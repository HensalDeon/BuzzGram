var zde=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var gBe=zde((ec,tc)=>{function Gde(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const c in r)if(c!=="default"&&!(c in t)){const l=Object.getOwnPropertyDescriptor(r,c);l&&Object.defineProperty(t,c,l.get?l:{enumerable:!0,get:()=>r[c]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))r(c);new MutationObserver(c=>{for(const l of c)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function n(c){const l={};return c.integrity&&(l.integrity=c.integrity),c.referrerPolicy&&(l.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?l.credentials="include":c.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(c){if(c.ep)return;c.ep=!0;const l=n(c);fetch(c.href,l)}})();var Gt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Kf(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var WX={exports:{}},vN={},HX={exports:{}},Wn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vb=Symbol.for("react.element"),Kde=Symbol.for("react.portal"),qde=Symbol.for("react.fragment"),Yde=Symbol.for("react.strict_mode"),Xde=Symbol.for("react.profiler"),Jde=Symbol.for("react.provider"),Qde=Symbol.for("react.context"),Zde=Symbol.for("react.forward_ref"),ehe=Symbol.for("react.suspense"),the=Symbol.for("react.memo"),nhe=Symbol.for("react.lazy"),u9=Symbol.iterator;function ihe(t){return t===null||typeof t!="object"?null:(t=u9&&t[u9]||t["@@iterator"],typeof t=="function"?t:null)}var $X={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},zX=Object.assign,GX={};function Ov(t,e,n){this.props=t,this.context=e,this.refs=GX,this.updater=n||$X}Ov.prototype.isReactComponent={};Ov.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ov.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function KX(){}KX.prototype=Ov.prototype;function fB(t,e,n){this.props=t,this.context=e,this.refs=GX,this.updater=n||$X}var pB=fB.prototype=new KX;pB.constructor=fB;zX(pB,Ov.prototype);pB.isPureReactComponent=!0;var d9=Array.isArray,qX=Object.prototype.hasOwnProperty,mB={current:null},YX={key:!0,ref:!0,__self:!0,__source:!0};function XX(t,e,n){var r,c={},l=null,d=null;if(e!=null)for(r in e.ref!==void 0&&(d=e.ref),e.key!==void 0&&(l=""+e.key),e)qX.call(e,r)&&!YX.hasOwnProperty(r)&&(c[r]=e[r]);var f=arguments.length-2;if(f===1)c.children=n;else if(1<f){for(var m=Array(f),E=0;E<f;E++)m[E]=arguments[E+2];c.children=m}if(t&&t.defaultProps)for(r in f=t.defaultProps,f)c[r]===void 0&&(c[r]=f[r]);return{$$typeof:vb,type:t,key:l,ref:d,props:c,_owner:mB.current}}function rhe(t,e){return{$$typeof:vb,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function gB(t){return typeof t=="object"&&t!==null&&t.$$typeof===vb}function she(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var h9=/\/+/g;function GU(t,e){return typeof t=="object"&&t!==null&&t.key!=null?she(""+t.key):e.toString(36)}function _O(t,e,n,r,c){var l=typeof t;(l==="undefined"||l==="boolean")&&(t=null);var d=!1;if(t===null)d=!0;else switch(l){case"string":case"number":d=!0;break;case"object":switch(t.$$typeof){case vb:case Kde:d=!0}}if(d)return d=t,c=c(d),t=r===""?"."+GU(d,0):r,d9(c)?(n="",t!=null&&(n=t.replace(h9,"$&/")+"/"),_O(c,e,n,"",function(E){return E})):c!=null&&(gB(c)&&(c=rhe(c,n+(!c.key||d&&d.key===c.key?"":(""+c.key).replace(h9,"$&/")+"/")+t)),e.push(c)),1;if(d=0,r=r===""?".":r+":",d9(t))for(var f=0;f<t.length;f++){l=t[f];var m=r+GU(l,f);d+=_O(l,e,n,m,c)}else if(m=ihe(t),typeof m=="function")for(t=m.call(t),f=0;!(l=t.next()).done;)l=l.value,m=r+GU(l,f++),d+=_O(l,e,n,m,c);else if(l==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return d}function yA(t,e,n){if(t==null)return t;var r=[],c=0;return _O(t,r,"","",function(l){return e.call(n,l,c++)}),r}function ohe(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var $o={current:null},EO={transition:null},ahe={ReactCurrentDispatcher:$o,ReactCurrentBatchConfig:EO,ReactCurrentOwner:mB};Wn.Children={map:yA,forEach:function(t,e,n){yA(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return yA(t,function(){e++}),e},toArray:function(t){return yA(t,function(e){return e})||[]},only:function(t){if(!gB(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Wn.Component=Ov;Wn.Fragment=qde;Wn.Profiler=Xde;Wn.PureComponent=fB;Wn.StrictMode=Yde;Wn.Suspense=ehe;Wn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ahe;Wn.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=zX({},t.props),c=t.key,l=t.ref,d=t._owner;if(e!=null){if(e.ref!==void 0&&(l=e.ref,d=mB.current),e.key!==void 0&&(c=""+e.key),t.type&&t.type.defaultProps)var f=t.type.defaultProps;for(m in e)qX.call(e,m)&&!YX.hasOwnProperty(m)&&(r[m]=e[m]===void 0&&f!==void 0?f[m]:e[m])}var m=arguments.length-2;if(m===1)r.children=n;else if(1<m){f=Array(m);for(var E=0;E<m;E++)f[E]=arguments[E+2];r.children=f}return{$$typeof:vb,type:t.type,key:c,ref:l,props:r,_owner:d}};Wn.createContext=function(t){return t={$$typeof:Qde,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Jde,_context:t},t.Consumer=t};Wn.createElement=XX;Wn.createFactory=function(t){var e=XX.bind(null,t);return e.type=t,e};Wn.createRef=function(){return{current:null}};Wn.forwardRef=function(t){return{$$typeof:Zde,render:t}};Wn.isValidElement=gB;Wn.lazy=function(t){return{$$typeof:nhe,_payload:{_status:-1,_result:t},_init:ohe}};Wn.memo=function(t,e){return{$$typeof:the,type:t,compare:e===void 0?null:e}};Wn.startTransition=function(t){var e=EO.transition;EO.transition={};try{t()}finally{EO.transition=e}};Wn.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Wn.useCallback=function(t,e){return $o.current.useCallback(t,e)};Wn.useContext=function(t){return $o.current.useContext(t)};Wn.useDebugValue=function(){};Wn.useDeferredValue=function(t){return $o.current.useDeferredValue(t)};Wn.useEffect=function(t,e){return $o.current.useEffect(t,e)};Wn.useId=function(){return $o.current.useId()};Wn.useImperativeHandle=function(t,e,n){return $o.current.useImperativeHandle(t,e,n)};Wn.useInsertionEffect=function(t,e){return $o.current.useInsertionEffect(t,e)};Wn.useLayoutEffect=function(t,e){return $o.current.useLayoutEffect(t,e)};Wn.useMemo=function(t,e){return $o.current.useMemo(t,e)};Wn.useReducer=function(t,e,n){return $o.current.useReducer(t,e,n)};Wn.useRef=function(t){return $o.current.useRef(t)};Wn.useState=function(t){return $o.current.useState(t)};Wn.useSyncExternalStore=function(t,e,n){return $o.current.useSyncExternalStore(t,e,n)};Wn.useTransition=function(){return $o.current.useTransition()};Wn.version="18.2.0";HX.exports=Wn;var $=HX.exports;const At=Kf($),che=Gde({__proto__:null,default:At},[$]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lhe=$,uhe=Symbol.for("react.element"),dhe=Symbol.for("react.fragment"),hhe=Object.prototype.hasOwnProperty,fhe=lhe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,phe={key:!0,ref:!0,__self:!0,__source:!0};function JX(t,e,n){var r,c={},l=null,d=null;n!==void 0&&(l=""+n),e.key!==void 0&&(l=""+e.key),e.ref!==void 0&&(d=e.ref);for(r in e)hhe.call(e,r)&&!phe.hasOwnProperty(r)&&(c[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)c[r]===void 0&&(c[r]=e[r]);return{$$typeof:uhe,type:t,key:l,ref:d,props:c,_owner:fhe.current}}vN.Fragment=dhe;vN.jsx=JX;vN.jsxs=JX;WX.exports=vN;var R=WX.exports,xF={},QX={exports:{}},oc={},ZX={exports:{}},eJ={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(_e,We){var Ie=_e.length;_e.push(We);e:for(;0<Ie;){var De=Ie-1>>>1,Ue=_e[De];if(0<c(Ue,We))_e[De]=We,_e[Ie]=Ue,Ie=De;else break e}}function n(_e){return _e.length===0?null:_e[0]}function r(_e){if(_e.length===0)return null;var We=_e[0],Ie=_e.pop();if(Ie!==We){_e[0]=Ie;e:for(var De=0,Ue=_e.length,rt=Ue>>>1;De<rt;){var gt=2*(De+1)-1,ft=_e[gt],Ft=gt+1,qt=_e[Ft];if(0>c(ft,Ie))Ft<Ue&&0>c(qt,ft)?(_e[De]=qt,_e[Ft]=Ie,De=Ft):(_e[De]=ft,_e[gt]=Ie,De=gt);else if(Ft<Ue&&0>c(qt,Ie))_e[De]=qt,_e[Ft]=Ie,De=Ft;else break e}}return We}function c(_e,We){var Ie=_e.sortIndex-We.sortIndex;return Ie!==0?Ie:_e.id-We.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var d=Date,f=d.now();t.unstable_now=function(){return d.now()-f}}var m=[],E=[],y=1,w=null,I=3,P=!1,k=!1,M=!1,K=typeof setTimeout=="function"?setTimeout:null,W=typeof clearTimeout=="function"?clearTimeout:null,V=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function G(_e){for(var We=n(E);We!==null;){if(We.callback===null)r(E);else if(We.startTime<=_e)r(E),We.sortIndex=We.expirationTime,e(m,We);else break;We=n(E)}}function Q(_e){if(M=!1,G(_e),!k)if(n(m)!==null)k=!0,be(Z);else{var We=n(E);We!==null&&Oe(Q,We.startTime-_e)}}function Z(_e,We){k=!1,M&&(M=!1,W(ce),ce=-1),P=!0;var Ie=I;try{for(G(We),w=n(m);w!==null&&(!(w.expirationTime>We)||_e&&!je());){var De=w.callback;if(typeof De=="function"){w.callback=null,I=w.priorityLevel;var Ue=De(w.expirationTime<=We);We=t.unstable_now(),typeof Ue=="function"?w.callback=Ue:w===n(m)&&r(m),G(We)}else r(m);w=n(m)}if(w!==null)var rt=!0;else{var gt=n(E);gt!==null&&Oe(Q,gt.startTime-We),rt=!1}return rt}finally{w=null,I=Ie,P=!1}}var Y=!1,oe=null,ce=-1,Se=5,xe=-1;function je(){return!(t.unstable_now()-xe<Se)}function Ge(){if(oe!==null){var _e=t.unstable_now();xe=_e;var We=!0;try{We=oe(!0,_e)}finally{We?ze():(Y=!1,oe=null)}}else Y=!1}var ze;if(typeof V=="function")ze=function(){V(Ge)};else if(typeof MessageChannel<"u"){var Ke=new MessageChannel,He=Ke.port2;Ke.port1.onmessage=Ge,ze=function(){He.postMessage(null)}}else ze=function(){K(Ge,0)};function be(_e){oe=_e,Y||(Y=!0,ze())}function Oe(_e,We){ce=K(function(){_e(t.unstable_now())},We)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(_e){_e.callback=null},t.unstable_continueExecution=function(){k||P||(k=!0,be(Z))},t.unstable_forceFrameRate=function(_e){0>_e||125<_e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Se=0<_e?Math.floor(1e3/_e):5},t.unstable_getCurrentPriorityLevel=function(){return I},t.unstable_getFirstCallbackNode=function(){return n(m)},t.unstable_next=function(_e){switch(I){case 1:case 2:case 3:var We=3;break;default:We=I}var Ie=I;I=We;try{return _e()}finally{I=Ie}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(_e,We){switch(_e){case 1:case 2:case 3:case 4:case 5:break;default:_e=3}var Ie=I;I=_e;try{return We()}finally{I=Ie}},t.unstable_scheduleCallback=function(_e,We,Ie){var De=t.unstable_now();switch(typeof Ie=="object"&&Ie!==null?(Ie=Ie.delay,Ie=typeof Ie=="number"&&0<Ie?De+Ie:De):Ie=De,_e){case 1:var Ue=-1;break;case 2:Ue=250;break;case 5:Ue=1073741823;break;case 4:Ue=1e4;break;default:Ue=5e3}return Ue=Ie+Ue,_e={id:y++,callback:We,priorityLevel:_e,startTime:Ie,expirationTime:Ue,sortIndex:-1},Ie>De?(_e.sortIndex=Ie,e(E,_e),n(m)===null&&_e===n(E)&&(M?(W(ce),ce=-1):M=!0,Oe(Q,Ie-De))):(_e.sortIndex=Ue,e(m,_e),k||P||(k=!0,be(Z))),_e},t.unstable_shouldYield=je,t.unstable_wrapCallback=function(_e){var We=I;return function(){var Ie=I;I=We;try{return _e.apply(this,arguments)}finally{I=Ie}}}})(eJ);ZX.exports=eJ;var mhe=ZX.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tJ=$,ic=mhe;function ct(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var nJ=new Set,PT={};function dg(t,e){dv(t,e),dv(t+"Capture",e)}function dv(t,e){for(PT[t]=e,t=0;t<e.length;t++)nJ.add(e[t])}var Ud=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),DF=Object.prototype.hasOwnProperty,ghe=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f9={},p9={};function _he(t){return DF.call(p9,t)?!0:DF.call(f9,t)?!1:ghe.test(t)?p9[t]=!0:(f9[t]=!0,!1)}function Ehe(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function vhe(t,e,n,r){if(e===null||typeof e>"u"||Ehe(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function zo(t,e,n,r,c,l,d){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=c,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=l,this.removeEmptyString=d}var Ys={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ys[t]=new zo(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ys[e]=new zo(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ys[t]=new zo(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ys[t]=new zo(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ys[t]=new zo(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ys[t]=new zo(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ys[t]=new zo(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ys[t]=new zo(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ys[t]=new zo(t,5,!1,t.toLowerCase(),null,!1,!1)});var _B=/[\-:]([a-z])/g;function EB(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(_B,EB);Ys[e]=new zo(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(_B,EB);Ys[e]=new zo(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(_B,EB);Ys[e]=new zo(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ys[t]=new zo(t,1,!1,t.toLowerCase(),null,!1,!1)});Ys.xlinkHref=new zo("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ys[t]=new zo(t,1,!1,t.toLowerCase(),null,!0,!0)});function vB(t,e,n,r){var c=Ys.hasOwnProperty(e)?Ys[e]:null;(c!==null?c.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(vhe(e,n,c,r)&&(n=null),r||c===null?_he(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):c.mustUseProperty?t[c.propertyName]=n===null?c.type===3?!1:"":n:(e=c.attributeName,r=c.attributeNamespace,n===null?t.removeAttribute(e):(c=c.type,n=c===3||c===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Gd=tJ.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,SA=Symbol.for("react.element"),RE=Symbol.for("react.portal"),IE=Symbol.for("react.fragment"),yB=Symbol.for("react.strict_mode"),kF=Symbol.for("react.profiler"),iJ=Symbol.for("react.provider"),rJ=Symbol.for("react.context"),SB=Symbol.for("react.forward_ref"),LF=Symbol.for("react.suspense"),MF=Symbol.for("react.suspense_list"),TB=Symbol.for("react.memo"),sf=Symbol.for("react.lazy"),sJ=Symbol.for("react.offscreen"),m9=Symbol.iterator;function CS(t){return t===null||typeof t!="object"?null:(t=m9&&t[m9]||t["@@iterator"],typeof t=="function"?t:null)}var Pr=Object.assign,KU;function XS(t){if(KU===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);KU=e&&e[1]||""}return`
`+KU+t}var qU=!1;function YU(t,e){if(!t||qU)return"";qU=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(E){var r=E}Reflect.construct(t,[],e)}else{try{e.call()}catch(E){r=E}t.call(e.prototype)}else{try{throw Error()}catch(E){r=E}t()}}catch(E){if(E&&r&&typeof E.stack=="string"){for(var c=E.stack.split(`
`),l=r.stack.split(`
`),d=c.length-1,f=l.length-1;1<=d&&0<=f&&c[d]!==l[f];)f--;for(;1<=d&&0<=f;d--,f--)if(c[d]!==l[f]){if(d!==1||f!==1)do if(d--,f--,0>f||c[d]!==l[f]){var m=`
`+c[d].replace(" at new "," at ");return t.displayName&&m.includes("<anonymous>")&&(m=m.replace("<anonymous>",t.displayName)),m}while(1<=d&&0<=f);break}}}finally{qU=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?XS(t):""}function yhe(t){switch(t.tag){case 5:return XS(t.type);case 16:return XS("Lazy");case 13:return XS("Suspense");case 19:return XS("SuspenseList");case 0:case 2:case 15:return t=YU(t.type,!1),t;case 11:return t=YU(t.type.render,!1),t;case 1:return t=YU(t.type,!0),t;default:return""}}function UF(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case IE:return"Fragment";case RE:return"Portal";case kF:return"Profiler";case yB:return"StrictMode";case LF:return"Suspense";case MF:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case rJ:return(t.displayName||"Context")+".Consumer";case iJ:return(t._context.displayName||"Context")+".Provider";case SB:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case TB:return e=t.displayName||null,e!==null?e:UF(t.type)||"Memo";case sf:e=t._payload,t=t._init;try{return UF(t(e))}catch{}}return null}function She(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return UF(e);case 8:return e===yB?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Vf(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function oJ(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function The(t){var e=oJ(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var c=n.get,l=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return c.call(this)},set:function(d){r=""+d,l.call(this,d)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(d){r=""+d},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function TA(t){t._valueTracker||(t._valueTracker=The(t))}function aJ(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=oJ(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function JO(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function jF(t,e){var n=e.checked;return Pr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function g9(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Vf(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function cJ(t,e){e=e.checked,e!=null&&vB(t,"checked",e,!1)}function FF(t,e){cJ(t,e);var n=Vf(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?VF(t,e.type,n):e.hasOwnProperty("defaultValue")&&VF(t,e.type,Vf(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function _9(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function VF(t,e,n){(e!=="number"||JO(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var JS=Array.isArray;function GE(t,e,n,r){if(t=t.options,e){e={};for(var c=0;c<n.length;c++)e["$"+n[c]]=!0;for(n=0;n<t.length;n++)c=e.hasOwnProperty("$"+t[n].value),t[n].selected!==c&&(t[n].selected=c),c&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Vf(n),e=null,c=0;c<t.length;c++){if(t[c].value===n){t[c].selected=!0,r&&(t[c].defaultSelected=!0);return}e!==null||t[c].disabled||(e=t[c])}e!==null&&(e.selected=!0)}}function BF(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ct(91));return Pr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function E9(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ct(92));if(JS(n)){if(1<n.length)throw Error(ct(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Vf(n)}}function lJ(t,e){var n=Vf(e.value),r=Vf(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function v9(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function uJ(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function WF(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?uJ(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var bA,dJ=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,c){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,c)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(bA=bA||document.createElement("div"),bA.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=bA.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function xT(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var lT={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},bhe=["Webkit","ms","Moz","O"];Object.keys(lT).forEach(function(t){bhe.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),lT[e]=lT[t]})});function hJ(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||lT.hasOwnProperty(t)&&lT[t]?(""+e).trim():e+"px"}function fJ(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,c=hJ(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,c):t[n]=c}}var whe=Pr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function HF(t,e){if(e){if(whe[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ct(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ct(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ct(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ct(62))}}function $F(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zF=null;function bB(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var GF=null,KE=null,qE=null;function y9(t){if(t=Tb(t)){if(typeof GF!="function")throw Error(ct(280));var e=t.stateNode;e&&(e=wN(e),GF(t.stateNode,t.type,e))}}function pJ(t){KE?qE?qE.push(t):qE=[t]:KE=t}function mJ(){if(KE){var t=KE,e=qE;if(qE=KE=null,y9(t),e)for(t=0;t<e.length;t++)y9(e[t])}}function gJ(t,e){return t(e)}function _J(){}var XU=!1;function EJ(t,e,n){if(XU)return t(e,n);XU=!0;try{return gJ(t,e,n)}finally{XU=!1,(KE!==null||qE!==null)&&(_J(),mJ())}}function DT(t,e){var n=t.stateNode;if(n===null)return null;var r=wN(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ct(231,e,typeof n));return n}var KF=!1;if(Ud)try{var RS={};Object.defineProperty(RS,"passive",{get:function(){KF=!0}}),window.addEventListener("test",RS,RS),window.removeEventListener("test",RS,RS)}catch{KF=!1}function Che(t,e,n,r,c,l,d,f,m){var E=Array.prototype.slice.call(arguments,3);try{e.apply(n,E)}catch(y){this.onError(y)}}var uT=!1,QO=null,ZO=!1,qF=null,Rhe={onError:function(t){uT=!0,QO=t}};function Ihe(t,e,n,r,c,l,d,f,m){uT=!1,QO=null,Che.apply(Rhe,arguments)}function Ahe(t,e,n,r,c,l,d,f,m){if(Ihe.apply(this,arguments),uT){if(uT){var E=QO;uT=!1,QO=null}else throw Error(ct(198));ZO||(ZO=!0,qF=E)}}function hg(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function vJ(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function S9(t){if(hg(t)!==t)throw Error(ct(188))}function Ohe(t){var e=t.alternate;if(!e){if(e=hg(t),e===null)throw Error(ct(188));return e!==t?null:t}for(var n=t,r=e;;){var c=n.return;if(c===null)break;var l=c.alternate;if(l===null){if(r=c.return,r!==null){n=r;continue}break}if(c.child===l.child){for(l=c.child;l;){if(l===n)return S9(c),t;if(l===r)return S9(c),e;l=l.sibling}throw Error(ct(188))}if(n.return!==r.return)n=c,r=l;else{for(var d=!1,f=c.child;f;){if(f===n){d=!0,n=c,r=l;break}if(f===r){d=!0,r=c,n=l;break}f=f.sibling}if(!d){for(f=l.child;f;){if(f===n){d=!0,n=l,r=c;break}if(f===r){d=!0,r=l,n=c;break}f=f.sibling}if(!d)throw Error(ct(189))}}if(n.alternate!==r)throw Error(ct(190))}if(n.tag!==3)throw Error(ct(188));return n.stateNode.current===n?t:e}function yJ(t){return t=Ohe(t),t!==null?SJ(t):null}function SJ(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=SJ(t);if(e!==null)return e;t=t.sibling}return null}var TJ=ic.unstable_scheduleCallback,T9=ic.unstable_cancelCallback,Nhe=ic.unstable_shouldYield,Phe=ic.unstable_requestPaint,zr=ic.unstable_now,xhe=ic.unstable_getCurrentPriorityLevel,wB=ic.unstable_ImmediatePriority,bJ=ic.unstable_UserBlockingPriority,e1=ic.unstable_NormalPriority,Dhe=ic.unstable_LowPriority,wJ=ic.unstable_IdlePriority,yN=null,_u=null;function khe(t){if(_u&&typeof _u.onCommitFiberRoot=="function")try{_u.onCommitFiberRoot(yN,t,void 0,(t.current.flags&128)===128)}catch{}}var Sl=Math.clz32?Math.clz32:Uhe,Lhe=Math.log,Mhe=Math.LN2;function Uhe(t){return t>>>=0,t===0?32:31-(Lhe(t)/Mhe|0)|0}var wA=64,CA=4194304;function QS(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function t1(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,c=t.suspendedLanes,l=t.pingedLanes,d=n&268435455;if(d!==0){var f=d&~c;f!==0?r=QS(f):(l&=d,l!==0&&(r=QS(l)))}else d=n&~c,d!==0?r=QS(d):l!==0&&(r=QS(l));if(r===0)return 0;if(e!==0&&e!==r&&!(e&c)&&(c=r&-r,l=e&-e,c>=l||c===16&&(l&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Sl(e),c=1<<n,r|=t[n],e&=~c;return r}function jhe(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Fhe(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,c=t.expirationTimes,l=t.pendingLanes;0<l;){var d=31-Sl(l),f=1<<d,m=c[d];m===-1?(!(f&n)||f&r)&&(c[d]=jhe(f,e)):m<=e&&(t.expiredLanes|=f),l&=~f}}function YF(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function CJ(){var t=wA;return wA<<=1,!(wA&4194240)&&(wA=64),t}function JU(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function yb(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Sl(e),t[e]=n}function Vhe(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var c=31-Sl(n),l=1<<c;e[c]=0,r[c]=-1,t[c]=-1,n&=~l}}function CB(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Sl(n),c=1<<r;c&e|t[r]&e&&(t[r]|=e),n&=~c}}var yi=0;function RJ(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var IJ,RB,AJ,OJ,NJ,XF=!1,RA=[],Cf=null,Rf=null,If=null,kT=new Map,LT=new Map,lf=[],Bhe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function b9(t,e){switch(t){case"focusin":case"focusout":Cf=null;break;case"dragenter":case"dragleave":Rf=null;break;case"mouseover":case"mouseout":If=null;break;case"pointerover":case"pointerout":kT.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":LT.delete(e.pointerId)}}function IS(t,e,n,r,c,l){return t===null||t.nativeEvent!==l?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:l,targetContainers:[c]},e!==null&&(e=Tb(e),e!==null&&RB(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,c!==null&&e.indexOf(c)===-1&&e.push(c),t)}function Whe(t,e,n,r,c){switch(e){case"focusin":return Cf=IS(Cf,t,e,n,r,c),!0;case"dragenter":return Rf=IS(Rf,t,e,n,r,c),!0;case"mouseover":return If=IS(If,t,e,n,r,c),!0;case"pointerover":var l=c.pointerId;return kT.set(l,IS(kT.get(l)||null,t,e,n,r,c)),!0;case"gotpointercapture":return l=c.pointerId,LT.set(l,IS(LT.get(l)||null,t,e,n,r,c)),!0}return!1}function PJ(t){var e=Dm(t.target);if(e!==null){var n=hg(e);if(n!==null){if(e=n.tag,e===13){if(e=vJ(n),e!==null){t.blockedOn=e,NJ(t.priority,function(){AJ(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function vO(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=JF(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);zF=r,n.target.dispatchEvent(r),zF=null}else return e=Tb(n),e!==null&&RB(e),t.blockedOn=n,!1;e.shift()}return!0}function w9(t,e,n){vO(t)&&n.delete(e)}function Hhe(){XF=!1,Cf!==null&&vO(Cf)&&(Cf=null),Rf!==null&&vO(Rf)&&(Rf=null),If!==null&&vO(If)&&(If=null),kT.forEach(w9),LT.forEach(w9)}function AS(t,e){t.blockedOn===e&&(t.blockedOn=null,XF||(XF=!0,ic.unstable_scheduleCallback(ic.unstable_NormalPriority,Hhe)))}function MT(t){function e(c){return AS(c,t)}if(0<RA.length){AS(RA[0],t);for(var n=1;n<RA.length;n++){var r=RA[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Cf!==null&&AS(Cf,t),Rf!==null&&AS(Rf,t),If!==null&&AS(If,t),kT.forEach(e),LT.forEach(e),n=0;n<lf.length;n++)r=lf[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<lf.length&&(n=lf[0],n.blockedOn===null);)PJ(n),n.blockedOn===null&&lf.shift()}var YE=Gd.ReactCurrentBatchConfig,n1=!0;function $he(t,e,n,r){var c=yi,l=YE.transition;YE.transition=null;try{yi=1,IB(t,e,n,r)}finally{yi=c,YE.transition=l}}function zhe(t,e,n,r){var c=yi,l=YE.transition;YE.transition=null;try{yi=4,IB(t,e,n,r)}finally{yi=c,YE.transition=l}}function IB(t,e,n,r){if(n1){var c=JF(t,e,n,r);if(c===null)aj(t,e,r,i1,n),b9(t,r);else if(Whe(c,t,e,n,r))r.stopPropagation();else if(b9(t,r),e&4&&-1<Bhe.indexOf(t)){for(;c!==null;){var l=Tb(c);if(l!==null&&IJ(l),l=JF(t,e,n,r),l===null&&aj(t,e,r,i1,n),l===c)break;c=l}c!==null&&r.stopPropagation()}else aj(t,e,r,null,n)}}var i1=null;function JF(t,e,n,r){if(i1=null,t=bB(r),t=Dm(t),t!==null)if(e=hg(t),e===null)t=null;else if(n=e.tag,n===13){if(t=vJ(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return i1=t,null}function xJ(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xhe()){case wB:return 1;case bJ:return 4;case e1:case Dhe:return 16;case wJ:return 536870912;default:return 16}default:return 16}}var _f=null,AB=null,yO=null;function DJ(){if(yO)return yO;var t,e=AB,n=e.length,r,c="value"in _f?_f.value:_f.textContent,l=c.length;for(t=0;t<n&&e[t]===c[t];t++);var d=n-t;for(r=1;r<=d&&e[n-r]===c[l-r];r++);return yO=c.slice(t,1<r?1-r:void 0)}function SO(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function IA(){return!0}function C9(){return!1}function ac(t){function e(n,r,c,l,d){this._reactName=n,this._targetInst=c,this.type=r,this.nativeEvent=l,this.target=d,this.currentTarget=null;for(var f in t)t.hasOwnProperty(f)&&(n=t[f],this[f]=n?n(l):l[f]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?IA:C9,this.isPropagationStopped=C9,this}return Pr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=IA)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=IA)},persist:function(){},isPersistent:IA}),e}var Nv={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},OB=ac(Nv),Sb=Pr({},Nv,{view:0,detail:0}),Ghe=ac(Sb),QU,ZU,OS,SN=Pr({},Sb,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:NB,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==OS&&(OS&&t.type==="mousemove"?(QU=t.screenX-OS.screenX,ZU=t.screenY-OS.screenY):ZU=QU=0,OS=t),QU)},movementY:function(t){return"movementY"in t?t.movementY:ZU}}),R9=ac(SN),Khe=Pr({},SN,{dataTransfer:0}),qhe=ac(Khe),Yhe=Pr({},Sb,{relatedTarget:0}),ej=ac(Yhe),Xhe=Pr({},Nv,{animationName:0,elapsedTime:0,pseudoElement:0}),Jhe=ac(Xhe),Qhe=Pr({},Nv,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Zhe=ac(Qhe),efe=Pr({},Nv,{data:0}),I9=ac(efe),tfe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nfe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ife={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rfe(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=ife[t])?!!e[t]:!1}function NB(){return rfe}var sfe=Pr({},Sb,{key:function(t){if(t.key){var e=tfe[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=SO(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?nfe[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:NB,charCode:function(t){return t.type==="keypress"?SO(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?SO(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),ofe=ac(sfe),afe=Pr({},SN,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),A9=ac(afe),cfe=Pr({},Sb,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:NB}),lfe=ac(cfe),ufe=Pr({},Nv,{propertyName:0,elapsedTime:0,pseudoElement:0}),dfe=ac(ufe),hfe=Pr({},SN,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),ffe=ac(hfe),pfe=[9,13,27,32],PB=Ud&&"CompositionEvent"in window,dT=null;Ud&&"documentMode"in document&&(dT=document.documentMode);var mfe=Ud&&"TextEvent"in window&&!dT,kJ=Ud&&(!PB||dT&&8<dT&&11>=dT),O9=String.fromCharCode(32),N9=!1;function LJ(t,e){switch(t){case"keyup":return pfe.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function MJ(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var AE=!1;function gfe(t,e){switch(t){case"compositionend":return MJ(e);case"keypress":return e.which!==32?null:(N9=!0,O9);case"textInput":return t=e.data,t===O9&&N9?null:t;default:return null}}function _fe(t,e){if(AE)return t==="compositionend"||!PB&&LJ(t,e)?(t=DJ(),yO=AB=_f=null,AE=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return kJ&&e.locale!=="ko"?null:e.data;default:return null}}var Efe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function P9(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Efe[t.type]:e==="textarea"}function UJ(t,e,n,r){pJ(r),e=r1(e,"onChange"),0<e.length&&(n=new OB("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var hT=null,UT=null;function vfe(t){qJ(t,0)}function TN(t){var e=PE(t);if(aJ(e))return t}function yfe(t,e){if(t==="change")return e}var jJ=!1;if(Ud){var tj;if(Ud){var nj="oninput"in document;if(!nj){var x9=document.createElement("div");x9.setAttribute("oninput","return;"),nj=typeof x9.oninput=="function"}tj=nj}else tj=!1;jJ=tj&&(!document.documentMode||9<document.documentMode)}function D9(){hT&&(hT.detachEvent("onpropertychange",FJ),UT=hT=null)}function FJ(t){if(t.propertyName==="value"&&TN(UT)){var e=[];UJ(e,UT,t,bB(t)),EJ(vfe,e)}}function Sfe(t,e,n){t==="focusin"?(D9(),hT=e,UT=n,hT.attachEvent("onpropertychange",FJ)):t==="focusout"&&D9()}function Tfe(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return TN(UT)}function bfe(t,e){if(t==="click")return TN(e)}function wfe(t,e){if(t==="input"||t==="change")return TN(e)}function Cfe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var bl=typeof Object.is=="function"?Object.is:Cfe;function jT(t,e){if(bl(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var c=n[r];if(!DF.call(e,c)||!bl(t[c],e[c]))return!1}return!0}function k9(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function L9(t,e){var n=k9(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=k9(n)}}function VJ(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?VJ(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function BJ(){for(var t=window,e=JO();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=JO(t.document)}return e}function xB(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Rfe(t){var e=BJ(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&VJ(n.ownerDocument.documentElement,n)){if(r!==null&&xB(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var c=n.textContent.length,l=Math.min(r.start,c);r=r.end===void 0?l:Math.min(r.end,c),!t.extend&&l>r&&(c=r,r=l,l=c),c=L9(n,l);var d=L9(n,r);c&&d&&(t.rangeCount!==1||t.anchorNode!==c.node||t.anchorOffset!==c.offset||t.focusNode!==d.node||t.focusOffset!==d.offset)&&(e=e.createRange(),e.setStart(c.node,c.offset),t.removeAllRanges(),l>r?(t.addRange(e),t.extend(d.node,d.offset)):(e.setEnd(d.node,d.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Ife=Ud&&"documentMode"in document&&11>=document.documentMode,OE=null,QF=null,fT=null,ZF=!1;function M9(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ZF||OE==null||OE!==JO(r)||(r=OE,"selectionStart"in r&&xB(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),fT&&jT(fT,r)||(fT=r,r=r1(QF,"onSelect"),0<r.length&&(e=new OB("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=OE)))}function AA(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var NE={animationend:AA("Animation","AnimationEnd"),animationiteration:AA("Animation","AnimationIteration"),animationstart:AA("Animation","AnimationStart"),transitionend:AA("Transition","TransitionEnd")},ij={},WJ={};Ud&&(WJ=document.createElement("div").style,"AnimationEvent"in window||(delete NE.animationend.animation,delete NE.animationiteration.animation,delete NE.animationstart.animation),"TransitionEvent"in window||delete NE.transitionend.transition);function bN(t){if(ij[t])return ij[t];if(!NE[t])return t;var e=NE[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in WJ)return ij[t]=e[n];return t}var HJ=bN("animationend"),$J=bN("animationiteration"),zJ=bN("animationstart"),GJ=bN("transitionend"),KJ=new Map,U9="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qf(t,e){KJ.set(t,e),dg(e,[t])}for(var rj=0;rj<U9.length;rj++){var sj=U9[rj],Afe=sj.toLowerCase(),Ofe=sj[0].toUpperCase()+sj.slice(1);qf(Afe,"on"+Ofe)}qf(HJ,"onAnimationEnd");qf($J,"onAnimationIteration");qf(zJ,"onAnimationStart");qf("dblclick","onDoubleClick");qf("focusin","onFocus");qf("focusout","onBlur");qf(GJ,"onTransitionEnd");dv("onMouseEnter",["mouseout","mouseover"]);dv("onMouseLeave",["mouseout","mouseover"]);dv("onPointerEnter",["pointerout","pointerover"]);dv("onPointerLeave",["pointerout","pointerover"]);dg("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));dg("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));dg("onBeforeInput",["compositionend","keypress","textInput","paste"]);dg("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));dg("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));dg("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ZS="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nfe=new Set("cancel close invalid load scroll toggle".split(" ").concat(ZS));function j9(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Ahe(r,e,void 0,t),t.currentTarget=null}function qJ(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],c=r.event;r=r.listeners;e:{var l=void 0;if(e)for(var d=r.length-1;0<=d;d--){var f=r[d],m=f.instance,E=f.currentTarget;if(f=f.listener,m!==l&&c.isPropagationStopped())break e;j9(c,f,E),l=m}else for(d=0;d<r.length;d++){if(f=r[d],m=f.instance,E=f.currentTarget,f=f.listener,m!==l&&c.isPropagationStopped())break e;j9(c,f,E),l=m}}}if(ZO)throw t=qF,ZO=!1,qF=null,t}function or(t,e){var n=e[r3];n===void 0&&(n=e[r3]=new Set);var r=t+"__bubble";n.has(r)||(YJ(e,t,2,!1),n.add(r))}function oj(t,e,n){var r=0;e&&(r|=4),YJ(n,t,r,e)}var OA="_reactListening"+Math.random().toString(36).slice(2);function FT(t){if(!t[OA]){t[OA]=!0,nJ.forEach(function(n){n!=="selectionchange"&&(Nfe.has(n)||oj(n,!1,t),oj(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[OA]||(e[OA]=!0,oj("selectionchange",!1,e))}}function YJ(t,e,n,r){switch(xJ(e)){case 1:var c=$he;break;case 4:c=zhe;break;default:c=IB}n=c.bind(null,e,n,t),c=void 0,!KF||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(c=!0),r?c!==void 0?t.addEventListener(e,n,{capture:!0,passive:c}):t.addEventListener(e,n,!0):c!==void 0?t.addEventListener(e,n,{passive:c}):t.addEventListener(e,n,!1)}function aj(t,e,n,r,c){var l=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var d=r.tag;if(d===3||d===4){var f=r.stateNode.containerInfo;if(f===c||f.nodeType===8&&f.parentNode===c)break;if(d===4)for(d=r.return;d!==null;){var m=d.tag;if((m===3||m===4)&&(m=d.stateNode.containerInfo,m===c||m.nodeType===8&&m.parentNode===c))return;d=d.return}for(;f!==null;){if(d=Dm(f),d===null)return;if(m=d.tag,m===5||m===6){r=l=d;continue e}f=f.parentNode}}r=r.return}EJ(function(){var E=l,y=bB(n),w=[];e:{var I=KJ.get(t);if(I!==void 0){var P=OB,k=t;switch(t){case"keypress":if(SO(n)===0)break e;case"keydown":case"keyup":P=ofe;break;case"focusin":k="focus",P=ej;break;case"focusout":k="blur",P=ej;break;case"beforeblur":case"afterblur":P=ej;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":P=R9;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":P=qhe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":P=lfe;break;case HJ:case $J:case zJ:P=Jhe;break;case GJ:P=dfe;break;case"scroll":P=Ghe;break;case"wheel":P=ffe;break;case"copy":case"cut":case"paste":P=Zhe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":P=A9}var M=(e&4)!==0,K=!M&&t==="scroll",W=M?I!==null?I+"Capture":null:I;M=[];for(var V=E,G;V!==null;){G=V;var Q=G.stateNode;if(G.tag===5&&Q!==null&&(G=Q,W!==null&&(Q=DT(V,W),Q!=null&&M.push(VT(V,Q,G)))),K)break;V=V.return}0<M.length&&(I=new P(I,k,null,n,y),w.push({event:I,listeners:M}))}}if(!(e&7)){e:{if(I=t==="mouseover"||t==="pointerover",P=t==="mouseout"||t==="pointerout",I&&n!==zF&&(k=n.relatedTarget||n.fromElement)&&(Dm(k)||k[jd]))break e;if((P||I)&&(I=y.window===y?y:(I=y.ownerDocument)?I.defaultView||I.parentWindow:window,P?(k=n.relatedTarget||n.toElement,P=E,k=k?Dm(k):null,k!==null&&(K=hg(k),k!==K||k.tag!==5&&k.tag!==6)&&(k=null)):(P=null,k=E),P!==k)){if(M=R9,Q="onMouseLeave",W="onMouseEnter",V="mouse",(t==="pointerout"||t==="pointerover")&&(M=A9,Q="onPointerLeave",W="onPointerEnter",V="pointer"),K=P==null?I:PE(P),G=k==null?I:PE(k),I=new M(Q,V+"leave",P,n,y),I.target=K,I.relatedTarget=G,Q=null,Dm(y)===E&&(M=new M(W,V+"enter",k,n,y),M.target=G,M.relatedTarget=K,Q=M),K=Q,P&&k)t:{for(M=P,W=k,V=0,G=M;G;G=_E(G))V++;for(G=0,Q=W;Q;Q=_E(Q))G++;for(;0<V-G;)M=_E(M),V--;for(;0<G-V;)W=_E(W),G--;for(;V--;){if(M===W||W!==null&&M===W.alternate)break t;M=_E(M),W=_E(W)}M=null}else M=null;P!==null&&F9(w,I,P,M,!1),k!==null&&K!==null&&F9(w,K,k,M,!0)}}e:{if(I=E?PE(E):window,P=I.nodeName&&I.nodeName.toLowerCase(),P==="select"||P==="input"&&I.type==="file")var Z=yfe;else if(P9(I))if(jJ)Z=wfe;else{Z=Tfe;var Y=Sfe}else(P=I.nodeName)&&P.toLowerCase()==="input"&&(I.type==="checkbox"||I.type==="radio")&&(Z=bfe);if(Z&&(Z=Z(t,E))){UJ(w,Z,n,y);break e}Y&&Y(t,I,E),t==="focusout"&&(Y=I._wrapperState)&&Y.controlled&&I.type==="number"&&VF(I,"number",I.value)}switch(Y=E?PE(E):window,t){case"focusin":(P9(Y)||Y.contentEditable==="true")&&(OE=Y,QF=E,fT=null);break;case"focusout":fT=QF=OE=null;break;case"mousedown":ZF=!0;break;case"contextmenu":case"mouseup":case"dragend":ZF=!1,M9(w,n,y);break;case"selectionchange":if(Ife)break;case"keydown":case"keyup":M9(w,n,y)}var oe;if(PB)e:{switch(t){case"compositionstart":var ce="onCompositionStart";break e;case"compositionend":ce="onCompositionEnd";break e;case"compositionupdate":ce="onCompositionUpdate";break e}ce=void 0}else AE?LJ(t,n)&&(ce="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(ce="onCompositionStart");ce&&(kJ&&n.locale!=="ko"&&(AE||ce!=="onCompositionStart"?ce==="onCompositionEnd"&&AE&&(oe=DJ()):(_f=y,AB="value"in _f?_f.value:_f.textContent,AE=!0)),Y=r1(E,ce),0<Y.length&&(ce=new I9(ce,t,null,n,y),w.push({event:ce,listeners:Y}),oe?ce.data=oe:(oe=MJ(n),oe!==null&&(ce.data=oe)))),(oe=mfe?gfe(t,n):_fe(t,n))&&(E=r1(E,"onBeforeInput"),0<E.length&&(y=new I9("onBeforeInput","beforeinput",null,n,y),w.push({event:y,listeners:E}),y.data=oe))}qJ(w,e)})}function VT(t,e,n){return{instance:t,listener:e,currentTarget:n}}function r1(t,e){for(var n=e+"Capture",r=[];t!==null;){var c=t,l=c.stateNode;c.tag===5&&l!==null&&(c=l,l=DT(t,n),l!=null&&r.unshift(VT(t,l,c)),l=DT(t,e),l!=null&&r.push(VT(t,l,c))),t=t.return}return r}function _E(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function F9(t,e,n,r,c){for(var l=e._reactName,d=[];n!==null&&n!==r;){var f=n,m=f.alternate,E=f.stateNode;if(m!==null&&m===r)break;f.tag===5&&E!==null&&(f=E,c?(m=DT(n,l),m!=null&&d.unshift(VT(n,m,f))):c||(m=DT(n,l),m!=null&&d.push(VT(n,m,f)))),n=n.return}d.length!==0&&t.push({event:e,listeners:d})}var Pfe=/\r\n?/g,xfe=/\u0000|\uFFFD/g;function V9(t){return(typeof t=="string"?t:""+t).replace(Pfe,`
`).replace(xfe,"")}function NA(t,e,n){if(e=V9(e),V9(t)!==e&&n)throw Error(ct(425))}function s1(){}var e3=null,t3=null;function n3(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var i3=typeof setTimeout=="function"?setTimeout:void 0,Dfe=typeof clearTimeout=="function"?clearTimeout:void 0,B9=typeof Promise=="function"?Promise:void 0,kfe=typeof queueMicrotask=="function"?queueMicrotask:typeof B9<"u"?function(t){return B9.resolve(null).then(t).catch(Lfe)}:i3;function Lfe(t){setTimeout(function(){throw t})}function cj(t,e){var n=e,r=0;do{var c=n.nextSibling;if(t.removeChild(n),c&&c.nodeType===8)if(n=c.data,n==="/$"){if(r===0){t.removeChild(c),MT(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=c}while(n);MT(e)}function Af(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function W9(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Pv=Math.random().toString(36).slice(2),mu="__reactFiber$"+Pv,BT="__reactProps$"+Pv,jd="__reactContainer$"+Pv,r3="__reactEvents$"+Pv,Mfe="__reactListeners$"+Pv,Ufe="__reactHandles$"+Pv;function Dm(t){var e=t[mu];if(e)return e;for(var n=t.parentNode;n;){if(e=n[jd]||n[mu]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=W9(t);t!==null;){if(n=t[mu])return n;t=W9(t)}return e}t=n,n=t.parentNode}return null}function Tb(t){return t=t[mu]||t[jd],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function PE(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ct(33))}function wN(t){return t[BT]||null}var s3=[],xE=-1;function Yf(t){return{current:t}}function lr(t){0>xE||(t.current=s3[xE],s3[xE]=null,xE--)}function Ji(t,e){xE++,s3[xE]=t.current,t.current=e}var Bf={},Co=Yf(Bf),ba=Yf(!1),qm=Bf;function hv(t,e){var n=t.type.contextTypes;if(!n)return Bf;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var c={},l;for(l in n)c[l]=e[l];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=c),c}function wa(t){return t=t.childContextTypes,t!=null}function o1(){lr(ba),lr(Co)}function H9(t,e,n){if(Co.current!==Bf)throw Error(ct(168));Ji(Co,e),Ji(ba,n)}function XJ(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var c in r)if(!(c in e))throw Error(ct(108,She(t)||"Unknown",c));return Pr({},n,r)}function a1(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Bf,qm=Co.current,Ji(Co,t),Ji(ba,ba.current),!0}function $9(t,e,n){var r=t.stateNode;if(!r)throw Error(ct(169));n?(t=XJ(t,e,qm),r.__reactInternalMemoizedMergedChildContext=t,lr(ba),lr(Co),Ji(Co,t)):lr(ba),Ji(ba,n)}var bd=null,CN=!1,lj=!1;function JJ(t){bd===null?bd=[t]:bd.push(t)}function jfe(t){CN=!0,JJ(t)}function Xf(){if(!lj&&bd!==null){lj=!0;var t=0,e=yi;try{var n=bd;for(yi=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}bd=null,CN=!1}catch(c){throw bd!==null&&(bd=bd.slice(t+1)),TJ(wB,Xf),c}finally{yi=e,lj=!1}}return null}var DE=[],kE=0,c1=null,l1=0,Oc=[],Nc=0,Ym=null,Rd=1,Id="";function ym(t,e){DE[kE++]=l1,DE[kE++]=c1,c1=t,l1=e}function QJ(t,e,n){Oc[Nc++]=Rd,Oc[Nc++]=Id,Oc[Nc++]=Ym,Ym=t;var r=Rd;t=Id;var c=32-Sl(r)-1;r&=~(1<<c),n+=1;var l=32-Sl(e)+c;if(30<l){var d=c-c%5;l=(r&(1<<d)-1).toString(32),r>>=d,c-=d,Rd=1<<32-Sl(e)+c|n<<c|r,Id=l+t}else Rd=1<<l|n<<c|r,Id=t}function DB(t){t.return!==null&&(ym(t,1),QJ(t,1,0))}function kB(t){for(;t===c1;)c1=DE[--kE],DE[kE]=null,l1=DE[--kE],DE[kE]=null;for(;t===Ym;)Ym=Oc[--Nc],Oc[Nc]=null,Id=Oc[--Nc],Oc[Nc]=null,Rd=Oc[--Nc],Oc[Nc]=null}var nc=null,Qa=null,Tr=!1,gl=null;function ZJ(t,e){var n=Dc(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function z9(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,nc=t,Qa=Af(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,nc=t,Qa=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ym!==null?{id:Rd,overflow:Id}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Dc(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,nc=t,Qa=null,!0):!1;default:return!1}}function o3(t){return(t.mode&1)!==0&&(t.flags&128)===0}function a3(t){if(Tr){var e=Qa;if(e){var n=e;if(!z9(t,e)){if(o3(t))throw Error(ct(418));e=Af(n.nextSibling);var r=nc;e&&z9(t,e)?ZJ(r,n):(t.flags=t.flags&-4097|2,Tr=!1,nc=t)}}else{if(o3(t))throw Error(ct(418));t.flags=t.flags&-4097|2,Tr=!1,nc=t}}}function G9(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;nc=t}function PA(t){if(t!==nc)return!1;if(!Tr)return G9(t),Tr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!n3(t.type,t.memoizedProps)),e&&(e=Qa)){if(o3(t))throw eQ(),Error(ct(418));for(;e;)ZJ(t,e),e=Af(e.nextSibling)}if(G9(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ct(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Qa=Af(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Qa=null}}else Qa=nc?Af(t.stateNode.nextSibling):null;return!0}function eQ(){for(var t=Qa;t;)t=Af(t.nextSibling)}function fv(){Qa=nc=null,Tr=!1}function LB(t){gl===null?gl=[t]:gl.push(t)}var Ffe=Gd.ReactCurrentBatchConfig;function hl(t,e){if(t&&t.defaultProps){e=Pr({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var u1=Yf(null),d1=null,LE=null,MB=null;function UB(){MB=LE=d1=null}function jB(t){var e=u1.current;lr(u1),t._currentValue=e}function c3(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function XE(t,e){d1=t,MB=LE=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ta=!0),t.firstContext=null)}function Uc(t){var e=t._currentValue;if(MB!==t)if(t={context:t,memoizedValue:e,next:null},LE===null){if(d1===null)throw Error(ct(308));LE=t,d1.dependencies={lanes:0,firstContext:t}}else LE=LE.next=t;return e}var km=null;function FB(t){km===null?km=[t]:km.push(t)}function tQ(t,e,n,r){var c=e.interleaved;return c===null?(n.next=n,FB(e)):(n.next=c.next,c.next=n),e.interleaved=n,Fd(t,r)}function Fd(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var of=!1;function VB(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function nQ(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function xd(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Of(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ei&2){var c=r.pending;return c===null?e.next=e:(e.next=c.next,c.next=e),r.pending=e,Fd(t,n)}return c=r.interleaved,c===null?(e.next=e,FB(r)):(e.next=c.next,c.next=e),r.interleaved=e,Fd(t,n)}function TO(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,CB(t,n)}}function K9(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var c=null,l=null;if(n=n.firstBaseUpdate,n!==null){do{var d={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};l===null?c=l=d:l=l.next=d,n=n.next}while(n!==null);l===null?c=l=e:l=l.next=e}else c=l=e;n={baseState:r.baseState,firstBaseUpdate:c,lastBaseUpdate:l,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function h1(t,e,n,r){var c=t.updateQueue;of=!1;var l=c.firstBaseUpdate,d=c.lastBaseUpdate,f=c.shared.pending;if(f!==null){c.shared.pending=null;var m=f,E=m.next;m.next=null,d===null?l=E:d.next=E,d=m;var y=t.alternate;y!==null&&(y=y.updateQueue,f=y.lastBaseUpdate,f!==d&&(f===null?y.firstBaseUpdate=E:f.next=E,y.lastBaseUpdate=m))}if(l!==null){var w=c.baseState;d=0,y=E=m=null,f=l;do{var I=f.lane,P=f.eventTime;if((r&I)===I){y!==null&&(y=y.next={eventTime:P,lane:0,tag:f.tag,payload:f.payload,callback:f.callback,next:null});e:{var k=t,M=f;switch(I=e,P=n,M.tag){case 1:if(k=M.payload,typeof k=="function"){w=k.call(P,w,I);break e}w=k;break e;case 3:k.flags=k.flags&-65537|128;case 0:if(k=M.payload,I=typeof k=="function"?k.call(P,w,I):k,I==null)break e;w=Pr({},w,I);break e;case 2:of=!0}}f.callback!==null&&f.lane!==0&&(t.flags|=64,I=c.effects,I===null?c.effects=[f]:I.push(f))}else P={eventTime:P,lane:I,tag:f.tag,payload:f.payload,callback:f.callback,next:null},y===null?(E=y=P,m=w):y=y.next=P,d|=I;if(f=f.next,f===null){if(f=c.shared.pending,f===null)break;I=f,f=I.next,I.next=null,c.lastBaseUpdate=I,c.shared.pending=null}}while(1);if(y===null&&(m=w),c.baseState=m,c.firstBaseUpdate=E,c.lastBaseUpdate=y,e=c.shared.interleaved,e!==null){c=e;do d|=c.lane,c=c.next;while(c!==e)}else l===null&&(c.shared.lanes=0);Jm|=d,t.lanes=d,t.memoizedState=w}}function q9(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],c=r.callback;if(c!==null){if(r.callback=null,r=n,typeof c!="function")throw Error(ct(191,c));c.call(r)}}}var iQ=new tJ.Component().refs;function l3(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Pr({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var RN={isMounted:function(t){return(t=t._reactInternals)?hg(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Ho(),c=Pf(t),l=xd(r,c);l.payload=e,n!=null&&(l.callback=n),e=Of(t,l,c),e!==null&&(Tl(e,t,c,r),TO(e,t,c))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Ho(),c=Pf(t),l=xd(r,c);l.tag=1,l.payload=e,n!=null&&(l.callback=n),e=Of(t,l,c),e!==null&&(Tl(e,t,c,r),TO(e,t,c))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ho(),r=Pf(t),c=xd(n,r);c.tag=2,e!=null&&(c.callback=e),e=Of(t,c,r),e!==null&&(Tl(e,t,r,n),TO(e,t,r))}};function Y9(t,e,n,r,c,l,d){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,l,d):e.prototype&&e.prototype.isPureReactComponent?!jT(n,r)||!jT(c,l):!0}function rQ(t,e,n){var r=!1,c=Bf,l=e.contextType;return typeof l=="object"&&l!==null?l=Uc(l):(c=wa(e)?qm:Co.current,r=e.contextTypes,l=(r=r!=null)?hv(t,c):Bf),e=new e(n,l),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=RN,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=c,t.__reactInternalMemoizedMaskedChildContext=l),e}function X9(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&RN.enqueueReplaceState(e,e.state,null)}function u3(t,e,n,r){var c=t.stateNode;c.props=n,c.state=t.memoizedState,c.refs=iQ,VB(t);var l=e.contextType;typeof l=="object"&&l!==null?c.context=Uc(l):(l=wa(e)?qm:Co.current,c.context=hv(t,l)),c.state=t.memoizedState,l=e.getDerivedStateFromProps,typeof l=="function"&&(l3(t,e,l,n),c.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof c.getSnapshotBeforeUpdate=="function"||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(e=c.state,typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount(),e!==c.state&&RN.enqueueReplaceState(c,c.state,null),h1(t,n,c,r),c.state=t.memoizedState),typeof c.componentDidMount=="function"&&(t.flags|=4194308)}function NS(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ct(309));var r=n.stateNode}if(!r)throw Error(ct(147,t));var c=r,l=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===l?e.ref:(e=function(d){var f=c.refs;f===iQ&&(f=c.refs={}),d===null?delete f[l]:f[l]=d},e._stringRef=l,e)}if(typeof t!="string")throw Error(ct(284));if(!n._owner)throw Error(ct(290,t))}return t}function xA(t,e){throw t=Object.prototype.toString.call(e),Error(ct(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function J9(t){var e=t._init;return e(t._payload)}function sQ(t){function e(W,V){if(t){var G=W.deletions;G===null?(W.deletions=[V],W.flags|=16):G.push(V)}}function n(W,V){if(!t)return null;for(;V!==null;)e(W,V),V=V.sibling;return null}function r(W,V){for(W=new Map;V!==null;)V.key!==null?W.set(V.key,V):W.set(V.index,V),V=V.sibling;return W}function c(W,V){return W=xf(W,V),W.index=0,W.sibling=null,W}function l(W,V,G){return W.index=G,t?(G=W.alternate,G!==null?(G=G.index,G<V?(W.flags|=2,V):G):(W.flags|=2,V)):(W.flags|=1048576,V)}function d(W){return t&&W.alternate===null&&(W.flags|=2),W}function f(W,V,G,Q){return V===null||V.tag!==6?(V=gj(G,W.mode,Q),V.return=W,V):(V=c(V,G),V.return=W,V)}function m(W,V,G,Q){var Z=G.type;return Z===IE?y(W,V,G.props.children,Q,G.key):V!==null&&(V.elementType===Z||typeof Z=="object"&&Z!==null&&Z.$$typeof===sf&&J9(Z)===V.type)?(Q=c(V,G.props),Q.ref=NS(W,V,G),Q.return=W,Q):(Q=AO(G.type,G.key,G.props,null,W.mode,Q),Q.ref=NS(W,V,G),Q.return=W,Q)}function E(W,V,G,Q){return V===null||V.tag!==4||V.stateNode.containerInfo!==G.containerInfo||V.stateNode.implementation!==G.implementation?(V=_j(G,W.mode,Q),V.return=W,V):(V=c(V,G.children||[]),V.return=W,V)}function y(W,V,G,Q,Z){return V===null||V.tag!==7?(V=Wm(G,W.mode,Q,Z),V.return=W,V):(V=c(V,G),V.return=W,V)}function w(W,V,G){if(typeof V=="string"&&V!==""||typeof V=="number")return V=gj(""+V,W.mode,G),V.return=W,V;if(typeof V=="object"&&V!==null){switch(V.$$typeof){case SA:return G=AO(V.type,V.key,V.props,null,W.mode,G),G.ref=NS(W,null,V),G.return=W,G;case RE:return V=_j(V,W.mode,G),V.return=W,V;case sf:var Q=V._init;return w(W,Q(V._payload),G)}if(JS(V)||CS(V))return V=Wm(V,W.mode,G,null),V.return=W,V;xA(W,V)}return null}function I(W,V,G,Q){var Z=V!==null?V.key:null;if(typeof G=="string"&&G!==""||typeof G=="number")return Z!==null?null:f(W,V,""+G,Q);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case SA:return G.key===Z?m(W,V,G,Q):null;case RE:return G.key===Z?E(W,V,G,Q):null;case sf:return Z=G._init,I(W,V,Z(G._payload),Q)}if(JS(G)||CS(G))return Z!==null?null:y(W,V,G,Q,null);xA(W,G)}return null}function P(W,V,G,Q,Z){if(typeof Q=="string"&&Q!==""||typeof Q=="number")return W=W.get(G)||null,f(V,W,""+Q,Z);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case SA:return W=W.get(Q.key===null?G:Q.key)||null,m(V,W,Q,Z);case RE:return W=W.get(Q.key===null?G:Q.key)||null,E(V,W,Q,Z);case sf:var Y=Q._init;return P(W,V,G,Y(Q._payload),Z)}if(JS(Q)||CS(Q))return W=W.get(G)||null,y(V,W,Q,Z,null);xA(V,Q)}return null}function k(W,V,G,Q){for(var Z=null,Y=null,oe=V,ce=V=0,Se=null;oe!==null&&ce<G.length;ce++){oe.index>ce?(Se=oe,oe=null):Se=oe.sibling;var xe=I(W,oe,G[ce],Q);if(xe===null){oe===null&&(oe=Se);break}t&&oe&&xe.alternate===null&&e(W,oe),V=l(xe,V,ce),Y===null?Z=xe:Y.sibling=xe,Y=xe,oe=Se}if(ce===G.length)return n(W,oe),Tr&&ym(W,ce),Z;if(oe===null){for(;ce<G.length;ce++)oe=w(W,G[ce],Q),oe!==null&&(V=l(oe,V,ce),Y===null?Z=oe:Y.sibling=oe,Y=oe);return Tr&&ym(W,ce),Z}for(oe=r(W,oe);ce<G.length;ce++)Se=P(oe,W,ce,G[ce],Q),Se!==null&&(t&&Se.alternate!==null&&oe.delete(Se.key===null?ce:Se.key),V=l(Se,V,ce),Y===null?Z=Se:Y.sibling=Se,Y=Se);return t&&oe.forEach(function(je){return e(W,je)}),Tr&&ym(W,ce),Z}function M(W,V,G,Q){var Z=CS(G);if(typeof Z!="function")throw Error(ct(150));if(G=Z.call(G),G==null)throw Error(ct(151));for(var Y=Z=null,oe=V,ce=V=0,Se=null,xe=G.next();oe!==null&&!xe.done;ce++,xe=G.next()){oe.index>ce?(Se=oe,oe=null):Se=oe.sibling;var je=I(W,oe,xe.value,Q);if(je===null){oe===null&&(oe=Se);break}t&&oe&&je.alternate===null&&e(W,oe),V=l(je,V,ce),Y===null?Z=je:Y.sibling=je,Y=je,oe=Se}if(xe.done)return n(W,oe),Tr&&ym(W,ce),Z;if(oe===null){for(;!xe.done;ce++,xe=G.next())xe=w(W,xe.value,Q),xe!==null&&(V=l(xe,V,ce),Y===null?Z=xe:Y.sibling=xe,Y=xe);return Tr&&ym(W,ce),Z}for(oe=r(W,oe);!xe.done;ce++,xe=G.next())xe=P(oe,W,ce,xe.value,Q),xe!==null&&(t&&xe.alternate!==null&&oe.delete(xe.key===null?ce:xe.key),V=l(xe,V,ce),Y===null?Z=xe:Y.sibling=xe,Y=xe);return t&&oe.forEach(function(Ge){return e(W,Ge)}),Tr&&ym(W,ce),Z}function K(W,V,G,Q){if(typeof G=="object"&&G!==null&&G.type===IE&&G.key===null&&(G=G.props.children),typeof G=="object"&&G!==null){switch(G.$$typeof){case SA:e:{for(var Z=G.key,Y=V;Y!==null;){if(Y.key===Z){if(Z=G.type,Z===IE){if(Y.tag===7){n(W,Y.sibling),V=c(Y,G.props.children),V.return=W,W=V;break e}}else if(Y.elementType===Z||typeof Z=="object"&&Z!==null&&Z.$$typeof===sf&&J9(Z)===Y.type){n(W,Y.sibling),V=c(Y,G.props),V.ref=NS(W,Y,G),V.return=W,W=V;break e}n(W,Y);break}else e(W,Y);Y=Y.sibling}G.type===IE?(V=Wm(G.props.children,W.mode,Q,G.key),V.return=W,W=V):(Q=AO(G.type,G.key,G.props,null,W.mode,Q),Q.ref=NS(W,V,G),Q.return=W,W=Q)}return d(W);case RE:e:{for(Y=G.key;V!==null;){if(V.key===Y)if(V.tag===4&&V.stateNode.containerInfo===G.containerInfo&&V.stateNode.implementation===G.implementation){n(W,V.sibling),V=c(V,G.children||[]),V.return=W,W=V;break e}else{n(W,V);break}else e(W,V);V=V.sibling}V=_j(G,W.mode,Q),V.return=W,W=V}return d(W);case sf:return Y=G._init,K(W,V,Y(G._payload),Q)}if(JS(G))return k(W,V,G,Q);if(CS(G))return M(W,V,G,Q);xA(W,G)}return typeof G=="string"&&G!==""||typeof G=="number"?(G=""+G,V!==null&&V.tag===6?(n(W,V.sibling),V=c(V,G),V.return=W,W=V):(n(W,V),V=gj(G,W.mode,Q),V.return=W,W=V),d(W)):n(W,V)}return K}var pv=sQ(!0),oQ=sQ(!1),bb={},Eu=Yf(bb),WT=Yf(bb),HT=Yf(bb);function Lm(t){if(t===bb)throw Error(ct(174));return t}function BB(t,e){switch(Ji(HT,e),Ji(WT,t),Ji(Eu,bb),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:WF(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=WF(e,t)}lr(Eu),Ji(Eu,e)}function mv(){lr(Eu),lr(WT),lr(HT)}function aQ(t){Lm(HT.current);var e=Lm(Eu.current),n=WF(e,t.type);e!==n&&(Ji(WT,t),Ji(Eu,n))}function WB(t){WT.current===t&&(lr(Eu),lr(WT))}var Ar=Yf(0);function f1(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var uj=[];function HB(){for(var t=0;t<uj.length;t++)uj[t]._workInProgressVersionPrimary=null;uj.length=0}var bO=Gd.ReactCurrentDispatcher,dj=Gd.ReactCurrentBatchConfig,Xm=0,Nr=null,gs=null,Ds=null,p1=!1,pT=!1,$T=0,Vfe=0;function go(){throw Error(ct(321))}function $B(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!bl(t[n],e[n]))return!1;return!0}function zB(t,e,n,r,c,l){if(Xm=l,Nr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,bO.current=t===null||t.memoizedState===null?$fe:zfe,t=n(r,c),pT){l=0;do{if(pT=!1,$T=0,25<=l)throw Error(ct(301));l+=1,Ds=gs=null,e.updateQueue=null,bO.current=Gfe,t=n(r,c)}while(pT)}if(bO.current=m1,e=gs!==null&&gs.next!==null,Xm=0,Ds=gs=Nr=null,p1=!1,e)throw Error(ct(300));return t}function GB(){var t=$T!==0;return $T=0,t}function hu(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ds===null?Nr.memoizedState=Ds=t:Ds=Ds.next=t,Ds}function jc(){if(gs===null){var t=Nr.alternate;t=t!==null?t.memoizedState:null}else t=gs.next;var e=Ds===null?Nr.memoizedState:Ds.next;if(e!==null)Ds=e,gs=t;else{if(t===null)throw Error(ct(310));gs=t,t={memoizedState:gs.memoizedState,baseState:gs.baseState,baseQueue:gs.baseQueue,queue:gs.queue,next:null},Ds===null?Nr.memoizedState=Ds=t:Ds=Ds.next=t}return Ds}function zT(t,e){return typeof e=="function"?e(t):e}function hj(t){var e=jc(),n=e.queue;if(n===null)throw Error(ct(311));n.lastRenderedReducer=t;var r=gs,c=r.baseQueue,l=n.pending;if(l!==null){if(c!==null){var d=c.next;c.next=l.next,l.next=d}r.baseQueue=c=l,n.pending=null}if(c!==null){l=c.next,r=r.baseState;var f=d=null,m=null,E=l;do{var y=E.lane;if((Xm&y)===y)m!==null&&(m=m.next={lane:0,action:E.action,hasEagerState:E.hasEagerState,eagerState:E.eagerState,next:null}),r=E.hasEagerState?E.eagerState:t(r,E.action);else{var w={lane:y,action:E.action,hasEagerState:E.hasEagerState,eagerState:E.eagerState,next:null};m===null?(f=m=w,d=r):m=m.next=w,Nr.lanes|=y,Jm|=y}E=E.next}while(E!==null&&E!==l);m===null?d=r:m.next=f,bl(r,e.memoizedState)||(Ta=!0),e.memoizedState=r,e.baseState=d,e.baseQueue=m,n.lastRenderedState=r}if(t=n.interleaved,t!==null){c=t;do l=c.lane,Nr.lanes|=l,Jm|=l,c=c.next;while(c!==t)}else c===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function fj(t){var e=jc(),n=e.queue;if(n===null)throw Error(ct(311));n.lastRenderedReducer=t;var r=n.dispatch,c=n.pending,l=e.memoizedState;if(c!==null){n.pending=null;var d=c=c.next;do l=t(l,d.action),d=d.next;while(d!==c);bl(l,e.memoizedState)||(Ta=!0),e.memoizedState=l,e.baseQueue===null&&(e.baseState=l),n.lastRenderedState=l}return[l,r]}function cQ(){}function lQ(t,e){var n=Nr,r=jc(),c=e(),l=!bl(r.memoizedState,c);if(l&&(r.memoizedState=c,Ta=!0),r=r.queue,KB(hQ.bind(null,n,r,t),[t]),r.getSnapshot!==e||l||Ds!==null&&Ds.memoizedState.tag&1){if(n.flags|=2048,GT(9,dQ.bind(null,n,r,c,e),void 0,null),ks===null)throw Error(ct(349));Xm&30||uQ(n,e,c)}return c}function uQ(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Nr.updateQueue,e===null?(e={lastEffect:null,stores:null},Nr.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function dQ(t,e,n,r){e.value=n,e.getSnapshot=r,fQ(e)&&pQ(t)}function hQ(t,e,n){return n(function(){fQ(e)&&pQ(t)})}function fQ(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!bl(t,n)}catch{return!0}}function pQ(t){var e=Fd(t,1);e!==null&&Tl(e,t,1,-1)}function Q9(t){var e=hu();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:zT,lastRenderedState:t},e.queue=t,t=t.dispatch=Hfe.bind(null,Nr,t),[e.memoizedState,t]}function GT(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Nr.updateQueue,e===null?(e={lastEffect:null,stores:null},Nr.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function mQ(){return jc().memoizedState}function wO(t,e,n,r){var c=hu();Nr.flags|=t,c.memoizedState=GT(1|e,n,void 0,r===void 0?null:r)}function IN(t,e,n,r){var c=jc();r=r===void 0?null:r;var l=void 0;if(gs!==null){var d=gs.memoizedState;if(l=d.destroy,r!==null&&$B(r,d.deps)){c.memoizedState=GT(e,n,l,r);return}}Nr.flags|=t,c.memoizedState=GT(1|e,n,l,r)}function Z9(t,e){return wO(8390656,8,t,e)}function KB(t,e){return IN(2048,8,t,e)}function gQ(t,e){return IN(4,2,t,e)}function _Q(t,e){return IN(4,4,t,e)}function EQ(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function vQ(t,e,n){return n=n!=null?n.concat([t]):null,IN(4,4,EQ.bind(null,e,t),n)}function qB(){}function yQ(t,e){var n=jc();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&$B(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function SQ(t,e){var n=jc();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&$B(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function TQ(t,e,n){return Xm&21?(bl(n,e)||(n=CJ(),Nr.lanes|=n,Jm|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ta=!0),t.memoizedState=n)}function Bfe(t,e){var n=yi;yi=n!==0&&4>n?n:4,t(!0);var r=dj.transition;dj.transition={};try{t(!1),e()}finally{yi=n,dj.transition=r}}function bQ(){return jc().memoizedState}function Wfe(t,e,n){var r=Pf(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},wQ(t))CQ(e,n);else if(n=tQ(t,e,n,r),n!==null){var c=Ho();Tl(n,t,r,c),RQ(n,e,r)}}function Hfe(t,e,n){var r=Pf(t),c={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(wQ(t))CQ(e,c);else{var l=t.alternate;if(t.lanes===0&&(l===null||l.lanes===0)&&(l=e.lastRenderedReducer,l!==null))try{var d=e.lastRenderedState,f=l(d,n);if(c.hasEagerState=!0,c.eagerState=f,bl(f,d)){var m=e.interleaved;m===null?(c.next=c,FB(e)):(c.next=m.next,m.next=c),e.interleaved=c;return}}catch{}finally{}n=tQ(t,e,c,r),n!==null&&(c=Ho(),Tl(n,t,r,c),RQ(n,e,r))}}function wQ(t){var e=t.alternate;return t===Nr||e!==null&&e===Nr}function CQ(t,e){pT=p1=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function RQ(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,CB(t,n)}}var m1={readContext:Uc,useCallback:go,useContext:go,useEffect:go,useImperativeHandle:go,useInsertionEffect:go,useLayoutEffect:go,useMemo:go,useReducer:go,useRef:go,useState:go,useDebugValue:go,useDeferredValue:go,useTransition:go,useMutableSource:go,useSyncExternalStore:go,useId:go,unstable_isNewReconciler:!1},$fe={readContext:Uc,useCallback:function(t,e){return hu().memoizedState=[t,e===void 0?null:e],t},useContext:Uc,useEffect:Z9,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,wO(4194308,4,EQ.bind(null,e,t),n)},useLayoutEffect:function(t,e){return wO(4194308,4,t,e)},useInsertionEffect:function(t,e){return wO(4,2,t,e)},useMemo:function(t,e){var n=hu();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=hu();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Wfe.bind(null,Nr,t),[r.memoizedState,t]},useRef:function(t){var e=hu();return t={current:t},e.memoizedState=t},useState:Q9,useDebugValue:qB,useDeferredValue:function(t){return hu().memoizedState=t},useTransition:function(){var t=Q9(!1),e=t[0];return t=Bfe.bind(null,t[1]),hu().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Nr,c=hu();if(Tr){if(n===void 0)throw Error(ct(407));n=n()}else{if(n=e(),ks===null)throw Error(ct(349));Xm&30||uQ(r,e,n)}c.memoizedState=n;var l={value:n,getSnapshot:e};return c.queue=l,Z9(hQ.bind(null,r,l,t),[t]),r.flags|=2048,GT(9,dQ.bind(null,r,l,n,e),void 0,null),n},useId:function(){var t=hu(),e=ks.identifierPrefix;if(Tr){var n=Id,r=Rd;n=(r&~(1<<32-Sl(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=$T++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Vfe++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},zfe={readContext:Uc,useCallback:yQ,useContext:Uc,useEffect:KB,useImperativeHandle:vQ,useInsertionEffect:gQ,useLayoutEffect:_Q,useMemo:SQ,useReducer:hj,useRef:mQ,useState:function(){return hj(zT)},useDebugValue:qB,useDeferredValue:function(t){var e=jc();return TQ(e,gs.memoizedState,t)},useTransition:function(){var t=hj(zT)[0],e=jc().memoizedState;return[t,e]},useMutableSource:cQ,useSyncExternalStore:lQ,useId:bQ,unstable_isNewReconciler:!1},Gfe={readContext:Uc,useCallback:yQ,useContext:Uc,useEffect:KB,useImperativeHandle:vQ,useInsertionEffect:gQ,useLayoutEffect:_Q,useMemo:SQ,useReducer:fj,useRef:mQ,useState:function(){return fj(zT)},useDebugValue:qB,useDeferredValue:function(t){var e=jc();return gs===null?e.memoizedState=t:TQ(e,gs.memoizedState,t)},useTransition:function(){var t=fj(zT)[0],e=jc().memoizedState;return[t,e]},useMutableSource:cQ,useSyncExternalStore:lQ,useId:bQ,unstable_isNewReconciler:!1};function gv(t,e){try{var n="",r=e;do n+=yhe(r),r=r.return;while(r);var c=n}catch(l){c=`
Error generating stack: `+l.message+`
`+l.stack}return{value:t,source:e,stack:c,digest:null}}function pj(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function d3(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Kfe=typeof WeakMap=="function"?WeakMap:Map;function IQ(t,e,n){n=xd(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){_1||(_1=!0,S3=r),d3(t,e)},n}function AQ(t,e,n){n=xd(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var c=e.value;n.payload=function(){return r(c)},n.callback=function(){d3(t,e)}}var l=t.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(n.callback=function(){d3(t,e),typeof r!="function"&&(Nf===null?Nf=new Set([this]):Nf.add(this));var d=e.stack;this.componentDidCatch(e.value,{componentStack:d!==null?d:""})}),n}function ez(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Kfe;var c=new Set;r.set(e,c)}else c=r.get(e),c===void 0&&(c=new Set,r.set(e,c));c.has(n)||(c.add(n),t=ape.bind(null,t,e,n),e.then(t,t))}function tz(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function nz(t,e,n,r,c){return t.mode&1?(t.flags|=65536,t.lanes=c,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=xd(-1,1),e.tag=2,Of(n,e,1))),n.lanes|=1),t)}var qfe=Gd.ReactCurrentOwner,Ta=!1;function Wo(t,e,n,r){e.child=t===null?oQ(e,null,n,r):pv(e,t.child,n,r)}function iz(t,e,n,r,c){n=n.render;var l=e.ref;return XE(e,c),r=zB(t,e,n,r,l,c),n=GB(),t!==null&&!Ta?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~c,Vd(t,e,c)):(Tr&&n&&DB(e),e.flags|=1,Wo(t,e,r,c),e.child)}function rz(t,e,n,r,c){if(t===null){var l=n.type;return typeof l=="function"&&!n4(l)&&l.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=l,OQ(t,e,l,r,c)):(t=AO(n.type,null,r,e,e.mode,c),t.ref=e.ref,t.return=e,e.child=t)}if(l=t.child,!(t.lanes&c)){var d=l.memoizedProps;if(n=n.compare,n=n!==null?n:jT,n(d,r)&&t.ref===e.ref)return Vd(t,e,c)}return e.flags|=1,t=xf(l,r),t.ref=e.ref,t.return=e,e.child=t}function OQ(t,e,n,r,c){if(t!==null){var l=t.memoizedProps;if(jT(l,r)&&t.ref===e.ref)if(Ta=!1,e.pendingProps=r=l,(t.lanes&c)!==0)t.flags&131072&&(Ta=!0);else return e.lanes=t.lanes,Vd(t,e,c)}return h3(t,e,n,r,c)}function NQ(t,e,n){var r=e.pendingProps,c=r.children,l=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ji(UE,Ja),Ja|=n;else{if(!(n&1073741824))return t=l!==null?l.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ji(UE,Ja),Ja|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=l!==null?l.baseLanes:n,Ji(UE,Ja),Ja|=r}else l!==null?(r=l.baseLanes|n,e.memoizedState=null):r=n,Ji(UE,Ja),Ja|=r;return Wo(t,e,c,n),e.child}function PQ(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function h3(t,e,n,r,c){var l=wa(n)?qm:Co.current;return l=hv(e,l),XE(e,c),n=zB(t,e,n,r,l,c),r=GB(),t!==null&&!Ta?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~c,Vd(t,e,c)):(Tr&&r&&DB(e),e.flags|=1,Wo(t,e,n,c),e.child)}function sz(t,e,n,r,c){if(wa(n)){var l=!0;a1(e)}else l=!1;if(XE(e,c),e.stateNode===null)CO(t,e),rQ(e,n,r),u3(e,n,r,c),r=!0;else if(t===null){var d=e.stateNode,f=e.memoizedProps;d.props=f;var m=d.context,E=n.contextType;typeof E=="object"&&E!==null?E=Uc(E):(E=wa(n)?qm:Co.current,E=hv(e,E));var y=n.getDerivedStateFromProps,w=typeof y=="function"||typeof d.getSnapshotBeforeUpdate=="function";w||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(f!==r||m!==E)&&X9(e,d,r,E),of=!1;var I=e.memoizedState;d.state=I,h1(e,r,d,c),m=e.memoizedState,f!==r||I!==m||ba.current||of?(typeof y=="function"&&(l3(e,n,y,r),m=e.memoizedState),(f=of||Y9(e,n,f,r,I,m,E))?(w||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(e.flags|=4194308)):(typeof d.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=m),d.props=r,d.state=m,d.context=E,r=f):(typeof d.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{d=e.stateNode,nQ(t,e),f=e.memoizedProps,E=e.type===e.elementType?f:hl(e.type,f),d.props=E,w=e.pendingProps,I=d.context,m=n.contextType,typeof m=="object"&&m!==null?m=Uc(m):(m=wa(n)?qm:Co.current,m=hv(e,m));var P=n.getDerivedStateFromProps;(y=typeof P=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(f!==w||I!==m)&&X9(e,d,r,m),of=!1,I=e.memoizedState,d.state=I,h1(e,r,d,c);var k=e.memoizedState;f!==w||I!==k||ba.current||of?(typeof P=="function"&&(l3(e,n,P,r),k=e.memoizedState),(E=of||Y9(e,n,E,r,I,k,m)||!1)?(y||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(r,k,m),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(r,k,m)),typeof d.componentDidUpdate=="function"&&(e.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof d.componentDidUpdate!="function"||f===t.memoizedProps&&I===t.memoizedState||(e.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||f===t.memoizedProps&&I===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=k),d.props=r,d.state=k,d.context=m,r=E):(typeof d.componentDidUpdate!="function"||f===t.memoizedProps&&I===t.memoizedState||(e.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||f===t.memoizedProps&&I===t.memoizedState||(e.flags|=1024),r=!1)}return f3(t,e,n,r,l,c)}function f3(t,e,n,r,c,l){PQ(t,e);var d=(e.flags&128)!==0;if(!r&&!d)return c&&$9(e,n,!1),Vd(t,e,l);r=e.stateNode,qfe.current=e;var f=d&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&d?(e.child=pv(e,t.child,null,l),e.child=pv(e,null,f,l)):Wo(t,e,f,l),e.memoizedState=r.state,c&&$9(e,n,!0),e.child}function xQ(t){var e=t.stateNode;e.pendingContext?H9(t,e.pendingContext,e.pendingContext!==e.context):e.context&&H9(t,e.context,!1),BB(t,e.containerInfo)}function oz(t,e,n,r,c){return fv(),LB(c),e.flags|=256,Wo(t,e,n,r),e.child}var p3={dehydrated:null,treeContext:null,retryLane:0};function m3(t){return{baseLanes:t,cachePool:null,transitions:null}}function DQ(t,e,n){var r=e.pendingProps,c=Ar.current,l=!1,d=(e.flags&128)!==0,f;if((f=d)||(f=t!==null&&t.memoizedState===null?!1:(c&2)!==0),f?(l=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(c|=1),Ji(Ar,c&1),t===null)return a3(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(d=r.children,t=r.fallback,l?(r=e.mode,l=e.child,d={mode:"hidden",children:d},!(r&1)&&l!==null?(l.childLanes=0,l.pendingProps=d):l=NN(d,r,0,null),t=Wm(t,r,n,null),l.return=e,t.return=e,l.sibling=t,e.child=l,e.child.memoizedState=m3(n),e.memoizedState=p3,t):YB(e,d));if(c=t.memoizedState,c!==null&&(f=c.dehydrated,f!==null))return Yfe(t,e,d,r,f,c,n);if(l){l=r.fallback,d=e.mode,c=t.child,f=c.sibling;var m={mode:"hidden",children:r.children};return!(d&1)&&e.child!==c?(r=e.child,r.childLanes=0,r.pendingProps=m,e.deletions=null):(r=xf(c,m),r.subtreeFlags=c.subtreeFlags&14680064),f!==null?l=xf(f,l):(l=Wm(l,d,n,null),l.flags|=2),l.return=e,r.return=e,r.sibling=l,e.child=r,r=l,l=e.child,d=t.child.memoizedState,d=d===null?m3(n):{baseLanes:d.baseLanes|n,cachePool:null,transitions:d.transitions},l.memoizedState=d,l.childLanes=t.childLanes&~n,e.memoizedState=p3,r}return l=t.child,t=l.sibling,r=xf(l,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function YB(t,e){return e=NN({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function DA(t,e,n,r){return r!==null&&LB(r),pv(e,t.child,null,n),t=YB(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Yfe(t,e,n,r,c,l,d){if(n)return e.flags&256?(e.flags&=-257,r=pj(Error(ct(422))),DA(t,e,d,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(l=r.fallback,c=e.mode,r=NN({mode:"visible",children:r.children},c,0,null),l=Wm(l,c,d,null),l.flags|=2,r.return=e,l.return=e,r.sibling=l,e.child=r,e.mode&1&&pv(e,t.child,null,d),e.child.memoizedState=m3(d),e.memoizedState=p3,l);if(!(e.mode&1))return DA(t,e,d,null);if(c.data==="$!"){if(r=c.nextSibling&&c.nextSibling.dataset,r)var f=r.dgst;return r=f,l=Error(ct(419)),r=pj(l,r,void 0),DA(t,e,d,r)}if(f=(d&t.childLanes)!==0,Ta||f){if(r=ks,r!==null){switch(d&-d){case 4:c=2;break;case 16:c=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:c=32;break;case 536870912:c=268435456;break;default:c=0}c=c&(r.suspendedLanes|d)?0:c,c!==0&&c!==l.retryLane&&(l.retryLane=c,Fd(t,c),Tl(r,t,c,-1))}return t4(),r=pj(Error(ct(421))),DA(t,e,d,r)}return c.data==="$?"?(e.flags|=128,e.child=t.child,e=cpe.bind(null,t),c._reactRetry=e,null):(t=l.treeContext,Qa=Af(c.nextSibling),nc=e,Tr=!0,gl=null,t!==null&&(Oc[Nc++]=Rd,Oc[Nc++]=Id,Oc[Nc++]=Ym,Rd=t.id,Id=t.overflow,Ym=e),e=YB(e,r.children),e.flags|=4096,e)}function az(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),c3(t.return,e,n)}function mj(t,e,n,r,c){var l=t.memoizedState;l===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:c}:(l.isBackwards=e,l.rendering=null,l.renderingStartTime=0,l.last=r,l.tail=n,l.tailMode=c)}function kQ(t,e,n){var r=e.pendingProps,c=r.revealOrder,l=r.tail;if(Wo(t,e,r.children,n),r=Ar.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&az(t,n,e);else if(t.tag===19)az(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ji(Ar,r),!(e.mode&1))e.memoizedState=null;else switch(c){case"forwards":for(n=e.child,c=null;n!==null;)t=n.alternate,t!==null&&f1(t)===null&&(c=n),n=n.sibling;n=c,n===null?(c=e.child,e.child=null):(c=n.sibling,n.sibling=null),mj(e,!1,c,n,l);break;case"backwards":for(n=null,c=e.child,e.child=null;c!==null;){if(t=c.alternate,t!==null&&f1(t)===null){e.child=c;break}t=c.sibling,c.sibling=n,n=c,c=t}mj(e,!0,n,null,l);break;case"together":mj(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function CO(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Vd(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Jm|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ct(153));if(e.child!==null){for(t=e.child,n=xf(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=xf(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Xfe(t,e,n){switch(e.tag){case 3:xQ(e),fv();break;case 5:aQ(e);break;case 1:wa(e.type)&&a1(e);break;case 4:BB(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,c=e.memoizedProps.value;Ji(u1,r._currentValue),r._currentValue=c;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ji(Ar,Ar.current&1),e.flags|=128,null):n&e.child.childLanes?DQ(t,e,n):(Ji(Ar,Ar.current&1),t=Vd(t,e,n),t!==null?t.sibling:null);Ji(Ar,Ar.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return kQ(t,e,n);e.flags|=128}if(c=e.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),Ji(Ar,Ar.current),r)break;return null;case 22:case 23:return e.lanes=0,NQ(t,e,n)}return Vd(t,e,n)}var LQ,g3,MQ,UQ;LQ=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};g3=function(){};MQ=function(t,e,n,r){var c=t.memoizedProps;if(c!==r){t=e.stateNode,Lm(Eu.current);var l=null;switch(n){case"input":c=jF(t,c),r=jF(t,r),l=[];break;case"select":c=Pr({},c,{value:void 0}),r=Pr({},r,{value:void 0}),l=[];break;case"textarea":c=BF(t,c),r=BF(t,r),l=[];break;default:typeof c.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=s1)}HF(n,r);var d;n=null;for(E in c)if(!r.hasOwnProperty(E)&&c.hasOwnProperty(E)&&c[E]!=null)if(E==="style"){var f=c[E];for(d in f)f.hasOwnProperty(d)&&(n||(n={}),n[d]="")}else E!=="dangerouslySetInnerHTML"&&E!=="children"&&E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&E!=="autoFocus"&&(PT.hasOwnProperty(E)?l||(l=[]):(l=l||[]).push(E,null));for(E in r){var m=r[E];if(f=c!=null?c[E]:void 0,r.hasOwnProperty(E)&&m!==f&&(m!=null||f!=null))if(E==="style")if(f){for(d in f)!f.hasOwnProperty(d)||m&&m.hasOwnProperty(d)||(n||(n={}),n[d]="");for(d in m)m.hasOwnProperty(d)&&f[d]!==m[d]&&(n||(n={}),n[d]=m[d])}else n||(l||(l=[]),l.push(E,n)),n=m;else E==="dangerouslySetInnerHTML"?(m=m?m.__html:void 0,f=f?f.__html:void 0,m!=null&&f!==m&&(l=l||[]).push(E,m)):E==="children"?typeof m!="string"&&typeof m!="number"||(l=l||[]).push(E,""+m):E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&(PT.hasOwnProperty(E)?(m!=null&&E==="onScroll"&&or("scroll",t),l||f===m||(l=[])):(l=l||[]).push(E,m))}n&&(l=l||[]).push("style",n);var E=l;(e.updateQueue=E)&&(e.flags|=4)}};UQ=function(t,e,n,r){n!==r&&(e.flags|=4)};function PS(t,e){if(!Tr)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function _o(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var c=t.child;c!==null;)n|=c.lanes|c.childLanes,r|=c.subtreeFlags&14680064,r|=c.flags&14680064,c.return=t,c=c.sibling;else for(c=t.child;c!==null;)n|=c.lanes|c.childLanes,r|=c.subtreeFlags,r|=c.flags,c.return=t,c=c.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Jfe(t,e,n){var r=e.pendingProps;switch(kB(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _o(e),null;case 1:return wa(e.type)&&o1(),_o(e),null;case 3:return r=e.stateNode,mv(),lr(ba),lr(Co),HB(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(PA(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,gl!==null&&(w3(gl),gl=null))),g3(t,e),_o(e),null;case 5:WB(e);var c=Lm(HT.current);if(n=e.type,t!==null&&e.stateNode!=null)MQ(t,e,n,r,c),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ct(166));return _o(e),null}if(t=Lm(Eu.current),PA(e)){r=e.stateNode,n=e.type;var l=e.memoizedProps;switch(r[mu]=e,r[BT]=l,t=(e.mode&1)!==0,n){case"dialog":or("cancel",r),or("close",r);break;case"iframe":case"object":case"embed":or("load",r);break;case"video":case"audio":for(c=0;c<ZS.length;c++)or(ZS[c],r);break;case"source":or("error",r);break;case"img":case"image":case"link":or("error",r),or("load",r);break;case"details":or("toggle",r);break;case"input":g9(r,l),or("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!l.multiple},or("invalid",r);break;case"textarea":E9(r,l),or("invalid",r)}HF(n,l),c=null;for(var d in l)if(l.hasOwnProperty(d)){var f=l[d];d==="children"?typeof f=="string"?r.textContent!==f&&(l.suppressHydrationWarning!==!0&&NA(r.textContent,f,t),c=["children",f]):typeof f=="number"&&r.textContent!==""+f&&(l.suppressHydrationWarning!==!0&&NA(r.textContent,f,t),c=["children",""+f]):PT.hasOwnProperty(d)&&f!=null&&d==="onScroll"&&or("scroll",r)}switch(n){case"input":TA(r),_9(r,l,!0);break;case"textarea":TA(r),v9(r);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(r.onclick=s1)}r=c,e.updateQueue=r,r!==null&&(e.flags|=4)}else{d=c.nodeType===9?c:c.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=uJ(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=d.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=d.createElement(n,{is:r.is}):(t=d.createElement(n),n==="select"&&(d=t,r.multiple?d.multiple=!0:r.size&&(d.size=r.size))):t=d.createElementNS(t,n),t[mu]=e,t[BT]=r,LQ(t,e,!1,!1),e.stateNode=t;e:{switch(d=$F(n,r),n){case"dialog":or("cancel",t),or("close",t),c=r;break;case"iframe":case"object":case"embed":or("load",t),c=r;break;case"video":case"audio":for(c=0;c<ZS.length;c++)or(ZS[c],t);c=r;break;case"source":or("error",t),c=r;break;case"img":case"image":case"link":or("error",t),or("load",t),c=r;break;case"details":or("toggle",t),c=r;break;case"input":g9(t,r),c=jF(t,r),or("invalid",t);break;case"option":c=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},c=Pr({},r,{value:void 0}),or("invalid",t);break;case"textarea":E9(t,r),c=BF(t,r),or("invalid",t);break;default:c=r}HF(n,c),f=c;for(l in f)if(f.hasOwnProperty(l)){var m=f[l];l==="style"?fJ(t,m):l==="dangerouslySetInnerHTML"?(m=m?m.__html:void 0,m!=null&&dJ(t,m)):l==="children"?typeof m=="string"?(n!=="textarea"||m!=="")&&xT(t,m):typeof m=="number"&&xT(t,""+m):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(PT.hasOwnProperty(l)?m!=null&&l==="onScroll"&&or("scroll",t):m!=null&&vB(t,l,m,d))}switch(n){case"input":TA(t),_9(t,r,!1);break;case"textarea":TA(t),v9(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Vf(r.value));break;case"select":t.multiple=!!r.multiple,l=r.value,l!=null?GE(t,!!r.multiple,l,!1):r.defaultValue!=null&&GE(t,!!r.multiple,r.defaultValue,!0);break;default:typeof c.onClick=="function"&&(t.onclick=s1)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return _o(e),null;case 6:if(t&&e.stateNode!=null)UQ(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ct(166));if(n=Lm(HT.current),Lm(Eu.current),PA(e)){if(r=e.stateNode,n=e.memoizedProps,r[mu]=e,(l=r.nodeValue!==n)&&(t=nc,t!==null))switch(t.tag){case 3:NA(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&NA(r.nodeValue,n,(t.mode&1)!==0)}l&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[mu]=e,e.stateNode=r}return _o(e),null;case 13:if(lr(Ar),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Tr&&Qa!==null&&e.mode&1&&!(e.flags&128))eQ(),fv(),e.flags|=98560,l=!1;else if(l=PA(e),r!==null&&r.dehydrated!==null){if(t===null){if(!l)throw Error(ct(318));if(l=e.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(ct(317));l[mu]=e}else fv(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;_o(e),l=!1}else gl!==null&&(w3(gl),gl=null),l=!0;if(!l)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ar.current&1?_s===0&&(_s=3):t4())),e.updateQueue!==null&&(e.flags|=4),_o(e),null);case 4:return mv(),g3(t,e),t===null&&FT(e.stateNode.containerInfo),_o(e),null;case 10:return jB(e.type._context),_o(e),null;case 17:return wa(e.type)&&o1(),_o(e),null;case 19:if(lr(Ar),l=e.memoizedState,l===null)return _o(e),null;if(r=(e.flags&128)!==0,d=l.rendering,d===null)if(r)PS(l,!1);else{if(_s!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(d=f1(t),d!==null){for(e.flags|=128,PS(l,!1),r=d.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)l=n,t=r,l.flags&=14680066,d=l.alternate,d===null?(l.childLanes=0,l.lanes=t,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=d.childLanes,l.lanes=d.lanes,l.child=d.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=d.memoizedProps,l.memoizedState=d.memoizedState,l.updateQueue=d.updateQueue,l.type=d.type,t=d.dependencies,l.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ji(Ar,Ar.current&1|2),e.child}t=t.sibling}l.tail!==null&&zr()>_v&&(e.flags|=128,r=!0,PS(l,!1),e.lanes=4194304)}else{if(!r)if(t=f1(d),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),PS(l,!0),l.tail===null&&l.tailMode==="hidden"&&!d.alternate&&!Tr)return _o(e),null}else 2*zr()-l.renderingStartTime>_v&&n!==1073741824&&(e.flags|=128,r=!0,PS(l,!1),e.lanes=4194304);l.isBackwards?(d.sibling=e.child,e.child=d):(n=l.last,n!==null?n.sibling=d:e.child=d,l.last=d)}return l.tail!==null?(e=l.tail,l.rendering=e,l.tail=e.sibling,l.renderingStartTime=zr(),e.sibling=null,n=Ar.current,Ji(Ar,r?n&1|2:n&1),e):(_o(e),null);case 22:case 23:return e4(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ja&1073741824&&(_o(e),e.subtreeFlags&6&&(e.flags|=8192)):_o(e),null;case 24:return null;case 25:return null}throw Error(ct(156,e.tag))}function Qfe(t,e){switch(kB(e),e.tag){case 1:return wa(e.type)&&o1(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return mv(),lr(ba),lr(Co),HB(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return WB(e),null;case 13:if(lr(Ar),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ct(340));fv()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return lr(Ar),null;case 4:return mv(),null;case 10:return jB(e.type._context),null;case 22:case 23:return e4(),null;case 24:return null;default:return null}}var kA=!1,bo=!1,Zfe=typeof WeakSet=="function"?WeakSet:Set,bt=null;function ME(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Dr(t,e,r)}else n.current=null}function _3(t,e,n){try{n()}catch(r){Dr(t,e,r)}}var cz=!1;function epe(t,e){if(e3=n1,t=BJ(),xB(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var c=r.anchorOffset,l=r.focusNode;r=r.focusOffset;try{n.nodeType,l.nodeType}catch{n=null;break e}var d=0,f=-1,m=-1,E=0,y=0,w=t,I=null;t:for(;;){for(var P;w!==n||c!==0&&w.nodeType!==3||(f=d+c),w!==l||r!==0&&w.nodeType!==3||(m=d+r),w.nodeType===3&&(d+=w.nodeValue.length),(P=w.firstChild)!==null;)I=w,w=P;for(;;){if(w===t)break t;if(I===n&&++E===c&&(f=d),I===l&&++y===r&&(m=d),(P=w.nextSibling)!==null)break;w=I,I=w.parentNode}w=P}n=f===-1||m===-1?null:{start:f,end:m}}else n=null}n=n||{start:0,end:0}}else n=null;for(t3={focusedElem:t,selectionRange:n},n1=!1,bt=e;bt!==null;)if(e=bt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,bt=t;else for(;bt!==null;){e=bt;try{var k=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(k!==null){var M=k.memoizedProps,K=k.memoizedState,W=e.stateNode,V=W.getSnapshotBeforeUpdate(e.elementType===e.type?M:hl(e.type,M),K);W.__reactInternalSnapshotBeforeUpdate=V}break;case 3:var G=e.stateNode.containerInfo;G.nodeType===1?G.textContent="":G.nodeType===9&&G.documentElement&&G.removeChild(G.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ct(163))}}catch(Q){Dr(e,e.return,Q)}if(t=e.sibling,t!==null){t.return=e.return,bt=t;break}bt=e.return}return k=cz,cz=!1,k}function mT(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var c=r=r.next;do{if((c.tag&t)===t){var l=c.destroy;c.destroy=void 0,l!==void 0&&_3(e,n,l)}c=c.next}while(c!==r)}}function AN(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function E3(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function jQ(t){var e=t.alternate;e!==null&&(t.alternate=null,jQ(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[mu],delete e[BT],delete e[r3],delete e[Mfe],delete e[Ufe])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function FQ(t){return t.tag===5||t.tag===3||t.tag===4}function lz(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||FQ(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function v3(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=s1));else if(r!==4&&(t=t.child,t!==null))for(v3(t,e,n),t=t.sibling;t!==null;)v3(t,e,n),t=t.sibling}function y3(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(y3(t,e,n),t=t.sibling;t!==null;)y3(t,e,n),t=t.sibling}var zs=null,fl=!1;function Qh(t,e,n){for(n=n.child;n!==null;)VQ(t,e,n),n=n.sibling}function VQ(t,e,n){if(_u&&typeof _u.onCommitFiberUnmount=="function")try{_u.onCommitFiberUnmount(yN,n)}catch{}switch(n.tag){case 5:bo||ME(n,e);case 6:var r=zs,c=fl;zs=null,Qh(t,e,n),zs=r,fl=c,zs!==null&&(fl?(t=zs,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):zs.removeChild(n.stateNode));break;case 18:zs!==null&&(fl?(t=zs,n=n.stateNode,t.nodeType===8?cj(t.parentNode,n):t.nodeType===1&&cj(t,n),MT(t)):cj(zs,n.stateNode));break;case 4:r=zs,c=fl,zs=n.stateNode.containerInfo,fl=!0,Qh(t,e,n),zs=r,fl=c;break;case 0:case 11:case 14:case 15:if(!bo&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){c=r=r.next;do{var l=c,d=l.destroy;l=l.tag,d!==void 0&&(l&2||l&4)&&_3(n,e,d),c=c.next}while(c!==r)}Qh(t,e,n);break;case 1:if(!bo&&(ME(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(f){Dr(n,e,f)}Qh(t,e,n);break;case 21:Qh(t,e,n);break;case 22:n.mode&1?(bo=(r=bo)||n.memoizedState!==null,Qh(t,e,n),bo=r):Qh(t,e,n);break;default:Qh(t,e,n)}}function uz(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Zfe),e.forEach(function(r){var c=lpe.bind(null,t,r);n.has(r)||(n.add(r),r.then(c,c))})}}function al(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var c=n[r];try{var l=t,d=e,f=d;e:for(;f!==null;){switch(f.tag){case 5:zs=f.stateNode,fl=!1;break e;case 3:zs=f.stateNode.containerInfo,fl=!0;break e;case 4:zs=f.stateNode.containerInfo,fl=!0;break e}f=f.return}if(zs===null)throw Error(ct(160));VQ(l,d,c),zs=null,fl=!1;var m=c.alternate;m!==null&&(m.return=null),c.return=null}catch(E){Dr(c,e,E)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)BQ(e,t),e=e.sibling}function BQ(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(al(e,t),uu(t),r&4){try{mT(3,t,t.return),AN(3,t)}catch(M){Dr(t,t.return,M)}try{mT(5,t,t.return)}catch(M){Dr(t,t.return,M)}}break;case 1:al(e,t),uu(t),r&512&&n!==null&&ME(n,n.return);break;case 5:if(al(e,t),uu(t),r&512&&n!==null&&ME(n,n.return),t.flags&32){var c=t.stateNode;try{xT(c,"")}catch(M){Dr(t,t.return,M)}}if(r&4&&(c=t.stateNode,c!=null)){var l=t.memoizedProps,d=n!==null?n.memoizedProps:l,f=t.type,m=t.updateQueue;if(t.updateQueue=null,m!==null)try{f==="input"&&l.type==="radio"&&l.name!=null&&cJ(c,l),$F(f,d);var E=$F(f,l);for(d=0;d<m.length;d+=2){var y=m[d],w=m[d+1];y==="style"?fJ(c,w):y==="dangerouslySetInnerHTML"?dJ(c,w):y==="children"?xT(c,w):vB(c,y,w,E)}switch(f){case"input":FF(c,l);break;case"textarea":lJ(c,l);break;case"select":var I=c._wrapperState.wasMultiple;c._wrapperState.wasMultiple=!!l.multiple;var P=l.value;P!=null?GE(c,!!l.multiple,P,!1):I!==!!l.multiple&&(l.defaultValue!=null?GE(c,!!l.multiple,l.defaultValue,!0):GE(c,!!l.multiple,l.multiple?[]:"",!1))}c[BT]=l}catch(M){Dr(t,t.return,M)}}break;case 6:if(al(e,t),uu(t),r&4){if(t.stateNode===null)throw Error(ct(162));c=t.stateNode,l=t.memoizedProps;try{c.nodeValue=l}catch(M){Dr(t,t.return,M)}}break;case 3:if(al(e,t),uu(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{MT(e.containerInfo)}catch(M){Dr(t,t.return,M)}break;case 4:al(e,t),uu(t);break;case 13:al(e,t),uu(t),c=t.child,c.flags&8192&&(l=c.memoizedState!==null,c.stateNode.isHidden=l,!l||c.alternate!==null&&c.alternate.memoizedState!==null||(QB=zr())),r&4&&uz(t);break;case 22:if(y=n!==null&&n.memoizedState!==null,t.mode&1?(bo=(E=bo)||y,al(e,t),bo=E):al(e,t),uu(t),r&8192){if(E=t.memoizedState!==null,(t.stateNode.isHidden=E)&&!y&&t.mode&1)for(bt=t,y=t.child;y!==null;){for(w=bt=y;bt!==null;){switch(I=bt,P=I.child,I.tag){case 0:case 11:case 14:case 15:mT(4,I,I.return);break;case 1:ME(I,I.return);var k=I.stateNode;if(typeof k.componentWillUnmount=="function"){r=I,n=I.return;try{e=r,k.props=e.memoizedProps,k.state=e.memoizedState,k.componentWillUnmount()}catch(M){Dr(r,n,M)}}break;case 5:ME(I,I.return);break;case 22:if(I.memoizedState!==null){hz(w);continue}}P!==null?(P.return=I,bt=P):hz(w)}y=y.sibling}e:for(y=null,w=t;;){if(w.tag===5){if(y===null){y=w;try{c=w.stateNode,E?(l=c.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(f=w.stateNode,m=w.memoizedProps.style,d=m!=null&&m.hasOwnProperty("display")?m.display:null,f.style.display=hJ("display",d))}catch(M){Dr(t,t.return,M)}}}else if(w.tag===6){if(y===null)try{w.stateNode.nodeValue=E?"":w.memoizedProps}catch(M){Dr(t,t.return,M)}}else if((w.tag!==22&&w.tag!==23||w.memoizedState===null||w===t)&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===t)break e;for(;w.sibling===null;){if(w.return===null||w.return===t)break e;y===w&&(y=null),w=w.return}y===w&&(y=null),w.sibling.return=w.return,w=w.sibling}}break;case 19:al(e,t),uu(t),r&4&&uz(t);break;case 21:break;default:al(e,t),uu(t)}}function uu(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(FQ(n)){var r=n;break e}n=n.return}throw Error(ct(160))}switch(r.tag){case 5:var c=r.stateNode;r.flags&32&&(xT(c,""),r.flags&=-33);var l=lz(t);y3(t,l,c);break;case 3:case 4:var d=r.stateNode.containerInfo,f=lz(t);v3(t,f,d);break;default:throw Error(ct(161))}}catch(m){Dr(t,t.return,m)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function tpe(t,e,n){bt=t,WQ(t)}function WQ(t,e,n){for(var r=(t.mode&1)!==0;bt!==null;){var c=bt,l=c.child;if(c.tag===22&&r){var d=c.memoizedState!==null||kA;if(!d){var f=c.alternate,m=f!==null&&f.memoizedState!==null||bo;f=kA;var E=bo;if(kA=d,(bo=m)&&!E)for(bt=c;bt!==null;)d=bt,m=d.child,d.tag===22&&d.memoizedState!==null?fz(c):m!==null?(m.return=d,bt=m):fz(c);for(;l!==null;)bt=l,WQ(l),l=l.sibling;bt=c,kA=f,bo=E}dz(t)}else c.subtreeFlags&8772&&l!==null?(l.return=c,bt=l):dz(t)}}function dz(t){for(;bt!==null;){var e=bt;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:bo||AN(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!bo)if(n===null)r.componentDidMount();else{var c=e.elementType===e.type?n.memoizedProps:hl(e.type,n.memoizedProps);r.componentDidUpdate(c,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var l=e.updateQueue;l!==null&&q9(e,l,r);break;case 3:var d=e.updateQueue;if(d!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}q9(e,d,n)}break;case 5:var f=e.stateNode;if(n===null&&e.flags&4){n=f;var m=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":m.autoFocus&&n.focus();break;case"img":m.src&&(n.src=m.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var E=e.alternate;if(E!==null){var y=E.memoizedState;if(y!==null){var w=y.dehydrated;w!==null&&MT(w)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ct(163))}bo||e.flags&512&&E3(e)}catch(I){Dr(e,e.return,I)}}if(e===t){bt=null;break}if(n=e.sibling,n!==null){n.return=e.return,bt=n;break}bt=e.return}}function hz(t){for(;bt!==null;){var e=bt;if(e===t){bt=null;break}var n=e.sibling;if(n!==null){n.return=e.return,bt=n;break}bt=e.return}}function fz(t){for(;bt!==null;){var e=bt;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{AN(4,e)}catch(m){Dr(e,n,m)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var c=e.return;try{r.componentDidMount()}catch(m){Dr(e,c,m)}}var l=e.return;try{E3(e)}catch(m){Dr(e,l,m)}break;case 5:var d=e.return;try{E3(e)}catch(m){Dr(e,d,m)}}}catch(m){Dr(e,e.return,m)}if(e===t){bt=null;break}var f=e.sibling;if(f!==null){f.return=e.return,bt=f;break}bt=e.return}}var npe=Math.ceil,g1=Gd.ReactCurrentDispatcher,XB=Gd.ReactCurrentOwner,Lc=Gd.ReactCurrentBatchConfig,ei=0,ks=null,os=null,Ks=0,Ja=0,UE=Yf(0),_s=0,KT=null,Jm=0,ON=0,JB=0,gT=null,va=null,QB=0,_v=1/0,Td=null,_1=!1,S3=null,Nf=null,LA=!1,Ef=null,E1=0,_T=0,T3=null,RO=-1,IO=0;function Ho(){return ei&6?zr():RO!==-1?RO:RO=zr()}function Pf(t){return t.mode&1?ei&2&&Ks!==0?Ks&-Ks:Ffe.transition!==null?(IO===0&&(IO=CJ()),IO):(t=yi,t!==0||(t=window.event,t=t===void 0?16:xJ(t.type)),t):1}function Tl(t,e,n,r){if(50<_T)throw _T=0,T3=null,Error(ct(185));yb(t,n,r),(!(ei&2)||t!==ks)&&(t===ks&&(!(ei&2)&&(ON|=n),_s===4&&uf(t,Ks)),Ca(t,r),n===1&&ei===0&&!(e.mode&1)&&(_v=zr()+500,CN&&Xf()))}function Ca(t,e){var n=t.callbackNode;Fhe(t,e);var r=t1(t,t===ks?Ks:0);if(r===0)n!==null&&T9(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&T9(n),e===1)t.tag===0?jfe(pz.bind(null,t)):JJ(pz.bind(null,t)),kfe(function(){!(ei&6)&&Xf()}),n=null;else{switch(RJ(r)){case 1:n=wB;break;case 4:n=bJ;break;case 16:n=e1;break;case 536870912:n=wJ;break;default:n=e1}n=XQ(n,HQ.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function HQ(t,e){if(RO=-1,IO=0,ei&6)throw Error(ct(327));var n=t.callbackNode;if(JE()&&t.callbackNode!==n)return null;var r=t1(t,t===ks?Ks:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=v1(t,r);else{e=r;var c=ei;ei|=2;var l=zQ();(ks!==t||Ks!==e)&&(Td=null,_v=zr()+500,Bm(t,e));do try{spe();break}catch(f){$Q(t,f)}while(1);UB(),g1.current=l,ei=c,os!==null?e=0:(ks=null,Ks=0,e=_s)}if(e!==0){if(e===2&&(c=YF(t),c!==0&&(r=c,e=b3(t,c))),e===1)throw n=KT,Bm(t,0),uf(t,r),Ca(t,zr()),n;if(e===6)uf(t,r);else{if(c=t.current.alternate,!(r&30)&&!ipe(c)&&(e=v1(t,r),e===2&&(l=YF(t),l!==0&&(r=l,e=b3(t,l))),e===1))throw n=KT,Bm(t,0),uf(t,r),Ca(t,zr()),n;switch(t.finishedWork=c,t.finishedLanes=r,e){case 0:case 1:throw Error(ct(345));case 2:Sm(t,va,Td);break;case 3:if(uf(t,r),(r&130023424)===r&&(e=QB+500-zr(),10<e)){if(t1(t,0)!==0)break;if(c=t.suspendedLanes,(c&r)!==r){Ho(),t.pingedLanes|=t.suspendedLanes&c;break}t.timeoutHandle=i3(Sm.bind(null,t,va,Td),e);break}Sm(t,va,Td);break;case 4:if(uf(t,r),(r&4194240)===r)break;for(e=t.eventTimes,c=-1;0<r;){var d=31-Sl(r);l=1<<d,d=e[d],d>c&&(c=d),r&=~l}if(r=c,r=zr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*npe(r/1960))-r,10<r){t.timeoutHandle=i3(Sm.bind(null,t,va,Td),r);break}Sm(t,va,Td);break;case 5:Sm(t,va,Td);break;default:throw Error(ct(329))}}}return Ca(t,zr()),t.callbackNode===n?HQ.bind(null,t):null}function b3(t,e){var n=gT;return t.current.memoizedState.isDehydrated&&(Bm(t,e).flags|=256),t=v1(t,e),t!==2&&(e=va,va=n,e!==null&&w3(e)),t}function w3(t){va===null?va=t:va.push.apply(va,t)}function ipe(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var c=n[r],l=c.getSnapshot;c=c.value;try{if(!bl(l(),c))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function uf(t,e){for(e&=~JB,e&=~ON,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Sl(e),r=1<<n;t[n]=-1,e&=~r}}function pz(t){if(ei&6)throw Error(ct(327));JE();var e=t1(t,0);if(!(e&1))return Ca(t,zr()),null;var n=v1(t,e);if(t.tag!==0&&n===2){var r=YF(t);r!==0&&(e=r,n=b3(t,r))}if(n===1)throw n=KT,Bm(t,0),uf(t,e),Ca(t,zr()),n;if(n===6)throw Error(ct(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Sm(t,va,Td),Ca(t,zr()),null}function ZB(t,e){var n=ei;ei|=1;try{return t(e)}finally{ei=n,ei===0&&(_v=zr()+500,CN&&Xf())}}function Qm(t){Ef!==null&&Ef.tag===0&&!(ei&6)&&JE();var e=ei;ei|=1;var n=Lc.transition,r=yi;try{if(Lc.transition=null,yi=1,t)return t()}finally{yi=r,Lc.transition=n,ei=e,!(ei&6)&&Xf()}}function e4(){Ja=UE.current,lr(UE)}function Bm(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Dfe(n)),os!==null)for(n=os.return;n!==null;){var r=n;switch(kB(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&o1();break;case 3:mv(),lr(ba),lr(Co),HB();break;case 5:WB(r);break;case 4:mv();break;case 13:lr(Ar);break;case 19:lr(Ar);break;case 10:jB(r.type._context);break;case 22:case 23:e4()}n=n.return}if(ks=t,os=t=xf(t.current,null),Ks=Ja=e,_s=0,KT=null,JB=ON=Jm=0,va=gT=null,km!==null){for(e=0;e<km.length;e++)if(n=km[e],r=n.interleaved,r!==null){n.interleaved=null;var c=r.next,l=n.pending;if(l!==null){var d=l.next;l.next=c,r.next=d}n.pending=r}km=null}return t}function $Q(t,e){do{var n=os;try{if(UB(),bO.current=m1,p1){for(var r=Nr.memoizedState;r!==null;){var c=r.queue;c!==null&&(c.pending=null),r=r.next}p1=!1}if(Xm=0,Ds=gs=Nr=null,pT=!1,$T=0,XB.current=null,n===null||n.return===null){_s=1,KT=e,os=null;break}e:{var l=t,d=n.return,f=n,m=e;if(e=Ks,f.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){var E=m,y=f,w=y.tag;if(!(y.mode&1)&&(w===0||w===11||w===15)){var I=y.alternate;I?(y.updateQueue=I.updateQueue,y.memoizedState=I.memoizedState,y.lanes=I.lanes):(y.updateQueue=null,y.memoizedState=null)}var P=tz(d);if(P!==null){P.flags&=-257,nz(P,d,f,l,e),P.mode&1&&ez(l,E,e),e=P,m=E;var k=e.updateQueue;if(k===null){var M=new Set;M.add(m),e.updateQueue=M}else k.add(m);break e}else{if(!(e&1)){ez(l,E,e),t4();break e}m=Error(ct(426))}}else if(Tr&&f.mode&1){var K=tz(d);if(K!==null){!(K.flags&65536)&&(K.flags|=256),nz(K,d,f,l,e),LB(gv(m,f));break e}}l=m=gv(m,f),_s!==4&&(_s=2),gT===null?gT=[l]:gT.push(l),l=d;do{switch(l.tag){case 3:l.flags|=65536,e&=-e,l.lanes|=e;var W=IQ(l,m,e);K9(l,W);break e;case 1:f=m;var V=l.type,G=l.stateNode;if(!(l.flags&128)&&(typeof V.getDerivedStateFromError=="function"||G!==null&&typeof G.componentDidCatch=="function"&&(Nf===null||!Nf.has(G)))){l.flags|=65536,e&=-e,l.lanes|=e;var Q=AQ(l,f,e);K9(l,Q);break e}}l=l.return}while(l!==null)}KQ(n)}catch(Z){e=Z,os===n&&n!==null&&(os=n=n.return);continue}break}while(1)}function zQ(){var t=g1.current;return g1.current=m1,t===null?m1:t}function t4(){(_s===0||_s===3||_s===2)&&(_s=4),ks===null||!(Jm&268435455)&&!(ON&268435455)||uf(ks,Ks)}function v1(t,e){var n=ei;ei|=2;var r=zQ();(ks!==t||Ks!==e)&&(Td=null,Bm(t,e));do try{rpe();break}catch(c){$Q(t,c)}while(1);if(UB(),ei=n,g1.current=r,os!==null)throw Error(ct(261));return ks=null,Ks=0,_s}function rpe(){for(;os!==null;)GQ(os)}function spe(){for(;os!==null&&!Nhe();)GQ(os)}function GQ(t){var e=YQ(t.alternate,t,Ja);t.memoizedProps=t.pendingProps,e===null?KQ(t):os=e,XB.current=null}function KQ(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Qfe(n,e),n!==null){n.flags&=32767,os=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{_s=6,os=null;return}}else if(n=Jfe(n,e,Ja),n!==null){os=n;return}if(e=e.sibling,e!==null){os=e;return}os=e=t}while(e!==null);_s===0&&(_s=5)}function Sm(t,e,n){var r=yi,c=Lc.transition;try{Lc.transition=null,yi=1,ope(t,e,n,r)}finally{Lc.transition=c,yi=r}return null}function ope(t,e,n,r){do JE();while(Ef!==null);if(ei&6)throw Error(ct(327));n=t.finishedWork;var c=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ct(177));t.callbackNode=null,t.callbackPriority=0;var l=n.lanes|n.childLanes;if(Vhe(t,l),t===ks&&(os=ks=null,Ks=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||LA||(LA=!0,XQ(e1,function(){return JE(),null})),l=(n.flags&15990)!==0,n.subtreeFlags&15990||l){l=Lc.transition,Lc.transition=null;var d=yi;yi=1;var f=ei;ei|=4,XB.current=null,epe(t,n),BQ(n,t),Rfe(t3),n1=!!e3,t3=e3=null,t.current=n,tpe(n),Phe(),ei=f,yi=d,Lc.transition=l}else t.current=n;if(LA&&(LA=!1,Ef=t,E1=c),l=t.pendingLanes,l===0&&(Nf=null),khe(n.stateNode),Ca(t,zr()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)c=e[n],r(c.value,{componentStack:c.stack,digest:c.digest});if(_1)throw _1=!1,t=S3,S3=null,t;return E1&1&&t.tag!==0&&JE(),l=t.pendingLanes,l&1?t===T3?_T++:(_T=0,T3=t):_T=0,Xf(),null}function JE(){if(Ef!==null){var t=RJ(E1),e=Lc.transition,n=yi;try{if(Lc.transition=null,yi=16>t?16:t,Ef===null)var r=!1;else{if(t=Ef,Ef=null,E1=0,ei&6)throw Error(ct(331));var c=ei;for(ei|=4,bt=t.current;bt!==null;){var l=bt,d=l.child;if(bt.flags&16){var f=l.deletions;if(f!==null){for(var m=0;m<f.length;m++){var E=f[m];for(bt=E;bt!==null;){var y=bt;switch(y.tag){case 0:case 11:case 15:mT(8,y,l)}var w=y.child;if(w!==null)w.return=y,bt=w;else for(;bt!==null;){y=bt;var I=y.sibling,P=y.return;if(jQ(y),y===E){bt=null;break}if(I!==null){I.return=P,bt=I;break}bt=P}}}var k=l.alternate;if(k!==null){var M=k.child;if(M!==null){k.child=null;do{var K=M.sibling;M.sibling=null,M=K}while(M!==null)}}bt=l}}if(l.subtreeFlags&2064&&d!==null)d.return=l,bt=d;else e:for(;bt!==null;){if(l=bt,l.flags&2048)switch(l.tag){case 0:case 11:case 15:mT(9,l,l.return)}var W=l.sibling;if(W!==null){W.return=l.return,bt=W;break e}bt=l.return}}var V=t.current;for(bt=V;bt!==null;){d=bt;var G=d.child;if(d.subtreeFlags&2064&&G!==null)G.return=d,bt=G;else e:for(d=V;bt!==null;){if(f=bt,f.flags&2048)try{switch(f.tag){case 0:case 11:case 15:AN(9,f)}}catch(Z){Dr(f,f.return,Z)}if(f===d){bt=null;break e}var Q=f.sibling;if(Q!==null){Q.return=f.return,bt=Q;break e}bt=f.return}}if(ei=c,Xf(),_u&&typeof _u.onPostCommitFiberRoot=="function")try{_u.onPostCommitFiberRoot(yN,t)}catch{}r=!0}return r}finally{yi=n,Lc.transition=e}}return!1}function mz(t,e,n){e=gv(n,e),e=IQ(t,e,1),t=Of(t,e,1),e=Ho(),t!==null&&(yb(t,1,e),Ca(t,e))}function Dr(t,e,n){if(t.tag===3)mz(t,t,n);else for(;e!==null;){if(e.tag===3){mz(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Nf===null||!Nf.has(r))){t=gv(n,t),t=AQ(e,t,1),e=Of(e,t,1),t=Ho(),e!==null&&(yb(e,1,t),Ca(e,t));break}}e=e.return}}function ape(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Ho(),t.pingedLanes|=t.suspendedLanes&n,ks===t&&(Ks&n)===n&&(_s===4||_s===3&&(Ks&130023424)===Ks&&500>zr()-QB?Bm(t,0):JB|=n),Ca(t,e)}function qQ(t,e){e===0&&(t.mode&1?(e=CA,CA<<=1,!(CA&130023424)&&(CA=4194304)):e=1);var n=Ho();t=Fd(t,e),t!==null&&(yb(t,e,n),Ca(t,n))}function cpe(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),qQ(t,n)}function lpe(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,c=t.memoizedState;c!==null&&(n=c.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ct(314))}r!==null&&r.delete(e),qQ(t,n)}var YQ;YQ=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||ba.current)Ta=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ta=!1,Xfe(t,e,n);Ta=!!(t.flags&131072)}else Ta=!1,Tr&&e.flags&1048576&&QJ(e,l1,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;CO(t,e),t=e.pendingProps;var c=hv(e,Co.current);XE(e,n),c=zB(null,e,r,t,c,n);var l=GB();return e.flags|=1,typeof c=="object"&&c!==null&&typeof c.render=="function"&&c.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,wa(r)?(l=!0,a1(e)):l=!1,e.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,VB(e),c.updater=RN,e.stateNode=c,c._reactInternals=e,u3(e,r,t,n),e=f3(null,e,r,!0,l,n)):(e.tag=0,Tr&&l&&DB(e),Wo(null,e,c,n),e=e.child),e;case 16:r=e.elementType;e:{switch(CO(t,e),t=e.pendingProps,c=r._init,r=c(r._payload),e.type=r,c=e.tag=dpe(r),t=hl(r,t),c){case 0:e=h3(null,e,r,t,n);break e;case 1:e=sz(null,e,r,t,n);break e;case 11:e=iz(null,e,r,t,n);break e;case 14:e=rz(null,e,r,hl(r.type,t),n);break e}throw Error(ct(306,r,""))}return e;case 0:return r=e.type,c=e.pendingProps,c=e.elementType===r?c:hl(r,c),h3(t,e,r,c,n);case 1:return r=e.type,c=e.pendingProps,c=e.elementType===r?c:hl(r,c),sz(t,e,r,c,n);case 3:e:{if(xQ(e),t===null)throw Error(ct(387));r=e.pendingProps,l=e.memoizedState,c=l.element,nQ(t,e),h1(e,r,null,n);var d=e.memoizedState;if(r=d.element,l.isDehydrated)if(l={element:r,isDehydrated:!1,cache:d.cache,pendingSuspenseBoundaries:d.pendingSuspenseBoundaries,transitions:d.transitions},e.updateQueue.baseState=l,e.memoizedState=l,e.flags&256){c=gv(Error(ct(423)),e),e=oz(t,e,r,n,c);break e}else if(r!==c){c=gv(Error(ct(424)),e),e=oz(t,e,r,n,c);break e}else for(Qa=Af(e.stateNode.containerInfo.firstChild),nc=e,Tr=!0,gl=null,n=oQ(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(fv(),r===c){e=Vd(t,e,n);break e}Wo(t,e,r,n)}e=e.child}return e;case 5:return aQ(e),t===null&&a3(e),r=e.type,c=e.pendingProps,l=t!==null?t.memoizedProps:null,d=c.children,n3(r,c)?d=null:l!==null&&n3(r,l)&&(e.flags|=32),PQ(t,e),Wo(t,e,d,n),e.child;case 6:return t===null&&a3(e),null;case 13:return DQ(t,e,n);case 4:return BB(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=pv(e,null,r,n):Wo(t,e,r,n),e.child;case 11:return r=e.type,c=e.pendingProps,c=e.elementType===r?c:hl(r,c),iz(t,e,r,c,n);case 7:return Wo(t,e,e.pendingProps,n),e.child;case 8:return Wo(t,e,e.pendingProps.children,n),e.child;case 12:return Wo(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,c=e.pendingProps,l=e.memoizedProps,d=c.value,Ji(u1,r._currentValue),r._currentValue=d,l!==null)if(bl(l.value,d)){if(l.children===c.children&&!ba.current){e=Vd(t,e,n);break e}}else for(l=e.child,l!==null&&(l.return=e);l!==null;){var f=l.dependencies;if(f!==null){d=l.child;for(var m=f.firstContext;m!==null;){if(m.context===r){if(l.tag===1){m=xd(-1,n&-n),m.tag=2;var E=l.updateQueue;if(E!==null){E=E.shared;var y=E.pending;y===null?m.next=m:(m.next=y.next,y.next=m),E.pending=m}}l.lanes|=n,m=l.alternate,m!==null&&(m.lanes|=n),c3(l.return,n,e),f.lanes|=n;break}m=m.next}}else if(l.tag===10)d=l.type===e.type?null:l.child;else if(l.tag===18){if(d=l.return,d===null)throw Error(ct(341));d.lanes|=n,f=d.alternate,f!==null&&(f.lanes|=n),c3(d,n,e),d=l.sibling}else d=l.child;if(d!==null)d.return=l;else for(d=l;d!==null;){if(d===e){d=null;break}if(l=d.sibling,l!==null){l.return=d.return,d=l;break}d=d.return}l=d}Wo(t,e,c.children,n),e=e.child}return e;case 9:return c=e.type,r=e.pendingProps.children,XE(e,n),c=Uc(c),r=r(c),e.flags|=1,Wo(t,e,r,n),e.child;case 14:return r=e.type,c=hl(r,e.pendingProps),c=hl(r.type,c),rz(t,e,r,c,n);case 15:return OQ(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,c=e.pendingProps,c=e.elementType===r?c:hl(r,c),CO(t,e),e.tag=1,wa(r)?(t=!0,a1(e)):t=!1,XE(e,n),rQ(e,r,c),u3(e,r,c,n),f3(null,e,r,!0,t,n);case 19:return kQ(t,e,n);case 22:return NQ(t,e,n)}throw Error(ct(156,e.tag))};function XQ(t,e){return TJ(t,e)}function upe(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dc(t,e,n,r){return new upe(t,e,n,r)}function n4(t){return t=t.prototype,!(!t||!t.isReactComponent)}function dpe(t){if(typeof t=="function")return n4(t)?1:0;if(t!=null){if(t=t.$$typeof,t===SB)return 11;if(t===TB)return 14}return 2}function xf(t,e){var n=t.alternate;return n===null?(n=Dc(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function AO(t,e,n,r,c,l){var d=2;if(r=t,typeof t=="function")n4(t)&&(d=1);else if(typeof t=="string")d=5;else e:switch(t){case IE:return Wm(n.children,c,l,e);case yB:d=8,c|=8;break;case kF:return t=Dc(12,n,e,c|2),t.elementType=kF,t.lanes=l,t;case LF:return t=Dc(13,n,e,c),t.elementType=LF,t.lanes=l,t;case MF:return t=Dc(19,n,e,c),t.elementType=MF,t.lanes=l,t;case sJ:return NN(n,c,l,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case iJ:d=10;break e;case rJ:d=9;break e;case SB:d=11;break e;case TB:d=14;break e;case sf:d=16,r=null;break e}throw Error(ct(130,t==null?t:typeof t,""))}return e=Dc(d,n,e,c),e.elementType=t,e.type=r,e.lanes=l,e}function Wm(t,e,n,r){return t=Dc(7,t,r,e),t.lanes=n,t}function NN(t,e,n,r){return t=Dc(22,t,r,e),t.elementType=sJ,t.lanes=n,t.stateNode={isHidden:!1},t}function gj(t,e,n){return t=Dc(6,t,null,e),t.lanes=n,t}function _j(t,e,n){return e=Dc(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function hpe(t,e,n,r,c){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=JU(0),this.expirationTimes=JU(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=JU(0),this.identifierPrefix=r,this.onRecoverableError=c,this.mutableSourceEagerHydrationData=null}function i4(t,e,n,r,c,l,d,f,m){return t=new hpe(t,e,n,f,m),e===1?(e=1,l===!0&&(e|=8)):e=0,l=Dc(3,null,null,e),t.current=l,l.stateNode=t,l.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},VB(l),t}function fpe(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:RE,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function JQ(t){if(!t)return Bf;t=t._reactInternals;e:{if(hg(t)!==t||t.tag!==1)throw Error(ct(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(wa(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ct(171))}if(t.tag===1){var n=t.type;if(wa(n))return XJ(t,n,e)}return e}function QQ(t,e,n,r,c,l,d,f,m){return t=i4(n,r,!0,t,c,l,d,f,m),t.context=JQ(null),n=t.current,r=Ho(),c=Pf(n),l=xd(r,c),l.callback=e??null,Of(n,l,c),t.current.lanes=c,yb(t,c,r),Ca(t,r),t}function PN(t,e,n,r){var c=e.current,l=Ho(),d=Pf(c);return n=JQ(n),e.context===null?e.context=n:e.pendingContext=n,e=xd(l,d),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Of(c,e,d),t!==null&&(Tl(t,c,d,l),TO(t,c,d)),d}function y1(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function gz(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function r4(t,e){gz(t,e),(t=t.alternate)&&gz(t,e)}function ppe(){return null}var ZQ=typeof reportError=="function"?reportError:function(t){console.error(t)};function s4(t){this._internalRoot=t}xN.prototype.render=s4.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ct(409));PN(t,e,null,null)};xN.prototype.unmount=s4.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Qm(function(){PN(null,t,null,null)}),e[jd]=null}};function xN(t){this._internalRoot=t}xN.prototype.unstable_scheduleHydration=function(t){if(t){var e=OJ();t={blockedOn:null,target:t,priority:e};for(var n=0;n<lf.length&&e!==0&&e<lf[n].priority;n++);lf.splice(n,0,t),n===0&&PJ(t)}};function o4(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function DN(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function _z(){}function mpe(t,e,n,r,c){if(c){if(typeof r=="function"){var l=r;r=function(){var E=y1(d);l.call(E)}}var d=QQ(e,r,t,0,null,!1,!1,"",_z);return t._reactRootContainer=d,t[jd]=d.current,FT(t.nodeType===8?t.parentNode:t),Qm(),d}for(;c=t.lastChild;)t.removeChild(c);if(typeof r=="function"){var f=r;r=function(){var E=y1(m);f.call(E)}}var m=i4(t,0,!1,null,null,!1,!1,"",_z);return t._reactRootContainer=m,t[jd]=m.current,FT(t.nodeType===8?t.parentNode:t),Qm(function(){PN(e,m,n,r)}),m}function kN(t,e,n,r,c){var l=n._reactRootContainer;if(l){var d=l;if(typeof c=="function"){var f=c;c=function(){var m=y1(d);f.call(m)}}PN(e,d,t,c)}else d=mpe(n,e,t,c,r);return y1(d)}IJ=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=QS(e.pendingLanes);n!==0&&(CB(e,n|1),Ca(e,zr()),!(ei&6)&&(_v=zr()+500,Xf()))}break;case 13:Qm(function(){var r=Fd(t,1);if(r!==null){var c=Ho();Tl(r,t,1,c)}}),r4(t,1)}};RB=function(t){if(t.tag===13){var e=Fd(t,134217728);if(e!==null){var n=Ho();Tl(e,t,134217728,n)}r4(t,134217728)}};AJ=function(t){if(t.tag===13){var e=Pf(t),n=Fd(t,e);if(n!==null){var r=Ho();Tl(n,t,e,r)}r4(t,e)}};OJ=function(){return yi};NJ=function(t,e){var n=yi;try{return yi=t,e()}finally{yi=n}};GF=function(t,e,n){switch(e){case"input":if(FF(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var c=wN(r);if(!c)throw Error(ct(90));aJ(r),FF(r,c)}}}break;case"textarea":lJ(t,n);break;case"select":e=n.value,e!=null&&GE(t,!!n.multiple,e,!1)}};gJ=ZB;_J=Qm;var gpe={usingClientEntryPoint:!1,Events:[Tb,PE,wN,pJ,mJ,ZB]},xS={findFiberByHostInstance:Dm,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},_pe={bundleType:xS.bundleType,version:xS.version,rendererPackageName:xS.rendererPackageName,rendererConfig:xS.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Gd.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=yJ(t),t===null?null:t.stateNode},findFiberByHostInstance:xS.findFiberByHostInstance||ppe,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var MA=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!MA.isDisabled&&MA.supportsFiber)try{yN=MA.inject(_pe),_u=MA}catch{}}oc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gpe;oc.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!o4(e))throw Error(ct(200));return fpe(t,e,null,n)};oc.createRoot=function(t,e){if(!o4(t))throw Error(ct(299));var n=!1,r="",c=ZQ;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(c=e.onRecoverableError)),e=i4(t,1,!1,null,null,n,!1,r,c),t[jd]=e.current,FT(t.nodeType===8?t.parentNode:t),new s4(e)};oc.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ct(188)):(t=Object.keys(t).join(","),Error(ct(268,t)));return t=yJ(e),t=t===null?null:t.stateNode,t};oc.flushSync=function(t){return Qm(t)};oc.hydrate=function(t,e,n){if(!DN(e))throw Error(ct(200));return kN(null,t,e,!0,n)};oc.hydrateRoot=function(t,e,n){if(!o4(t))throw Error(ct(405));var r=n!=null&&n.hydratedSources||null,c=!1,l="",d=ZQ;if(n!=null&&(n.unstable_strictMode===!0&&(c=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(d=n.onRecoverableError)),e=QQ(e,null,t,1,n??null,c,!1,l,d),t[jd]=e.current,FT(t),r)for(t=0;t<r.length;t++)n=r[t],c=n._getVersion,c=c(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,c]:e.mutableSourceEagerHydrationData.push(n,c);return new xN(e)};oc.render=function(t,e,n){if(!DN(e))throw Error(ct(200));return kN(null,t,e,!1,n)};oc.unmountComponentAtNode=function(t){if(!DN(t))throw Error(ct(40));return t._reactRootContainer?(Qm(function(){kN(null,null,t,!1,function(){t._reactRootContainer=null,t[jd]=null})}),!0):!1};oc.unstable_batchedUpdates=ZB;oc.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!DN(n))throw Error(ct(200));if(t==null||t._reactInternals===void 0)throw Error(ct(38));return kN(t,e,n,!1,r)};oc.version="18.2.0-next-9e3b772b8-20220608";function eZ(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(eZ)}catch(t){console.error(t)}}eZ(),QX.exports=oc;var a4=QX.exports;const Mm=Kf(a4);var Ez=a4;xF.createRoot=Ez.createRoot,xF.hydrateRoot=Ez.hydrateRoot;var Epe=function(e){return vpe(e)&&!ype(e)};function vpe(t){return!!t&&typeof t=="object"}function ype(t){var e=Object.prototype.toString.call(t);return e==="[object RegExp]"||e==="[object Date]"||bpe(t)}var Spe=typeof Symbol=="function"&&Symbol.for,Tpe=Spe?Symbol.for("react.element"):60103;function bpe(t){return t.$$typeof===Tpe}function wpe(t){return Array.isArray(t)?[]:{}}function S1(t,e){return e.clone!==!1&&e.isMergeableObject(t)?qT(wpe(t),t,e):t}function Cpe(t,e,n){return t.concat(e).map(function(r){return S1(r,n)})}function Rpe(t,e,n){var r={};return n.isMergeableObject(t)&&Object.keys(t).forEach(function(c){r[c]=S1(t[c],n)}),Object.keys(e).forEach(function(c){!n.isMergeableObject(e[c])||!t[c]?r[c]=S1(e[c],n):r[c]=qT(t[c],e[c],n)}),r}function qT(t,e,n){n=n||{},n.arrayMerge=n.arrayMerge||Cpe,n.isMergeableObject=n.isMergeableObject||Epe;var r=Array.isArray(e),c=Array.isArray(t),l=r===c;return l?r?n.arrayMerge(t,e,n):Rpe(t,e,n):S1(e,n)}qT.all=function(e,n){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce(function(r,c){return qT(r,c,n)},{})};var C3=qT,Ipe=typeof global=="object"&&global&&global.Object===Object&&global;const tZ=Ipe;var Ape=typeof self=="object"&&self&&self.Object===Object&&self,Ope=tZ||Ape||Function("return this")();const Pu=Ope;var Npe=Pu.Symbol;const Wf=Npe;var nZ=Object.prototype,Ppe=nZ.hasOwnProperty,xpe=nZ.toString,DS=Wf?Wf.toStringTag:void 0;function Dpe(t){var e=Ppe.call(t,DS),n=t[DS];try{t[DS]=void 0;var r=!0}catch{}var c=xpe.call(t);return r&&(e?t[DS]=n:delete t[DS]),c}var kpe=Object.prototype,Lpe=kpe.toString;function Mpe(t){return Lpe.call(t)}var Upe="[object Null]",jpe="[object Undefined]",vz=Wf?Wf.toStringTag:void 0;function fg(t){return t==null?t===void 0?jpe:Upe:vz&&vz in Object(t)?Dpe(t):Mpe(t)}function iZ(t,e){return function(n){return t(e(n))}}var Fpe=iZ(Object.getPrototypeOf,Object);const c4=Fpe;function pg(t){return t!=null&&typeof t=="object"}var Vpe="[object Object]",Bpe=Function.prototype,Wpe=Object.prototype,rZ=Bpe.toString,Hpe=Wpe.hasOwnProperty,$pe=rZ.call(Object);function yz(t){if(!pg(t)||fg(t)!=Vpe)return!1;var e=c4(t);if(e===null)return!0;var n=Hpe.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&rZ.call(n)==$pe}var Sz=Array.isArray,Tz=Object.keys,zpe=Object.prototype.hasOwnProperty,Gpe=typeof Element<"u";function R3(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){var n=Sz(t),r=Sz(e),c,l,d;if(n&&r){if(l=t.length,l!=e.length)return!1;for(c=l;c--!==0;)if(!R3(t[c],e[c]))return!1;return!0}if(n!=r)return!1;var f=t instanceof Date,m=e instanceof Date;if(f!=m)return!1;if(f&&m)return t.getTime()==e.getTime();var E=t instanceof RegExp,y=e instanceof RegExp;if(E!=y)return!1;if(E&&y)return t.toString()==e.toString();var w=Tz(t);if(l=w.length,l!==Tz(e).length)return!1;for(c=l;c--!==0;)if(!zpe.call(e,w[c]))return!1;if(Gpe&&t instanceof Element&&e instanceof Element)return t===e;for(c=l;c--!==0;)if(d=w[c],!(d==="_owner"&&t.$$typeof)&&!R3(t[d],e[d]))return!1;return!0}return t!==t&&e!==e}var Kpe=function(e,n){try{return R3(e,n)}catch(r){if(r.message&&r.message.match(/stack|recursion/i)||r.number===-2146828260)return console.warn("Warning: react-fast-compare does not handle circular references.",r.name,r.message),!1;throw r}};const Tm=Kf(Kpe);var qpe=!0;function Ype(t,e){if(!qpe){if(t)return;var n="Warning: "+e;typeof console<"u"&&console.warn(n);try{throw Error(n)}catch{}}}function Xpe(){this.__data__=[],this.size=0}function sZ(t,e){return t===e||t!==t&&e!==e}function LN(t,e){for(var n=t.length;n--;)if(sZ(t[n][0],e))return n;return-1}var Jpe=Array.prototype,Qpe=Jpe.splice;function Zpe(t){var e=this.__data__,n=LN(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():Qpe.call(e,n,1),--this.size,!0}function eme(t){var e=this.__data__,n=LN(e,t);return n<0?void 0:e[n][1]}function tme(t){return LN(this.__data__,t)>-1}function nme(t,e){var n=this.__data__,r=LN(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}function Kd(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Kd.prototype.clear=Xpe;Kd.prototype.delete=Zpe;Kd.prototype.get=eme;Kd.prototype.has=tme;Kd.prototype.set=nme;function ime(){this.__data__=new Kd,this.size=0}function rme(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}function sme(t){return this.__data__.get(t)}function ome(t){return this.__data__.has(t)}function wb(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var ame="[object AsyncFunction]",cme="[object Function]",lme="[object GeneratorFunction]",ume="[object Proxy]";function oZ(t){if(!wb(t))return!1;var e=fg(t);return e==cme||e==lme||e==ame||e==ume}var dme=Pu["__core-js_shared__"];const Ej=dme;var bz=function(){var t=/[^.]+$/.exec(Ej&&Ej.keys&&Ej.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function hme(t){return!!bz&&bz in t}var fme=Function.prototype,pme=fme.toString;function mg(t){if(t!=null){try{return pme.call(t)}catch{}try{return t+""}catch{}}return""}var mme=/[\\^$.*+?()[\]{}|]/g,gme=/^\[object .+?Constructor\]$/,_me=Function.prototype,Eme=Object.prototype,vme=_me.toString,yme=Eme.hasOwnProperty,Sme=RegExp("^"+vme.call(yme).replace(mme,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Tme(t){if(!wb(t)||hme(t))return!1;var e=oZ(t)?Sme:gme;return e.test(mg(t))}function bme(t,e){return t==null?void 0:t[e]}function gg(t,e){var n=bme(t,e);return Tme(n)?n:void 0}var wme=gg(Pu,"Map");const YT=wme;var Cme=gg(Object,"create");const XT=Cme;function Rme(){this.__data__=XT?XT(null):{},this.size=0}function Ime(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Ame="__lodash_hash_undefined__",Ome=Object.prototype,Nme=Ome.hasOwnProperty;function Pme(t){var e=this.__data__;if(XT){var n=e[t];return n===Ame?void 0:n}return Nme.call(e,t)?e[t]:void 0}var xme=Object.prototype,Dme=xme.hasOwnProperty;function kme(t){var e=this.__data__;return XT?e[t]!==void 0:Dme.call(e,t)}var Lme="__lodash_hash_undefined__";function Mme(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=XT&&e===void 0?Lme:e,this}function Zm(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Zm.prototype.clear=Rme;Zm.prototype.delete=Ime;Zm.prototype.get=Pme;Zm.prototype.has=kme;Zm.prototype.set=Mme;function Ume(){this.size=0,this.__data__={hash:new Zm,map:new(YT||Kd),string:new Zm}}function jme(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function MN(t,e){var n=t.__data__;return jme(e)?n[typeof e=="string"?"string":"hash"]:n.map}function Fme(t){var e=MN(this,t).delete(t);return this.size-=e?1:0,e}function Vme(t){return MN(this,t).get(t)}function Bme(t){return MN(this,t).has(t)}function Wme(t,e){var n=MN(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}function Jf(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Jf.prototype.clear=Ume;Jf.prototype.delete=Fme;Jf.prototype.get=Vme;Jf.prototype.has=Bme;Jf.prototype.set=Wme;var Hme=200;function $me(t,e){var n=this.__data__;if(n instanceof Kd){var r=n.__data__;if(!YT||r.length<Hme-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Jf(r)}return n.set(t,e),this.size=n.size,this}function xv(t){var e=this.__data__=new Kd(t);this.size=e.size}xv.prototype.clear=ime;xv.prototype.delete=rme;xv.prototype.get=sme;xv.prototype.has=ome;xv.prototype.set=$me;function zme(t,e){for(var n=-1,r=t==null?0:t.length;++n<r&&e(t[n],n,t)!==!1;);return t}var Gme=function(){try{var t=gg(Object,"defineProperty");return t({},"",{}),t}catch{}}();const wz=Gme;function aZ(t,e,n){e=="__proto__"&&wz?wz(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}var Kme=Object.prototype,qme=Kme.hasOwnProperty;function cZ(t,e,n){var r=t[e];(!(qme.call(t,e)&&sZ(r,n))||n===void 0&&!(e in t))&&aZ(t,e,n)}function UN(t,e,n,r){var c=!n;n||(n={});for(var l=-1,d=e.length;++l<d;){var f=e[l],m=r?r(n[f],t[f],f,n,t):void 0;m===void 0&&(m=t[f]),c?aZ(n,f,m):cZ(n,f,m)}return n}function Yme(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}var Xme="[object Arguments]";function Cz(t){return pg(t)&&fg(t)==Xme}var lZ=Object.prototype,Jme=lZ.hasOwnProperty,Qme=lZ.propertyIsEnumerable,Zme=Cz(function(){return arguments}())?Cz:function(t){return pg(t)&&Jme.call(t,"callee")&&!Qme.call(t,"callee")};const ege=Zme;var tge=Array.isArray;const Cb=tge;function nge(){return!1}var uZ=typeof ec=="object"&&ec&&!ec.nodeType&&ec,Rz=uZ&&typeof tc=="object"&&tc&&!tc.nodeType&&tc,ige=Rz&&Rz.exports===uZ,Iz=ige?Pu.Buffer:void 0,rge=Iz?Iz.isBuffer:void 0,sge=rge||nge;const dZ=sge;var oge=9007199254740991,age=/^(?:0|[1-9]\d*)$/;function cge(t,e){var n=typeof t;return e=e??oge,!!e&&(n=="number"||n!="symbol"&&age.test(t))&&t>-1&&t%1==0&&t<e}var lge=9007199254740991;function hZ(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=lge}var uge="[object Arguments]",dge="[object Array]",hge="[object Boolean]",fge="[object Date]",pge="[object Error]",mge="[object Function]",gge="[object Map]",_ge="[object Number]",Ege="[object Object]",vge="[object RegExp]",yge="[object Set]",Sge="[object String]",Tge="[object WeakMap]",bge="[object ArrayBuffer]",wge="[object DataView]",Cge="[object Float32Array]",Rge="[object Float64Array]",Ige="[object Int8Array]",Age="[object Int16Array]",Oge="[object Int32Array]",Nge="[object Uint8Array]",Pge="[object Uint8ClampedArray]",xge="[object Uint16Array]",Dge="[object Uint32Array]",ar={};ar[Cge]=ar[Rge]=ar[Ige]=ar[Age]=ar[Oge]=ar[Nge]=ar[Pge]=ar[xge]=ar[Dge]=!0;ar[uge]=ar[dge]=ar[bge]=ar[hge]=ar[wge]=ar[fge]=ar[pge]=ar[mge]=ar[gge]=ar[_ge]=ar[Ege]=ar[vge]=ar[yge]=ar[Sge]=ar[Tge]=!1;function kge(t){return pg(t)&&hZ(t.length)&&!!ar[fg(t)]}function l4(t){return function(e){return t(e)}}var fZ=typeof ec=="object"&&ec&&!ec.nodeType&&ec,ET=fZ&&typeof tc=="object"&&tc&&!tc.nodeType&&tc,Lge=ET&&ET.exports===fZ,vj=Lge&&tZ.process,Mge=function(){try{var t=ET&&ET.require&&ET.require("util").types;return t||vj&&vj.binding&&vj.binding("util")}catch{}}();const Ev=Mge;var Az=Ev&&Ev.isTypedArray,Uge=Az?l4(Az):kge;const jge=Uge;var Fge=Object.prototype,Vge=Fge.hasOwnProperty;function pZ(t,e){var n=Cb(t),r=!n&&ege(t),c=!n&&!r&&dZ(t),l=!n&&!r&&!c&&jge(t),d=n||r||c||l,f=d?Yme(t.length,String):[],m=f.length;for(var E in t)(e||Vge.call(t,E))&&!(d&&(E=="length"||c&&(E=="offset"||E=="parent")||l&&(E=="buffer"||E=="byteLength"||E=="byteOffset")||cge(E,m)))&&f.push(E);return f}var Bge=Object.prototype;function u4(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||Bge;return t===n}var Wge=iZ(Object.keys,Object);const Hge=Wge;var $ge=Object.prototype,zge=$ge.hasOwnProperty;function Gge(t){if(!u4(t))return Hge(t);var e=[];for(var n in Object(t))zge.call(t,n)&&n!="constructor"&&e.push(n);return e}function mZ(t){return t!=null&&hZ(t.length)&&!oZ(t)}function d4(t){return mZ(t)?pZ(t):Gge(t)}function Kge(t,e){return t&&UN(e,d4(e),t)}function qge(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}var Yge=Object.prototype,Xge=Yge.hasOwnProperty;function Jge(t){if(!wb(t))return qge(t);var e=u4(t),n=[];for(var r in t)r=="constructor"&&(e||!Xge.call(t,r))||n.push(r);return n}function h4(t){return mZ(t)?pZ(t,!0):Jge(t)}function Qge(t,e){return t&&UN(e,h4(e),t)}var gZ=typeof ec=="object"&&ec&&!ec.nodeType&&ec,Oz=gZ&&typeof tc=="object"&&tc&&!tc.nodeType&&tc,Zge=Oz&&Oz.exports===gZ,Nz=Zge?Pu.Buffer:void 0,Pz=Nz?Nz.allocUnsafe:void 0;function e_e(t,e){if(e)return t.slice();var n=t.length,r=Pz?Pz(n):new t.constructor(n);return t.copy(r),r}function _Z(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}function t_e(t,e){for(var n=-1,r=t==null?0:t.length,c=0,l=[];++n<r;){var d=t[n];e(d,n,t)&&(l[c++]=d)}return l}function EZ(){return[]}var n_e=Object.prototype,i_e=n_e.propertyIsEnumerable,xz=Object.getOwnPropertySymbols,r_e=xz?function(t){return t==null?[]:(t=Object(t),t_e(xz(t),function(e){return i_e.call(t,e)}))}:EZ;const f4=r_e;function s_e(t,e){return UN(t,f4(t),e)}function vZ(t,e){for(var n=-1,r=e.length,c=t.length;++n<r;)t[c+n]=e[n];return t}var o_e=Object.getOwnPropertySymbols,a_e=o_e?function(t){for(var e=[];t;)vZ(e,f4(t)),t=c4(t);return e}:EZ;const yZ=a_e;function c_e(t,e){return UN(t,yZ(t),e)}function SZ(t,e,n){var r=e(t);return Cb(t)?r:vZ(r,n(t))}function l_e(t){return SZ(t,d4,f4)}function u_e(t){return SZ(t,h4,yZ)}var d_e=gg(Pu,"DataView");const I3=d_e;var h_e=gg(Pu,"Promise");const A3=h_e;var f_e=gg(Pu,"Set");const O3=f_e;var p_e=gg(Pu,"WeakMap");const N3=p_e;var Dz="[object Map]",m_e="[object Object]",kz="[object Promise]",Lz="[object Set]",Mz="[object WeakMap]",Uz="[object DataView]",g_e=mg(I3),__e=mg(YT),E_e=mg(A3),v_e=mg(O3),y_e=mg(N3),bm=fg;(I3&&bm(new I3(new ArrayBuffer(1)))!=Uz||YT&&bm(new YT)!=Dz||A3&&bm(A3.resolve())!=kz||O3&&bm(new O3)!=Lz||N3&&bm(new N3)!=Mz)&&(bm=function(t){var e=fg(t),n=e==m_e?t.constructor:void 0,r=n?mg(n):"";if(r)switch(r){case g_e:return Uz;case __e:return Dz;case E_e:return kz;case v_e:return Lz;case y_e:return Mz}return e});const p4=bm;var S_e=Object.prototype,T_e=S_e.hasOwnProperty;function b_e(t){var e=t.length,n=new t.constructor(e);return e&&typeof t[0]=="string"&&T_e.call(t,"index")&&(n.index=t.index,n.input=t.input),n}var w_e=Pu.Uint8Array;const jz=w_e;function m4(t){var e=new t.constructor(t.byteLength);return new jz(e).set(new jz(t)),e}function C_e(t,e){var n=e?m4(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}var R_e=/\w*$/;function I_e(t){var e=new t.constructor(t.source,R_e.exec(t));return e.lastIndex=t.lastIndex,e}var Fz=Wf?Wf.prototype:void 0,Vz=Fz?Fz.valueOf:void 0;function A_e(t){return Vz?Object(Vz.call(t)):{}}function O_e(t,e){var n=e?m4(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}var N_e="[object Boolean]",P_e="[object Date]",x_e="[object Map]",D_e="[object Number]",k_e="[object RegExp]",L_e="[object Set]",M_e="[object String]",U_e="[object Symbol]",j_e="[object ArrayBuffer]",F_e="[object DataView]",V_e="[object Float32Array]",B_e="[object Float64Array]",W_e="[object Int8Array]",H_e="[object Int16Array]",$_e="[object Int32Array]",z_e="[object Uint8Array]",G_e="[object Uint8ClampedArray]",K_e="[object Uint16Array]",q_e="[object Uint32Array]";function Y_e(t,e,n){var r=t.constructor;switch(e){case j_e:return m4(t);case N_e:case P_e:return new r(+t);case F_e:return C_e(t,n);case V_e:case B_e:case W_e:case H_e:case $_e:case z_e:case G_e:case K_e:case q_e:return O_e(t,n);case x_e:return new r;case D_e:case M_e:return new r(t);case k_e:return I_e(t);case L_e:return new r;case U_e:return A_e(t)}}var Bz=Object.create,X_e=function(){function t(){}return function(e){if(!wb(e))return{};if(Bz)return Bz(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();const J_e=X_e;function Q_e(t){return typeof t.constructor=="function"&&!u4(t)?J_e(c4(t)):{}}var Z_e="[object Map]";function eEe(t){return pg(t)&&p4(t)==Z_e}var Wz=Ev&&Ev.isMap,tEe=Wz?l4(Wz):eEe;const nEe=tEe;var iEe="[object Set]";function rEe(t){return pg(t)&&p4(t)==iEe}var Hz=Ev&&Ev.isSet,sEe=Hz?l4(Hz):rEe;const oEe=sEe;var aEe=1,cEe=2,lEe=4,TZ="[object Arguments]",uEe="[object Array]",dEe="[object Boolean]",hEe="[object Date]",fEe="[object Error]",bZ="[object Function]",pEe="[object GeneratorFunction]",mEe="[object Map]",gEe="[object Number]",wZ="[object Object]",_Ee="[object RegExp]",EEe="[object Set]",vEe="[object String]",yEe="[object Symbol]",SEe="[object WeakMap]",TEe="[object ArrayBuffer]",bEe="[object DataView]",wEe="[object Float32Array]",CEe="[object Float64Array]",REe="[object Int8Array]",IEe="[object Int16Array]",AEe="[object Int32Array]",OEe="[object Uint8Array]",NEe="[object Uint8ClampedArray]",PEe="[object Uint16Array]",xEe="[object Uint32Array]",Yi={};Yi[TZ]=Yi[uEe]=Yi[TEe]=Yi[bEe]=Yi[dEe]=Yi[hEe]=Yi[wEe]=Yi[CEe]=Yi[REe]=Yi[IEe]=Yi[AEe]=Yi[mEe]=Yi[gEe]=Yi[wZ]=Yi[_Ee]=Yi[EEe]=Yi[vEe]=Yi[yEe]=Yi[OEe]=Yi[NEe]=Yi[PEe]=Yi[xEe]=!0;Yi[fEe]=Yi[bZ]=Yi[SEe]=!1;function OO(t,e,n,r,c,l){var d,f=e&aEe,m=e&cEe,E=e&lEe;if(n&&(d=c?n(t,r,c,l):n(t)),d!==void 0)return d;if(!wb(t))return t;var y=Cb(t);if(y){if(d=b_e(t),!f)return _Z(t,d)}else{var w=p4(t),I=w==bZ||w==pEe;if(dZ(t))return e_e(t,f);if(w==wZ||w==TZ||I&&!c){if(d=m||I?{}:Q_e(t),!f)return m?c_e(t,Qge(d,t)):s_e(t,Kge(d,t))}else{if(!Yi[w])return c?t:{};d=Y_e(t,w,f)}}l||(l=new xv);var P=l.get(t);if(P)return P;l.set(t,d),oEe(t)?t.forEach(function(K){d.add(OO(K,e,n,K,t,l))}):nEe(t)&&t.forEach(function(K,W){d.set(W,OO(K,e,n,W,t,l))});var k=E?m?u_e:l_e:m?h4:d4,M=y?void 0:k(t);return zme(M||t,function(K,W){M&&(W=K,K=t[W]),cZ(d,W,OO(K,e,n,W,t,l))}),d}var DEe=4;function $z(t){return OO(t,DEe)}function CZ(t,e){for(var n=-1,r=t==null?0:t.length,c=Array(r);++n<r;)c[n]=e(t[n],n,t);return c}var kEe="[object Symbol]";function g4(t){return typeof t=="symbol"||pg(t)&&fg(t)==kEe}var LEe="Expected a function";function _4(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(LEe);var n=function(){var r=arguments,c=e?e.apply(this,r):r[0],l=n.cache;if(l.has(c))return l.get(c);var d=t.apply(this,r);return n.cache=l.set(c,d)||l,d};return n.cache=new(_4.Cache||Jf),n}_4.Cache=Jf;var MEe=500;function UEe(t){var e=_4(t,function(r){return n.size===MEe&&n.clear(),r}),n=e.cache;return e}var jEe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,FEe=/\\(\\)?/g,VEe=UEe(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(jEe,function(n,r,c,l){e.push(c?l.replace(FEe,"$1"):r||n)}),e});const BEe=VEe;var WEe=1/0;function HEe(t){if(typeof t=="string"||g4(t))return t;var e=t+"";return e=="0"&&1/t==-WEe?"-0":e}var $Ee=1/0,zz=Wf?Wf.prototype:void 0,Gz=zz?zz.toString:void 0;function RZ(t){if(typeof t=="string")return t;if(Cb(t))return CZ(t,RZ)+"";if(g4(t))return Gz?Gz.call(t):"";var e=t+"";return e=="0"&&1/t==-$Ee?"-0":e}function zEe(t){return t==null?"":RZ(t)}function IZ(t){return Cb(t)?CZ(t,HEe):g4(t)?[t]:_Z(BEe(zEe(t)))}var AZ={exports:{}},Ti={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ls=typeof Symbol=="function"&&Symbol.for,E4=Ls?Symbol.for("react.element"):60103,v4=Ls?Symbol.for("react.portal"):60106,jN=Ls?Symbol.for("react.fragment"):60107,FN=Ls?Symbol.for("react.strict_mode"):60108,VN=Ls?Symbol.for("react.profiler"):60114,BN=Ls?Symbol.for("react.provider"):60109,WN=Ls?Symbol.for("react.context"):60110,y4=Ls?Symbol.for("react.async_mode"):60111,HN=Ls?Symbol.for("react.concurrent_mode"):60111,$N=Ls?Symbol.for("react.forward_ref"):60112,zN=Ls?Symbol.for("react.suspense"):60113,GEe=Ls?Symbol.for("react.suspense_list"):60120,GN=Ls?Symbol.for("react.memo"):60115,KN=Ls?Symbol.for("react.lazy"):60116,KEe=Ls?Symbol.for("react.block"):60121,qEe=Ls?Symbol.for("react.fundamental"):60117,YEe=Ls?Symbol.for("react.responder"):60118,XEe=Ls?Symbol.for("react.scope"):60119;function cc(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case E4:switch(t=t.type,t){case y4:case HN:case jN:case VN:case FN:case zN:return t;default:switch(t=t&&t.$$typeof,t){case WN:case $N:case KN:case GN:case BN:return t;default:return e}}case v4:return e}}}function OZ(t){return cc(t)===HN}Ti.AsyncMode=y4;Ti.ConcurrentMode=HN;Ti.ContextConsumer=WN;Ti.ContextProvider=BN;Ti.Element=E4;Ti.ForwardRef=$N;Ti.Fragment=jN;Ti.Lazy=KN;Ti.Memo=GN;Ti.Portal=v4;Ti.Profiler=VN;Ti.StrictMode=FN;Ti.Suspense=zN;Ti.isAsyncMode=function(t){return OZ(t)||cc(t)===y4};Ti.isConcurrentMode=OZ;Ti.isContextConsumer=function(t){return cc(t)===WN};Ti.isContextProvider=function(t){return cc(t)===BN};Ti.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===E4};Ti.isForwardRef=function(t){return cc(t)===$N};Ti.isFragment=function(t){return cc(t)===jN};Ti.isLazy=function(t){return cc(t)===KN};Ti.isMemo=function(t){return cc(t)===GN};Ti.isPortal=function(t){return cc(t)===v4};Ti.isProfiler=function(t){return cc(t)===VN};Ti.isStrictMode=function(t){return cc(t)===FN};Ti.isSuspense=function(t){return cc(t)===zN};Ti.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===jN||t===HN||t===VN||t===FN||t===zN||t===GEe||typeof t=="object"&&t!==null&&(t.$$typeof===KN||t.$$typeof===GN||t.$$typeof===BN||t.$$typeof===WN||t.$$typeof===$N||t.$$typeof===qEe||t.$$typeof===YEe||t.$$typeof===XEe||t.$$typeof===KEe)};Ti.typeOf=cc;AZ.exports=Ti;var JEe=AZ.exports,NZ=JEe,QEe={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},ZEe={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},PZ={};PZ[NZ.ForwardRef]=QEe;PZ[NZ.Memo]=ZEe;function Ns(){return Ns=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ns.apply(this,arguments)}function xZ(t,e){if(t==null)return{};var n={},r=Object.keys(t),c,l;for(l=0;l<r.length;l++)c=r[l],!(e.indexOf(c)>=0)&&(n[c]=t[c]);return n}var qN=$.createContext(void 0);qN.displayName="FormikContext";qN.Provider;qN.Consumer;function eve(){var t=$.useContext(qN);return t||Ype(!1),t}var ll=function(e){return typeof e=="function"},YN=function(e){return e!==null&&typeof e=="object"},tve=function(e){return String(Math.floor(Number(e)))===e},yj=function(e){return Object.prototype.toString.call(e)==="[object String]"},Sj=function(e){return YN(e)&&ll(e.then)};function Xa(t,e,n,r){r===void 0&&(r=0);for(var c=IZ(e);t&&r<c.length;)t=t[c[r++]];return r!==c.length&&!t||t===void 0?n:t}function Hm(t,e,n){for(var r=$z(t),c=r,l=0,d=IZ(e);l<d.length-1;l++){var f=d[l],m=Xa(t,d.slice(0,l+1));if(m&&(YN(m)||Array.isArray(m)))c=c[f]=$z(m);else{var E=d[l+1];c=c[f]=tve(E)&&Number(E)>=0?[]:{}}}return(l===0?t:c)[d[l]]===n?t:(n===void 0?delete c[d[l]]:c[d[l]]=n,l===0&&n===void 0&&delete r[d[l]],r)}function DZ(t,e,n,r){n===void 0&&(n=new WeakMap),r===void 0&&(r={});for(var c=0,l=Object.keys(t);c<l.length;c++){var d=l[c],f=t[d];YN(f)?n.get(f)||(n.set(f,!0),r[d]=Array.isArray(f)?[]:{},DZ(f,e,n,r[d])):r[d]=e}return r}function nve(t,e){switch(e.type){case"SET_VALUES":return Ns({},t,{values:e.payload});case"SET_TOUCHED":return Ns({},t,{touched:e.payload});case"SET_ERRORS":return Tm(t.errors,e.payload)?t:Ns({},t,{errors:e.payload});case"SET_STATUS":return Ns({},t,{status:e.payload});case"SET_ISSUBMITTING":return Ns({},t,{isSubmitting:e.payload});case"SET_ISVALIDATING":return Ns({},t,{isValidating:e.payload});case"SET_FIELD_VALUE":return Ns({},t,{values:Hm(t.values,e.payload.field,e.payload.value)});case"SET_FIELD_TOUCHED":return Ns({},t,{touched:Hm(t.touched,e.payload.field,e.payload.value)});case"SET_FIELD_ERROR":return Ns({},t,{errors:Hm(t.errors,e.payload.field,e.payload.value)});case"RESET_FORM":return Ns({},t,e.payload);case"SET_FORMIK_STATE":return e.payload(t);case"SUBMIT_ATTEMPT":return Ns({},t,{touched:DZ(t.values,!0),isSubmitting:!0,submitCount:t.submitCount+1});case"SUBMIT_FAILURE":return Ns({},t,{isSubmitting:!1});case"SUBMIT_SUCCESS":return Ns({},t,{isSubmitting:!1});default:return t}}var dm={},UA={};function XN(t){var e=t.validateOnChange,n=e===void 0?!0:e,r=t.validateOnBlur,c=r===void 0?!0:r,l=t.validateOnMount,d=l===void 0?!1:l,f=t.isInitialValid,m=t.enableReinitialize,E=m===void 0?!1:m,y=t.onSubmit,w=xZ(t,["validateOnChange","validateOnBlur","validateOnMount","isInitialValid","enableReinitialize","onSubmit"]),I=Ns({validateOnChange:n,validateOnBlur:c,validateOnMount:d,onSubmit:y},w),P=$.useRef(I.initialValues),k=$.useRef(I.initialErrors||dm),M=$.useRef(I.initialTouched||UA),K=$.useRef(I.initialStatus),W=$.useRef(!1),V=$.useRef({});$.useEffect(function(){return W.current=!0,function(){W.current=!1}},[]);var G=$.useState(0),Q=G[1],Z=$.useRef({values:I.initialValues,errors:I.initialErrors||dm,touched:I.initialTouched||UA,status:I.initialStatus,isSubmitting:!1,isValidating:!1,submitCount:0}),Y=Z.current,oe=$.useCallback(function(Ne){var dt=Z.current;Z.current=nve(dt,Ne),dt!==Z.current&&Q(function(Et){return Et+1})},[]),ce=$.useCallback(function(Ne,dt){return new Promise(function(Et,st){var Ot=I.validate(Ne,dt);Ot==null?Et(dm):Sj(Ot)?Ot.then(function(Qt){Et(Qt||dm)},function(Qt){st(Qt)}):Et(Ot)})},[I.validate]),Se=$.useCallback(function(Ne,dt){var Et=I.validationSchema,st=ll(Et)?Et(dt):Et,Ot=dt&&st.validateAt?st.validateAt(dt,Ne):rve(Ne,st);return new Promise(function(Qt,kt){Ot.then(function(){Qt(dm)},function(Lt){Lt.name==="ValidationError"?Qt(ive(Lt)):kt(Lt)})})},[I.validationSchema]),xe=$.useCallback(function(Ne,dt){return new Promise(function(Et){return Et(V.current[Ne].validate(dt))})},[]),je=$.useCallback(function(Ne){var dt=Object.keys(V.current).filter(function(st){return ll(V.current[st].validate)}),Et=dt.length>0?dt.map(function(st){return xe(st,Xa(Ne,st))}):[Promise.resolve("DO_NOT_DELETE_YOU_WILL_BE_FIRED")];return Promise.all(Et).then(function(st){return st.reduce(function(Ot,Qt,kt){return Qt==="DO_NOT_DELETE_YOU_WILL_BE_FIRED"||Qt&&(Ot=Hm(Ot,dt[kt],Qt)),Ot},{})})},[xe]),Ge=$.useCallback(function(Ne){return Promise.all([je(Ne),I.validationSchema?Se(Ne):{},I.validate?ce(Ne):{}]).then(function(dt){var Et=dt[0],st=dt[1],Ot=dt[2],Qt=C3.all([Et,st,Ot],{arrayMerge:sve});return Qt})},[I.validate,I.validationSchema,je,ce,Se]),ze=wc(function(Ne){return Ne===void 0&&(Ne=Y.values),oe({type:"SET_ISVALIDATING",payload:!0}),Ge(Ne).then(function(dt){return W.current&&(oe({type:"SET_ISVALIDATING",payload:!1}),oe({type:"SET_ERRORS",payload:dt})),dt})});$.useEffect(function(){d&&W.current===!0&&Tm(P.current,I.initialValues)&&ze(P.current)},[d,ze]);var Ke=$.useCallback(function(Ne){var dt=Ne&&Ne.values?Ne.values:P.current,Et=Ne&&Ne.errors?Ne.errors:k.current?k.current:I.initialErrors||{},st=Ne&&Ne.touched?Ne.touched:M.current?M.current:I.initialTouched||{},Ot=Ne&&Ne.status?Ne.status:K.current?K.current:I.initialStatus;P.current=dt,k.current=Et,M.current=st,K.current=Ot;var Qt=function(){oe({type:"RESET_FORM",payload:{isSubmitting:!!Ne&&!!Ne.isSubmitting,errors:Et,touched:st,status:Ot,values:dt,isValidating:!!Ne&&!!Ne.isValidating,submitCount:Ne&&Ne.submitCount&&typeof Ne.submitCount=="number"?Ne.submitCount:0}})};if(I.onReset){var kt=I.onReset(Y.values,ui);Sj(kt)?kt.then(Qt):Qt()}else Qt()},[I.initialErrors,I.initialStatus,I.initialTouched,I.onReset]);$.useEffect(function(){W.current===!0&&!Tm(P.current,I.initialValues)&&E&&(P.current=I.initialValues,Ke(),d&&ze(P.current))},[E,I.initialValues,Ke,d,ze]),$.useEffect(function(){E&&W.current===!0&&!Tm(k.current,I.initialErrors)&&(k.current=I.initialErrors||dm,oe({type:"SET_ERRORS",payload:I.initialErrors||dm}))},[E,I.initialErrors]),$.useEffect(function(){E&&W.current===!0&&!Tm(M.current,I.initialTouched)&&(M.current=I.initialTouched||UA,oe({type:"SET_TOUCHED",payload:I.initialTouched||UA}))},[E,I.initialTouched]),$.useEffect(function(){E&&W.current===!0&&!Tm(K.current,I.initialStatus)&&(K.current=I.initialStatus,oe({type:"SET_STATUS",payload:I.initialStatus}))},[E,I.initialStatus,I.initialTouched]);var He=wc(function(Ne){if(V.current[Ne]&&ll(V.current[Ne].validate)){var dt=Xa(Y.values,Ne),Et=V.current[Ne].validate(dt);return Sj(Et)?(oe({type:"SET_ISVALIDATING",payload:!0}),Et.then(function(st){return st}).then(function(st){oe({type:"SET_FIELD_ERROR",payload:{field:Ne,value:st}}),oe({type:"SET_ISVALIDATING",payload:!1})})):(oe({type:"SET_FIELD_ERROR",payload:{field:Ne,value:Et}}),Promise.resolve(Et))}else if(I.validationSchema)return oe({type:"SET_ISVALIDATING",payload:!0}),Se(Y.values,Ne).then(function(st){return st}).then(function(st){oe({type:"SET_FIELD_ERROR",payload:{field:Ne,value:Xa(st,Ne)}}),oe({type:"SET_ISVALIDATING",payload:!1})});return Promise.resolve()}),be=$.useCallback(function(Ne,dt){var Et=dt.validate;V.current[Ne]={validate:Et}},[]),Oe=$.useCallback(function(Ne){delete V.current[Ne]},[]),_e=wc(function(Ne,dt){oe({type:"SET_TOUCHED",payload:Ne});var Et=dt===void 0?c:dt;return Et?ze(Y.values):Promise.resolve()}),We=$.useCallback(function(Ne){oe({type:"SET_ERRORS",payload:Ne})},[]),Ie=wc(function(Ne,dt){var Et=ll(Ne)?Ne(Y.values):Ne;oe({type:"SET_VALUES",payload:Et});var st=dt===void 0?n:dt;return st?ze(Et):Promise.resolve()}),De=$.useCallback(function(Ne,dt){oe({type:"SET_FIELD_ERROR",payload:{field:Ne,value:dt}})},[]),Ue=wc(function(Ne,dt,Et){oe({type:"SET_FIELD_VALUE",payload:{field:Ne,value:dt}});var st=Et===void 0?n:Et;return st?ze(Hm(Y.values,Ne,dt)):Promise.resolve()}),rt=$.useCallback(function(Ne,dt){var Et=dt,st=Ne,Ot;if(!yj(Ne)){Ne.persist&&Ne.persist();var Qt=Ne.target?Ne.target:Ne.currentTarget,kt=Qt.type,Lt=Qt.name,Ut=Qt.id,Dn=Qt.value,xt=Qt.checked,Mt=Qt.outerHTML,Nt=Qt.options,ni=Qt.multiple;Et=dt||Lt||Ut,st=/number|range/.test(kt)?(Ot=parseFloat(Dn),isNaN(Ot)?"":Ot):/checkbox/.test(kt)?ave(Xa(Y.values,Et),xt,Dn):Nt&&ni?ove(Nt):Dn}Et&&Ue(Et,st)},[Ue,Y.values]),gt=wc(function(Ne){if(yj(Ne))return function(dt){return rt(dt,Ne)};rt(Ne)}),ft=wc(function(Ne,dt,Et){dt===void 0&&(dt=!0),oe({type:"SET_FIELD_TOUCHED",payload:{field:Ne,value:dt}});var st=Et===void 0?c:Et;return st?ze(Y.values):Promise.resolve()}),Ft=$.useCallback(function(Ne,dt){Ne.persist&&Ne.persist();var Et=Ne.target,st=Et.name,Ot=Et.id,Qt=Et.outerHTML,kt=dt||st||Ot;ft(kt,!0)},[ft]),qt=wc(function(Ne){if(yj(Ne))return function(dt){return Ft(dt,Ne)};Ft(Ne)}),ti=$.useCallback(function(Ne){ll(Ne)?oe({type:"SET_FORMIK_STATE",payload:Ne}):oe({type:"SET_FORMIK_STATE",payload:function(){return Ne}})},[]),Vt=$.useCallback(function(Ne){oe({type:"SET_STATUS",payload:Ne})},[]),xn=$.useCallback(function(Ne){oe({type:"SET_ISSUBMITTING",payload:Ne})},[]),En=wc(function(){return oe({type:"SUBMIT_ATTEMPT"}),ze().then(function(Ne){var dt=Ne instanceof Error,Et=!dt&&Object.keys(Ne).length===0;if(Et){var st;try{if(st=rn(),st===void 0)return}catch(Ot){throw Ot}return Promise.resolve(st).then(function(Ot){return W.current&&oe({type:"SUBMIT_SUCCESS"}),Ot}).catch(function(Ot){if(W.current)throw oe({type:"SUBMIT_FAILURE"}),Ot})}else if(W.current&&(oe({type:"SUBMIT_FAILURE"}),dt))throw Ne})}),Di=wc(function(Ne){Ne&&Ne.preventDefault&&ll(Ne.preventDefault)&&Ne.preventDefault(),Ne&&Ne.stopPropagation&&ll(Ne.stopPropagation)&&Ne.stopPropagation(),En().catch(function(dt){console.warn("Warning: An unhandled error was caught from submitForm()",dt)})}),ui={resetForm:Ke,validateForm:ze,validateField:He,setErrors:We,setFieldError:De,setFieldTouched:ft,setFieldValue:Ue,setStatus:Vt,setSubmitting:xn,setTouched:_e,setValues:Ie,setFormikState:ti,submitForm:En},rn=wc(function(){return y(Y.values,ui)}),Rn=wc(function(Ne){Ne&&Ne.preventDefault&&ll(Ne.preventDefault)&&Ne.preventDefault(),Ne&&Ne.stopPropagation&&ll(Ne.stopPropagation)&&Ne.stopPropagation(),Ke()}),us=$.useCallback(function(Ne){return{value:Xa(Y.values,Ne),error:Xa(Y.errors,Ne),touched:!!Xa(Y.touched,Ne),initialValue:Xa(P.current,Ne),initialTouched:!!Xa(M.current,Ne),initialError:Xa(k.current,Ne)}},[Y.errors,Y.touched,Y.values]),di=$.useCallback(function(Ne){return{setValue:function(Et,st){return Ue(Ne,Et,st)},setTouched:function(Et,st){return ft(Ne,Et,st)},setError:function(Et){return De(Ne,Et)}}},[Ue,ft,De]),Go=$.useCallback(function(Ne){var dt=YN(Ne),Et=dt?Ne.name:Ne,st=Xa(Y.values,Et),Ot={name:Et,value:st,onChange:gt,onBlur:qt};if(dt){var Qt=Ne.type,kt=Ne.value,Lt=Ne.as,Ut=Ne.multiple;Qt==="checkbox"?kt===void 0?Ot.checked=!!st:(Ot.checked=!!(Array.isArray(st)&&~st.indexOf(kt)),Ot.value=kt):Qt==="radio"?(Ot.checked=st===kt,Ot.value=kt):Lt==="select"&&Ut&&(Ot.value=Ot.value||[],Ot.multiple=!0)}return Ot},[qt,gt,Y.values]),qr=$.useMemo(function(){return!Tm(P.current,Y.values)},[P.current,Y.values]),Zi=$.useMemo(function(){return typeof f<"u"?qr?Y.errors&&Object.keys(Y.errors).length===0:f!==!1&&ll(f)?f(I):f:Y.errors&&Object.keys(Y.errors).length===0},[f,qr,Y.errors,I]),wi=Ns({},Y,{initialValues:P.current,initialErrors:k.current,initialTouched:M.current,initialStatus:K.current,handleBlur:qt,handleChange:gt,handleReset:Rn,handleSubmit:Di,resetForm:Ke,setErrors:We,setFormikState:ti,setFieldTouched:ft,setFieldValue:Ue,setFieldError:De,setStatus:Vt,setSubmitting:xn,setTouched:_e,setValues:Ie,submitForm:En,validateForm:ze,validateField:He,isValid:Zi,dirty:qr,unregisterField:Oe,registerField:be,getFieldProps:Go,getFieldMeta:us,getFieldHelpers:di,validateOnBlur:c,validateOnChange:n,validateOnMount:d});return wi}function ive(t){var e={};if(t.inner){if(t.inner.length===0)return Hm(e,t.path,t.message);for(var c=t.inner,n=Array.isArray(c),r=0,c=n?c:c[Symbol.iterator]();;){var l;if(n){if(r>=c.length)break;l=c[r++]}else{if(r=c.next(),r.done)break;l=r.value}var d=l;Xa(e,d.path)||(e=Hm(e,d.path,d.message))}}return e}function rve(t,e,n,r){n===void 0&&(n=!1);var c=P3(t);return e[n?"validateSync":"validate"](c,{abortEarly:!1,context:r||c})}function P3(t){var e=Array.isArray(t)?[]:{};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=String(n);Array.isArray(t[r])===!0?e[r]=t[r].map(function(c){return Array.isArray(c)===!0||yz(c)?P3(c):c!==""?c:void 0}):yz(t[r])?e[r]=P3(t[r]):e[r]=t[r]!==""?t[r]:void 0}return e}function sve(t,e,n){var r=t.slice();return e.forEach(function(l,d){if(typeof r[d]>"u"){var f=n.clone!==!1,m=f&&n.isMergeableObject(l);r[d]=m?C3(Array.isArray(l)?[]:{},l,n):l}else n.isMergeableObject(l)?r[d]=C3(t[d],l,n):t.indexOf(l)===-1&&r.push(l)}),r}function ove(t){return Array.from(t).filter(function(e){return e.selected}).map(function(e){return e.value})}function ave(t,e,n){if(typeof t=="boolean")return!!e;var r=[],c=!1,l=-1;if(Array.isArray(t))r=t,l=t.indexOf(n),c=l>=0;else if(!n||n=="true"||n=="false")return!!e;return e&&n&&!c?r.concat(n):c?r.slice(0,l).concat(r.slice(l+1)):r}var cve=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?$.useLayoutEffect:$.useEffect;function wc(t){var e=$.useRef(t);return cve(function(){e.current=t}),$.useCallback(function(){for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return e.current.apply(void 0,r)},[])}var lve=$.forwardRef(function(t,e){var n=t.action,r=xZ(t,["action"]),c=n??"#",l=eve(),d=l.handleReset,f=l.handleSubmit;return $.createElement("form",Ns({onSubmit:f,ref:e,onReset:d,action:c},r))});lve.displayName="Form";function kZ(t,e){return function(){return t.apply(e,arguments)}}const{toString:uve}=Object.prototype,{getPrototypeOf:S4}=Object,JN=(t=>e=>{const n=uve.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),xu=t=>(t=t.toLowerCase(),e=>JN(e)===t),QN=t=>e=>typeof e===t,{isArray:Dv}=Array,JT=QN("undefined");function dve(t){return t!==null&&!JT(t)&&t.constructor!==null&&!JT(t.constructor)&&Mc(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const LZ=xu("ArrayBuffer");function hve(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&LZ(t.buffer),e}const fve=QN("string"),Mc=QN("function"),MZ=QN("number"),ZN=t=>t!==null&&typeof t=="object",pve=t=>t===!0||t===!1,NO=t=>{if(JN(t)!=="object")return!1;const e=S4(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},mve=xu("Date"),gve=xu("File"),_ve=xu("Blob"),Eve=xu("FileList"),vve=t=>ZN(t)&&Mc(t.pipe),yve=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Mc(t.append)&&((e=JN(t))==="formdata"||e==="object"&&Mc(t.toString)&&t.toString()==="[object FormData]"))},Sve=xu("URLSearchParams"),Tve=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Rb(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let r,c;if(typeof t!="object"&&(t=[t]),Dv(t))for(r=0,c=t.length;r<c;r++)e.call(null,t[r],r,t);else{const l=n?Object.getOwnPropertyNames(t):Object.keys(t),d=l.length;let f;for(r=0;r<d;r++)f=l[r],e.call(null,t[f],f,t)}}function UZ(t,e){e=e.toLowerCase();const n=Object.keys(t);let r=n.length,c;for(;r-- >0;)if(c=n[r],e===c.toLowerCase())return c;return null}const jZ=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),FZ=t=>!JT(t)&&t!==jZ;function x3(){const{caseless:t}=FZ(this)&&this||{},e={},n=(r,c)=>{const l=t&&UZ(e,c)||c;NO(e[l])&&NO(r)?e[l]=x3(e[l],r):NO(r)?e[l]=x3({},r):Dv(r)?e[l]=r.slice():e[l]=r};for(let r=0,c=arguments.length;r<c;r++)arguments[r]&&Rb(arguments[r],n);return e}const bve=(t,e,n,{allOwnKeys:r}={})=>(Rb(e,(c,l)=>{n&&Mc(c)?t[l]=kZ(c,n):t[l]=c},{allOwnKeys:r}),t),wve=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),Cve=(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},Rve=(t,e,n,r)=>{let c,l,d;const f={};if(e=e||{},t==null)return e;do{for(c=Object.getOwnPropertyNames(t),l=c.length;l-- >0;)d=c[l],(!r||r(d,t,e))&&!f[d]&&(e[d]=t[d],f[d]=!0);t=n!==!1&&S4(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},Ive=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return r!==-1&&r===n},Ave=t=>{if(!t)return null;if(Dv(t))return t;let e=t.length;if(!MZ(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},Ove=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&S4(Uint8Array)),Nve=(t,e)=>{const r=(t&&t[Symbol.iterator]).call(t);let c;for(;(c=r.next())&&!c.done;){const l=c.value;e.call(t,l[0],l[1])}},Pve=(t,e)=>{let n;const r=[];for(;(n=t.exec(e))!==null;)r.push(n);return r},xve=xu("HTMLFormElement"),Dve=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,c){return r.toUpperCase()+c}),Kz=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),kve=xu("RegExp"),VZ=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};Rb(n,(c,l)=>{let d;(d=e(c,l,t))!==!1&&(r[l]=d||c)}),Object.defineProperties(t,r)},Lve=t=>{VZ(t,(e,n)=>{if(Mc(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=t[n];if(Mc(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},Mve=(t,e)=>{const n={},r=c=>{c.forEach(l=>{n[l]=!0})};return Dv(t)?r(t):r(String(t).split(e)),n},Uve=()=>{},jve=(t,e)=>(t=+t,Number.isFinite(t)?t:e),Tj="abcdefghijklmnopqrstuvwxyz",qz="0123456789",BZ={DIGIT:qz,ALPHA:Tj,ALPHA_DIGIT:Tj+Tj.toUpperCase()+qz},Fve=(t=16,e=BZ.ALPHA_DIGIT)=>{let n="";const{length:r}=e;for(;t--;)n+=e[Math.random()*r|0];return n};function Vve(t){return!!(t&&Mc(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const Bve=t=>{const e=new Array(10),n=(r,c)=>{if(ZN(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[c]=r;const l=Dv(r)?[]:{};return Rb(r,(d,f)=>{const m=n(d,c+1);!JT(m)&&(l[f]=m)}),e[c]=void 0,l}}return r};return n(t,0)},Wve=xu("AsyncFunction"),Hve=t=>t&&(ZN(t)||Mc(t))&&Mc(t.then)&&Mc(t.catch),Je={isArray:Dv,isArrayBuffer:LZ,isBuffer:dve,isFormData:yve,isArrayBufferView:hve,isString:fve,isNumber:MZ,isBoolean:pve,isObject:ZN,isPlainObject:NO,isUndefined:JT,isDate:mve,isFile:gve,isBlob:_ve,isRegExp:kve,isFunction:Mc,isStream:vve,isURLSearchParams:Sve,isTypedArray:Ove,isFileList:Eve,forEach:Rb,merge:x3,extend:bve,trim:Tve,stripBOM:wve,inherits:Cve,toFlatObject:Rve,kindOf:JN,kindOfTest:xu,endsWith:Ive,toArray:Ave,forEachEntry:Nve,matchAll:Pve,isHTMLForm:xve,hasOwnProperty:Kz,hasOwnProp:Kz,reduceDescriptors:VZ,freezeMethods:Lve,toObjectSet:Mve,toCamelCase:Dve,noop:Uve,toFiniteNumber:jve,findKey:UZ,global:jZ,isContextDefined:FZ,ALPHABET:BZ,generateString:Fve,isSpecCompliantForm:Vve,toJSONObject:Bve,isAsyncFn:Wve,isThenable:Hve};function Zn(t,e,n,r,c){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),c&&(this.response=c)}Je.inherits(Zn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Je.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const WZ=Zn.prototype,HZ={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{HZ[t]={value:t}});Object.defineProperties(Zn,HZ);Object.defineProperty(WZ,"isAxiosError",{value:!0});Zn.from=(t,e,n,r,c,l)=>{const d=Object.create(WZ);return Je.toFlatObject(t,d,function(m){return m!==Error.prototype},f=>f!=="isAxiosError"),Zn.call(d,t.message,e,n,r,c),d.cause=t,d.name=t.name,l&&Object.assign(d,l),d};const $ve=null;function D3(t){return Je.isPlainObject(t)||Je.isArray(t)}function $Z(t){return Je.endsWith(t,"[]")?t.slice(0,-2):t}function Yz(t,e,n){return t?t.concat(e).map(function(c,l){return c=$Z(c),!n&&l?"["+c+"]":c}).join(n?".":""):e}function zve(t){return Je.isArray(t)&&!t.some(D3)}const Gve=Je.toFlatObject(Je,{},null,function(e){return/^is[A-Z]/.test(e)});function eP(t,e,n){if(!Je.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=Je.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(M,K){return!Je.isUndefined(K[M])});const r=n.metaTokens,c=n.visitor||y,l=n.dots,d=n.indexes,m=(n.Blob||typeof Blob<"u"&&Blob)&&Je.isSpecCompliantForm(e);if(!Je.isFunction(c))throw new TypeError("visitor must be a function");function E(k){if(k===null)return"";if(Je.isDate(k))return k.toISOString();if(!m&&Je.isBlob(k))throw new Zn("Blob is not supported. Use a Buffer instead.");return Je.isArrayBuffer(k)||Je.isTypedArray(k)?m&&typeof Blob=="function"?new Blob([k]):Buffer.from(k):k}function y(k,M,K){let W=k;if(k&&!K&&typeof k=="object"){if(Je.endsWith(M,"{}"))M=r?M:M.slice(0,-2),k=JSON.stringify(k);else if(Je.isArray(k)&&zve(k)||(Je.isFileList(k)||Je.endsWith(M,"[]"))&&(W=Je.toArray(k)))return M=$Z(M),W.forEach(function(G,Q){!(Je.isUndefined(G)||G===null)&&e.append(d===!0?Yz([M],Q,l):d===null?M:M+"[]",E(G))}),!1}return D3(k)?!0:(e.append(Yz(K,M,l),E(k)),!1)}const w=[],I=Object.assign(Gve,{defaultVisitor:y,convertValue:E,isVisitable:D3});function P(k,M){if(!Je.isUndefined(k)){if(w.indexOf(k)!==-1)throw Error("Circular reference detected in "+M.join("."));w.push(k),Je.forEach(k,function(W,V){(!(Je.isUndefined(W)||W===null)&&c.call(e,W,Je.isString(V)?V.trim():V,M,I))===!0&&P(W,M?M.concat(V):[V])}),w.pop()}}if(!Je.isObject(t))throw new TypeError("data must be an object");return P(t),e}function Xz(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function T4(t,e){this._pairs=[],t&&eP(t,this,e)}const zZ=T4.prototype;zZ.append=function(e,n){this._pairs.push([e,n])};zZ.toString=function(e){const n=e?function(r){return e.call(this,r,Xz)}:Xz;return this._pairs.map(function(c){return n(c[0])+"="+n(c[1])},"").join("&")};function Kve(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function GZ(t,e,n){if(!e)return t;const r=n&&n.encode||Kve,c=n&&n.serialize;let l;if(c?l=c(e,n):l=Je.isURLSearchParams(e)?e.toString():new T4(e,n).toString(r),l){const d=t.indexOf("#");d!==-1&&(t=t.slice(0,d)),t+=(t.indexOf("?")===-1?"?":"&")+l}return t}class qve{constructor(){this.handlers=[]}use(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Je.forEach(this.handlers,function(r){r!==null&&e(r)})}}const Jz=qve,KZ={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Yve=typeof URLSearchParams<"u"?URLSearchParams:T4,Xve=typeof FormData<"u"?FormData:null,Jve=typeof Blob<"u"?Blob:null,Qve=(()=>{let t;return typeof navigator<"u"&&((t=navigator.product)==="ReactNative"||t==="NativeScript"||t==="NS")?!1:typeof window<"u"&&typeof document<"u"})(),Zve=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),El={isBrowser:!0,classes:{URLSearchParams:Yve,FormData:Xve,Blob:Jve},isStandardBrowserEnv:Qve,isStandardBrowserWebWorkerEnv:Zve,protocols:["http","https","file","blob","url","data"]};function eye(t,e){return eP(t,new El.classes.URLSearchParams,Object.assign({visitor:function(n,r,c,l){return El.isNode&&Je.isBuffer(n)?(this.append(r,n.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)}},e))}function tye(t){return Je.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function nye(t){const e={},n=Object.keys(t);let r;const c=n.length;let l;for(r=0;r<c;r++)l=n[r],e[l]=t[l];return e}function qZ(t){function e(n,r,c,l){let d=n[l++];const f=Number.isFinite(+d),m=l>=n.length;return d=!d&&Je.isArray(c)?c.length:d,m?(Je.hasOwnProp(c,d)?c[d]=[c[d],r]:c[d]=r,!f):((!c[d]||!Je.isObject(c[d]))&&(c[d]=[]),e(n,r,c[d],l)&&Je.isArray(c[d])&&(c[d]=nye(c[d])),!f)}if(Je.isFormData(t)&&Je.isFunction(t.entries)){const n={};return Je.forEachEntry(t,(r,c)=>{e(tye(r),c,n,0)}),n}return null}function iye(t,e,n){if(Je.isString(t))try{return(e||JSON.parse)(t),Je.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}const b4={transitional:KZ,adapter:El.isNode?"http":"xhr",transformRequest:[function(e,n){const r=n.getContentType()||"",c=r.indexOf("application/json")>-1,l=Je.isObject(e);if(l&&Je.isHTMLForm(e)&&(e=new FormData(e)),Je.isFormData(e))return c&&c?JSON.stringify(qZ(e)):e;if(Je.isArrayBuffer(e)||Je.isBuffer(e)||Je.isStream(e)||Je.isFile(e)||Je.isBlob(e))return e;if(Je.isArrayBufferView(e))return e.buffer;if(Je.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let f;if(l){if(r.indexOf("application/x-www-form-urlencoded")>-1)return eye(e,this.formSerializer).toString();if((f=Je.isFileList(e))||r.indexOf("multipart/form-data")>-1){const m=this.env&&this.env.FormData;return eP(f?{"files[]":e}:e,m&&new m,this.formSerializer)}}return l||c?(n.setContentType("application/json",!1),iye(e)):e}],transformResponse:[function(e){const n=this.transitional||b4.transitional,r=n&&n.forcedJSONParsing,c=this.responseType==="json";if(e&&Je.isString(e)&&(r&&!this.responseType||c)){const d=!(n&&n.silentJSONParsing)&&c;try{return JSON.parse(e)}catch(f){if(d)throw f.name==="SyntaxError"?Zn.from(f,Zn.ERR_BAD_RESPONSE,this,null,this.response):f}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:El.classes.FormData,Blob:El.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Je.forEach(["delete","get","head","post","put","patch"],t=>{b4.headers[t]={}});const w4=b4,rye=Je.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),sye=t=>{const e={};let n,r,c;return t&&t.split(`
`).forEach(function(d){c=d.indexOf(":"),n=d.substring(0,c).trim().toLowerCase(),r=d.substring(c+1).trim(),!(!n||e[n]&&rye[n])&&(n==="set-cookie"?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e},Qz=Symbol("internals");function kS(t){return t&&String(t).trim().toLowerCase()}function PO(t){return t===!1||t==null?t:Je.isArray(t)?t.map(PO):String(t)}function oye(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}const aye=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function bj(t,e,n,r,c){if(Je.isFunction(r))return r.call(this,e,n);if(c&&(e=n),!!Je.isString(e)){if(Je.isString(r))return e.indexOf(r)!==-1;if(Je.isRegExp(r))return r.test(e)}}function cye(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,r)=>n.toUpperCase()+r)}function lye(t,e){const n=Je.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(c,l,d){return this[r].call(this,e,c,l,d)},configurable:!0})})}class tP{constructor(e){e&&this.set(e)}set(e,n,r){const c=this;function l(f,m,E){const y=kS(m);if(!y)throw new Error("header name must be a non-empty string");const w=Je.findKey(c,y);(!w||c[w]===void 0||E===!0||E===void 0&&c[w]!==!1)&&(c[w||m]=PO(f))}const d=(f,m)=>Je.forEach(f,(E,y)=>l(E,y,m));return Je.isPlainObject(e)||e instanceof this.constructor?d(e,n):Je.isString(e)&&(e=e.trim())&&!aye(e)?d(sye(e),n):e!=null&&l(n,e,r),this}get(e,n){if(e=kS(e),e){const r=Je.findKey(this,e);if(r){const c=this[r];if(!n)return c;if(n===!0)return oye(c);if(Je.isFunction(n))return n.call(this,c,r);if(Je.isRegExp(n))return n.exec(c);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=kS(e),e){const r=Je.findKey(this,e);return!!(r&&this[r]!==void 0&&(!n||bj(this,this[r],r,n)))}return!1}delete(e,n){const r=this;let c=!1;function l(d){if(d=kS(d),d){const f=Je.findKey(r,d);f&&(!n||bj(r,r[f],f,n))&&(delete r[f],c=!0)}}return Je.isArray(e)?e.forEach(l):l(e),c}clear(e){const n=Object.keys(this);let r=n.length,c=!1;for(;r--;){const l=n[r];(!e||bj(this,this[l],l,e,!0))&&(delete this[l],c=!0)}return c}normalize(e){const n=this,r={};return Je.forEach(this,(c,l)=>{const d=Je.findKey(r,l);if(d){n[d]=PO(c),delete n[l];return}const f=e?cye(l):String(l).trim();f!==l&&delete n[l],n[f]=PO(c),r[f]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return Je.forEach(this,(r,c)=>{r!=null&&r!==!1&&(n[c]=e&&Je.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const r=new this(e);return n.forEach(c=>r.set(c)),r}static accessor(e){const r=(this[Qz]=this[Qz]={accessors:{}}).accessors,c=this.prototype;function l(d){const f=kS(d);r[f]||(lye(c,d),r[f]=!0)}return Je.isArray(e)?e.forEach(l):l(e),this}}tP.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Je.reduceDescriptors(tP.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[n]=r}}});Je.freezeMethods(tP);const Dd=tP;function wj(t,e){const n=this||w4,r=e||n,c=Dd.from(r.headers);let l=r.data;return Je.forEach(t,function(f){l=f.call(n,l,c.normalize(),e?e.status:void 0)}),c.normalize(),l}function YZ(t){return!!(t&&t.__CANCEL__)}function Ib(t,e,n){Zn.call(this,t??"canceled",Zn.ERR_CANCELED,e,n),this.name="CanceledError"}Je.inherits(Ib,Zn,{__CANCEL__:!0});function uye(t,e,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?t(n):e(new Zn("Request failed with status code "+n.status,[Zn.ERR_BAD_REQUEST,Zn.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}const dye=El.isStandardBrowserEnv?function(){return{write:function(n,r,c,l,d,f){const m=[];m.push(n+"="+encodeURIComponent(r)),Je.isNumber(c)&&m.push("expires="+new Date(c).toGMTString()),Je.isString(l)&&m.push("path="+l),Je.isString(d)&&m.push("domain="+d),f===!0&&m.push("secure"),document.cookie=m.join("; ")},read:function(n){const r=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove:function(n){this.write(n,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function hye(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function fye(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}function XZ(t,e){return t&&!hye(e)?fye(t,e):e}const pye=El.isStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");let r;function c(l){let d=l;return e&&(n.setAttribute("href",d),d=n.href),n.setAttribute("href",d),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return r=c(window.location.href),function(d){const f=Je.isString(d)?c(d):d;return f.protocol===r.protocol&&f.host===r.host}}():function(){return function(){return!0}}();function mye(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function gye(t,e){t=t||10;const n=new Array(t),r=new Array(t);let c=0,l=0,d;return e=e!==void 0?e:1e3,function(m){const E=Date.now(),y=r[l];d||(d=E),n[c]=m,r[c]=E;let w=l,I=0;for(;w!==c;)I+=n[w++],w=w%t;if(c=(c+1)%t,c===l&&(l=(l+1)%t),E-d<e)return;const P=y&&E-y;return P?Math.round(I*1e3/P):void 0}}function Zz(t,e){let n=0;const r=gye(50,250);return c=>{const l=c.loaded,d=c.lengthComputable?c.total:void 0,f=l-n,m=r(f),E=l<=d;n=l;const y={loaded:l,total:d,progress:d?l/d:void 0,bytes:f,rate:m||void 0,estimated:m&&d&&E?(d-l)/m:void 0,event:c};y[e?"download":"upload"]=!0,t(y)}}const _ye=typeof XMLHttpRequest<"u",Eye=_ye&&function(t){return new Promise(function(n,r){let c=t.data;const l=Dd.from(t.headers).normalize(),d=t.responseType;let f;function m(){t.cancelToken&&t.cancelToken.unsubscribe(f),t.signal&&t.signal.removeEventListener("abort",f)}Je.isFormData(c)&&(El.isStandardBrowserEnv||El.isStandardBrowserWebWorkerEnv?l.setContentType(!1):l.setContentType("multipart/form-data;",!1));let E=new XMLHttpRequest;if(t.auth){const P=t.auth.username||"",k=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";l.set("Authorization","Basic "+btoa(P+":"+k))}const y=XZ(t.baseURL,t.url);E.open(t.method.toUpperCase(),GZ(y,t.params,t.paramsSerializer),!0),E.timeout=t.timeout;function w(){if(!E)return;const P=Dd.from("getAllResponseHeaders"in E&&E.getAllResponseHeaders()),M={data:!d||d==="text"||d==="json"?E.responseText:E.response,status:E.status,statusText:E.statusText,headers:P,config:t,request:E};uye(function(W){n(W),m()},function(W){r(W),m()},M),E=null}if("onloadend"in E?E.onloadend=w:E.onreadystatechange=function(){!E||E.readyState!==4||E.status===0&&!(E.responseURL&&E.responseURL.indexOf("file:")===0)||setTimeout(w)},E.onabort=function(){E&&(r(new Zn("Request aborted",Zn.ECONNABORTED,t,E)),E=null)},E.onerror=function(){r(new Zn("Network Error",Zn.ERR_NETWORK,t,E)),E=null},E.ontimeout=function(){let k=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const M=t.transitional||KZ;t.timeoutErrorMessage&&(k=t.timeoutErrorMessage),r(new Zn(k,M.clarifyTimeoutError?Zn.ETIMEDOUT:Zn.ECONNABORTED,t,E)),E=null},El.isStandardBrowserEnv){const P=(t.withCredentials||pye(y))&&t.xsrfCookieName&&dye.read(t.xsrfCookieName);P&&l.set(t.xsrfHeaderName,P)}c===void 0&&l.setContentType(null),"setRequestHeader"in E&&Je.forEach(l.toJSON(),function(k,M){E.setRequestHeader(M,k)}),Je.isUndefined(t.withCredentials)||(E.withCredentials=!!t.withCredentials),d&&d!=="json"&&(E.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&E.addEventListener("progress",Zz(t.onDownloadProgress,!0)),typeof t.onUploadProgress=="function"&&E.upload&&E.upload.addEventListener("progress",Zz(t.onUploadProgress)),(t.cancelToken||t.signal)&&(f=P=>{E&&(r(!P||P.type?new Ib(null,t,E):P),E.abort(),E=null)},t.cancelToken&&t.cancelToken.subscribe(f),t.signal&&(t.signal.aborted?f():t.signal.addEventListener("abort",f)));const I=mye(y);if(I&&El.protocols.indexOf(I)===-1){r(new Zn("Unsupported protocol "+I+":",Zn.ERR_BAD_REQUEST,t));return}E.send(c||null)})},xO={http:$ve,xhr:Eye};Je.forEach(xO,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const JZ={getAdapter:t=>{t=Je.isArray(t)?t:[t];const{length:e}=t;let n,r;for(let c=0;c<e&&(n=t[c],!(r=Je.isString(n)?xO[n.toLowerCase()]:n));c++);if(!r)throw r===!1?new Zn(`Adapter ${n} is not supported by the environment`,"ERR_NOT_SUPPORT"):new Error(Je.hasOwnProp(xO,n)?`Adapter '${n}' is not available in the build`:`Unknown adapter '${n}'`);if(!Je.isFunction(r))throw new TypeError("adapter is not a function");return r},adapters:xO};function Cj(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Ib(null,t)}function eG(t){return Cj(t),t.headers=Dd.from(t.headers),t.data=wj.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),JZ.getAdapter(t.adapter||w4.adapter)(t).then(function(r){return Cj(t),r.data=wj.call(t,t.transformResponse,r),r.headers=Dd.from(r.headers),r},function(r){return YZ(r)||(Cj(t),r&&r.response&&(r.response.data=wj.call(t,t.transformResponse,r.response),r.response.headers=Dd.from(r.response.headers))),Promise.reject(r)})}const tG=t=>t instanceof Dd?t.toJSON():t;function vv(t,e){e=e||{};const n={};function r(E,y,w){return Je.isPlainObject(E)&&Je.isPlainObject(y)?Je.merge.call({caseless:w},E,y):Je.isPlainObject(y)?Je.merge({},y):Je.isArray(y)?y.slice():y}function c(E,y,w){if(Je.isUndefined(y)){if(!Je.isUndefined(E))return r(void 0,E,w)}else return r(E,y,w)}function l(E,y){if(!Je.isUndefined(y))return r(void 0,y)}function d(E,y){if(Je.isUndefined(y)){if(!Je.isUndefined(E))return r(void 0,E)}else return r(void 0,y)}function f(E,y,w){if(w in e)return r(E,y);if(w in t)return r(void 0,E)}const m={url:l,method:l,data:l,baseURL:d,transformRequest:d,transformResponse:d,paramsSerializer:d,timeout:d,timeoutMessage:d,withCredentials:d,adapter:d,responseType:d,xsrfCookieName:d,xsrfHeaderName:d,onUploadProgress:d,onDownloadProgress:d,decompress:d,maxContentLength:d,maxBodyLength:d,beforeRedirect:d,transport:d,httpAgent:d,httpsAgent:d,cancelToken:d,socketPath:d,responseEncoding:d,validateStatus:f,headers:(E,y)=>c(tG(E),tG(y),!0)};return Je.forEach(Object.keys(Object.assign({},t,e)),function(y){const w=m[y]||c,I=w(t[y],e[y],y);Je.isUndefined(I)&&w!==f||(n[y]=I)}),n}const QZ="1.5.0",C4={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{C4[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const nG={};C4.transitional=function(e,n,r){function c(l,d){return"[Axios v"+QZ+"] Transitional option '"+l+"'"+d+(r?". "+r:"")}return(l,d,f)=>{if(e===!1)throw new Zn(c(d," has been removed"+(n?" in "+n:"")),Zn.ERR_DEPRECATED);return n&&!nG[d]&&(nG[d]=!0,console.warn(c(d," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(l,d,f):!0}};function vye(t,e,n){if(typeof t!="object")throw new Zn("options must be an object",Zn.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let c=r.length;for(;c-- >0;){const l=r[c],d=e[l];if(d){const f=t[l],m=f===void 0||d(f,l,t);if(m!==!0)throw new Zn("option "+l+" must be "+m,Zn.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Zn("Unknown option "+l,Zn.ERR_BAD_OPTION)}}const k3={assertOptions:vye,validators:C4},Zh=k3.validators;class T1{constructor(e){this.defaults=e,this.interceptors={request:new Jz,response:new Jz}}request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=vv(this.defaults,n);const{transitional:r,paramsSerializer:c,headers:l}=n;r!==void 0&&k3.assertOptions(r,{silentJSONParsing:Zh.transitional(Zh.boolean),forcedJSONParsing:Zh.transitional(Zh.boolean),clarifyTimeoutError:Zh.transitional(Zh.boolean)},!1),c!=null&&(Je.isFunction(c)?n.paramsSerializer={serialize:c}:k3.assertOptions(c,{encode:Zh.function,serialize:Zh.function},!0)),n.method=(n.method||this.defaults.method||"get").toLowerCase();let d=l&&Je.merge(l.common,l[n.method]);l&&Je.forEach(["delete","get","head","post","put","patch","common"],k=>{delete l[k]}),n.headers=Dd.concat(d,l);const f=[];let m=!0;this.interceptors.request.forEach(function(M){typeof M.runWhen=="function"&&M.runWhen(n)===!1||(m=m&&M.synchronous,f.unshift(M.fulfilled,M.rejected))});const E=[];this.interceptors.response.forEach(function(M){E.push(M.fulfilled,M.rejected)});let y,w=0,I;if(!m){const k=[eG.bind(this),void 0];for(k.unshift.apply(k,f),k.push.apply(k,E),I=k.length,y=Promise.resolve(n);w<I;)y=y.then(k[w++],k[w++]);return y}I=f.length;let P=n;for(w=0;w<I;){const k=f[w++],M=f[w++];try{P=k(P)}catch(K){M.call(this,K);break}}try{y=eG.call(this,P)}catch(k){return Promise.reject(k)}for(w=0,I=E.length;w<I;)y=y.then(E[w++],E[w++]);return y}getUri(e){e=vv(this.defaults,e);const n=XZ(e.baseURL,e.url);return GZ(n,e.params,e.paramsSerializer)}}Je.forEach(["delete","get","head","options"],function(e){T1.prototype[e]=function(n,r){return this.request(vv(r||{},{method:e,url:n,data:(r||{}).data}))}});Je.forEach(["post","put","patch"],function(e){function n(r){return function(l,d,f){return this.request(vv(f||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:l,data:d}))}}T1.prototype[e]=n(),T1.prototype[e+"Form"]=n(!0)});const DO=T1;class R4{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(l){n=l});const r=this;this.promise.then(c=>{if(!r._listeners)return;let l=r._listeners.length;for(;l-- >0;)r._listeners[l](c);r._listeners=null}),this.promise.then=c=>{let l;const d=new Promise(f=>{r.subscribe(f),l=f}).then(c);return d.cancel=function(){r.unsubscribe(l)},d},e(function(l,d,f){r.reason||(r.reason=new Ib(l,d,f),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}static source(){let e;return{token:new R4(function(c){e=c}),cancel:e}}}const yye=R4;function Sye(t){return function(n){return t.apply(null,n)}}function Tye(t){return Je.isObject(t)&&t.isAxiosError===!0}const L3={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(L3).forEach(([t,e])=>{L3[e]=t});const bye=L3;function ZZ(t){const e=new DO(t),n=kZ(DO.prototype.request,e);return Je.extend(n,DO.prototype,e,{allOwnKeys:!0}),Je.extend(n,e,null,{allOwnKeys:!0}),n.create=function(c){return ZZ(vv(t,c))},n}const ls=ZZ(w4);ls.Axios=DO;ls.CanceledError=Ib;ls.CancelToken=yye;ls.isCancel=YZ;ls.VERSION=QZ;ls.toFormData=eP;ls.AxiosError=Zn;ls.Cancel=ls.CanceledError;ls.all=function(e){return Promise.all(e)};ls.spread=Sye;ls.isAxiosError=Tye;ls.mergeConfig=vv;ls.AxiosHeaders=Dd;ls.formToJSON=t=>qZ(Je.isHTMLForm(t)?new FormData(t):t);ls.getAdapter=JZ.getAdapter;ls.HttpStatusCode=bye;ls.default=ls;const I4=ls,Qf=I4.create({baseURL:"https://buzzgram.online/api"}),wye=t=>Qf.post("/auth/login",t),Cye=t=>Qf.post("/auth/google-auth",t),Rye=t=>Qf.post("/auth/register",t),Iye=t=>Qf.post("/auth/admin-login",t),Aye=t=>Qf.post("/auth/otp-signup",t),Oye=t=>Qf.post("/auth/otp-recovery",t),eee=(t,e)=>Qf.post("/auth/verify-otp",{phone:t,otp:e}),Nye=t=>Qf.put("/auth/forgot-password",t),Pye=t=>async e=>{e({type:"AUTH_START"});try{const{data:n}=await wye(t);return n.error?{success:!1,error:n.error}:(e({type:"AUTH_SUCCESS",data:n}),{success:!0})}catch(n){return e({type:"AUTH_FAIL",error:!0}),{success:!1,error:n.response.data.error}}},xye=t=>async e=>{e({type:"AUTH_START"});try{const{data:n}=await Cye(t);return n.error?{success:!1,error:n.error}:(e({type:"AUTH_SUCCESS",data:n}),{success:!0})}catch(n){return e({type:"AUTH_FAIL",error:!0}),{success:!1,error:n.response.data.error}}},Dye=t=>async e=>{e({type:"ADMIN_AUTH_START"});try{const{data:n}=await Iye(t);return e({type:"ADMIN_AUTH_SUCCESS",data:n}),{success:!0}}catch(n){return console.log(n),e({type:"ADMIN_AUTH_FAIL",error:!0}),{success:!1}}},kye=t=>async e=>{e({type:"AUTH_START"});try{const{data:n}=await Rye(t);return e({type:"AUTH_SUCCESS",data:n}),{success:!0}}catch(n){console.log(n);const r=n.response.data.error;return e({type:"AUTH_FAIL",error:r}),{success:!1}}},Bi=()=>async t=>{t({type:"LOG_OUT"}),t({type:"RESET_POST_STATE"})},tee=()=>async t=>{t({type:"ADMIN_LOG_OUT"}),t({type:"RESET_STATE"})};var nee={exports:{}},iee={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yv=$;function Lye(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Mye=typeof Object.is=="function"?Object.is:Lye,Uye=yv.useState,jye=yv.useEffect,Fye=yv.useLayoutEffect,Vye=yv.useDebugValue;function Bye(t,e){var n=e(),r=Uye({inst:{value:n,getSnapshot:e}}),c=r[0].inst,l=r[1];return Fye(function(){c.value=n,c.getSnapshot=e,Rj(c)&&l({inst:c})},[t,n,e]),jye(function(){return Rj(c)&&l({inst:c}),t(function(){Rj(c)&&l({inst:c})})},[t]),Vye(n),n}function Rj(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Mye(t,n)}catch{return!0}}function Wye(t,e){return e()}var Hye=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Wye:Bye;iee.useSyncExternalStore=yv.useSyncExternalStore!==void 0?yv.useSyncExternalStore:Hye;nee.exports=iee;var $ye=nee.exports,ree={exports:{}},see={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nP=$,zye=$ye;function Gye(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Kye=typeof Object.is=="function"?Object.is:Gye,qye=zye.useSyncExternalStore,Yye=nP.useRef,Xye=nP.useEffect,Jye=nP.useMemo,Qye=nP.useDebugValue;see.useSyncExternalStoreWithSelector=function(t,e,n,r,c){var l=Yye(null);if(l.current===null){var d={hasValue:!1,value:null};l.current=d}else d=l.current;l=Jye(function(){function m(P){if(!E){if(E=!0,y=P,P=r(P),c!==void 0&&d.hasValue){var k=d.value;if(c(k,P))return w=k}return w=P}if(k=w,Kye(y,P))return k;var M=r(P);return c!==void 0&&c(k,M)?k:(y=P,w=M)}var E=!1,y,w,I=n===void 0?null:n;return[function(){return m(e())},I===null?void 0:function(){return m(I())}]},[e,n,r,c]);var f=qye(t,l[0],l[1]);return Xye(function(){d.hasValue=!0,d.value=f},[f]),Qye(f),f};ree.exports=see;var Zye=ree.exports;function e0e(t){t()}let oee=e0e;const t0e=t=>oee=t,n0e=()=>oee,iG=Symbol.for("react-redux-context"),rG=typeof globalThis<"u"?globalThis:{};function i0e(){var t;if(!$.createContext)return{};const e=(t=rG[iG])!=null?t:rG[iG]=new Map;let n=e.get($.createContext);return n||(n=$.createContext(null),e.set($.createContext,n)),n}const Hf=i0e();function A4(t=Hf){return function(){return $.useContext(t)}}const aee=A4(),r0e=()=>{throw new Error("uSES not initialized!")};let cee=r0e;const s0e=t=>{cee=t},o0e=(t,e)=>t===e;function a0e(t=Hf){const e=t===Hf?aee:A4(t);return function(r,c={}){const{equalityFn:l=o0e,stabilityCheck:d=void 0,noopCheck:f=void 0}=typeof c=="function"?{equalityFn:c}:c,{store:m,subscription:E,getServerState:y,stabilityCheck:w,noopCheck:I}=e();$.useRef(!0);const P=$.useCallback({[r.name](M){return r(M)}}[r.name],[r,w,d]),k=cee(E.addNestedSub,m.getState,y||m.getState,P,l);return $.useDebugValue(k),k}}const Si=a0e();function c0e(t,e){if(t==null)return{};var n={},r=Object.keys(t),c,l;for(l=0;l<r.length;l++)c=r[l],!(e.indexOf(c)>=0)&&(n[c]=t[c]);return n}var xi={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O4=Symbol.for("react.element"),N4=Symbol.for("react.portal"),iP=Symbol.for("react.fragment"),rP=Symbol.for("react.strict_mode"),sP=Symbol.for("react.profiler"),oP=Symbol.for("react.provider"),aP=Symbol.for("react.context"),l0e=Symbol.for("react.server_context"),cP=Symbol.for("react.forward_ref"),lP=Symbol.for("react.suspense"),uP=Symbol.for("react.suspense_list"),dP=Symbol.for("react.memo"),hP=Symbol.for("react.lazy"),u0e=Symbol.for("react.offscreen"),lee;lee=Symbol.for("react.module.reference");function Vc(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case O4:switch(t=t.type,t){case iP:case sP:case rP:case lP:case uP:return t;default:switch(t=t&&t.$$typeof,t){case l0e:case aP:case cP:case hP:case dP:case oP:return t;default:return e}}case N4:return e}}}xi.ContextConsumer=aP;xi.ContextProvider=oP;xi.Element=O4;xi.ForwardRef=cP;xi.Fragment=iP;xi.Lazy=hP;xi.Memo=dP;xi.Portal=N4;xi.Profiler=sP;xi.StrictMode=rP;xi.Suspense=lP;xi.SuspenseList=uP;xi.isAsyncMode=function(){return!1};xi.isConcurrentMode=function(){return!1};xi.isContextConsumer=function(t){return Vc(t)===aP};xi.isContextProvider=function(t){return Vc(t)===oP};xi.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===O4};xi.isForwardRef=function(t){return Vc(t)===cP};xi.isFragment=function(t){return Vc(t)===iP};xi.isLazy=function(t){return Vc(t)===hP};xi.isMemo=function(t){return Vc(t)===dP};xi.isPortal=function(t){return Vc(t)===N4};xi.isProfiler=function(t){return Vc(t)===sP};xi.isStrictMode=function(t){return Vc(t)===rP};xi.isSuspense=function(t){return Vc(t)===lP};xi.isSuspenseList=function(t){return Vc(t)===uP};xi.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===iP||t===sP||t===rP||t===lP||t===uP||t===u0e||typeof t=="object"&&t!==null&&(t.$$typeof===hP||t.$$typeof===dP||t.$$typeof===oP||t.$$typeof===aP||t.$$typeof===cP||t.$$typeof===lee||t.getModuleId!==void 0)};xi.typeOf=Vc;function d0e(){const t=n0e();let e=null,n=null;return{clear(){e=null,n=null},notify(){t(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){let r=[],c=e;for(;c;)r.push(c),c=c.next;return r},subscribe(r){let c=!0,l=n={callback:r,next:null,prev:n};return l.prev?l.prev.next=l:e=l,function(){!c||e===null||(c=!1,l.next?l.next.prev=l.prev:n=l.prev,l.prev?l.prev.next=l.next:e=l.next)}}}}const sG={notify(){},get:()=>[]};function h0e(t,e){let n,r=sG;function c(w){return m(),r.subscribe(w)}function l(){r.notify()}function d(){y.onStateChange&&y.onStateChange()}function f(){return!!n}function m(){n||(n=e?e.addNestedSub(d):t.subscribe(d),r=d0e())}function E(){n&&(n(),n=void 0,r.clear(),r=sG)}const y={addNestedSub:c,notifyNestedSubs:l,handleChangeWrapper:d,isSubscribed:f,trySubscribe:m,tryUnsubscribe:E,getListeners:()=>r};return y}const f0e=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",p0e=f0e?$.useLayoutEffect:$.useEffect;function m0e({store:t,context:e,children:n,serverState:r,stabilityCheck:c="once",noopCheck:l="once"}){const d=$.useMemo(()=>{const E=h0e(t);return{store:t,subscription:E,getServerState:r?()=>r:void 0,stabilityCheck:c,noopCheck:l}},[t,r,c,l]),f=$.useMemo(()=>t.getState(),[t]);p0e(()=>{const{subscription:E}=d;return E.onStateChange=E.notifyNestedSubs,E.trySubscribe(),f!==t.getState()&&E.notifyNestedSubs(),()=>{E.tryUnsubscribe(),E.onStateChange=void 0}},[d,f]);const m=e||Hf;return $.createElement(m.Provider,{value:d},n)}function uee(t=Hf){const e=t===Hf?aee:A4(t);return function(){const{store:r}=e();return r}}const g0e=uee();function _0e(t=Hf){const e=t===Hf?g0e:uee(t);return function(){return e().dispatch}}const bi=_0e();s0e(Zye.useSyncExternalStoreWithSelector);t0e(a4.unstable_batchedUpdates);/**
 * @remix-run/router v1.9.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function QT(){return QT=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},QT.apply(this,arguments)}var vf;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(vf||(vf={}));const oG="popstate";function E0e(t){t===void 0&&(t={});function e(r,c){let{pathname:l,search:d,hash:f}=r.location;return M3("",{pathname:l,search:d,hash:f},c.state&&c.state.usr||null,c.state&&c.state.key||"default")}function n(r,c){return typeof c=="string"?c:b1(c)}return y0e(e,n,null,t)}function Kr(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function P4(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function v0e(){return Math.random().toString(36).substr(2,8)}function aG(t,e){return{usr:t.state,key:t.key,idx:e}}function M3(t,e,n,r){return n===void 0&&(n=null),QT({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?kv(e):e,{state:n,key:e&&e.key||r||v0e()})}function b1(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function kv(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function y0e(t,e,n,r){r===void 0&&(r={});let{window:c=document.defaultView,v5Compat:l=!1}=r,d=c.history,f=vf.Pop,m=null,E=y();E==null&&(E=0,d.replaceState(QT({},d.state,{idx:E}),""));function y(){return(d.state||{idx:null}).idx}function w(){f=vf.Pop;let K=y(),W=K==null?null:K-E;E=K,m&&m({action:f,location:M.location,delta:W})}function I(K,W){f=vf.Push;let V=M3(M.location,K,W);n&&n(V,K),E=y()+1;let G=aG(V,E),Q=M.createHref(V);try{d.pushState(G,"",Q)}catch(Z){if(Z instanceof DOMException&&Z.name==="DataCloneError")throw Z;c.location.assign(Q)}l&&m&&m({action:f,location:M.location,delta:1})}function P(K,W){f=vf.Replace;let V=M3(M.location,K,W);n&&n(V,K),E=y();let G=aG(V,E),Q=M.createHref(V);d.replaceState(G,"",Q),l&&m&&m({action:f,location:M.location,delta:0})}function k(K){let W=c.location.origin!=="null"?c.location.origin:c.location.href,V=typeof K=="string"?K:b1(K);return Kr(W,"No window.location.(origin|href) available to create URL for href: "+V),new URL(V,W)}let M={get action(){return f},get location(){return t(c,d)},listen(K){if(m)throw new Error("A history only accepts one active listener");return c.addEventListener(oG,w),m=K,()=>{c.removeEventListener(oG,w),m=null}},createHref(K){return e(c,K)},createURL:k,encodeLocation(K){let W=k(K);return{pathname:W.pathname,search:W.search,hash:W.hash}},push:I,replace:P,go(K){return d.go(K)}};return M}var cG;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(cG||(cG={}));function S0e(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?kv(e):e,c=x4(r.pathname||"/",n);if(c==null)return null;let l=dee(t);T0e(l);let d=null;for(let f=0;d==null&&f<l.length;++f)d=P0e(l[f],k0e(c));return d}function dee(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let c=(l,d,f)=>{let m={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:d,route:l};m.relativePath.startsWith("/")&&(Kr(m.relativePath.startsWith(r),'Absolute route path "'+m.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),m.relativePath=m.relativePath.slice(r.length));let E=Df([r,m.relativePath]),y=n.concat(m);l.children&&l.children.length>0&&(Kr(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+E+'".')),dee(l.children,e,y,E)),!(l.path==null&&!l.index)&&e.push({path:E,score:O0e(E,l.index),routesMeta:y})};return t.forEach((l,d)=>{var f;if(l.path===""||!((f=l.path)!=null&&f.includes("?")))c(l,d);else for(let m of hee(l.path))c(l,d,m)}),e}function hee(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,c=n.endsWith("?"),l=n.replace(/\?$/,"");if(r.length===0)return c?[l,""]:[l];let d=hee(r.join("/")),f=[];return f.push(...d.map(m=>m===""?l:[l,m].join("/"))),c&&f.push(...d),f.map(m=>t.startsWith("/")&&m===""?"/":m)}function T0e(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:N0e(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const b0e=/^:\w+$/,w0e=3,C0e=2,R0e=1,I0e=10,A0e=-2,lG=t=>t==="*";function O0e(t,e){let n=t.split("/"),r=n.length;return n.some(lG)&&(r+=A0e),e&&(r+=C0e),n.filter(c=>!lG(c)).reduce((c,l)=>c+(b0e.test(l)?w0e:l===""?R0e:I0e),r)}function N0e(t,e){return t.length===e.length&&t.slice(0,-1).every((r,c)=>r===e[c])?t[t.length-1]-e[e.length-1]:0}function P0e(t,e){let{routesMeta:n}=t,r={},c="/",l=[];for(let d=0;d<n.length;++d){let f=n[d],m=d===n.length-1,E=c==="/"?e:e.slice(c.length)||"/",y=x0e({path:f.relativePath,caseSensitive:f.caseSensitive,end:m},E);if(!y)return null;Object.assign(r,y.params);let w=f.route;l.push({params:r,pathname:Df([c,y.pathname]),pathnameBase:j0e(Df([c,y.pathnameBase])),route:w}),y.pathnameBase!=="/"&&(c=Df([c,y.pathnameBase]))}return l}function x0e(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=D0e(t.path,t.caseSensitive,t.end),c=e.match(n);if(!c)return null;let l=c[0],d=l.replace(/(.)\/+$/,"$1"),f=c.slice(1);return{params:r.reduce((E,y,w)=>{if(y==="*"){let I=f[w]||"";d=l.slice(0,l.length-I.length).replace(/(.)\/+$/,"$1")}return E[y]=L0e(f[w]||"",y),E},{}),pathname:l,pathnameBase:d,pattern:t}}function D0e(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),P4(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],c="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(d,f)=>(r.push(f),"/([^\\/]+)"));return t.endsWith("*")?(r.push("*"),c+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?c+="\\/*$":t!==""&&t!=="/"&&(c+="(?:(?=\\/|$))"),[new RegExp(c,e?void 0:"i"),r]}function k0e(t){try{return decodeURI(t)}catch(e){return P4(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function L0e(t,e){try{return decodeURIComponent(t)}catch(n){return P4(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function x4(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function M0e(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:c=""}=typeof t=="string"?kv(t):t;return{pathname:n?n.startsWith("/")?n:U0e(n,e):e,search:F0e(r),hash:V0e(c)}}function U0e(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(c=>{c===".."?n.length>1&&n.pop():c!=="."&&n.push(c)}),n.length>1?n.join("/"):"/"}function Ij(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function D4(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function k4(t,e,n,r){r===void 0&&(r=!1);let c;typeof t=="string"?c=kv(t):(c=QT({},t),Kr(!c.pathname||!c.pathname.includes("?"),Ij("?","pathname","search",c)),Kr(!c.pathname||!c.pathname.includes("#"),Ij("#","pathname","hash",c)),Kr(!c.search||!c.search.includes("#"),Ij("#","search","hash",c)));let l=t===""||c.pathname==="",d=l?"/":c.pathname,f;if(r||d==null)f=n;else{let w=e.length-1;if(d.startsWith("..")){let I=d.split("/");for(;I[0]==="..";)I.shift(),w-=1;c.pathname=I.join("/")}f=w>=0?e[w]:"/"}let m=M0e(c,f),E=d&&d!=="/"&&d.endsWith("/"),y=(l||d===".")&&n.endsWith("/");return!m.pathname.endsWith("/")&&(E||y)&&(m.pathname+="/"),m}const Df=t=>t.join("/").replace(/\/\/+/g,"/"),j0e=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),F0e=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,V0e=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function B0e(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const fee=["post","put","patch","delete"];new Set(fee);const W0e=["get",...fee];new Set(W0e);/**
 * React Router v6.16.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function w1(){return w1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},w1.apply(this,arguments)}const L4=$.createContext(null),H0e=$.createContext(null),Lv=$.createContext(null),fP=$.createContext(null),Du=$.createContext({outlet:null,matches:[],isDataRoute:!1}),pee=$.createContext(null);function $0e(t,e){let{relative:n}=e===void 0?{}:e;Mv()||Kr(!1);let{basename:r,navigator:c}=$.useContext(Lv),{hash:l,pathname:d,search:f}=gee(t,{relative:n}),m=d;return r!=="/"&&(m=d==="/"?r:Df([r,d])),c.createHref({pathname:m,search:f,hash:l})}function Mv(){return $.useContext(fP)!=null}function qd(){return Mv()||Kr(!1),$.useContext(fP).location}function mee(t){$.useContext(Lv).static||$.useLayoutEffect(t)}function Ia(){let{isDataRoute:t}=$.useContext(Du);return t?oSe():z0e()}function z0e(){Mv()||Kr(!1);let t=$.useContext(L4),{basename:e,navigator:n}=$.useContext(Lv),{matches:r}=$.useContext(Du),{pathname:c}=qd(),l=JSON.stringify(D4(r).map(m=>m.pathnameBase)),d=$.useRef(!1);return mee(()=>{d.current=!0}),$.useCallback(function(m,E){if(E===void 0&&(E={}),!d.current)return;if(typeof m=="number"){n.go(m);return}let y=k4(m,JSON.parse(l),c,E.relative==="path");t==null&&e!=="/"&&(y.pathname=y.pathname==="/"?e:Df([e,y.pathname])),(E.replace?n.replace:n.push)(y,E.state,E)},[e,n,l,c,t])}const G0e=$.createContext(null);function K0e(t){let e=$.useContext(Du).outlet;return e&&$.createElement(G0e.Provider,{value:t},e)}function q0e(){let{matches:t}=$.useContext(Du),e=t[t.length-1];return e?e.params:{}}function gee(t,e){let{relative:n}=e===void 0?{}:e,{matches:r}=$.useContext(Du),{pathname:c}=qd(),l=JSON.stringify(D4(r).map(d=>d.pathnameBase));return $.useMemo(()=>k4(t,JSON.parse(l),c,n==="path"),[t,l,c,n])}function Y0e(t,e){return X0e(t,e)}function X0e(t,e,n){Mv()||Kr(!1);let{navigator:r}=$.useContext(Lv),{matches:c}=$.useContext(Du),l=c[c.length-1],d=l?l.params:{};l&&l.pathname;let f=l?l.pathnameBase:"/";l&&l.route;let m=qd(),E;if(e){var y;let M=typeof e=="string"?kv(e):e;f==="/"||(y=M.pathname)!=null&&y.startsWith(f)||Kr(!1),E=M}else E=m;let w=E.pathname||"/",I=f==="/"?w:w.slice(f.length)||"/",P=S0e(t,{pathname:I}),k=tSe(P&&P.map(M=>Object.assign({},M,{params:Object.assign({},d,M.params),pathname:Df([f,r.encodeLocation?r.encodeLocation(M.pathname).pathname:M.pathname]),pathnameBase:M.pathnameBase==="/"?f:Df([f,r.encodeLocation?r.encodeLocation(M.pathnameBase).pathname:M.pathnameBase])})),c,n);return e&&k?$.createElement(fP.Provider,{value:{location:w1({pathname:"/",search:"",hash:"",state:null,key:"default"},E),navigationType:vf.Pop}},k):k}function J0e(){let t=sSe(),e=B0e(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,c={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},l=null;return $.createElement($.Fragment,null,$.createElement("h2",null,"Unexpected Application Error!"),$.createElement("h3",{style:{fontStyle:"italic"}},e),n?$.createElement("pre",{style:c},n):null,l)}const Q0e=$.createElement(J0e,null);class Z0e extends $.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error?$.createElement(Du.Provider,{value:this.props.routeContext},$.createElement(pee.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function eSe(t){let{routeContext:e,match:n,children:r}=t,c=$.useContext(L4);return c&&c.static&&c.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(c.staticContext._deepestRenderedBoundaryId=n.route.id),$.createElement(Du.Provider,{value:e},r)}function tSe(t,e,n){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),t==null){var c;if((c=n)!=null&&c.errors)t=n.matches;else return null}let l=t,d=(r=n)==null?void 0:r.errors;if(d!=null){let f=l.findIndex(m=>m.route.id&&(d==null?void 0:d[m.route.id]));f>=0||Kr(!1),l=l.slice(0,Math.min(l.length,f+1))}return l.reduceRight((f,m,E)=>{let y=m.route.id?d==null?void 0:d[m.route.id]:null,w=null;n&&(w=m.route.errorElement||Q0e);let I=e.concat(l.slice(0,E+1)),P=()=>{let k;return y?k=w:m.route.Component?k=$.createElement(m.route.Component,null):m.route.element?k=m.route.element:k=f,$.createElement(eSe,{match:m,routeContext:{outlet:f,matches:I,isDataRoute:n!=null},children:k})};return n&&(m.route.ErrorBoundary||m.route.errorElement||E===0)?$.createElement(Z0e,{location:n.location,revalidation:n.revalidation,component:w,error:y,children:P(),routeContext:{outlet:null,matches:I,isDataRoute:!0}}):P()},null)}var _ee=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(_ee||{}),C1=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(C1||{});function nSe(t){let e=$.useContext(L4);return e||Kr(!1),e}function iSe(t){let e=$.useContext(H0e);return e||Kr(!1),e}function rSe(t){let e=$.useContext(Du);return e||Kr(!1),e}function Eee(t){let e=rSe(),n=e.matches[e.matches.length-1];return n.route.id||Kr(!1),n.route.id}function sSe(){var t;let e=$.useContext(pee),n=iSe(C1.UseRouteError),r=Eee(C1.UseRouteError);return e||((t=n.errors)==null?void 0:t[r])}function oSe(){let{router:t}=nSe(_ee.UseNavigateStable),e=Eee(C1.UseNavigateStable),n=$.useRef(!1);return mee(()=>{n.current=!0}),$.useCallback(function(c,l){l===void 0&&(l={}),n.current&&(typeof c=="number"?t.navigate(c):t.navigate(c,w1({fromRouteId:e},l)))},[t,e])}function Ya(t){let{to:e,replace:n,state:r,relative:c}=t;Mv()||Kr(!1);let{matches:l}=$.useContext(Du),{pathname:d}=qd(),f=Ia(),m=k4(e,D4(l).map(y=>y.pathnameBase),d,c==="path"),E=JSON.stringify(m);return $.useEffect(()=>f(JSON.parse(E),{replace:n,state:r,relative:c}),[f,E,c,n,r]),null}function aSe(t){return K0e(t.context)}function Os(t){Kr(!1)}function cSe(t){let{basename:e="/",children:n=null,location:r,navigationType:c=vf.Pop,navigator:l,static:d=!1}=t;Mv()&&Kr(!1);let f=e.replace(/^\/*/,"/"),m=$.useMemo(()=>({basename:f,navigator:l,static:d}),[f,l,d]);typeof r=="string"&&(r=kv(r));let{pathname:E="/",search:y="",hash:w="",state:I=null,key:P="default"}=r,k=$.useMemo(()=>{let M=x4(E,f);return M==null?null:{location:{pathname:M,search:y,hash:w,state:I,key:P},navigationType:c}},[f,E,y,w,I,P,c]);return k==null?null:$.createElement(Lv.Provider,{value:m},$.createElement(fP.Provider,{children:n,value:k}))}function vee(t){let{children:e,location:n}=t;return Y0e(U3(e),n)}new Promise(()=>{});function U3(t,e){e===void 0&&(e=[]);let n=[];return $.Children.forEach(t,(r,c)=>{if(!$.isValidElement(r))return;let l=[...e,c];if(r.type===$.Fragment){n.push.apply(n,U3(r.props.children,l));return}r.type!==Os&&Kr(!1),!r.props.index||!r.props.children||Kr(!1);let d={id:r.props.id||l.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(d.children=U3(r.props.children,l)),n.push(d)}),n}/**
 * React Router DOM v6.16.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function j3(){return j3=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},j3.apply(this,arguments)}function lSe(t,e){if(t==null)return{};var n={},r=Object.keys(t),c,l;for(l=0;l<r.length;l++)c=r[l],!(e.indexOf(c)>=0)&&(n[c]=t[c]);return n}function uSe(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function dSe(t,e){return t.button===0&&(!e||e==="_self")&&!uSe(t)}const hSe=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"],fSe="startTransition",uG=che[fSe];function pSe(t){let{basename:e,children:n,future:r,window:c}=t,l=$.useRef();l.current==null&&(l.current=E0e({window:c,v5Compat:!0}));let d=l.current,[f,m]=$.useState({action:d.action,location:d.location}),{v7_startTransition:E}=r||{},y=$.useCallback(w=>{E&&uG?uG(()=>m(w)):m(w)},[m,E]);return $.useLayoutEffect(()=>d.listen(y),[d,y]),$.createElement(cSe,{basename:e,children:n,location:f.location,navigationType:f.action,navigator:d})}const mSe=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",gSe=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,df=$.forwardRef(function(e,n){let{onClick:r,relative:c,reloadDocument:l,replace:d,state:f,target:m,to:E,preventScrollReset:y}=e,w=lSe(e,hSe),{basename:I}=$.useContext(Lv),P,k=!1;if(typeof E=="string"&&gSe.test(E)&&(P=E,mSe))try{let V=new URL(window.location.href),G=E.startsWith("//")?new URL(V.protocol+E):new URL(E),Q=x4(G.pathname,I);G.origin===V.origin&&Q!=null?E=Q+G.search+G.hash:k=!0}catch{}let M=$0e(E,{relative:c}),K=_Se(E,{replace:d,state:f,target:m,preventScrollReset:y,relative:c});function W(V){r&&r(V),V.defaultPrevented||K(V)}return $.createElement("a",j3({},w,{href:P||M,onClick:k||l?r:W,ref:n,target:m}))});var dG;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher"})(dG||(dG={}));var hG;(function(t){t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(hG||(hG={}));function _Se(t,e){let{target:n,replace:r,state:c,preventScrollReset:l,relative:d}=e===void 0?{}:e,f=Ia(),m=qd(),E=gee(t,{relative:d});return $.useCallback(y=>{if(dSe(y,n)){y.preventDefault();let w=r!==void 0?r:b1(m)===b1(E);f(t,{replace:w,state:c,preventScrollReset:l,relative:d})}},[m,f,E,r,c,n,t,l,d])}const yee=$.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),pP=$.createContext({}),M4=$.createContext(null),mP=typeof document<"u",ESe=mP?$.useLayoutEffect:$.useEffect,See=$.createContext({strict:!1});function vSe(t,e,n,r){const{visualElement:c}=$.useContext(pP),l=$.useContext(See),d=$.useContext(M4),f=$.useContext(yee).reducedMotion,m=$.useRef();r=r||l.renderer,!m.current&&r&&(m.current=r(t,{visualState:e,parent:c,props:n,presenceContext:d,blockInitialAnimation:d?d.initial===!1:!1,reducedMotionConfig:f}));const E=m.current;$.useInsertionEffect(()=>{E&&E.update(n,d)});const y=$.useRef(!!window.HandoffAppearAnimations);return ESe(()=>{E&&(E.render(),y.current&&E.animationState&&E.animationState.animateChanges())}),$.useEffect(()=>{E&&(E.updateFeatures(),!y.current&&E.animationState&&E.animationState.animateChanges(),window.HandoffAppearAnimations=void 0,y.current=!1)}),E}function jE(t){return typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function ySe(t,e,n){return $.useCallback(r=>{r&&t.mount&&t.mount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):jE(n)&&(n.current=r))},[e])}function ZT(t){return typeof t=="string"||Array.isArray(t)}function gP(t){return typeof t=="object"&&typeof t.start=="function"}const U4=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],j4=["initial",...U4];function _P(t){return gP(t.animate)||j4.some(e=>ZT(t[e]))}function Tee(t){return!!(_P(t)||t.variants)}function SSe(t,e){if(_P(t)){const{initial:n,animate:r}=t;return{initial:n===!1||ZT(n)?n:void 0,animate:ZT(r)?r:void 0}}return t.inherit!==!1?e:{}}function TSe(t){const{initial:e,animate:n}=SSe(t,$.useContext(pP));return $.useMemo(()=>({initial:e,animate:n}),[fG(e),fG(n)])}function fG(t){return Array.isArray(t)?t.join(" "):t}const pG={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},eb={};for(const t in pG)eb[t]={isEnabled:e=>pG[t].some(n=>!!e[n])};function bSe(t){for(const e in t)eb[e]={...eb[e],...t[e]}}const bee=$.createContext({}),wee=$.createContext({}),wSe=Symbol.for("motionComponentSymbol");function CSe({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:r,Component:c}){t&&bSe(t);function l(f,m){let E;const y={...$.useContext(yee),...f,layoutId:RSe(f)},{isStatic:w}=y,I=TSe(f),P=r(f,w);if(!w&&mP){I.visualElement=vSe(c,P,y,e);const k=$.useContext(wee),M=$.useContext(See).strict;I.visualElement&&(E=I.visualElement.loadFeatures(y,M,t,k))}return $.createElement(pP.Provider,{value:I},E&&I.visualElement?$.createElement(E,{visualElement:I.visualElement,...y}):null,n(c,f,ySe(P,I.visualElement,m),P,w,I.visualElement))}const d=$.forwardRef(l);return d[wSe]=c,d}function RSe({layoutId:t}){const e=$.useContext(bee).id;return e&&t!==void 0?e+"-"+t:t}function ISe(t){function e(r,c={}){return CSe(t(r,c))}if(typeof Proxy>"u")return e;const n=new Map;return new Proxy(e,{get:(r,c)=>(n.has(c)||n.set(c,e(c)),n.get(c))})}const ASe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function F4(t){return typeof t!="string"||t.includes("-")?!1:!!(ASe.indexOf(t)>-1||/[A-Z]/.test(t))}const R1={};function OSe(t){Object.assign(R1,t)}const Ab=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],_g=new Set(Ab);function Cee(t,{layout:e,layoutId:n}){return _g.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!R1[t]||t==="opacity")}const Ra=t=>!!(t&&t.getVelocity),NSe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},PSe=Ab.length;function xSe(t,{enableHardwareAcceleration:e=!0,allowTransformNone:n=!0},r,c){let l="";for(let d=0;d<PSe;d++){const f=Ab[d];if(t[f]!==void 0){const m=NSe[f]||f;l+=`${m}(${t[f]}) `}}return e&&!t.z&&(l+="translateZ(0)"),l=l.trim(),c?l=c(t,r?"":l):n&&r&&(l="none"),l}const Ree=t=>e=>typeof e=="string"&&e.startsWith(t),Iee=Ree("--"),F3=Ree("var(--"),DSe=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,kSe=(t,e)=>e&&typeof t=="number"?e.transform(t):t,$f=(t,e,n)=>Math.min(Math.max(n,t),e),Eg={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},vT={...Eg,transform:t=>$f(0,1,t)},jA={...Eg,default:1},yT=t=>Math.round(t*1e5)/1e5,EP=/(-)?([\d]*\.?[\d])+/g,Aee=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,LSe=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function Ob(t){return typeof t=="string"}const Nb=t=>({test:e=>Ob(e)&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),rf=Nb("deg"),vu=Nb("%"),Jt=Nb("px"),MSe=Nb("vh"),USe=Nb("vw"),mG={...vu,parse:t=>vu.parse(t)/100,transform:t=>vu.transform(t*100)},gG={...Eg,transform:Math.round},Oee={borderWidth:Jt,borderTopWidth:Jt,borderRightWidth:Jt,borderBottomWidth:Jt,borderLeftWidth:Jt,borderRadius:Jt,radius:Jt,borderTopLeftRadius:Jt,borderTopRightRadius:Jt,borderBottomRightRadius:Jt,borderBottomLeftRadius:Jt,width:Jt,maxWidth:Jt,height:Jt,maxHeight:Jt,size:Jt,top:Jt,right:Jt,bottom:Jt,left:Jt,padding:Jt,paddingTop:Jt,paddingRight:Jt,paddingBottom:Jt,paddingLeft:Jt,margin:Jt,marginTop:Jt,marginRight:Jt,marginBottom:Jt,marginLeft:Jt,rotate:rf,rotateX:rf,rotateY:rf,rotateZ:rf,scale:jA,scaleX:jA,scaleY:jA,scaleZ:jA,skew:rf,skewX:rf,skewY:rf,distance:Jt,translateX:Jt,translateY:Jt,translateZ:Jt,x:Jt,y:Jt,z:Jt,perspective:Jt,transformPerspective:Jt,opacity:vT,originX:mG,originY:mG,originZ:Jt,zIndex:gG,fillOpacity:vT,strokeOpacity:vT,numOctaves:gG};function V4(t,e,n,r){const{style:c,vars:l,transform:d,transformOrigin:f}=t;let m=!1,E=!1,y=!0;for(const w in e){const I=e[w];if(Iee(w)){l[w]=I;continue}const P=Oee[w],k=kSe(I,P);if(_g.has(w)){if(m=!0,d[w]=k,!y)continue;I!==(P.default||0)&&(y=!1)}else w.startsWith("origin")?(E=!0,f[w]=k):c[w]=k}if(e.transform||(m||r?c.transform=xSe(t.transform,n,y,r):c.transform&&(c.transform="none")),E){const{originX:w="50%",originY:I="50%",originZ:P=0}=f;c.transformOrigin=`${w} ${I} ${P}`}}const B4=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Nee(t,e,n){for(const r in e)!Ra(e[r])&&!Cee(r,n)&&(t[r]=e[r])}function jSe({transformTemplate:t},e,n){return $.useMemo(()=>{const r=B4();return V4(r,e,{enableHardwareAcceleration:!n},t),Object.assign({},r.vars,r.style)},[e])}function FSe(t,e,n){const r=t.style||{},c={};return Nee(c,r,t),Object.assign(c,jSe(t,e,n)),t.transformValues?t.transformValues(c):c}function VSe(t,e,n){const r={},c=FSe(t,e,n);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,c.userSelect=c.WebkitUserSelect=c.WebkitTouchCallout="none",c.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=c,r}const BSe=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onLayoutAnimationStart","onLayoutAnimationComplete","onLayoutMeasure","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","ignoreStrict","viewport"]);function I1(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||BSe.has(t)}let Pee=t=>!I1(t);function WSe(t){t&&(Pee=e=>e.startsWith("on")?!I1(e):t(e))}try{WSe(require("@emotion/is-prop-valid").default)}catch{}function HSe(t,e,n){const r={};for(const c in t)c==="values"&&typeof t.values=="object"||(Pee(c)||n===!0&&I1(c)||!e&&!I1(c)||t.draggable&&c.startsWith("onDrag"))&&(r[c]=t[c]);return r}function _G(t,e,n){return typeof t=="string"?t:Jt.transform(e+n*t)}function $Se(t,e,n){const r=_G(e,t.x,t.width),c=_G(n,t.y,t.height);return`${r} ${c}`}const zSe={offset:"stroke-dashoffset",array:"stroke-dasharray"},GSe={offset:"strokeDashoffset",array:"strokeDasharray"};function KSe(t,e,n=1,r=0,c=!0){t.pathLength=1;const l=c?zSe:GSe;t[l.offset]=Jt.transform(-r);const d=Jt.transform(e),f=Jt.transform(n);t[l.array]=`${d} ${f}`}function W4(t,{attrX:e,attrY:n,attrScale:r,originX:c,originY:l,pathLength:d,pathSpacing:f=1,pathOffset:m=0,...E},y,w,I){if(V4(t,E,y,I),w){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:P,style:k,dimensions:M}=t;P.transform&&(M&&(k.transform=P.transform),delete P.transform),M&&(c!==void 0||l!==void 0||k.transform)&&(k.transformOrigin=$Se(M,c!==void 0?c:.5,l!==void 0?l:.5)),e!==void 0&&(P.x=e),n!==void 0&&(P.y=n),r!==void 0&&(P.scale=r),d!==void 0&&KSe(P,d,f,m,!1)}const xee=()=>({...B4(),attrs:{}}),H4=t=>typeof t=="string"&&t.toLowerCase()==="svg";function qSe(t,e,n,r){const c=$.useMemo(()=>{const l=xee();return W4(l,e,{enableHardwareAcceleration:!1},H4(r),t.transformTemplate),{...l.attrs,style:{...l.style}}},[e]);if(t.style){const l={};Nee(l,t.style,t),c.style={...l,...c.style}}return c}function YSe(t=!1){return(n,r,c,{latestValues:l},d)=>{const m=(F4(n)?qSe:VSe)(r,l,d,n),y={...HSe(r,typeof n=="string",t),...m,ref:c},{children:w}=r,I=$.useMemo(()=>Ra(w)?w.get():w,[w]);return $.createElement(n,{...y,children:I})}}const $4=t=>t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();function Dee(t,{style:e,vars:n},r,c){Object.assign(t.style,e,c&&c.getProjectionStyles(r));for(const l in n)t.style.setProperty(l,n[l])}const kee=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Lee(t,e,n,r){Dee(t,e,void 0,r);for(const c in e.attrs)t.setAttribute(kee.has(c)?c:$4(c),e.attrs[c])}function z4(t,e){const{style:n}=t,r={};for(const c in n)(Ra(n[c])||e.style&&Ra(e.style[c])||Cee(c,t))&&(r[c]=n[c]);return r}function Mee(t,e){const n=z4(t,e);for(const r in t)if(Ra(t[r])||Ra(e[r])){const c=Ab.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;n[c]=t[r]}return n}function G4(t,e,n,r={},c={}){return typeof e=="function"&&(e=e(n!==void 0?n:t.custom,r,c)),typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"&&(e=e(n!==void 0?n:t.custom,r,c)),e}function XSe(t){const e=$.useRef(null);return e.current===null&&(e.current=t()),e.current}const A1=t=>Array.isArray(t),JSe=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),QSe=t=>A1(t)?t[t.length-1]||0:t;function kO(t){const e=Ra(t)?t.get():t;return JSe(e)?e.toValue():e}function ZSe({scrapeMotionValuesFromProps:t,createRenderState:e,onMount:n},r,c,l){const d={latestValues:eTe(r,c,l,t),renderState:e()};return n&&(d.mount=f=>n(r,f,d)),d}const Uee=t=>(e,n)=>{const r=$.useContext(pP),c=$.useContext(M4),l=()=>ZSe(t,e,r,c);return n?l():XSe(l)};function eTe(t,e,n,r){const c={},l=r(t,{});for(const I in l)c[I]=kO(l[I]);let{initial:d,animate:f}=t;const m=_P(t),E=Tee(t);e&&E&&!m&&t.inherit!==!1&&(d===void 0&&(d=e.initial),f===void 0&&(f=e.animate));let y=n?n.initial===!1:!1;y=y||d===!1;const w=y?f:d;return w&&typeof w!="boolean"&&!gP(w)&&(Array.isArray(w)?w:[w]).forEach(P=>{const k=G4(t,P);if(!k)return;const{transitionEnd:M,transition:K,...W}=k;for(const V in W){let G=W[V];if(Array.isArray(G)){const Q=y?G.length-1:0;G=G[Q]}G!==null&&(c[V]=G)}for(const V in M)c[V]=M[V]}),c}const kr=t=>t;class EG{constructor(){this.order=[],this.scheduled=new Set}add(e){if(!this.scheduled.has(e))return this.scheduled.add(e),this.order.push(e),!0}remove(e){const n=this.order.indexOf(e);n!==-1&&(this.order.splice(n,1),this.scheduled.delete(e))}clear(){this.order.length=0,this.scheduled.clear()}}function tTe(t){let e=new EG,n=new EG,r=0,c=!1,l=!1;const d=new WeakSet,f={schedule:(m,E=!1,y=!1)=>{const w=y&&c,I=w?e:n;return E&&d.add(m),I.add(m)&&w&&c&&(r=e.order.length),m},cancel:m=>{n.remove(m),d.delete(m)},process:m=>{if(c){l=!0;return}if(c=!0,[e,n]=[n,e],n.clear(),r=e.order.length,r)for(let E=0;E<r;E++){const y=e.order[E];y(m),d.has(y)&&(f.schedule(y),t())}c=!1,l&&(l=!1,f.process(m))}};return f}const FA=["prepare","read","update","preRender","render","postRender"],nTe=40;function iTe(t,e){let n=!1,r=!0;const c={delta:0,timestamp:0,isProcessing:!1},l=FA.reduce((w,I)=>(w[I]=tTe(()=>n=!0),w),{}),d=w=>l[w].process(c),f=()=>{const w=performance.now();n=!1,c.delta=r?1e3/60:Math.max(Math.min(w-c.timestamp,nTe),1),c.timestamp=w,c.isProcessing=!0,FA.forEach(d),c.isProcessing=!1,n&&e&&(r=!1,t(f))},m=()=>{n=!0,r=!0,c.isProcessing||t(f)};return{schedule:FA.reduce((w,I)=>{const P=l[I];return w[I]=(k,M=!1,K=!1)=>(n||m(),P.schedule(k,M,K)),w},{}),cancel:w=>FA.forEach(I=>l[I].cancel(w)),state:c,steps:l}}const{schedule:ur,cancel:Bd,state:Ps,steps:Aj}=iTe(typeof requestAnimationFrame<"u"?requestAnimationFrame:kr,!0),rTe={useVisualState:Uee({scrapeMotionValuesFromProps:Mee,createRenderState:xee,onMount:(t,e,{renderState:n,latestValues:r})=>{ur.read(()=>{try{n.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{n.dimensions={x:0,y:0,width:0,height:0}}}),ur.render(()=>{W4(n,r,{enableHardwareAcceleration:!1},H4(e.tagName),t.transformTemplate),Lee(e,n)})}})},sTe={useVisualState:Uee({scrapeMotionValuesFromProps:z4,createRenderState:B4})};function oTe(t,{forwardMotionProps:e=!1},n,r){return{...F4(t)?rTe:sTe,preloadedFeatures:n,useRender:YSe(e),createVisualElement:r,Component:t}}function Ad(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}const jee=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1;function vP(t,e="page"){return{point:{x:t[e+"X"],y:t[e+"Y"]}}}const aTe=t=>e=>jee(e)&&t(e,vP(e));function kd(t,e,n,r){return Ad(t,e,aTe(n),r)}const cTe=(t,e)=>n=>e(t(n)),kf=(...t)=>t.reduce(cTe);function Fee(t){let e=null;return()=>{const n=()=>{e=null};return e===null?(e=t,n):!1}}const vG=Fee("dragHorizontal"),yG=Fee("dragVertical");function Vee(t){let e=!1;if(t==="y")e=yG();else if(t==="x")e=vG();else{const n=vG(),r=yG();n&&r?e=()=>{n(),r()}:(n&&n(),r&&r())}return e}function Bee(){const t=Vee(!0);return t?(t(),!1):!0}class Zf{constructor(e){this.isMounted=!1,this.node=e}update(){}}function SG(t,e){const n="pointer"+(e?"enter":"leave"),r="onHover"+(e?"Start":"End"),c=(l,d)=>{if(l.type==="touch"||Bee())return;const f=t.getProps();t.animationState&&f.whileHover&&t.animationState.setActive("whileHover",e),f[r]&&ur.update(()=>f[r](l,d))};return kd(t.current,n,c,{passive:!t.getProps()[r]})}class lTe extends Zf{mount(){this.unmount=kf(SG(this.node,!0),SG(this.node,!1))}unmount(){}}class uTe extends Zf{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=kf(Ad(this.node.current,"focus",()=>this.onFocus()),Ad(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const Wee=(t,e)=>e?t===e?!0:Wee(t,e.parentElement):!1;function Oj(t,e){if(!e)return;const n=new PointerEvent("pointer"+t);e(n,vP(n))}class dTe extends Zf{constructor(){super(...arguments),this.removeStartListeners=kr,this.removeEndListeners=kr,this.removeAccessibleListeners=kr,this.startPointerPress=(e,n)=>{if(this.removeEndListeners(),this.isPressing)return;const r=this.node.getProps(),l=kd(window,"pointerup",(f,m)=>{if(!this.checkPressEnd())return;const{onTap:E,onTapCancel:y}=this.node.getProps();ur.update(()=>{Wee(this.node.current,f.target)?E&&E(f,m):y&&y(f,m)})},{passive:!(r.onTap||r.onPointerUp)}),d=kd(window,"pointercancel",(f,m)=>this.cancelPress(f,m),{passive:!(r.onTapCancel||r.onPointerCancel)});this.removeEndListeners=kf(l,d),this.startPress(e,n)},this.startAccessiblePress=()=>{const e=l=>{if(l.key!=="Enter"||this.isPressing)return;const d=f=>{f.key!=="Enter"||!this.checkPressEnd()||Oj("up",(m,E)=>{const{onTap:y}=this.node.getProps();y&&ur.update(()=>y(m,E))})};this.removeEndListeners(),this.removeEndListeners=Ad(this.node.current,"keyup",d),Oj("down",(f,m)=>{this.startPress(f,m)})},n=Ad(this.node.current,"keydown",e),r=()=>{this.isPressing&&Oj("cancel",(l,d)=>this.cancelPress(l,d))},c=Ad(this.node.current,"blur",r);this.removeAccessibleListeners=kf(n,c)}}startPress(e,n){this.isPressing=!0;const{onTapStart:r,whileTap:c}=this.node.getProps();c&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),r&&ur.update(()=>r(e,n))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!Bee()}cancelPress(e,n){if(!this.checkPressEnd())return;const{onTapCancel:r}=this.node.getProps();r&&ur.update(()=>r(e,n))}mount(){const e=this.node.getProps(),n=kd(this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),r=Ad(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=kf(n,r)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const V3=new WeakMap,Nj=new WeakMap,hTe=t=>{const e=V3.get(t.target);e&&e(t)},fTe=t=>{t.forEach(hTe)};function pTe({root:t,...e}){const n=t||document;Nj.has(n)||Nj.set(n,{});const r=Nj.get(n),c=JSON.stringify(e);return r[c]||(r[c]=new IntersectionObserver(fTe,{root:t,...e})),r[c]}function mTe(t,e,n){const r=pTe(e);return V3.set(t,n),r.observe(t),()=>{V3.delete(t),r.unobserve(t)}}const gTe={some:0,all:1};class _Te extends Zf{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:c="some",once:l}=e,d={root:n?n.current:void 0,rootMargin:r,threshold:typeof c=="number"?c:gTe[c]},f=m=>{const{isIntersecting:E}=m;if(this.isInView===E||(this.isInView=E,l&&!E&&this.hasEnteredView))return;E&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",E);const{onViewportEnter:y,onViewportLeave:w}=this.node.getProps(),I=E?y:w;I&&I(m)};return mTe(this.node.current,d,f)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(ETe(e,n))&&this.startObserver()}unmount(){}}function ETe({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const vTe={inView:{Feature:_Te},tap:{Feature:dTe},focus:{Feature:uTe},hover:{Feature:lTe}};function Hee(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}function yTe(t){const e={};return t.values.forEach((n,r)=>e[r]=n.get()),e}function STe(t){const e={};return t.values.forEach((n,r)=>e[r]=n.getVelocity()),e}function yP(t,e,n){const r=t.getProps();return G4(r,e,n!==void 0?n:r.custom,yTe(t),STe(t))}const TTe="framerAppearId",bTe="data-"+$4(TTe);let wTe=kr,K4=kr;const Lf=t=>t*1e3,Ld=t=>t/1e3,CTe={current:!1},$ee=t=>Array.isArray(t)&&typeof t[0]=="number";function zee(t){return!!(!t||typeof t=="string"&&Gee[t]||$ee(t)||Array.isArray(t)&&t.every(zee))}const eT=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,Gee={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:eT([0,.65,.55,1]),circOut:eT([.55,0,1,.45]),backIn:eT([.31,.01,.66,-.59]),backOut:eT([.33,1.53,.69,.99])};function Kee(t){if(t)return $ee(t)?eT(t):Array.isArray(t)?t.map(Kee):Gee[t]}function RTe(t,e,n,{delay:r=0,duration:c,repeat:l=0,repeatType:d="loop",ease:f,times:m}={}){const E={[e]:n};m&&(E.offset=m);const y=Kee(f);return Array.isArray(y)&&(E.easing=y),t.animate(E,{delay:r,duration:c,easing:Array.isArray(y)?"linear":y,fill:"both",iterations:l+1,direction:d==="reverse"?"alternate":"normal"})}function ITe(t,{repeat:e,repeatType:n="loop"}){const r=e&&n!=="loop"&&e%2===1?0:t.length-1;return t[r]}const qee=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,ATe=1e-7,OTe=12;function NTe(t,e,n,r,c){let l,d,f=0;do d=e+(n-e)/2,l=qee(d,r,c)-t,l>0?n=d:e=d;while(Math.abs(l)>ATe&&++f<OTe);return d}function Pb(t,e,n,r){if(t===e&&n===r)return kr;const c=l=>NTe(l,0,1,t,n);return l=>l===0||l===1?l:qee(c(l),e,r)}const PTe=Pb(.42,0,1,1),xTe=Pb(0,0,.58,1),Yee=Pb(.42,0,.58,1),DTe=t=>Array.isArray(t)&&typeof t[0]!="number",Xee=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,Jee=t=>e=>1-t(1-e),Qee=t=>1-Math.sin(Math.acos(t)),q4=Jee(Qee),kTe=Xee(q4),Zee=Pb(.33,1.53,.69,.99),Y4=Jee(Zee),LTe=Xee(Y4),MTe=t=>(t*=2)<1?.5*Y4(t):.5*(2-Math.pow(2,-10*(t-1))),UTe={linear:kr,easeIn:PTe,easeInOut:Yee,easeOut:xTe,circIn:Qee,circInOut:kTe,circOut:q4,backIn:Y4,backInOut:LTe,backOut:Zee,anticipate:MTe},TG=t=>{if(Array.isArray(t)){K4(t.length===4);const[e,n,r,c]=t;return Pb(e,n,r,c)}else if(typeof t=="string")return UTe[t];return t},X4=(t,e)=>n=>!!(Ob(n)&&LSe.test(n)&&n.startsWith(t)||e&&Object.prototype.hasOwnProperty.call(n,e)),ete=(t,e,n)=>r=>{if(!Ob(r))return r;const[c,l,d,f]=r.match(EP);return{[t]:parseFloat(c),[e]:parseFloat(l),[n]:parseFloat(d),alpha:f!==void 0?parseFloat(f):1}},jTe=t=>$f(0,255,t),Pj={...Eg,transform:t=>Math.round(jTe(t))},Um={test:X4("rgb","red"),parse:ete("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+Pj.transform(t)+", "+Pj.transform(e)+", "+Pj.transform(n)+", "+yT(vT.transform(r))+")"};function FTe(t){let e="",n="",r="",c="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),c=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),c=t.substring(4,5),e+=e,n+=n,r+=r,c+=c),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:c?parseInt(c,16)/255:1}}const B3={test:X4("#"),parse:FTe,transform:Um.transform},FE={test:X4("hsl","hue"),parse:ete("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+vu.transform(yT(e))+", "+vu.transform(yT(n))+", "+yT(vT.transform(r))+")"},Bo={test:t=>Um.test(t)||B3.test(t)||FE.test(t),parse:t=>Um.test(t)?Um.parse(t):FE.test(t)?FE.parse(t):B3.parse(t),transform:t=>Ob(t)?t:t.hasOwnProperty("red")?Um.transform(t):FE.transform(t)},Or=(t,e,n)=>-n*t+n*e+t;function xj(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function VTe({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let c=0,l=0,d=0;if(!e)c=l=d=n;else{const f=n<.5?n*(1+e):n+e-n*e,m=2*n-f;c=xj(m,f,t+1/3),l=xj(m,f,t),d=xj(m,f,t-1/3)}return{red:Math.round(c*255),green:Math.round(l*255),blue:Math.round(d*255),alpha:r}}const Dj=(t,e,n)=>{const r=t*t;return Math.sqrt(Math.max(0,n*(e*e-r)+r))},BTe=[B3,Um,FE],WTe=t=>BTe.find(e=>e.test(t));function bG(t){const e=WTe(t);let n=e.parse(t);return e===FE&&(n=VTe(n)),n}const tte=(t,e)=>{const n=bG(t),r=bG(e),c={...n};return l=>(c.red=Dj(n.red,r.red,l),c.green=Dj(n.green,r.green,l),c.blue=Dj(n.blue,r.blue,l),c.alpha=Or(n.alpha,r.alpha,l),Um.transform(c))};function HTe(t){var e,n;return isNaN(t)&&Ob(t)&&(((e=t.match(EP))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(Aee))===null||n===void 0?void 0:n.length)||0)>0}const nte={regex:DSe,countKey:"Vars",token:"${v}",parse:kr},ite={regex:Aee,countKey:"Colors",token:"${c}",parse:Bo.parse},rte={regex:EP,countKey:"Numbers",token:"${n}",parse:Eg.parse};function kj(t,{regex:e,countKey:n,token:r,parse:c}){const l=t.tokenised.match(e);l&&(t["num"+n]=l.length,t.tokenised=t.tokenised.replace(e,r),t.values.push(...l.map(c)))}function O1(t){const e=t.toString(),n={value:e,tokenised:e,values:[],numVars:0,numColors:0,numNumbers:0};return n.value.includes("var(--")&&kj(n,nte),kj(n,ite),kj(n,rte),n}function ste(t){return O1(t).values}function ote(t){const{values:e,numColors:n,numVars:r,tokenised:c}=O1(t),l=e.length;return d=>{let f=c;for(let m=0;m<l;m++)m<r?f=f.replace(nte.token,d[m]):m<r+n?f=f.replace(ite.token,Bo.transform(d[m])):f=f.replace(rte.token,yT(d[m]));return f}}const $Te=t=>typeof t=="number"?0:t;function zTe(t){const e=ste(t);return ote(t)(e.map($Te))}const zf={test:HTe,parse:ste,createTransformer:ote,getAnimatableNone:zTe},ate=(t,e)=>n=>`${n>0?e:t}`;function cte(t,e){return typeof t=="number"?n=>Or(t,e,n):Bo.test(t)?tte(t,e):t.startsWith("var(")?ate(t,e):ute(t,e)}const lte=(t,e)=>{const n=[...t],r=n.length,c=t.map((l,d)=>cte(l,e[d]));return l=>{for(let d=0;d<r;d++)n[d]=c[d](l);return n}},GTe=(t,e)=>{const n={...t,...e},r={};for(const c in n)t[c]!==void 0&&e[c]!==void 0&&(r[c]=cte(t[c],e[c]));return c=>{for(const l in r)n[l]=r[l](c);return n}},ute=(t,e)=>{const n=zf.createTransformer(e),r=O1(t),c=O1(e);return r.numVars===c.numVars&&r.numColors===c.numColors&&r.numNumbers>=c.numNumbers?kf(lte(r.values,c.values),n):ate(t,e)},tb=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r},wG=(t,e)=>n=>Or(t,e,n);function KTe(t){return typeof t=="number"?wG:typeof t=="string"?Bo.test(t)?tte:ute:Array.isArray(t)?lte:typeof t=="object"?GTe:wG}function qTe(t,e,n){const r=[],c=n||KTe(t[0]),l=t.length-1;for(let d=0;d<l;d++){let f=c(t[d],t[d+1]);if(e){const m=Array.isArray(e)?e[d]||kr:e;f=kf(m,f)}r.push(f)}return r}function dte(t,e,{clamp:n=!0,ease:r,mixer:c}={}){const l=t.length;if(K4(l===e.length),l===1)return()=>e[0];t[0]>t[l-1]&&(t=[...t].reverse(),e=[...e].reverse());const d=qTe(e,r,c),f=d.length,m=E=>{let y=0;if(f>1)for(;y<t.length-2&&!(E<t[y+1]);y++);const w=tb(t[y],t[y+1],E);return d[y](w)};return n?E=>m($f(t[0],t[l-1],E)):m}function YTe(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const c=tb(0,e,r);t.push(Or(n,1,c))}}function XTe(t){const e=[0];return YTe(e,t.length-1),e}function JTe(t,e){return t.map(n=>n*e)}function QTe(t,e){return t.map(()=>e||Yee).splice(0,t.length-1)}function N1({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const c=DTe(r)?r.map(TG):TG(r),l={done:!1,value:e[0]},d=JTe(n&&n.length===e.length?n:XTe(e),t),f=dte(d,e,{ease:Array.isArray(c)?c:QTe(e,c)});return{calculatedDuration:t,next:m=>(l.value=f(m),l.done=m>=t,l)}}function hte(t,e){return e?t*(1e3/e):0}const ZTe=5;function fte(t,e,n){const r=Math.max(e-ZTe,0);return hte(n-t(r),e-r)}const Lj=.001,ebe=.01,CG=10,tbe=.05,nbe=1;function ibe({duration:t=800,bounce:e=.25,velocity:n=0,mass:r=1}){let c,l;wTe(t<=Lf(CG));let d=1-e;d=$f(tbe,nbe,d),t=$f(ebe,CG,Ld(t)),d<1?(c=E=>{const y=E*d,w=y*t,I=y-n,P=W3(E,d),k=Math.exp(-w);return Lj-I/P*k},l=E=>{const w=E*d*t,I=w*n+n,P=Math.pow(d,2)*Math.pow(E,2)*t,k=Math.exp(-w),M=W3(Math.pow(E,2),d);return(-c(E)+Lj>0?-1:1)*((I-P)*k)/M}):(c=E=>{const y=Math.exp(-E*t),w=(E-n)*t+1;return-Lj+y*w},l=E=>{const y=Math.exp(-E*t),w=(n-E)*(t*t);return y*w});const f=5/t,m=sbe(c,l,f);if(t=Lf(t),isNaN(m))return{stiffness:100,damping:10,duration:t};{const E=Math.pow(m,2)*r;return{stiffness:E,damping:d*2*Math.sqrt(r*E),duration:t}}}const rbe=12;function sbe(t,e,n){let r=n;for(let c=1;c<rbe;c++)r=r-t(r)/e(r);return r}function W3(t,e){return t*Math.sqrt(1-e*e)}const obe=["duration","bounce"],abe=["stiffness","damping","mass"];function RG(t,e){return e.some(n=>t[n]!==void 0)}function cbe(t){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...t};if(!RG(t,abe)&&RG(t,obe)){const n=ibe(t);e={...e,...n,velocity:0,mass:1},e.isResolvedFromDuration=!0}return e}function pte({keyframes:t,restDelta:e,restSpeed:n,...r}){const c=t[0],l=t[t.length-1],d={done:!1,value:c},{stiffness:f,damping:m,mass:E,velocity:y,duration:w,isResolvedFromDuration:I}=cbe(r),P=y?-Ld(y):0,k=m/(2*Math.sqrt(f*E)),M=l-c,K=Ld(Math.sqrt(f/E)),W=Math.abs(M)<5;n||(n=W?.01:2),e||(e=W?.005:.5);let V;if(k<1){const G=W3(K,k);V=Q=>{const Z=Math.exp(-k*K*Q);return l-Z*((P+k*K*M)/G*Math.sin(G*Q)+M*Math.cos(G*Q))}}else if(k===1)V=G=>l-Math.exp(-K*G)*(M+(P+K*M)*G);else{const G=K*Math.sqrt(k*k-1);V=Q=>{const Z=Math.exp(-k*K*Q),Y=Math.min(G*Q,300);return l-Z*((P+k*K*M)*Math.sinh(Y)+G*M*Math.cosh(Y))/G}}return{calculatedDuration:I&&w||null,next:G=>{const Q=V(G);if(I)d.done=G>=w;else{let Z=P;G!==0&&(k<1?Z=fte(V,G,Q):Z=0);const Y=Math.abs(Z)<=n,oe=Math.abs(l-Q)<=e;d.done=Y&&oe}return d.value=d.done?l:Q,d}}}function IG({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:c=10,bounceStiffness:l=500,modifyTarget:d,min:f,max:m,restDelta:E=.5,restSpeed:y}){const w=t[0],I={done:!1,value:w},P=ce=>f!==void 0&&ce<f||m!==void 0&&ce>m,k=ce=>f===void 0?m:m===void 0||Math.abs(f-ce)<Math.abs(m-ce)?f:m;let M=n*e;const K=w+M,W=d===void 0?K:d(K);W!==K&&(M=W-w);const V=ce=>-M*Math.exp(-ce/r),G=ce=>W+V(ce),Q=ce=>{const Se=V(ce),xe=G(ce);I.done=Math.abs(Se)<=E,I.value=I.done?W:xe};let Z,Y;const oe=ce=>{P(I.value)&&(Z=ce,Y=pte({keyframes:[I.value,k(I.value)],velocity:fte(G,ce,I.value),damping:c,stiffness:l,restDelta:E,restSpeed:y}))};return oe(0),{calculatedDuration:null,next:ce=>{let Se=!1;return!Y&&Z===void 0&&(Se=!0,Q(ce),oe(ce)),Z!==void 0&&ce>Z?Y.next(ce-Z):(!Se&&Q(ce),I)}}}const lbe=t=>{const e=({timestamp:n})=>t(n);return{start:()=>ur.update(e,!0),stop:()=>Bd(e),now:()=>Ps.isProcessing?Ps.timestamp:performance.now()}},AG=2e4;function OG(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<AG;)e+=n,r=t.next(e);return e>=AG?1/0:e}const ube={decay:IG,inertia:IG,tween:N1,keyframes:N1,spring:pte};function P1({autoplay:t=!0,delay:e=0,driver:n=lbe,keyframes:r,type:c="keyframes",repeat:l=0,repeatDelay:d=0,repeatType:f="loop",onPlay:m,onStop:E,onComplete:y,onUpdate:w,...I}){let P=1,k=!1,M,K;const W=()=>{K=new Promise(De=>{M=De})};W();let V;const G=ube[c]||N1;let Q;G!==N1&&typeof r[0]!="number"&&(Q=dte([0,100],r,{clamp:!1}),r=[0,100]);const Z=G({...I,keyframes:r});let Y;f==="mirror"&&(Y=G({...I,keyframes:[...r].reverse(),velocity:-(I.velocity||0)}));let oe="idle",ce=null,Se=null,xe=null;Z.calculatedDuration===null&&l&&(Z.calculatedDuration=OG(Z));const{calculatedDuration:je}=Z;let Ge=1/0,ze=1/0;je!==null&&(Ge=je+d,ze=Ge*(l+1)-d);let Ke=0;const He=De=>{if(Se===null)return;P>0&&(Se=Math.min(Se,De)),P<0&&(Se=Math.min(De-ze/P,Se)),ce!==null?Ke=ce:Ke=Math.round(De-Se)*P;const Ue=Ke-e*(P>=0?1:-1),rt=P>=0?Ue<0:Ue>ze;Ke=Math.max(Ue,0),oe==="finished"&&ce===null&&(Ke=ze);let gt=Ke,ft=Z;if(l){const Vt=Ke/Ge;let xn=Math.floor(Vt),En=Vt%1;!En&&Vt>=1&&(En=1),En===1&&xn--,xn=Math.min(xn,l+1);const Di=!!(xn%2);Di&&(f==="reverse"?(En=1-En,d&&(En-=d/Ge)):f==="mirror"&&(ft=Y));let ui=$f(0,1,En);Ke>ze&&(ui=f==="reverse"&&Di?1:0),gt=ui*Ge}const Ft=rt?{done:!1,value:r[0]}:ft.next(gt);Q&&(Ft.value=Q(Ft.value));let{done:qt}=Ft;!rt&&je!==null&&(qt=P>=0?Ke>=ze:Ke<=0);const ti=ce===null&&(oe==="finished"||oe==="running"&&qt);return w&&w(Ft.value),ti&&_e(),Ft},be=()=>{V&&V.stop(),V=void 0},Oe=()=>{oe="idle",be(),M(),W(),Se=xe=null},_e=()=>{oe="finished",y&&y(),be(),M()},We=()=>{if(k)return;V||(V=n(He));const De=V.now();m&&m(),ce!==null?Se=De-ce:(!Se||oe==="finished")&&(Se=De),oe==="finished"&&W(),xe=Se,ce=null,oe="running",V.start()};t&&We();const Ie={then(De,Ue){return K.then(De,Ue)},get time(){return Ld(Ke)},set time(De){De=Lf(De),Ke=De,ce!==null||!V||P===0?ce=De:Se=V.now()-De/P},get duration(){const De=Z.calculatedDuration===null?OG(Z):Z.calculatedDuration;return Ld(De)},get speed(){return P},set speed(De){De===P||!V||(P=De,Ie.time=Ld(Ke))},get state(){return oe},play:We,pause:()=>{oe="paused",ce=Ke},stop:()=>{k=!0,oe!=="idle"&&(oe="idle",E&&E(),Oe())},cancel:()=>{xe!==null&&He(xe),Oe()},complete:()=>{oe="finished"},sample:De=>(Se=0,He(De))};return Ie}function dbe(t){let e;return()=>(e===void 0&&(e=t()),e)}const hbe=dbe(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),fbe=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),VA=10,pbe=2e4,mbe=(t,e)=>e.type==="spring"||t==="backgroundColor"||!zee(e.ease);function gbe(t,e,{onUpdate:n,onComplete:r,...c}){if(!(hbe()&&fbe.has(e)&&!c.repeatDelay&&c.repeatType!=="mirror"&&c.damping!==0&&c.type!=="inertia"))return!1;let d=!1,f,m;const E=()=>{m=new Promise(V=>{f=V})};E();let{keyframes:y,duration:w=300,ease:I,times:P}=c;if(mbe(e,c)){const V=P1({...c,repeat:0,delay:0});let G={done:!1,value:y[0]};const Q=[];let Z=0;for(;!G.done&&Z<pbe;)G=V.sample(Z),Q.push(G.value),Z+=VA;P=void 0,y=Q,w=Z-VA,I="linear"}const k=RTe(t.owner.current,e,y,{...c,duration:w,ease:I,times:P});c.syncStart&&(k.startTime=Ps.isProcessing?Ps.timestamp:document.timeline?document.timeline.currentTime:performance.now());const M=()=>k.cancel(),K=()=>{ur.update(M),f(),E()};return k.onfinish=()=>{t.set(ITe(y,c)),r&&r(),K()},{then(V,G){return m.then(V,G)},attachTimeline(V){return k.timeline=V,k.onfinish=null,kr},get time(){return Ld(k.currentTime||0)},set time(V){k.currentTime=Lf(V)},get speed(){return k.playbackRate},set speed(V){k.playbackRate=V},get duration(){return Ld(w)},play:()=>{d||(k.play(),Bd(M))},pause:()=>k.pause(),stop:()=>{if(d=!0,k.playState==="idle")return;const{currentTime:V}=k;if(V){const G=P1({...c,autoplay:!1});t.setWithVelocity(G.sample(V-VA).value,G.sample(V).value,VA)}K()},complete:()=>k.finish(),cancel:K}}function _be({keyframes:t,delay:e,onUpdate:n,onComplete:r}){const c=()=>(n&&n(t[t.length-1]),r&&r(),{time:0,speed:1,duration:0,play:kr,pause:kr,stop:kr,then:l=>(l(),Promise.resolve()),cancel:kr,complete:kr});return e?P1({keyframes:[0,1],duration:0,delay:e,onComplete:c}):c()}const Ebe={type:"spring",stiffness:500,damping:25,restSpeed:10},vbe=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),ybe={type:"keyframes",duration:.8},Sbe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Tbe=(t,{keyframes:e})=>e.length>2?ybe:_g.has(t)?t.startsWith("scale")?vbe(e[1]):Ebe:Sbe,H3=(t,e)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(zf.test(e)||e==="0")&&!e.startsWith("url(")),bbe=new Set(["brightness","contrast","saturate","opacity"]);function wbe(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(EP)||[];if(!r)return t;const c=n.replace(r,"");let l=bbe.has(e)?1:0;return r!==n&&(l*=100),e+"("+l+c+")"}const Cbe=/([a-z-]*)\(.*?\)/g,$3={...zf,getAnimatableNone:t=>{const e=t.match(Cbe);return e?e.map(wbe).join(" "):t}},Rbe={...Oee,color:Bo,backgroundColor:Bo,outlineColor:Bo,fill:Bo,stroke:Bo,borderColor:Bo,borderTopColor:Bo,borderRightColor:Bo,borderBottomColor:Bo,borderLeftColor:Bo,filter:$3,WebkitFilter:$3},J4=t=>Rbe[t];function mte(t,e){let n=J4(t);return n!==$3&&(n=zf),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const gte=t=>/^0[^.\s]+$/.test(t);function Ibe(t){if(typeof t=="number")return t===0;if(t!==null)return t==="none"||t==="0"||gte(t)}function Abe(t,e,n,r){const c=H3(e,n);let l;Array.isArray(n)?l=[...n]:l=[null,n];const d=r.from!==void 0?r.from:t.get();let f;const m=[];for(let E=0;E<l.length;E++)l[E]===null&&(l[E]=E===0?d:l[E-1]),Ibe(l[E])&&m.push(E),typeof l[E]=="string"&&l[E]!=="none"&&l[E]!=="0"&&(f=l[E]);if(c&&m.length&&f)for(let E=0;E<m.length;E++){const y=m[E];l[y]=mte(e,f)}return l}function Obe({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:c,repeat:l,repeatType:d,repeatDelay:f,from:m,elapsed:E,...y}){return!!Object.keys(y).length}function _te(t,e){return t[e]||t.default||t}const Q4=(t,e,n,r={})=>c=>{const l=_te(r,t)||{},d=l.delay||r.delay||0;let{elapsed:f=0}=r;f=f-Lf(d);const m=Abe(e,t,n,l),E=m[0],y=m[m.length-1],w=H3(t,E),I=H3(t,y);let P={keyframes:m,velocity:e.getVelocity(),ease:"easeOut",...l,delay:-f,onUpdate:k=>{e.set(k),l.onUpdate&&l.onUpdate(k)},onComplete:()=>{c(),l.onComplete&&l.onComplete()}};if(Obe(l)||(P={...P,...Tbe(t,P)}),P.duration&&(P.duration=Lf(P.duration)),P.repeatDelay&&(P.repeatDelay=Lf(P.repeatDelay)),!w||!I||CTe.current||l.type===!1)return _be(P);if(e.owner&&e.owner.current instanceof HTMLElement&&!e.owner.getProps().onUpdate){const k=gbe(e,t,P);if(k)return k}return P1(P)};function x1(t){return!!(Ra(t)&&t.add)}const Ete=t=>/^\-?\d*\.?\d+$/.test(t);function Z4(t,e){t.indexOf(e)===-1&&t.push(e)}function e5(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class t5{constructor(){this.subscriptions=[]}add(e){return Z4(this.subscriptions,e),()=>e5(this.subscriptions,e)}notify(e,n,r){const c=this.subscriptions.length;if(c)if(c===1)this.subscriptions[0](e,n,r);else for(let l=0;l<c;l++){const d=this.subscriptions[l];d&&d(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Nbe=t=>!isNaN(parseFloat(t));class Pbe{constructor(e,n={}){this.version="10.16.4",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(r,c=!0)=>{this.prev=this.current,this.current=r;const{delta:l,timestamp:d}=Ps;this.lastUpdated!==d&&(this.timeDelta=l,this.lastUpdated=d,ur.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),c&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>ur.postRender(this.velocityCheck),this.velocityCheck=({timestamp:r})=>{r!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=Nbe(this.current),this.owner=n.owner}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new t5);const r=this.events[e].add(n);return e==="change"?()=>{r(),ur.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,r){this.set(n),this.prev=e,this.timeDelta=r}jump(e){this.updateAndNotify(e),this.prev=e,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?hte(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Sv(t,e){return new Pbe(t,e)}const vte=t=>e=>e.test(t),xbe={test:t=>t==="auto",parse:t=>t},yte=[Eg,Jt,vu,rf,USe,MSe,xbe],LS=t=>yte.find(vte(t)),Dbe=[...yte,Bo,zf],kbe=t=>Dbe.find(vte(t));function Lbe(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Sv(n))}function Mbe(t,e){const n=yP(t,e);let{transitionEnd:r={},transition:c={},...l}=n?t.makeTargetAnimatable(n,!1):{};l={...l,...r};for(const d in l){const f=QSe(l[d]);Lbe(t,d,f)}}function Ube(t,e,n){var r,c;const l=Object.keys(e).filter(f=>!t.hasValue(f)),d=l.length;if(d)for(let f=0;f<d;f++){const m=l[f],E=e[m];let y=null;Array.isArray(E)&&(y=E[0]),y===null&&(y=(c=(r=n[m])!==null&&r!==void 0?r:t.readValue(m))!==null&&c!==void 0?c:e[m]),y!=null&&(typeof y=="string"&&(Ete(y)||gte(y))?y=parseFloat(y):!kbe(y)&&zf.test(E)&&(y=mte(m,E)),t.addValue(m,Sv(y,{owner:t})),n[m]===void 0&&(n[m]=y),y!==null&&t.setBaseTarget(m,y))}}function jbe(t,e){return e?(e[t]||e.default||e).from:void 0}function Fbe(t,e,n){const r={};for(const c in t){const l=jbe(c,e);if(l!==void 0)r[c]=l;else{const d=n.getValue(c);d&&(r[c]=d.get())}}return r}function Vbe({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function Ste(t,e,{delay:n=0,transitionOverride:r,type:c}={}){let{transition:l=t.getDefaultTransition(),transitionEnd:d,...f}=t.makeTargetAnimatable(e);const m=t.getValue("willChange");r&&(l=r);const E=[],y=c&&t.animationState&&t.animationState.getState()[c];for(const w in f){const I=t.getValue(w),P=f[w];if(!I||P===void 0||y&&Vbe(y,w))continue;const k={delay:n,elapsed:0,...l};if(window.HandoffAppearAnimations&&!I.hasAnimated){const K=t.getProps()[bTe];K&&(k.elapsed=window.HandoffAppearAnimations(K,w,I,ur),k.syncStart=!0)}I.start(Q4(w,I,P,t.shouldReduceMotion&&_g.has(w)?{type:!1}:k));const M=I.animation;x1(m)&&(m.add(w),M.then(()=>m.remove(w))),E.push(M)}return d&&Promise.all(E).then(()=>{d&&Mbe(t,d)}),E}function z3(t,e,n={}){const r=yP(t,e,n.custom);let{transition:c=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(c=n.transitionOverride);const l=r?()=>Promise.all(Ste(t,r,n)):()=>Promise.resolve(),d=t.variantChildren&&t.variantChildren.size?(m=0)=>{const{delayChildren:E=0,staggerChildren:y,staggerDirection:w}=c;return Bbe(t,e,E+m,y,w,n)}:()=>Promise.resolve(),{when:f}=c;if(f){const[m,E]=f==="beforeChildren"?[l,d]:[d,l];return m().then(()=>E())}else return Promise.all([l(),d(n.delay)])}function Bbe(t,e,n=0,r=0,c=1,l){const d=[],f=(t.variantChildren.size-1)*r,m=c===1?(E=0)=>E*r:(E=0)=>f-E*r;return Array.from(t.variantChildren).sort(Wbe).forEach((E,y)=>{E.notify("AnimationStart",e),d.push(z3(E,e,{...l,delay:n+m(y)}).then(()=>E.notify("AnimationComplete",e)))}),Promise.all(d)}function Wbe(t,e){return t.sortNodePosition(e)}function Hbe(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const c=e.map(l=>z3(t,l,n));r=Promise.all(c)}else if(typeof e=="string")r=z3(t,e,n);else{const c=typeof e=="function"?yP(t,e,n.custom):e;r=Promise.all(Ste(t,c,n))}return r.then(()=>t.notify("AnimationComplete",e))}const $be=[...U4].reverse(),zbe=U4.length;function Gbe(t){return e=>Promise.all(e.map(({animation:n,options:r})=>Hbe(t,n,r)))}function Kbe(t){let e=Gbe(t);const n=Ybe();let r=!0;const c=(m,E)=>{const y=yP(t,E);if(y){const{transition:w,transitionEnd:I,...P}=y;m={...m,...P,...I}}return m};function l(m){e=m(t)}function d(m,E){const y=t.getProps(),w=t.getVariantContext(!0)||{},I=[],P=new Set;let k={},M=1/0;for(let W=0;W<zbe;W++){const V=$be[W],G=n[V],Q=y[V]!==void 0?y[V]:w[V],Z=ZT(Q),Y=V===E?G.isActive:null;Y===!1&&(M=W);let oe=Q===w[V]&&Q!==y[V]&&Z;if(oe&&r&&t.manuallyAnimateOnMount&&(oe=!1),G.protectedKeys={...k},!G.isActive&&Y===null||!Q&&!G.prevProp||gP(Q)||typeof Q=="boolean")continue;const ce=qbe(G.prevProp,Q);let Se=ce||V===E&&G.isActive&&!oe&&Z||W>M&&Z;const xe=Array.isArray(Q)?Q:[Q];let je=xe.reduce(c,{});Y===!1&&(je={});const{prevResolvedValues:Ge={}}=G,ze={...Ge,...je},Ke=He=>{Se=!0,P.delete(He),G.needsAnimating[He]=!0};for(const He in ze){const be=je[He],Oe=Ge[He];k.hasOwnProperty(He)||(be!==Oe?A1(be)&&A1(Oe)?!Hee(be,Oe)||ce?Ke(He):G.protectedKeys[He]=!0:be!==void 0?Ke(He):P.add(He):be!==void 0&&P.has(He)?Ke(He):G.protectedKeys[He]=!0)}G.prevProp=Q,G.prevResolvedValues=je,G.isActive&&(k={...k,...je}),r&&t.blockInitialAnimation&&(Se=!1),Se&&!oe&&I.push(...xe.map(He=>({animation:He,options:{type:V,...m}})))}if(P.size){const W={};P.forEach(V=>{const G=t.getBaseTarget(V);G!==void 0&&(W[V]=G)}),I.push({animation:W})}let K=!!I.length;return r&&y.initial===!1&&!t.manuallyAnimateOnMount&&(K=!1),r=!1,K?e(I):Promise.resolve()}function f(m,E,y){var w;if(n[m].isActive===E)return Promise.resolve();(w=t.variantChildren)===null||w===void 0||w.forEach(P=>{var k;return(k=P.animationState)===null||k===void 0?void 0:k.setActive(m,E)}),n[m].isActive=E;const I=d(y,m);for(const P in n)n[P].protectedKeys={};return I}return{animateChanges:d,setActive:f,setAnimateFunction:l,getState:()=>n}}function qbe(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!Hee(e,t):!1}function hm(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Ybe(){return{animate:hm(!0),whileInView:hm(),whileHover:hm(),whileTap:hm(),whileDrag:hm(),whileFocus:hm(),exit:hm()}}class Xbe extends Zf{constructor(e){super(e),e.animationState||(e.animationState=Kbe(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();this.unmount(),gP(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){}}let Jbe=0;class Qbe extends Zf{constructor(){super(...arguments),this.id=Jbe++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n,custom:r}=this.node.presenceContext,{isPresent:c}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===c)return;const l=this.node.animationState.setActive("exit",!e,{custom:r??this.node.getProps().custom});n&&!e&&l.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const Zbe={animation:{Feature:Xbe},exit:{Feature:Qbe}},NG=(t,e)=>Math.abs(t-e);function ewe(t,e){const n=NG(t.x,e.x),r=NG(t.y,e.y);return Math.sqrt(n**2+r**2)}class Tte{constructor(e,n,{transformPagePoint:r}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const E=Uj(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,w=ewe(E.offset,{x:0,y:0})>=3;if(!y&&!w)return;const{point:I}=E,{timestamp:P}=Ps;this.history.push({...I,timestamp:P});const{onStart:k,onMove:M}=this.handlers;y||(k&&k(this.lastMoveEvent,E),this.startEvent=this.lastMoveEvent),M&&M(this.lastMoveEvent,E)},this.handlePointerMove=(E,y)=>{this.lastMoveEvent=E,this.lastMoveEventInfo=Mj(y,this.transformPagePoint),ur.update(this.updatePoint,!0)},this.handlePointerUp=(E,y)=>{if(this.end(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const{onEnd:w,onSessionEnd:I}=this.handlers,P=Uj(E.type==="pointercancel"?this.lastMoveEventInfo:Mj(y,this.transformPagePoint),this.history);this.startEvent&&w&&w(E,P),I&&I(E,P)},!jee(e))return;this.handlers=n,this.transformPagePoint=r;const c=vP(e),l=Mj(c,this.transformPagePoint),{point:d}=l,{timestamp:f}=Ps;this.history=[{...d,timestamp:f}];const{onSessionStart:m}=n;m&&m(e,Uj(l,this.history)),this.removeListeners=kf(kd(window,"pointermove",this.handlePointerMove),kd(window,"pointerup",this.handlePointerUp),kd(window,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Bd(this.updatePoint)}}function Mj(t,e){return e?{point:e(t.point)}:t}function PG(t,e){return{x:t.x-e.x,y:t.y-e.y}}function Uj({point:t},e){return{point:t,delta:PG(t,bte(e)),offset:PG(t,twe(e)),velocity:nwe(e,.1)}}function twe(t){return t[0]}function bte(t){return t[t.length-1]}function nwe(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const c=bte(t);for(;n>=0&&(r=t[n],!(c.timestamp-r.timestamp>Lf(e)));)n--;if(!r)return{x:0,y:0};const l=Ld(c.timestamp-r.timestamp);if(l===0)return{x:0,y:0};const d={x:(c.x-r.x)/l,y:(c.y-r.y)/l};return d.x===1/0&&(d.x=0),d.y===1/0&&(d.y=0),d}function rc(t){return t.max-t.min}function G3(t,e=0,n=.01){return Math.abs(t-e)<=n}function xG(t,e,n,r=.5){t.origin=r,t.originPoint=Or(e.min,e.max,t.origin),t.scale=rc(n)/rc(e),(G3(t.scale,1,1e-4)||isNaN(t.scale))&&(t.scale=1),t.translate=Or(n.min,n.max,t.origin)-t.originPoint,(G3(t.translate)||isNaN(t.translate))&&(t.translate=0)}function ST(t,e,n,r){xG(t.x,e.x,n.x,r?r.originX:void 0),xG(t.y,e.y,n.y,r?r.originY:void 0)}function DG(t,e,n){t.min=n.min+e.min,t.max=t.min+rc(e)}function iwe(t,e,n){DG(t.x,e.x,n.x),DG(t.y,e.y,n.y)}function kG(t,e,n){t.min=e.min-n.min,t.max=t.min+rc(e)}function TT(t,e,n){kG(t.x,e.x,n.x),kG(t.y,e.y,n.y)}function rwe(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?Or(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?Or(n,t,r.max):Math.min(t,n)),t}function LG(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function swe(t,{top:e,left:n,bottom:r,right:c}){return{x:LG(t.x,n,c),y:LG(t.y,e,r)}}function MG(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function owe(t,e){return{x:MG(t.x,e.x),y:MG(t.y,e.y)}}function awe(t,e){let n=.5;const r=rc(t),c=rc(e);return c>r?n=tb(e.min,e.max-r,t.min):r>c&&(n=tb(t.min,t.max-c,e.min)),$f(0,1,n)}function cwe(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const K3=.35;function lwe(t=K3){return t===!1?t=0:t===!0&&(t=K3),{x:UG(t,"left","right"),y:UG(t,"top","bottom")}}function UG(t,e,n){return{min:jG(t,e),max:jG(t,n)}}function jG(t,e){return typeof t=="number"?t:t[e]||0}const FG=()=>({translate:0,scale:1,origin:0,originPoint:0}),VE=()=>({x:FG(),y:FG()}),VG=()=>({min:0,max:0}),ss=()=>({x:VG(),y:VG()});function fu(t){return[t("x"),t("y")]}function wte({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function uwe({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function dwe(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function jj(t){return t===void 0||t===1}function q3({scale:t,scaleX:e,scaleY:n}){return!jj(t)||!jj(e)||!jj(n)}function wm(t){return q3(t)||Cte(t)||t.z||t.rotate||t.rotateX||t.rotateY}function Cte(t){return BG(t.x)||BG(t.y)}function BG(t){return t&&t!=="0%"}function D1(t,e,n){const r=t-n,c=e*r;return n+c}function WG(t,e,n,r,c){return c!==void 0&&(t=D1(t,c,r)),D1(t,n,r)+e}function Y3(t,e=0,n=1,r,c){t.min=WG(t.min,e,n,r,c),t.max=WG(t.max,e,n,r,c)}function Rte(t,{x:e,y:n}){Y3(t.x,e.translate,e.scale,e.originPoint),Y3(t.y,n.translate,n.scale,n.originPoint)}function hwe(t,e,n,r=!1){const c=n.length;if(!c)return;e.x=e.y=1;let l,d;for(let f=0;f<c;f++){l=n[f],d=l.projectionDelta;const m=l.instance;m&&m.style&&m.style.display==="contents"||(r&&l.options.layoutScroll&&l.scroll&&l!==l.root&&BE(t,{x:-l.scroll.offset.x,y:-l.scroll.offset.y}),d&&(e.x*=d.x.scale,e.y*=d.y.scale,Rte(t,d)),r&&wm(l.latestValues)&&BE(t,l.latestValues))}e.x=HG(e.x),e.y=HG(e.y)}function HG(t){return Number.isInteger(t)||t>1.0000000000001||t<.999999999999?t:1}function af(t,e){t.min=t.min+e,t.max=t.max+e}function $G(t,e,[n,r,c]){const l=e[c]!==void 0?e[c]:.5,d=Or(t.min,t.max,l);Y3(t,e[n],e[r],d,e.scale)}const fwe=["x","scaleX","originX"],pwe=["y","scaleY","originY"];function BE(t,e){$G(t.x,e,fwe),$G(t.y,e,pwe)}function Ite(t,e){return wte(dwe(t.getBoundingClientRect(),e))}function mwe(t,e,n){const r=Ite(t,n),{scroll:c}=e;return c&&(af(r.x,c.offset.x),af(r.y,c.offset.y)),r}const gwe=new WeakMap;class _we{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ss(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const c=m=>{this.stopAnimation(),n&&this.snapToCursor(vP(m,"page").point)},l=(m,E)=>{const{drag:y,dragPropagation:w,onDragStart:I}=this.getProps();if(y&&!w&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=Vee(y),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),fu(k=>{let M=this.getAxisMotionValue(k).get()||0;if(vu.test(M)){const{projection:K}=this.visualElement;if(K&&K.layout){const W=K.layout.layoutBox[k];W&&(M=rc(W)*(parseFloat(M)/100))}}this.originPoint[k]=M}),I&&ur.update(()=>I(m,E),!1,!0);const{animationState:P}=this.visualElement;P&&P.setActive("whileDrag",!0)},d=(m,E)=>{const{dragPropagation:y,dragDirectionLock:w,onDirectionLock:I,onDrag:P}=this.getProps();if(!y&&!this.openGlobalLock)return;const{offset:k}=E;if(w&&this.currentDirection===null){this.currentDirection=Ewe(k),this.currentDirection!==null&&I&&I(this.currentDirection);return}this.updateAxis("x",E.point,k),this.updateAxis("y",E.point,k),this.visualElement.render(),P&&P(m,E)},f=(m,E)=>this.stop(m,E);this.panSession=new Tte(e,{onSessionStart:c,onStart:l,onMove:d,onSessionEnd:f},{transformPagePoint:this.visualElement.getTransformPagePoint()})}stop(e,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:c}=n;this.startAnimation(c);const{onDragEnd:l}=this.getProps();l&&ur.update(()=>l(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,r){const{drag:c}=this.getProps();if(!r||!BA(e,c,this.currentDirection))return;const l=this.getAxisMotionValue(e);let d=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(d=rwe(d,this.constraints[e],this.elastic[e])),l.set(d)}resolveConstraints(){const{dragConstraints:e,dragElastic:n}=this.getProps(),{layout:r}=this.visualElement.projection||{},c=this.constraints;e&&jE(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=swe(r.layoutBox,e):this.constraints=!1,this.elastic=lwe(n),c!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&fu(l=>{this.getAxisMotionValue(l)&&(this.constraints[l]=cwe(r.layoutBox[l],this.constraints[l]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!jE(e))return!1;const r=e.current,{projection:c}=this.visualElement;if(!c||!c.layout)return!1;const l=mwe(r,c.root,this.visualElement.getTransformPagePoint());let d=owe(c.layout.layoutBox,l);if(n){const f=n(uwe(d));this.hasMutatedConstraints=!!f,f&&(d=wte(f))}return d}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:c,dragTransition:l,dragSnapToOrigin:d,onDragTransitionEnd:f}=this.getProps(),m=this.constraints||{},E=fu(y=>{if(!BA(y,n,this.currentDirection))return;let w=m&&m[y]||{};d&&(w={min:0,max:0});const I=c?200:1e6,P=c?40:1e7,k={type:"inertia",velocity:r?e[y]:0,bounceStiffness:I,bounceDamping:P,timeConstant:750,restDelta:1,restSpeed:10,...l,...w};return this.startAxisValueAnimation(y,k)});return Promise.all(E).then(f)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return r.start(Q4(e,r,0,n))}stopAnimation(){fu(e=>this.getAxisMotionValue(e).stop())}getAxisMotionValue(e){const n="_drag"+e.toUpperCase(),r=this.visualElement.getProps(),c=r[n];return c||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){fu(n=>{const{drag:r}=this.getProps();if(!BA(n,r,this.currentDirection))return;const{projection:c}=this.visualElement,l=this.getAxisMotionValue(n);if(c&&c.layout){const{min:d,max:f}=c.layout.layoutBox[n];l.set(e[n]-Or(d,f,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!jE(n)||!r||!this.constraints)return;this.stopAnimation();const c={x:0,y:0};fu(d=>{const f=this.getAxisMotionValue(d);if(f){const m=f.get();c[d]=awe({min:m,max:m},this.constraints[d])}});const{transformTemplate:l}=this.visualElement.getProps();this.visualElement.current.style.transform=l?l({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),fu(d=>{if(!BA(d,e,null))return;const f=this.getAxisMotionValue(d),{min:m,max:E}=this.constraints[d];f.set(Or(m,E,c[d]))})}addListeners(){if(!this.visualElement.current)return;gwe.set(this.visualElement,this);const e=this.visualElement.current,n=kd(e,"pointerdown",m=>{const{drag:E,dragListener:y=!0}=this.getProps();E&&y&&this.start(m)}),r=()=>{const{dragConstraints:m}=this.getProps();jE(m)&&(this.constraints=this.resolveRefConstraints())},{projection:c}=this.visualElement,l=c.addEventListener("measure",r);c&&!c.layout&&(c.root&&c.root.updateScroll(),c.updateLayout()),r();const d=Ad(window,"resize",()=>this.scalePositionWithinConstraints()),f=c.addEventListener("didUpdate",({delta:m,hasLayoutChanged:E})=>{this.isDragging&&E&&(fu(y=>{const w=this.getAxisMotionValue(y);w&&(this.originPoint[y]+=m[y].translate,w.set(w.get()+m[y].translate))}),this.visualElement.render())});return()=>{d(),n(),l(),f&&f()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:c=!1,dragConstraints:l=!1,dragElastic:d=K3,dragMomentum:f=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:c,dragConstraints:l,dragElastic:d,dragMomentum:f}}}function BA(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function Ewe(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class vwe extends Zf{constructor(e){super(e),this.removeGroupControls=kr,this.removeListeners=kr,this.controls=new _we(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||kr}unmount(){this.removeGroupControls(),this.removeListeners()}}const zG=t=>(e,n)=>{t&&ur.update(()=>t(e,n))};class ywe extends Zf{constructor(){super(...arguments),this.removePointerDownListener=kr}onPointerDown(e){this.session=new Tte(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint()})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:c}=this.node.getProps();return{onSessionStart:zG(e),onStart:zG(n),onMove:r,onEnd:(l,d)=>{delete this.session,c&&ur.update(()=>c(l,d))}}}mount(){this.removePointerDownListener=kd(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function Swe(){const t=$.useContext(M4);if(t===null)return[!0,null];const{isPresent:e,onExitComplete:n,register:r}=t,c=$.useId();return $.useEffect(()=>r(c),[]),!e&&n?[!1,()=>n&&n(c)]:[!0]}const LO={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function GG(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const MS={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Jt.test(t))t=parseFloat(t);else return t;const n=GG(t,e.target.x),r=GG(t,e.target.y);return`${n}% ${r}%`}},Twe={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,c=zf.parse(t);if(c.length>5)return r;const l=zf.createTransformer(t),d=typeof c[0]!="number"?1:0,f=n.x.scale*e.x,m=n.y.scale*e.y;c[0+d]/=f,c[1+d]/=m;const E=Or(f,m,.5);return typeof c[2+d]=="number"&&(c[2+d]/=E),typeof c[3+d]=="number"&&(c[3+d]/=E),l(c)}};class bwe extends At.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:c}=this.props,{projection:l}=e;OSe(wwe),l&&(n.group&&n.group.add(l),r&&r.register&&c&&r.register(l),l.root.didUpdate(),l.addEventListener("animationComplete",()=>{this.safeToRemove()}),l.setOptions({...l.options,onExitComplete:()=>this.safeToRemove()})),LO.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:c,isPresent:l}=this.props,d=r.projection;return d&&(d.isPresent=l,c||e.layoutDependency!==n||n===void 0?d.willUpdate():this.safeToRemove(),e.isPresent!==l&&(l?d.promote():d.relegate()||ur.postRender(()=>{const f=d.getStack();(!f||!f.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),queueMicrotask(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:c}=e;c&&(c.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(c),r&&r.deregister&&r.deregister(c))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function Ate(t){const[e,n]=Swe(),r=$.useContext(bee);return At.createElement(bwe,{...t,layoutGroup:r,switchLayoutGroup:$.useContext(wee),isPresent:e,safeToRemove:n})}const wwe={borderRadius:{...MS,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:MS,borderTopRightRadius:MS,borderBottomLeftRadius:MS,borderBottomRightRadius:MS,boxShadow:Twe},Ote=["TopLeft","TopRight","BottomLeft","BottomRight"],Cwe=Ote.length,KG=t=>typeof t=="string"?parseFloat(t):t,qG=t=>typeof t=="number"||Jt.test(t);function Rwe(t,e,n,r,c,l){c?(t.opacity=Or(0,n.opacity!==void 0?n.opacity:1,Iwe(r)),t.opacityExit=Or(e.opacity!==void 0?e.opacity:1,0,Awe(r))):l&&(t.opacity=Or(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,r));for(let d=0;d<Cwe;d++){const f=`border${Ote[d]}Radius`;let m=YG(e,f),E=YG(n,f);if(m===void 0&&E===void 0)continue;m||(m=0),E||(E=0),m===0||E===0||qG(m)===qG(E)?(t[f]=Math.max(Or(KG(m),KG(E),r),0),(vu.test(E)||vu.test(m))&&(t[f]+="%")):t[f]=E}(e.rotate||n.rotate)&&(t.rotate=Or(e.rotate||0,n.rotate||0,r))}function YG(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const Iwe=Nte(0,.5,q4),Awe=Nte(.5,.95,kr);function Nte(t,e,n){return r=>r<t?0:r>e?1:n(tb(t,e,r))}function XG(t,e){t.min=e.min,t.max=e.max}function Cc(t,e){XG(t.x,e.x),XG(t.y,e.y)}function JG(t,e,n,r,c){return t-=e,t=D1(t,1/n,r),c!==void 0&&(t=D1(t,1/c,r)),t}function Owe(t,e=0,n=1,r=.5,c,l=t,d=t){if(vu.test(e)&&(e=parseFloat(e),e=Or(d.min,d.max,e/100)-d.min),typeof e!="number")return;let f=Or(l.min,l.max,r);t===l&&(f-=e),t.min=JG(t.min,e,n,f,c),t.max=JG(t.max,e,n,f,c)}function QG(t,e,[n,r,c],l,d){Owe(t,e[n],e[r],e[c],e.scale,l,d)}const Nwe=["x","scaleX","originX"],Pwe=["y","scaleY","originY"];function ZG(t,e,n,r){QG(t.x,e,Nwe,n?n.x:void 0,r?r.x:void 0),QG(t.y,e,Pwe,n?n.y:void 0,r?r.y:void 0)}function eK(t){return t.translate===0&&t.scale===1}function Pte(t){return eK(t.x)&&eK(t.y)}function xwe(t,e){return t.x.min===e.x.min&&t.x.max===e.x.max&&t.y.min===e.y.min&&t.y.max===e.y.max}function xte(t,e){return Math.round(t.x.min)===Math.round(e.x.min)&&Math.round(t.x.max)===Math.round(e.x.max)&&Math.round(t.y.min)===Math.round(e.y.min)&&Math.round(t.y.max)===Math.round(e.y.max)}function tK(t){return rc(t.x)/rc(t.y)}class Dwe{constructor(){this.members=[]}add(e){Z4(this.members,e),e.scheduleRender()}remove(e){if(e5(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(c=>e===c);if(n===0)return!1;let r;for(let c=n;c>=0;c--){const l=this.members[c];if(l.isPresent!==!1){r=l;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:c}=e.options;c===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function nK(t,e,n){let r="";const c=t.x.translate/e.x,l=t.y.translate/e.y;if((c||l)&&(r=`translate3d(${c}px, ${l}px, 0) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{rotate:m,rotateX:E,rotateY:y}=n;m&&(r+=`rotate(${m}deg) `),E&&(r+=`rotateX(${E}deg) `),y&&(r+=`rotateY(${y}deg) `)}const d=t.x.scale*e.x,f=t.y.scale*e.y;return(d!==1||f!==1)&&(r+=`scale(${d}, ${f})`),r||"none"}const kwe=(t,e)=>t.depth-e.depth;class Lwe{constructor(){this.children=[],this.isDirty=!1}add(e){Z4(this.children,e),this.isDirty=!0}remove(e){e5(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(kwe),this.isDirty=!1,this.children.forEach(e)}}function Mwe(t,e){const n=performance.now(),r=({timestamp:c})=>{const l=c-n;l>=e&&(Bd(r),t(l-e))};return ur.read(r,!0),()=>Bd(r)}function Uwe(t){window.MotionDebug&&window.MotionDebug.record(t)}function jwe(t){return t instanceof SVGElement&&t.tagName!=="svg"}function Fwe(t,e,n){const r=Ra(t)?t:Sv(t);return r.start(Q4("",r,e,n)),r.animation}const iK=["","X","Y","Z"],rK=1e3;let Vwe=0;const Cm={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function Dte({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:c}){return class{constructor(d={},f=e==null?void 0:e()){this.id=Vwe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{Cm.totalNodes=Cm.resolvedTargetDeltas=Cm.recalculatedProjection=0,this.nodes.forEach(Hwe),this.nodes.forEach(qwe),this.nodes.forEach(Ywe),this.nodes.forEach($we),Uwe(Cm)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=d,this.root=f?f.root||f:this,this.path=f?[...f.path,f]:[],this.parent=f,this.depth=f?f.depth+1:0;for(let m=0;m<this.path.length;m++)this.path[m].shouldResetTransform=!0;this.root===this&&(this.nodes=new Lwe)}addEventListener(d,f){return this.eventHandlers.has(d)||this.eventHandlers.set(d,new t5),this.eventHandlers.get(d).add(f)}notifyListeners(d,...f){const m=this.eventHandlers.get(d);m&&m.notify(...f)}hasListeners(d){return this.eventHandlers.has(d)}mount(d,f=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=jwe(d),this.instance=d;const{layoutId:m,layout:E,visualElement:y}=this.options;if(y&&!y.current&&y.mount(d),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),f&&(E||m)&&(this.isLayoutDirty=!0),t){let w;const I=()=>this.root.updateBlockedByResize=!1;t(d,()=>{this.root.updateBlockedByResize=!0,w&&w(),w=Mwe(I,250),LO.hasAnimatedSinceResize&&(LO.hasAnimatedSinceResize=!1,this.nodes.forEach(oK))})}m&&this.root.registerSharedNode(m,this),this.options.animate!==!1&&y&&(m||E)&&this.addEventListener("didUpdate",({delta:w,hasLayoutChanged:I,hasRelativeTargetChanged:P,layout:k})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const M=this.options.transition||y.getDefaultTransition()||eCe,{onLayoutAnimationStart:K,onLayoutAnimationComplete:W}=y.getProps(),V=!this.targetLayout||!xte(this.targetLayout,k)||P,G=!I&&P;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||G||I&&(V||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(w,G);const Q={..._te(M,"layout"),onPlay:K,onComplete:W};(y.shouldReduceMotion||this.options.layoutRoot)&&(Q.delay=0,Q.type=!1),this.startAnimation(Q)}else I||oK(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=k})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const d=this.getStack();d&&d.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Bd(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Xwe),this.animationId++)}getTransformTemplate(){const{visualElement:d}=this.options;return d&&d.getProps().transformTemplate}willUpdate(d=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let y=0;y<this.path.length;y++){const w=this.path[y];w.shouldResetTransform=!0,w.updateScroll("snapshot"),w.options.layoutRoot&&w.willUpdate(!1)}const{layoutId:f,layout:m}=this.options;if(f===void 0&&!m)return;const E=this.getTransformTemplate();this.prevTransformTemplateValue=E?E(this.latestValues,""):void 0,this.updateSnapshot(),d&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(sK);return}this.isUpdating||this.nodes.forEach(Gwe),this.isUpdating=!1,this.nodes.forEach(Kwe),this.nodes.forEach(Bwe),this.nodes.forEach(Wwe),this.clearAllSnapshots();const f=performance.now();Ps.delta=$f(0,1e3/60,f-Ps.timestamp),Ps.timestamp=f,Ps.isProcessing=!0,Aj.update.process(Ps),Aj.preRender.process(Ps),Aj.render.process(Ps),Ps.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(zwe),this.sharedNodes.forEach(Jwe)}scheduleUpdateProjection(){ur.preRender(this.updateProjection,!1,!0)}scheduleCheckAfterUnmount(){ur.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let m=0;m<this.path.length;m++)this.path[m].updateScroll();const d=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ss(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:f}=this.options;f&&f.notify("LayoutMeasure",this.layout.layoutBox,d?d.layoutBox:void 0)}updateScroll(d="measure"){let f=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===d&&(f=!1),f&&(this.scroll={animationId:this.root.animationId,phase:d,isRoot:r(this.instance),offset:n(this.instance)})}resetTransform(){if(!c)return;const d=this.isLayoutDirty||this.shouldResetTransform,f=this.projectionDelta&&!Pte(this.projectionDelta),m=this.getTransformTemplate(),E=m?m(this.latestValues,""):void 0,y=E!==this.prevTransformTemplateValue;d&&(f||wm(this.latestValues)||y)&&(c(this.instance,E),this.shouldResetTransform=!1,this.scheduleRender())}measure(d=!0){const f=this.measurePageBox();let m=this.removeElementScroll(f);return d&&(m=this.removeTransform(m)),tCe(m),{animationId:this.root.animationId,measuredBox:f,layoutBox:m,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:d}=this.options;if(!d)return ss();const f=d.measureViewportBox(),{scroll:m}=this.root;return m&&(af(f.x,m.offset.x),af(f.y,m.offset.y)),f}removeElementScroll(d){const f=ss();Cc(f,d);for(let m=0;m<this.path.length;m++){const E=this.path[m],{scroll:y,options:w}=E;if(E!==this.root&&y&&w.layoutScroll){if(y.isRoot){Cc(f,d);const{scroll:I}=this.root;I&&(af(f.x,-I.offset.x),af(f.y,-I.offset.y))}af(f.x,y.offset.x),af(f.y,y.offset.y)}}return f}applyTransform(d,f=!1){const m=ss();Cc(m,d);for(let E=0;E<this.path.length;E++){const y=this.path[E];!f&&y.options.layoutScroll&&y.scroll&&y!==y.root&&BE(m,{x:-y.scroll.offset.x,y:-y.scroll.offset.y}),wm(y.latestValues)&&BE(m,y.latestValues)}return wm(this.latestValues)&&BE(m,this.latestValues),m}removeTransform(d){const f=ss();Cc(f,d);for(let m=0;m<this.path.length;m++){const E=this.path[m];if(!E.instance||!wm(E.latestValues))continue;q3(E.latestValues)&&E.updateSnapshot();const y=ss(),w=E.measurePageBox();Cc(y,w),ZG(f,E.latestValues,E.snapshot?E.snapshot.layoutBox:void 0,y)}return wm(this.latestValues)&&ZG(f,this.latestValues),f}setTargetDelta(d){this.targetDelta=d,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(d){this.options={...this.options,...d,crossfade:d.crossfade!==void 0?d.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Ps.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(d=!1){var f;const m=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=m.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=m.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=m.isSharedProjectionDirty);const E=!!this.resumingFrom||this!==m;if(!(d||E&&this.isSharedProjectionDirty||this.isProjectionDirty||!((f=this.parent)===null||f===void 0)&&f.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:w,layoutId:I}=this.options;if(!(!this.layout||!(w||I))){if(this.resolvedRelativeTargetAt=Ps.timestamp,!this.targetDelta&&!this.relativeTarget){const P=this.getClosestProjectingParent();P&&P.layout&&this.animationProgress!==1?(this.relativeParent=P,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ss(),this.relativeTargetOrigin=ss(),TT(this.relativeTargetOrigin,this.layout.layoutBox,P.layout.layoutBox),Cc(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=ss(),this.targetWithTransforms=ss()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),iwe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Cc(this.target,this.layout.layoutBox),Rte(this.target,this.targetDelta)):Cc(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const P=this.getClosestProjectingParent();P&&!!P.resumingFrom==!!this.resumingFrom&&!P.options.layoutScroll&&P.target&&this.animationProgress!==1?(this.relativeParent=P,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ss(),this.relativeTargetOrigin=ss(),TT(this.relativeTargetOrigin,this.target,P.target),Cc(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Cm.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||q3(this.parent.latestValues)||Cte(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var d;const f=this.getLead(),m=!!this.resumingFrom||this!==f;let E=!0;if((this.isProjectionDirty||!((d=this.parent)===null||d===void 0)&&d.isProjectionDirty)&&(E=!1),m&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(E=!1),this.resolvedRelativeTargetAt===Ps.timestamp&&(E=!1),E)return;const{layout:y,layoutId:w}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(y||w))return;Cc(this.layoutCorrected,this.layout.layoutBox);const I=this.treeScale.x,P=this.treeScale.y;hwe(this.layoutCorrected,this.treeScale,this.path,m),f.layout&&!f.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(f.target=f.layout.layoutBox);const{target:k}=f;if(!k){this.projectionTransform&&(this.projectionDelta=VE(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=VE(),this.projectionDeltaWithTransform=VE());const M=this.projectionTransform;ST(this.projectionDelta,this.layoutCorrected,k,this.latestValues),this.projectionTransform=nK(this.projectionDelta,this.treeScale),(this.projectionTransform!==M||this.treeScale.x!==I||this.treeScale.y!==P)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",k)),Cm.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(d=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),d){const f=this.getStack();f&&f.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(d,f=!1){const m=this.snapshot,E=m?m.latestValues:{},y={...this.latestValues},w=VE();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!f;const I=ss(),P=m?m.source:void 0,k=this.layout?this.layout.source:void 0,M=P!==k,K=this.getStack(),W=!K||K.members.length<=1,V=!!(M&&!W&&this.options.crossfade===!0&&!this.path.some(Zwe));this.animationProgress=0;let G;this.mixTargetDelta=Q=>{const Z=Q/1e3;aK(w.x,d.x,Z),aK(w.y,d.y,Z),this.setTargetDelta(w),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(TT(I,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Qwe(this.relativeTarget,this.relativeTargetOrigin,I,Z),G&&xwe(this.relativeTarget,G)&&(this.isProjectionDirty=!1),G||(G=ss()),Cc(G,this.relativeTarget)),M&&(this.animationValues=y,Rwe(y,E,this.latestValues,Z,V,W)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=Z},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(d){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Bd(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ur.update(()=>{LO.hasAnimatedSinceResize=!0,this.currentAnimation=Fwe(0,rK,{...d,onUpdate:f=>{this.mixTargetDelta(f),d.onUpdate&&d.onUpdate(f)},onComplete:()=>{d.onComplete&&d.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const d=this.getStack();d&&d.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(rK),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const d=this.getLead();let{targetWithTransforms:f,target:m,layout:E,latestValues:y}=d;if(!(!f||!m||!E)){if(this!==d&&this.layout&&E&&kte(this.options.animationType,this.layout.layoutBox,E.layoutBox)){m=this.target||ss();const w=rc(this.layout.layoutBox.x);m.x.min=d.target.x.min,m.x.max=m.x.min+w;const I=rc(this.layout.layoutBox.y);m.y.min=d.target.y.min,m.y.max=m.y.min+I}Cc(f,m),BE(f,y),ST(this.projectionDeltaWithTransform,this.layoutCorrected,f,y)}}registerSharedNode(d,f){this.sharedNodes.has(d)||this.sharedNodes.set(d,new Dwe),this.sharedNodes.get(d).add(f);const E=f.options.initialPromotionConfig;f.promote({transition:E?E.transition:void 0,preserveFollowOpacity:E&&E.shouldPreserveFollowOpacity?E.shouldPreserveFollowOpacity(f):void 0})}isLead(){const d=this.getStack();return d?d.lead===this:!0}getLead(){var d;const{layoutId:f}=this.options;return f?((d=this.getStack())===null||d===void 0?void 0:d.lead)||this:this}getPrevLead(){var d;const{layoutId:f}=this.options;return f?(d=this.getStack())===null||d===void 0?void 0:d.prevLead:void 0}getStack(){const{layoutId:d}=this.options;if(d)return this.root.sharedNodes.get(d)}promote({needsReset:d,transition:f,preserveFollowOpacity:m}={}){const E=this.getStack();E&&E.promote(this,m),d&&(this.projectionDelta=void 0,this.needsReset=!0),f&&this.setOptions({transition:f})}relegate(){const d=this.getStack();return d?d.relegate(this):!1}resetRotation(){const{visualElement:d}=this.options;if(!d)return;let f=!1;const{latestValues:m}=d;if((m.rotate||m.rotateX||m.rotateY||m.rotateZ)&&(f=!0),!f)return;const E={};for(let y=0;y<iK.length;y++){const w="rotate"+iK[y];m[w]&&(E[w]=m[w],d.setStaticValue(w,0))}d.render();for(const y in E)d.setStaticValue(y,E[y]);d.scheduleRender()}getProjectionStyles(d={}){var f,m;const E={};if(!this.instance||this.isSVG)return E;if(this.isVisible)E.visibility="";else return{visibility:"hidden"};const y=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,E.opacity="",E.pointerEvents=kO(d.pointerEvents)||"",E.transform=y?y(this.latestValues,""):"none",E;const w=this.getLead();if(!this.projectionDelta||!this.layout||!w.target){const M={};return this.options.layoutId&&(M.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,M.pointerEvents=kO(d.pointerEvents)||""),this.hasProjected&&!wm(this.latestValues)&&(M.transform=y?y({},""):"none",this.hasProjected=!1),M}const I=w.animationValues||w.latestValues;this.applyTransformsToTarget(),E.transform=nK(this.projectionDeltaWithTransform,this.treeScale,I),y&&(E.transform=y(I,E.transform));const{x:P,y:k}=this.projectionDelta;E.transformOrigin=`${P.origin*100}% ${k.origin*100}% 0`,w.animationValues?E.opacity=w===this?(m=(f=I.opacity)!==null&&f!==void 0?f:this.latestValues.opacity)!==null&&m!==void 0?m:1:this.preserveOpacity?this.latestValues.opacity:I.opacityExit:E.opacity=w===this?I.opacity!==void 0?I.opacity:"":I.opacityExit!==void 0?I.opacityExit:0;for(const M in R1){if(I[M]===void 0)continue;const{correct:K,applyTo:W}=R1[M],V=E.transform==="none"?I[M]:K(I[M],w);if(W){const G=W.length;for(let Q=0;Q<G;Q++)E[W[Q]]=V}else E[M]=V}return this.options.layoutId&&(E.pointerEvents=w===this?kO(d.pointerEvents)||"":"none"),E}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(d=>{var f;return(f=d.currentAnimation)===null||f===void 0?void 0:f.stop()}),this.root.nodes.forEach(sK),this.root.sharedNodes.clear()}}}function Bwe(t){t.updateLayout()}function Wwe(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:c}=t.layout,{animationType:l}=t.options,d=n.source!==t.layout.source;l==="size"?fu(w=>{const I=d?n.measuredBox[w]:n.layoutBox[w],P=rc(I);I.min=r[w].min,I.max=I.min+P}):kte(l,n.layoutBox,r)&&fu(w=>{const I=d?n.measuredBox[w]:n.layoutBox[w],P=rc(r[w]);I.max=I.min+P,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[w].max=t.relativeTarget[w].min+P)});const f=VE();ST(f,r,n.layoutBox);const m=VE();d?ST(m,t.applyTransform(c,!0),n.measuredBox):ST(m,r,n.layoutBox);const E=!Pte(f);let y=!1;if(!t.resumeFrom){const w=t.getClosestProjectingParent();if(w&&!w.resumeFrom){const{snapshot:I,layout:P}=w;if(I&&P){const k=ss();TT(k,n.layoutBox,I.layoutBox);const M=ss();TT(M,r,P.layoutBox),xte(k,M)||(y=!0),w.options.layoutRoot&&(t.relativeTarget=M,t.relativeTargetOrigin=k,t.relativeParent=w)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:n,delta:m,layoutDelta:f,hasLayoutChanged:E,hasRelativeTargetChanged:y})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function Hwe(t){Cm.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function $we(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function zwe(t){t.clearSnapshot()}function sK(t){t.clearMeasurements()}function Gwe(t){t.isLayoutDirty=!1}function Kwe(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function oK(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function qwe(t){t.resolveTargetDelta()}function Ywe(t){t.calcProjection()}function Xwe(t){t.resetRotation()}function Jwe(t){t.removeLeadSnapshot()}function aK(t,e,n){t.translate=Or(e.translate,0,n),t.scale=Or(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function cK(t,e,n,r){t.min=Or(e.min,n.min,r),t.max=Or(e.max,n.max,r)}function Qwe(t,e,n,r){cK(t.x,e.x,n.x,r),cK(t.y,e.y,n.y,r)}function Zwe(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const eCe={duration:.45,ease:[.4,0,.1,1]},lK=t=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(t),uK=lK("applewebkit/")&&!lK("chrome/")?Math.round:kr;function dK(t){t.min=uK(t.min),t.max=uK(t.max)}function tCe(t){dK(t.x),dK(t.y)}function kte(t,e,n){return t==="position"||t==="preserve-aspect"&&!G3(tK(e),tK(n),.2)}const nCe=Dte({attachResizeListener:(t,e)=>Ad(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Fj={current:void 0},Lte=Dte({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!Fj.current){const t=new nCe({});t.mount(window),t.setOptions({layoutScroll:!0}),Fj.current=t}return Fj.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),iCe={pan:{Feature:ywe},drag:{Feature:vwe,ProjectionNode:Lte,MeasureLayout:Ate}},rCe=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function sCe(t){const e=rCe.exec(t);if(!e)return[,];const[,n,r]=e;return[n,r]}function X3(t,e,n=1){const[r,c]=sCe(t);if(!r)return;const l=window.getComputedStyle(e).getPropertyValue(r);if(l){const d=l.trim();return Ete(d)?parseFloat(d):d}else return F3(c)?X3(c,e,n+1):c}function oCe(t,{...e},n){const r=t.current;if(!(r instanceof Element))return{target:e,transitionEnd:n};n&&(n={...n}),t.values.forEach(c=>{const l=c.get();if(!F3(l))return;const d=X3(l,r);d&&c.set(d)});for(const c in e){const l=e[c];if(!F3(l))continue;const d=X3(l,r);d&&(e[c]=d,n||(n={}),n[c]===void 0&&(n[c]=l))}return{target:e,transitionEnd:n}}const aCe=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),Mte=t=>aCe.has(t),cCe=t=>Object.keys(t).some(Mte),hK=t=>t===Eg||t===Jt,fK=(t,e)=>parseFloat(t.split(", ")[e]),pK=(t,e)=>(n,{transform:r})=>{if(r==="none"||!r)return 0;const c=r.match(/^matrix3d\((.+)\)$/);if(c)return fK(c[1],e);{const l=r.match(/^matrix\((.+)\)$/);return l?fK(l[1],t):0}},lCe=new Set(["x","y","z"]),uCe=Ab.filter(t=>!lCe.has(t));function dCe(t){const e=[];return uCe.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e.length&&t.render(),e}const Tv={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:pK(4,13),y:pK(5,14)};Tv.translateX=Tv.x;Tv.translateY=Tv.y;const hCe=(t,e,n)=>{const r=e.measureViewportBox(),c=e.current,l=getComputedStyle(c),{display:d}=l,f={};d==="none"&&e.setStaticValue("display",t.display||"block"),n.forEach(E=>{f[E]=Tv[E](r,l)}),e.render();const m=e.measureViewportBox();return n.forEach(E=>{const y=e.getValue(E);y&&y.jump(f[E]),t[E]=Tv[E](m,l)}),t},fCe=(t,e,n={},r={})=>{e={...e},r={...r};const c=Object.keys(e).filter(Mte);let l=[],d=!1;const f=[];if(c.forEach(m=>{const E=t.getValue(m);if(!t.hasValue(m))return;let y=n[m],w=LS(y);const I=e[m];let P;if(A1(I)){const k=I.length,M=I[0]===null?1:0;y=I[M],w=LS(y);for(let K=M;K<k&&I[K]!==null;K++)P?K4(LS(I[K])===P):P=LS(I[K])}else P=LS(I);if(w!==P)if(hK(w)&&hK(P)){const k=E.get();typeof k=="string"&&E.set(parseFloat(k)),typeof I=="string"?e[m]=parseFloat(I):Array.isArray(I)&&P===Jt&&(e[m]=I.map(parseFloat))}else w!=null&&w.transform&&(P!=null&&P.transform)&&(y===0||I===0)?y===0?E.set(P.transform(y)):e[m]=w.transform(I):(d||(l=dCe(t),d=!0),f.push(m),r[m]=r[m]!==void 0?r[m]:e[m],E.jump(I))}),f.length){const m=f.indexOf("height")>=0?window.pageYOffset:null,E=hCe(e,t,f);return l.length&&l.forEach(([y,w])=>{t.getValue(y).set(w)}),t.render(),mP&&m!==null&&window.scrollTo({top:m}),{target:E,transitionEnd:r}}else return{target:e,transitionEnd:r}};function pCe(t,e,n,r){return cCe(e)?fCe(t,e,n,r):{target:e,transitionEnd:r}}const mCe=(t,e,n,r)=>{const c=oCe(t,e,r);return e=c.target,r=c.transitionEnd,pCe(t,e,n,r)},J3={current:null},Ute={current:!1};function gCe(){if(Ute.current=!0,!!mP)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>J3.current=t.matches;t.addListener(e),e()}else J3.current=!1}function _Ce(t,e,n){const{willChange:r}=e;for(const c in e){const l=e[c],d=n[c];if(Ra(l))t.addValue(c,l),x1(r)&&r.add(c);else if(Ra(d))t.addValue(c,Sv(l,{owner:t})),x1(r)&&r.remove(c);else if(d!==l)if(t.hasValue(c)){const f=t.getValue(c);!f.hasAnimated&&f.set(l)}else{const f=t.getStaticValue(c);t.addValue(c,Sv(f!==void 0?f:l,{owner:t}))}}for(const c in n)e[c]===void 0&&t.removeValue(c);return e}const mK=new WeakMap,jte=Object.keys(eb),ECe=jte.length,gK=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],vCe=j4.length;class yCe{constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:c,visualState:l},d={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>ur.render(this.render,!1,!0);const{latestValues:f,renderState:m}=l;this.latestValues=f,this.baseTarget={...f},this.initialValues=n.initial?{...f}:{},this.renderState=m,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=c,this.options=d,this.isControllingVariants=_P(n),this.isVariantNode=Tee(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:E,...y}=this.scrapeMotionValuesFromProps(n,{});for(const w in y){const I=y[w];f[w]!==void 0&&Ra(I)&&(I.set(f[w],!1),x1(E)&&E.add(w))}}scrapeMotionValuesFromProps(e,n){return{}}mount(e){this.current=e,mK.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),Ute.current||gCe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:J3.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){mK.delete(this.current),this.projection&&this.projection.unmount(),Bd(this.notifyUpdate),Bd(this.render),this.valueSubscriptions.forEach(e=>e()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features)this.features[e].unmount();this.current=null}bindToMotionValue(e,n){const r=_g.has(e),c=n.on("change",d=>{this.latestValues[e]=d,this.props.onUpdate&&ur.update(this.notifyUpdate,!1,!0),r&&this.projection&&(this.projection.isTransformDirty=!0)}),l=n.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{c(),l()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}loadFeatures({children:e,...n},r,c,l){let d,f;for(let m=0;m<ECe;m++){const E=jte[m],{isEnabled:y,Feature:w,ProjectionNode:I,MeasureLayout:P}=eb[E];I&&(d=I),y(n)&&(!this.features[E]&&w&&(this.features[E]=new w(this)),P&&(f=P))}if(!this.projection&&d){this.projection=new d(this.latestValues,this.parent&&this.parent.projection);const{layoutId:m,layout:E,drag:y,dragConstraints:w,layoutScroll:I,layoutRoot:P}=n;this.projection.setOptions({layoutId:m,layout:E,alwaysMeasureLayout:!!y||w&&jE(w),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof E=="string"?E:"both",initialPromotionConfig:l,layoutScroll:I,layoutRoot:P})}return f}updateFeatures(){for(const e in this.features){const n=this.features[e];n.isMounted?n.update():(n.mount(),n.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ss()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}makeTargetAnimatable(e,n=!0){return this.makeTargetAnimatableFromInstance(e,this.props,n)}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<gK.length;r++){const c=gK[r];this.propEventSubscriptions[c]&&(this.propEventSubscriptions[c](),delete this.propEventSubscriptions[c]);const l=e["on"+c];l&&(this.propEventSubscriptions[c]=this.on(c,l))}this.prevMotionValues=_Ce(this,this.scrapeMotionValuesFromProps(e,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(e=!1){if(e)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const r=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(r.initial=this.props.initial),r}const n={};for(let r=0;r<vCe;r++){const c=j4[r],l=this.props[c];(ZT(l)||l===!1)&&(n[c]=l)}return n}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){n!==this.values.get(e)&&(this.removeValue(e),this.bindToMotionValue(e,n)),this.values.set(e,n),this.latestValues[e]=n.get()}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=Sv(n,{owner:this}),this.addValue(e,r)),r}readValue(e){var n;return this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(n=this.getBaseTargetFromProps(this.props,e))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,e,this.options)}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:r}=this.props,c=typeof r=="string"||typeof r=="object"?(n=G4(this.props,r))===null||n===void 0?void 0:n[e]:void 0;if(r&&c!==void 0)return c;const l=this.getBaseTargetFromProps(this.props,e);return l!==void 0&&!Ra(l)?l:this.initialValues[e]!==void 0&&c===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new t5),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class Fte extends yCe{sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}makeTargetAnimatableFromInstance({transition:e,transitionEnd:n,...r},{transformValues:c},l){let d=Fbe(r,e||{},this);if(c&&(n&&(n=c(n)),r&&(r=c(r)),d&&(d=c(d))),l){Ube(this,r,d);const f=mCe(this,r,d,n);n=f.transitionEnd,r=f.target}return{transition:e,transitionEnd:n,...r}}}function SCe(t){return window.getComputedStyle(t)}class TCe extends Fte{readValueFromInstance(e,n){if(_g.has(n)){const r=J4(n);return r&&r.default||0}else{const r=SCe(e),c=(Iee(n)?r.getPropertyValue(n):r[n])||0;return typeof c=="string"?c.trim():c}}measureInstanceViewportBox(e,{transformPagePoint:n}){return Ite(e,n)}build(e,n,r,c){V4(e,n,r,c.transformTemplate)}scrapeMotionValuesFromProps(e,n){return z4(e,n)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Ra(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}renderInstance(e,n,r,c){Dee(e,n,r,c)}}class bCe extends Fte{constructor(){super(...arguments),this.isSVGTag=!1}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(_g.has(n)){const r=J4(n);return r&&r.default||0}return n=kee.has(n)?n:$4(n),e.getAttribute(n)}measureInstanceViewportBox(){return ss()}scrapeMotionValuesFromProps(e,n){return Mee(e,n)}build(e,n,r,c){W4(e,n,r,this.isSVGTag,c.transformTemplate)}renderInstance(e,n,r,c){Lee(e,n,r,c)}mount(e){this.isSVGTag=H4(e.tagName),super.mount(e)}}const wCe=(t,e)=>F4(t)?new bCe(e,{enableHardwareAcceleration:!1}):new TCe(e,{enableHardwareAcceleration:!0}),CCe={layout:{ProjectionNode:Lte,MeasureLayout:Ate}},RCe={...Zbe,...vTe,...iCe,...CCe},dn=ISe((t,e)=>oTe(t,e,RCe,wCe));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vte=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let c=t.charCodeAt(r);c<128?e[n++]=c:c<2048?(e[n++]=c>>6|192,e[n++]=c&63|128):(c&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(c=65536+((c&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=c>>18|240,e[n++]=c>>12&63|128,e[n++]=c>>6&63|128,e[n++]=c&63|128):(e[n++]=c>>12|224,e[n++]=c>>6&63|128,e[n++]=c&63|128)}return e},ICe=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const c=t[n++];if(c<128)e[r++]=String.fromCharCode(c);else if(c>191&&c<224){const l=t[n++];e[r++]=String.fromCharCode((c&31)<<6|l&63)}else if(c>239&&c<365){const l=t[n++],d=t[n++],f=t[n++],m=((c&7)<<18|(l&63)<<12|(d&63)<<6|f&63)-65536;e[r++]=String.fromCharCode(55296+(m>>10)),e[r++]=String.fromCharCode(56320+(m&1023))}else{const l=t[n++],d=t[n++];e[r++]=String.fromCharCode((c&15)<<12|(l&63)<<6|d&63)}}return e.join("")},Bte={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let c=0;c<t.length;c+=3){const l=t[c],d=c+1<t.length,f=d?t[c+1]:0,m=c+2<t.length,E=m?t[c+2]:0,y=l>>2,w=(l&3)<<4|f>>4;let I=(f&15)<<2|E>>6,P=E&63;m||(P=64,d||(I=64)),r.push(n[y],n[w],n[I],n[P])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Vte(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):ICe(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let c=0;c<t.length;){const l=n[t.charAt(c++)],f=c<t.length?n[t.charAt(c)]:0;++c;const E=c<t.length?n[t.charAt(c)]:64;++c;const w=c<t.length?n[t.charAt(c)]:64;if(++c,l==null||f==null||E==null||w==null)throw new ACe;const I=l<<2|f>>4;if(r.push(I),E!==64){const P=f<<4&240|E>>2;if(r.push(P),w!==64){const k=E<<6&192|w;r.push(k)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class ACe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const OCe=function(t){const e=Vte(t);return Bte.encodeByteArray(e,!0)},Wte=function(t){return OCe(t).replace(/\./g,"")},Hte=function(t){try{return Bte.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NCe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PCe=()=>NCe().__FIREBASE_DEFAULTS__,xCe=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},DCe=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Hte(t[1]);return e&&JSON.parse(e)},n5=()=>{try{return PCe()||xCe()||DCe()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},kCe=t=>{var e,n;return(n=(e=n5())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},$te=()=>{var t;return(t=n5())===null||t===void 0?void 0:t.config},zte=t=>{var e;return(e=n5())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LCe{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ro(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function MCe(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ro())}function UCe(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function jCe(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function FCe(){const t=Ro();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function VCe(){try{return typeof indexedDB=="object"}catch{return!1}}function BCe(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",c=self.indexedDB.open(r);c.onsuccess=()=>{c.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},c.onupgradeneeded=()=>{n=!1},c.onerror=()=>{var l;e(((l=c.error)===null||l===void 0?void 0:l.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WCe="FirebaseError";class ep extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=WCe,Object.setPrototypeOf(this,ep.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xb.prototype.create)}}class xb{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},c=`${this.service}/${e}`,l=this.errors[e],d=l?HCe(l,r):"Error",f=`${this.serviceName}: ${d} (${c}).`;return new ep(c,f,r)}}function HCe(t,e){return t.replace($Ce,(n,r)=>{const c=e[r];return c!=null?String(c):`<${r}?>`})}const $Ce=/\{\$([^}]+)}/g;function zCe(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function k1(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const c of n){if(!r.includes(c))return!1;const l=t[c],d=e[c];if(_K(l)&&_K(d)){if(!k1(l,d))return!1}else if(l!==d)return!1}for(const c of r)if(!n.includes(c))return!1;return!0}function _K(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Db(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(c=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(c))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function GCe(t,e){const n=new KCe(t,e);return n.subscribe.bind(n)}class KCe{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let c;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");qCe(e,["next","error","complete"])?c=e:c={next:e,error:n,complete:r},c.next===void 0&&(c.next=Vj),c.error===void 0&&(c.error=Vj),c.complete===void 0&&(c.complete=Vj);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?c.error(this.finalError):c.complete()}catch{}}),this.observers.push(c),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function qCe(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Vj(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uv(t){return t&&t._delegate?t._delegate:t}class bv{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rm="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YCe{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new LCe;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const c=this.getOrInitializeService({instanceIdentifier:n});c&&r.resolve(c)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),c=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(l){if(c)return null;throw l}else{if(c)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(JCe(e))try{this.getOrInitializeService({instanceIdentifier:Rm})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(n);try{const l=this.getOrInitializeService({instanceIdentifier:c});r.resolve(l)}catch{}}}}clearInstance(e=Rm){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Rm){return this.instances.has(e)}getOptions(e=Rm){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const c=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[l,d]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(l);r===f&&d.resolve(c)}return c}onInit(e,n){var r;const c=this.normalizeInstanceIdentifier(n),l=(r=this.onInitCallbacks.get(c))!==null&&r!==void 0?r:new Set;l.add(e),this.onInitCallbacks.set(c,l);const d=this.instances.get(c);return d&&e(d,c),()=>{l.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const c of r)try{c(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:XCe(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Rm){return this.component?this.component.multipleInstances?e:Rm:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function XCe(t){return t===Rm?void 0:t}function JCe(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QCe{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new YCe(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Vi;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Vi||(Vi={}));const ZCe={debug:Vi.DEBUG,verbose:Vi.VERBOSE,info:Vi.INFO,warn:Vi.WARN,error:Vi.ERROR,silent:Vi.SILENT},eRe=Vi.INFO,tRe={[Vi.DEBUG]:"log",[Vi.VERBOSE]:"log",[Vi.INFO]:"info",[Vi.WARN]:"warn",[Vi.ERROR]:"error"},nRe=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),c=tRe[e];if(c)console[c](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Gte{constructor(e){this.name=e,this._logLevel=eRe,this._logHandler=nRe,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Vi))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?ZCe[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Vi.DEBUG,...e),this._logHandler(this,Vi.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Vi.VERBOSE,...e),this._logHandler(this,Vi.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Vi.INFO,...e),this._logHandler(this,Vi.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Vi.WARN,...e),this._logHandler(this,Vi.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Vi.ERROR,...e),this._logHandler(this,Vi.ERROR,...e)}}const iRe=(t,e)=>e.some(n=>t instanceof n);let EK,vK;function rRe(){return EK||(EK=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function sRe(){return vK||(vK=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Kte=new WeakMap,Q3=new WeakMap,qte=new WeakMap,Bj=new WeakMap,i5=new WeakMap;function oRe(t){const e=new Promise((n,r)=>{const c=()=>{t.removeEventListener("success",l),t.removeEventListener("error",d)},l=()=>{n(Mf(t.result)),c()},d=()=>{r(t.error),c()};t.addEventListener("success",l),t.addEventListener("error",d)});return e.then(n=>{n instanceof IDBCursor&&Kte.set(n,t)}).catch(()=>{}),i5.set(e,t),e}function aRe(t){if(Q3.has(t))return;const e=new Promise((n,r)=>{const c=()=>{t.removeEventListener("complete",l),t.removeEventListener("error",d),t.removeEventListener("abort",d)},l=()=>{n(),c()},d=()=>{r(t.error||new DOMException("AbortError","AbortError")),c()};t.addEventListener("complete",l),t.addEventListener("error",d),t.addEventListener("abort",d)});Q3.set(t,e)}let Z3={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Q3.get(t);if(e==="objectStoreNames")return t.objectStoreNames||qte.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Mf(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function cRe(t){Z3=t(Z3)}function lRe(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Wj(this),e,...n);return qte.set(r,e.sort?e.sort():[e]),Mf(r)}:sRe().includes(t)?function(...e){return t.apply(Wj(this),e),Mf(Kte.get(this))}:function(...e){return Mf(t.apply(Wj(this),e))}}function uRe(t){return typeof t=="function"?lRe(t):(t instanceof IDBTransaction&&aRe(t),iRe(t,rRe())?new Proxy(t,Z3):t)}function Mf(t){if(t instanceof IDBRequest)return oRe(t);if(Bj.has(t))return Bj.get(t);const e=uRe(t);return e!==t&&(Bj.set(t,e),i5.set(e,t)),e}const Wj=t=>i5.get(t);function dRe(t,e,{blocked:n,upgrade:r,blocking:c,terminated:l}={}){const d=indexedDB.open(t,e),f=Mf(d);return r&&d.addEventListener("upgradeneeded",m=>{r(Mf(d.result),m.oldVersion,m.newVersion,Mf(d.transaction),m)}),n&&d.addEventListener("blocked",m=>n(m.oldVersion,m.newVersion,m)),f.then(m=>{l&&m.addEventListener("close",()=>l()),c&&m.addEventListener("versionchange",E=>c(E.oldVersion,E.newVersion,E))}).catch(()=>{}),f}const hRe=["get","getKey","getAll","getAllKeys","count"],fRe=["put","add","delete","clear"],Hj=new Map;function yK(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Hj.get(e))return Hj.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,c=fRe.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(c||hRe.includes(n)))return;const l=async function(d,...f){const m=this.transaction(d,c?"readwrite":"readonly");let E=m.store;return r&&(E=E.index(f.shift())),(await Promise.all([E[n](...f),c&&m.done]))[0]};return Hj.set(e,l),l}cRe(t=>({...t,get:(e,n,r)=>yK(e,n)||t.get(e,n,r),has:(e,n)=>!!yK(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pRe{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(mRe(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function mRe(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const eV="@firebase/app",SK="0.9.22";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eg=new Gte("@firebase/app"),gRe="@firebase/app-compat",_Re="@firebase/analytics-compat",ERe="@firebase/analytics",vRe="@firebase/app-check-compat",yRe="@firebase/app-check",SRe="@firebase/auth",TRe="@firebase/auth-compat",bRe="@firebase/database",wRe="@firebase/database-compat",CRe="@firebase/functions",RRe="@firebase/functions-compat",IRe="@firebase/installations",ARe="@firebase/installations-compat",ORe="@firebase/messaging",NRe="@firebase/messaging-compat",PRe="@firebase/performance",xRe="@firebase/performance-compat",DRe="@firebase/remote-config",kRe="@firebase/remote-config-compat",LRe="@firebase/storage",MRe="@firebase/storage-compat",URe="@firebase/firestore",jRe="@firebase/firestore-compat",FRe="firebase",VRe="10.5.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tV="[DEFAULT]",BRe={[eV]:"fire-core",[gRe]:"fire-core-compat",[ERe]:"fire-analytics",[_Re]:"fire-analytics-compat",[yRe]:"fire-app-check",[vRe]:"fire-app-check-compat",[SRe]:"fire-auth",[TRe]:"fire-auth-compat",[bRe]:"fire-rtdb",[wRe]:"fire-rtdb-compat",[CRe]:"fire-fn",[RRe]:"fire-fn-compat",[IRe]:"fire-iid",[ARe]:"fire-iid-compat",[ORe]:"fire-fcm",[NRe]:"fire-fcm-compat",[PRe]:"fire-perf",[xRe]:"fire-perf-compat",[DRe]:"fire-rc",[kRe]:"fire-rc-compat",[LRe]:"fire-gcs",[MRe]:"fire-gcs-compat",[URe]:"fire-fst",[jRe]:"fire-fst-compat","fire-js":"fire-js",[FRe]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L1=new Map,nV=new Map;function WRe(t,e){try{t.container.addComponent(e)}catch(n){eg.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function nb(t){const e=t.name;if(nV.has(e))return eg.debug(`There were multiple attempts to register component ${e}.`),!1;nV.set(e,t);for(const n of L1.values())WRe(n,t);return!0}function Yte(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HRe={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Uf=new xb("app","Firebase",HRe);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $Re{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new bv("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Uf.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kb=VRe;function Xte(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:tV,automaticDataCollectionEnabled:!1},e),c=r.name;if(typeof c!="string"||!c)throw Uf.create("bad-app-name",{appName:String(c)});if(n||(n=$te()),!n)throw Uf.create("no-options");const l=L1.get(c);if(l){if(k1(n,l.options)&&k1(r,l.config))return l;throw Uf.create("duplicate-app",{appName:c})}const d=new QCe(c);for(const m of nV.values())d.addComponent(m);const f=new $Re(n,r,d);return L1.set(c,f),f}function zRe(t=tV){const e=L1.get(t);if(!e&&t===tV&&$te())return Xte();if(!e)throw Uf.create("no-app",{appName:t});return e}function QE(t,e,n){var r;let c=(r=BRe[t])!==null&&r!==void 0?r:t;n&&(c+=`-${n}`);const l=c.match(/\s|\//),d=e.match(/\s|\//);if(l||d){const f=[`Unable to register library "${c}" with version "${e}":`];l&&f.push(`library name "${c}" contains illegal characters (whitespace or "/")`),l&&d&&f.push("and"),d&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),eg.warn(f.join(" "));return}nb(new bv(`${c}-version`,()=>({library:c,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GRe="firebase-heartbeat-database",KRe=1,ib="firebase-heartbeat-store";let $j=null;function Jte(){return $j||($j=dRe(GRe,KRe,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(ib)}}}).catch(t=>{throw Uf.create("idb-open",{originalErrorMessage:t.message})})),$j}async function qRe(t){try{return await(await Jte()).transaction(ib).objectStore(ib).get(Qte(t))}catch(e){if(e instanceof ep)eg.warn(e.message);else{const n=Uf.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});eg.warn(n.message)}}}async function TK(t,e){try{const r=(await Jte()).transaction(ib,"readwrite");await r.objectStore(ib).put(e,Qte(t)),await r.done}catch(n){if(n instanceof ep)eg.warn(n.message);else{const r=Uf.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});eg.warn(r.message)}}}function Qte(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YRe=1024,XRe=30*24*60*60*1e3;class JRe{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new ZRe(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=bK();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(c=>c.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(c=>{const l=new Date(c.date).valueOf();return Date.now()-l<=XRe}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=bK(),{heartbeatsToSend:n,unsentEntries:r}=QRe(this._heartbeatsCache.heartbeats),c=Wte(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),c}}function bK(){return new Date().toISOString().substring(0,10)}function QRe(t,e=YRe){const n=[];let r=t.slice();for(const c of t){const l=n.find(d=>d.agent===c.agent);if(l){if(l.dates.push(c.date),wK(n)>e){l.dates.pop();break}}else if(n.push({agent:c.agent,dates:[c.date]}),wK(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class ZRe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return VCe()?BCe().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await qRe(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const c=await this.read();return TK(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:c.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const c=await this.read();return TK(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:c.lastSentHeartbeatDate,heartbeats:[...c.heartbeats,...e.heartbeats]})}else return}}function wK(t){return Wte(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eIe(t){nb(new bv("platform-logger",e=>new pRe(e),"PRIVATE")),nb(new bv("heartbeat",e=>new JRe(e),"PRIVATE")),QE(eV,SK,t),QE(eV,SK,"esm2017"),QE("fire-js","")}eIe("");function r5(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,r=Object.getOwnPropertySymbols(t);c<r.length;c++)e.indexOf(r[c])<0&&Object.prototype.propertyIsEnumerable.call(t,r[c])&&(n[r[c]]=t[r[c]]);return n}function Zte(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const tIe=Zte,ene=new xb("auth","Firebase",Zte());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M1=new Gte("@firebase/auth");function nIe(t,...e){M1.logLevel<=Vi.WARN&&M1.warn(`Auth (${kb}): ${t}`,...e)}function MO(t,...e){M1.logLevel<=Vi.ERROR&&M1.error(`Auth (${kb}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iu(t,...e){throw s5(t,...e)}function yu(t,...e){return s5(t,...e)}function tne(t,e,n){const r=Object.assign(Object.assign({},tIe()),{[e]:n});return new xb("auth","Firebase",r).create(e,{appName:t.name})}function iIe(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Iu(t,"argument-error"),tne(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function s5(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return ene.create(t,...e)}function pn(t,e,...n){if(!t)throw s5(e,...n)}function Od(t){const e="INTERNAL ASSERTION FAILED: "+t;throw MO(e),new Error(e)}function Wd(t,e){t||Od(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iV(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function rIe(){return CK()==="http:"||CK()==="https:"}function CK(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sIe(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(rIe()||UCe()||"connection"in navigator)?navigator.onLine:!0}function oIe(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lb{constructor(e,n){this.shortDelay=e,this.longDelay=n,Wd(n>e,"Short delay should be less than long delay!"),this.isMobile=MCe()||jCe()}get(){return sIe()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o5(t,e){Wd(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nne{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Od("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Od("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Od("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aIe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cIe=new Lb(3e4,6e4);function ine(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Mb(t,e,n,r,c={}){return rne(t,c,async()=>{let l={},d={};r&&(e==="GET"?d=r:l={body:JSON.stringify(r)});const f=Db(Object.assign({key:t.config.apiKey},d)).slice(1),m=await t._getAdditionalHeaders();return m["Content-Type"]="application/json",t.languageCode&&(m["X-Firebase-Locale"]=t.languageCode),nne.fetch()(sne(t,t.config.apiHost,n,f),Object.assign({method:e,headers:m,referrerPolicy:"no-referrer"},l))})}async function rne(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},aIe),e);try{const c=new uIe(t),l=await Promise.race([n(),c.promise]);c.clearNetworkTimeout();const d=await l.json();if("needConfirmation"in d)throw WA(t,"account-exists-with-different-credential",d);if(l.ok&&!("errorMessage"in d))return d;{const f=l.ok?d.errorMessage:d.error.message,[m,E]=f.split(" : ");if(m==="FEDERATED_USER_ID_ALREADY_LINKED")throw WA(t,"credential-already-in-use",d);if(m==="EMAIL_EXISTS")throw WA(t,"email-already-in-use",d);if(m==="USER_DISABLED")throw WA(t,"user-disabled",d);const y=r[m]||m.toLowerCase().replace(/[_\s]+/g,"-");if(E)throw tne(t,y,E);Iu(t,y)}}catch(c){if(c instanceof ep)throw c;Iu(t,"network-request-failed",{message:String(c)})}}async function lIe(t,e,n,r,c={}){const l=await Mb(t,e,n,r,c);return"mfaPendingCredential"in l&&Iu(t,"multi-factor-auth-required",{_serverResponse:l}),l}function sne(t,e,n,r){const c=`${e}${n}?${r}`;return t.config.emulator?o5(t.config,c):`${t.config.apiScheme}://${c}`}class uIe{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(yu(this.auth,"network-request-failed")),cIe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function WA(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const c=yu(t,e,r);return c.customData._tokenResponse=n,c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dIe(t,e){return Mb(t,"POST","/v1/accounts:delete",e)}async function hIe(t,e){return Mb(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bT(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function fIe(t,e=!1){const n=Uv(t),r=await n.getIdToken(e),c=a5(r);pn(c&&c.exp&&c.auth_time&&c.iat,n.auth,"internal-error");const l=typeof c.firebase=="object"?c.firebase:void 0,d=l==null?void 0:l.sign_in_provider;return{claims:c,token:r,authTime:bT(zj(c.auth_time)),issuedAtTime:bT(zj(c.iat)),expirationTime:bT(zj(c.exp)),signInProvider:d||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function zj(t){return Number(t)*1e3}function a5(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return MO("JWT malformed, contained fewer than 3 sections"),null;try{const c=Hte(n);return c?JSON.parse(c):(MO("Failed to decode base64 JWT payload"),null)}catch(c){return MO("Caught error parsing JWT payload as JSON",c==null?void 0:c.toString()),null}}function pIe(t){const e=a5(t);return pn(e,"internal-error"),pn(typeof e.exp<"u","internal-error"),pn(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rb(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ep&&mIe(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function mIe({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gIe{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const c=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,c)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class one{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=bT(this.lastLoginAt),this.creationTime=bT(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U1(t){var e;const n=t.auth,r=await t.getIdToken(),c=await rb(t,hIe(n,{idToken:r}));pn(c==null?void 0:c.users.length,n,"internal-error");const l=c.users[0];t._notifyReloadListener(l);const d=!((e=l.providerUserInfo)===null||e===void 0)&&e.length?vIe(l.providerUserInfo):[],f=EIe(t.providerData,d),m=t.isAnonymous,E=!(t.email&&l.passwordHash)&&!(f!=null&&f.length),y=m?E:!1,w={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:f,metadata:new one(l.createdAt,l.lastLoginAt),isAnonymous:y};Object.assign(t,w)}async function _Ie(t){const e=Uv(t);await U1(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function EIe(t,e){return[...t.filter(r=>!e.some(c=>c.providerId===r.providerId)),...e]}function vIe(t){return t.map(e=>{var{providerId:n}=e,r=r5(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yIe(t,e){const n=await rne(t,{},async()=>{const r=Db({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:c,apiKey:l}=t.config,d=sne(t,c,"/v1/token",`key=${l}`),f=await t._getAdditionalHeaders();return f["Content-Type"]="application/x-www-form-urlencoded",nne.fetch()(d,{method:"POST",headers:f,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sb{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){pn(e.idToken,"internal-error"),pn(typeof e.idToken<"u","internal-error"),pn(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):pIe(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}async getToken(e,n=!1){return pn(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:c,expiresIn:l}=await yIe(e,n);this.updateTokensAndExpiration(r,c,Number(l))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:c,expirationTime:l}=n,d=new sb;return r&&(pn(typeof r=="string","internal-error",{appName:e}),d.refreshToken=r),c&&(pn(typeof c=="string","internal-error",{appName:e}),d.accessToken=c),l&&(pn(typeof l=="number","internal-error",{appName:e}),d.expirationTime=l),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new sb,this.toJSON())}_performRefresh(){return Od("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ef(t,e){pn(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class $m{constructor(e){var{uid:n,auth:r,stsTokenManager:c}=e,l=r5(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new gIe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=c,this.accessToken=c.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new one(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const n=await rb(this,this.stsTokenManager.getToken(this.auth,e));return pn(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return fIe(this,e)}reload(){return _Ie(this)}_assign(e){this!==e&&(pn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new $m(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){pn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await U1(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await rb(this,dIe(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,c,l,d,f,m,E,y;const w=(r=n.displayName)!==null&&r!==void 0?r:void 0,I=(c=n.email)!==null&&c!==void 0?c:void 0,P=(l=n.phoneNumber)!==null&&l!==void 0?l:void 0,k=(d=n.photoURL)!==null&&d!==void 0?d:void 0,M=(f=n.tenantId)!==null&&f!==void 0?f:void 0,K=(m=n._redirectEventId)!==null&&m!==void 0?m:void 0,W=(E=n.createdAt)!==null&&E!==void 0?E:void 0,V=(y=n.lastLoginAt)!==null&&y!==void 0?y:void 0,{uid:G,emailVerified:Q,isAnonymous:Z,providerData:Y,stsTokenManager:oe}=n;pn(G&&oe,e,"internal-error");const ce=sb.fromJSON(this.name,oe);pn(typeof G=="string",e,"internal-error"),ef(w,e.name),ef(I,e.name),pn(typeof Q=="boolean",e,"internal-error"),pn(typeof Z=="boolean",e,"internal-error"),ef(P,e.name),ef(k,e.name),ef(M,e.name),ef(K,e.name),ef(W,e.name),ef(V,e.name);const Se=new $m({uid:G,auth:e,email:I,emailVerified:Q,displayName:w,isAnonymous:Z,photoURL:k,phoneNumber:P,tenantId:M,stsTokenManager:ce,createdAt:W,lastLoginAt:V});return Y&&Array.isArray(Y)&&(Se.providerData=Y.map(xe=>Object.assign({},xe))),K&&(Se._redirectEventId=K),Se}static async _fromIdTokenResponse(e,n,r=!1){const c=new sb;c.updateFromServerResponse(n);const l=new $m({uid:n.localId,auth:e,stsTokenManager:c,isAnonymous:r});return await U1(l),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RK=new Map;function Nd(t){Wd(t instanceof Function,"Expected a class definition");let e=RK.get(t);return e?(Wd(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,RK.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ane{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}ane.type="NONE";const IK=ane;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UO(t,e,n){return`firebase:${t}:${e}:${n}`}class ZE{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:c,name:l}=this.auth;this.fullUserKey=UO(this.userKey,c.apiKey,l),this.fullPersistenceKey=UO("persistence",c.apiKey,l),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?$m._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ZE(Nd(IK),e,r);const c=(await Promise.all(n.map(async E=>{if(await E._isAvailable())return E}))).filter(E=>E);let l=c[0]||Nd(IK);const d=UO(r,e.config.apiKey,e.name);let f=null;for(const E of n)try{const y=await E._get(d);if(y){const w=$m._fromJSON(e,y);E!==l&&(f=w),l=E;break}}catch{}const m=c.filter(E=>E._shouldAllowMigration);return!l._shouldAllowMigration||!m.length?new ZE(l,e,r):(l=m[0],f&&await l._set(d,f.toJSON()),await Promise.all(n.map(async E=>{if(E!==l)try{await E._remove(d)}catch{}})),new ZE(l,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AK(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(une(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(cne(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(hne(e))return"Blackberry";if(fne(e))return"Webos";if(c5(e))return"Safari";if((e.includes("chrome/")||lne(e))&&!e.includes("edge/"))return"Chrome";if(dne(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function cne(t=Ro()){return/firefox\//i.test(t)}function c5(t=Ro()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function lne(t=Ro()){return/crios\//i.test(t)}function une(t=Ro()){return/iemobile/i.test(t)}function dne(t=Ro()){return/android/i.test(t)}function hne(t=Ro()){return/blackberry/i.test(t)}function fne(t=Ro()){return/webos/i.test(t)}function SP(t=Ro()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function SIe(t=Ro()){var e;return SP(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function TIe(){return FCe()&&document.documentMode===10}function pne(t=Ro()){return SP(t)||dne(t)||fne(t)||hne(t)||/windows phone/i.test(t)||une(t)}function bIe(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mne(t,e=[]){let n;switch(t){case"Browser":n=AK(Ro());break;case"Worker":n=`${AK(Ro())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${kb}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wIe{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=l=>new Promise((d,f)=>{try{const m=e(l);d(m)}catch(m){f(m)}});r.onAbort=n,this.queue.push(r);const c=this.queue.length-1;return()=>{this.queue[c]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const c of n)try{c()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CIe(t,e={}){return Mb(t,"GET","/v2/passwordPolicy",ine(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RIe=6;class IIe{constructor(e){var n,r,c,l;const d=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=d.minPasswordLength)!==null&&n!==void 0?n:RIe,d.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=d.maxPasswordLength),d.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=d.containsLowercaseCharacter),d.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=d.containsUppercaseCharacter),d.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=d.containsNumericCharacter),d.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=d.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(c=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&c!==void 0?c:"",this.forceUpgradeOnSignin=(l=e.forceUpgradeOnSignin)!==null&&l!==void 0?l:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,c,l,d,f;const m={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,m),this.validatePasswordCharacterOptions(e,m),m.isValid&&(m.isValid=(n=m.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),m.isValid&&(m.isValid=(r=m.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),m.isValid&&(m.isValid=(c=m.containsLowercaseLetter)!==null&&c!==void 0?c:!0),m.isValid&&(m.isValid=(l=m.containsUppercaseLetter)!==null&&l!==void 0?l:!0),m.isValid&&(m.isValid=(d=m.containsNumericCharacter)!==null&&d!==void 0?d:!0),m.isValid&&(m.isValid=(f=m.containsNonAlphanumericCharacter)!==null&&f!==void 0?f:!0),m}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,c=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),c&&(n.meetsMaxPasswordLength=e.length<=c)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let c=0;c<e.length;c++)r=e.charAt(c),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,c,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=c)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AIe{constructor(e,n,r,c){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=c,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new OK(this),this.idTokenSubscription=new OK(this),this.beforeStateQueue=new wIe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ene,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=c.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Nd(n)),this._initializationPromise=this.queue(async()=>{var r,c;if(!this._deleted&&(this.persistenceManager=await ZE.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((c=this.currentUser)===null||c===void 0?void 0:c.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var n;const r=await this.assertedPersistence.getCurrentUser();let c=r,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,f=c==null?void 0:c._redirectEventId,m=await this.tryRedirectSignIn(e);(!d||d===f)&&(m!=null&&m.user)&&(c=m.user,l=!0)}if(!c)return this.directlySetCurrentUser(null);if(!c._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(c)}catch(d){c=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return c?this.reloadAndSetCurrentUserOrClear(c):this.directlySetCurrentUser(null)}return pn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===c._redirectEventId?this.directlySetCurrentUser(c):this.reloadAndSetCurrentUserOrClear(c)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await U1(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=oIe()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const n=e?Uv(e):null;return n&&pn(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&pn(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Nd(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await CIe(this),n=new IIe(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new xb("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Nd(e)||this._popupRedirectResolver;pn(n,this,"argument-error"),this.redirectPersistenceManager=await ZE.create(this,[Nd(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,c){if(this._deleted)return()=>{};const l=typeof n=="function"?n:n.next.bind(n);let d=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(pn(f,this,"internal-error"),f.then(()=>{d||l(this.currentUser)}),typeof n=="function"){const m=e.addObserver(n,r,c);return()=>{d=!0,m()}}else{const m=e.addObserver(n);return()=>{d=!0,m()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return pn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=mne(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const c=await this._getAppCheckToken();return c&&(n["X-Firebase-AppCheck"]=c),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&nIe(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function TP(t){return Uv(t)}class OK{constructor(e){this.auth=e,this.observer=null,this.addObserver=GCe(n=>this.observer=n)}get next(){return pn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OIe(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function NIe(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=c=>{const l=yu("internal-error");l.customData=c,n(l)},r.type="text/javascript",r.charset="UTF-8",OIe().appendChild(r)})}function PIe(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xIe(t,e){const n=Yte(t,"auth");if(n.isInitialized()){const c=n.getImmediate(),l=n.getOptions();if(k1(l,e??{}))return c;Iu(c,"already-initialized")}return n.initialize({options:e})}function DIe(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Nd);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function kIe(t,e,n){const r=TP(t);pn(r._canInitEmulator,r,"emulator-config-failed"),pn(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const c=!!(n!=null&&n.disableWarnings),l=gne(e),{host:d,port:f}=LIe(e),m=f===null?"":`:${f}`;r.config.emulator={url:`${l}//${d}${m}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:d,port:f,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:c})}),c||MIe()}function gne(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function LIe(t){const e=gne(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",c=/^(\[[^\]]+\])(:|$)/.exec(r);if(c){const l=c[1];return{host:l,port:NK(r.substr(l.length+1))}}else{const[l,d]=r.split(":");return{host:l,port:NK(d)}}}function NK(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function MIe(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _ne{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Od("not implemented")}_getIdTokenResponse(e){return Od("not implemented")}_linkToIdToken(e,n){return Od("not implemented")}_getReauthenticationResolver(e){return Od("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ev(t,e){return lIe(t,"POST","/v1/accounts:signInWithIdp",ine(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UIe="http://localhost";class tg extends _ne{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new tg(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Iu("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:c}=n,l=r5(n,["providerId","signInMethod"]);if(!r||!c)return null;const d=new tg(r,c);return d.idToken=l.idToken||void 0,d.accessToken=l.accessToken||void 0,d.secret=l.secret,d.nonce=l.nonce,d.pendingToken=l.pendingToken||null,d}_getIdTokenResponse(e){const n=this.buildRequest();return ev(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ev(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ev(e,n)}buildRequest(){const e={requestUri:UIe,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Db(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l5{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ub extends l5{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf extends Ub{constructor(){super("facebook.com")}static credential(e){return tg._fromParams({providerId:hf.PROVIDER_ID,signInMethod:hf.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return hf.credentialFromTaggedObject(e)}static credentialFromError(e){return hf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return hf.credential(e.oauthAccessToken)}catch{return null}}}hf.FACEBOOK_SIGN_IN_METHOD="facebook.com";hf.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd extends Ub{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return tg._fromParams({providerId:wd.PROVIDER_ID,signInMethod:wd.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return wd.credentialFromTaggedObject(e)}static credentialFromError(e){return wd.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return wd.credential(n,r)}catch{return null}}}wd.GOOGLE_SIGN_IN_METHOD="google.com";wd.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff extends Ub{constructor(){super("github.com")}static credential(e){return tg._fromParams({providerId:ff.PROVIDER_ID,signInMethod:ff.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ff.credentialFromTaggedObject(e)}static credentialFromError(e){return ff.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ff.credential(e.oauthAccessToken)}catch{return null}}}ff.GITHUB_SIGN_IN_METHOD="github.com";ff.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf extends Ub{constructor(){super("twitter.com")}static credential(e,n){return tg._fromParams({providerId:pf.PROVIDER_ID,signInMethod:pf.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return pf.credentialFromTaggedObject(e)}static credentialFromError(e){return pf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return pf.credential(n,r)}catch{return null}}}pf.TWITTER_SIGN_IN_METHOD="twitter.com";pf.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wv{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,c=!1){const l=await $m._fromIdTokenResponse(e,r,c),d=PK(r);return new wv({user:l,providerId:d,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const c=PK(r);return new wv({user:e,providerId:c,_tokenResponse:r,operationType:n})}}function PK(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j1 extends ep{constructor(e,n,r,c){var l;super(n.code,n.message),this.operationType=r,this.user=c,Object.setPrototypeOf(this,j1.prototype),this.customData={appName:e.name,tenantId:(l=e.tenantId)!==null&&l!==void 0?l:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,c){return new j1(e,n,r,c)}}function Ene(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?j1._fromErrorAndOperation(t,l,e,r):l})}async function jIe(t,e,n=!1){const r=await rb(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return wv._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FIe(t,e,n=!1){const{auth:r}=t,c="reauthenticate";try{const l=await rb(t,Ene(r,c,e,t),n);pn(l.idToken,r,"internal-error");const d=a5(l.idToken);pn(d,r,"internal-error");const{sub:f}=d;return pn(t.uid===f,r,"user-mismatch"),wv._forOperation(t,c,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&Iu(r,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VIe(t,e,n=!1){const r="signIn",c=await Ene(t,r,e),l=await wv._fromIdTokenResponse(t,r,c);return n||await t._updateCurrentUser(l.user),l}function BIe(t,e,n,r){return Uv(t).onIdTokenChanged(e,n,r)}function WIe(t,e,n){return Uv(t).beforeAuthStateChanged(e,n)}const F1="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vne{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(F1,"1"),this.storage.removeItem(F1),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HIe(){const t=Ro();return c5(t)||SP(t)}const $Ie=1e3,zIe=10;class yne extends vne{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=HIe()&&bIe(),this.fallbackToPolling=pne(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),c=this.localCache[n];r!==c&&e(n,c,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((d,f,m)=>{this.notifyListeners(d,m)});return}const r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const d=this.storage.getItem(r);if(e.newValue!==d)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}const c=()=>{const d=this.storage.getItem(r);!n&&this.localCache[r]===d||this.notifyListeners(r,d)},l=this.storage.getItem(r);TIe()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(c,zIe):c()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const c of Array.from(r))c(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},$Ie)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}yne.type="LOCAL";const GIe=yne;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sne extends vne{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Sne.type="SESSION";const Tne=Sne;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KIe(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bP{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(c=>c.isListeningto(e));if(n)return n;const r=new bP(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:c,data:l}=n.data,d=this.handlersMap[c];if(!(d!=null&&d.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:c});const f=Array.from(d).map(async E=>E(n.origin,l)),m=await KIe(f);n.ports[0].postMessage({status:"done",eventId:r,eventType:c,response:m})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}bP.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u5(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qIe{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const c=typeof MessageChannel<"u"?new MessageChannel:null;if(!c)throw new Error("connection_unavailable");let l,d;return new Promise((f,m)=>{const E=u5("",20);c.port1.start();const y=setTimeout(()=>{m(new Error("unsupported_event"))},r);d={messageChannel:c,onMessage(w){const I=w;if(I.data.eventId===E)switch(I.data.status){case"ack":clearTimeout(y),l=setTimeout(()=>{m(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),f(I.data.response);break;default:clearTimeout(y),clearTimeout(l),m(new Error("invalid_response"));break}}},this.handlers.add(d),c.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:E,data:n},[c.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Su(){return window}function YIe(t){Su().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bne(){return typeof Su().WorkerGlobalScope<"u"&&typeof Su().importScripts=="function"}async function XIe(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function JIe(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function QIe(){return bne()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wne="firebaseLocalStorageDb",ZIe=1,V1="firebaseLocalStorage",Cne="fbase_key";class jb{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function wP(t,e){return t.transaction([V1],e?"readwrite":"readonly").objectStore(V1)}function eAe(){const t=indexedDB.deleteDatabase(wne);return new jb(t).toPromise()}function rV(){const t=indexedDB.open(wne,ZIe);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(V1,{keyPath:Cne})}catch(c){n(c)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(V1)?e(r):(r.close(),await eAe(),e(await rV()))})})}async function xK(t,e,n){const r=wP(t,!0).put({[Cne]:e,value:n});return new jb(r).toPromise()}async function tAe(t,e){const n=wP(t,!1).get(e),r=await new jb(n).toPromise();return r===void 0?null:r.value}function DK(t,e){const n=wP(t,!0).delete(e);return new jb(n).toPromise()}const nAe=800,iAe=3;class Rne{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await rV(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>iAe)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return bne()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=bP._getInstance(QIe()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await XIe(),!this.activeServiceWorker)return;this.sender=new qIe(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||JIe()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await rV();return await xK(e,F1,"1"),await DK(e,F1),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>xK(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>tAe(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>DK(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(c=>{const l=wP(c,!1).getAll();return new jb(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;for(const{fbase_key:c,value:l}of e)r.add(c),JSON.stringify(this.localCache[c])!==JSON.stringify(l)&&(this.notifyListeners(c,l),n.push(c));for(const c of Object.keys(this.localCache))this.localCache[c]&&!r.has(c)&&(this.notifyListeners(c,null),n.push(c));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const c of Array.from(r))c(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),nAe)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Rne.type="LOCAL";const rAe=Rne;new Lb(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ine(t,e){return e?Nd(e):(pn(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d5 extends _ne{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ev(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ev(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ev(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function sAe(t){return VIe(t.auth,new d5(t),t.bypassAuthState)}function oAe(t){const{auth:e,user:n}=t;return pn(n,e,"internal-error"),FIe(n,new d5(t),t.bypassAuthState)}async function aAe(t){const{auth:e,user:n}=t;return pn(n,e,"internal-error"),jIe(n,new d5(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ane{constructor(e,n,r,c,l=!1){this.auth=e,this.resolver=r,this.user=c,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:c,tenantId:l,error:d,type:f}=e;if(d){this.reject(d);return}const m={auth:this.auth,requestUri:n,sessionId:r,tenantId:l||void 0,postBody:c||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(m))}catch(E){this.reject(E)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return sAe;case"linkViaPopup":case"linkViaRedirect":return aAe;case"reauthViaPopup":case"reauthViaRedirect":return oAe;default:Iu(this.auth,"internal-error")}}resolve(e){Wd(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Wd(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cAe=new Lb(2e3,1e4);async function lAe(t,e,n){const r=TP(t);iIe(t,e,l5);const c=Ine(r,n);return new jm(r,"signInViaPopup",e,c).executeNotNull()}class jm extends Ane{constructor(e,n,r,c,l){super(e,n,c,l),this.provider=r,this.authWindow=null,this.pollId=null,jm.currentPopupAction&&jm.currentPopupAction.cancel(),jm.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return pn(e,this.auth,"internal-error"),e}async onExecution(){Wd(this.filter.length===1,"Popup operations only handle one event");const e=u5();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(yu(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(yu(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,jm.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(yu(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,cAe.get())};e()}}jm.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uAe="pendingRedirect",jO=new Map;class dAe extends Ane{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=jO.get(this.auth._key());if(!e){try{const r=await hAe(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}jO.set(this.auth._key(),e)}return this.bypassAuthState||jO.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function hAe(t,e){const n=mAe(e),r=pAe(t);if(!await r._isAvailable())return!1;const c=await r._get(n)==="true";return await r._remove(n),c}function fAe(t,e){jO.set(t._key(),e)}function pAe(t){return Nd(t._redirectPersistence)}function mAe(t){return UO(uAe,t.config.apiKey,t.name)}async function gAe(t,e,n=!1){const r=TP(t),c=Ine(r,e),d=await new dAe(r,c,n).execute();return d&&!n&&(delete d.user._redirectEventId,await r._persistUserIfCurrent(d.user),await r._setRedirectUser(null,e)),d}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _Ae=10*60*1e3;class EAe{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!vAe(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!One(e)){const c=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(yu(this.auth,c))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=_Ae&&this.cachedEventUids.clear(),this.cachedEventUids.has(kK(e))}saveEventToCache(e){this.cachedEventUids.add(kK(e)),this.lastProcessedEventTime=Date.now()}}function kK(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function One({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function vAe(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return One(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yAe(t,e={}){return Mb(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SAe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,TAe=/^https?/;async function bAe(t){if(t.config.emulator)return;const{authorizedDomains:e}=await yAe(t);for(const n of e)try{if(wAe(n))return}catch{}Iu(t,"unauthorized-domain")}function wAe(t){const e=iV(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const d=new URL(t);return d.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&d.hostname===r}if(!TAe.test(n))return!1;if(SAe.test(t))return r===t;const c=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+c+"|"+c+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CAe=new Lb(3e4,6e4);function LK(){const t=Su().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function RAe(t){return new Promise((e,n)=>{var r,c,l;function d(){LK(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{LK(),n(yu(t,"network-request-failed"))},timeout:CAe.get()})}if(!((c=(r=Su().gapi)===null||r===void 0?void 0:r.iframes)===null||c===void 0)&&c.Iframe)e(gapi.iframes.getContext());else if(!((l=Su().gapi)===null||l===void 0)&&l.load)d();else{const f=PIe("iframefcb");return Su()[f]=()=>{gapi.load?d():n(yu(t,"network-request-failed"))},NIe(`https://apis.google.com/js/api.js?onload=${f}`).catch(m=>n(m))}}).catch(e=>{throw FO=null,e})}let FO=null;function IAe(t){return FO=FO||RAe(t),FO}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AAe=new Lb(5e3,15e3),OAe="__/auth/iframe",NAe="emulator/auth/iframe",PAe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},xAe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function DAe(t){const e=t.config;pn(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?o5(e,NAe):`https://${t.config.authDomain}/${OAe}`,r={apiKey:e.apiKey,appName:t.name,v:kb},c=xAe.get(t.config.apiHost);c&&(r.eid=c);const l=t._getFrameworks();return l.length&&(r.fw=l.join(",")),`${n}?${Db(r).slice(1)}`}async function kAe(t){const e=await IAe(t),n=Su().gapi;return pn(n,t,"internal-error"),e.open({where:document.body,url:DAe(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:PAe,dontclear:!0},r=>new Promise(async(c,l)=>{await r.restyle({setHideOnLeave:!1});const d=yu(t,"network-request-failed"),f=Su().setTimeout(()=>{l(d)},AAe.get());function m(){Su().clearTimeout(f),c(r)}r.ping(m).then(m,()=>{l(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LAe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},MAe=500,UAe=600,jAe="_blank",FAe="http://localhost";class MK{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function VAe(t,e,n,r=MAe,c=UAe){const l=Math.max((window.screen.availHeight-c)/2,0).toString(),d=Math.max((window.screen.availWidth-r)/2,0).toString();let f="";const m=Object.assign(Object.assign({},LAe),{width:r.toString(),height:c.toString(),top:l,left:d}),E=Ro().toLowerCase();n&&(f=lne(E)?jAe:n),cne(E)&&(e=e||FAe,m.scrollbars="yes");const y=Object.entries(m).reduce((I,[P,k])=>`${I}${P}=${k},`,"");if(SIe(E)&&f!=="_self")return BAe(e||"",f),new MK(null);const w=window.open(e||"",f,y);pn(w,t,"popup-blocked");try{w.focus()}catch{}return new MK(w)}function BAe(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WAe="__/auth/handler",HAe="emulator/auth/handler",$Ae=encodeURIComponent("fac");async function UK(t,e,n,r,c,l){pn(t.config.authDomain,t,"auth-domain-config-required"),pn(t.config.apiKey,t,"invalid-api-key");const d={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:kb,eventId:c};if(e instanceof l5){e.setDefaultLanguage(t.languageCode),d.providerId=e.providerId||"",zCe(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[y,w]of Object.entries(l||{}))d[y]=w}if(e instanceof Ub){const y=e.getScopes().filter(w=>w!=="");y.length>0&&(d.scopes=y.join(","))}t.tenantId&&(d.tid=t.tenantId);const f=d;for(const y of Object.keys(f))f[y]===void 0&&delete f[y];const m=await t._getAppCheckToken(),E=m?`#${$Ae}=${encodeURIComponent(m)}`:"";return`${zAe(t)}?${Db(f).slice(1)}${E}`}function zAe({config:t}){return t.emulator?o5(t,HAe):`https://${t.authDomain}/${WAe}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gj="webStorageSupport";class GAe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Tne,this._completeRedirectFn=gAe,this._overrideRedirectResult=fAe}async _openPopup(e,n,r,c){var l;Wd((l=this.eventManagers[e._key()])===null||l===void 0?void 0:l.manager,"_initialize() not called before _openPopup()");const d=await UK(e,n,r,iV(),c);return VAe(e,d,u5())}async _openRedirect(e,n,r,c){await this._originValidation(e);const l=await UK(e,n,r,iV(),c);return YIe(l),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:c,promise:l}=this.eventManagers[n];return c?Promise.resolve(c):(Wd(l,"If manager is not set, promise should be"),l)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await kAe(e),r=new EAe(e);return n.register("authEvent",c=>(pn(c==null?void 0:c.authEvent,e,"invalid-auth-event"),{status:r.onEvent(c.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Gj,{type:Gj},c=>{var l;const d=(l=c==null?void 0:c[0])===null||l===void 0?void 0:l[Gj];d!==void 0&&n(!!d),Iu(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=bAe(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return pne()||c5()||SP()}}const KAe=GAe;var jK="@firebase/auth",FK="1.3.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qAe{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){pn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YAe(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function XAe(t){nb(new bv("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),c=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:d,authDomain:f}=r.options;pn(d&&!d.includes(":"),"invalid-api-key",{appName:r.name});const m={apiKey:d,authDomain:f,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:mne(t)},E=new AIe(r,c,l,m);return DIe(E,n),E},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),nb(new bv("auth-internal",e=>{const n=TP(e.getProvider("auth").getImmediate());return(r=>new qAe(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),QE(jK,FK,YAe(t)),QE(jK,FK,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JAe=5*60,QAe=zte("authIdTokenMaxAge")||JAe;let VK=null;const ZAe=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>QAe)return;const c=n==null?void 0:n.token;VK!==c&&(VK=c,await fetch(t,{method:c?"POST":"DELETE",headers:c?{Authorization:`Bearer ${c}`}:{}}))};function eOe(t=zRe()){const e=Yte(t,"auth");if(e.isInitialized())return e.getImmediate();const n=xIe(t,{popupRedirectResolver:KAe,persistence:[rAe,GIe,Tne]}),r=zte("authTokenSyncURL");if(r){const l=ZAe(r);WIe(n,l,()=>l(n.currentUser)),BIe(n,d=>l(d))}const c=kCe("auth");return c&&kIe(n,`http://${c}`),n}XAe("Browser");var tOe="firebase",nOe="10.5.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */QE(tOe,nOe,"app");const iOe={apiKey:"AIzaSyB8r9F_MsxR3qq0a7SQh20GsZUSMcbNuoI",authDomain:"buzzgram-6a283.firebaseapp.com",projectId:"buzzgram-6a283",storageBucket:"buzzgram-6a283.appspot.com",messagingSenderId:"782160460930",appId:"1:782160460930:web:e546ebff5f26a96a48489b"},rOe=Xte(iOe);var Nne={exports:{}},sOe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",oOe=sOe,aOe=oOe;function Pne(){}function xne(){}xne.resetWarningCache=Pne;var cOe=function(){function t(r,c,l,d,f,m){if(m!==aOe){var E=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw E.name="Invariant Violation",E}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:xne,resetWarningCache:Pne};return n.PropTypes=n,n};Nne.exports=cOe();var lOe=Nne.exports;const Le=Kf(lOe);let uOe={data:""},dOe=t=>typeof window=="object"?((t?t.querySelector("#_goober"):window._goober)||Object.assign((t||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:t||uOe,hOe=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,fOe=/\/\*[^]*?\*\/|  +/g,BK=/\n+/g,mf=(t,e)=>{let n="",r="",c="";for(let l in t){let d=t[l];l[0]=="@"?l[1]=="i"?n=l+" "+d+";":r+=l[1]=="f"?mf(d,l):l+"{"+mf(d,l[1]=="k"?"":e)+"}":typeof d=="object"?r+=mf(d,e?e.replace(/([^,])+/g,f=>l.replace(/(^:.*)|([^,])+/g,m=>/&/.test(m)?m.replace(/&/g,f):f?f+" "+m:m)):l):d!=null&&(l=/^--/.test(l)?l:l.replace(/[A-Z]/g,"-$&").toLowerCase(),c+=mf.p?mf.p(l,d):l+":"+d+";")}return n+(e&&c?e+"{"+c+"}":c)+r},gd={},Dne=t=>{if(typeof t=="object"){let e="";for(let n in t)e+=n+Dne(t[n]);return e}return t},pOe=(t,e,n,r,c)=>{let l=Dne(t),d=gd[l]||(gd[l]=(m=>{let E=0,y=11;for(;E<m.length;)y=101*y+m.charCodeAt(E++)>>>0;return"go"+y})(l));if(!gd[d]){let m=l!==t?t:(E=>{let y,w,I=[{}];for(;y=hOe.exec(E.replace(fOe,""));)y[4]?I.shift():y[3]?(w=y[3].replace(BK," ").trim(),I.unshift(I[0][w]=I[0][w]||{})):I[0][y[1]]=y[2].replace(BK," ").trim();return I[0]})(t);gd[d]=mf(c?{["@keyframes "+d]:m}:m,n?"":"."+d)}let f=n&&gd.g?gd.g:null;return n&&(gd.g=gd[d]),((m,E,y,w)=>{w?E.data=E.data.replace(w,m):E.data.indexOf(m)===-1&&(E.data=y?m+E.data:E.data+m)})(gd[d],e,r,f),d},mOe=(t,e,n)=>t.reduce((r,c,l)=>{let d=e[l];if(d&&d.call){let f=d(n),m=f&&f.props&&f.props.className||/^go/.test(f)&&f;d=m?"."+m:f&&typeof f=="object"?f.props?"":mf(f,""):f===!1?"":f}return r+c+(d??"")},"");function CP(t){let e=this||{},n=t.call?t(e.p):t;return pOe(n.unshift?n.raw?mOe(n,[].slice.call(arguments,1),e.p):n.reduce((r,c)=>Object.assign(r,c&&c.call?c(e.p):c),{}):n,dOe(e.target),e.g,e.o,e.k)}let kne,sV,oV;CP.bind({g:1});let Hd=CP.bind({k:1});function gOe(t,e,n,r){mf.p=e,kne=t,sV=n,oV=r}function tp(t,e){let n=this||{};return function(){let r=arguments;function c(l,d){let f=Object.assign({},l),m=f.className||c.className;n.p=Object.assign({theme:sV&&sV()},f),n.o=/ *go\d+/.test(m),f.className=CP.apply(n,r)+(m?" "+m:""),e&&(f.ref=d);let E=t;return t[0]&&(E=f.as||t,delete f.as),oV&&E[0]&&oV(f),kne(E,f)}return e?e(c):c}}var _Oe=t=>typeof t=="function",B1=(t,e)=>_Oe(t)?t(e):t,EOe=(()=>{let t=0;return()=>(++t).toString()})(),Lne=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),vOe=20,VO=new Map,yOe=1e3,WK=t=>{if(VO.has(t))return;let e=setTimeout(()=>{VO.delete(t),vg({type:4,toastId:t})},yOe);VO.set(t,e)},SOe=t=>{let e=VO.get(t);e&&clearTimeout(e)},aV=(t,e)=>{switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,vOe)};case 1:return e.toast.id&&SOe(e.toast.id),{...t,toasts:t.toasts.map(l=>l.id===e.toast.id?{...l,...e.toast}:l)};case 2:let{toast:n}=e;return t.toasts.find(l=>l.id===n.id)?aV(t,{type:1,toast:n}):aV(t,{type:0,toast:n});case 3:let{toastId:r}=e;return r?WK(r):t.toasts.forEach(l=>{WK(l.id)}),{...t,toasts:t.toasts.map(l=>l.id===r||r===void 0?{...l,visible:!1}:l)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(l=>l.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let c=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(l=>({...l,pauseDuration:l.pauseDuration+c}))}}},BO=[],WO={toasts:[],pausedAt:void 0},vg=t=>{WO=aV(WO,t),BO.forEach(e=>{e(WO)})},TOe={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},bOe=(t={})=>{let[e,n]=$.useState(WO);$.useEffect(()=>(BO.push(n),()=>{let c=BO.indexOf(n);c>-1&&BO.splice(c,1)}),[e]);let r=e.toasts.map(c=>{var l,d;return{...t,...t[c.type],...c,duration:c.duration||((l=t[c.type])==null?void 0:l.duration)||(t==null?void 0:t.duration)||TOe[c.type],style:{...t.style,...(d=t[c.type])==null?void 0:d.style,...c.style}}});return{...e,toasts:r}},wOe=(t,e="blank",n)=>({createdAt:Date.now(),visible:!0,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...n,id:(n==null?void 0:n.id)||EOe()}),Fb=t=>(e,n)=>{let r=wOe(e,t,n);return vg({type:2,toast:r}),r.id},Za=(t,e)=>Fb("blank")(t,e);Za.error=Fb("error");Za.success=Fb("success");Za.loading=Fb("loading");Za.custom=Fb("custom");Za.dismiss=t=>{vg({type:3,toastId:t})};Za.remove=t=>vg({type:4,toastId:t});Za.promise=(t,e,n)=>{let r=Za.loading(e.loading,{...n,...n==null?void 0:n.loading});return t.then(c=>(Za.success(B1(e.success,c),{id:r,...n,...n==null?void 0:n.success}),c)).catch(c=>{Za.error(B1(e.error,c),{id:r,...n,...n==null?void 0:n.error})}),t};var COe=(t,e)=>{vg({type:1,toast:{id:t,height:e}})},ROe=()=>{vg({type:5,time:Date.now()})},IOe=t=>{let{toasts:e,pausedAt:n}=bOe(t);$.useEffect(()=>{if(n)return;let l=Date.now(),d=e.map(f=>{if(f.duration===1/0)return;let m=(f.duration||0)+f.pauseDuration-(l-f.createdAt);if(m<0){f.visible&&Za.dismiss(f.id);return}return setTimeout(()=>Za.dismiss(f.id),m)});return()=>{d.forEach(f=>f&&clearTimeout(f))}},[e,n]);let r=$.useCallback(()=>{n&&vg({type:6,time:Date.now()})},[n]),c=$.useCallback((l,d)=>{let{reverseOrder:f=!1,gutter:m=8,defaultPosition:E}=d||{},y=e.filter(P=>(P.position||E)===(l.position||E)&&P.height),w=y.findIndex(P=>P.id===l.id),I=y.filter((P,k)=>k<w&&P.visible).length;return y.filter(P=>P.visible).slice(...f?[I+1]:[0,I]).reduce((P,k)=>P+(k.height||0)+m,0)},[e]);return{toasts:e,handlers:{updateHeight:COe,startPause:ROe,endPause:r,calculateOffset:c}}},AOe=Hd`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,OOe=Hd`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,NOe=Hd`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,POe=tp("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${AOe} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${OOe} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${NOe} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,xOe=Hd`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,DOe=tp("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${xOe} 1s linear infinite;
`,kOe=Hd`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,LOe=Hd`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,MOe=tp("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${kOe} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${LOe} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,UOe=tp("div")`
  position: absolute;
`,jOe=tp("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,FOe=Hd`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,VOe=tp("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${FOe} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,BOe=({toast:t})=>{let{icon:e,type:n,iconTheme:r}=t;return e!==void 0?typeof e=="string"?$.createElement(VOe,null,e):e:n==="blank"?null:$.createElement(jOe,null,$.createElement(DOe,{...r}),n!=="loading"&&$.createElement(UOe,null,n==="error"?$.createElement(POe,{...r}):$.createElement(MOe,{...r})))},WOe=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,HOe=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,$Oe="0%{opacity:0;} 100%{opacity:1;}",zOe="0%{opacity:1;} 100%{opacity:0;}",GOe=tp("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,KOe=tp("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,qOe=(t,e)=>{let n=t.includes("top")?1:-1,[r,c]=Lne()?[$Oe,zOe]:[WOe(n),HOe(n)];return{animation:e?`${Hd(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Hd(c)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},YOe=$.memo(({toast:t,position:e,style:n,children:r})=>{let c=t.height?qOe(t.position||e||"top-center",t.visible):{opacity:0},l=$.createElement(BOe,{toast:t}),d=$.createElement(KOe,{...t.ariaProps},B1(t.message,t));return $.createElement(GOe,{className:t.className,style:{...c,...n,...t.style}},typeof r=="function"?r({icon:l,message:d}):$.createElement($.Fragment,null,l,d))});gOe($.createElement);var XOe=({id:t,className:e,style:n,onHeightUpdate:r,children:c})=>{let l=$.useCallback(d=>{if(d){let f=()=>{let m=d.getBoundingClientRect().height;r(t,m)};f(),new MutationObserver(f).observe(d,{subtree:!0,childList:!0,characterData:!0})}},[t,r]);return $.createElement("div",{ref:l,className:e,style:n},c)},JOe=(t,e)=>{let n=t.includes("top"),r=n?{top:0}:{bottom:0},c=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Lne()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(n?1:-1)}px)`,...r,...c}},QOe=CP`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,HA=16,ku=({reverseOrder:t,position:e="top-center",toastOptions:n,gutter:r,children:c,containerStyle:l,containerClassName:d})=>{let{toasts:f,handlers:m}=IOe(n);return $.createElement("div",{style:{position:"fixed",zIndex:9999,top:HA,left:HA,right:HA,bottom:HA,pointerEvents:"none",...l},className:d,onMouseEnter:m.startPause,onMouseLeave:m.endPause},f.map(E=>{let y=E.position||e,w=m.calculateOffset(E,{reverseOrder:t,gutter:r,defaultPosition:e}),I=JOe(y,w);return $.createElement(XOe,{id:E.id,key:E.id,onHeightUpdate:m.updateHeight,className:E.visible?QOe:"",style:I},E.type==="custom"?B1(E.message,E):c?c(E):$.createElement(YOe,{toast:E,position:y}))}))},fe=Za;const RP="/assets/logo-c19cefcc.png";function yg(t){this._maxSize=t,this.clear()}yg.prototype.clear=function(){this._size=0,this._values=Object.create(null)};yg.prototype.get=function(t){return this._values[t]};yg.prototype.set=function(t,e){return this._size>=this._maxSize&&this.clear(),t in this._values||this._size++,this._values[t]=e};var ZOe=/[^.^\]^[]+|(?=\[\]|\.\.)/g,Mne=/^\d+$/,e1e=/^\d/,t1e=/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/g,n1e=/^\s*(['"]?)(.*?)(\1)\s*$/,h5=512,HK=new yg(h5),$K=new yg(h5),zK=new yg(h5),zm={Cache:yg,split:cV,normalizePath:Kj,setter:function(t){var e=Kj(t);return $K.get(t)||$K.set(t,function(r,c){for(var l=0,d=e.length,f=r;l<d-1;){var m=e[l];if(m==="__proto__"||m==="constructor"||m==="prototype")return r;f=f[e[l++]]}f[e[l]]=c})},getter:function(t,e){var n=Kj(t);return zK.get(t)||zK.set(t,function(c){for(var l=0,d=n.length;l<d;)if(c!=null||!e)c=c[n[l++]];else return;return c})},join:function(t){return t.reduce(function(e,n){return e+(f5(n)||Mne.test(n)?"["+n+"]":(e?".":"")+n)},"")},forEach:function(t,e,n){i1e(Array.isArray(t)?t:cV(t),e,n)}};function Kj(t){return HK.get(t)||HK.set(t,cV(t).map(function(e){return e.replace(n1e,"$2")}))}function cV(t){return t.match(ZOe)||[""]}function i1e(t,e,n){var r=t.length,c,l,d,f;for(l=0;l<r;l++)c=t[l],c&&(o1e(c)&&(c='"'+c+'"'),f=f5(c),d=!f&&/^\d+$/.test(c),e.call(n,c,f,d,l,t))}function f5(t){return typeof t=="string"&&t&&["'",'"'].indexOf(t.charAt(0))!==-1}function r1e(t){return t.match(e1e)&&!t.match(Mne)}function s1e(t){return t1e.test(t)}function o1e(t){return!f5(t)&&(r1e(t)||s1e(t))}const a1e=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?:['’](?:d|ll|m|re|s|t|ve))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['’](?:D|LL|M|RE|S|T|VE))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['’](?:d|ll|m|re|s|t|ve))?|[A-Z\xc0-\xd6\xd8-\xde]+(?:['’](?:D|LL|M|RE|S|T|VE))?|\d*(?:1ST|2ND|3RD|(?![123])\dTH)(?=\b|[a-z_])|\d*(?:1st|2nd|3rd|(?![123])\dth)(?=\b|[A-Z_])|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,IP=t=>t.match(a1e)||[],AP=t=>t[0].toUpperCase()+t.slice(1),p5=(t,e)=>IP(t).join(e).toLowerCase(),Une=t=>IP(t).reduce((e,n)=>`${e}${e?n[0].toUpperCase()+n.slice(1).toLowerCase():n.toLowerCase()}`,""),c1e=t=>AP(Une(t)),l1e=t=>p5(t,"_"),u1e=t=>p5(t,"-"),d1e=t=>AP(p5(t," ")),h1e=t=>IP(t).map(AP).join(" ");var qj={words:IP,upperFirst:AP,camelCase:Une,pascalCase:c1e,snakeCase:l1e,kebabCase:u1e,sentenceCase:d1e,titleCase:h1e},m5={exports:{}};m5.exports=function(t){return jne(f1e(t),t)};m5.exports.array=jne;function jne(t,e){var n=t.length,r=new Array(n),c={},l=n,d=p1e(e),f=m1e(t);for(e.forEach(function(E){if(!f.has(E[0])||!f.has(E[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")});l--;)c[l]||m(t[l],l,new Set);return r;function m(E,y,w){if(w.has(E)){var I;try{I=", node was:"+JSON.stringify(E)}catch{I=""}throw new Error("Cyclic dependency"+I)}if(!f.has(E))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(E));if(!c[y]){c[y]=!0;var P=d.get(E)||new Set;if(P=Array.from(P),y=P.length){w.add(E);do{var k=P[--y];m(k,f.get(k),w)}while(y);w.delete(E)}r[--n]=E}}}function f1e(t){for(var e=new Set,n=0,r=t.length;n<r;n++){var c=t[n];e.add(c[0]),e.add(c[1])}return Array.from(e)}function p1e(t){for(var e=new Map,n=0,r=t.length;n<r;n++){var c=t[n];e.has(c[0])||e.set(c[0],new Set),e.has(c[1])||e.set(c[1],new Set),e.get(c[0]).add(c[1])}return e}function m1e(t){for(var e=new Map,n=0,r=t.length;n<r;n++)e.set(t[n],n);return e}var g1e=m5.exports;const _1e=Kf(g1e),E1e=Object.prototype.toString,v1e=Error.prototype.toString,y1e=RegExp.prototype.toString,S1e=typeof Symbol<"u"?Symbol.prototype.toString:()=>"",T1e=/^Symbol\((.*)\)(.*)$/;function b1e(t){return t!=+t?"NaN":t===0&&1/t<0?"-0":""+t}function GK(t,e=!1){if(t==null||t===!0||t===!1)return""+t;const n=typeof t;if(n==="number")return b1e(t);if(n==="string")return e?`"${t}"`:t;if(n==="function")return"[Function "+(t.name||"anonymous")+"]";if(n==="symbol")return S1e.call(t).replace(T1e,"Symbol($1)");const r=E1e.call(t).slice(8,-1);return r==="Date"?isNaN(t.getTime())?""+t:t.toISOString(t):r==="Error"||t instanceof Error?"["+v1e.call(t)+"]":r==="RegExp"?y1e.call(t):null}function jf(t,e){let n=GK(t,e);return n!==null?n:JSON.stringify(t,function(r,c){let l=GK(this[r],e);return l!==null?l:c},2)}function Fne(t){return t==null?[]:[].concat(t)}let Vne,w1e=/\$\{\s*(\w+)\s*\}/g;Vne=Symbol.toStringTag;class ya extends Error{static formatError(e,n){const r=n.label||n.path||"this";return r!==n.path&&(n=Object.assign({},n,{path:r})),typeof e=="string"?e.replace(w1e,(c,l)=>jf(n[l])):typeof e=="function"?e(n):e}static isError(e){return e&&e.name==="ValidationError"}constructor(e,n,r,c,l){super(),this.value=void 0,this.path=void 0,this.type=void 0,this.errors=void 0,this.params=void 0,this.inner=void 0,this[Vne]="Error",this.name="ValidationError",this.value=n,this.path=r,this.type=c,this.errors=[],this.inner=[],Fne(e).forEach(d=>{if(ya.isError(d)){this.errors.push(...d.errors);const f=d.inner.length?d.inner:[d];this.inner.push(...f)}else this.errors.push(d)}),this.message=this.errors.length>1?`${this.errors.length} errors occurred`:this.errors[0],!l&&Error.captureStackTrace&&Error.captureStackTrace(this,ya)}}let pu={default:"${path} is invalid",required:"${path} is a required field",defined:"${path} must be defined",notNull:"${path} cannot be null",oneOf:"${path} must be one of the following values: ${values}",notOneOf:"${path} must not be one of the following values: ${values}",notType:({path:t,type:e,value:n,originalValue:r})=>{const c=r!=null&&r!==n?` (cast from the value \`${jf(r,!0)}\`).`:".";return e!=="mixed"?`${t} must be a \`${e}\` type, but the final value was: \`${jf(n,!0)}\``+c:`${t} must match the configured type. The validated value was: \`${jf(n,!0)}\``+c}},ul={length:"${path} must be exactly ${length} characters",min:"${path} must be at least ${min} characters",max:"${path} must be at most ${max} characters",matches:'${path} must match the following: "${regex}"',email:"${path} must be a valid email",url:"${path} must be a valid URL",uuid:"${path} must be a valid UUID",trim:"${path} must be a trimmed string",lowercase:"${path} must be a lowercase string",uppercase:"${path} must be a upper case string"},C1e={min:"${path} must be greater than or equal to ${min}",max:"${path} must be less than or equal to ${max}",lessThan:"${path} must be less than ${less}",moreThan:"${path} must be greater than ${more}",positive:"${path} must be a positive number",negative:"${path} must be a negative number",integer:"${path} must be an integer"},lV={min:"${path} field must be later than ${min}",max:"${path} field must be at earlier than ${max}"},R1e={isValue:"${path} field must be ${value}"},uV={noUnknown:"${path} field has unspecified keys: ${unknown}"},I1e={min:"${path} field must have at least ${min} items",max:"${path} field must have less than or equal to ${max} items",length:"${path} must have ${length} items"},A1e={notType:t=>{const{path:e,value:n,spec:r}=t,c=r.types.length;if(Array.isArray(n)){if(n.length<c)return`${e} tuple value has too few items, expected a length of ${c} but got ${n.length} for value: \`${jf(n,!0)}\``;if(n.length>c)return`${e} tuple value has too many items, expected a length of ${c} but got ${n.length} for value: \`${jf(n,!0)}\``}return ya.formatError(pu.notType,t)}};Object.assign(Object.create(null),{mixed:pu,string:ul,number:C1e,date:lV,object:uV,array:I1e,boolean:R1e,tuple:A1e});const g5=t=>t&&t.__isYupSchema__;class W1{static fromOptions(e,n){if(!n.then&&!n.otherwise)throw new TypeError("either `then:` or `otherwise:` is required for `when()` conditions");let{is:r,then:c,otherwise:l}=n,d=typeof r=="function"?r:(...f)=>f.every(m=>m===r);return new W1(e,(f,m)=>{var E;let y=d(...f)?c:l;return(E=y==null?void 0:y(m))!=null?E:m})}constructor(e,n){this.fn=void 0,this.refs=e,this.refs=e,this.fn=n}resolve(e,n){let r=this.refs.map(l=>l.getValue(n==null?void 0:n.value,n==null?void 0:n.parent,n==null?void 0:n.context)),c=this.fn(r,e,n);if(c===void 0||c===e)return e;if(!g5(c))throw new TypeError("conditions must return a schema object");return c.resolve(n)}}const $A={context:"$",value:"."};function Bne(t,e){return new np(t,e)}class np{constructor(e,n={}){if(this.key=void 0,this.isContext=void 0,this.isValue=void 0,this.isSibling=void 0,this.path=void 0,this.getter=void 0,this.map=void 0,typeof e!="string")throw new TypeError("ref must be a string, got: "+e);if(this.key=e.trim(),e==="")throw new TypeError("ref must be a non-empty string");this.isContext=this.key[0]===$A.context,this.isValue=this.key[0]===$A.value,this.isSibling=!this.isContext&&!this.isValue;let r=this.isContext?$A.context:this.isValue?$A.value:"";this.path=this.key.slice(r.length),this.getter=this.path&&zm.getter(this.path,!0),this.map=n.map}getValue(e,n,r){let c=this.isContext?r:this.isValue?e:n;return this.getter&&(c=this.getter(c||{})),this.map&&(c=this.map(c)),c}cast(e,n){return this.getValue(e,n==null?void 0:n.parent,n==null?void 0:n.context)}resolve(){return this}describe(){return{type:"ref",key:this.key}}toString(){return`Ref(${this.key})`}static isRef(e){return e&&e.__isYupRef}}np.prototype.__isYupRef=!0;const Fm=t=>t==null;function EE(t){function e({value:n,path:r="",options:c,originalValue:l,schema:d},f,m){const{name:E,test:y,params:w,message:I,skipAbsent:P}=t;let{parent:k,context:M,abortEarly:K=d.spec.abortEarly,disableStackTrace:W=d.spec.disableStackTrace}=c;function V(je){return np.isRef(je)?je.getValue(n,k,M):je}function G(je={}){var Ge;const ze=Object.assign({value:n,originalValue:l,label:d.spec.label,path:je.path||r,spec:d.spec},w,je.params);for(const He of Object.keys(ze))ze[He]=V(ze[He]);const Ke=new ya(ya.formatError(je.message||I,ze),n,ze.path,je.type||E,(Ge=je.disableStackTrace)!=null?Ge:W);return Ke.params=ze,Ke}const Q=K?f:m;let Z={path:r,parent:k,type:E,from:c.from,createError:G,resolve:V,options:c,originalValue:l,schema:d};const Y=je=>{ya.isError(je)?Q(je):je?m(null):Q(G())},oe=je=>{ya.isError(je)?Q(je):f(je)};if(P&&Fm(n))return Y(!0);let Se;try{var xe;if(Se=y.call(Z,n,Z),typeof((xe=Se)==null?void 0:xe.then)=="function"){if(c.sync)throw new Error(`Validation test of type: "${Z.type}" returned a Promise during a synchronous validate. This test will finish after the validate call has returned`);return Promise.resolve(Se).then(Y,oe)}}catch(je){oe(je);return}Y(Se)}return e.OPTIONS=t,e}function O1e(t,e,n,r=n){let c,l,d;return e?(zm.forEach(e,(f,m,E)=>{let y=m?f.slice(1,f.length-1):f;t=t.resolve({context:r,parent:c,value:n});let w=t.type==="tuple",I=E?parseInt(y,10):0;if(t.innerType||w){if(w&&!E)throw new Error(`Yup.reach cannot implicitly index into a tuple type. the path part "${d}" must contain an index to the tuple element, e.g. "${d}[0]"`);if(n&&I>=n.length)throw new Error(`Yup.reach cannot resolve an array item at index: ${f}, in the path: ${e}. because there is no value at that index. `);c=n,n=n&&n[I],t=w?t.spec.types[I]:t.innerType}if(!E){if(!t.fields||!t.fields[y])throw new Error(`The schema does not contain the path: ${e}. (failed at: ${d} which is a type: "${t.type}")`);c=n,n=n&&n[y],t=t.fields[y]}l=y,d=m?"["+f+"]":"."+f}),{schema:t,parent:c,parentPath:l}):{parent:c,parentPath:e,schema:t}}class H1 extends Set{describe(){const e=[];for(const n of this.values())e.push(np.isRef(n)?n.describe():n);return e}resolveAll(e){let n=[];for(const r of this.values())n.push(e(r));return n}clone(){return new H1(this.values())}merge(e,n){const r=this.clone();return e.forEach(c=>r.add(c)),n.forEach(c=>r.delete(c)),r}}function WE(t,e=new Map){if(g5(t)||!t||typeof t!="object")return t;if(e.has(t))return e.get(t);let n;if(t instanceof Date)n=new Date(t.getTime()),e.set(t,n);else if(t instanceof RegExp)n=new RegExp(t),e.set(t,n);else if(Array.isArray(t)){n=new Array(t.length),e.set(t,n);for(let r=0;r<t.length;r++)n[r]=WE(t[r],e)}else if(t instanceof Map){n=new Map,e.set(t,n);for(const[r,c]of t.entries())n.set(r,WE(c,e))}else if(t instanceof Set){n=new Set,e.set(t,n);for(const r of t)n.add(WE(r,e))}else if(t instanceof Object){n={},e.set(t,n);for(const[r,c]of Object.entries(t))n[r]=WE(c,e)}else throw Error(`Unable to clone ${t}`);return n}class Au{constructor(e){this.type=void 0,this.deps=[],this.tests=void 0,this.transforms=void 0,this.conditions=[],this._mutate=void 0,this.internalTests={},this._whitelist=new H1,this._blacklist=new H1,this.exclusiveTests=Object.create(null),this._typeCheck=void 0,this.spec=void 0,this.tests=[],this.transforms=[],this.withMutation(()=>{this.typeError(pu.notType)}),this.type=e.type,this._typeCheck=e.check,this.spec=Object.assign({strip:!1,strict:!1,abortEarly:!0,recursive:!0,disableStackTrace:!1,nullable:!1,optional:!0,coerce:!0},e==null?void 0:e.spec),this.withMutation(n=>{n.nonNullable()})}get _type(){return this.type}clone(e){if(this._mutate)return e&&Object.assign(this.spec,e),this;const n=Object.create(Object.getPrototypeOf(this));return n.type=this.type,n._typeCheck=this._typeCheck,n._whitelist=this._whitelist.clone(),n._blacklist=this._blacklist.clone(),n.internalTests=Object.assign({},this.internalTests),n.exclusiveTests=Object.assign({},this.exclusiveTests),n.deps=[...this.deps],n.conditions=[...this.conditions],n.tests=[...this.tests],n.transforms=[...this.transforms],n.spec=WE(Object.assign({},this.spec,e)),n}label(e){let n=this.clone();return n.spec.label=e,n}meta(...e){if(e.length===0)return this.spec.meta;let n=this.clone();return n.spec.meta=Object.assign(n.spec.meta||{},e[0]),n}withMutation(e){let n=this._mutate;this._mutate=!0;let r=e(this);return this._mutate=n,r}concat(e){if(!e||e===this)return this;if(e.type!==this.type&&this.type!=="mixed")throw new TypeError(`You cannot \`concat()\` schema's of different types: ${this.type} and ${e.type}`);let n=this,r=e.clone();const c=Object.assign({},n.spec,r.spec);return r.spec=c,r.internalTests=Object.assign({},n.internalTests,r.internalTests),r._whitelist=n._whitelist.merge(e._whitelist,e._blacklist),r._blacklist=n._blacklist.merge(e._blacklist,e._whitelist),r.tests=n.tests,r.exclusiveTests=n.exclusiveTests,r.withMutation(l=>{e.tests.forEach(d=>{l.test(d.OPTIONS)})}),r.transforms=[...n.transforms,...r.transforms],r}isType(e){return e==null?!!(this.spec.nullable&&e===null||this.spec.optional&&e===void 0):this._typeCheck(e)}resolve(e){let n=this;if(n.conditions.length){let r=n.conditions;n=n.clone(),n.conditions=[],n=r.reduce((c,l)=>l.resolve(c,e),n),n=n.resolve(e)}return n}resolveOptions(e){var n,r,c,l;return Object.assign({},e,{from:e.from||[],strict:(n=e.strict)!=null?n:this.spec.strict,abortEarly:(r=e.abortEarly)!=null?r:this.spec.abortEarly,recursive:(c=e.recursive)!=null?c:this.spec.recursive,disableStackTrace:(l=e.disableStackTrace)!=null?l:this.spec.disableStackTrace})}cast(e,n={}){let r=this.resolve(Object.assign({value:e},n)),c=n.assert==="ignore-optionality",l=r._cast(e,n);if(n.assert!==!1&&!r.isType(l)){if(c&&Fm(l))return l;let d=jf(e),f=jf(l);throw new TypeError(`The value of ${n.path||"field"} could not be cast to a value that satisfies the schema type: "${r.type}". 

attempted value: ${d} 
`+(f!==d?`result of cast: ${f}`:""))}return l}_cast(e,n){let r=e===void 0?e:this.transforms.reduce((c,l)=>l.call(this,c,e,this),e);return r===void 0&&(r=this.getDefault(n)),r}_validate(e,n={},r,c){let{path:l,originalValue:d=e,strict:f=this.spec.strict}=n,m=e;f||(m=this._cast(m,Object.assign({assert:!1},n)));let E=[];for(let y of Object.values(this.internalTests))y&&E.push(y);this.runTests({path:l,value:m,originalValue:d,options:n,tests:E},r,y=>{if(y.length)return c(y,m);this.runTests({path:l,value:m,originalValue:d,options:n,tests:this.tests},r,c)})}runTests(e,n,r){let c=!1,{tests:l,value:d,originalValue:f,path:m,options:E}=e,y=M=>{c||(c=!0,n(M,d))},w=M=>{c||(c=!0,r(M,d))},I=l.length,P=[];if(!I)return w([]);let k={value:d,originalValue:f,path:m,options:E,schema:this};for(let M=0;M<l.length;M++){const K=l[M];K(k,y,function(V){V&&(Array.isArray(V)?P.push(...V):P.push(V)),--I<=0&&w(P)})}}asNestedTest({key:e,index:n,parent:r,parentPath:c,originalParent:l,options:d}){const f=e??n;if(f==null)throw TypeError("Must include `key` or `index` for nested validations");const m=typeof f=="number";let E=r[f];const y=Object.assign({},d,{strict:!0,parent:r,value:E,originalValue:l[f],key:void 0,[m?"index":"key"]:f,path:m||f.includes(".")?`${c||""}[${E?f:`"${f}"`}]`:(c?`${c}.`:"")+e});return(w,I,P)=>this.resolve(y)._validate(E,y,I,P)}validate(e,n){var r;let c=this.resolve(Object.assign({},n,{value:e})),l=(r=n==null?void 0:n.disableStackTrace)!=null?r:c.spec.disableStackTrace;return new Promise((d,f)=>c._validate(e,n,(m,E)=>{ya.isError(m)&&(m.value=E),f(m)},(m,E)=>{m.length?f(new ya(m,E,void 0,void 0,l)):d(E)}))}validateSync(e,n){var r;let c=this.resolve(Object.assign({},n,{value:e})),l,d=(r=n==null?void 0:n.disableStackTrace)!=null?r:c.spec.disableStackTrace;return c._validate(e,Object.assign({},n,{sync:!0}),(f,m)=>{throw ya.isError(f)&&(f.value=m),f},(f,m)=>{if(f.length)throw new ya(f,e,void 0,void 0,d);l=m}),l}isValid(e,n){return this.validate(e,n).then(()=>!0,r=>{if(ya.isError(r))return!1;throw r})}isValidSync(e,n){try{return this.validateSync(e,n),!0}catch(r){if(ya.isError(r))return!1;throw r}}_getDefault(e){let n=this.spec.default;return n==null?n:typeof n=="function"?n.call(this,e):WE(n)}getDefault(e){return this.resolve(e||{})._getDefault(e)}default(e){return arguments.length===0?this._getDefault():this.clone({default:e})}strict(e=!0){return this.clone({strict:e})}nullability(e,n){const r=this.clone({nullable:e});return r.internalTests.nullable=EE({message:n,name:"nullable",test(c){return c===null?this.schema.spec.nullable:!0}}),r}optionality(e,n){const r=this.clone({optional:e});return r.internalTests.optionality=EE({message:n,name:"optionality",test(c){return c===void 0?this.schema.spec.optional:!0}}),r}optional(){return this.optionality(!0)}defined(e=pu.defined){return this.optionality(!1,e)}nullable(){return this.nullability(!0)}nonNullable(e=pu.notNull){return this.nullability(!1,e)}required(e=pu.required){return this.clone().withMutation(n=>n.nonNullable(e).defined(e))}notRequired(){return this.clone().withMutation(e=>e.nullable().optional())}transform(e){let n=this.clone();return n.transforms.push(e),n}test(...e){let n;if(e.length===1?typeof e[0]=="function"?n={test:e[0]}:n=e[0]:e.length===2?n={name:e[0],test:e[1]}:n={name:e[0],message:e[1],test:e[2]},n.message===void 0&&(n.message=pu.default),typeof n.test!="function")throw new TypeError("`test` is a required parameters");let r=this.clone(),c=EE(n),l=n.exclusive||n.name&&r.exclusiveTests[n.name]===!0;if(n.exclusive&&!n.name)throw new TypeError("Exclusive tests must provide a unique `name` identifying the test");return n.name&&(r.exclusiveTests[n.name]=!!n.exclusive),r.tests=r.tests.filter(d=>!(d.OPTIONS.name===n.name&&(l||d.OPTIONS.test===c.OPTIONS.test))),r.tests.push(c),r}when(e,n){!Array.isArray(e)&&typeof e!="string"&&(n=e,e=".");let r=this.clone(),c=Fne(e).map(l=>new np(l));return c.forEach(l=>{l.isSibling&&r.deps.push(l.key)}),r.conditions.push(typeof n=="function"?new W1(c,n):W1.fromOptions(c,n)),r}typeError(e){let n=this.clone();return n.internalTests.typeError=EE({message:e,name:"typeError",skipAbsent:!0,test(r){return this.schema._typeCheck(r)?!0:this.createError({params:{type:this.schema.type}})}}),n}oneOf(e,n=pu.oneOf){let r=this.clone();return e.forEach(c=>{r._whitelist.add(c),r._blacklist.delete(c)}),r.internalTests.whiteList=EE({message:n,name:"oneOf",skipAbsent:!0,test(c){let l=this.schema._whitelist,d=l.resolveAll(this.resolve);return d.includes(c)?!0:this.createError({params:{values:Array.from(l).join(", "),resolved:d}})}}),r}notOneOf(e,n=pu.notOneOf){let r=this.clone();return e.forEach(c=>{r._blacklist.add(c),r._whitelist.delete(c)}),r.internalTests.blacklist=EE({message:n,name:"notOneOf",test(c){let l=this.schema._blacklist,d=l.resolveAll(this.resolve);return d.includes(c)?this.createError({params:{values:Array.from(l).join(", "),resolved:d}}):!0}}),r}strip(e=!0){let n=this.clone();return n.spec.strip=e,n}describe(e){const n=(e?this.resolve(e):this).clone(),{label:r,meta:c,optional:l,nullable:d}=n.spec;return{meta:c,label:r,optional:l,nullable:d,default:n.getDefault(e),type:n.type,oneOf:n._whitelist.describe(),notOneOf:n._blacklist.describe(),tests:n.tests.map(m=>({name:m.OPTIONS.name,params:m.OPTIONS.params})).filter((m,E,y)=>y.findIndex(w=>w.name===m.name)===E)}}}Au.prototype.__isYupSchema__=!0;for(const t of["validate","validateSync"])Au.prototype[`${t}At`]=function(e,n,r={}){const{parent:c,parentPath:l,schema:d}=O1e(this,e,n,r.context);return d[t](c&&c[l],Object.assign({},r,{parent:c,path:e}))};for(const t of["equals","is"])Au.prototype[t]=Au.prototype.oneOf;for(const t of["not","nope"])Au.prototype[t]=Au.prototype.notOneOf;let N1e=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,P1e=/^((https?|ftp):)?\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,x1e=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,D1e=t=>Fm(t)||t===t.trim(),k1e={}.toString();function To(){return new Wne}class Wne extends Au{constructor(){super({type:"string",check(e){return e instanceof String&&(e=e.valueOf()),typeof e=="string"}}),this.withMutation(()=>{this.transform((e,n,r)=>{if(!r.spec.coerce||r.isType(e)||Array.isArray(e))return e;const c=e!=null&&e.toString?e.toString():e;return c===k1e?e:c})})}required(e){return super.required(e).withMutation(n=>n.test({message:e||pu.required,name:"required",skipAbsent:!0,test:r=>!!r.length}))}notRequired(){return super.notRequired().withMutation(e=>(e.tests=e.tests.filter(n=>n.OPTIONS.name!=="required"),e))}length(e,n=ul.length){return this.test({message:n,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test(r){return r.length===this.resolve(e)}})}min(e,n=ul.min){return this.test({message:n,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(r){return r.length>=this.resolve(e)}})}max(e,n=ul.max){return this.test({name:"max",exclusive:!0,message:n,params:{max:e},skipAbsent:!0,test(r){return r.length<=this.resolve(e)}})}matches(e,n){let r=!1,c,l;return n&&(typeof n=="object"?{excludeEmptyString:r=!1,message:c,name:l}=n:c=n),this.test({name:l||"matches",message:c||ul.matches,params:{regex:e},skipAbsent:!0,test:d=>d===""&&r||d.search(e)!==-1})}email(e=ul.email){return this.matches(N1e,{name:"email",message:e,excludeEmptyString:!0})}url(e=ul.url){return this.matches(P1e,{name:"url",message:e,excludeEmptyString:!0})}uuid(e=ul.uuid){return this.matches(x1e,{name:"uuid",message:e,excludeEmptyString:!1})}ensure(){return this.default("").transform(e=>e===null?"":e)}trim(e=ul.trim){return this.transform(n=>n!=null?n.trim():n).test({message:e,name:"trim",test:D1e})}lowercase(e=ul.lowercase){return this.transform(n=>Fm(n)?n:n.toLowerCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:n=>Fm(n)||n===n.toLowerCase()})}uppercase(e=ul.uppercase){return this.transform(n=>Fm(n)?n:n.toUpperCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:n=>Fm(n)||n===n.toUpperCase()})}}To.prototype=Wne.prototype;const L1e=/^(\d{4}|[+-]\d{6})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:[ T]?(\d{2}):?(\d{2})(?::?(\d{2})(?:[,.](\d{1,}))?)?(?:(Z)|([+-])(\d{2})(?::?(\d{2}))?)?)?$/;function _d(t,e=0){return Number(t)||e}function M1e(t){const e=L1e.exec(t);if(!e)return Date.parse?Date.parse(t):Number.NaN;const n={year:_d(e[1]),month:_d(e[2],1)-1,day:_d(e[3],1),hour:_d(e[4]),minute:_d(e[5]),second:_d(e[6]),millisecond:e[7]?_d(e[7].substring(0,3)):0,z:e[8]||void 0,plusMinus:e[9]||void 0,hourOffset:_d(e[10]),minuteOffset:_d(e[11])};if(n.z===void 0&&n.plusMinus===void 0)return new Date(n.year,n.month,n.day,n.hour,n.minute,n.second,n.millisecond).valueOf();let r=0;return n.z!=="Z"&&n.plusMinus!==void 0&&(r=n.hourOffset*60+n.minuteOffset,n.plusMinus==="+"&&(r=0-r)),Date.UTC(n.year,n.month,n.day,n.hour,n.minute+r,n.second,n.millisecond)}let U1e=new Date(""),j1e=t=>Object.prototype.toString.call(t)==="[object Date]";class OP extends Au{constructor(){super({type:"date",check(e){return j1e(e)&&!isNaN(e.getTime())}}),this.withMutation(()=>{this.transform((e,n,r)=>!r.spec.coerce||r.isType(e)||e===null?e:(e=M1e(e),isNaN(e)?OP.INVALID_DATE:new Date(e)))})}prepareParam(e,n){let r;if(np.isRef(e))r=e;else{let c=this.cast(e);if(!this._typeCheck(c))throw new TypeError(`\`${n}\` must be a Date or a value that can be \`cast()\` to a Date`);r=c}return r}min(e,n=lV.min){let r=this.prepareParam(e,"min");return this.test({message:n,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(c){return c>=this.resolve(r)}})}max(e,n=lV.max){let r=this.prepareParam(e,"max");return this.test({message:n,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(c){return c<=this.resolve(r)}})}}OP.INVALID_DATE=U1e;OP.prototype;function F1e(t,e=[]){let n=[],r=new Set,c=new Set(e.map(([d,f])=>`${d}-${f}`));function l(d,f){let m=zm.split(d)[0];r.add(m),c.has(`${f}-${m}`)||n.push([f,m])}for(const d of Object.keys(t)){let f=t[d];r.add(d),np.isRef(f)&&f.isSibling?l(f.path,d):g5(f)&&"deps"in f&&f.deps.forEach(m=>l(m,d))}return _1e.array(Array.from(r),n).reverse()}function KK(t,e){let n=1/0;return t.some((r,c)=>{var l;if((l=e.path)!=null&&l.includes(r))return n=c,!0}),n}function Hne(t){return(e,n)=>KK(t,e)-KK(t,n)}const V1e=(t,e,n)=>{if(typeof t!="string")return t;let r=t;try{r=JSON.parse(t)}catch{}return n.isType(r)?r:t};function HO(t){if("fields"in t){const e={};for(const[n,r]of Object.entries(t.fields))e[n]=HO(r);return t.setFields(e)}if(t.type==="array"){const e=t.optional();return e.innerType&&(e.innerType=HO(e.innerType)),e}return t.type==="tuple"?t.optional().clone({types:t.spec.types.map(HO)}):"optional"in t?t.optional():t}const B1e=(t,e)=>{const n=[...zm.normalizePath(e)];if(n.length===1)return n[0]in t;let r=n.pop(),c=zm.getter(zm.join(n),!0)(t);return!!(c&&r in c)};let qK=t=>Object.prototype.toString.call(t)==="[object Object]";function W1e(t,e){let n=Object.keys(t.fields);return Object.keys(e).filter(r=>n.indexOf(r)===-1)}const H1e=Hne([]);function Vb(t){return new $ne(t)}class $ne extends Au{constructor(e){super({type:"object",check(n){return qK(n)||typeof n=="function"}}),this.fields=Object.create(null),this._sortErrors=H1e,this._nodes=[],this._excludedEdges=[],this.withMutation(()=>{e&&this.shape(e)})}_cast(e,n={}){var r;let c=super._cast(e,n);if(c===void 0)return this.getDefault(n);if(!this._typeCheck(c))return c;let l=this.fields,d=(r=n.stripUnknown)!=null?r:this.spec.noUnknown,f=[].concat(this._nodes,Object.keys(c).filter(w=>!this._nodes.includes(w))),m={},E=Object.assign({},n,{parent:m,__validating:n.__validating||!1}),y=!1;for(const w of f){let I=l[w],P=w in c;if(I){let k,M=c[w];E.path=(n.path?`${n.path}.`:"")+w,I=I.resolve({value:M,context:n.context,parent:m});let K=I instanceof Au?I.spec:void 0,W=K==null?void 0:K.strict;if(K!=null&&K.strip){y=y||w in c;continue}k=!n.__validating||!W?I.cast(c[w],E):c[w],k!==void 0&&(m[w]=k)}else P&&!d&&(m[w]=c[w]);(P!==w in m||m[w]!==c[w])&&(y=!0)}return y?m:c}_validate(e,n={},r,c){let{from:l=[],originalValue:d=e,recursive:f=this.spec.recursive}=n;n.from=[{schema:this,value:d},...l],n.__validating=!0,n.originalValue=d,super._validate(e,n,r,(m,E)=>{if(!f||!qK(E)){c(m,E);return}d=d||E;let y=[];for(let w of this._nodes){let I=this.fields[w];!I||np.isRef(I)||y.push(I.asNestedTest({options:n,key:w,parent:E,parentPath:n.path,originalParent:d}))}this.runTests({tests:y,value:E,originalValue:d,options:n},r,w=>{c(w.sort(this._sortErrors).concat(m),E)})})}clone(e){const n=super.clone(e);return n.fields=Object.assign({},this.fields),n._nodes=this._nodes,n._excludedEdges=this._excludedEdges,n._sortErrors=this._sortErrors,n}concat(e){let n=super.concat(e),r=n.fields;for(let[c,l]of Object.entries(this.fields)){const d=r[c];r[c]=d===void 0?l:d}return n.withMutation(c=>c.setFields(r,[...this._excludedEdges,...e._excludedEdges]))}_getDefault(e){if("default"in this.spec)return super._getDefault(e);if(!this._nodes.length)return;let n={};return this._nodes.forEach(r=>{var c;const l=this.fields[r];let d=e;(c=d)!=null&&c.value&&(d=Object.assign({},d,{parent:d.value,value:d.value[r]})),n[r]=l&&"getDefault"in l?l.getDefault(d):void 0}),n}setFields(e,n){let r=this.clone();return r.fields=e,r._nodes=F1e(e,n),r._sortErrors=Hne(Object.keys(e)),n&&(r._excludedEdges=n),r}shape(e,n=[]){return this.clone().withMutation(r=>{let c=r._excludedEdges;return n.length&&(Array.isArray(n[0])||(n=[n]),c=[...r._excludedEdges,...n]),r.setFields(Object.assign(r.fields,e),c)})}partial(){const e={};for(const[n,r]of Object.entries(this.fields))e[n]="optional"in r&&r.optional instanceof Function?r.optional():r;return this.setFields(e)}deepPartial(){return HO(this)}pick(e){const n={};for(const r of e)this.fields[r]&&(n[r]=this.fields[r]);return this.setFields(n)}omit(e){const n=Object.assign({},this.fields);for(const r of e)delete n[r];return this.setFields(n)}from(e,n,r){let c=zm.getter(e,!0);return this.transform(l=>{if(!l)return l;let d=l;return B1e(l,e)&&(d=Object.assign({},l),r||delete d[e],d[n]=c(l)),d})}json(){return this.transform(V1e)}noUnknown(e=!0,n=uV.noUnknown){typeof e!="boolean"&&(n=e,e=!0);let r=this.test({name:"noUnknown",exclusive:!0,message:n,test(c){if(c==null)return!0;const l=W1e(this.schema,c);return!e||l.length===0||this.createError({params:{unknown:l.join(", ")}})}});return r.spec.noUnknown=e,r}unknown(e=!0,n=uV.noUnknown){return this.noUnknown(!e,n)}transformKeys(e){return this.transform(n=>{if(!n)return n;const r={};for(const c of Object.keys(n))r[e(c)]=n[c];return r})}camelCase(){return this.transformKeys(qj.camelCase)}snakeCase(){return this.transformKeys(qj.snakeCase)}constantCase(){return this.transformKeys(e=>qj.snakeCase(e).toUpperCase())}describe(e){let n=super.describe(e);n.fields={};for(const[c,l]of Object.entries(this.fields)){var r;let d=e;(r=d)!=null&&r.value&&(d=Object.assign({},d,{parent:d.value,value:d.value[c]})),n.fields[c]=l.describe(d)}return n}}Vb.prototype=$ne.prototype;const $1e=Vb().shape({username:To().trim().min(5,"Minimum 5 characters are required for username").max(20,"Cannot exceed 20 characters").required("Username cannot be empty"),password:To().trim().min(8,"Minimum 6 characters required").matches(/^(?=.*[a-zA-Z])(?=.*\d)/,"Password must contain at least one letter","and one number").required("Password cannot be empty")}),z1e=Vb().shape({fullname:To().trim().min(5,"Minimum 5 characters required").max(20,"Cannot exceed 20 characters").required("Fullname cannot be empty"),username:To().trim().min(5,"Minimum 5 characters are required for username").max(20,"Cannot exceed 20 characters").required("Username cannot be empty"),password:To().trim().min(8,"Minimum 6 characters required").matches(/^(?=.*[a-zA-Z])(?=.*\d)/,"Password must contain at least one letter","and one number").required("Password cannot be empty"),confPassword:To().oneOf([Bne("password"),null],"Confirm password is not same").required("Confirm password is required"),email:To().trim().email("Invalid email fromat").required("email cannot be empty"),phone:To().trim().matches(/^[0-9]{10}$/,"Phone must be a 10-digit number").required("Phone cannot be empty"),verifyOtp:To().trim().matches(/^[0-9]{6}$/,"OTP must be a 8-digit number").required("OTP cannot be empty")}),G1e=()=>{const[t,e]=$.useState(!0),n=Ia(),r=bi(),c=()=>{e(!t)},l=async()=>{try{const d=new wd,f=eOe(rOe),{_tokenResponse:m}=await lAe(f,d);console.log(m);const E={username:`${m.firstName}_${m.lastName}`,fullname:m.displayName,password:m.idToken,email:m.email,profileimage:m.photoUrl};try{const y=await r(xye(E));return y.success?fe.success(R.jsx("b",{children:"Logined..!"})):y.error==="User is blocked."?fe.error(R.jsx("b",{children:"User is blocked! Contact admin for assistance!"})):fe.error(R.jsx("b",{children:"Invalid Credentials."}))}catch(y){fe.error("Somethig went wrong!"),console.error("An error occurred:",y)}}catch(d){console.log("cannot sign in with google",d)}};return R.jsxs("div",{className:"Auth",children:[R.jsx(ku,{position:"top-center",reverseOrder:!1}),R.jsxs("div",{className:"a-left",onClick:()=>n("/auth"),children:[R.jsx("img",{src:RP,alt:""}),R.jsxs("div",{className:"Webname",children:[R.jsx("h1",{children:"BuzzGram"}),R.jsx("h6",{children:"Explore the ideas throughout the world"})]})]}),t?R.jsx(zne,{toggleForm:c,handleGoogleClick:l}):R.jsx(Gne,{toggleForm:c,handleGoogleClick:l})]})};function zne({toggleForm:t,handleGoogleClick:e}){const n=Si(l=>l.authReducer.loading),r=bi(),c=XN({initialValues:{username:"",password:""},validationSchema:$1e,validateOnBlur:!0,validateOnChange:!0,onSubmit:async l=>{l=await Object.assign(l);try{const d=await r(Pye(l));return d.success?fe.success(R.jsx("b",{children:"Login Successfull..!"})):d.error==="User is blocked."?fe.error(R.jsx("b",{children:"User is blocked! Contact admin for assistance!"})):fe.error(R.jsx("b",{children:"Invalid Credentials."}))}catch(d){fe.error("Somethig went wrong!"),console.error("An error occurred:",d)}}});return R.jsx(dn.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{duration:.5},className:"a-right",children:R.jsxs("form",{className:"infoForm authForm position-relative",onSubmit:c.handleSubmit,children:[R.jsx("h3",{children:"Log In"}),R.jsxs("div",{style:{display:"flow"},children:[R.jsx("input",{...c.getFieldProps("username"),type:"text",placeholder:"Username",className:"infoInput",name:"username"}),c.touched.username&&c.errors.username&&R.jsx("div",{style:{color:"red"},children:c.errors.username})]}),R.jsxs("div",{style:{display:"flow"},children:[R.jsx("input",{...c.getFieldProps("password"),type:"password",className:"infoInput",placeholder:"Password",name:"password"}),c.touched.password&&c.errors.password&&R.jsx("div",{style:{color:"red"},children:c.errors.password})]}),R.jsx(df,{to:"/forgot-password",className:"forgot-pass",children:"forgot password?"}),R.jsxs("div",{className:"pt-3",children:[R.jsxs("span",{style:{fontSize:"12px"},children:["Don't have an account?"," ",R.jsx("button",{onClick:t,children:R.jsx("b",{children:"Signup"})})]}),R.jsx("button",{type:"submit",className:"button infoButton",disabled:n,children:n?"login...":"Login"})]}),R.jsx(dn.button,{type:"button",disabled:n,whileHover:{scale:1.1},whileTap:{scale:.9},transition:{type:"spring",stiffness:400,damping:17},onClick:e,className:"login-with-google-btn",children:"Sign in with Google"})]})})}zne.propTypes={toggleForm:Le.func.isRequired,handleGoogleClick:Le.func.isRequired};function Gne({toggleForm:t,handleGoogleClick:e}){const n=Si(V=>V.authReducer.loading),r=Si(V=>V.authReducer.error),c=bi(),l=$.useRef(null),d=$.useRef(null),[f,m]=$.useState(!1),[E,y]=$.useState(!1),[w,I]=$.useState(!1),[P,k]=$.useState(30);$.useEffect(()=>{let V;return f&&P>0&&w?V=setInterval(()=>{k(G=>G-1)},1e3):P===0&&I(!1),()=>{clearInterval(V)}},[f,P,w]);const M=async V=>{var Q,Z;if(V.preventDefault(),l.current.value.length===10)try{const Y=await Aye({phone:l.current.value});console.log(Y.data),Y.status==200?(fe.success(R.jsx("b",{children:Y.data.message})),m(!0),k(30),I(!0)):fe.error(R.jsx("b",{children:Y.data.error}))}catch(Y){fe.error(R.jsx("b",{children:(Q=Y.response)!=null&&Q.data.error?(Z=Y.response)==null?void 0:Z.data.error:"Something went wrong!"})),console.log(Y)}},K=async V=>{var G,Q;V.preventDefault();try{const Z=await eee(l.current.value,d.current.value);Z.status==200?(y(!0),fe.success(R.jsx("b",{children:Z.data.message}))):fe.error(R.jsx("b",{children:Z.data.error}))}catch(Z){fe.error(R.jsx("b",{children:(G=Z.response)!=null&&G.data.error?(Q=Z.response)==null?void 0:Q.data.error:"Something went wrong!"})),console.log(Z)}},W=XN({initialValues:{fullname:"",username:"",password:"",confPassword:"",email:"",phone:"",verifyOtp:""},validationSchema:z1e,validateOnBlur:!0,validateOnChange:!0,onSubmit:async V=>{if(V=await Object.assign(V),!E)return fe.error(R.jsx("b",{children:"Verify Otp first"}));try{(await c(kye(V))).success?(k(0),fe.success(R.jsx("b",{children:"Registered Successfully...!"}))):fe.error(r)}catch(G){console.error("An error occurred:",G)}}});return R.jsx(dn.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{duration:.5},className:"a-right signup",children:R.jsxs("form",{className:"infoForm authForm",onSubmit:W.handleSubmit,children:[R.jsx("h3",{children:"Sign Up"}),R.jsxs("div",{style:{display:"flow"},children:[R.jsx("input",{...W.getFieldProps("fullname"),type:"text",placeholder:"FullName",className:"infoInput",name:"fullname"}),W.touched.fullname&&W.errors.fullname&&R.jsx("div",{style:{color:"red"},children:W.errors.fullname})]}),R.jsxs("div",{style:{display:"flow"},children:[R.jsx("input",{...W.getFieldProps("username"),type:"text",placeholder:"Username",className:"infoInput",name:"username"}),W.touched.username&&W.errors.username&&R.jsx("div",{style:{color:"red"},children:W.errors.username})]}),R.jsxs("div",{style:{display:"flow"},children:[R.jsx("input",{...W.getFieldProps("password"),type:"password",className:"infoInput",placeholder:"Password",name:"password"}),W.touched.password&&W.errors.password&&R.jsx("div",{style:{color:"red"},children:W.errors.password})]}),R.jsxs("div",{style:{display:"flow"},children:[R.jsx("input",{...W.getFieldProps("confPassword"),type:"password",className:"infoInput",placeholder:"Confirm password",name:"confPassword"}),W.touched.confPassword&&W.errors.confPassword&&R.jsx("div",{style:{color:"red"},children:W.errors.confPassword})]}),R.jsxs("div",{style:{display:"flow"},children:[R.jsx("input",{...W.getFieldProps("email"),type:"email",className:"infoInput",placeholder:"email",name:"email"}),W.touched.email&&W.errors.email&&R.jsx("div",{style:{color:"red"},children:W.errors.email})]}),R.jsxs("div",{style:{display:"flow"},children:[R.jsxs("div",{className:"otp-setup",children:[R.jsx("input",{...W.getFieldProps("phone"),ref:l,type:"text",className:"infoInput",placeholder:"Phone",name:"phone"}),!w&&R.jsx("button",{className:"button otp",onClick:V=>M(V),children:R.jsx("span",{children:"OTP"})})]}),W.touched.phone&&W.errors.phone&&R.jsx("div",{style:{color:"red"},children:W.errors.phone}),w&&R.jsxs("span",{style:{fontSize:"0.8rem"},children:["Resend OTP in ",P,"s"]})]}),f&&R.jsxs("div",{style:{display:"flow"},children:[R.jsxs("div",{className:"otp-setup",children:[R.jsx("input",{...W.getFieldProps("verifyOtp"),ref:d,type:"text",className:"infoInput",placeholder:"Verify OTP",name:"verifyOtp"}),R.jsx("button",{className:"button otp",onClick:V=>K(V),children:R.jsx("span",{className:"material-symbols-outlined",children:"task_alt"})})]}),W.touched.verifyOtp&&W.errors.verifyOtp&&R.jsx("div",{style:{color:"red"},children:W.errors.verifyOtp})]}),R.jsxs("div",{children:[R.jsxs("span",{style:{fontSize:"12px"},children:["Already have an account?"," ",R.jsx("button",{onClick:t,children:R.jsx("b",{children:"Login"})})]}),R.jsx("button",{type:"submit",className:"button infoButton",disabled:n,children:n?"Signing...":"SignUp"})]}),R.jsx(dn.button,{type:"button",disabled:n,className:"login-with-google-btn",onClick:e,whileHover:{scale:1.1},whileTap:{scale:.9},transition:{type:"spring",stiffness:400,damping:17},children:"Sign in with Google"})]})})}Gne.propTypes={toggleForm:Le.func.isRequired,handleGoogleClick:Le.func.isRequired};const K1e=Vb().shape({adminName:To().trim().min(5,"Minimum 5 characters are required for username").max(20,"Cannot exceed 20 characters").required("Admin name cannot be empty"),password:To().trim().required("Password cannot be empty")}),q1e=()=>R.jsxs("div",{className:"Auth",children:[R.jsxs("div",{className:"a-left",children:[R.jsx("img",{src:RP,alt:""}),R.jsxs("div",{className:"Webname",children:[R.jsx("h1",{children:"BuzzGram"}),R.jsx("h6",{children:"Explore the ideas throughout the world"})]})]}),R.jsx(Y1e,{})]});function Y1e(){const t=Si(r=>r.authReducer.adminLoading),e=bi(),n=XN({initialValues:{adminName:"",password:""},validationSchema:K1e,validateOnBlur:!0,validateOnChange:!0,onSubmit:async r=>{r=await Object.assign(r);try{(await e(Dye(r))).success?fe.success(R.jsx("b",{children:"Login Successfull..!"})):fe.error(R.jsx("b",{children:"Login failed. Please check your credentials."}))}catch(c){fe.error("Somethig went wrong!"),console.error("An error occurred:",c)}}});return R.jsxs("div",{className:"a-right",children:[R.jsx(ku,{position:"top-center",reverseOrder:!1}),R.jsxs("form",{className:"infoForm authForm",onSubmit:n.handleSubmit,children:[R.jsx("h3",{children:"Log In"}),R.jsxs("div",{style:{display:"flow"},children:[R.jsx("input",{...n.getFieldProps("adminName"),type:"text",placeholder:"Admin Name",className:"infoInput",name:"adminName"}),n.touched.adminName&&n.errors.adminName&&R.jsx("div",{style:{color:"red"},children:n.errors.adminName})]}),R.jsxs("div",{style:{display:"flow"},children:[R.jsx("input",{...n.getFieldProps("password"),type:"password",className:"infoInput",placeholder:"Password",name:"password"}),n.touched.password&&n.errors.password&&R.jsx("div",{style:{color:"red"},children:n.errors.password})]}),R.jsx("div",{children:R.jsx("button",{type:"submit",className:"button infoButton",disabled:t,children:t?"login...":"Login"})})]})]})}const ip=()=>{const t=I4.create({baseURL:"https://buzzgram.online/api"});return t.interceptors.request.use(e=>{const n=localStorage.getItem("profile");return n&&(e.headers.Authorization=`Bearer ${JSON.parse(n).token}`),e}),t},_5=()=>{const t=I4.create({baseURL:"https://buzzgram.online/api"});return t.interceptors.request.use(e=>{const n=localStorage.getItem("admin");return n&&(e.headers.Authorization=`Bearer ${JSON.parse(n).token}`),e}),t},Lu=ip(),E5=t=>Lu.get(`/user/${t}`),X1e=()=>Lu.get("/user/"),J1e=(t,e)=>Lu.put(`/user/${t}`,e),Q1e=(t,e)=>Lu.put(`/user/${t}/profile`,{profileimage:e}),Z1e=(t,e)=>Lu.put(`/user/${t}/cover`,{coverimage:e}),eNe=(t,e)=>Lu.put(`/user/${t}/follow`,{curUserId:e}),tNe=(t,e)=>Lu.put(`/user/${t}/unfollow`,{curUserId:e}),nNe=t=>Lu.get(`/user/search?q=${t}`),iNe=t=>Lu.get(`/user/${t}/followers`),rNe=t=>Lu.get(`/user/${t}/following`),v5=ip(),ng=t=>v5.post("/notification/",t),YK=t=>v5.get(`/notification/${t}`),sNe=t=>v5.patch(`/notification/${t}`);var $1={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */$1.exports;(function(t,e){(function(){var n,r="4.17.21",c=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",d="Expected a function",f="Invalid `variable` option passed into `_.template`",m="__lodash_hash_undefined__",E=500,y="__lodash_placeholder__",w=1,I=2,P=4,k=1,M=2,K=1,W=2,V=4,G=8,Q=16,Z=32,Y=64,oe=128,ce=256,Se=512,xe=30,je="...",Ge=800,ze=16,Ke=1,He=2,be=3,Oe=1/0,_e=9007199254740991,We=17976931348623157e292,Ie=0/0,De=4294967295,Ue=De-1,rt=De>>>1,gt=[["ary",oe],["bind",K],["bindKey",W],["curry",G],["curryRight",Q],["flip",Se],["partial",Z],["partialRight",Y],["rearg",ce]],ft="[object Arguments]",Ft="[object Array]",qt="[object AsyncFunction]",ti="[object Boolean]",Vt="[object Date]",xn="[object DOMException]",En="[object Error]",Di="[object Function]",ui="[object GeneratorFunction]",rn="[object Map]",Rn="[object Number]",us="[object Null]",di="[object Object]",Go="[object Promise]",qr="[object Proxy]",Zi="[object RegExp]",wi="[object Set]",Ne="[object String]",dt="[object Symbol]",Et="[object Undefined]",st="[object WeakMap]",Ot="[object WeakSet]",Qt="[object ArrayBuffer]",kt="[object DataView]",Lt="[object Float32Array]",Ut="[object Float64Array]",Dn="[object Int8Array]",xt="[object Int16Array]",Mt="[object Int32Array]",Nt="[object Uint8Array]",ni="[object Uint8ClampedArray]",vs="[object Uint16Array]",Ci="[object Uint32Array]",bg=/\b__p \+= '';/g,sp=/\b(__p \+=) '' \+/g,op=/(__e\(.*?\)|\b__t\)) \+\n'';/g,sn=/&(?:amp|lt|gt|quot|#39);/g,hn=/[&<>"']/g,wr=RegExp(sn.source),Yr=RegExp(hn.source),Ko=/<%-([\s\S]+?)%>/g,Xs=/<%([\s\S]+?)%>/g,ap=/<%=([\s\S]+?)%>/g,QP=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Wv=/^\w*$/,Hv=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Jd=/[\\^$.*+?()[\]{}|]/g,ZP=RegExp(Jd.source),dr=/^\s+/,cp=/\s/,lc=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ex=/\{\n\/\* \[wrapped with (.+)\] \*/,wg=/,? & /,ys=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,$v=/[()=,{}\[\]\/\s]/,Jb=/\\(\\)?/g,Qb=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Zb=/\w*$/,Cl=/^[-+]0x[0-9a-f]+$/i,Cg=/^0b[01]+$/i,Uu=/^\[object .+?Constructor\]$/,tx=/^0o[0-7]+$/i,nx=/^(?:0|[1-9]\d*)$/,zv=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Rg=/($^)/,Gv=/['\n\r\u2028\u2029\\]/g,ju="\\ud800-\\udfff",ix="\\u0300-\\u036f",rx="\\ufe20-\\ufe2f",lp="\\u20d0-\\u20ff",ew=ix+rx+lp,tw="\\u2700-\\u27bf",Rl="a-z\\xdf-\\xf6\\xf8-\\xff",nw="\\xac\\xb1\\xd7\\xf7",sx="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",qo="\\u2000-\\u206f",Fu=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ig="A-Z\\xc0-\\xd6\\xd8-\\xde",Ag="\\ufe0e\\ufe0f",iw=nw+sx+qo+Fu,Og="['’]",Js="["+ju+"]",Il="["+iw+"]",up="["+ew+"]",Ng="\\d+",rw="["+tw+"]",Kv="["+Rl+"]",qv="[^"+ju+iw+Ng+tw+Rl+Ig+"]",Pg="\\ud83c[\\udffb-\\udfff]",Vu="(?:"+up+"|"+Pg+")",Yv="[^"+ju+"]",Xv="(?:\\ud83c[\\udde6-\\uddff]){2}",Jv="[\\ud800-\\udbff][\\udc00-\\udfff]",Aa="["+Ig+"]",Qv="\\u200d",sw="(?:"+Kv+"|"+qv+")",ox="(?:"+Aa+"|"+qv+")",ow="(?:"+Og+"(?:d|ll|m|re|s|t|ve))?",aw="(?:"+Og+"(?:D|LL|M|RE|S|T|VE))?",Qd=Vu+"?",cw="["+Ag+"]?",Zd="(?:"+Qv+"(?:"+[Yv,Xv,Jv].join("|")+")"+cw+Qd+")*",ax="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",cx="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",lw=cw+Qd+Zd,Yo="(?:"+[rw,Xv,Jv].join("|")+")"+lw,lx="(?:"+[Yv+up+"?",up,Xv,Jv,Js].join("|")+")",ux=RegExp(Og,"g"),Zv=RegExp(up,"g"),dp=RegExp(Pg+"(?="+Pg+")|"+lx+lw,"g"),ey=RegExp([Aa+"?"+Kv+"+"+ow+"(?="+[Il,Aa,"$"].join("|")+")",ox+"+"+aw+"(?="+[Il,Aa+sw,"$"].join("|")+")",Aa+"?"+sw+"+"+ow,Aa+"+"+aw,cx,ax,Ng,Yo].join("|"),"g"),ty=RegExp("["+Qv+ju+ew+Ag+"]"),dx=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,uw=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],dw=-1,ki={};ki[Lt]=ki[Ut]=ki[Dn]=ki[xt]=ki[Mt]=ki[Nt]=ki[ni]=ki[vs]=ki[Ci]=!0,ki[ft]=ki[Ft]=ki[Qt]=ki[ti]=ki[kt]=ki[Vt]=ki[En]=ki[Di]=ki[rn]=ki[Rn]=ki[di]=ki[Zi]=ki[wi]=ki[Ne]=ki[st]=!1;var Ri={};Ri[ft]=Ri[Ft]=Ri[Qt]=Ri[kt]=Ri[ti]=Ri[Vt]=Ri[Lt]=Ri[Ut]=Ri[Dn]=Ri[xt]=Ri[Mt]=Ri[rn]=Ri[Rn]=Ri[di]=Ri[Zi]=Ri[wi]=Ri[Ne]=Ri[dt]=Ri[Nt]=Ri[ni]=Ri[vs]=Ri[Ci]=!0,Ri[En]=Ri[Di]=Ri[st]=!1;var hw={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},ny={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},fw={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},eh={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},hx=parseFloat,fx=parseInt,Al=typeof Gt=="object"&&Gt&&Gt.Object===Object&&Gt,px=typeof self=="object"&&self&&self.Object===Object&&self,ds=Al||px||Function("return this")(),Xr=e&&!e.nodeType&&e,Bu=Xr&&!0&&t&&!t.nodeType&&t,pw=Bu&&Bu.exports===Xr,iy=pw&&Al.process,Xo=function(){try{var we=Bu&&Bu.require&&Bu.require("util").types;return we||iy&&iy.binding&&iy.binding("util")}catch{}}(),xg=Xo&&Xo.isArrayBuffer,mw=Xo&&Xo.isDate,ry=Xo&&Xo.isMap,gw=Xo&&Xo.isRegExp,_w=Xo&&Xo.isSet,Ew=Xo&&Xo.isTypedArray;function Jr(we,$e,Pe){switch(Pe.length){case 0:return we.call($e);case 1:return we.call($e,Pe[0]);case 2:return we.call($e,Pe[0],Pe[1]);case 3:return we.call($e,Pe[0],Pe[1],Pe[2])}return we.apply($e,Pe)}function sy(we,$e,Pe,vt){for(var on=-1,Xn=we==null?0:we.length;++on<Xn;){var Mr=we[on];$e(vt,Mr,Pe(Mr),we)}return vt}function Jo(we,$e){for(var Pe=-1,vt=we==null?0:we.length;++Pe<vt&&$e(we[Pe],Pe,we)!==!1;);return we}function Wi(we,$e){for(var Pe=we==null?0:we.length;Pe--&&$e(we[Pe],Pe,we)!==!1;);return we}function vw(we,$e){for(var Pe=-1,vt=we==null?0:we.length;++Pe<vt;)if(!$e(we[Pe],Pe,we))return!1;return!0}function Bc(we,$e){for(var Pe=-1,vt=we==null?0:we.length,on=0,Xn=[];++Pe<vt;){var Mr=we[Pe];$e(Mr,Pe,we)&&(Xn[on++]=Mr)}return Xn}function hp(we,$e){var Pe=we==null?0:we.length;return!!Pe&&nh(we,$e,0)>-1}function oy(we,$e,Pe){for(var vt=-1,on=we==null?0:we.length;++vt<on;)if(Pe($e,we[vt]))return!0;return!1}function Hi(we,$e){for(var Pe=-1,vt=we==null?0:we.length,on=Array(vt);++Pe<vt;)on[Pe]=$e(we[Pe],Pe,we);return on}function Ol(we,$e){for(var Pe=-1,vt=$e.length,on=we.length;++Pe<vt;)we[on+Pe]=$e[Pe];return we}function ay(we,$e,Pe,vt){var on=-1,Xn=we==null?0:we.length;for(vt&&Xn&&(Pe=we[++on]);++on<Xn;)Pe=$e(Pe,we[on],on,we);return Pe}function mx(we,$e,Pe,vt){var on=we==null?0:we.length;for(vt&&on&&(Pe=we[--on]);on--;)Pe=$e(Pe,we[on],on,we);return Pe}function cy(we,$e){for(var Pe=-1,vt=we==null?0:we.length;++Pe<vt;)if($e(we[Pe],Pe,we))return!0;return!1}var Dg=uy("length");function yw(we){return we.split("")}function ly(we){return we.match(ys)||[]}function Sw(we,$e,Pe){var vt;return Pe(we,function(on,Xn,Mr){if($e(on,Xn,Mr))return vt=Xn,!1}),vt}function th(we,$e,Pe,vt){for(var on=we.length,Xn=Pe+(vt?1:-1);vt?Xn--:++Xn<on;)if($e(we[Xn],Xn,we))return Xn;return-1}function nh(we,$e,Pe){return $e===$e?Sx(we,$e,Pe):th(we,bw,Pe)}function Tw(we,$e,Pe,vt){for(var on=Pe-1,Xn=we.length;++on<Xn;)if(vt(we[on],$e))return on;return-1}function bw(we){return we!==we}function ww(we,$e){var Pe=we==null?0:we.length;return Pe?hy(we,$e)/Pe:Ie}function uy(we){return function($e){return $e==null?n:$e[we]}}function dy(we){return function($e){return we==null?n:we[$e]}}function Cw(we,$e,Pe,vt,on){return on(we,function(Xn,Mr,gi){Pe=vt?(vt=!1,Xn):$e(Pe,Xn,Mr,gi)}),Pe}function gx(we,$e){var Pe=we.length;for(we.sort($e);Pe--;)we[Pe]=we[Pe].value;return we}function hy(we,$e){for(var Pe,vt=-1,on=we.length;++vt<on;){var Xn=$e(we[vt]);Xn!==n&&(Pe=Pe===n?Xn:Pe+Xn)}return Pe}function fy(we,$e){for(var Pe=-1,vt=Array(we);++Pe<we;)vt[Pe]=$e(Pe);return vt}function Rw(we,$e){return Hi($e,function(Pe){return[Pe,we[Pe]]})}function Iw(we){return we&&we.slice(0,my(we)+1).replace(dr,"")}function Ao(we){return function($e){return we($e)}}function py(we,$e){return Hi($e,function(Pe){return we[Pe]})}function Wc(we,$e){return we.has($e)}function Aw(we,$e){for(var Pe=-1,vt=we.length;++Pe<vt&&nh($e,we[Pe],0)>-1;);return Pe}function Ow(we,$e){for(var Pe=we.length;Pe--&&nh($e,we[Pe],0)>-1;);return Pe}function _x(we,$e){for(var Pe=we.length,vt=0;Pe--;)we[Pe]===$e&&++vt;return vt}var Ex=dy(hw),Nw=dy(ny);function vx(we){return"\\"+eh[we]}function yx(we,$e){return we==null?n:we[$e]}function ih(we){return ty.test(we)}function fp(we){return dx.test(we)}function Qo(we){for(var $e,Pe=[];!($e=we.next()).done;)Pe.push($e.value);return Pe}function kg(we){var $e=-1,Pe=Array(we.size);return we.forEach(function(vt,on){Pe[++$e]=[on,vt]}),Pe}function Pw(we,$e){return function(Pe){return we($e(Pe))}}function Nl(we,$e){for(var Pe=-1,vt=we.length,on=0,Xn=[];++Pe<vt;){var Mr=we[Pe];(Mr===$e||Mr===y)&&(we[Pe]=y,Xn[on++]=Pe)}return Xn}function Lg(we){var $e=-1,Pe=Array(we.size);return we.forEach(function(vt){Pe[++$e]=vt}),Pe}function Oa(we){var $e=-1,Pe=Array(we.size);return we.forEach(function(vt){Pe[++$e]=[vt,vt]}),Pe}function Sx(we,$e,Pe){for(var vt=Pe-1,on=we.length;++vt<on;)if(we[vt]===$e)return vt;return-1}function Tx(we,$e,Pe){for(var vt=Pe+1;vt--;)if(we[vt]===$e)return vt;return vt}function rh(we){return ih(we)?gy(we):Dg(we)}function Qs(we){return ih(we)?wx(we):yw(we)}function my(we){for(var $e=we.length;$e--&&cp.test(we.charAt($e)););return $e}var bx=dy(fw);function gy(we){for(var $e=dp.lastIndex=0;dp.test(we);)++$e;return $e}function wx(we){return we.match(dp)||[]}function _y(we){return we.match(ey)||[]}var Ey=function we($e){$e=$e==null?ds:Pl.defaults(ds.Object(),$e,Pl.pick(ds,uw));var Pe=$e.Array,vt=$e.Date,on=$e.Error,Xn=$e.Function,Mr=$e.Math,gi=$e.Object,vy=$e.RegExp,sh=$e.String,Zo=$e.TypeError,Hc=Pe.prototype,xw=Xn.prototype,oh=gi.prototype,Kn=$e["__core-js_shared__"],Mg=xw.toString,ai=oh.hasOwnProperty,Cx=0,Ug=function(){var g=/[^.]+$/.exec(Kn&&Kn.keys&&Kn.keys.IE_PROTO||"");return g?"Symbol(src)_1."+g:""}(),jg=oh.toString,Rx=Mg.call(gi),Ix=ds._,Dw=vy("^"+Mg.call(ai).replace(Jd,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Fg=pw?$e.Buffer:n,xl=$e.Symbol,Vg=$e.Uint8Array,Dl=Fg?Fg.allocUnsafe:n,Bg=Pw(gi.getPrototypeOf,gi),kw=gi.create,Lw=oh.propertyIsEnumerable,pp=Hc.splice,yy=xl?xl.isConcatSpreadable:n,mp=xl?xl.iterator:n,Wu=xl?xl.toStringTag:n,uc=function(){try{var g=Qu(gi,"defineProperty");return g({},"",{}),g}catch{}}(),Ax=$e.clearTimeout!==ds.clearTimeout&&$e.clearTimeout,Ox=vt&&vt.now!==ds.Date.now&&vt.now,Nx=$e.setTimeout!==ds.setTimeout&&$e.setTimeout,Wg=Mr.ceil,Hg=Mr.floor,Sy=gi.getOwnPropertySymbols,Mw=Fg?Fg.isBuffer:n,$g=$e.isFinite,Px=Hc.join,xx=Pw(gi.keys,gi),hr=Mr.max,Ss=Mr.min,Dx=vt.now,kx=$e.parseInt,kl=Mr.random,Lx=Hc.reverse,Ty=Qu($e,"DataView"),Oo=Qu($e,"Map"),by=Qu($e,"Promise"),ah=Qu($e,"Set"),gp=Qu($e,"WeakMap"),_p=Qu(gi,"create"),Ep=gp&&new gp,ch={},Mx=ed(Ty),Ux=ed(Oo),Uw=ed(by),jx=ed(ah),Fx=ed(gp),lh=xl?xl.prototype:n,Hu=lh?lh.valueOf:n,ot=lh?lh.toString:n;function ne(g){if(er(g)&&!un(g)&&!(g instanceof On)){if(g instanceof No)return g;if(ai.call(g,"__wrapped__"))return wC(g)}return new No(g)}var uh=function(){function g(){}return function(S){if(!$i(S))return{};if(kw)return kw(S);g.prototype=S;var A=new g;return g.prototype=n,A}}();function zg(){}function No(g,S){this.__wrapped__=g,this.__actions__=[],this.__chain__=!!S,this.__index__=0,this.__values__=n}ne.templateSettings={escape:Ko,evaluate:Xs,interpolate:ap,variable:"",imports:{_:ne}},ne.prototype=zg.prototype,ne.prototype.constructor=ne,No.prototype=uh(zg.prototype),No.prototype.constructor=No;function On(g){this.__wrapped__=g,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=De,this.__views__=[]}function Vx(){var g=new On(this.__wrapped__);return g.__actions__=eo(this.__actions__),g.__dir__=this.__dir__,g.__filtered__=this.__filtered__,g.__iteratees__=eo(this.__iteratees__),g.__takeCount__=this.__takeCount__,g.__views__=eo(this.__views__),g}function Bx(){if(this.__filtered__){var g=new On(this);g.__dir__=-1,g.__filtered__=!0}else g=this.clone(),g.__dir__*=-1;return g}function Wx(){var g=this.__wrapped__.value(),S=this.__dir__,A=un(g),U=S<0,q=A?g.length:0,re=ID(0,q,this.__views__),de=re.start,ge=re.end,Re=ge-de,Ye=U?ge:de-1,Xe=this.__iteratees__,tt=Xe.length,pt=0,_t=Ss(Re,this.__takeCount__);if(!A||!U&&q==Re&&_t==Re)return lC(g,this.__actions__);var Ht=[];e:for(;Re--&&pt<_t;){Ye+=S;for(var yn=-1,Wt=g[Ye];++yn<tt;){var Nn=Xe[yn],kn=Nn.iteratee,ro=Nn.type,Bs=kn(Wt);if(ro==He)Wt=Bs;else if(!Bs){if(ro==Ke)continue e;break e}}Ht[pt++]=Wt}return Ht}On.prototype=uh(zg.prototype),On.prototype.constructor=On;function $c(g){var S=-1,A=g==null?0:g.length;for(this.clear();++S<A;){var U=g[S];this.set(U[0],U[1])}}function Hx(){this.__data__=_p?_p(null):{},this.size=0}function $x(g){var S=this.has(g)&&delete this.__data__[g];return this.size-=S?1:0,S}function zx(g){var S=this.__data__;if(_p){var A=S[g];return A===m?n:A}return ai.call(S,g)?S[g]:n}function Gx(g){var S=this.__data__;return _p?S[g]!==n:ai.call(S,g)}function jw(g,S){var A=this.__data__;return this.size+=this.has(g)?0:1,A[g]=_p&&S===n?m:S,this}$c.prototype.clear=Hx,$c.prototype.delete=$x,$c.prototype.get=zx,$c.prototype.has=Gx,$c.prototype.set=jw;function zc(g){var S=-1,A=g==null?0:g.length;for(this.clear();++S<A;){var U=g[S];this.set(U[0],U[1])}}function wy(){this.__data__=[],this.size=0}function Kx(g){var S=this.__data__,A=Gg(S,g);if(A<0)return!1;var U=S.length-1;return A==U?S.pop():pp.call(S,A,1),--this.size,!0}function Fw(g){var S=this.__data__,A=Gg(S,g);return A<0?n:S[A][1]}function qx(g){return Gg(this.__data__,g)>-1}function Yx(g,S){var A=this.__data__,U=Gg(A,g);return U<0?(++this.size,A.push([g,S])):A[U][1]=S,this}zc.prototype.clear=wy,zc.prototype.delete=Kx,zc.prototype.get=Fw,zc.prototype.has=qx,zc.prototype.set=Yx;function dc(g){var S=-1,A=g==null?0:g.length;for(this.clear();++S<A;){var U=g[S];this.set(U[0],U[1])}}function Xx(){this.size=0,this.__data__={hash:new $c,map:new(Oo||zc),string:new $c}}function Jx(g){var S=Op(this,g).delete(g);return this.size-=S?1:0,S}function Vw(g){return Op(this,g).get(g)}function Qx(g){return Op(this,g).has(g)}function Bw(g,S){var A=Op(this,g),U=A.size;return A.set(g,S),this.size+=A.size==U?0:1,this}dc.prototype.clear=Xx,dc.prototype.delete=Jx,dc.prototype.get=Vw,dc.prototype.has=Qx,dc.prototype.set=Bw;function Gc(g){var S=-1,A=g==null?0:g.length;for(this.__data__=new dc;++S<A;)this.add(g[S])}function Zx(g){return this.__data__.set(g,m),this}function eD(g){return this.__data__.has(g)}Gc.prototype.add=Gc.prototype.push=Zx,Gc.prototype.has=eD;function Ms(g){var S=this.__data__=new zc(g);this.size=S.size}function Ww(){this.__data__=new zc,this.size=0}function Hw(g){var S=this.__data__,A=S.delete(g);return this.size=S.size,A}function $w(g){return this.__data__.get(g)}function tD(g){return this.__data__.has(g)}function nD(g,S){var A=this.__data__;if(A instanceof zc){var U=A.__data__;if(!Oo||U.length<c-1)return U.push([g,S]),this.size=++A.size,this;A=this.__data__=new dc(U)}return A.set(g,S),this.size=A.size,this}Ms.prototype.clear=Ww,Ms.prototype.delete=Hw,Ms.prototype.get=$w,Ms.prototype.has=tD,Ms.prototype.set=nD;function zw(g,S){var A=un(g),U=!A&&Zc(g),q=!A&&!U&&zl(g),re=!A&&!U&&!q&&id(g),de=A||U||q||re,ge=de?fy(g.length,sh):[],Re=ge.length;for(var Ye in g)(S||ai.call(g,Ye))&&!(de&&(Ye=="length"||q&&(Ye=="offset"||Ye=="parent")||re&&(Ye=="buffer"||Ye=="byteLength"||Ye=="byteOffset")||Do(Ye,Re)))&&ge.push(Ye);return ge}function Cy(g){var S=g.length;return S?g[e_(0,S-1)]:n}function iD(g,S){return xp(eo(g),$u(S,0,g.length))}function Gw(g){return xp(eo(g))}function Ry(g,S,A){(A!==n&&!ta(g[S],A)||A===n&&!(S in g))&&Kc(g,S,A)}function vp(g,S,A){var U=g[S];(!(ai.call(g,S)&&ta(U,A))||A===n&&!(S in g))&&Kc(g,S,A)}function Gg(g,S){for(var A=g.length;A--;)if(ta(g[A][0],S))return A;return-1}function rD(g,S,A,U){return qc(g,function(q,re,de){S(U,q,A(q),de)}),U}function Kw(g,S){return g&&ea(S,Qr(S),g)}function sD(g,S){return g&&ea(S,Vs(S),g)}function Kc(g,S,A){S=="__proto__"&&uc?uc(g,S,{configurable:!0,enumerable:!0,value:A,writable:!0}):g[S]=A}function Iy(g,S){for(var A=-1,U=S.length,q=Pe(U),re=g==null;++A<U;)q[A]=re?n:R0(g,S[A]);return q}function $u(g,S,A){return g===g&&(A!==n&&(g=g<=A?g:A),S!==n&&(g=g>=S?g:S)),g}function Po(g,S,A,U,q,re){var de,ge=S&w,Re=S&I,Ye=S&P;if(A&&(de=q?A(g,U,q,re):A(g)),de!==n)return de;if(!$i(g))return g;var Xe=un(g);if(Xe){if(de=OD(g),!ge)return eo(g,de)}else{var tt=bs(g),pt=tt==Di||tt==ui;if(zl(g))return hC(g,ge);if(tt==di||tt==ft||pt&&!q){if(de=Re||pt?{}:e0(g),!ge)return Re?wD(g,sD(de,g)):$y(g,Kw(de,g))}else{if(!Ri[tt])return q?g:{};de=h_(g,tt,ge)}}re||(re=new Ms);var _t=re.get(g);if(_t)return _t;re.set(g,de),w0(g)?g.forEach(function(Wt){de.add(Po(Wt,S,A,Wt,g,re))}):nd(g)&&g.forEach(function(Wt,Nn){de.set(Nn,Po(Wt,S,A,Nn,g,re))});var Ht=Ye?Re?l_:Xy:Re?Vs:Qr,yn=Xe?n:Ht(g);return Jo(yn||g,function(Wt,Nn){yn&&(Nn=Wt,Wt=g[Nn]),vp(de,Nn,Po(Wt,S,A,Nn,g,re))}),de}function qw(g){var S=Qr(g);return function(A){return Yw(A,g,S)}}function Yw(g,S,A){var U=A.length;if(g==null)return!U;for(g=gi(g);U--;){var q=A[U],re=S[q],de=g[q];if(de===n&&!(q in g)||!re(de))return!1}return!0}function Xw(g,S,A){if(typeof g!="function")throw new Zo(d);return Hl(function(){g.apply(n,A)},S)}function yp(g,S,A,U){var q=-1,re=hp,de=!0,ge=g.length,Re=[],Ye=S.length;if(!ge)return Re;A&&(S=Hi(S,Ao(A))),U?(re=oy,de=!1):S.length>=c&&(re=Wc,de=!1,S=new Gc(S));e:for(;++q<ge;){var Xe=g[q],tt=A==null?Xe:A(Xe);if(Xe=U||Xe!==0?Xe:0,de&&tt===tt){for(var pt=Ye;pt--;)if(S[pt]===tt)continue e;Re.push(Xe)}else re(S,tt,U)||Re.push(Xe)}return Re}var qc=r_(Na),Jw=r_(Yg,!0);function oD(g,S){var A=!0;return qc(g,function(U,q,re){return A=!!S(U,q,re),A}),A}function dh(g,S,A){for(var U=-1,q=g.length;++U<q;){var re=g[U],de=S(re);if(de!=null&&(ge===n?de===de&&!no(de):A(de,ge)))var ge=de,Re=re}return Re}function Kg(g,S,A,U){var q=g.length;for(A=mn(A),A<0&&(A=-A>q?0:q+A),U=U===n||U>q?q:mn(U),U<0&&(U+=q),U=A>U?0:ER(U);A<U;)g[A++]=S;return g}function qg(g,S){var A=[];return qc(g,function(U,q,re){S(U,q,re)&&A.push(U)}),A}function hs(g,S,A,U,q){var re=-1,de=g.length;for(A||(A=f_),q||(q=[]);++re<de;){var ge=g[re];S>0&&A(ge)?S>1?hs(ge,S-1,A,U,q):Ol(q,ge):U||(q[q.length]=ge)}return q}var Ay=gC(),Qw=gC(!0);function Na(g,S){return g&&Ay(g,S,Qr)}function Yg(g,S){return g&&Qw(g,S,Qr)}function hh(g,S){return Bc(S,function(A){return ka(g[A])})}function zu(g,S){S=Fl(S,g);for(var A=0,U=S.length;g!=null&&A<U;)g=g[Da(S[A++])];return A&&A==U?g:n}function Zw(g,S,A){var U=S(g);return un(g)?U:Ol(U,A(g))}function Ts(g){return g==null?g===n?Et:us:Wu&&Wu in gi(g)?Qy(g):Qc(g)}function Oy(g,S){return g>S}function aD(g,S){return g!=null&&ai.call(g,S)}function cD(g,S){return g!=null&&S in gi(g)}function lD(g,S,A){return g>=Ss(S,A)&&g<hr(S,A)}function Ny(g,S,A){for(var U=A?oy:hp,q=g[0].length,re=g.length,de=re,ge=Pe(re),Re=1/0,Ye=[];de--;){var Xe=g[de];de&&S&&(Xe=Hi(Xe,Ao(S))),Re=Ss(Xe.length,Re),ge[de]=!A&&(S||q>=120&&Xe.length>=120)?new Gc(de&&Xe):n}Xe=g[0];var tt=-1,pt=ge[0];e:for(;++tt<q&&Ye.length<Re;){var _t=Xe[tt],Ht=S?S(_t):_t;if(_t=A||_t!==0?_t:0,!(pt?Wc(pt,Ht):U(Ye,Ht,A))){for(de=re;--de;){var yn=ge[de];if(!(yn?Wc(yn,Ht):U(g[de],Ht,A)))continue e}pt&&pt.push(Ht),Ye.push(_t)}}return Ye}function uD(g,S,A,U){return Na(g,function(q,re,de){S(U,A(q),re,de)}),U}function Ll(g,S,A){S=Fl(S,g),g=bC(g,S);var U=g==null?g:g[Da(ko(S))];return U==null?n:Jr(U,g,A)}function Py(g){return er(g)&&Ts(g)==ft}function dD(g){return er(g)&&Ts(g)==Qt}function eC(g){return er(g)&&Ts(g)==Vt}function Ml(g,S,A,U,q){return g===S?!0:g==null||S==null||!er(g)&&!er(S)?g!==g&&S!==S:hD(g,S,A,U,Ml,q)}function hD(g,S,A,U,q,re){var de=un(g),ge=un(S),Re=de?Ft:bs(g),Ye=ge?Ft:bs(S);Re=Re==ft?di:Re,Ye=Ye==ft?di:Ye;var Xe=Re==di,tt=Ye==di,pt=Re==Ye;if(pt&&zl(g)){if(!zl(S))return!1;de=!0,Xe=!1}if(pt&&!Xe)return re||(re=new Ms),de||id(g)?vC(g,S,A,U,q,re):Yy(g,S,Re,A,U,q,re);if(!(A&k)){var _t=Xe&&ai.call(g,"__wrapped__"),Ht=tt&&ai.call(S,"__wrapped__");if(_t||Ht){var yn=_t?g.value():g,Wt=Ht?S.value():S;return re||(re=new Ms),q(yn,Wt,A,U,re)}}return pt?(re||(re=new Ms),Ip(g,S,A,U,q,re)):!1}function fD(g){return er(g)&&bs(g)==rn}function Xg(g,S,A,U){var q=A.length,re=q,de=!U;if(g==null)return!re;for(g=gi(g);q--;){var ge=A[q];if(de&&ge[2]?ge[1]!==g[ge[0]]:!(ge[0]in g))return!1}for(;++q<re;){ge=A[q];var Re=ge[0],Ye=g[Re],Xe=ge[1];if(de&&ge[2]){if(Ye===n&&!(Re in g))return!1}else{var tt=new Ms;if(U)var pt=U(Ye,Xe,Re,g,S,tt);if(!(pt===n?Ml(Xe,Ye,k|M,U,tt):pt))return!1}}return!0}function tC(g){if(!$i(g)||m_(g))return!1;var S=ka(g)?Dw:Uu;return S.test(ed(g))}function pD(g){return er(g)&&Ts(g)==Zi}function mD(g){return er(g)&&bs(g)==wi}function xy(g){return er(g)&&R_(g.length)&&!!ki[Ts(g)]}function Jg(g){return typeof g=="function"?g:g==null?io:typeof g=="object"?un(g)?Tp(g[0],g[1]):Sp(g):Th(g)}function Qg(g){if(!Zu(g))return xx(g);var S=[];for(var A in gi(g))ai.call(g,A)&&A!="constructor"&&S.push(A);return S}function Dy(g){if(!$i(g))return TC(g);var S=Zu(g),A=[];for(var U in g)U=="constructor"&&(S||!ai.call(g,U))||A.push(U);return A}function Zg(g,S){return g<S}function ky(g,S){var A=-1,U=js(g)?Pe(g.length):[];return qc(g,function(q,re,de){U[++A]=S(q,re,de)}),U}function Sp(g){var S=u_(g);return S.length==1&&S[0][2]?Wl(S[0][0],S[0][1]):function(A){return A===g||Xg(A,g,S)}}function Tp(g,S){return p_(g)&&t0(S)?Wl(Da(g),S):function(A){var U=R0(A,g);return U===n&&U===S?A_(A,g):Ml(S,U,k|M)}}function Gu(g,S,A,U,q){g!==S&&Ay(S,function(re,de){if(q||(q=new Ms),$i(re))gD(g,S,de,A,Gu,U,q);else{var ge=U?U(Np(g,de),re,de+"",g,S,q):n;ge===n&&(ge=re),Ry(g,de,ge)}},Vs)}function gD(g,S,A,U,q,re,de){var ge=Np(g,A),Re=Np(S,A),Ye=de.get(Re);if(Ye){Ry(g,A,Ye);return}var Xe=re?re(ge,Re,A+"",g,S,de):n,tt=Xe===n;if(tt){var pt=un(Re),_t=!pt&&zl(Re),Ht=!pt&&!_t&&id(Re);Xe=Re,pt||_t||Ht?un(ge)?Xe=ge:Cr(ge)?Xe=eo(ge):_t?(tt=!1,Xe=hC(Re,!0)):Ht?(tt=!1,Xe=pC(Re,!0)):Xe=[]:Sh(Re)||Zc(Re)?(Xe=ge,Zc(ge)?Xe=vR(ge):(!$i(ge)||ka(ge))&&(Xe=e0(Re))):tt=!1}tt&&(de.set(Re,Xe),q(Xe,Re,U,re,de),de.delete(Re)),Ry(g,A,Xe)}function nC(g,S){var A=g.length;if(A)return S+=S<0?A:0,Do(S,A)?g[S]:n}function Ly(g,S,A){S.length?S=Hi(S,function(re){return un(re)?function(de){return zu(de,re.length===1?re[0]:re)}:re}):S=[io];var U=-1;S=Hi(S,Ao(Bt()));var q=ky(g,function(re,de,ge){var Re=Hi(S,function(Ye){return Ye(re)});return{criteria:Re,index:++U,value:re}});return gx(q,function(re,de){return bD(re,de,A)})}function iC(g,S){return rC(g,S,function(A,U){return A_(g,U)})}function rC(g,S,A){for(var U=-1,q=S.length,re={};++U<q;){var de=S[U],ge=zu(g,de);A(ge,de)&&Ul(re,Fl(de,g),ge)}return re}function _D(g){return function(S){return zu(S,g)}}function My(g,S,A,U){var q=U?Tw:nh,re=-1,de=S.length,ge=g;for(g===S&&(S=eo(S)),A&&(ge=Hi(g,Ao(A)));++re<de;)for(var Re=0,Ye=S[re],Xe=A?A(Ye):Ye;(Re=q(ge,Xe,Re,U))>-1;)ge!==g&&pp.call(ge,Re,1),pp.call(g,Re,1);return g}function sC(g,S){for(var A=g?S.length:0,U=A-1;A--;){var q=S[A];if(A==U||q!==re){var re=q;Do(q)?pp.call(g,q,1):jy(g,q)}}return g}function e_(g,S){return g+Hg(kl()*(S-g+1))}function ED(g,S,A,U){for(var q=-1,re=hr(Wg((S-g)/(A||1)),0),de=Pe(re);re--;)de[U?re:++q]=g,g+=A;return de}function Uy(g,S){var A="";if(!g||S<1||S>_e)return A;do S%2&&(A+=g),S=Hg(S/2),S&&(g+=g);while(S);return A}function vn(g,S){return Pp(_h(g,S,io),g+"")}function vD(g){return Cy(Gl(g))}function oC(g,S){var A=Gl(g);return xp(A,$u(S,0,A.length))}function Ul(g,S,A,U){if(!$i(g))return g;S=Fl(S,g);for(var q=-1,re=S.length,de=re-1,ge=g;ge!=null&&++q<re;){var Re=Da(S[q]),Ye=A;if(Re==="__proto__"||Re==="constructor"||Re==="prototype")return g;if(q!=de){var Xe=ge[Re];Ye=U?U(Xe,Re,ge):n,Ye===n&&(Ye=$i(Xe)?Xe:Do(S[q+1])?[]:{})}vp(ge,Re,Ye),ge=ge[Re]}return g}var aC=Ep?function(g,S){return Ep.set(g,S),g}:io,bp=uc?function(g,S){return uc(g,"toString",{configurable:!0,enumerable:!1,value:O0(S),writable:!0})}:io;function yD(g){return xp(Gl(g))}function xo(g,S,A){var U=-1,q=g.length;S<0&&(S=-S>q?0:q+S),A=A>q?q:A,A<0&&(A+=q),q=S>A?0:A-S>>>0,S>>>=0;for(var re=Pe(q);++U<q;)re[U]=g[U+S];return re}function fh(g,S){var A;return qc(g,function(U,q,re){return A=S(U,q,re),!A}),!!A}function t_(g,S,A){var U=0,q=g==null?U:g.length;if(typeof S=="number"&&S===S&&q<=rt){for(;U<q;){var re=U+q>>>1,de=g[re];de!==null&&!no(de)&&(A?de<=S:de<S)?U=re+1:q=re}return q}return ph(g,S,io,A)}function ph(g,S,A,U){var q=0,re=g==null?0:g.length;if(re===0)return 0;S=A(S);for(var de=S!==S,ge=S===null,Re=no(S),Ye=S===n;q<re;){var Xe=Hg((q+re)/2),tt=A(g[Xe]),pt=tt!==n,_t=tt===null,Ht=tt===tt,yn=no(tt);if(de)var Wt=U||Ht;else Ye?Wt=Ht&&(U||pt):ge?Wt=Ht&&pt&&(U||!_t):Re?Wt=Ht&&pt&&!_t&&(U||!yn):_t||yn?Wt=!1:Wt=U?tt<=S:tt<S;Wt?q=Xe+1:re=Xe}return Ss(re,Ue)}function mh(g,S){for(var A=-1,U=g.length,q=0,re=[];++A<U;){var de=g[A],ge=S?S(de):de;if(!A||!ta(ge,Re)){var Re=ge;re[q++]=de===0?0:de}}return re}function wp(g){return typeof g=="number"?g:no(g)?Ie:+g}function Zs(g){if(typeof g=="string")return g;if(un(g))return Hi(g,Zs)+"";if(no(g))return ot?ot.call(g):"";var S=g+"";return S=="0"&&1/g==-Oe?"-0":S}function jl(g,S,A){var U=-1,q=hp,re=g.length,de=!0,ge=[],Re=ge;if(A)de=!1,q=oy;else if(re>=c){var Ye=S?null:RD(g);if(Ye)return Lg(Ye);de=!1,q=Wc,Re=new Gc}else Re=S?[]:ge;e:for(;++U<re;){var Xe=g[U],tt=S?S(Xe):Xe;if(Xe=A||Xe!==0?Xe:0,de&&tt===tt){for(var pt=Re.length;pt--;)if(Re[pt]===tt)continue e;S&&Re.push(tt),ge.push(Xe)}else q(Re,tt,A)||(Re!==ge&&Re.push(tt),ge.push(Xe))}return ge}function jy(g,S){return S=Fl(S,g),g=bC(g,S),g==null||delete g[Da(ko(S))]}function cC(g,S,A,U){return Ul(g,S,A(zu(g,S)),U)}function Li(g,S,A,U){for(var q=g.length,re=U?q:-1;(U?re--:++re<q)&&S(g[re],re,g););return A?xo(g,U?0:re,U?re+1:q):xo(g,U?re+1:0,U?q:re)}function lC(g,S){var A=g;return A instanceof On&&(A=A.value()),ay(S,function(U,q){return q.func.apply(q.thisArg,Ol([U],q.args))},A)}function Fy(g,S,A){var U=g.length;if(U<2)return U?jl(g[0]):[];for(var q=-1,re=Pe(U);++q<U;)for(var de=g[q],ge=-1;++ge<U;)ge!=q&&(re[q]=yp(re[q]||de,g[ge],S,A));return jl(hs(re,1),S,A)}function uC(g,S,A){for(var U=-1,q=g.length,re=S.length,de={};++U<q;){var ge=U<re?S[U]:n;A(de,g[U],ge)}return de}function Vy(g){return Cr(g)?g:[]}function n_(g){return typeof g=="function"?g:io}function Fl(g,S){return un(g)?g:p_(g,S)?[g]:s0(qn(g))}var SD=vn;function Vl(g,S,A){var U=g.length;return A=A===n?U:A,!S&&A>=U?g:xo(g,S,A)}var dC=Ax||function(g){return ds.clearTimeout(g)};function hC(g,S){if(S)return g.slice();var A=g.length,U=Dl?Dl(A):new g.constructor(A);return g.copy(U),U}function By(g){var S=new g.constructor(g.byteLength);return new Vg(S).set(new Vg(g)),S}function TD(g,S){var A=S?By(g.buffer):g.buffer;return new g.constructor(A,g.byteOffset,g.byteLength)}function fC(g){var S=new g.constructor(g.source,Zb.exec(g));return S.lastIndex=g.lastIndex,S}function gh(g){return Hu?gi(Hu.call(g)):{}}function pC(g,S){var A=S?By(g.buffer):g.buffer;return new g.constructor(A,g.byteOffset,g.length)}function Wy(g,S){if(g!==S){var A=g!==n,U=g===null,q=g===g,re=no(g),de=S!==n,ge=S===null,Re=S===S,Ye=no(S);if(!ge&&!Ye&&!re&&g>S||re&&de&&Re&&!ge&&!Ye||U&&de&&Re||!A&&Re||!q)return 1;if(!U&&!re&&!Ye&&g<S||Ye&&A&&q&&!U&&!re||ge&&A&&q||!de&&q||!Re)return-1}return 0}function bD(g,S,A){for(var U=-1,q=g.criteria,re=S.criteria,de=q.length,ge=A.length;++U<de;){var Re=Wy(q[U],re[U]);if(Re){if(U>=ge)return Re;var Ye=A[U];return Re*(Ye=="desc"?-1:1)}}return g.index-S.index}function Hy(g,S,A,U){for(var q=-1,re=g.length,de=A.length,ge=-1,Re=S.length,Ye=hr(re-de,0),Xe=Pe(Re+Ye),tt=!U;++ge<Re;)Xe[ge]=S[ge];for(;++q<de;)(tt||q<re)&&(Xe[A[q]]=g[q]);for(;Ye--;)Xe[ge++]=g[q++];return Xe}function mC(g,S,A,U){for(var q=-1,re=g.length,de=-1,ge=A.length,Re=-1,Ye=S.length,Xe=hr(re-ge,0),tt=Pe(Xe+Ye),pt=!U;++q<Xe;)tt[q]=g[q];for(var _t=q;++Re<Ye;)tt[_t+Re]=S[Re];for(;++de<ge;)(pt||q<re)&&(tt[_t+A[de]]=g[q++]);return tt}function eo(g,S){var A=-1,U=g.length;for(S||(S=Pe(U));++A<U;)S[A]=g[A];return S}function ea(g,S,A,U){var q=!A;A||(A={});for(var re=-1,de=S.length;++re<de;){var ge=S[re],Re=U?U(A[ge],g[ge],ge,A,g):n;Re===n&&(Re=g[ge]),q?Kc(A,ge,Re):vp(A,ge,Re)}return A}function $y(g,S){return ea(g,d_(g),S)}function wD(g,S){return ea(g,Zy(g),S)}function i_(g,S){return function(A,U){var q=un(A)?sy:rD,re=S?S():{};return q(A,g,Bt(U,2),re)}}function Ku(g){return vn(function(S,A){var U=-1,q=A.length,re=q>1?A[q-1]:n,de=q>2?A[2]:n;for(re=g.length>3&&typeof re=="function"?(q--,re):n,de&&Us(A[0],A[1],de)&&(re=q<3?n:re,q=1),S=gi(S);++U<q;){var ge=A[U];ge&&g(S,ge,U,re)}return S})}function r_(g,S){return function(A,U){if(A==null)return A;if(!js(A))return g(A,U);for(var q=A.length,re=S?q:-1,de=gi(A);(S?re--:++re<q)&&U(de[re],re,de)!==!1;);return A}}function gC(g){return function(S,A,U){for(var q=-1,re=gi(S),de=U(S),ge=de.length;ge--;){var Re=de[g?ge:++q];if(A(re[Re],Re,re)===!1)break}return S}}function hc(g,S,A){var U=S&K,q=Cp(g);function re(){var de=this&&this!==ds&&this instanceof re?q:g;return de.apply(U?A:this,arguments)}return re}function qu(g){return function(S){S=qn(S);var A=ih(S)?Qs(S):n,U=A?A[0]:S.charAt(0),q=A?Vl(A,1).join(""):S.slice(1);return U[g]()+q}}function Yc(g){return function(S){return ay(jR(xR(S).replace(ux,"")),g,"")}}function Cp(g){return function(){var S=arguments;switch(S.length){case 0:return new g;case 1:return new g(S[0]);case 2:return new g(S[0],S[1]);case 3:return new g(S[0],S[1],S[2]);case 4:return new g(S[0],S[1],S[2],S[3]);case 5:return new g(S[0],S[1],S[2],S[3],S[4]);case 6:return new g(S[0],S[1],S[2],S[3],S[4],S[5]);case 7:return new g(S[0],S[1],S[2],S[3],S[4],S[5],S[6])}var A=uh(g.prototype),U=g.apply(A,S);return $i(U)?U:A}}function CD(g,S,A){var U=Cp(g);function q(){for(var re=arguments.length,de=Pe(re),ge=re,Re=Ju(q);ge--;)de[ge]=arguments[ge];var Ye=re<3&&de[0]!==Re&&de[re-1]!==Re?[]:Nl(de,Re);if(re-=Ye.length,re<A)return Xu(g,S,s_,q.placeholder,n,de,Ye,n,n,A-re);var Xe=this&&this!==ds&&this instanceof q?U:g;return Jr(Xe,this,de)}return q}function _C(g){return function(S,A,U){var q=gi(S);if(!js(S)){var re=Bt(A,3);S=Qr(S),A=function(ge){return re(q[ge],ge,q)}}var de=g(S,A,U);return de>-1?q[re?S[de]:de]:n}}function EC(g){return fc(function(S){var A=S.length,U=A,q=No.prototype.thru;for(g&&S.reverse();U--;){var re=S[U];if(typeof re!="function")throw new Zo(d);if(q&&!de&&Ap(re)=="wrapper")var de=new No([],!0)}for(U=de?U:A;++U<A;){re=S[U];var ge=Ap(re),Re=ge=="wrapper"?Jy(re):n;Re&&Jc(Re[0])&&Re[1]==(oe|G|Z|ce)&&!Re[4].length&&Re[9]==1?de=de[Ap(Re[0])].apply(de,Re[3]):de=re.length==1&&Jc(re)?de[ge]():de.thru(re)}return function(){var Ye=arguments,Xe=Ye[0];if(de&&Ye.length==1&&un(Xe))return de.plant(Xe).value();for(var tt=0,pt=A?S[tt].apply(this,Ye):Xe;++tt<A;)pt=S[tt].call(this,pt);return pt}})}function s_(g,S,A,U,q,re,de,ge,Re,Ye){var Xe=S&oe,tt=S&K,pt=S&W,_t=S&(G|Q),Ht=S&Se,yn=pt?n:Cp(g);function Wt(){for(var Nn=arguments.length,kn=Pe(Nn),ro=Nn;ro--;)kn[ro]=arguments[ro];if(_t)var Bs=Ju(Wt),so=_x(kn,Bs);if(U&&(kn=Hy(kn,U,q,_t)),re&&(kn=mC(kn,re,de,_t)),Nn-=so,_t&&Nn<Ye){var Rr=Nl(kn,Bs);return Xu(g,S,s_,Wt.placeholder,A,kn,Rr,ge,Re,Ye-Nn)}var La=tt?A:this,tl=pt?La[g]:g;return Nn=kn.length,ge?kn=n0(kn,ge):Ht&&Nn>1&&kn.reverse(),Xe&&Re<Nn&&(kn.length=Re),this&&this!==ds&&this instanceof Wt&&(tl=yn||Cp(tl)),tl.apply(La,kn)}return Wt}function zy(g,S){return function(A,U){return uD(A,g,S(U),{})}}function Pa(g,S){return function(A,U){var q;if(A===n&&U===n)return S;if(A!==n&&(q=A),U!==n){if(q===n)return U;typeof A=="string"||typeof U=="string"?(A=Zs(A),U=Zs(U)):(A=wp(A),U=wp(U)),q=g(A,U)}return q}}function Gy(g){return fc(function(S){return S=Hi(S,Ao(Bt())),vn(function(A){var U=this;return g(S,function(q){return Jr(q,U,A)})})})}function Yu(g,S){S=S===n?" ":Zs(S);var A=S.length;if(A<2)return A?Uy(S,g):S;var U=Uy(S,Wg(g/rh(S)));return ih(S)?Vl(Qs(U),0,g).join(""):U.slice(0,g)}function Ky(g,S,A,U){var q=S&K,re=Cp(g);function de(){for(var ge=-1,Re=arguments.length,Ye=-1,Xe=U.length,tt=Pe(Xe+Re),pt=this&&this!==ds&&this instanceof de?re:g;++Ye<Xe;)tt[Ye]=U[Ye];for(;Re--;)tt[Ye++]=arguments[++ge];return Jr(pt,q?A:this,tt)}return de}function o_(g){return function(S,A,U){return U&&typeof U!="number"&&Us(S,A,U)&&(A=U=n),S=O(S),A===n?(A=S,S=0):A=O(A),U=U===n?S<A?1:-1:O(U),ED(S,A,U,g)}}function a_(g){return function(S,A){return typeof S=="string"&&typeof A=="string"||(S=na(S),A=na(A)),g(S,A)}}function Xu(g,S,A,U,q,re,de,ge,Re,Ye){var Xe=S&G,tt=Xe?de:n,pt=Xe?n:de,_t=Xe?re:n,Ht=Xe?n:re;S|=Xe?Z:Y,S&=~(Xe?Y:Z),S&V||(S&=~(K|W));var yn=[g,S,q,_t,tt,Ht,pt,ge,Re,Ye],Wt=A.apply(n,yn);return Jc(g)&&g_(Wt,yn),Wt.placeholder=U,i0(Wt,g,S)}function Bl(g){var S=Mr[g];return function(A,U){if(A=na(A),U=U==null?0:Ss(mn(U),292),U&&$g(A)){var q=(qn(A)+"e").split("e"),re=S(q[0]+"e"+(+q[1]+U));return q=(qn(re)+"e").split("e"),+(q[0]+"e"+(+q[1]-U))}return S(A)}}var RD=ah&&1/Lg(new ah([,-0]))[1]==Oe?function(g){return new ah(g)}:P0;function Ur(g){return function(S){var A=bs(S);return A==rn?kg(S):A==wi?Oa(S):Rw(S,g(S))}}function Xc(g,S,A,U,q,re,de,ge){var Re=S&W;if(!Re&&typeof g!="function")throw new Zo(d);var Ye=U?U.length:0;if(Ye||(S&=~(Z|Y),U=q=n),de=de===n?de:hr(mn(de),0),ge=ge===n?ge:mn(ge),Ye-=q?q.length:0,S&Y){var Xe=U,tt=q;U=q=n}var pt=Re?n:Jy(g),_t=[g,S,A,U,q,Xe,tt,re,de,ge];if(pt&&PD(_t,pt),g=_t[0],S=_t[1],A=_t[2],U=_t[3],q=_t[4],ge=_t[9]=_t[9]===n?Re?0:g.length:hr(_t[9]-Ye,0),!ge&&S&(G|Q)&&(S&=~(G|Q)),!S||S==K)var Ht=hc(g,S,A);else S==G||S==Q?Ht=CD(g,S,ge):(S==Z||S==(K|Z))&&!q.length?Ht=Ky(g,S,A,U):Ht=s_.apply(n,_t);var yn=pt?aC:g_;return i0(yn(Ht,_t),g,S)}function c_(g,S,A,U){return g===n||ta(g,oh[A])&&!ai.call(U,A)?S:g}function Rp(g,S,A,U,q,re){return $i(g)&&$i(S)&&(re.set(S,g),Gu(g,S,n,Rp,re),re.delete(S)),g}function qy(g){return Sh(g)?n:g}function vC(g,S,A,U,q,re){var de=A&k,ge=g.length,Re=S.length;if(ge!=Re&&!(de&&Re>ge))return!1;var Ye=re.get(g),Xe=re.get(S);if(Ye&&Xe)return Ye==S&&Xe==g;var tt=-1,pt=!0,_t=A&M?new Gc:n;for(re.set(g,S),re.set(S,g);++tt<ge;){var Ht=g[tt],yn=S[tt];if(U)var Wt=de?U(yn,Ht,tt,S,g,re):U(Ht,yn,tt,g,S,re);if(Wt!==n){if(Wt)continue;pt=!1;break}if(_t){if(!cy(S,function(Nn,kn){if(!Wc(_t,kn)&&(Ht===Nn||q(Ht,Nn,A,U,re)))return _t.push(kn)})){pt=!1;break}}else if(!(Ht===yn||q(Ht,yn,A,U,re))){pt=!1;break}}return re.delete(g),re.delete(S),pt}function Yy(g,S,A,U,q,re,de){switch(A){case kt:if(g.byteLength!=S.byteLength||g.byteOffset!=S.byteOffset)return!1;g=g.buffer,S=S.buffer;case Qt:return!(g.byteLength!=S.byteLength||!re(new Vg(g),new Vg(S)));case ti:case Vt:case Rn:return ta(+g,+S);case En:return g.name==S.name&&g.message==S.message;case Zi:case Ne:return g==S+"";case rn:var ge=kg;case wi:var Re=U&k;if(ge||(ge=Lg),g.size!=S.size&&!Re)return!1;var Ye=de.get(g);if(Ye)return Ye==S;U|=M,de.set(g,S);var Xe=vC(ge(g),ge(S),U,q,re,de);return de.delete(g),Xe;case dt:if(Hu)return Hu.call(g)==Hu.call(S)}return!1}function Ip(g,S,A,U,q,re){var de=A&k,ge=Xy(g),Re=ge.length,Ye=Xy(S),Xe=Ye.length;if(Re!=Xe&&!de)return!1;for(var tt=Re;tt--;){var pt=ge[tt];if(!(de?pt in S:ai.call(S,pt)))return!1}var _t=re.get(g),Ht=re.get(S);if(_t&&Ht)return _t==S&&Ht==g;var yn=!0;re.set(g,S),re.set(S,g);for(var Wt=de;++tt<Re;){pt=ge[tt];var Nn=g[pt],kn=S[pt];if(U)var ro=de?U(kn,Nn,pt,S,g,re):U(Nn,kn,pt,g,S,re);if(!(ro===n?Nn===kn||q(Nn,kn,A,U,re):ro)){yn=!1;break}Wt||(Wt=pt=="constructor")}if(yn&&!Wt){var Bs=g.constructor,so=S.constructor;Bs!=so&&"constructor"in g&&"constructor"in S&&!(typeof Bs=="function"&&Bs instanceof Bs&&typeof so=="function"&&so instanceof so)&&(yn=!1)}return re.delete(g),re.delete(S),yn}function fc(g){return Pp(_h(g,n,IC),g+"")}function Xy(g){return Zw(g,Qr,d_)}function l_(g){return Zw(g,Vs,Zy)}var Jy=Ep?function(g){return Ep.get(g)}:P0;function Ap(g){for(var S=g.name+"",A=ch[S],U=ai.call(ch,S)?A.length:0;U--;){var q=A[U],re=q.func;if(re==null||re==g)return q.name}return S}function Ju(g){var S=ai.call(ne,"placeholder")?ne:g;return S.placeholder}function Bt(){var g=ne.iteratee||N0;return g=g===N0?Jg:g,arguments.length?g(arguments[0],arguments[1]):g}function Op(g,S){var A=g.__data__;return xa(S)?A[typeof S=="string"?"string":"hash"]:A.map}function u_(g){for(var S=Qr(g),A=S.length;A--;){var U=S[A],q=g[U];S[A]=[U,q,t0(q)]}return S}function Qu(g,S){var A=yx(g,S);return tC(A)?A:n}function Qy(g){var S=ai.call(g,Wu),A=g[Wu];try{g[Wu]=n;var U=!0}catch{}var q=jg.call(g);return U&&(S?g[Wu]=A:delete g[Wu]),q}var d_=Sy?function(g){return g==null?[]:(g=gi(g),Bc(Sy(g),function(S){return Lw.call(g,S)}))}:x0,Zy=Sy?function(g){for(var S=[];g;)Ol(S,d_(g)),g=Bg(g);return S}:x0,bs=Ts;(Ty&&bs(new Ty(new ArrayBuffer(1)))!=kt||Oo&&bs(new Oo)!=rn||by&&bs(by.resolve())!=Go||ah&&bs(new ah)!=wi||gp&&bs(new gp)!=st)&&(bs=function(g){var S=Ts(g),A=S==di?g.constructor:n,U=A?ed(A):"";if(U)switch(U){case Mx:return kt;case Ux:return rn;case Uw:return Go;case jx:return wi;case Fx:return st}return S});function ID(g,S,A){for(var U=-1,q=A.length;++U<q;){var re=A[U],de=re.size;switch(re.type){case"drop":g+=de;break;case"dropRight":S-=de;break;case"take":S=Ss(S,g+de);break;case"takeRight":g=hr(g,S-de);break}}return{start:g,end:S}}function AD(g){var S=g.match(ex);return S?S[1].split(wg):[]}function yC(g,S,A){S=Fl(S,g);for(var U=-1,q=S.length,re=!1;++U<q;){var de=Da(S[U]);if(!(re=g!=null&&A(g,de)))break;g=g[de]}return re||++U!=q?re:(q=g==null?0:g.length,!!q&&R_(q)&&Do(de,q)&&(un(g)||Zc(g)))}function OD(g){var S=g.length,A=new g.constructor(S);return S&&typeof g[0]=="string"&&ai.call(g,"index")&&(A.index=g.index,A.input=g.input),A}function e0(g){return typeof g.constructor=="function"&&!Zu(g)?uh(Bg(g)):{}}function h_(g,S,A){var U=g.constructor;switch(S){case Qt:return By(g);case ti:case Vt:return new U(+g);case kt:return TD(g,A);case Lt:case Ut:case Dn:case xt:case Mt:case Nt:case ni:case vs:case Ci:return pC(g,A);case rn:return new U;case Rn:case Ne:return new U(g);case Zi:return fC(g);case wi:return new U;case dt:return gh(g)}}function to(g,S){var A=S.length;if(!A)return g;var U=A-1;return S[U]=(A>1?"& ":"")+S[U],S=S.join(A>2?", ":" "),g.replace(lc,`{
/* [wrapped with `+S+`] */
`)}function f_(g){return un(g)||Zc(g)||!!(yy&&g&&g[yy])}function Do(g,S){var A=typeof g;return S=S??_e,!!S&&(A=="number"||A!="symbol"&&nx.test(g))&&g>-1&&g%1==0&&g<S}function Us(g,S,A){if(!$i(A))return!1;var U=typeof S;return(U=="number"?js(A)&&Do(S,A.length):U=="string"&&S in A)?ta(A[S],g):!1}function p_(g,S){if(un(g))return!1;var A=typeof g;return A=="number"||A=="symbol"||A=="boolean"||g==null||no(g)?!0:Wv.test(g)||!QP.test(g)||S!=null&&g in gi(S)}function xa(g){var S=typeof g;return S=="string"||S=="number"||S=="symbol"||S=="boolean"?g!=="__proto__":g===null}function Jc(g){var S=Ap(g),A=ne[S];if(typeof A!="function"||!(S in On.prototype))return!1;if(g===A)return!0;var U=Jy(A);return!!U&&g===U[0]}function m_(g){return!!Ug&&Ug in g}var ND=Kn?ka:bh;function Zu(g){var S=g&&g.constructor,A=typeof S=="function"&&S.prototype||oh;return g===A}function t0(g){return g===g&&!$i(g)}function Wl(g,S){return function(A){return A==null?!1:A[g]===S&&(S!==n||g in gi(A))}}function SC(g){var S=w_(g,function(U){return A.size===E&&A.clear(),U}),A=S.cache;return S}function PD(g,S){var A=g[1],U=S[1],q=A|U,re=q<(K|W|oe),de=U==oe&&A==G||U==oe&&A==ce&&g[7].length<=S[8]||U==(oe|ce)&&S[7].length<=S[8]&&A==G;if(!(re||de))return g;U&K&&(g[2]=S[2],q|=A&K?0:V);var ge=S[3];if(ge){var Re=g[3];g[3]=Re?Hy(Re,ge,S[4]):ge,g[4]=Re?Nl(g[3],y):S[4]}return ge=S[5],ge&&(Re=g[5],g[5]=Re?mC(Re,ge,S[6]):ge,g[6]=Re?Nl(g[5],y):S[6]),ge=S[7],ge&&(g[7]=ge),U&oe&&(g[8]=g[8]==null?S[8]:Ss(g[8],S[8])),g[9]==null&&(g[9]=S[9]),g[0]=S[0],g[1]=q,g}function TC(g){var S=[];if(g!=null)for(var A in gi(g))S.push(A);return S}function Qc(g){return jg.call(g)}function _h(g,S,A){return S=hr(S===n?g.length-1:S,0),function(){for(var U=arguments,q=-1,re=hr(U.length-S,0),de=Pe(re);++q<re;)de[q]=U[S+q];q=-1;for(var ge=Pe(S+1);++q<S;)ge[q]=U[q];return ge[S]=A(de),Jr(g,this,ge)}}function bC(g,S){return S.length<2?g:zu(g,xo(S,0,-1))}function n0(g,S){for(var A=g.length,U=Ss(S.length,A),q=eo(g);U--;){var re=S[U];g[U]=Do(re,A)?q[re]:n}return g}function Np(g,S){if(!(S==="constructor"&&typeof g[S]=="function")&&S!="__proto__")return g[S]}var g_=r0(aC),Hl=Nx||function(g,S){return ds.setTimeout(g,S)},Pp=r0(bp);function i0(g,S,A){var U=S+"";return Pp(g,to(U,xD(AD(U),A)))}function r0(g){var S=0,A=0;return function(){var U=Dx(),q=ze-(U-A);if(A=U,q>0){if(++S>=Ge)return arguments[0]}else S=0;return g.apply(n,arguments)}}function xp(g,S){var A=-1,U=g.length,q=U-1;for(S=S===n?U:S;++A<S;){var re=e_(A,q),de=g[re];g[re]=g[A],g[A]=de}return g.length=S,g}var s0=SC(function(g){var S=[];return g.charCodeAt(0)===46&&S.push(""),g.replace(Hv,function(A,U,q,re){S.push(q?re.replace(Jb,"$1"):U||A)}),S});function Da(g){if(typeof g=="string"||no(g))return g;var S=g+"";return S=="0"&&1/g==-Oe?"-0":S}function ed(g){if(g!=null){try{return Mg.call(g)}catch{}try{return g+""}catch{}}return""}function xD(g,S){return Jo(gt,function(A){var U="_."+A[0];S&A[1]&&!hp(g,U)&&g.push(U)}),g.sort()}function wC(g){if(g instanceof On)return g.clone();var S=new No(g.__wrapped__,g.__chain__);return S.__actions__=eo(g.__actions__),S.__index__=g.__index__,S.__values__=g.__values__,S}function DD(g,S,A){(A?Us(g,S,A):S===n)?S=1:S=hr(mn(S),0);var U=g==null?0:g.length;if(!U||S<1)return[];for(var q=0,re=0,de=Pe(Wg(U/S));q<U;)de[re++]=xo(g,q,q+=S);return de}function CC(g){for(var S=-1,A=g==null?0:g.length,U=0,q=[];++S<A;){var re=g[S];re&&(q[U++]=re)}return q}function kD(){var g=arguments.length;if(!g)return[];for(var S=Pe(g-1),A=arguments[0],U=g;U--;)S[U-1]=arguments[U];return Ol(un(A)?eo(A):[A],hs(S,1))}var o0=vn(function(g,S){return Cr(g)?yp(g,hs(S,1,Cr,!0)):[]}),LD=vn(function(g,S){var A=ko(S);return Cr(A)&&(A=n),Cr(g)?yp(g,hs(S,1,Cr,!0),Bt(A,2)):[]}),MD=vn(function(g,S){var A=ko(S);return Cr(A)&&(A=n),Cr(g)?yp(g,hs(S,1,Cr,!0),n,A):[]});function UD(g,S,A){var U=g==null?0:g.length;return U?(S=A||S===n?1:mn(S),xo(g,S<0?0:S,U)):[]}function jD(g,S,A){var U=g==null?0:g.length;return U?(S=A||S===n?1:mn(S),S=U-S,xo(g,0,S<0?0:S)):[]}function FD(g,S){return g&&g.length?Li(g,Bt(S,3),!0,!0):[]}function VD(g,S){return g&&g.length?Li(g,Bt(S,3),!0):[]}function RC(g,S,A,U){var q=g==null?0:g.length;return q?(A&&typeof A!="number"&&Us(g,S,A)&&(A=0,U=q),Kg(g,S,A,U)):[]}function a0(g,S,A){var U=g==null?0:g.length;if(!U)return-1;var q=A==null?0:mn(A);return q<0&&(q=hr(U+q,0)),th(g,Bt(S,3),q)}function c0(g,S,A){var U=g==null?0:g.length;if(!U)return-1;var q=U-1;return A!==n&&(q=mn(A),q=A<0?hr(U+q,0):Ss(q,U-1)),th(g,Bt(S,3),q,!0)}function IC(g){var S=g==null?0:g.length;return S?hs(g,1):[]}function AC(g){var S=g==null?0:g.length;return S?hs(g,Oe):[]}function BD(g,S){var A=g==null?0:g.length;return A?(S=S===n?1:mn(S),hs(g,S)):[]}function OC(g){for(var S=-1,A=g==null?0:g.length,U={};++S<A;){var q=g[S];U[q[0]]=q[1]}return U}function NC(g){return g&&g.length?g[0]:n}function PC(g,S,A){var U=g==null?0:g.length;if(!U)return-1;var q=A==null?0:mn(A);return q<0&&(q=hr(U+q,0)),nh(g,S,q)}function xC(g){var S=g==null?0:g.length;return S?xo(g,0,-1):[]}var WD=vn(function(g){var S=Hi(g,Vy);return S.length&&S[0]===g[0]?Ny(S):[]}),Dp=vn(function(g){var S=ko(g),A=Hi(g,Vy);return S===ko(A)?S=n:A.pop(),A.length&&A[0]===g[0]?Ny(A,Bt(S,2)):[]}),DC=vn(function(g){var S=ko(g),A=Hi(g,Vy);return S=typeof S=="function"?S:n,S&&A.pop(),A.length&&A[0]===g[0]?Ny(A,n,S):[]});function kC(g,S){return g==null?"":Px.call(g,S)}function ko(g){var S=g==null?0:g.length;return S?g[S-1]:n}function LC(g,S,A){var U=g==null?0:g.length;if(!U)return-1;var q=U;return A!==n&&(q=mn(A),q=q<0?hr(U+q,0):Ss(q,U-1)),S===S?Tx(g,S,q):th(g,bw,q,!0)}function HD(g,S){return g&&g.length?nC(g,mn(S)):n}var $D=vn(MC);function MC(g,S){return g&&g.length&&S&&S.length?My(g,S):g}function $l(g,S,A){return g&&g.length&&S&&S.length?My(g,S,Bt(A,2)):g}function __(g,S,A){return g&&g.length&&S&&S.length?My(g,S,n,A):g}var UC=fc(function(g,S){var A=g==null?0:g.length,U=Iy(g,S);return sC(g,Hi(S,function(q){return Do(q,A)?+q:q}).sort(Wy)),U});function zD(g,S){var A=[];if(!(g&&g.length))return A;var U=-1,q=[],re=g.length;for(S=Bt(S,3);++U<re;){var de=g[U];S(de,U,g)&&(A.push(de),q.push(U))}return sC(g,q),A}function l0(g){return g==null?g:Lx.call(g)}function GD(g,S,A){var U=g==null?0:g.length;return U?(A&&typeof A!="number"&&Us(g,S,A)?(S=0,A=U):(S=S==null?0:mn(S),A=A===n?U:mn(A)),xo(g,S,A)):[]}function KD(g,S){return t_(g,S)}function jC(g,S,A){return ph(g,S,Bt(A,2))}function FC(g,S){var A=g==null?0:g.length;if(A){var U=t_(g,S);if(U<A&&ta(g[U],S))return U}return-1}function VC(g,S){return t_(g,S,!0)}function BC(g,S,A){return ph(g,S,Bt(A,2),!0)}function qD(g,S){var A=g==null?0:g.length;if(A){var U=t_(g,S,!0)-1;if(ta(g[U],S))return U}return-1}function YD(g){return g&&g.length?mh(g):[]}function WC(g,S){return g&&g.length?mh(g,Bt(S,2)):[]}function XD(g){var S=g==null?0:g.length;return S?xo(g,1,S):[]}function JD(g,S,A){return g&&g.length?(S=A||S===n?1:mn(S),xo(g,0,S<0?0:S)):[]}function QD(g,S,A){var U=g==null?0:g.length;return U?(S=A||S===n?1:mn(S),S=U-S,xo(g,S<0?0:S,U)):[]}function ZD(g,S){return g&&g.length?Li(g,Bt(S,3),!1,!0):[]}function td(g,S){return g&&g.length?Li(g,Bt(S,3)):[]}var HC=vn(function(g){return jl(hs(g,1,Cr,!0))}),$C=vn(function(g){var S=ko(g);return Cr(S)&&(S=n),jl(hs(g,1,Cr,!0),Bt(S,2))}),ek=vn(function(g){var S=ko(g);return S=typeof S=="function"?S:n,jl(hs(g,1,Cr,!0),n,S)});function Eh(g){return g&&g.length?jl(g):[]}function u0(g,S){return g&&g.length?jl(g,Bt(S,2)):[]}function tk(g,S){return S=typeof S=="function"?S:n,g&&g.length?jl(g,n,S):[]}function E_(g){if(!(g&&g.length))return[];var S=0;return g=Bc(g,function(A){if(Cr(A))return S=hr(A.length,S),!0}),fy(S,function(A){return Hi(g,uy(A))})}function zC(g,S){if(!(g&&g.length))return[];var A=E_(g);return S==null?A:Hi(A,function(U){return Jr(S,n,U)})}var d0=vn(function(g,S){return Cr(g)?yp(g,S):[]}),GC=vn(function(g){return Fy(Bc(g,Cr))}),nk=vn(function(g){var S=ko(g);return Cr(S)&&(S=n),Fy(Bc(g,Cr),Bt(S,2))}),ik=vn(function(g){var S=ko(g);return S=typeof S=="function"?S:n,Fy(Bc(g,Cr),n,S)}),rk=vn(E_);function sk(g,S){return uC(g||[],S||[],vp)}function ok(g,S){return uC(g||[],S||[],Ul)}var KC=vn(function(g){var S=g.length,A=S>1?g[S-1]:n;return A=typeof A=="function"?(g.pop(),A):n,zC(g,A)});function v_(g){var S=ne(g);return S.__chain__=!0,S}function ak(g,S){return S(g),g}function vh(g,S){return S(g)}var ck=fc(function(g){var S=g.length,A=S?g[0]:0,U=this.__wrapped__,q=function(re){return Iy(re,g)};return S>1||this.__actions__.length||!(U instanceof On)||!Do(A)?this.thru(q):(U=U.slice(A,+A+(S?1:0)),U.__actions__.push({func:vh,args:[q],thisArg:n}),new No(U,this.__chain__).thru(function(re){return S&&!re.length&&re.push(n),re}))});function lk(){return v_(this)}function uk(){return new No(this.value(),this.__chain__)}function dk(){this.__values__===n&&(this.__values__=_R(this.value()));var g=this.__index__>=this.__values__.length,S=g?n:this.__values__[this.__index__++];return{done:g,value:S}}function qC(){return this}function hk(g){for(var S,A=this;A instanceof zg;){var U=wC(A);U.__index__=0,U.__values__=n,S?q.__wrapped__=U:S=U;var q=U;A=A.__wrapped__}return q.__wrapped__=g,S}function h0(){var g=this.__wrapped__;if(g instanceof On){var S=g;return this.__actions__.length&&(S=new On(this)),S=S.reverse(),S.__actions__.push({func:vh,args:[l0],thisArg:n}),new No(S,this.__chain__)}return this.thru(l0)}function YC(){return lC(this.__wrapped__,this.__actions__)}var fk=i_(function(g,S,A){ai.call(g,A)?++g[A]:Kc(g,A,1)});function XC(g,S,A){var U=un(g)?vw:oD;return A&&Us(g,S,A)&&(S=n),U(g,Bt(S,3))}function pk(g,S){var A=un(g)?Bc:qg;return A(g,Bt(S,3))}var mk=_C(a0),gk=_C(c0);function _k(g,S){return hs(y_(g,S),1)}function Ek(g,S){return hs(y_(g,S),Oe)}function vk(g,S,A){return A=A===n?1:mn(A),hs(y_(g,S),A)}function JC(g,S){var A=un(g)?Jo:qc;return A(g,Bt(S,3))}function QC(g,S){var A=un(g)?Wi:Jw;return A(g,Bt(S,3))}var yk=i_(function(g,S,A){ai.call(g,A)?g[A].push(S):Kc(g,A,[S])});function Sk(g,S,A,U){g=js(g)?g:Gl(g),A=A&&!U?mn(A):0;var q=g.length;return A<0&&(A=hr(q+A,0)),I_(g)?A<=q&&g.indexOf(S,A)>-1:!!q&&nh(g,S,A)>-1}var Tk=vn(function(g,S,A){var U=-1,q=typeof S=="function",re=js(g)?Pe(g.length):[];return qc(g,function(de){re[++U]=q?Jr(S,de,A):Ll(de,S,A)}),re}),bk=i_(function(g,S,A){Kc(g,A,S)});function y_(g,S){var A=un(g)?Hi:ky;return A(g,Bt(S,3))}function wk(g,S,A,U){return g==null?[]:(un(S)||(S=S==null?[]:[S]),A=U?n:A,un(A)||(A=A==null?[]:[A]),Ly(g,S,A))}var Ck=i_(function(g,S,A){g[A?0:1].push(S)},function(){return[[],[]]});function Rk(g,S,A){var U=un(g)?ay:Cw,q=arguments.length<3;return U(g,Bt(S,4),A,q,qc)}function Ik(g,S,A){var U=un(g)?mx:Cw,q=arguments.length<3;return U(g,Bt(S,4),A,q,Jw)}function Ak(g,S){var A=un(g)?Bc:qg;return A(g,kp(Bt(S,3)))}function Ok(g){var S=un(g)?Cy:vD;return S(g)}function Nk(g,S,A){(A?Us(g,S,A):S===n)?S=1:S=mn(S);var U=un(g)?iD:oC;return U(g,S)}function Pk(g){var S=un(g)?Gw:yD;return S(g)}function ZC(g){if(g==null)return 0;if(js(g))return I_(g)?rh(g):g.length;var S=bs(g);return S==rn||S==wi?g.size:Qg(g).length}function eR(g,S,A){var U=un(g)?cy:fh;return A&&Us(g,S,A)&&(S=n),U(g,Bt(S,3))}var xk=vn(function(g,S){if(g==null)return[];var A=S.length;return A>1&&Us(g,S[0],S[1])?S=[]:A>2&&Us(S[0],S[1],S[2])&&(S=[S[0]]),Ly(g,hs(S,1),[])}),S_=Ox||function(){return ds.Date.now()};function T_(g,S){if(typeof S!="function")throw new Zo(d);return g=mn(g),function(){if(--g<1)return S.apply(this,arguments)}}function b_(g,S,A){return S=A?n:S,S=g&&S==null?g.length:S,Xc(g,oe,n,n,n,n,S)}function f0(g,S){var A;if(typeof S!="function")throw new Zo(d);return g=mn(g),function(){return--g>0&&(A=S.apply(this,arguments)),g<=1&&(S=n),A}}var yh=vn(function(g,S,A){var U=K;if(A.length){var q=Nl(A,Ju(yh));U|=Z}return Xc(g,U,S,A,q)}),p0=vn(function(g,S,A){var U=K|W;if(A.length){var q=Nl(A,Ju(p0));U|=Z}return Xc(S,U,g,A,q)});function tR(g,S,A){S=A?n:S;var U=Xc(g,G,n,n,n,n,n,S);return U.placeholder=tR.placeholder,U}function m0(g,S,A){S=A?n:S;var U=Xc(g,Q,n,n,n,n,n,S);return U.placeholder=m0.placeholder,U}function g0(g,S,A){var U,q,re,de,ge,Re,Ye=0,Xe=!1,tt=!1,pt=!0;if(typeof g!="function")throw new Zo(d);S=na(S)||0,$i(A)&&(Xe=!!A.leading,tt="maxWait"in A,re=tt?hr(na(A.maxWait)||0,S):re,pt="trailing"in A?!!A.trailing:pt);function _t(Rr){var La=U,tl=q;return U=q=n,Ye=Rr,de=g.apply(tl,La),de}function Ht(Rr){return Ye=Rr,ge=Hl(Nn,S),Xe?_t(Rr):de}function yn(Rr){var La=Rr-Re,tl=Rr-Ye,D_=S-La;return tt?Ss(D_,re-tl):D_}function Wt(Rr){var La=Rr-Re,tl=Rr-Ye;return Re===n||La>=S||La<0||tt&&tl>=re}function Nn(){var Rr=S_();if(Wt(Rr))return kn(Rr);ge=Hl(Nn,yn(Rr))}function kn(Rr){return ge=n,pt&&U?_t(Rr):(U=q=n,de)}function ro(){ge!==n&&dC(ge),Ye=0,U=Re=q=ge=n}function Bs(){return ge===n?de:kn(S_())}function so(){var Rr=S_(),La=Wt(Rr);if(U=arguments,q=this,Re=Rr,La){if(ge===n)return Ht(Re);if(tt)return dC(ge),ge=Hl(Nn,S),_t(Re)}return ge===n&&(ge=Hl(Nn,S)),de}return so.cancel=ro,so.flush=Bs,so}var Dk=vn(function(g,S){return Xw(g,1,S)}),nR=vn(function(g,S,A){return Xw(g,na(S)||0,A)});function iR(g){return Xc(g,Se)}function w_(g,S){if(typeof g!="function"||S!=null&&typeof S!="function")throw new Zo(d);var A=function(){var U=arguments,q=S?S.apply(this,U):U[0],re=A.cache;if(re.has(q))return re.get(q);var de=g.apply(this,U);return A.cache=re.set(q,de)||re,de};return A.cache=new(w_.Cache||dc),A}w_.Cache=dc;function kp(g){if(typeof g!="function")throw new Zo(d);return function(){var S=arguments;switch(S.length){case 0:return!g.call(this);case 1:return!g.call(this,S[0]);case 2:return!g.call(this,S[0],S[1]);case 3:return!g.call(this,S[0],S[1],S[2])}return!g.apply(this,S)}}function rR(g){return f0(2,g)}var kk=SD(function(g,S){S=S.length==1&&un(S[0])?Hi(S[0],Ao(Bt())):Hi(hs(S,1),Ao(Bt()));var A=S.length;return vn(function(U){for(var q=-1,re=Ss(U.length,A);++q<re;)U[q]=S[q].call(this,U[q]);return Jr(g,this,U)})}),_0=vn(function(g,S){var A=Nl(S,Ju(_0));return Xc(g,Z,n,S,A)}),sR=vn(function(g,S){var A=Nl(S,Ju(sR));return Xc(g,Y,n,S,A)}),Lk=fc(function(g,S){return Xc(g,ce,n,n,n,S)});function Mk(g,S){if(typeof g!="function")throw new Zo(d);return S=S===n?S:mn(S),vn(g,S)}function Uk(g,S){if(typeof g!="function")throw new Zo(d);return S=S==null?0:hr(mn(S),0),vn(function(A){var U=A[S],q=Vl(A,0,S);return U&&Ol(q,U),Jr(g,this,q)})}function oR(g,S,A){var U=!0,q=!0;if(typeof g!="function")throw new Zo(d);return $i(A)&&(U="leading"in A?!!A.leading:U,q="trailing"in A?!!A.trailing:q),g0(g,S,{leading:U,maxWait:S,trailing:q})}function aR(g){return b_(g,1)}function E0(g,S){return _0(n_(S),g)}function cR(){if(!arguments.length)return[];var g=arguments[0];return un(g)?g:[g]}function v0(g){return Po(g,P)}function jk(g,S){return S=typeof S=="function"?S:n,Po(g,P,S)}function Fk(g){return Po(g,w|P)}function Vk(g,S){return S=typeof S=="function"?S:n,Po(g,w|P,S)}function lR(g,S){return S==null||Yw(g,S,Qr(S))}function ta(g,S){return g===S||g!==g&&S!==S}var Bk=a_(Oy),Wk=a_(function(g,S){return g>=S}),Zc=Py(function(){return arguments}())?Py:function(g){return er(g)&&ai.call(g,"callee")&&!Lw.call(g,"callee")},un=Pe.isArray,Hk=xg?Ao(xg):dD;function js(g){return g!=null&&R_(g.length)&&!ka(g)}function Cr(g){return er(g)&&js(g)}function uR(g){return g===!0||g===!1||er(g)&&Ts(g)==ti}var zl=Mw||bh,$k=mw?Ao(mw):eC;function zk(g){return er(g)&&g.nodeType===1&&!Sh(g)}function C_(g){if(g==null)return!0;if(js(g)&&(un(g)||typeof g=="string"||typeof g.splice=="function"||zl(g)||id(g)||Zc(g)))return!g.length;var S=bs(g);if(S==rn||S==wi)return!g.size;if(Zu(g))return!Qg(g).length;for(var A in g)if(ai.call(g,A))return!1;return!0}function dR(g,S){return Ml(g,S)}function hR(g,S,A){A=typeof A=="function"?A:n;var U=A?A(g,S):n;return U===n?Ml(g,S,n,A):!!U}function y0(g){if(!er(g))return!1;var S=Ts(g);return S==En||S==xn||typeof g.message=="string"&&typeof g.name=="string"&&!Sh(g)}function fR(g){return typeof g=="number"&&$g(g)}function ka(g){if(!$i(g))return!1;var S=Ts(g);return S==Di||S==ui||S==qt||S==qr}function S0(g){return typeof g=="number"&&g==mn(g)}function R_(g){return typeof g=="number"&&g>-1&&g%1==0&&g<=_e}function $i(g){var S=typeof g;return g!=null&&(S=="object"||S=="function")}function er(g){return g!=null&&typeof g=="object"}var nd=ry?Ao(ry):fD;function T0(g,S){return g===S||Xg(g,S,u_(S))}function Gk(g,S,A){return A=typeof A=="function"?A:n,Xg(g,S,u_(S),A)}function Kk(g){return mR(g)&&g!=+g}function qk(g){if(ND(g))throw new on(l);return tC(g)}function Yk(g){return g===null}function pR(g){return g==null}function mR(g){return typeof g=="number"||er(g)&&Ts(g)==Rn}function Sh(g){if(!er(g)||Ts(g)!=di)return!1;var S=Bg(g);if(S===null)return!0;var A=ai.call(S,"constructor")&&S.constructor;return typeof A=="function"&&A instanceof A&&Mg.call(A)==Rx}var b0=gw?Ao(gw):pD;function Xk(g){return S0(g)&&g>=-_e&&g<=_e}var w0=_w?Ao(_w):mD;function I_(g){return typeof g=="string"||!un(g)&&er(g)&&Ts(g)==Ne}function no(g){return typeof g=="symbol"||er(g)&&Ts(g)==dt}var id=Ew?Ao(Ew):xy;function Jk(g){return g===n}function Qk(g){return er(g)&&bs(g)==st}function gR(g){return er(g)&&Ts(g)==Ot}var Lp=a_(Zg),Zk=a_(function(g,S){return g<=S});function _R(g){if(!g)return[];if(js(g))return I_(g)?Qs(g):eo(g);if(mp&&g[mp])return Qo(g[mp]());var S=bs(g),A=S==rn?kg:S==wi?Lg:Gl;return A(g)}function O(g){if(!g)return g===0?g:0;if(g=na(g),g===Oe||g===-Oe){var S=g<0?-1:1;return S*We}return g===g?g:0}function mn(g){var S=O(g),A=S%1;return S===S?A?S-A:S:0}function ER(g){return g?$u(mn(g),0,De):0}function na(g){if(typeof g=="number")return g;if(no(g))return Ie;if($i(g)){var S=typeof g.valueOf=="function"?g.valueOf():g;g=$i(S)?S+"":S}if(typeof g!="string")return g===0?g:+g;g=Iw(g);var A=Cg.test(g);return A||tx.test(g)?fx(g.slice(2),A?2:8):Cl.test(g)?Ie:+g}function vR(g){return ea(g,Vs(g))}function eL(g){return g?$u(mn(g),-_e,_e):g===0?g:0}function qn(g){return g==null?"":Zs(g)}var tL=Ku(function(g,S){if(Zu(S)||js(S)){ea(S,Qr(S),g);return}for(var A in S)ai.call(S,A)&&vp(g,A,S[A])}),Fs=Ku(function(g,S){ea(S,Vs(S),g)}),Mp=Ku(function(g,S,A,U){ea(S,Vs(S),g,U)}),nL=Ku(function(g,S,A,U){ea(S,Qr(S),g,U)}),yR=fc(Iy);function iL(g,S){var A=uh(g);return S==null?A:Kw(A,S)}var C0=vn(function(g,S){g=gi(g);var A=-1,U=S.length,q=U>2?S[2]:n;for(q&&Us(S[0],S[1],q)&&(U=1);++A<U;)for(var re=S[A],de=Vs(re),ge=-1,Re=de.length;++ge<Re;){var Ye=de[ge],Xe=g[Ye];(Xe===n||ta(Xe,oh[Ye])&&!ai.call(g,Ye))&&(g[Ye]=re[Ye])}return g}),rL=vn(function(g){return g.push(n,Rp),Jr(A0,n,g)});function sL(g,S){return Sw(g,Bt(S,3),Na)}function oL(g,S){return Sw(g,Bt(S,3),Yg)}function aL(g,S){return g==null?g:Ay(g,Bt(S,3),Vs)}function SR(g,S){return g==null?g:Qw(g,Bt(S,3),Vs)}function TR(g,S){return g&&Na(g,Bt(S,3))}function cL(g,S){return g&&Yg(g,Bt(S,3))}function lL(g){return g==null?[]:hh(g,Qr(g))}function bR(g){return g==null?[]:hh(g,Vs(g))}function R0(g,S,A){var U=g==null?n:zu(g,S);return U===n?A:U}function uL(g,S){return g!=null&&yC(g,S,aD)}function A_(g,S){return g!=null&&yC(g,S,cD)}var dL=zy(function(g,S,A){S!=null&&typeof S.toString!="function"&&(S=jg.call(S)),g[S]=A},O0(io)),hL=zy(function(g,S,A){S!=null&&typeof S.toString!="function"&&(S=jg.call(S)),ai.call(g,S)?g[S].push(A):g[S]=[A]},Bt),wR=vn(Ll);function Qr(g){return js(g)?zw(g):Qg(g)}function Vs(g){return js(g)?zw(g,!0):Dy(g)}function I0(g,S){var A={};return S=Bt(S,3),Na(g,function(U,q,re){Kc(A,S(U,q,re),U)}),A}function fL(g,S){var A={};return S=Bt(S,3),Na(g,function(U,q,re){Kc(A,q,S(U,q,re))}),A}var pL=Ku(function(g,S,A){Gu(g,S,A)}),A0=Ku(function(g,S,A,U){Gu(g,S,A,U)}),mL=fc(function(g,S){var A={};if(g==null)return A;var U=!1;S=Hi(S,function(re){return re=Fl(re,g),U||(U=re.length>1),re}),ea(g,l_(g),A),U&&(A=Po(A,w|I|P,qy));for(var q=S.length;q--;)jy(A,S[q]);return A});function CR(g,S){return el(g,kp(Bt(S)))}var RR=fc(function(g,S){return g==null?{}:iC(g,S)});function el(g,S){if(g==null)return{};var A=Hi(l_(g),function(U){return[U]});return S=Bt(S),rC(g,A,function(U,q){return S(U,q[0])})}function IR(g,S,A){S=Fl(S,g);var U=-1,q=S.length;for(q||(q=1,g=n);++U<q;){var re=g==null?n:g[Da(S[U])];re===n&&(U=q,re=A),g=ka(re)?re.call(g):re}return g}function gL(g,S,A){return g==null?g:Ul(g,S,A)}function _L(g,S,A,U){return U=typeof U=="function"?U:n,g==null?g:Ul(g,S,A,U)}var AR=Ur(Qr),OR=Ur(Vs);function NR(g,S,A){var U=un(g),q=U||zl(g)||id(g);if(S=Bt(S,4),A==null){var re=g&&g.constructor;q?A=U?new re:[]:$i(g)?A=ka(re)?uh(Bg(g)):{}:A={}}return(q?Jo:Na)(g,function(de,ge,Re){return S(A,de,ge,Re)}),A}function EL(g,S){return g==null?!0:jy(g,S)}function vL(g,S,A){return g==null?g:cC(g,S,n_(A))}function yL(g,S,A,U){return U=typeof U=="function"?U:n,g==null?g:cC(g,S,n_(A),U)}function Gl(g){return g==null?[]:py(g,Qr(g))}function Up(g){return g==null?[]:py(g,Vs(g))}function SL(g,S,A){return A===n&&(A=S,S=n),A!==n&&(A=na(A),A=A===A?A:0),S!==n&&(S=na(S),S=S===S?S:0),$u(na(g),S,A)}function TL(g,S,A){return S=O(S),A===n?(A=S,S=0):A=O(A),g=na(g),lD(g,S,A)}function bL(g,S,A){if(A&&typeof A!="boolean"&&Us(g,S,A)&&(S=A=n),A===n&&(typeof S=="boolean"?(A=S,S=n):typeof g=="boolean"&&(A=g,g=n)),g===n&&S===n?(g=0,S=1):(g=O(g),S===n?(S=g,g=0):S=O(S)),g>S){var U=g;g=S,S=U}if(A||g%1||S%1){var q=kl();return Ss(g+q*(S-g+hx("1e-"+((q+"").length-1))),S)}return e_(g,S)}var wL=Yc(function(g,S,A){return S=S.toLowerCase(),g+(A?PR(S):S)});function PR(g){return O_(qn(g).toLowerCase())}function xR(g){return g=qn(g),g&&g.replace(zv,Ex).replace(Zv,"")}function DR(g,S,A){g=qn(g),S=Zs(S);var U=g.length;A=A===n?U:$u(mn(A),0,U);var q=A;return A-=S.length,A>=0&&g.slice(A,q)==S}function CL(g){return g=qn(g),g&&Yr.test(g)?g.replace(hn,Nw):g}function RL(g){return g=qn(g),g&&ZP.test(g)?g.replace(Jd,"\\$&"):g}var IL=Yc(function(g,S,A){return g+(A?"-":"")+S.toLowerCase()}),AL=Yc(function(g,S,A){return g+(A?" ":"")+S.toLowerCase()}),OL=qu("toLowerCase");function kR(g,S,A){g=qn(g),S=mn(S);var U=S?rh(g):0;if(!S||U>=S)return g;var q=(S-U)/2;return Yu(Hg(q),A)+g+Yu(Wg(q),A)}function NL(g,S,A){g=qn(g),S=mn(S);var U=S?rh(g):0;return S&&U<S?g+Yu(S-U,A):g}function PL(g,S,A){g=qn(g),S=mn(S);var U=S?rh(g):0;return S&&U<S?Yu(S-U,A)+g:g}function LR(g,S,A){return A||S==null?S=0:S&&(S=+S),kx(qn(g).replace(dr,""),S||0)}function xL(g,S,A){return(A?Us(g,S,A):S===n)?S=1:S=mn(S),Uy(qn(g),S)}function DL(){var g=arguments,S=qn(g[0]);return g.length<3?S:S.replace(g[1],g[2])}var kL=Yc(function(g,S,A){return g+(A?"_":"")+S.toLowerCase()});function LL(g,S,A){return A&&typeof A!="number"&&Us(g,S,A)&&(S=A=n),A=A===n?De:A>>>0,A?(g=qn(g),g&&(typeof S=="string"||S!=null&&!b0(S))&&(S=Zs(S),!S&&ih(g))?Vl(Qs(g),0,A):g.split(S,A)):[]}var ML=Yc(function(g,S,A){return g+(A?" ":"")+O_(S)});function UL(g,S,A){return g=qn(g),A=A==null?0:$u(mn(A),0,g.length),S=Zs(S),g.slice(A,A+S.length)==S}function MR(g,S,A){var U=ne.templateSettings;A&&Us(g,S,A)&&(S=n),g=qn(g),S=Mp({},S,U,c_);var q=Mp({},S.imports,U.imports,c_),re=Qr(q),de=py(q,re),ge,Re,Ye=0,Xe=S.interpolate||Rg,tt="__p += '",pt=vy((S.escape||Rg).source+"|"+Xe.source+"|"+(Xe===ap?Qb:Rg).source+"|"+(S.evaluate||Rg).source+"|$","g"),_t="//# sourceURL="+(ai.call(S,"sourceURL")?(S.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++dw+"]")+`
`;g.replace(pt,function(Wt,Nn,kn,ro,Bs,so){return kn||(kn=ro),tt+=g.slice(Ye,so).replace(Gv,vx),Nn&&(ge=!0,tt+=`' +
__e(`+Nn+`) +
'`),Bs&&(Re=!0,tt+=`';
`+Bs+`;
__p += '`),kn&&(tt+=`' +
((__t = (`+kn+`)) == null ? '' : __t) +
'`),Ye=so+Wt.length,Wt}),tt+=`';
`;var Ht=ai.call(S,"variable")&&S.variable;if(!Ht)tt=`with (obj) {
`+tt+`
}
`;else if($v.test(Ht))throw new on(f);tt=(Re?tt.replace(bg,""):tt).replace(sp,"$1").replace(op,"$1;"),tt="function("+(Ht||"obj")+`) {
`+(Ht?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(ge?", __e = _.escape":"")+(Re?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+tt+`return __p
}`;var yn=FR(function(){return Xn(re,_t+"return "+tt).apply(n,de)});if(yn.source=tt,y0(yn))throw yn;return yn}function jL(g){return qn(g).toLowerCase()}function FL(g){return qn(g).toUpperCase()}function VL(g,S,A){if(g=qn(g),g&&(A||S===n))return Iw(g);if(!g||!(S=Zs(S)))return g;var U=Qs(g),q=Qs(S),re=Aw(U,q),de=Ow(U,q)+1;return Vl(U,re,de).join("")}function BL(g,S,A){if(g=qn(g),g&&(A||S===n))return g.slice(0,my(g)+1);if(!g||!(S=Zs(S)))return g;var U=Qs(g),q=Ow(U,Qs(S))+1;return Vl(U,0,q).join("")}function UR(g,S,A){if(g=qn(g),g&&(A||S===n))return g.replace(dr,"");if(!g||!(S=Zs(S)))return g;var U=Qs(g),q=Aw(U,Qs(S));return Vl(U,q).join("")}function WL(g,S){var A=xe,U=je;if($i(S)){var q="separator"in S?S.separator:q;A="length"in S?mn(S.length):A,U="omission"in S?Zs(S.omission):U}g=qn(g);var re=g.length;if(ih(g)){var de=Qs(g);re=de.length}if(A>=re)return g;var ge=A-rh(U);if(ge<1)return U;var Re=de?Vl(de,0,ge).join(""):g.slice(0,ge);if(q===n)return Re+U;if(de&&(ge+=Re.length-ge),b0(q)){if(g.slice(ge).search(q)){var Ye,Xe=Re;for(q.global||(q=vy(q.source,qn(Zb.exec(q))+"g")),q.lastIndex=0;Ye=q.exec(Xe);)var tt=Ye.index;Re=Re.slice(0,tt===n?ge:tt)}}else if(g.indexOf(Zs(q),ge)!=ge){var pt=Re.lastIndexOf(q);pt>-1&&(Re=Re.slice(0,pt))}return Re+U}function HL(g){return g=qn(g),g&&wr.test(g)?g.replace(sn,bx):g}var $L=Yc(function(g,S,A){return g+(A?" ":"")+S.toUpperCase()}),O_=qu("toUpperCase");function jR(g,S,A){return g=qn(g),S=A?n:S,S===n?fp(g)?_y(g):ly(g):g.match(S)||[]}var FR=vn(function(g,S){try{return Jr(g,n,S)}catch(A){return y0(A)?A:new on(A)}}),zL=fc(function(g,S){return Jo(S,function(A){A=Da(A),Kc(g,A,yh(g[A],g))}),g});function GL(g){var S=g==null?0:g.length,A=Bt();return g=S?Hi(g,function(U){if(typeof U[1]!="function")throw new Zo(d);return[A(U[0]),U[1]]}):[],vn(function(U){for(var q=-1;++q<S;){var re=g[q];if(Jr(re[0],this,U))return Jr(re[1],this,U)}})}function KL(g){return qw(Po(g,w))}function O0(g){return function(){return g}}function qL(g,S){return g==null||g!==g?S:g}var VR=EC(),YL=EC(!0);function io(g){return g}function N0(g){return Jg(typeof g=="function"?g:Po(g,w))}function XL(g){return Sp(Po(g,w))}function JL(g,S){return Tp(g,Po(S,w))}var QL=vn(function(g,S){return function(A){return Ll(A,g,S)}}),ZL=vn(function(g,S){return function(A){return Ll(g,A,S)}});function N_(g,S,A){var U=Qr(S),q=hh(S,U);A==null&&!($i(S)&&(q.length||!U.length))&&(A=S,S=g,g=this,q=hh(S,Qr(S)));var re=!($i(A)&&"chain"in A)||!!A.chain,de=ka(g);return Jo(q,function(ge){var Re=S[ge];g[ge]=Re,de&&(g.prototype[ge]=function(){var Ye=this.__chain__;if(re||Ye){var Xe=g(this.__wrapped__),tt=Xe.__actions__=eo(this.__actions__);return tt.push({func:Re,args:arguments,thisArg:g}),Xe.__chain__=Ye,Xe}return Re.apply(g,Ol([this.value()],arguments))})}),g}function eM(){return ds._===this&&(ds._=Ix),this}function P0(){}function BR(g){return g=mn(g),vn(function(S){return nC(S,g)})}var tM=Gy(Hi),P_=Gy(vw),WR=Gy(cy);function Th(g){return p_(g)?uy(Da(g)):_D(g)}function nM(g){return function(S){return g==null?n:zu(g,S)}}var iM=o_(),rM=o_(!0);function x0(){return[]}function bh(){return!1}function sM(){return{}}function HR(){return""}function D0(){return!0}function k0(g,S){if(g=mn(g),g<1||g>_e)return[];var A=De,U=Ss(g,De);S=Bt(S),g-=De;for(var q=fy(U,S);++A<g;)S(A);return q}function oM(g){return un(g)?Hi(g,Da):no(g)?[g]:eo(s0(qn(g)))}function aM(g){var S=++Cx;return qn(g)+S}var cM=Pa(function(g,S){return g+S},0),lM=Bl("ceil"),uM=Pa(function(g,S){return g/S},1),x_=Bl("floor");function dM(g){return g&&g.length?dh(g,io,Oy):n}function wh(g,S){return g&&g.length?dh(g,Bt(S,2),Oy):n}function L0(g){return ww(g,io)}function jp(g,S){return ww(g,Bt(S,2))}function Ch(g){return g&&g.length?dh(g,io,Zg):n}function $R(g,S){return g&&g.length?dh(g,Bt(S,2),Zg):n}var M0=Pa(function(g,S){return g*S},1),Fp=Bl("round"),hM=Pa(function(g,S){return g-S},0);function fM(g){return g&&g.length?hy(g,io):0}function pM(g,S){return g&&g.length?hy(g,Bt(S,2)):0}return ne.after=T_,ne.ary=b_,ne.assign=tL,ne.assignIn=Fs,ne.assignInWith=Mp,ne.assignWith=nL,ne.at=yR,ne.before=f0,ne.bind=yh,ne.bindAll=zL,ne.bindKey=p0,ne.castArray=cR,ne.chain=v_,ne.chunk=DD,ne.compact=CC,ne.concat=kD,ne.cond=GL,ne.conforms=KL,ne.constant=O0,ne.countBy=fk,ne.create=iL,ne.curry=tR,ne.curryRight=m0,ne.debounce=g0,ne.defaults=C0,ne.defaultsDeep=rL,ne.defer=Dk,ne.delay=nR,ne.difference=o0,ne.differenceBy=LD,ne.differenceWith=MD,ne.drop=UD,ne.dropRight=jD,ne.dropRightWhile=FD,ne.dropWhile=VD,ne.fill=RC,ne.filter=pk,ne.flatMap=_k,ne.flatMapDeep=Ek,ne.flatMapDepth=vk,ne.flatten=IC,ne.flattenDeep=AC,ne.flattenDepth=BD,ne.flip=iR,ne.flow=VR,ne.flowRight=YL,ne.fromPairs=OC,ne.functions=lL,ne.functionsIn=bR,ne.groupBy=yk,ne.initial=xC,ne.intersection=WD,ne.intersectionBy=Dp,ne.intersectionWith=DC,ne.invert=dL,ne.invertBy=hL,ne.invokeMap=Tk,ne.iteratee=N0,ne.keyBy=bk,ne.keys=Qr,ne.keysIn=Vs,ne.map=y_,ne.mapKeys=I0,ne.mapValues=fL,ne.matches=XL,ne.matchesProperty=JL,ne.memoize=w_,ne.merge=pL,ne.mergeWith=A0,ne.method=QL,ne.methodOf=ZL,ne.mixin=N_,ne.negate=kp,ne.nthArg=BR,ne.omit=mL,ne.omitBy=CR,ne.once=rR,ne.orderBy=wk,ne.over=tM,ne.overArgs=kk,ne.overEvery=P_,ne.overSome=WR,ne.partial=_0,ne.partialRight=sR,ne.partition=Ck,ne.pick=RR,ne.pickBy=el,ne.property=Th,ne.propertyOf=nM,ne.pull=$D,ne.pullAll=MC,ne.pullAllBy=$l,ne.pullAllWith=__,ne.pullAt=UC,ne.range=iM,ne.rangeRight=rM,ne.rearg=Lk,ne.reject=Ak,ne.remove=zD,ne.rest=Mk,ne.reverse=l0,ne.sampleSize=Nk,ne.set=gL,ne.setWith=_L,ne.shuffle=Pk,ne.slice=GD,ne.sortBy=xk,ne.sortedUniq=YD,ne.sortedUniqBy=WC,ne.split=LL,ne.spread=Uk,ne.tail=XD,ne.take=JD,ne.takeRight=QD,ne.takeRightWhile=ZD,ne.takeWhile=td,ne.tap=ak,ne.throttle=oR,ne.thru=vh,ne.toArray=_R,ne.toPairs=AR,ne.toPairsIn=OR,ne.toPath=oM,ne.toPlainObject=vR,ne.transform=NR,ne.unary=aR,ne.union=HC,ne.unionBy=$C,ne.unionWith=ek,ne.uniq=Eh,ne.uniqBy=u0,ne.uniqWith=tk,ne.unset=EL,ne.unzip=E_,ne.unzipWith=zC,ne.update=vL,ne.updateWith=yL,ne.values=Gl,ne.valuesIn=Up,ne.without=d0,ne.words=jR,ne.wrap=E0,ne.xor=GC,ne.xorBy=nk,ne.xorWith=ik,ne.zip=rk,ne.zipObject=sk,ne.zipObjectDeep=ok,ne.zipWith=KC,ne.entries=AR,ne.entriesIn=OR,ne.extend=Fs,ne.extendWith=Mp,N_(ne,ne),ne.add=cM,ne.attempt=FR,ne.camelCase=wL,ne.capitalize=PR,ne.ceil=lM,ne.clamp=SL,ne.clone=v0,ne.cloneDeep=Fk,ne.cloneDeepWith=Vk,ne.cloneWith=jk,ne.conformsTo=lR,ne.deburr=xR,ne.defaultTo=qL,ne.divide=uM,ne.endsWith=DR,ne.eq=ta,ne.escape=CL,ne.escapeRegExp=RL,ne.every=XC,ne.find=mk,ne.findIndex=a0,ne.findKey=sL,ne.findLast=gk,ne.findLastIndex=c0,ne.findLastKey=oL,ne.floor=x_,ne.forEach=JC,ne.forEachRight=QC,ne.forIn=aL,ne.forInRight=SR,ne.forOwn=TR,ne.forOwnRight=cL,ne.get=R0,ne.gt=Bk,ne.gte=Wk,ne.has=uL,ne.hasIn=A_,ne.head=NC,ne.identity=io,ne.includes=Sk,ne.indexOf=PC,ne.inRange=TL,ne.invoke=wR,ne.isArguments=Zc,ne.isArray=un,ne.isArrayBuffer=Hk,ne.isArrayLike=js,ne.isArrayLikeObject=Cr,ne.isBoolean=uR,ne.isBuffer=zl,ne.isDate=$k,ne.isElement=zk,ne.isEmpty=C_,ne.isEqual=dR,ne.isEqualWith=hR,ne.isError=y0,ne.isFinite=fR,ne.isFunction=ka,ne.isInteger=S0,ne.isLength=R_,ne.isMap=nd,ne.isMatch=T0,ne.isMatchWith=Gk,ne.isNaN=Kk,ne.isNative=qk,ne.isNil=pR,ne.isNull=Yk,ne.isNumber=mR,ne.isObject=$i,ne.isObjectLike=er,ne.isPlainObject=Sh,ne.isRegExp=b0,ne.isSafeInteger=Xk,ne.isSet=w0,ne.isString=I_,ne.isSymbol=no,ne.isTypedArray=id,ne.isUndefined=Jk,ne.isWeakMap=Qk,ne.isWeakSet=gR,ne.join=kC,ne.kebabCase=IL,ne.last=ko,ne.lastIndexOf=LC,ne.lowerCase=AL,ne.lowerFirst=OL,ne.lt=Lp,ne.lte=Zk,ne.max=dM,ne.maxBy=wh,ne.mean=L0,ne.meanBy=jp,ne.min=Ch,ne.minBy=$R,ne.stubArray=x0,ne.stubFalse=bh,ne.stubObject=sM,ne.stubString=HR,ne.stubTrue=D0,ne.multiply=M0,ne.nth=HD,ne.noConflict=eM,ne.noop=P0,ne.now=S_,ne.pad=kR,ne.padEnd=NL,ne.padStart=PL,ne.parseInt=LR,ne.random=bL,ne.reduce=Rk,ne.reduceRight=Ik,ne.repeat=xL,ne.replace=DL,ne.result=IR,ne.round=Fp,ne.runInContext=we,ne.sample=Ok,ne.size=ZC,ne.snakeCase=kL,ne.some=eR,ne.sortedIndex=KD,ne.sortedIndexBy=jC,ne.sortedIndexOf=FC,ne.sortedLastIndex=VC,ne.sortedLastIndexBy=BC,ne.sortedLastIndexOf=qD,ne.startCase=ML,ne.startsWith=UL,ne.subtract=hM,ne.sum=fM,ne.sumBy=pM,ne.template=MR,ne.times=k0,ne.toFinite=O,ne.toInteger=mn,ne.toLength=ER,ne.toLower=jL,ne.toNumber=na,ne.toSafeInteger=eL,ne.toString=qn,ne.toUpper=FL,ne.trim=VL,ne.trimEnd=BL,ne.trimStart=UR,ne.truncate=WL,ne.unescape=HL,ne.uniqueId=aM,ne.upperCase=$L,ne.upperFirst=O_,ne.each=JC,ne.eachRight=QC,ne.first=NC,N_(ne,function(){var g={};return Na(ne,function(S,A){ai.call(ne.prototype,A)||(g[A]=S)}),g}(),{chain:!1}),ne.VERSION=r,Jo(["bind","bindKey","curry","curryRight","partial","partialRight"],function(g){ne[g].placeholder=ne}),Jo(["drop","take"],function(g,S){On.prototype[g]=function(A){A=A===n?1:hr(mn(A),0);var U=this.__filtered__&&!S?new On(this):this.clone();return U.__filtered__?U.__takeCount__=Ss(A,U.__takeCount__):U.__views__.push({size:Ss(A,De),type:g+(U.__dir__<0?"Right":"")}),U},On.prototype[g+"Right"]=function(A){return this.reverse()[g](A).reverse()}}),Jo(["filter","map","takeWhile"],function(g,S){var A=S+1,U=A==Ke||A==be;On.prototype[g]=function(q){var re=this.clone();return re.__iteratees__.push({iteratee:Bt(q,3),type:A}),re.__filtered__=re.__filtered__||U,re}}),Jo(["head","last"],function(g,S){var A="take"+(S?"Right":"");On.prototype[g]=function(){return this[A](1).value()[0]}}),Jo(["initial","tail"],function(g,S){var A="drop"+(S?"":"Right");On.prototype[g]=function(){return this.__filtered__?new On(this):this[A](1)}}),On.prototype.compact=function(){return this.filter(io)},On.prototype.find=function(g){return this.filter(g).head()},On.prototype.findLast=function(g){return this.reverse().find(g)},On.prototype.invokeMap=vn(function(g,S){return typeof g=="function"?new On(this):this.map(function(A){return Ll(A,g,S)})}),On.prototype.reject=function(g){return this.filter(kp(Bt(g)))},On.prototype.slice=function(g,S){g=mn(g);var A=this;return A.__filtered__&&(g>0||S<0)?new On(A):(g<0?A=A.takeRight(-g):g&&(A=A.drop(g)),S!==n&&(S=mn(S),A=S<0?A.dropRight(-S):A.take(S-g)),A)},On.prototype.takeRightWhile=function(g){return this.reverse().takeWhile(g).reverse()},On.prototype.toArray=function(){return this.take(De)},Na(On.prototype,function(g,S){var A=/^(?:filter|find|map|reject)|While$/.test(S),U=/^(?:head|last)$/.test(S),q=ne[U?"take"+(S=="last"?"Right":""):S],re=U||/^find/.test(S);q&&(ne.prototype[S]=function(){var de=this.__wrapped__,ge=U?[1]:arguments,Re=de instanceof On,Ye=ge[0],Xe=Re||un(de),tt=function(Nn){var kn=q.apply(ne,Ol([Nn],ge));return U&&pt?kn[0]:kn};Xe&&A&&typeof Ye=="function"&&Ye.length!=1&&(Re=Xe=!1);var pt=this.__chain__,_t=!!this.__actions__.length,Ht=re&&!pt,yn=Re&&!_t;if(!re&&Xe){de=yn?de:new On(this);var Wt=g.apply(de,ge);return Wt.__actions__.push({func:vh,args:[tt],thisArg:n}),new No(Wt,pt)}return Ht&&yn?g.apply(this,ge):(Wt=this.thru(tt),Ht?U?Wt.value()[0]:Wt.value():Wt)})}),Jo(["pop","push","shift","sort","splice","unshift"],function(g){var S=Hc[g],A=/^(?:push|sort|unshift)$/.test(g)?"tap":"thru",U=/^(?:pop|shift)$/.test(g);ne.prototype[g]=function(){var q=arguments;if(U&&!this.__chain__){var re=this.value();return S.apply(un(re)?re:[],q)}return this[A](function(de){return S.apply(un(de)?de:[],q)})}}),Na(On.prototype,function(g,S){var A=ne[S];if(A){var U=A.name+"";ai.call(ch,U)||(ch[U]=[]),ch[U].push({name:S,func:A})}}),ch[s_(n,W).name]=[{name:"wrapper",func:n}],On.prototype.clone=Vx,On.prototype.reverse=Bx,On.prototype.value=Wx,ne.prototype.at=ck,ne.prototype.chain=lk,ne.prototype.commit=uk,ne.prototype.next=dk,ne.prototype.plant=hk,ne.prototype.reverse=h0,ne.prototype.toJSON=ne.prototype.valueOf=ne.prototype.value=YC,ne.prototype.first=ne.prototype.head,mp&&(ne.prototype[mp]=qC),ne},Pl=Ey();Bu?((Bu.exports=Pl)._=Pl,Xr._=Pl):ds._=Pl}).call(Gt)})($1,$1.exports);var oNe=$1.exports;const Gr="/assets/icon-accounts-3b03538b.svg";function Kne({users:t}){const e=Ia(),n=r=>{e(`/profile/${r._id}`)};return R.jsx("div",{className:"FollowersCard",style:{gap:"0rem"},children:t.map(r=>R.jsx("div",{onClick:()=>n(r),className:"follower py-2 mx-2 px-2",children:R.jsxs(dn.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5},children:[R.jsx("img",{src:r.profileimage||Gr,alt:"avatar",style:{width:"2.5rem",height:"2.5rem",borderRadius:"50%"}}),R.jsxs("div",{className:"name",children:[R.jsx("span",{children:(r==null?void 0:r.fullname)||"no name available"}),R.jsx("span",{children:(r==null?void 0:r.username)||"no usernmae"})]})]})},r._id))})}Kne.propTypes={users:Le.arrayOf(Le.shape({_id:Le.string,fullname:Le.string,username:Le.string})).isRequired};var qne={},$d={};Object.defineProperty($d,"__esModule",{value:!0});$d.cssValue=$d.parseLengthAndUnit=void 0;var aNe={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0};function Yne(t){if(typeof t=="number")return{value:t,unit:"px"};var e,n=(t.match(/^[0-9.]*/)||"").toString();n.includes(".")?e=parseFloat(n):e=parseInt(n,10);var r=(t.match(/[^0-9]*$/)||"").toString();return aNe[r]?{value:e,unit:r}:(console.warn("React Spinners: ".concat(t," is not a valid css value. Defaulting to ").concat(e,"px.")),{value:e,unit:"px"})}$d.parseLengthAndUnit=Yne;function cNe(t){var e=Yne(t);return"".concat(e.value).concat(e.unit)}$d.cssValue=cNe;var Sg={};Object.defineProperty(Sg,"__esModule",{value:!0});Sg.createAnimation=void 0;var lNe=function(t,e,n){var r="react-spinners-".concat(t,"-").concat(n);if(typeof window>"u"||!window.document)return r;var c=document.createElement("style");document.head.appendChild(c);var l=c.sheet,d=`
    @keyframes `.concat(r,` {
      `).concat(e,`
    }
  `);return l&&l.insertRule(d,0),r};Sg.createAnimation=lNe;var z1=Gt&&Gt.__assign||function(){return z1=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&(t[c]=e[c])}return t},z1.apply(this,arguments)},uNe=Gt&&Gt.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n);var c=Object.getOwnPropertyDescriptor(e,n);(!c||("get"in c?!e.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,c)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),dNe=Gt&&Gt.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),hNe=Gt&&Gt.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)n!=="default"&&Object.prototype.hasOwnProperty.call(t,n)&&uNe(e,t,n);return dNe(e,t),e},fNe=Gt&&Gt.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,r=Object.getOwnPropertySymbols(t);c<r.length;c++)e.indexOf(r[c])<0&&Object.prototype.propertyIsEnumerable.call(t,r[c])&&(n[r[c]]=t[r[c]]);return n};Object.defineProperty(qne,"__esModule",{value:!0});var zA=hNe($),Yj=$d,pNe=Sg,mNe=(0,pNe.createAnimation)("BeatLoader","50% {transform: scale(0.75);opacity: 0.2} 100% {transform: scale(1);opacity: 1}","beat");function gNe(t){var e=t.loading,n=e===void 0?!0:e,r=t.color,c=r===void 0?"#000000":r,l=t.speedMultiplier,d=l===void 0?1:l,f=t.cssOverride,m=f===void 0?{}:f,E=t.size,y=E===void 0?15:E,w=t.margin,I=w===void 0?2:w,P=fNe(t,["loading","color","speedMultiplier","cssOverride","size","margin"]),k=z1({display:"inherit"},m),M=function(K){return{display:"inline-block",backgroundColor:c,width:(0,Yj.cssValue)(y),height:(0,Yj.cssValue)(y),margin:(0,Yj.cssValue)(I),borderRadius:"100%",animation:"".concat(mNe," ").concat(.7/d,"s ").concat(K%2?"0s":"".concat(.35/d,"s")," infinite linear"),animationFillMode:"both"}};return n?zA.createElement("span",z1({style:k},P),zA.createElement("span",{style:M(1)}),zA.createElement("span",{style:M(2)}),zA.createElement("span",{style:M(3)})):null}var tv=qne.default=gNe;const Xne=()=>{const t=bi(),[e,n]=$.useState(""),[r,c]=$.useState([]),[l,d]=$.useState(!0),f={margin:"0 40%"},m=oNe.debounce(async y=>{nNe(y).then(w=>{d(!1),c(w.data)}).catch(w=>{w.response.data.error==="Token has expired"&&t(Bi()),d(!1)})},400),E=y=>{const w=y.target.value;n(w),m(w)};return R.jsxs("div",{className:"LogoSearch",children:[R.jsxs("div",{className:"contents",children:[R.jsx("img",{src:RP,alt:""}),R.jsxs("div",{className:"Search",style:{width:"14rem"},children:[R.jsx("input",{type:"text",placeholder:"#Find users",value:e,onChange:E}),e.trim()!==""&&R.jsx("div",{onClick:()=>n(""),className:"s-icon",children:R.jsx("span",{className:"material-symbols-outlined",children:"cancel"})})]})]}),e.trim()!==""&&R.jsxs("div",{className:"results",children:[R.jsx(tv,{loading:l,cssOverride:f,color:"#d67b36"}),!l&&!r.length>0&&R.jsx("div",{className:"noResult",children:R.jsx("span",{className:"lg-text",children:"No Users Found!"})}),R.jsx(Kne,{users:r})]})]})},Yd=ip(),_Ne=(t,e)=>Yd.get(`/posts/${t}/timeline?page=${e}`),ENe=(t,e)=>Yd.get(`/posts/${t}/all?page=${e}`),vNe=t=>Yd.get(`posts/${t}/saved`),Jne=t=>Yd.get(`posts/${t}/liked-users`),yNe=t=>Yd.get(`posts/${t}`),SNe=(t,e)=>Yd.put(`/posts/${t}/like`,{user:e}),TNe=(t,e,n)=>Yd.put(`posts/${t}?user=${e}`,n),bNe=(t,e,n)=>Yd.patch(`posts/${t}/${e}/${n}`),wNe=(t,e)=>Yd.delete(`posts/${t}?user=${e}`),NP=_5(),CNe=()=>NP.get("/admin/userlist"),RNe=t=>NP.put("/admin/action",{user:t}),INe=(t,e)=>NP.delete(`posts/${t}?user=${e}`),ANe=()=>NP.get("/admin/dashboard"),Qne=(t,e)=>async n=>{try{if(e){n({type:"RETREIVING_START"});const{data:r}=await _Ne(t,e);n({type:"RETREIVING_SUCCESS",data:r})}}catch(r){console.log(r),r.response.data.error==="Token has expired"&&n(Bi()),n({type:"RETREIVING_FAIL"})}},ONe=(t,e)=>async n=>{n({type:"GET_POSTS_START"});try{const{data:r}=await ENe(t,e);n({type:"GET_POSTS_SUCCESS",data:r})}catch(r){console.log(r),r.response.data.error==="Token has expired"&&n(Bi()),n({type:"GET_POSTS_FAIL"})}},Zne=(t,e)=>async n=>{try{const r=await SNe(t,e);if(r.status===200){const c=r.data.includes("Post liked")?"LIKE_POST":"UNLIKE_POST";n({type:c,postId:t,userId:e})}}catch(r){r.response.data.error==="Token has expired"&&n(Bi())}},eie=(t,e,n)=>async r=>{try{return(await TNe(t,e,n)).status===200?(r({type:"EDIT_POST_SUCCESS",postId:t,editedData:n}),{success:!0}):{success:!1}}catch(c){console.log(c),c.response.data.error==="Token has expired"&&r(Bi())}},y5=(t,e,n)=>async r=>{try{return(n==="user"?await wNe(t,e):await INe(t,e)).status===200?(r({type:"DELETE_POST_SUCCESS",postId:t}),{success:!0}):{success:!1}}catch(c){console.log(c),c.response.data.error==="Token has expired"&&r(Bi())}},tie=(t,e,n)=>async r=>{try{const c=await bNe(t,e,n);return c.status===200?(r({type:"UPDATE_SAVED",postId:e,isSaved:n}),{success:!0,message:c.data.message}):{success:!1,error:c.data.error}}catch(c){return c.response.data.error==="Token has expired"&&r(Bi()),{success:!1,error:c.response.data.error}}};var nie={},G1=Gt&&Gt.__assign||function(){return G1=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&(t[c]=e[c])}return t},G1.apply(this,arguments)},NNe=Gt&&Gt.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n);var c=Object.getOwnPropertyDescriptor(e,n);(!c||("get"in c?!e.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,c)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),PNe=Gt&&Gt.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),xNe=Gt&&Gt.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)n!=="default"&&Object.prototype.hasOwnProperty.call(t,n)&&NNe(e,t,n);return PNe(e,t),e},DNe=Gt&&Gt.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,r=Object.getOwnPropertySymbols(t);c<r.length;c++)e.indexOf(r[c])<0&&Object.prototype.propertyIsEnumerable.call(t,r[c])&&(n[r[c]]=t[r[c]]);return n};Object.defineProperty(nie,"__esModule",{value:!0});var fm=xNe($),kNe=$d,vE=Sg,Eo=[1,3,5],LNe=[(0,vE.createAnimation)("PropagateLoader","25% {transform: translateX(-".concat(Eo[0],`rem) scale(0.75)}
    50% {transform: translateX(-`).concat(Eo[1],`rem) scale(0.6)}
    75% {transform: translateX(-`).concat(Eo[2],`rem) scale(0.5)}
    95% {transform: translateX(0rem) scale(1)}`),"propogate-0"),(0,vE.createAnimation)("PropagateLoader","25% {transform: translateX(-".concat(Eo[0],`rem) scale(0.75)}
    50% {transform: translateX(-`).concat(Eo[1],`rem) scale(0.6)}
    75% {transform: translateX(-`).concat(Eo[1],`rem) scale(0.6)}
    95% {transform: translateX(0rem) scale(1)}`),"propogate-1"),(0,vE.createAnimation)("PropagateLoader","25% {transform: translateX(-".concat(Eo[0],`rem) scale(0.75)}
    75% {transform: translateX(-`).concat(Eo[0],`rem) scale(0.75)}
    95% {transform: translateX(0rem) scale(1)}`),"propogate-2"),(0,vE.createAnimation)("PropagateLoader","25% {transform: translateX(".concat(Eo[0],`rem) scale(0.75)}
    75% {transform: translateX(`).concat(Eo[0],`rem) scale(0.75)}
    95% {transform: translateX(0rem) scale(1)}`),"propogate-3"),(0,vE.createAnimation)("PropagateLoader","25% {transform: translateX(".concat(Eo[0],`rem) scale(0.75)}
    50% {transform: translateX(`).concat(Eo[1],`rem) scale(0.6)}
    75% {transform: translateX(`).concat(Eo[1],`rem) scale(0.6)}
    95% {transform: translateX(0rem) scale(1)}`),"propogate-4"),(0,vE.createAnimation)("PropagateLoader","25% {transform: translateX(".concat(Eo[0],`rem) scale(0.75)}
    50% {transform: translateX(`).concat(Eo[1],`rem) scale(0.6)}
    75% {transform: translateX(`).concat(Eo[2],`rem) scale(0.5)}
    95% {transform: translateX(0rem) scale(1)}`),"propogate-5")];function MNe(t){var e=t.loading,n=e===void 0?!0:e,r=t.color,c=r===void 0?"#000000":r,l=t.speedMultiplier,d=l===void 0?1:l,f=t.cssOverride,m=f===void 0?{}:f,E=t.size,y=E===void 0?15:E,w=DNe(t,["loading","color","speedMultiplier","cssOverride","size"]),I=(0,kNe.parseLengthAndUnit)(y),P=I.value,k=I.unit,M=G1({display:"inherit",position:"relative"},m),K=function(W){return{position:"absolute",fontSize:"".concat(P/3).concat(k),width:"".concat(P).concat(k),height:"".concat(P).concat(k),background:c,borderRadius:"50%",animation:"".concat(LNe[W]," ").concat(1.5/d,"s infinite"),animationFillMode:"forwards"}};return n?fm.createElement("span",G1({style:M},w),fm.createElement("span",{style:K(0)}),fm.createElement("span",{style:K(1)}),fm.createElement("span",{style:K(2)}),fm.createElement("span",{style:K(3)}),fm.createElement("span",{style:K(4)}),fm.createElement("span",{style:K(5)})):null}var S5=nie.default=MNe;const UNe=ip(),PP=_5(),jNe=(t,e,n,r)=>UNe.post("/report",{reporterId:t,targetType:e,targetId:n,reason:r}),FNe=t=>PP.get(`/report?page=${t}`),VNe=(t,e)=>PP.get(`/report/target/${t}/${e}`),BNe=(t,e)=>PP.put(`/report/${t}/${e}`),WNe=t=>PP.delete(`/report/${t}`),T5=(t,e,n,r)=>async c=>{try{const{data:l}=await jNe(t,e,n,r);return console.log(l),l?(c({type:"CREATE_REPORT_SUCCESS",payload:l}),l.targetType==="post"&&c({type:"FILTER_REPORTED_POSTS",targetId:n}),{success:!0}):{success:!1}}catch(l){l.response.data.error==="Token has expired"&&c(Bi()),console.error("Error creating report:",l)}},Bb=ip(),HNe=_5(),$Ne=(t,e)=>Bb.post("/posts/like-comment",{commentId:t,user:e}),zNe=t=>Bb.post("/posts/comment",t),GNe=(t,e)=>Bb.put(`/posts/${t}/update-comment`,{text:e}),KNe=t=>Bb.get(`/posts/${t}/comments`),qNe=t=>Bb.delete(`/posts/${t}/comment`),YNe=t=>HNe.delete(`/posts/${t}/comment`),iie=t=>async e=>{try{const{data:n}=await zNe(t);return n.error?{success:!1,error:n.error}:(e({type:"COMMENT_SUCCESS",postId:t.postId,Id:n._id}),{success:!0})}catch(n){return console.log(n),n.response.data.error==="Token has expired"&&e(Bi()),{success:!1}}},rie=(t,e)=>n=>{n({type:"DELETE_COMMENT",id:t,postId:e})},XNe=(t,e)=>async n=>{n({type:"UPDATING_START"});try{const{data:r}=await J1e(t,e);return n({type:"UPDATING_SUCCESS",data:r}),{success:!0,message:r.message}}catch(r){return r.response.data.error==="Token has expired"&&n(Bi()),n({type:"UPDATING_FAIL"}),{success:!1,error:r.response.data.error}}},JNe=(t,e)=>async n=>{try{const{data:r}=await Q1e(t,e);return n({type:"PROFILE_UPLOAD_SUCCESS",data:e,id:t}),{success:!0,data:r}}catch(r){return r.response.data.error==="Token has expired"&&n(Bi()),{success:!1}}},QNe=(t,e)=>async n=>{try{const{data:r}=await Z1e(t,e);return n({type:"COVER_UPLOAD_SUCCESS",data:e,id:t}),{success:!0,data:r}}catch(r){return r.response.data.error==="Token has expired"&&n(Bi()),{success:!1}}},Wb=(t,e)=>async n=>{try{const r=await eNe(t,e);return r.status===201?(n({type:"FOLLOW_USER",data:t}),{success:!0,message:r.data.message}):{success:!1,error:r.data.error}}catch(r){return r.response.data.error==="Token has expired"&&n(Bi()),console.log(r),{success:!1,error:r.response.data.error}}},Hb=(t,e)=>async n=>{try{const r=await tNe(t,e);return r.status===201?(n({type:"UNFOLLOW_USER",data:t}),{success:!0,message:r.data.message}):{success:!1,error:r.data.error}}catch(r){return r.response.data.error==="Token has expired"&&n(Bi()),console.log(r),{success:!1,error:r.response.data.error}}};var sie={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var e={}.hasOwnProperty;function n(){for(var r=[],c=0;c<arguments.length;c++){var l=arguments[c];if(l){var d=typeof l;if(d==="string"||d==="number")r.push(l);else if(Array.isArray(l)){if(l.length){var f=n.apply(null,l);f&&r.push(f)}}else if(d==="object"){if(l.toString!==Object.prototype.toString&&!l.toString.toString().includes("[native code]")){r.push(l.toString());continue}for(var m in l)e.call(l,m)&&l[m]&&r.push(m)}}}return r.join(" ")}t.exports?(n.default=n,t.exports=n):window.classNames=n})()})(sie);var ZNe=sie.exports;const zd=Kf(ZNe),jv=!!(typeof window<"u"&&window.document&&window.document.createElement);var dV=!1,hV=!1;try{var Xj={get passive(){return dV=!0},get once(){return hV=dV=!0}};jv&&(window.addEventListener("test",Xj,Xj),window.removeEventListener("test",Xj,!0))}catch{}function oie(t,e,n,r){if(r&&typeof r!="boolean"&&!hV){var c=r.once,l=r.capture,d=n;!hV&&c&&(d=n.__once||function f(m){this.removeEventListener(e,f,l),n.call(this,m)},n.__once=d),t.addEventListener(e,d,dV?r:l)}t.addEventListener(e,n,r)}function xP(t){return t&&t.ownerDocument||document}function fV(t,e,n,r){var c=r&&typeof r!="boolean"?r.capture:r;t.removeEventListener(e,n,c),n.__once&&t.removeEventListener(e,n.__once,c)}var GA;function XK(t){if((!GA&&GA!==0||t)&&jv){var e=document.createElement("div");e.style.position="absolute",e.style.top="-9999px",e.style.width="50px",e.style.height="50px",e.style.overflow="scroll",document.body.appendChild(e),GA=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return GA}function ePe(){return $.useState(null)}function tPe(t){const e=$.useRef(t);return $.useEffect(()=>{e.current=t},[t]),e}function gu(t){const e=tPe(t);return $.useCallback(function(...n){return e.current&&e.current(...n)},[e])}const JK=t=>!t||typeof t=="function"?t:e=>{t.current=e};function nPe(t,e){const n=JK(t),r=JK(e);return c=>{n&&n(c),r&&r(c)}}function DP(t,e){return $.useMemo(()=>nPe(t,e),[t,e])}function iPe(t){const e=$.useRef(t);return e.current=t,e}function aie(t){const e=iPe(t);$.useEffect(()=>()=>e.current(),[])}function rPe(t){var e=xP(t);return e&&e.defaultView||window}function sPe(t,e){return rPe(t).getComputedStyle(t,e)}var oPe=/([A-Z])/g;function aPe(t){return t.replace(oPe,"-$1").toLowerCase()}var cPe=/^ms-/;function KA(t){return aPe(t).replace(cPe,"-ms-")}var lPe=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function uPe(t){return!!(t&&lPe.test(t))}function Gm(t,e){var n="",r="";if(typeof e=="string")return t.style.getPropertyValue(KA(e))||sPe(t).getPropertyValue(KA(e));Object.keys(e).forEach(function(c){var l=e[c];!l&&l!==0?t.style.removeProperty(KA(c)):uPe(c)?r+=c+"("+l+") ":n+=KA(c)+": "+l+";"}),r&&(n+="transform: "+r+";"),t.style.cssText+=";"+n}function K1(t,e,n,r){return oie(t,e,n,r),function(){fV(t,e,n,r)}}function dPe(t,e,n,r){if(n===void 0&&(n=!1),r===void 0&&(r=!0),t){var c=document.createEvent("HTMLEvents");c.initEvent(e,n,r),t.dispatchEvent(c)}}function hPe(t){var e=Gm(t,"transitionDuration")||"",n=e.indexOf("ms")===-1?1e3:1;return parseFloat(e)*n}function fPe(t,e,n){n===void 0&&(n=5);var r=!1,c=setTimeout(function(){r||dPe(t,"transitionend",!0)},e+n),l=K1(t,"transitionend",function(){r=!0},{once:!0});return function(){clearTimeout(c),l()}}function cie(t,e,n,r){n==null&&(n=hPe(t)||0);var c=fPe(t,n,r),l=K1(t,"transitionend",e);return function(){c(),l()}}function Jj(t){t===void 0&&(t=xP());try{var e=t.activeElement;return!e||!e.nodeName?null:e}catch{return t.body}}function QK(t,e){if(t.contains)return t.contains(e);if(t.compareDocumentPosition)return t===e||!!(t.compareDocumentPosition(e)&16)}function pPe(){const t=$.useRef(!0),e=$.useRef(()=>t.current);return $.useEffect(()=>(t.current=!0,()=>{t.current=!1}),[]),e.current}function mPe(t){const e=$.useRef(null);return $.useEffect(()=>{e.current=t}),e.current}const gPe="data-rr-ui-";function _Pe(t){return`${gPe}${t}`}function EPe(t=document){const e=t.defaultView;return Math.abs(e.innerWidth-t.documentElement.clientWidth)}const ZK=_Pe("modal-open");class vPe{constructor({ownerDocument:e,handleContainerOverflow:n=!0,isRTL:r=!1}={}){this.handleContainerOverflow=n,this.isRTL=r,this.modals=[],this.ownerDocument=e}getScrollbarWidth(){return EPe(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(e){}removeModalAttributes(e){}setContainerStyle(e){const n={overflow:"hidden"},r=this.isRTL?"paddingLeft":"paddingRight",c=this.getElement();e.style={overflow:c.style.overflow,[r]:c.style[r]},e.scrollBarWidth&&(n[r]=`${parseInt(Gm(c,r)||"0",10)+e.scrollBarWidth}px`),c.setAttribute(ZK,""),Gm(c,n)}reset(){[...this.modals].forEach(e=>this.remove(e))}removeContainerStyle(e){const n=this.getElement();n.removeAttribute(ZK),Object.assign(n.style,e.style)}add(e){let n=this.modals.indexOf(e);return n!==-1||(n=this.modals.length,this.modals.push(e),this.setModalAttributes(e),n!==0)||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),n}remove(e){const n=this.modals.indexOf(e);n!==-1&&(this.modals.splice(n,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(e))}isTopModal(e){return!!this.modals.length&&this.modals[this.modals.length-1]===e}}const b5=vPe,lie=$.createContext(jv?window:void 0);lie.Provider;function w5(){return $.useContext(lie)}const Qj=(t,e)=>jv?t==null?(e||xP()).body:(typeof t=="function"&&(t=t()),t&&"current"in t&&(t=t.current),t&&("nodeType"in t||t.getBoundingClientRect)?t:null):null;function yPe(t,e){const n=w5(),[r,c]=$.useState(()=>Qj(t,n==null?void 0:n.document));if(!r){const l=Qj(t);l&&c(l)}return $.useEffect(()=>{e&&r&&e(r)},[e,r]),$.useEffect(()=>{const l=Qj(t);l!==r&&c(l)},[t,r]),r}const SPe=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",TPe=typeof document<"u",eq=TPe||SPe?$.useLayoutEffect:$.useEffect;function bPe({children:t,in:e,onExited:n,mountOnEnter:r,unmountOnExit:c}){const l=$.useRef(null),d=$.useRef(e),f=gu(n);$.useEffect(()=>{e?d.current=!0:f(l.current)},[e,f]);const m=DP(l,t.ref),E=$.cloneElement(t,{ref:m});return e?E:c||!d.current&&r?null:E}function wPe({in:t,onTransition:e}){const n=$.useRef(null),r=$.useRef(!0),c=gu(e);return eq(()=>{if(!n.current)return;let l=!1;return c({in:t,element:n.current,initial:r.current,isStale:()=>l}),()=>{l=!0}},[t,c]),eq(()=>(r.current=!1,()=>{r.current=!0}),[]),n}function CPe({children:t,in:e,onExited:n,onEntered:r,transition:c}){const[l,d]=$.useState(!e);e&&l&&d(!1);const f=wPe({in:!!e,onTransition:E=>{const y=()=>{E.isStale()||(E.in?r==null||r(E.element,E.initial):(d(!0),n==null||n(E.element)))};Promise.resolve(c(E)).then(y,w=>{throw E.in||d(!0),w})}}),m=DP(f,t.ref);return l&&!e?null:$.cloneElement(t,{ref:m})}function tq(t,e,n){return t?R.jsx(t,Object.assign({},n)):e?R.jsx(CPe,Object.assign({},n,{transition:e})):R.jsx(bPe,Object.assign({},n))}function RPe(t){return t.code==="Escape"||t.keyCode===27}const IPe=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];function APe(t,e){if(t==null)return{};var n={},r=Object.keys(t),c,l;for(l=0;l<r.length;l++)c=r[l],!(e.indexOf(c)>=0)&&(n[c]=t[c]);return n}let Zj;function OPe(t){return Zj||(Zj=new b5({ownerDocument:t==null?void 0:t.document})),Zj}function NPe(t){const e=w5(),n=t||OPe(e),r=$.useRef({dialog:null,backdrop:null});return Object.assign(r.current,{add:()=>n.add(r.current),remove:()=>n.remove(r.current),isTopModal:()=>n.isTopModal(r.current),setDialogRef:$.useCallback(c=>{r.current.dialog=c},[]),setBackdropRef:$.useCallback(c=>{r.current.backdrop=c},[])})}const uie=$.forwardRef((t,e)=>{let{show:n=!1,role:r="dialog",className:c,style:l,children:d,backdrop:f=!0,keyboard:m=!0,onBackdropClick:E,onEscapeKeyDown:y,transition:w,runTransition:I,backdropTransition:P,runBackdropTransition:k,autoFocus:M=!0,enforceFocus:K=!0,restoreFocus:W=!0,restoreFocusOptions:V,renderDialog:G,renderBackdrop:Q=Rn=>R.jsx("div",Object.assign({},Rn)),manager:Z,container:Y,onShow:oe,onHide:ce=()=>{},onExit:Se,onExited:xe,onExiting:je,onEnter:Ge,onEntering:ze,onEntered:Ke}=t,He=APe(t,IPe);const be=w5(),Oe=yPe(Y),_e=NPe(Z),We=pPe(),Ie=mPe(n),[De,Ue]=$.useState(!n),rt=$.useRef(null);$.useImperativeHandle(e,()=>_e,[_e]),jv&&!Ie&&n&&(rt.current=Jj(be==null?void 0:be.document)),n&&De&&Ue(!1);const gt=gu(()=>{if(_e.add(),xn.current=K1(document,"keydown",ti),Vt.current=K1(document,"focus",()=>setTimeout(Ft),!0),oe&&oe(),M){var Rn,us;const di=Jj((Rn=(us=_e.dialog)==null?void 0:us.ownerDocument)!=null?Rn:be==null?void 0:be.document);_e.dialog&&di&&!QK(_e.dialog,di)&&(rt.current=di,_e.dialog.focus())}}),ft=gu(()=>{if(_e.remove(),xn.current==null||xn.current(),Vt.current==null||Vt.current(),W){var Rn;(Rn=rt.current)==null||Rn.focus==null||Rn.focus(V),rt.current=null}});$.useEffect(()=>{!n||!Oe||gt()},[n,Oe,gt]),$.useEffect(()=>{De&&ft()},[De,ft]),aie(()=>{ft()});const Ft=gu(()=>{if(!K||!We()||!_e.isTopModal())return;const Rn=Jj(be==null?void 0:be.document);_e.dialog&&Rn&&!QK(_e.dialog,Rn)&&_e.dialog.focus()}),qt=gu(Rn=>{Rn.target===Rn.currentTarget&&(E==null||E(Rn),f===!0&&ce())}),ti=gu(Rn=>{m&&RPe(Rn)&&_e.isTopModal()&&(y==null||y(Rn),Rn.defaultPrevented||ce())}),Vt=$.useRef(),xn=$.useRef(),En=(...Rn)=>{Ue(!0),xe==null||xe(...Rn)};if(!Oe)return null;const Di=Object.assign({role:r,ref:_e.setDialogRef,"aria-modal":r==="dialog"?!0:void 0},He,{style:l,className:c,tabIndex:-1});let ui=G?G(Di):R.jsx("div",Object.assign({},Di,{children:$.cloneElement(d,{role:"document"})}));ui=tq(w,I,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!n,onExit:Se,onExiting:je,onExited:En,onEnter:Ge,onEntering:ze,onEntered:Ke,children:ui});let rn=null;return f&&(rn=Q({ref:_e.setBackdropRef,onClick:qt}),rn=tq(P,k,{in:!!n,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:rn})),R.jsx(R.Fragment,{children:Mm.createPortal(R.jsxs(R.Fragment,{children:[rn,ui]}),Oe)})});uie.displayName="Modal";const PPe=Object.assign(uie,{Manager:b5});function xPe(t,e){return t.classList?!!e&&t.classList.contains(e):(" "+(t.className.baseVal||t.className)+" ").indexOf(" "+e+" ")!==-1}function DPe(t,e){t.classList?t.classList.add(e):xPe(t,e)||(typeof t.className=="string"?t.className=t.className+" "+e:t.setAttribute("class",(t.className&&t.className.baseVal||"")+" "+e))}var kPe=Function.prototype.bind.call(Function.prototype.call,[].slice);function yE(t,e){return kPe(t.querySelectorAll(e))}function nq(t,e){return t.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function LPe(t,e){t.classList?t.classList.remove(e):typeof t.className=="string"?t.className=nq(t.className,e):t.setAttribute("class",nq(t.className&&t.className.baseVal||"",e))}const SE={FIXED_CONTENT:".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",STICKY_CONTENT:".sticky-top",NAVBAR_TOGGLER:".navbar-toggler"};class MPe extends b5{adjustAndStore(e,n,r){const c=n.style[e];n.dataset[e]=c,Gm(n,{[e]:`${parseFloat(Gm(n,e))+r}px`})}restore(e,n){const r=n.dataset[e];r!==void 0&&(delete n.dataset[e],Gm(n,{[e]:r}))}setContainerStyle(e){super.setContainerStyle(e);const n=this.getElement();if(DPe(n,"modal-open"),!e.scrollBarWidth)return;const r=this.isRTL?"paddingLeft":"paddingRight",c=this.isRTL?"marginLeft":"marginRight";yE(n,SE.FIXED_CONTENT).forEach(l=>this.adjustAndStore(r,l,e.scrollBarWidth)),yE(n,SE.STICKY_CONTENT).forEach(l=>this.adjustAndStore(c,l,-e.scrollBarWidth)),yE(n,SE.NAVBAR_TOGGLER).forEach(l=>this.adjustAndStore(c,l,e.scrollBarWidth))}removeContainerStyle(e){super.removeContainerStyle(e);const n=this.getElement();LPe(n,"modal-open");const r=this.isRTL?"paddingLeft":"paddingRight",c=this.isRTL?"marginLeft":"marginRight";yE(n,SE.FIXED_CONTENT).forEach(l=>this.restore(r,l)),yE(n,SE.STICKY_CONTENT).forEach(l=>this.restore(c,l)),yE(n,SE.NAVBAR_TOGGLER).forEach(l=>this.restore(c,l))}}let eF;function UPe(t){return eF||(eF=new MPe(t)),eF}function pV(t,e){return pV=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,c){return r.__proto__=c,r},pV(t,e)}function jPe(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,pV(t,e)}const iq={disabled:!1},die=At.createContext(null);var FPe=function(e){return e.scrollTop},tT="unmounted",Im="exited",cf="entering",Pm="entered",mV="exiting",Xd=function(t){jPe(e,t);function e(r,c){var l;l=t.call(this,r,c)||this;var d=c,f=d&&!d.isMounting?r.enter:r.appear,m;return l.appearStatus=null,r.in?f?(m=Im,l.appearStatus=cf):m=Pm:r.unmountOnExit||r.mountOnEnter?m=tT:m=Im,l.state={status:m},l.nextCallback=null,l}e.getDerivedStateFromProps=function(c,l){var d=c.in;return d&&l.status===tT?{status:Im}:null};var n=e.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(c){var l=null;if(c!==this.props){var d=this.state.status;this.props.in?d!==cf&&d!==Pm&&(l=cf):(d===cf||d===Pm)&&(l=mV)}this.updateStatus(!1,l)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var c=this.props.timeout,l,d,f;return l=d=f=c,c!=null&&typeof c!="number"&&(l=c.exit,d=c.enter,f=c.appear!==void 0?c.appear:d),{exit:l,enter:d,appear:f}},n.updateStatus=function(c,l){if(c===void 0&&(c=!1),l!==null)if(this.cancelNextCallback(),l===cf){if(this.props.unmountOnExit||this.props.mountOnEnter){var d=this.props.nodeRef?this.props.nodeRef.current:Mm.findDOMNode(this);d&&FPe(d)}this.performEnter(c)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Im&&this.setState({status:tT})},n.performEnter=function(c){var l=this,d=this.props.enter,f=this.context?this.context.isMounting:c,m=this.props.nodeRef?[f]:[Mm.findDOMNode(this),f],E=m[0],y=m[1],w=this.getTimeouts(),I=f?w.appear:w.enter;if(!c&&!d||iq.disabled){this.safeSetState({status:Pm},function(){l.props.onEntered(E)});return}this.props.onEnter(E,y),this.safeSetState({status:cf},function(){l.props.onEntering(E,y),l.onTransitionEnd(I,function(){l.safeSetState({status:Pm},function(){l.props.onEntered(E,y)})})})},n.performExit=function(){var c=this,l=this.props.exit,d=this.getTimeouts(),f=this.props.nodeRef?void 0:Mm.findDOMNode(this);if(!l||iq.disabled){this.safeSetState({status:Im},function(){c.props.onExited(f)});return}this.props.onExit(f),this.safeSetState({status:mV},function(){c.props.onExiting(f),c.onTransitionEnd(d.exit,function(){c.safeSetState({status:Im},function(){c.props.onExited(f)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(c,l){l=this.setNextCallback(l),this.setState(c,l)},n.setNextCallback=function(c){var l=this,d=!0;return this.nextCallback=function(f){d&&(d=!1,l.nextCallback=null,c(f))},this.nextCallback.cancel=function(){d=!1},this.nextCallback},n.onTransitionEnd=function(c,l){this.setNextCallback(l);var d=this.props.nodeRef?this.props.nodeRef.current:Mm.findDOMNode(this),f=c==null&&!this.props.addEndListener;if(!d||f){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var m=this.props.nodeRef?[this.nextCallback]:[d,this.nextCallback],E=m[0],y=m[1];this.props.addEndListener(E,y)}c!=null&&setTimeout(this.nextCallback,c)},n.render=function(){var c=this.state.status;if(c===tT)return null;var l=this.props,d=l.children;l.in,l.mountOnEnter,l.unmountOnExit,l.appear,l.enter,l.exit,l.timeout,l.addEndListener,l.onEnter,l.onEntering,l.onEntered,l.onExit,l.onExiting,l.onExited,l.nodeRef;var f=c0e(l,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return At.createElement(die.Provider,{value:null},typeof d=="function"?d(c,f):At.cloneElement(At.Children.only(d),f))},e}(At.Component);Xd.contextType=die;Xd.propTypes={};function TE(){}Xd.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:TE,onEntering:TE,onEntered:TE,onExit:TE,onExiting:TE,onExited:TE};Xd.UNMOUNTED=tT;Xd.EXITED=Im;Xd.ENTERING=cf;Xd.ENTERED=Pm;Xd.EXITING=mV;const VPe=Xd;function rq(t,e){const n=Gm(t,e)||"",r=n.indexOf("ms")===-1?1e3:1;return parseFloat(n)*r}function BPe(t,e){const n=rq(t,"transitionDuration"),r=rq(t,"transitionDelay"),c=cie(t,l=>{l.target===t&&(c(),e(l))},n+r)}function WPe(t){t.offsetHeight}function HPe(t){return t&&"setState"in t?Mm.findDOMNode(t):t??null}const $Pe=At.forwardRef(({onEnter:t,onEntering:e,onEntered:n,onExit:r,onExiting:c,onExited:l,addEndListener:d,children:f,childRef:m,...E},y)=>{const w=$.useRef(null),I=DP(w,m),P=Y=>{I(HPe(Y))},k=Y=>oe=>{Y&&w.current&&Y(w.current,oe)},M=$.useCallback(k(t),[t]),K=$.useCallback(k(e),[e]),W=$.useCallback(k(n),[n]),V=$.useCallback(k(r),[r]),G=$.useCallback(k(c),[c]),Q=$.useCallback(k(l),[l]),Z=$.useCallback(k(d),[d]);return R.jsx(VPe,{ref:y,...E,onEnter:M,onEntered:W,onEntering:K,onExit:V,onExited:Q,onExiting:G,addEndListener:Z,nodeRef:w,children:typeof f=="function"?(Y,oe)=>f(Y,{...oe,ref:P}):At.cloneElement(f,{ref:P})})}),zPe=$Pe,GPe={[cf]:"show",[Pm]:"show"},hie=$.forwardRef(({className:t,children:e,transitionClasses:n={},onEnter:r,...c},l)=>{const d={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1,...c},f=$.useCallback((m,E)=>{WPe(m),r==null||r(m,E)},[r]);return R.jsx(zPe,{ref:l,addEndListener:BPe,...d,onEnter:f,childRef:e.ref,children:(m,E)=>$.cloneElement(e,{...E,className:zd("fade",t,e.props.className,GPe[m],n[m])})})});hie.displayName="Fade";const fie=hie;var KPe=/-(.)/g;function qPe(t){return t.replace(KPe,function(e,n){return n.toUpperCase()})}const YPe=["xxl","xl","lg","md","sm","xs"],XPe="xs",pie=$.createContext({prefixes:{},breakpoints:YPe,minBreakpoint:XPe});function kP(t,e){const{prefixes:n}=$.useContext(pie);return t||n[e]||e}function JPe(){const{dir:t}=$.useContext(pie);return t==="rtl"}const QPe=t=>t[0].toUpperCase()+qPe(t).slice(1);function C5(t,{displayName:e=QPe(t),Component:n,defaultProps:r}={}){const c=$.forwardRef(({className:l,bsPrefix:d,as:f=n||"div",...m},E)=>{const y={...r,...m},w=kP(d,t);return R.jsx(f,{ref:E,className:zd(l,w),...y})});return c.displayName=e,c}const ZPe=C5("modal-body"),exe=$.createContext({onHide(){}}),mie=exe,gie=$.forwardRef(({bsPrefix:t,className:e,contentClassName:n,centered:r,size:c,fullscreen:l,children:d,scrollable:f,...m},E)=>{t=kP(t,"modal");const y=`${t}-dialog`,w=typeof l=="string"?`${t}-fullscreen-${l}`:`${t}-fullscreen`;return R.jsx("div",{...m,ref:E,className:zd(y,e,c&&`${t}-${c}`,r&&`${y}-centered`,f&&`${y}-scrollable`,l&&w),children:R.jsx("div",{className:zd(`${t}-content`,n),children:d})})});gie.displayName="ModalDialog";const _ie=gie,txe=C5("modal-footer"),nxe={"aria-label":Le.string,onClick:Le.func,variant:Le.oneOf(["white"])},R5=$.forwardRef(({className:t,variant:e,"aria-label":n="Close",...r},c)=>R.jsx("button",{ref:c,type:"button",className:zd("btn-close",e&&`btn-close-${e}`,t),"aria-label":n,...r}));R5.displayName="CloseButton";R5.propTypes=nxe;const ixe=R5,rxe=$.forwardRef(({closeLabel:t="Close",closeVariant:e,closeButton:n=!1,onHide:r,children:c,...l},d)=>{const f=$.useContext(mie),m=gu(()=>{f==null||f.onHide(),r==null||r()});return R.jsxs("div",{ref:d,...l,children:[c,n&&R.jsx(ixe,{"aria-label":t,variant:e,onClick:m})]})}),sxe=rxe,Eie=$.forwardRef(({bsPrefix:t,className:e,closeLabel:n="Close",closeButton:r=!1,...c},l)=>(t=kP(t,"modal-header"),R.jsx(sxe,{ref:l,...c,className:zd(e,t),closeLabel:n,closeButton:r})));Eie.displayName="ModalHeader";const oxe=Eie,axe=t=>$.forwardRef((e,n)=>R.jsx("div",{...e,ref:n,className:zd(e.className,t)})),cxe=axe("h4"),lxe=C5("modal-title",{Component:cxe});function uxe(t){return R.jsx(fie,{...t,timeout:null})}function dxe(t){return R.jsx(fie,{...t,timeout:null})}const vie=$.forwardRef(({bsPrefix:t,className:e,style:n,dialogClassName:r,contentClassName:c,children:l,dialogAs:d=_ie,"aria-labelledby":f,"aria-describedby":m,"aria-label":E,show:y=!1,animation:w=!0,backdrop:I=!0,keyboard:P=!0,onEscapeKeyDown:k,onShow:M,onHide:K,container:W,autoFocus:V=!0,enforceFocus:G=!0,restoreFocus:Q=!0,restoreFocusOptions:Z,onEntered:Y,onExit:oe,onExiting:ce,onEnter:Se,onEntering:xe,onExited:je,backdropClassName:Ge,manager:ze,...Ke},He)=>{const[be,Oe]=$.useState({}),[_e,We]=$.useState(!1),Ie=$.useRef(!1),De=$.useRef(!1),Ue=$.useRef(null),[rt,gt]=ePe(),ft=DP(He,gt),Ft=gu(K),qt=JPe();t=kP(t,"modal");const ti=$.useMemo(()=>({onHide:Ft}),[Ft]);function Vt(){return ze||UPe({isRTL:qt})}function xn(st){if(!jv)return;const Ot=Vt().getScrollbarWidth()>0,Qt=st.scrollHeight>xP(st).documentElement.clientHeight;Oe({paddingRight:Ot&&!Qt?XK():void 0,paddingLeft:!Ot&&Qt?XK():void 0})}const En=gu(()=>{rt&&xn(rt.dialog)});aie(()=>{fV(window,"resize",En),Ue.current==null||Ue.current()});const Di=()=>{Ie.current=!0},ui=st=>{Ie.current&&rt&&st.target===rt.dialog&&(De.current=!0),Ie.current=!1},rn=()=>{We(!0),Ue.current=cie(rt.dialog,()=>{We(!1)})},Rn=st=>{st.target===st.currentTarget&&rn()},us=st=>{if(I==="static"){Rn(st);return}if(De.current||st.target!==st.currentTarget){De.current=!1;return}K==null||K()},di=st=>{P?k==null||k(st):(st.preventDefault(),I==="static"&&rn())},Go=(st,Ot)=>{st&&xn(st),Se==null||Se(st,Ot)},qr=st=>{Ue.current==null||Ue.current(),oe==null||oe(st)},Zi=(st,Ot)=>{xe==null||xe(st,Ot),oie(window,"resize",En)},wi=st=>{st&&(st.style.display=""),je==null||je(st),fV(window,"resize",En)},Ne=$.useCallback(st=>R.jsx("div",{...st,className:zd(`${t}-backdrop`,Ge,!w&&"show")}),[w,Ge,t]),dt={...n,...be};dt.display="block";const Et=st=>R.jsx("div",{role:"dialog",...st,style:dt,className:zd(e,t,_e&&`${t}-static`,!w&&"show"),onClick:I?us:void 0,onMouseUp:ui,"aria-label":E,"aria-labelledby":f,"aria-describedby":m,children:R.jsx(d,{...Ke,onMouseDown:Di,className:r,contentClassName:c,children:l})});return R.jsx(mie.Provider,{value:ti,children:R.jsx(PPe,{show:y,ref:ft,backdrop:I,container:W,keyboard:!0,autoFocus:V,enforceFocus:G,restoreFocus:Q,restoreFocusOptions:Z,onEscapeKeyDown:di,onShow:M,onHide:K,onEnter:Go,onEntering:Zi,onEntered:Y,onExit:qr,onExiting:ce,onExited:wi,manager:Vt(),transition:w?uxe:void 0,backdropTransition:w?dxe:void 0,renderBackdrop:Ne,renderDialog:Et})})});vie.displayName="Modal";const ln=Object.assign(vie,{Body:ZPe,Header:oxe,Title:lxe,Footer:txe,Dialog:_ie,TRANSITION_DURATION:300,BACKDROP_TRANSITION_DURATION:150}),LP="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAYCAYAAAALQIb7AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAPFSURBVHgBhVbNTlNBFD5nWsAmLsob1IWGhYvyBJYXMPAEhLUm4s6FiRA3rgQSF5iYFN4AngDcK14XRhM35QnAxFiEzhzPz8zcuRVxmts7nZl7vu985+cWoRjj4ULPoX8BhMv8s4sBCAJ8BoTq8jft3H70vYKpcfV64QEgLgeCZSDXBQ9dXj7jZw/9hd/sbHwbpbOYJpP9e6ueaJuBugzBH0QGAr0IAUnnezOEG/j46+l4a6HXAhwS4CCdsTsxQX7WniFHtNZ+/mU/g4lHLedPKOC8AgXA/LCYCTJHJAMcBU9rbGqIhD0D0A/oFRyWgLx/HuhqUTx0Yq0Ffsib88KEZWCPMHsEnkEYnLKX0HPgjlimXu2RqMCXlysBKmnZ7yLNDNWzy+HdPhF+ytL5aEDcMEORcWKuYhgpKvdMNrI5RuL8xfMgZnGpzdI9MQnE7SyJeWegKgkaGeEgc743jQsgUT1Pv+0MYSvgcps3NcC2qIAqASYDsiZLnG4ploIvZEhJNbzWsxj4hD1PlNQgetiGqL2sxYRQoxSTwwItM2cesSFjT0Ioe4OWIrKPTekjacA7bWMWKyDFwCfQCBQ0bdVz1DXSuRGyZKrllE1TAGOmJi8dszvLLEIEspSlvCaSpTjo5ZS9Ri1IaYhJ9jzeU9kYCCYbPxx5PEUqDVv86jpxNYl8hizGkpFeJFePonEA6zxMxSe7SqtyOIFjQ49sCfMBA6CyliBd5LE4j8X5lGiazZGI7FHluEUdKsMkkzD1MX1TnRVex2LVdMBkOHsTFSkkj0rwaL13F3CrYq/Os/FcqFZHZrwGRZ8zLAUecolQQTJKKJ5zUp3Ovfl44OafVucOuAHXgVQ5LCaxDZlBMiJO2pJlWrmenqUoZ2wM2uoI9iRvtTf+dLM7vHledvkkj8UBozcY6wzq/aaMNWCsNSY9CiHsZzDxjq5gE+vuTRGIoMxUT3X/LKWNsUOaiq8Bb3R2q1GsyHpcvLwv3XygHJIRSq8bynGU9ljvpziJF07bmsRJDwXam317spbsuxJszrdXmOGIPWiyszvlbuAtabKUUTaKhGJ2jzyGzdJ+Aww3WE5sLbHBUW6ujR6Xaw0bMZomxnGabYdBki/bh2vG+Fmf/4vQkbwoMXdu5db4q1C+y3L3Aay8m6xMA/3lWRqdV9Xo1xgXuT6286ujkRhl9tUJxKR2Zi4nS9cB/dOzclyu9/sc6i02NKg7iP0Byr0Q8Nh72Oy8+3B8k63/gqUxXu8PnHer7GGfM7MvCcDZd8D1fdjZvRkkjT/FfiYEdnzPlAAAAABJRU5ErkJggg==",I5="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAYCAYAAAALQIb7AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAALbSURBVHgBvVbNTttAEJ5ZOypULUo59WhEIlUVUPcJcG5JeyA8AekT0D4B5AmAJwCOvaWXErUH3CfAhaiKRCJ87KEH30IUO9OZdZyENj+0Svgke9fr2flm1rvfGGEI1ou8lUqpPQIq8mNaDyJ4SOhB1Dm6/vHVgz+QWcs7gLhFCEUkPUeuAAErnU637NerfmKLSWd14+0OUvewTzIC7OAkcSCBmSk85mEHJoCQSs3L6qn0VZJRQkQER2GHVhpXZxgarWdAlONMTwnA57ZkpPBcspG2RxSwTVnsxD6eRysyRwdIeCj++5ll1gt6ohA1a2fvR0Vo2ZxJhAfcLQ7CBjc0W9u+5waj5qyuFQ4RYZe7LgeRw+zLNzYZdCGRRwblfG+wxqOQ2ShcMInNl9eonb2eZGvZxbQZtW9kxSRz1TU0M68nudOIBKGi7TgjbqfA9yoBr5ZeTgIsmtw4+qE3ON2BDigH9wQCVfi+qxC2kL8XyaB8WJgTEg4FDwgh0zvJsp00zAGySXrdgPcF+NIzwwUb5gAzvI398u5VvJjfeuMOzAOEdswF31W8WxiImzAPIOzEbeSq0FwQcZXv5mhRnSFikQZbBKN59aWi5ODxITuK2XEPZomePyQaCDFnJyKss1tdLxRhBsiu50viT7IKTTiRMUNuwc/67fLzbJu7eT7Z+aXlzMfgVyOA/4SuIgYeoy5X9OHmsurK+B3VSNRfCmaoWrlxaj6RyHLSxtPFC3Zs8eY7ub6qvkve3VGQ0Hi0LWmLqpvdxfOkDv0Lkflk8VyIxE/HgPLw+7/0UOqWEWF/QtThslOfXg0kMCmo/XkjytVI8R0mjK1wv3H5uTw2m6XHu7yjpeimJ9XFsUovmmaE7f1epRUF8BWgS9Q9bdSqrj5DSm0mJNqGK31ktvbHfeupZSVrcyUP6YAtnbFGXEz5VpYgJvm6dw2TTPh3rcQ/MK8SVWCSTyJ300gS/AaQqFPLhhfzoAAAAABJRU5ErkJggg==",yie="/assets/icon-comment-b8c1f526.svg",Sie="/assets/icon-flatViewComment-c78cd589.svg",Tie="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAABOCAYAAACOqiAdAAAACXBIWXMAAAsTAAALEwEAmpwYAAACE0lEQVR4nO3by45MQRzH8W/i7gGww4aNjC2xFBmXTCaewcyS4RmYhGAzLjPxDHgMYy/YIDPzAti4DSGlqjlan3aqkk531PeT/JOT7qrMyW/61LlVgSRJkiRJ0gjtBA6n2jHKP/S/OAo8Bj4C31OF7UfA1Lh3blLNA18agfVX+G5u3Ds5aWaBb0NC61VoMzPunZ2k8WyjQ2i9Wnfci85nhNar8Aut3o2C4K5XnxrwoCC40Kd6iwXBXa0+NeBUQXAnDQ62AM8yQnsBbDW46DjwqUNooc2x1EfJGeDdkNDeAtO9xvrTXuAW8KoRWNi+Cezpa6sW24FtbV9KkupyALgC3El1OX2mFrvTzfvXAddw4bPl1EYNIZCnHe4cVg2v/NHSSl/fah1sOTzbKrR1zCMO/rmPlS6N+789Ce4VBBfOttW7WxDcUvWpAQsFwV00OH4O9Dknh01gv8FFyxnB3U99RLwAXu0Q2hNgl4n9Hd5Ky2G7mX5phvaPMW8hnTmX0jWbY5ok6dfrwVDqYB9wG3jTuBR5nV5Sh5fVGuAs8H7IxW+YHnF6UMeanciYdBMm6Ig4zet5xr3qS6d5RdMFj5XCZMTqLRYEd6361HDydDGn6xeaLThUXZZEXJK0nhHamkuSfpvJWAR3rtFPxCWVw5ZdfgYumNRgU2lR74dGYGH7IXCkpY8awnLyQ6lcWi5JkiRJkhiZH7Mimh1wkQlOAAAAAElFTkSuQmCC",hxe="/assets/icon-threeDots-7bc682ea.svg";var bie={},q1=Gt&&Gt.__assign||function(){return q1=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&(t[c]=e[c])}return t},q1.apply(this,arguments)},fxe=Gt&&Gt.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n);var c=Object.getOwnPropertyDescriptor(e,n);(!c||("get"in c?!e.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,c)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),pxe=Gt&&Gt.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),mxe=Gt&&Gt.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)n!=="default"&&Object.prototype.hasOwnProperty.call(t,n)&&fxe(e,t,n);return pxe(e,t),e},gxe=Gt&&Gt.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,r=Object.getOwnPropertySymbols(t);c<r.length;c++)e.indexOf(r[c])<0&&Object.prototype.propertyIsEnumerable.call(t,r[c])&&(n[r[c]]=t[r[c]]);return n};Object.defineProperty(bie,"__esModule",{value:!0});var pm=mxe($),US=$d,gV=Sg,_xe=[(0,gV.createAnimation)("PacmanLoader","0% {transform: rotate(0deg)} 50% {transform: rotate(-44deg)}","pacman-1"),(0,gV.createAnimation)("PacmanLoader","0% {transform: rotate(0deg)} 50% {transform: rotate(44deg)}","pacman-2")];function Exe(t){var e=t.loading,n=e===void 0?!0:e,r=t.color,c=r===void 0?"#000000":r,l=t.speedMultiplier,d=l===void 0?1:l,f=t.cssOverride,m=f===void 0?{}:f,E=t.size,y=E===void 0?25:E,w=t.margin,I=w===void 0?2:w,P=gxe(t,["loading","color","speedMultiplier","cssOverride","size","margin"]),k=(0,US.parseLengthAndUnit)(y),M=k.value,K=k.unit,W=q1({display:"inherit",position:"relative",fontSize:0,height:"".concat(M*2).concat(K),width:"".concat(M*2).concat(K)},m),V=(0,gV.createAnimation)("PacmanLoader",`75% {opacity: 0.7}
    100% {transform: translate(`.concat("".concat(-4*M).concat(K),", ").concat("".concat(-M/4).concat(K),")}"),"ball"),G=function(Se){return{width:"".concat(M/3).concat(K),height:"".concat(M/3).concat(K),backgroundColor:c,margin:(0,US.cssValue)(I),borderRadius:"100%",transform:"translate(0, ".concat("".concat(-M/4).concat(K),")"),position:"absolute",top:"".concat(M).concat(K),left:"".concat(M*4).concat(K),animation:"".concat(V," ").concat(1/d,"s ").concat(Se*.25,"s infinite linear"),animationFillMode:"both"}},Q="".concat((0,US.cssValue)(y)," solid transparent"),Z="".concat((0,US.cssValue)(y)," solid ").concat(c),Y=function(Se){return{width:0,height:0,borderRight:Q,borderTop:Se===0?Q:Z,borderLeft:Z,borderBottom:Se===0?Z:Q,borderRadius:(0,US.cssValue)(y),position:"absolute",animation:"".concat(_xe[Se]," ").concat(.8/d,"s infinite ease-in-out"),animationFillMode:"both"}},oe=Y(0),ce=Y(1);return n?pm.createElement("span",q1({style:W},P),pm.createElement("span",{style:oe}),pm.createElement("span",{style:ce}),pm.createElement("span",{style:G(2)}),pm.createElement("span",{style:G(3)}),pm.createElement("span",{style:G(4)}),pm.createElement("span",{style:G(5)})):null}var $b=bie.default=Exe;const Ou=Object.create(null);Ou.open="0";Ou.close="1";Ou.ping="2";Ou.pong="3";Ou.message="4";Ou.upgrade="5";Ou.noop="6";const $O=Object.create(null);Object.keys(Ou).forEach(t=>{$O[Ou[t]]=t});const _V={type:"error",data:"parser error"},wie=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Cie=typeof ArrayBuffer=="function",Rie=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,A5=({type:t,data:e},n,r)=>wie&&e instanceof Blob?n?r(e):sq(e,r):Cie&&(e instanceof ArrayBuffer||Rie(e))?n?r(e):sq(new Blob([e]),r):r(Ou[t]+(e||"")),sq=(t,e)=>{const n=new FileReader;return n.onload=function(){const r=n.result.split(",")[1];e("b"+(r||""))},n.readAsDataURL(t)};function oq(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let tF;function vxe(t,e){if(wie&&t.data instanceof Blob)return t.data.arrayBuffer().then(oq).then(e);if(Cie&&(t.data instanceof ArrayBuffer||Rie(t.data)))return e(oq(t.data));A5(t,!1,n=>{tF||(tF=new TextEncoder),e(tF.encode(n))})}const aq="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",nT=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<aq.length;t++)nT[aq.charCodeAt(t)]=t;const yxe=t=>{let e=t.length*.75,n=t.length,r,c=0,l,d,f,m;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);const E=new ArrayBuffer(e),y=new Uint8Array(E);for(r=0;r<n;r+=4)l=nT[t.charCodeAt(r)],d=nT[t.charCodeAt(r+1)],f=nT[t.charCodeAt(r+2)],m=nT[t.charCodeAt(r+3)],y[c++]=l<<2|d>>4,y[c++]=(d&15)<<4|f>>2,y[c++]=(f&3)<<6|m&63;return E},Sxe=typeof ArrayBuffer=="function",O5=(t,e)=>{if(typeof t!="string")return{type:"message",data:Iie(t,e)};const n=t.charAt(0);return n==="b"?{type:"message",data:Txe(t.substring(1),e)}:$O[n]?t.length>1?{type:$O[n],data:t.substring(1)}:{type:$O[n]}:_V},Txe=(t,e)=>{if(Sxe){const n=yxe(t);return Iie(n,e)}else return{base64:!0,data:t}},Iie=(t,e)=>{switch(e){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}},Aie=String.fromCharCode(30),bxe=(t,e)=>{const n=t.length,r=new Array(n);let c=0;t.forEach((l,d)=>{A5(l,!1,f=>{r[d]=f,++c===n&&e(r.join(Aie))})})},wxe=(t,e)=>{const n=t.split(Aie),r=[];for(let c=0;c<n.length;c++){const l=O5(n[c],e);if(r.push(l),l.type==="error")break}return r};function Cxe(){return new TransformStream({transform(t,e){vxe(t,n=>{const r=n.length;let c;if(r<126)c=new Uint8Array(1),new DataView(c.buffer).setUint8(0,r);else if(r<65536){c=new Uint8Array(3);const l=new DataView(c.buffer);l.setUint8(0,126),l.setUint16(1,r)}else{c=new Uint8Array(9);const l=new DataView(c.buffer);l.setUint8(0,127),l.setBigUint64(1,BigInt(r))}t.data&&typeof t.data!="string"&&(c[0]|=128),e.enqueue(c),e.enqueue(n)})}})}let nF;function qA(t){return t.reduce((e,n)=>e+n.length,0)}function YA(t,e){if(t[0].length===e)return t.shift();const n=new Uint8Array(e);let r=0;for(let c=0;c<e;c++)n[c]=t[0][r++],r===t[0].length&&(t.shift(),r=0);return t.length&&r<t[0].length&&(t[0]=t[0].slice(r)),n}function Rxe(t,e){nF||(nF=new TextDecoder);const n=[];let r=0,c=-1,l=!1;return new TransformStream({transform(d,f){for(n.push(d);;){if(r===0){if(qA(n)<1)break;const m=YA(n,1);l=(m[0]&128)===128,c=m[0]&127,c<126?r=3:c===126?r=1:r=2}else if(r===1){if(qA(n)<2)break;const m=YA(n,2);c=new DataView(m.buffer,m.byteOffset,m.length).getUint16(0),r=3}else if(r===2){if(qA(n)<8)break;const m=YA(n,8),E=new DataView(m.buffer,m.byteOffset,m.length),y=E.getUint32(0);if(y>Math.pow(2,53-32)-1){f.enqueue(_V);break}c=y*Math.pow(2,32)+E.getUint32(4),r=3}else{if(qA(n)<c)break;const m=YA(n,c);f.enqueue(O5(l?m:nF.decode(m),e)),r=0}if(c===0||c>t){f.enqueue(_V);break}}}})}const Oie=4;function cs(t){if(t)return Ixe(t)}function Ixe(t){for(var e in cs.prototype)t[e]=cs.prototype[e];return t}cs.prototype.on=cs.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};cs.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this};cs.prototype.off=cs.prototype.removeListener=cs.prototype.removeAllListeners=cs.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+t];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var r,c=0;c<n.length;c++)if(r=n[c],r===e||r.fn===e){n.splice(c,1);break}return n.length===0&&delete this._callbacks["$"+t],this};cs.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(n){n=n.slice(0);for(var r=0,c=n.length;r<c;++r)n[r].apply(this,e)}return this};cs.prototype.emitReserved=cs.prototype.emit;cs.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};cs.prototype.hasListeners=function(t){return!!this.listeners(t).length};const Pc=(()=>typeof self<"u"?self:typeof window<"u"?window:Function("return this")())();function Nie(t,...e){return e.reduce((n,r)=>(t.hasOwnProperty(r)&&(n[r]=t[r]),n),{})}const Axe=Pc.setTimeout,Oxe=Pc.clearTimeout;function MP(t,e){e.useNativeTimers?(t.setTimeoutFn=Axe.bind(Pc),t.clearTimeoutFn=Oxe.bind(Pc)):(t.setTimeoutFn=Pc.setTimeout.bind(Pc),t.clearTimeoutFn=Pc.clearTimeout.bind(Pc))}const Nxe=1.33;function Pxe(t){return typeof t=="string"?xxe(t):Math.ceil((t.byteLength||t.size)*Nxe)}function xxe(t){let e=0,n=0;for(let r=0,c=t.length;r<c;r++)e=t.charCodeAt(r),e<128?n+=1:e<2048?n+=2:e<55296||e>=57344?n+=3:(r++,n+=4);return n}function Dxe(t){let e="";for(let n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e}function kxe(t){let e={},n=t.split("&");for(let r=0,c=n.length;r<c;r++){let l=n[r].split("=");e[decodeURIComponent(l[0])]=decodeURIComponent(l[1])}return e}class Lxe extends Error{constructor(e,n,r){super(e),this.description=n,this.context=r,this.type="TransportError"}}class N5 extends cs{constructor(e){super(),this.writable=!1,MP(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,n,r){return super.emitReserved("error",new Lxe(e,n,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const n=O5(e,this.socket.binaryType);this.onPacket(n)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,n={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const n=Dxe(e);return n.length?"?"+n:""}}const Pie="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),EV=64,Mxe={};let cq=0,XA=0,lq;function uq(t){let e="";do e=Pie[t%EV]+e,t=Math.floor(t/EV);while(t>0);return e}function xie(){const t=uq(+new Date);return t!==lq?(cq=0,lq=t):t+"."+uq(cq++)}for(;XA<EV;XA++)Mxe[Pie[XA]]=XA;let Die=!1;try{Die=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Uxe=Die;function kie(t){const e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||Uxe))return new XMLHttpRequest}catch{}if(!e)try{return new Pc[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function jxe(){}const Fxe=function(){return new kie({xdomain:!1}).responseType!=null}();class Vxe extends N5{constructor(e){if(super(e),this.polling=!1,typeof location<"u"){const r=location.protocol==="https:";let c=location.port;c||(c=r?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||c!==e.port}const n=e&&e.forceBase64;this.supportsBinary=Fxe&&!n,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const n=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let r=0;this.polling&&(r++,this.once("pollComplete",function(){--r||n()})),this.writable||(r++,this.once("drain",function(){--r||n()}))}else n()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const n=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};wxe(e,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,bxe(e,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=xie()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(e,n)}request(e={}){return Object.assign(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new Tu(this.uri(),e)}doWrite(e,n){const r=this.request({method:"POST",data:e});r.on("success",n),r.on("error",(c,l)=>{this.onError("xhr post error",c,l)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(n,r)=>{this.onError("xhr poll error",n,r)}),this.pollXhr=e}}class Tu extends cs{constructor(e,n){super(),MP(this,n),this.opts=n,this.method=n.method||"GET",this.uri=e,this.data=n.data!==void 0?n.data:null,this.create()}create(){var e;const n=Nie(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this.opts.xd;const r=this.xhr=new kie(n);try{r.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let c in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(c)&&r.setRequestHeader(c,this.opts.extraHeaders[c])}}catch{}if(this.method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(e=this.opts.cookieJar)===null||e===void 0||e.addCookies(r),"withCredentials"in r&&(r.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(r.timeout=this.opts.requestTimeout),r.onreadystatechange=()=>{var c;r.readyState===3&&((c=this.opts.cookieJar)===null||c===void 0||c.parseCookies(r)),r.readyState===4&&(r.status===200||r.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof r.status=="number"?r.status:0)},0))},r.send(this.data)}catch(c){this.setTimeoutFn(()=>{this.onError(c)},0);return}typeof document<"u"&&(this.index=Tu.requestsCount++,Tu.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=jxe,e)try{this.xhr.abort()}catch{}typeof document<"u"&&delete Tu.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}Tu.requestsCount=0;Tu.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",dq);else if(typeof addEventListener=="function"){const t="onpagehide"in Pc?"pagehide":"unload";addEventListener(t,dq,!1)}}function dq(){for(let t in Tu.requests)Tu.requests.hasOwnProperty(t)&&Tu.requests[t].abort()}const P5=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,n)=>n(e,0))(),JA=Pc.WebSocket||Pc.MozWebSocket,hq=!0,Bxe="arraybuffer",fq=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Wxe extends N5{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),n=this.opts.protocols,r=fq?{}:Nie(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=hq&&!fq?n?new JA(e,n):new JA(e):new JA(e,n,r)}catch(c){return this.emitReserved("error",c)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let n=0;n<e.length;n++){const r=e[n],c=n===e.length-1;A5(r,this.supportsBinary,l=>{const d={};try{hq&&this.ws.send(l)}catch{}c&&P5(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=xie()),this.supportsBinary||(n.b64=1),this.createUri(e,n)}check(){return!!JA}}class Hxe extends N5{get name(){return"webtransport"}doOpen(){typeof WebTransport=="function"&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this.transport.ready.then(()=>{this.transport.createBidirectionalStream().then(e=>{const n=Rxe(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=e.readable.pipeThrough(n).getReader(),c=Cxe();c.readable.pipeTo(e.writable),this.writer=c.writable.getWriter();const l=()=>{r.read().then(({done:f,value:m})=>{f||(this.onPacket(m),l())}).catch(f=>{})};l();const d={type:"open"};this.query.sid&&(d.data=`{"sid":"${this.query.sid}"}`),this.writer.write(d).then(()=>this.onOpen())})}))}write(e){this.writable=!1;for(let n=0;n<e.length;n++){const r=e[n],c=n===e.length-1;this.writer.write(r).then(()=>{c&&P5(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this.transport)===null||e===void 0||e.close()}}const $xe={websocket:Wxe,webtransport:Hxe,polling:Vxe},zxe=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Gxe=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function vV(t){const e=t,n=t.indexOf("["),r=t.indexOf("]");n!=-1&&r!=-1&&(t=t.substring(0,n)+t.substring(n,r).replace(/:/g,";")+t.substring(r,t.length));let c=zxe.exec(t||""),l={},d=14;for(;d--;)l[Gxe[d]]=c[d]||"";return n!=-1&&r!=-1&&(l.source=e,l.host=l.host.substring(1,l.host.length-1).replace(/;/g,":"),l.authority=l.authority.replace("[","").replace("]","").replace(/;/g,":"),l.ipv6uri=!0),l.pathNames=Kxe(l,l.path),l.queryKey=qxe(l,l.query),l}function Kxe(t,e){const n=/\/{2,9}/g,r=e.replace(n,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&r.splice(0,1),e.slice(-1)=="/"&&r.splice(r.length-1,1),r}function qxe(t,e){const n={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,c,l){c&&(n[c]=l)}),n}let Lie=class CE extends cs{constructor(e,n={}){super(),this.binaryType=Bxe,this.writeBuffer=[],e&&typeof e=="object"&&(n=e,e=null),e?(e=vV(e),n.hostname=e.host,n.secure=e.protocol==="https"||e.protocol==="wss",n.port=e.port,e.query&&(n.query=e.query)):n.host&&(n.hostname=vV(n.host).host),MP(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=n.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=kxe(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){const n=Object.assign({},this.opts.query);n.EIO=Oie,n.transport=e,this.id&&(n.sid=this.id);const r=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new $xe[e](r)}open(){let e;if(this.opts.rememberUpgrade&&CE.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch{this.transports.shift(),this.open();return}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",n=>this.onClose("transport close",n))}probe(e){let n=this.createTransport(e),r=!1;CE.priorWebsocketSuccess=!1;const c=()=>{r||(n.send([{type:"ping",data:"probe"}]),n.once("packet",w=>{if(!r)if(w.type==="pong"&&w.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;CE.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(y(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const I=new Error("probe error");I.transport=n.name,this.emitReserved("upgradeError",I)}}))};function l(){r||(r=!0,y(),n.close(),n=null)}const d=w=>{const I=new Error("probe error: "+w);I.transport=n.name,l(),this.emitReserved("upgradeError",I)};function f(){d("transport closed")}function m(){d("socket closed")}function E(w){n&&w.name!==n.name&&l()}const y=()=>{n.removeListener("open",c),n.removeListener("error",d),n.removeListener("close",f),this.off("close",m),this.off("upgrading",E)};n.once("open",c),n.once("error",d),n.once("close",f),this.once("close",m),this.once("upgrading",E),this.upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{r||n.open()},200):n.open()}onOpen(){if(this.readyState="open",CE.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade){let e=0;const n=this.upgrades.length;for(;e<n;e++)this.probe(this.upgrades[e])}}onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),this.resetPingTimeout(),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const n=new Error("server error");n.code=e.data,this.onError(n);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let r=0;r<this.writeBuffer.length;r++){const c=this.writeBuffer[r].data;if(c&&(n+=Pxe(c)),r>0&&n>this.maxPayload)return this.writeBuffer.slice(0,r);n+=2}return this.writeBuffer}write(e,n,r){return this.sendPacket("message",e,n,r),this}send(e,n,r){return this.sendPacket("message",e,n,r),this}sendPacket(e,n,r,c){if(typeof n=="function"&&(c=n,n=void 0),typeof r=="function"&&(c=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const l={type:e,data:n,options:r};this.emitReserved("packetCreate",l),this.writeBuffer.push(l),c&&this.once("flush",c),this.flush()}close(){const e=()=>{this.onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),e()},r=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}onError(e){CE.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,n){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,n),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const n=[];let r=0;const c=e.length;for(;r<c;r++)~this.transports.indexOf(e[r])&&n.push(e[r]);return n}};Lie.protocol=Oie;function Yxe(t,e="",n){let r=t;n=n||typeof location<"u"&&location,t==null&&(t=n.protocol+"//"+n.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=n.protocol+t:t=n.host+t),/^(https?|wss?):\/\//.test(t)||(typeof n<"u"?t=n.protocol+"//"+t:t="https://"+t),r=vV(t)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const l=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+l+":"+r.port+e,r.href=r.protocol+"://"+l+(n&&n.port===r.port?"":":"+r.port),r}const Xxe=typeof ArrayBuffer=="function",Jxe=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,Mie=Object.prototype.toString,Qxe=typeof Blob=="function"||typeof Blob<"u"&&Mie.call(Blob)==="[object BlobConstructor]",Zxe=typeof File=="function"||typeof File<"u"&&Mie.call(File)==="[object FileConstructor]";function x5(t){return Xxe&&(t instanceof ArrayBuffer||Jxe(t))||Qxe&&t instanceof Blob||Zxe&&t instanceof File}function zO(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let n=0,r=t.length;n<r;n++)if(zO(t[n]))return!0;return!1}if(x5(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return zO(t.toJSON(),!0);for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&zO(t[n]))return!0;return!1}function eDe(t){const e=[],n=t.data,r=t;return r.data=yV(n,e),r.attachments=e.length,{packet:r,buffers:e}}function yV(t,e){if(!t)return t;if(x5(t)){const n={_placeholder:!0,num:e.length};return e.push(t),n}else if(Array.isArray(t)){const n=new Array(t.length);for(let r=0;r<t.length;r++)n[r]=yV(t[r],e);return n}else if(typeof t=="object"&&!(t instanceof Date)){const n={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=yV(t[r],e));return n}return t}function tDe(t,e){return t.data=SV(t.data,e),delete t.attachments,t}function SV(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let n=0;n<t.length;n++)t[n]=SV(t[n],e);else if(typeof t=="object")for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=SV(t[n],e));return t}const nDe=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],iDe=5;var zn;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(zn||(zn={}));class rDe{constructor(e){this.replacer=e}encode(e){return(e.type===zn.EVENT||e.type===zn.ACK)&&zO(e)?this.encodeAsBinary({type:e.type===zn.EVENT?zn.BINARY_EVENT:zn.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let n=""+e.type;return(e.type===zn.BINARY_EVENT||e.type===zn.BINARY_ACK)&&(n+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(n+=e.nsp+","),e.id!=null&&(n+=e.id),e.data!=null&&(n+=JSON.stringify(e.data,this.replacer)),n}encodeAsBinary(e){const n=eDe(e),r=this.encodeAsString(n.packet),c=n.buffers;return c.unshift(r),c}}function pq(t){return Object.prototype.toString.call(t)==="[object Object]"}class D5 extends cs{constructor(e){super(),this.reviver=e}add(e){let n;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(e);const r=n.type===zn.BINARY_EVENT;r||n.type===zn.BINARY_ACK?(n.type=r?zn.EVENT:zn.ACK,this.reconstructor=new sDe(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(x5(e)||e.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(e),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let n=0;const r={type:Number(e.charAt(0))};if(zn[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===zn.BINARY_EVENT||r.type===zn.BINARY_ACK){const l=n+1;for(;e.charAt(++n)!=="-"&&n!=e.length;);const d=e.substring(l,n);if(d!=Number(d)||e.charAt(n)!=="-")throw new Error("Illegal attachments");r.attachments=Number(d)}if(e.charAt(n+1)==="/"){const l=n+1;for(;++n&&!(e.charAt(n)===","||n===e.length););r.nsp=e.substring(l,n)}else r.nsp="/";const c=e.charAt(n+1);if(c!==""&&Number(c)==c){const l=n+1;for(;++n;){const d=e.charAt(n);if(d==null||Number(d)!=d){--n;break}if(n===e.length)break}r.id=Number(e.substring(l,n+1))}if(e.charAt(++n)){const l=this.tryParse(e.substr(n));if(D5.isPayloadValid(r.type,l))r.data=l;else throw new Error("invalid payload")}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,n){switch(e){case zn.CONNECT:return pq(n);case zn.DISCONNECT:return n===void 0;case zn.CONNECT_ERROR:return typeof n=="string"||pq(n);case zn.EVENT:case zn.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&nDe.indexOf(n[0])===-1);case zn.ACK:case zn.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class sDe{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const n=tDe(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const oDe=Object.freeze(Object.defineProperty({__proto__:null,Decoder:D5,Encoder:rDe,get PacketType(){return zn},protocol:iDe},Symbol.toStringTag,{value:"Module"}));function pl(t,e,n){return t.on(e,n),function(){t.off(e,n)}}const aDe=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Uie extends cs{constructor(e,n,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=n,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[pl(e,"open",this.onopen.bind(this)),pl(e,"packet",this.onpacket.bind(this)),pl(e,"error",this.onerror.bind(this)),pl(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...n){if(aDe.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(n.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const r={type:zn.EVENT,data:n};if(r.options={},r.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const d=this.ids++,f=n.pop();this._registerAckCallback(d,f),r.id=d}const c=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!c||!this.connected)||(this.connected?(this.notifyOutgoingListeners(r),this.packet(r)):this.sendBuffer.push(r)),this.flags={},this}_registerAckCallback(e,n){var r;const c=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(c===void 0){this.acks[e]=n;return}const l=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let d=0;d<this.sendBuffer.length;d++)this.sendBuffer[d].id===e&&this.sendBuffer.splice(d,1);n.call(this,new Error("operation has timed out"))},c);this.acks[e]=(...d)=>{this.io.clearTimeoutFn(l),n.apply(this,[null,...d])}}emitWithAck(e,...n){const r=this.flags.timeout!==void 0||this._opts.ackTimeout!==void 0;return new Promise((c,l)=>{n.push((d,f)=>r?d?l(d):c(f):c(d)),this.emit(e,...n)})}_addToQueue(e){let n;typeof e[e.length-1]=="function"&&(n=e.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((c,...l)=>r!==this._queue[0]?void 0:(c!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(c)):(this._queue.shift(),n&&n(null,...l)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!e||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:zn.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,n)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case zn.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case zn.EVENT:case zn.BINARY_EVENT:this.onevent(e);break;case zn.ACK:case zn.BINARY_ACK:this.onack(e);break;case zn.DISCONNECT:this.ondisconnect();break;case zn.CONNECT_ERROR:this.destroy();const r=new Error(e.data.message);r.data=e.data.data,this.emitReserved("connect_error",r);break}}onevent(e){const n=e.data||[];e.id!=null&&n.push(this.ack(e.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const r of n)r.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const n=this;let r=!1;return function(...c){r||(r=!0,n.packet({type:zn.ACK,id:e,data:c}))}}onack(e){const n=this.acks[e.id];typeof n=="function"&&(n.apply(this,e.data),delete this.acks[e.id])}onconnect(e,n){this.id=e,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:zn.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const n=this._anyListeners;for(let r=0;r<n.length;r++)if(e===n[r])return n.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const n=this._anyOutgoingListeners;for(let r=0;r<n.length;r++)if(e===n[r])return n.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const r of n)r.apply(this,e.data)}}}function Fv(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}Fv.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=Math.floor(e*10)&1?t+n:t-n}return Math.min(t,this.max)|0};Fv.prototype.reset=function(){this.attempts=0};Fv.prototype.setMin=function(t){this.ms=t};Fv.prototype.setMax=function(t){this.max=t};Fv.prototype.setJitter=function(t){this.jitter=t};class TV extends cs{constructor(e,n){var r;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(n=e,e=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,MP(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((r=n.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new Fv({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=e;const c=n.parser||oDe;this.encoder=new c.Encoder,this.decoder=new c.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var n;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(n=this.backoff)===null||n===void 0||n.setMin(e),this)}randomizationFactor(e){var n;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(n=this.backoff)===null||n===void 0||n.setJitter(e),this)}reconnectionDelayMax(e){var n;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(n=this.backoff)===null||n===void 0||n.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Lie(this.uri,this.opts);const n=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const c=pl(n,"open",function(){r.onopen(),e&&e()}),l=f=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",f),e?e(f):this.maybeReconnectOnOpen()},d=pl(n,"error",l);if(this._timeout!==!1){const f=this._timeout,m=this.setTimeoutFn(()=>{c(),l(new Error("timeout")),n.close()},f);this.opts.autoUnref&&m.unref(),this.subs.push(()=>{this.clearTimeoutFn(m)})}return this.subs.push(c),this.subs.push(d),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(pl(e,"ping",this.onping.bind(this)),pl(e,"data",this.ondata.bind(this)),pl(e,"error",this.onerror.bind(this)),pl(e,"close",this.onclose.bind(this)),pl(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(n){this.onclose("parse error",n)}}ondecoded(e){P5(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,n){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new Uie(this,e,n),this.nsps[e]=r),r}_destroy(e){const n=Object.keys(this.nsps);for(const r of n)if(this.nsps[r].active)return;this._close()}_packet(e){const n=this.encoder.encode(e);for(let r=0;r<n.length;r++)this.engine.write(n[r],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,n){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(c=>{c?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",c)):e.onreconnect()}))},n);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const jS={};function GO(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};const n=Yxe(t,e.path||"/socket.io"),r=n.source,c=n.id,l=n.path,d=jS[c]&&l in jS[c].nsps,f=e.forceNew||e["force new connection"]||e.multiplex===!1||d;let m;return f?m=new TV(r,e):(jS[c]||(jS[c]=new TV(r,e)),m=jS[c]),n.query&&!e.query&&(e.query=n.queryKey),m.socket(n.path,e)}Object.assign(GO,{Manager:TV,Socket:Uie,io:GO,connect:GO});const _a=GO("https://buzzgram.online"),UP=({showCmt:t,handleCmtClose:e,data:n})=>{const r=bi(),c=Ia(),{user:l}=Si(Ue=>Ue.authReducer.authData),[d,f]=$.useState([]),[m,E]=$.useState([]),[y,w]=$.useState(!1),[I,P]=$.useState(!1),[k,M]=$.useState(!1),[K,W]=$.useState(null),[V,G]=$.useState(!1),[Q,Z]=$.useState(""),[Y,oe]=$.useState(""),ce=()=>{M(!1)},Se=()=>{G(!1)},xe=()=>{P(!1)},je=Ue=>{Z(Ue.text),W(Ue.user._id),E(Ue),M(!0)},Ge=()=>{P(!0),M(!1)},ze=()=>{G(!0),ce()},Ke=Ue=>{const rt=Ue.target.value;Z(rt)},He=100,be=Ue=>{const rt=Ue.target.value;rt.length<=He&&oe(rt)},Oe=()=>{const Ue=fe.loading("Commenting...");GNe(m._id,Q).then(rt=>{fe.dismiss(Ue),fe.success(R.jsx("b",{children:rt.data.msg})),ce(),xe();const gt=d.map(ft=>ft._id===m._id?{...ft,text:Q}:ft);f(gt)}).catch(rt=>{fe.dismiss(Ue),console.error("Error editing comment:",rt),fe.error(R.jsx("b",{children:"Error editing comment"}))})},_e=()=>{const Ue=fe.loading("Deleting...");qNe(m._id).then(rt=>{fe.dismiss(Ue),fe.success(R.jsx("b",{children:rt.data.message})),ce(),r(rie(m._id,n._id)),e();const gt=d.filter(ft=>ft._id!==m._id);f(gt)}).catch(rt=>{fe.dismiss(Ue),console.error("Error deleting comment:",rt),fe.error(R.jsx("b",{children:"Error deleting comment"}))})},We={position:"absolute",top:"49%",left:"40%",display:"block",margin:"0 auto",zIndex:"1066"},Ie=async(Ue,rt)=>{const gt=d.map(ft=>{if(ft._id===Ue){const Ft=ft.likes.includes(l._id)?ft.likes.filter(qt=>qt!==l._id):[...ft.likes,l._id];return{...ft,likes:Ft}}return ft});f(gt),$Ne(Ue,l._id).then(()=>{var ft,Ft;if(!rt.likes.includes(l._id)&&l._id!==((ft=n==null?void 0:n.user)==null?void 0:ft._id)){const qt={senderId:l._id,receiverId:(Ft=n==null?void 0:n.user)==null?void 0:Ft._id,text:"Liked your comment",url:n==null?void 0:n.image};ng(qt).then(({data:ti})=>{var Vt;_a.emit("get-notification",{to:qt.receiverId||((Vt=ti==null?void 0:ti.user)==null?void 0:Vt._id),from:{id:qt.senderId||l._id,profileimage:l.profileimage,username:l.username},text:qt.text,url:ti==null?void 0:ti.image})})}}).catch(ft=>{var Ft;console.log(ft),((Ft=ft==null?void 0:ft.response)==null?void 0:Ft.status)===401&&r(Bi())})},De=async()=>{if(!Y.trim())return fe.error(R.jsx("b",{children:"cannot send empty report!"}));const Ue=fe.loading("Reporting...");try{const rt=await r(T5(l._id,"comment",m._id,Y));console.log(rt,"//"),fe.dismiss(Ue),rt.success?(G(!1),fe.success(R.jsx("b",{children:"Comment Reported...!"}))):fe.error(R.jsx("b",{children:"Comment Reporting Failed...!"}))}catch(rt){fe.error(R.jsx("b",{children:"Something went wrong while updating!"})),console.error("Error:",rt)}};return $.useEffect(()=>{t&&(w(!0),KNe(n._id).then(Ue=>{Ue.data&&(w(!1),f(Ue.data))}).catch(Ue=>{console.error("Error fetching comments:",Ue)}))},[t,n==null?void 0:n._id]),R.jsxs(R.Fragment,{children:[R.jsx($b,{loading:y,cssOverride:We,color:"orange",speedMultiplier:1}),R.jsx(ln,{show:k,onHide:ce,className:"modal-postion",children:R.jsx(ln.Body,{style:{background:"#232323"},children:K!==l._id?R.jsx(R.Fragment,{children:R.jsx("span",{onClick:ze,className:"linear-gradient-text",children:"Report"})}):R.jsxs(R.Fragment,{children:[R.jsx("span",{onClick:Ge,className:"linear-gradient-text",children:"Edit"}),R.jsx("hr",{}),R.jsx("span",{onClick:_e,className:"linear-gradient-text",children:"Delete"})]})})}),R.jsx(ln,{show:V,onHide:Se,className:"modal-postion",children:R.jsxs(ln.Body,{style:{width:"17rem"},children:[R.jsx("label",{className:"pt-2 pb-3 linear-gradient-text",children:"Provide Reason!"}),R.jsxs("div",{className:"Search",children:[R.jsx("textarea",{type:"text",name:"report",onChange:be}),R.jsx("span",{onClick:De,className:"material-symbols-outlined",children:"report"})]}),R.jsx("div",{style:{display:"flex"},children:R.jsxs("span",{className:"lg-text",children:[He-Y.length," / ",He]})})]})}),R.jsx(ln,{show:I,onHide:xe,className:"modal-postion",children:R.jsxs(ln.Body,{style:{width:"17rem",background:"#232323"},children:[R.jsx("label",{className:"pt-2 pb-3 linear-gradient-text",children:"Edit Comment?"}),R.jsxs("div",{className:"Search",children:[R.jsx("input",{type:"text",name:"description",value:Q,onChange:Ke}),R.jsx("span",{onClick:Oe,className:"material-symbols-outlined",children:"update"})]})]})}),!y&&R.jsx(ln,{show:t,onHide:e,children:R.jsx(ln.Body,{style:{paddingBottom:"18px",maxHeight:"15rem",overflowY:"auto"},children:d.map((Ue,rt)=>{var gt;return R.jsxs("div",{children:[R.jsxs("div",{className:"cmt-containers",children:[R.jsx("img",{onClick:()=>{var ft;return c(`/profile/${(ft=Ue==null?void 0:Ue.user)==null?void 0:ft._id}`)},src:((gt=Ue==null?void 0:Ue.user)==null?void 0:gt.profileimage)||Gr,style:{maxWidth:"2rem"},alt:"avatar"}),R.jsxs("div",{className:"user-details",children:[R.jsx("b",{onClick:()=>{var ft;return c(`/profile/${(ft=Ue==null?void 0:Ue.user)==null?void 0:ft._id}`)},className:"lg-text",children:Ue.user.username}),R.jsxs("span",{className:"text",children:[Ue.text,"    ",R.jsx("img",{onClick:()=>je(Ue),className:"dots",style:{width:"1.5rem"},src:hxe,alt:"dots"})]})]}),R.jsxs("div",{className:"like-count",children:[R.jsx("img",{src:Ue.likes.includes(l._id)?LP:I5,onClick:()=>Ie(Ue._id,Ue),alt:"like"}),R.jsx("span",{className:"lg-text",style:{fontSize:"13px"},children:Ue.likes.length})]})]}),rt<d.length-1?R.jsx("hr",{}):null]},Ue._id)})})})]})};UP.propTypes={showCmt:Le.bool.isRequired,handleCmtClose:Le.func.isRequired,data:Le.shape({_id:Le.string.isRequired,user:Le.object,image:Le.string})};UP.defaultProps={data:null};const cDe="/assets/icon-flatFollow-772d6e29.svg",lDe="/assets/icon-flatUnfollow-fc43a869.svg";function ob({usersToShow:t,userDetails:e,setUsersToShow:n,currUser:r}){const c=bi(),l=Ia(),[d,f]=$.useState(r==null?void 0:r.following),m=Si(w=>w.authReducer.authData.user),E=async w=>{const I=fe.loading("Following...");try{const P=await c(Wb(w,r._id));P.success?(f(k=>[...k,w]),fe.success(R.jsx("b",{children:P.message}))):fe.error(R.jsx("b",{children:P.error})),fe.dismiss(I)}catch(P){fe.dismiss(I),fe.error(R.jsx("b",{children:"Cannot follow at the moment!"})),console.error("Error:",P)}},y=async w=>{const I=fe.loading("Unfollowing...");try{const P=await c(Hb(w,r._id));if(P.success){const k=d.filter(M=>M!==w);f(k),fe.success(R.jsx("b",{children:P.message}))}else fe.error(R.jsx("b",{children:P.error}));fe.dismiss(I)}catch(P){fe.dismiss(I),fe.error(R.jsx("b",{children:"Can't Unfollow at the moment!"})),console.error("Error:",P)}};return R.jsx(ln,{show:t,onHide:()=>n(!1),children:R.jsxs(ln.Body,{style:{overflow:"scroll",maxHeight:"14rem"},children:[e.map(w=>R.jsxs("div",{className:"d-flex flex-column align-items-center",children:[R.jsx(dn.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5},className:"d-flex flex-column py-1 px-1 background",style:{width:"17rem",borderRadius:"1rem"},children:R.jsxs("div",{className:"d-flex gap-5 justify-content-between",children:[R.jsxs("div",{className:"d-flex gap-3 align-items-center",children:[R.jsx("img",{style:{width:"3rem"},className:"rounded-circle",src:w==null?void 0:w.profileimage,alt:"avatar"}),R.jsxs("div",{className:"d-flex flex-column",onClick:()=>l(`/profile/${w._id}`,n(!1)),children:[R.jsx("span",{className:"text-white text-left",children:w==null?void 0:w.username}),R.jsx("span",{className:"text-white align-self-start",children:w==null?void 0:w.fullname})]})]}),w._id!==m._id&&(d.includes(w._id)?R.jsx(dn.img,{whileHover:{scale:1.2},whileTap:{scale:.9},transition:{type:"spring",stiffness:400,damping:17},src:lDe,style:{width:"2.5rem",cursor:"pointer"},onClick:()=>y(w._id)}):R.jsx(dn.img,{whileHover:{scale:1.2},whileTap:{scale:.9},transition:{type:"spring",stiffness:400,damping:17},src:cDe,style:{width:"2.5rem",cursor:"pointer"},onClick:()=>E(w._id)}))]})},w._id),R.jsx("div",{className:"bg-bottom"})]},w._id)),e.length==0&&R.jsx("span",{className:"lg-text",children:"Nothing...!"})]})})}ob.propTypes={usersToShow:Le.bool.isRequired,userDetails:Le.arrayOf(Le.shape({_id:Le.string.isRequired,username:Le.string,profileimage:Le.string})).isRequired,setUsersToShow:Le.func.isRequired,currUser:Le.object.isRequired};const jie=({data:t})=>{var wi,Ne,dt,Et,st,Ot,Qt,kt;const e=bi(),n=Ia(),{user:r}=Si(Lt=>Lt.authReducer.authData),[c,l]=$.useState(!1),[d,f]=$.useState(!1),[m,E]=$.useState(!1),[y,w]=$.useState([]),[I,P]=$.useState(!1),[k,M]=$.useState(!1),[K,W]=$.useState(!1),[V,G]=$.useState(!1),[Q,Z]=$.useState(t.likes.includes(r._id)),[Y,oe]=$.useState(t.likes.length),[ce,Se]=$.useState({description:t.description}),[xe,je]=$.useState(""),[Ge,ze]=$.useState(""),[Ke,He]=$.useState(r==null?void 0:r.saved.includes(t._id)),[be,Oe]=$.useState(r==null?void 0:r.following.includes((wi=t==null?void 0:t.user)==null?void 0:wi._id)),_e=async()=>{if(!Ge.trim())return fe.error(R.jsx("b",{children:"Comment cannot be empty!"}));const Lt={text:Ge,user:r._id,postId:t._id,postUserId:t.user._id};try{const Ut=fe.loading("Commenting...");(await e(iie(Lt))).success?(fe.dismiss(Ut),fe.success(R.jsx("b",{children:"Comment added...!"})),ze("")):(fe.dismiss(Ut),fe.error(R.jsx("b",{children:"Failed to add comment...!"})))}catch(Ut){console.log(Ut)}},We=()=>{G(!0)},Ie=()=>{G(!1)},De=()=>f(!1),Ue=()=>P(!1),rt=()=>{P(!0),De()},gt=()=>{W(!1)},ft=()=>{M(!1),Se({description:t.description})},Ft=()=>f(!0),qt=()=>{W(!0),f(!1)},ti=()=>{M(!0),f(!1)},Vt=()=>{var Lt,Ut;if(!Q&&r._id!==((Lt=t==null?void 0:t.user)==null?void 0:Lt._id)){const Dn={senderId:r._id,receiverId:(Ut=t==null?void 0:t.user)==null?void 0:Ut._id,text:"Liked your Post",url:t==null?void 0:t.image};ng(Dn).then(({data:xt})=>{var Mt;_a.emit("get-notification",{to:Dn.receiverId||((Mt=xt==null?void 0:xt.user)==null?void 0:Mt._id),from:{id:Dn.senderId||r._id,profileimage:r.profileimage,username:r.username},text:Dn.text,url:xt==null?void 0:xt.image})})}Z(Dn=>!Dn),oe(Q?Dn=>Dn-1:Dn=>Dn+1),e(Zne(t._id,r._id))},xn=async()=>{try{l(!0);const Lt=await Jne(t==null?void 0:t._id);Lt.data&&(w(Lt.data.likes),l(!1),E(!0))}catch(Lt){l(!1),console.log(Lt),fe.error(R.jsx("b",{children:"Couldn't get the details"}))}},En=100,Di=Lt=>{const Ut=Lt.target.value;Ut.length<=En&&Se({...ce,[Lt.target.name]:Ut})},ui=100,rn=Lt=>{const Ut=Lt.target.value;Ut.length<=ui&&je(Ut)},Rn=async()=>{if(!xe.trim())return fe.error(R.jsx("b",{children:"cannot send empty report!"}));const Lt=fe.loading("Reporting...");try{const Ut=await e(T5(r._id,"post",t._id,xe));fe.dismiss(Lt),Ut.success?(W(!1),fe.success(R.jsx("b",{children:"Post Reported...!"}))):fe.error(R.jsx("b",{children:"Post Report Failed...!"}))}catch(Ut){fe.error(R.jsx("b",{children:"Something went wrong while updating!"})),console.error("Error:",Ut)}},us=async()=>{const{description:Lt}=ce;if(!Lt.trim()){fe.error(R.jsx("b",{children:"Description cannot be empty!"}));return}const Ut=fe.loading("Updating...");try{const Dn=await e(eie(t._id,r._id,ce));fe.dismiss(Ut),Dn.success?(M(!1),fe.success(R.jsx("b",{children:"Post Updated...!"}))):fe.error(R.jsx("b",{children:"Post Update Failed...!"}))}catch(Dn){fe.error(R.jsx("b",{children:"Something went wrong while updating!"})),console.error("Error:",Dn)}},di=async()=>{const Lt=fe.loading("Deleting...");try{const Ut=await e(y5(t._id,r._id,"user"));fe.dismiss(Lt),Ut.success?fe.success(R.jsx("b",{children:"Post Deleted...!"})):fe.error(R.jsx("b",{children:"Failed to delete...!"}))}catch(Ut){fe.error(R.jsx("b",{children:"Something went wrong!"})),console.error("Error:",Ut)}},Go=async()=>{const Lt=fe.loading("Saving...");try{const Ut=await e(tie(r._id,t._id,Ke));fe.dismiss(Lt),Ut.success?(He(!Ke),fe.success(R.jsx("b",{children:Ut.message}))):fe.error(R.jsx("b",{children:Ut.error})),De()}catch(Ut){De(),fe.error(R.jsx("b",{children:"Something went wrong while saving!"})),console.error("Error:",Ut)}},qr=async()=>{var Ut;const Lt=fe.loading("Following...");try{const Dn=await e(Wb(t.user._id,r._id));if(console.log(Dn),Dn.success){const xt={senderId:r._id,receiverId:(Ut=t==null?void 0:t.user)==null?void 0:Ut._id,text:"Started following you"};ng(xt).then(({data:Mt})=>{var Nt;_a.emit("get-notification",{to:xt.receiverId||((Nt=Mt==null?void 0:Mt.user)==null?void 0:Nt._id),from:{id:xt.senderId||r._id,profileimage:r.profileimage,username:r.username},text:xt.text})}),fe.success(R.jsx("b",{children:Dn.message})),Oe(!be)}else fe.error(R.jsx("b",{children:Dn.error}));fe.dismiss(Lt)}catch(Dn){fe.dismiss(Lt),fe.error(R.jsx("b",{children:"Cannot follow at the moment!"})),console.error("Error:",Dn)}},Zi=async()=>{const Lt=fe.loading("Unfollowing...");Ue();try{const Ut=await e(Hb(t.user._id,r._id));console.log(Ut),Ut.success?(fe.success(R.jsx("b",{children:Ut.message})),Oe(!be)):fe.error(R.jsx("b",{children:Ut.error})),fe.dismiss(Lt)}catch(Ut){fe.dismiss(Lt),fe.error(R.jsx("b",{children:"Can't Unfollow at the moment!"})),console.error("Error:",Ut)}};return R.jsxs("div",{className:"Post",children:[R.jsx(ln,{show:I,onHide:Ue,children:R.jsxs(ln.Body,{style:{width:"10rem"},children:[R.jsx("img",{src:((Ne=t==null?void 0:t.user)==null?void 0:Ne.profileimage)||Gr,alt:""}),R.jsx("span",{className:"lg-text pb-2",children:be?"Unfollow this user?":"Follow this User?"}),R.jsxs("div",{className:"cover",children:[R.jsx("button",{className:"button modalButton",onClick:Ue,children:"No!"}),R.jsx("button",{className:"button modalButton",onClick:Zi,children:"Yes!"})]})]})}),R.jsx(ln,{show:d,onHide:De,className:"modal-postion",children:R.jsxs(ln.Body,{children:[((dt=t.user)==null?void 0:dt._id)!==r._id&&R.jsxs(R.Fragment,{children:[R.jsx("span",{onClick:be?rt:qr,className:"linear-gradient-text",children:be?"Unfollow User":"Follow User"}),R.jsx("hr",{}),R.jsx("span",{onClick:qt,className:"linear-gradient-text",children:"Report Post"}),R.jsx("hr",{})]}),R.jsx("span",{className:"linear-gradient-text",onClick:Go,children:Ke?"Unsave":"Save"}),((Et=t.user)==null?void 0:Et._id)===r._id&&R.jsxs(R.Fragment,{children:[R.jsx("hr",{}),R.jsx("button",{onClick:ti,className:"linear-gradient-text",children:"Edit"}),R.jsx("hr",{}),R.jsx("span",{onClick:di,className:"linear-gradient-text",children:"Delete"})]})]})}),R.jsx(ln,{show:k,onHide:ft,className:"modal-postion",children:R.jsxs(ln.Body,{style:{width:"17rem"},children:[R.jsx("label",{className:"pt-2 pb-3 linear-gradient-text",children:"Edit Description?"}),R.jsxs("div",{className:"Search",children:[R.jsx("input",{type:"text",name:"description",value:ce.description,onChange:Di}),R.jsx("span",{onClick:us,className:"material-symbols-outlined",children:"update"})]}),R.jsx("div",{style:{display:"flex"},children:R.jsxs("span",{className:"lg-text",children:[En-ce.description.length," / ",En]})})]})}),R.jsx(ln,{show:K,onHide:gt,className:"modal-postion",children:R.jsxs(ln.Body,{style:{width:"17rem"},children:[R.jsx("label",{className:"pt-2 pb-3 linear-gradient-text",children:"Provide Reason!"}),R.jsxs("div",{className:"Search",children:[R.jsx("textarea",{type:"text",name:"report",onChange:rn}),R.jsx("span",{onClick:Rn,className:"material-symbols-outlined",children:"report"})]}),R.jsx("div",{style:{display:"flex"},children:R.jsxs("span",{className:"lg-text",children:[ui-xe.length," / ",ui]})})]})}),R.jsx(UP,{showCmt:V,handleCmtClose:Ie,data:t}),y.length!==0&&R.jsx(ob,{currUser:r,usersToShow:m,userDetails:y,setUsersToShow:E}),R.jsxs("div",{className:"header",children:[R.jsx("div",{className:"contents",children:R.jsxs("button",{onClick:()=>n(`/profile/${t.user._id}`),children:[R.jsx("img",{className:"image",src:((st=t.user)==null?void 0:st.profileimage)||Gr,alt:"profile"}),R.jsx("span",{children:((Ot=t.user)==null?void 0:Ot.username)||"noNameAvailable"})]})}),R.jsx("button",{onClick:Ft,children:R.jsx("img",{className:"dot-image",src:Tie,alt:""})})]}),R.jsx("img",{src:t.image,alt:""}),R.jsxs("div",{className:"postReact",children:[R.jsx("img",{src:Q?LP:I5,alt:"",style:{cursor:"pointer"},onClick:Vt}),R.jsx("img",{style:{width:"1.8rem"},src:Sie,alt:"comment",onClick:We})]}),R.jsxs("span",{onClick:xn,className:"d-flex position-relative",style:{color:"var(--gray)",fontSize:"12px",cursor:"pointer"},children:[Y," likes",R.jsx(tv,{loading:c,color:"orange",speedMultiplier:1})]}),R.jsxs("div",{className:"detail",children:[R.jsx("span",{children:R.jsx("b",{children:((Qt=t.user)==null?void 0:Qt.username)||"noNameAvailable"})}),R.jsxs("span",{children:[" ",t.description]})]}),R.jsxs("div",{className:"comment",children:[R.jsx("input",{type:"text",placeholder:"Add a comment...",value:Ge,onChange:Lt=>ze(Lt.target.value)}),R.jsx("img",{src:yie,onClick:_e})]}),((kt=t.comments)==null?void 0:kt.length)!==0&&R.jsx("span",{onClick:We,className:"lg-text viewCmt",children:"View all comments"})]})};jie.propTypes={data:Le.shape({_id:Le.string.isRequired,image:Le.string.isRequired,likes:Le.array.isRequired,comments:Le.array.isRequired,user:Le.shape({username:Le.string,profileimage:Le.string,_id:Le.string.isRequired}),description:Le.string.isRequired}).isRequired};function uDe(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Fie=uDe,dDe=typeof Gt=="object"&&Gt&&Gt.Object===Object&&Gt,hDe=dDe,fDe=hDe,pDe=typeof self=="object"&&self&&self.Object===Object&&self,mDe=fDe||pDe||Function("return this")(),Vie=mDe,gDe=Vie,_De=function(){return gDe.Date.now()},EDe=_De,vDe=/\s/;function yDe(t){for(var e=t.length;e--&&vDe.test(t.charAt(e)););return e}var SDe=yDe,TDe=SDe,bDe=/^\s+/;function wDe(t){return t&&t.slice(0,TDe(t)+1).replace(bDe,"")}var CDe=wDe,RDe=Vie,IDe=RDe.Symbol,Bie=IDe,mq=Bie,Wie=Object.prototype,ADe=Wie.hasOwnProperty,ODe=Wie.toString,FS=mq?mq.toStringTag:void 0;function NDe(t){var e=ADe.call(t,FS),n=t[FS];try{t[FS]=void 0;var r=!0}catch{}var c=ODe.call(t);return r&&(e?t[FS]=n:delete t[FS]),c}var PDe=NDe,xDe=Object.prototype,DDe=xDe.toString;function kDe(t){return DDe.call(t)}var LDe=kDe,gq=Bie,MDe=PDe,UDe=LDe,jDe="[object Null]",FDe="[object Undefined]",_q=gq?gq.toStringTag:void 0;function VDe(t){return t==null?t===void 0?FDe:jDe:_q&&_q in Object(t)?MDe(t):UDe(t)}var BDe=VDe;function WDe(t){return t!=null&&typeof t=="object"}var HDe=WDe,$De=BDe,zDe=HDe,GDe="[object Symbol]";function KDe(t){return typeof t=="symbol"||zDe(t)&&$De(t)==GDe}var qDe=KDe,YDe=CDe,Eq=Fie,XDe=qDe,vq=0/0,JDe=/^[-+]0x[0-9a-f]+$/i,QDe=/^0b[01]+$/i,ZDe=/^0o[0-7]+$/i,eke=parseInt;function tke(t){if(typeof t=="number")return t;if(XDe(t))return vq;if(Eq(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Eq(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=YDe(t);var n=QDe.test(t);return n||ZDe.test(t)?eke(t.slice(2),n?2:8):JDe.test(t)?vq:+t}var nke=tke,ike=Fie,iF=EDe,yq=nke,rke="Expected a function",ske=Math.max,oke=Math.min;function ake(t,e,n){var r,c,l,d,f,m,E=0,y=!1,w=!1,I=!0;if(typeof t!="function")throw new TypeError(rke);e=yq(e)||0,ike(n)&&(y=!!n.leading,w="maxWait"in n,l=w?ske(yq(n.maxWait)||0,e):l,I="trailing"in n?!!n.trailing:I);function P(Y){var oe=r,ce=c;return r=c=void 0,E=Y,d=t.apply(ce,oe),d}function k(Y){return E=Y,f=setTimeout(W,e),y?P(Y):d}function M(Y){var oe=Y-m,ce=Y-E,Se=e-oe;return w?oke(Se,l-ce):Se}function K(Y){var oe=Y-m,ce=Y-E;return m===void 0||oe>=e||oe<0||w&&ce>=l}function W(){var Y=iF();if(K(Y))return V(Y);f=setTimeout(W,M(Y))}function V(Y){return f=void 0,I&&r?P(Y):(r=c=void 0,d)}function G(){f!==void 0&&clearTimeout(f),E=0,r=m=c=f=void 0}function Q(){return f===void 0?d:V(iF())}function Z(){var Y=iF(),oe=K(Y);if(r=arguments,c=this,m=Y,oe){if(f===void 0)return k(m);if(w)return clearTimeout(f),f=setTimeout(W,e),P(m)}return f===void 0&&(f=setTimeout(W,e)),d}return Z.cancel=G,Z.flush=Q,Z}var cke=ake;const k5=Kf(cke),lke=()=>{const t=bi(),{user:e}=Si(k=>k.authReducer.authData);let{posts:n,timeLineloading:r,moreTimelinePosts:c}=Si(k=>k.postReducer);const l=localStorage.getItem("timelinePage"),d=l?parseInt(l,10):1,[f,m]=$.useState(d),[E,y]=$.useState(!1),I=k5(async()=>{if(!E){y(!0);try{window.innerHeight+document.documentElement.scrollTop+1>=document.documentElement.scrollHeight&&c&&m(k=>k+1)}catch(k){console.log(k)}}},1e3),P={display:"block",margin:"auto"};return $.useEffect(()=>{localStorage.getItem("timelinePage")!==String(f)&&(f&&t(Qne(e._id,f)),localStorage.setItem("timelinePage",f))},[f,t,e._id]),$.useEffect(()=>(window.addEventListener("scroll",I),()=>{window.removeEventListener("scroll",I),y(!1)}),[E]),R.jsxs("div",{className:"Posts",children:[n.map(k=>R.jsx(dn.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5},children:R.jsx(jie,{data:k})},k._id)),R.jsx(S5,{loading:r,cssOverride:P,color:"orange"})]})},L5=t=>{const{color:e,size:n,...r}=t;return At.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:n,height:n,viewBox:"0 0 24 24",fill:e,...r},At.createElement("path",{d:"M19,2H5A3,3,0,0,0,2,5V19a3,3,0,0,0,3,3H19a2.81,2.81,0,0,0,.49-.05l.3-.07.07,0h0l.05,0,.37-.14.13-.07c.1-.06.21-.11.31-.18a3.79,3.79,0,0,0,.38-.32l.07-.09a2.69,2.69,0,0,0,.27-.32l.09-.13a2.31,2.31,0,0,0,.18-.35,1,1,0,0,0,.07-.15c.05-.12.08-.25.12-.38l0-.15A2.6,2.6,0,0,0,22,19V5A3,3,0,0,0,19,2ZM5,20a1,1,0,0,1-1-1V14.69l3.29-3.3h0a1,1,0,0,1,1.42,0L17.31,20Zm15-1a1,1,0,0,1-.07.36,1,1,0,0,1-.08.14.94.94,0,0,1-.09.12l-5.35-5.35.88-.88a1,1,0,0,1,1.42,0h0L20,16.69Zm0-5.14L18.12,12a3.08,3.08,0,0,0-4.24,0l-.88.88L10.12,10a3.08,3.08,0,0,0-4.24,0L4,11.86V5A1,1,0,0,1,5,4H19a1,1,0,0,1,1,1ZM13.5,6A1.5,1.5,0,1,0,15,7.5,1.5,1.5,0,0,0,13.5,6Z"}))};L5.propTypes={color:Le.string,size:Le.oneOfType([Le.string,Le.number])};L5.defaultProps={color:"currentColor",size:"24"};const uke=L5,M5=t=>{const{color:e,size:n,...r}=t;return At.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:n,height:n,viewBox:"0 0 24 24",fill:e,...r},At.createElement("path",{d:"M21.71,20.29,18,16.61A9,9,0,1,0,16.61,18l3.68,3.68a1,1,0,0,0,1.42,0A1,1,0,0,0,21.71,20.29ZM11,18a7,7,0,1,1,7-7A7,7,0,0,1,11,18Z"}))};M5.propTypes={color:Le.string,size:Le.oneOfType([Le.string,Le.number])};M5.defaultProps={color:"currentColor",size:"24"};const dke=M5,U5=t=>{const{color:e,size:n,...r}=t;return At.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:n,height:n,viewBox:"0 0 24 24",fill:e,...r},At.createElement("path",{d:"M13.41,12l4.3-4.29a1,1,0,1,0-1.42-1.42L12,10.59,7.71,6.29A1,1,0,0,0,6.29,7.71L10.59,12l-4.3,4.29a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0L12,13.41l4.29,4.3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42Z"}))};U5.propTypes={color:Le.string,size:Le.oneOfType([Le.string,Le.number])};U5.defaultProps={color:"currentColor",size:"24"};const hke=U5,Hie=ip(),$ie=t=>Hie.post("/upload/",t,{headers:{"Content-Type":"multipart/form-data"}}),fke=t=>Hie.post("/posts",t),zie=t=>async e=>{e({type:"IMG_UPLOAD_START"});try{const n=await $ie(t);return e({type:"IMG_UPLOAD_SUCCESS"}),{url:n.data.url}}catch(n){console.log(n),n.response.data.error==="Token has expired"&&e(Bi()),e({type:"IMG_UPLOAD_FAIL"})}},pke=t=>async e=>{e({type:"UPLOAD_START"});try{const n=await fke(t);console.log(n,"upload"),e({type:"UPLOAD_SUCCESS",data:n.data})}catch(n){console.log(n),n.response.data.error==="Token has expired"&&e(Bi()),e({type:"UPLOAD_FAIL"})}};/*!
 * Cropper.js v1.6.1
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2023-09-17T03:44:19.860Z
 */function Sq(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),n.push.apply(n,r)}return n}function Gie(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Sq(Object(n),!0).forEach(function(r){_ke(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Sq(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function bV(t){"@babel/helpers - typeof";return bV=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bV(t)}function mke(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tq(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,qie(r.key),r)}}function gke(t,e,n){return e&&Tq(t.prototype,e),n&&Tq(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _ke(t,e,n){return e=qie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kie(t){return Eke(t)||vke(t)||yke(t)||Ske()}function Eke(t){if(Array.isArray(t))return wV(t)}function vke(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function yke(t,e){if(t){if(typeof t=="string")return wV(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wV(t,e)}}function wV(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ske(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tke(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qie(t){var e=Tke(t,"string");return typeof e=="symbol"?e:String(e)}var jP=typeof window<"u"&&typeof window.document<"u",Nu=jP?window:{},j5=jP&&Nu.document.documentElement?"ontouchstart"in Nu.document.documentElement:!1,F5=jP?"PointerEvent"in Nu:!1,vr="cropper",V5="all",Yie="crop",Xie="move",Jie="zoom",mm="e",gm="w",bE="s",tf="n",VS="ne",BS="nw",WS="se",HS="sw",CV="".concat(vr,"-crop"),bq="".concat(vr,"-disabled"),Ea="".concat(vr,"-hidden"),wq="".concat(vr,"-hide"),bke="".concat(vr,"-invisible"),Y1="".concat(vr,"-modal"),RV="".concat(vr,"-move"),ab="".concat(vr,"Action"),QA="".concat(vr,"Preview"),B5="crop",Qie="move",Zie="none",IV="crop",AV="cropend",OV="cropmove",NV="cropstart",Cq="dblclick",wke=j5?"touchstart":"mousedown",Cke=j5?"touchmove":"mousemove",Rke=j5?"touchend touchcancel":"mouseup",Rq=F5?"pointerdown":wke,Iq=F5?"pointermove":Cke,Aq=F5?"pointerup pointercancel":Rke,Oq="ready",Nq="resize",Pq="wheel",PV="zoom",xq="image/jpeg",Ike=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,Ake=/^data:/,Oke=/^data:image\/jpeg;base64,/,Nke=/^img|canvas$/i,ere=200,tre=100,Dq={viewMode:0,dragMode:B5,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:ere,minContainerHeight:tre,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},Pke='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',xke=Number.isNaN||Nu.isNaN;function Bn(t){return typeof t=="number"&&!xke(t)}var kq=function(e){return e>0&&e<1/0};function rF(t){return typeof t>"u"}function ig(t){return bV(t)==="object"&&t!==null}var Dke=Object.prototype.hasOwnProperty;function HE(t){if(!ig(t))return!1;try{var e=t.constructor,n=e.prototype;return e&&n&&Dke.call(n,"isPrototypeOf")}catch{return!1}}function ga(t){return typeof t=="function"}var kke=Array.prototype.slice;function nre(t){return Array.from?Array.from(t):kke.call(t)}function as(t,e){return t&&ga(e)&&(Array.isArray(t)||Bn(t.length)?nre(t).forEach(function(n,r){e.call(t,n,r,t)}):ig(t)&&Object.keys(t).forEach(function(n){e.call(t,t[n],n,t)})),t}var Sr=Object.assign||function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),c=1;c<n;c++)r[c-1]=arguments[c];return ig(e)&&r.length>0&&r.forEach(function(l){ig(l)&&Object.keys(l).forEach(function(d){e[d]=l[d]})}),e},Lke=/\.\d*(?:0|9){12}\d*$/;function nv(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return Lke.test(t)?Math.round(t*e)/e:t}var Mke=/^width|height|left|top|marginLeft|marginTop$/;function yf(t,e){var n=t.style;as(e,function(r,c){Mke.test(c)&&Bn(r)&&(r="".concat(r,"px")),n[c]=r})}function Uke(t,e){return t.classList?t.classList.contains(e):t.className.indexOf(e)>-1}function xs(t,e){if(e){if(Bn(t.length)){as(t,function(r){xs(r,e)});return}if(t.classList){t.classList.add(e);return}var n=t.className.trim();n?n.indexOf(e)<0&&(t.className="".concat(n," ").concat(e)):t.className=e}}function bu(t,e){if(e){if(Bn(t.length)){as(t,function(n){bu(n,e)});return}if(t.classList){t.classList.remove(e);return}t.className.indexOf(e)>=0&&(t.className=t.className.replace(e,""))}}function $E(t,e,n){if(e){if(Bn(t.length)){as(t,function(r){$E(r,e,n)});return}n?xs(t,e):bu(t,e)}}var jke=/([a-z\d])([A-Z])/g;function W5(t){return t.replace(jke,"$1-$2").toLowerCase()}function xV(t,e){return ig(t[e])?t[e]:t.dataset?t.dataset[e]:t.getAttribute("data-".concat(W5(e)))}function cb(t,e,n){ig(n)?t[e]=n:t.dataset?t.dataset[e]=n:t.setAttribute("data-".concat(W5(e)),n)}function Fke(t,e){if(ig(t[e]))try{delete t[e]}catch{t[e]=void 0}else if(t.dataset)try{delete t.dataset[e]}catch{t.dataset[e]=void 0}else t.removeAttribute("data-".concat(W5(e)))}var ire=/\s\s*/,rre=function(){var t=!1;if(jP){var e=!1,n=function(){},r=Object.defineProperty({},"once",{get:function(){return t=!0,e},set:function(l){e=l}});Nu.addEventListener("test",n,r),Nu.removeEventListener("test",n,r)}return t}();function cl(t,e,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},c=n;e.trim().split(ire).forEach(function(l){if(!rre){var d=t.listeners;d&&d[l]&&d[l][n]&&(c=d[l][n],delete d[l][n],Object.keys(d[l]).length===0&&delete d[l],Object.keys(d).length===0&&delete t.listeners)}t.removeEventListener(l,c,r)})}function Ic(t,e,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},c=n;e.trim().split(ire).forEach(function(l){if(r.once&&!rre){var d=t.listeners,f=d===void 0?{}:d;c=function(){delete f[l][n],t.removeEventListener(l,c,r);for(var E=arguments.length,y=new Array(E),w=0;w<E;w++)y[w]=arguments[w];n.apply(t,y)},f[l]||(f[l]={}),f[l][n]&&t.removeEventListener(l,f[l][n],r),f[l][n]=c,t.listeners=f}t.addEventListener(l,c,r)})}function iv(t,e,n){var r;return ga(Event)&&ga(CustomEvent)?r=new CustomEvent(e,{detail:n,bubbles:!0,cancelable:!0}):(r=document.createEvent("CustomEvent"),r.initCustomEvent(e,!0,!0,n)),t.dispatchEvent(r)}function sre(t){var e=t.getBoundingClientRect();return{left:e.left+(window.pageXOffset-document.documentElement.clientLeft),top:e.top+(window.pageYOffset-document.documentElement.clientTop)}}var sF=Nu.location,Vke=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function Lq(t){var e=t.match(Vke);return e!==null&&(e[1]!==sF.protocol||e[2]!==sF.hostname||e[3]!==sF.port)}function Mq(t){var e="timestamp=".concat(new Date().getTime());return t+(t.indexOf("?")===-1?"?":"&")+e}function wT(t){var e=t.rotate,n=t.scaleX,r=t.scaleY,c=t.translateX,l=t.translateY,d=[];Bn(c)&&c!==0&&d.push("translateX(".concat(c,"px)")),Bn(l)&&l!==0&&d.push("translateY(".concat(l,"px)")),Bn(e)&&e!==0&&d.push("rotate(".concat(e,"deg)")),Bn(n)&&n!==1&&d.push("scaleX(".concat(n,")")),Bn(r)&&r!==1&&d.push("scaleY(".concat(r,")"));var f=d.length?d.join(" "):"none";return{WebkitTransform:f,msTransform:f,transform:f}}function Bke(t){var e=Gie({},t),n=0;return as(t,function(r,c){delete e[c],as(e,function(l){var d=Math.abs(r.startX-l.startX),f=Math.abs(r.startY-l.startY),m=Math.abs(r.endX-l.endX),E=Math.abs(r.endY-l.endY),y=Math.sqrt(d*d+f*f),w=Math.sqrt(m*m+E*E),I=(w-y)/y;Math.abs(I)>Math.abs(n)&&(n=I)})}),n}function ZA(t,e){var n=t.pageX,r=t.pageY,c={endX:n,endY:r};return e?c:Gie({startX:n,startY:r},c)}function Wke(t){var e=0,n=0,r=0;return as(t,function(c){var l=c.startX,d=c.startY;e+=l,n+=d,r+=1}),e/=r,n/=r,{pageX:e,pageY:n}}function Sf(t){var e=t.aspectRatio,n=t.height,r=t.width,c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"contain",l=kq(r),d=kq(n);if(l&&d){var f=n*e;c==="contain"&&f>r||c==="cover"&&f<r?n=r/e:r=n*e}else l?n=r/e:d&&(r=n*e);return{width:r,height:n}}function Hke(t){var e=t.width,n=t.height,r=t.degree;if(r=Math.abs(r)%180,r===90)return{width:n,height:e};var c=r%90*Math.PI/180,l=Math.sin(c),d=Math.cos(c),f=e*d+n*l,m=e*l+n*d;return r>90?{width:m,height:f}:{width:f,height:m}}function $ke(t,e,n,r){var c=e.aspectRatio,l=e.naturalWidth,d=e.naturalHeight,f=e.rotate,m=f===void 0?0:f,E=e.scaleX,y=E===void 0?1:E,w=e.scaleY,I=w===void 0?1:w,P=n.aspectRatio,k=n.naturalWidth,M=n.naturalHeight,K=r.fillColor,W=K===void 0?"transparent":K,V=r.imageSmoothingEnabled,G=V===void 0?!0:V,Q=r.imageSmoothingQuality,Z=Q===void 0?"low":Q,Y=r.maxWidth,oe=Y===void 0?1/0:Y,ce=r.maxHeight,Se=ce===void 0?1/0:ce,xe=r.minWidth,je=xe===void 0?0:xe,Ge=r.minHeight,ze=Ge===void 0?0:Ge,Ke=document.createElement("canvas"),He=Ke.getContext("2d"),be=Sf({aspectRatio:P,width:oe,height:Se}),Oe=Sf({aspectRatio:P,width:je,height:ze},"cover"),_e=Math.min(be.width,Math.max(Oe.width,k)),We=Math.min(be.height,Math.max(Oe.height,M)),Ie=Sf({aspectRatio:c,width:oe,height:Se}),De=Sf({aspectRatio:c,width:je,height:ze},"cover"),Ue=Math.min(Ie.width,Math.max(De.width,l)),rt=Math.min(Ie.height,Math.max(De.height,d)),gt=[-Ue/2,-rt/2,Ue,rt];return Ke.width=nv(_e),Ke.height=nv(We),He.fillStyle=W,He.fillRect(0,0,_e,We),He.save(),He.translate(_e/2,We/2),He.rotate(m*Math.PI/180),He.scale(y,I),He.imageSmoothingEnabled=G,He.imageSmoothingQuality=Z,He.drawImage.apply(He,[t].concat(Kie(gt.map(function(ft){return Math.floor(nv(ft))})))),He.restore(),Ke}var ore=String.fromCharCode;function zke(t,e,n){var r="";n+=e;for(var c=e;c<n;c+=1)r+=ore(t.getUint8(c));return r}var Gke=/^data:.*,/;function Kke(t){var e=t.replace(Gke,""),n=atob(e),r=new ArrayBuffer(n.length),c=new Uint8Array(r);return as(c,function(l,d){c[d]=n.charCodeAt(d)}),r}function qke(t,e){for(var n=[],r=8192,c=new Uint8Array(t);c.length>0;)n.push(ore.apply(null,nre(c.subarray(0,r)))),c=c.subarray(r);return"data:".concat(e,";base64,").concat(btoa(n.join("")))}function Yke(t){var e=new DataView(t),n;try{var r,c,l;if(e.getUint8(0)===255&&e.getUint8(1)===216)for(var d=e.byteLength,f=2;f+1<d;){if(e.getUint8(f)===255&&e.getUint8(f+1)===225){c=f;break}f+=1}if(c){var m=c+4,E=c+10;if(zke(e,m,4)==="Exif"){var y=e.getUint16(E);if(r=y===18761,(r||y===19789)&&e.getUint16(E+2,r)===42){var w=e.getUint32(E+4,r);w>=8&&(l=E+w)}}}if(l){var I=e.getUint16(l,r),P,k;for(k=0;k<I;k+=1)if(P=l+k*12+2,e.getUint16(P,r)===274){P+=8,n=e.getUint16(P,r),e.setUint16(P,1,r);break}}}catch{n=1}return n}function Xke(t){var e=0,n=1,r=1;switch(t){case 2:n=-1;break;case 3:e=-180;break;case 4:r=-1;break;case 5:e=90,r=-1;break;case 6:e=90;break;case 7:e=90,n=-1;break;case 8:e=-90;break}return{rotate:e,scaleX:n,scaleY:r}}var Jke={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var e=this.element,n=this.options,r=this.container,c=this.cropper,l=Number(n.minContainerWidth),d=Number(n.minContainerHeight);xs(c,Ea),bu(e,Ea);var f={width:Math.max(r.offsetWidth,l>=0?l:ere),height:Math.max(r.offsetHeight,d>=0?d:tre)};this.containerData=f,yf(c,{width:f.width,height:f.height}),xs(e,Ea),bu(c,Ea)},initCanvas:function(){var e=this.containerData,n=this.imageData,r=this.options.viewMode,c=Math.abs(n.rotate)%180===90,l=c?n.naturalHeight:n.naturalWidth,d=c?n.naturalWidth:n.naturalHeight,f=l/d,m=e.width,E=e.height;e.height*f>e.width?r===3?m=e.height*f:E=e.width/f:r===3?E=e.width/f:m=e.height*f;var y={aspectRatio:f,naturalWidth:l,naturalHeight:d,width:m,height:E};this.canvasData=y,this.limited=r===1||r===2,this.limitCanvas(!0,!0),y.width=Math.min(Math.max(y.width,y.minWidth),y.maxWidth),y.height=Math.min(Math.max(y.height,y.minHeight),y.maxHeight),y.left=(e.width-y.width)/2,y.top=(e.height-y.height)/2,y.oldLeft=y.left,y.oldTop=y.top,this.initialCanvasData=Sr({},y)},limitCanvas:function(e,n){var r=this.options,c=this.containerData,l=this.canvasData,d=this.cropBoxData,f=r.viewMode,m=l.aspectRatio,E=this.cropped&&d;if(e){var y=Number(r.minCanvasWidth)||0,w=Number(r.minCanvasHeight)||0;f>1?(y=Math.max(y,c.width),w=Math.max(w,c.height),f===3&&(w*m>y?y=w*m:w=y/m)):f>0&&(y?y=Math.max(y,E?d.width:0):w?w=Math.max(w,E?d.height:0):E&&(y=d.width,w=d.height,w*m>y?y=w*m:w=y/m));var I=Sf({aspectRatio:m,width:y,height:w});y=I.width,w=I.height,l.minWidth=y,l.minHeight=w,l.maxWidth=1/0,l.maxHeight=1/0}if(n)if(f>(E?0:1)){var P=c.width-l.width,k=c.height-l.height;l.minLeft=Math.min(0,P),l.minTop=Math.min(0,k),l.maxLeft=Math.max(0,P),l.maxTop=Math.max(0,k),E&&this.limited&&(l.minLeft=Math.min(d.left,d.left+(d.width-l.width)),l.minTop=Math.min(d.top,d.top+(d.height-l.height)),l.maxLeft=d.left,l.maxTop=d.top,f===2&&(l.width>=c.width&&(l.minLeft=Math.min(0,P),l.maxLeft=Math.max(0,P)),l.height>=c.height&&(l.minTop=Math.min(0,k),l.maxTop=Math.max(0,k))))}else l.minLeft=-l.width,l.minTop=-l.height,l.maxLeft=c.width,l.maxTop=c.height},renderCanvas:function(e,n){var r=this.canvasData,c=this.imageData;if(n){var l=Hke({width:c.naturalWidth*Math.abs(c.scaleX||1),height:c.naturalHeight*Math.abs(c.scaleY||1),degree:c.rotate||0}),d=l.width,f=l.height,m=r.width*(d/r.naturalWidth),E=r.height*(f/r.naturalHeight);r.left-=(m-r.width)/2,r.top-=(E-r.height)/2,r.width=m,r.height=E,r.aspectRatio=d/f,r.naturalWidth=d,r.naturalHeight=f,this.limitCanvas(!0,!1)}(r.width>r.maxWidth||r.width<r.minWidth)&&(r.left=r.oldLeft),(r.height>r.maxHeight||r.height<r.minHeight)&&(r.top=r.oldTop),r.width=Math.min(Math.max(r.width,r.minWidth),r.maxWidth),r.height=Math.min(Math.max(r.height,r.minHeight),r.maxHeight),this.limitCanvas(!1,!0),r.left=Math.min(Math.max(r.left,r.minLeft),r.maxLeft),r.top=Math.min(Math.max(r.top,r.minTop),r.maxTop),r.oldLeft=r.left,r.oldTop=r.top,yf(this.canvas,Sr({width:r.width,height:r.height},wT({translateX:r.left,translateY:r.top}))),this.renderImage(e),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(e){var n=this.canvasData,r=this.imageData,c=r.naturalWidth*(n.width/n.naturalWidth),l=r.naturalHeight*(n.height/n.naturalHeight);Sr(r,{width:c,height:l,left:(n.width-c)/2,top:(n.height-l)/2}),yf(this.image,Sr({width:r.width,height:r.height},wT(Sr({translateX:r.left,translateY:r.top},r)))),e&&this.output()},initCropBox:function(){var e=this.options,n=this.canvasData,r=e.aspectRatio||e.initialAspectRatio,c=Number(e.autoCropArea)||.8,l={width:n.width,height:n.height};r&&(n.height*r>n.width?l.height=l.width/r:l.width=l.height*r),this.cropBoxData=l,this.limitCropBox(!0,!0),l.width=Math.min(Math.max(l.width,l.minWidth),l.maxWidth),l.height=Math.min(Math.max(l.height,l.minHeight),l.maxHeight),l.width=Math.max(l.minWidth,l.width*c),l.height=Math.max(l.minHeight,l.height*c),l.left=n.left+(n.width-l.width)/2,l.top=n.top+(n.height-l.height)/2,l.oldLeft=l.left,l.oldTop=l.top,this.initialCropBoxData=Sr({},l)},limitCropBox:function(e,n){var r=this.options,c=this.containerData,l=this.canvasData,d=this.cropBoxData,f=this.limited,m=r.aspectRatio;if(e){var E=Number(r.minCropBoxWidth)||0,y=Number(r.minCropBoxHeight)||0,w=f?Math.min(c.width,l.width,l.width+l.left,c.width-l.left):c.width,I=f?Math.min(c.height,l.height,l.height+l.top,c.height-l.top):c.height;E=Math.min(E,c.width),y=Math.min(y,c.height),m&&(E&&y?y*m>E?y=E/m:E=y*m:E?y=E/m:y&&(E=y*m),I*m>w?I=w/m:w=I*m),d.minWidth=Math.min(E,w),d.minHeight=Math.min(y,I),d.maxWidth=w,d.maxHeight=I}n&&(f?(d.minLeft=Math.max(0,l.left),d.minTop=Math.max(0,l.top),d.maxLeft=Math.min(c.width,l.left+l.width)-d.width,d.maxTop=Math.min(c.height,l.top+l.height)-d.height):(d.minLeft=0,d.minTop=0,d.maxLeft=c.width-d.width,d.maxTop=c.height-d.height))},renderCropBox:function(){var e=this.options,n=this.containerData,r=this.cropBoxData;(r.width>r.maxWidth||r.width<r.minWidth)&&(r.left=r.oldLeft),(r.height>r.maxHeight||r.height<r.minHeight)&&(r.top=r.oldTop),r.width=Math.min(Math.max(r.width,r.minWidth),r.maxWidth),r.height=Math.min(Math.max(r.height,r.minHeight),r.maxHeight),this.limitCropBox(!1,!0),r.left=Math.min(Math.max(r.left,r.minLeft),r.maxLeft),r.top=Math.min(Math.max(r.top,r.minTop),r.maxTop),r.oldLeft=r.left,r.oldTop=r.top,e.movable&&e.cropBoxMovable&&cb(this.face,ab,r.width>=n.width&&r.height>=n.height?Xie:V5),yf(this.cropBox,Sr({width:r.width,height:r.height},wT({translateX:r.left,translateY:r.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),iv(this.element,IV,this.getData())}},Qke={initPreview:function(){var e=this.element,n=this.crossOrigin,r=this.options.preview,c=n?this.crossOriginUrl:this.url,l=e.alt||"The image to preview",d=document.createElement("img");if(n&&(d.crossOrigin=n),d.src=c,d.alt=l,this.viewBox.appendChild(d),this.viewBoxImage=d,!!r){var f=r;typeof r=="string"?f=e.ownerDocument.querySelectorAll(r):r.querySelector&&(f=[r]),this.previews=f,as(f,function(m){var E=document.createElement("img");cb(m,QA,{width:m.offsetWidth,height:m.offsetHeight,html:m.innerHTML}),n&&(E.crossOrigin=n),E.src=c,E.alt=l,E.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',m.innerHTML="",m.appendChild(E)})}},resetPreview:function(){as(this.previews,function(e){var n=xV(e,QA);yf(e,{width:n.width,height:n.height}),e.innerHTML=n.html,Fke(e,QA)})},preview:function(){var e=this.imageData,n=this.canvasData,r=this.cropBoxData,c=r.width,l=r.height,d=e.width,f=e.height,m=r.left-n.left-e.left,E=r.top-n.top-e.top;!this.cropped||this.disabled||(yf(this.viewBoxImage,Sr({width:d,height:f},wT(Sr({translateX:-m,translateY:-E},e)))),as(this.previews,function(y){var w=xV(y,QA),I=w.width,P=w.height,k=I,M=P,K=1;c&&(K=I/c,M=l*K),l&&M>P&&(K=P/l,k=c*K,M=P),yf(y,{width:k,height:M}),yf(y.getElementsByTagName("img")[0],Sr({width:d*K,height:f*K},wT(Sr({translateX:-m*K,translateY:-E*K},e))))}))}},Zke={bind:function(){var e=this.element,n=this.options,r=this.cropper;ga(n.cropstart)&&Ic(e,NV,n.cropstart),ga(n.cropmove)&&Ic(e,OV,n.cropmove),ga(n.cropend)&&Ic(e,AV,n.cropend),ga(n.crop)&&Ic(e,IV,n.crop),ga(n.zoom)&&Ic(e,PV,n.zoom),Ic(r,Rq,this.onCropStart=this.cropStart.bind(this)),n.zoomable&&n.zoomOnWheel&&Ic(r,Pq,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),n.toggleDragModeOnDblclick&&Ic(r,Cq,this.onDblclick=this.dblclick.bind(this)),Ic(e.ownerDocument,Iq,this.onCropMove=this.cropMove.bind(this)),Ic(e.ownerDocument,Aq,this.onCropEnd=this.cropEnd.bind(this)),n.responsive&&Ic(window,Nq,this.onResize=this.resize.bind(this))},unbind:function(){var e=this.element,n=this.options,r=this.cropper;ga(n.cropstart)&&cl(e,NV,n.cropstart),ga(n.cropmove)&&cl(e,OV,n.cropmove),ga(n.cropend)&&cl(e,AV,n.cropend),ga(n.crop)&&cl(e,IV,n.crop),ga(n.zoom)&&cl(e,PV,n.zoom),cl(r,Rq,this.onCropStart),n.zoomable&&n.zoomOnWheel&&cl(r,Pq,this.onWheel,{passive:!1,capture:!0}),n.toggleDragModeOnDblclick&&cl(r,Cq,this.onDblclick),cl(e.ownerDocument,Iq,this.onCropMove),cl(e.ownerDocument,Aq,this.onCropEnd),n.responsive&&cl(window,Nq,this.onResize)}},eLe={resize:function(){if(!this.disabled){var e=this.options,n=this.container,r=this.containerData,c=n.offsetWidth/r.width,l=n.offsetHeight/r.height,d=Math.abs(c-1)>Math.abs(l-1)?c:l;if(d!==1){var f,m;e.restore&&(f=this.getCanvasData(),m=this.getCropBoxData()),this.render(),e.restore&&(this.setCanvasData(as(f,function(E,y){f[y]=E*d})),this.setCropBoxData(as(m,function(E,y){m[y]=E*d})))}}},dblclick:function(){this.disabled||this.options.dragMode===Zie||this.setDragMode(Uke(this.dragBox,CV)?Qie:B5)},wheel:function(e){var n=this,r=Number(this.options.wheelZoomRatio)||.1,c=1;this.disabled||(e.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){n.wheeling=!1},50),e.deltaY?c=e.deltaY>0?1:-1:e.wheelDelta?c=-e.wheelDelta/120:e.detail&&(c=e.detail>0?1:-1),this.zoom(-c*r,e)))},cropStart:function(e){var n=e.buttons,r=e.button;if(!(this.disabled||(e.type==="mousedown"||e.type==="pointerdown"&&e.pointerType==="mouse")&&(Bn(n)&&n!==1||Bn(r)&&r!==0||e.ctrlKey))){var c=this.options,l=this.pointers,d;e.changedTouches?as(e.changedTouches,function(f){l[f.identifier]=ZA(f)}):l[e.pointerId||0]=ZA(e),Object.keys(l).length>1&&c.zoomable&&c.zoomOnTouch?d=Jie:d=xV(e.target,ab),Ike.test(d)&&iv(this.element,NV,{originalEvent:e,action:d})!==!1&&(e.preventDefault(),this.action=d,this.cropping=!1,d===Yie&&(this.cropping=!0,xs(this.dragBox,Y1)))}},cropMove:function(e){var n=this.action;if(!(this.disabled||!n)){var r=this.pointers;e.preventDefault(),iv(this.element,OV,{originalEvent:e,action:n})!==!1&&(e.changedTouches?as(e.changedTouches,function(c){Sr(r[c.identifier]||{},ZA(c,!0))}):Sr(r[e.pointerId||0]||{},ZA(e,!0)),this.change(e))}},cropEnd:function(e){if(!this.disabled){var n=this.action,r=this.pointers;e.changedTouches?as(e.changedTouches,function(c){delete r[c.identifier]}):delete r[e.pointerId||0],n&&(e.preventDefault(),Object.keys(r).length||(this.action=""),this.cropping&&(this.cropping=!1,$E(this.dragBox,Y1,this.cropped&&this.options.modal)),iv(this.element,AV,{originalEvent:e,action:n}))}}},tLe={change:function(e){var n=this.options,r=this.canvasData,c=this.containerData,l=this.cropBoxData,d=this.pointers,f=this.action,m=n.aspectRatio,E=l.left,y=l.top,w=l.width,I=l.height,P=E+w,k=y+I,M=0,K=0,W=c.width,V=c.height,G=!0,Q;!m&&e.shiftKey&&(m=w&&I?w/I:1),this.limited&&(M=l.minLeft,K=l.minTop,W=M+Math.min(c.width,r.width,r.left+r.width),V=K+Math.min(c.height,r.height,r.top+r.height));var Z=d[Object.keys(d)[0]],Y={x:Z.endX-Z.startX,y:Z.endY-Z.startY},oe=function(Se){switch(Se){case mm:P+Y.x>W&&(Y.x=W-P);break;case gm:E+Y.x<M&&(Y.x=M-E);break;case tf:y+Y.y<K&&(Y.y=K-y);break;case bE:k+Y.y>V&&(Y.y=V-k);break}};switch(f){case V5:E+=Y.x,y+=Y.y;break;case mm:if(Y.x>=0&&(P>=W||m&&(y<=K||k>=V))){G=!1;break}oe(mm),w+=Y.x,w<0&&(f=gm,w=-w,E-=w),m&&(I=w/m,y+=(l.height-I)/2);break;case tf:if(Y.y<=0&&(y<=K||m&&(E<=M||P>=W))){G=!1;break}oe(tf),I-=Y.y,y+=Y.y,I<0&&(f=bE,I=-I,y-=I),m&&(w=I*m,E+=(l.width-w)/2);break;case gm:if(Y.x<=0&&(E<=M||m&&(y<=K||k>=V))){G=!1;break}oe(gm),w-=Y.x,E+=Y.x,w<0&&(f=mm,w=-w,E-=w),m&&(I=w/m,y+=(l.height-I)/2);break;case bE:if(Y.y>=0&&(k>=V||m&&(E<=M||P>=W))){G=!1;break}oe(bE),I+=Y.y,I<0&&(f=tf,I=-I,y-=I),m&&(w=I*m,E+=(l.width-w)/2);break;case VS:if(m){if(Y.y<=0&&(y<=K||P>=W)){G=!1;break}oe(tf),I-=Y.y,y+=Y.y,w=I*m}else oe(tf),oe(mm),Y.x>=0?P<W?w+=Y.x:Y.y<=0&&y<=K&&(G=!1):w+=Y.x,Y.y<=0?y>K&&(I-=Y.y,y+=Y.y):(I-=Y.y,y+=Y.y);w<0&&I<0?(f=HS,I=-I,w=-w,y-=I,E-=w):w<0?(f=BS,w=-w,E-=w):I<0&&(f=WS,I=-I,y-=I);break;case BS:if(m){if(Y.y<=0&&(y<=K||E<=M)){G=!1;break}oe(tf),I-=Y.y,y+=Y.y,w=I*m,E+=l.width-w}else oe(tf),oe(gm),Y.x<=0?E>M?(w-=Y.x,E+=Y.x):Y.y<=0&&y<=K&&(G=!1):(w-=Y.x,E+=Y.x),Y.y<=0?y>K&&(I-=Y.y,y+=Y.y):(I-=Y.y,y+=Y.y);w<0&&I<0?(f=WS,I=-I,w=-w,y-=I,E-=w):w<0?(f=VS,w=-w,E-=w):I<0&&(f=HS,I=-I,y-=I);break;case HS:if(m){if(Y.x<=0&&(E<=M||k>=V)){G=!1;break}oe(gm),w-=Y.x,E+=Y.x,I=w/m}else oe(bE),oe(gm),Y.x<=0?E>M?(w-=Y.x,E+=Y.x):Y.y>=0&&k>=V&&(G=!1):(w-=Y.x,E+=Y.x),Y.y>=0?k<V&&(I+=Y.y):I+=Y.y;w<0&&I<0?(f=VS,I=-I,w=-w,y-=I,E-=w):w<0?(f=WS,w=-w,E-=w):I<0&&(f=BS,I=-I,y-=I);break;case WS:if(m){if(Y.x>=0&&(P>=W||k>=V)){G=!1;break}oe(mm),w+=Y.x,I=w/m}else oe(bE),oe(mm),Y.x>=0?P<W?w+=Y.x:Y.y>=0&&k>=V&&(G=!1):w+=Y.x,Y.y>=0?k<V&&(I+=Y.y):I+=Y.y;w<0&&I<0?(f=BS,I=-I,w=-w,y-=I,E-=w):w<0?(f=HS,w=-w,E-=w):I<0&&(f=VS,I=-I,y-=I);break;case Xie:this.move(Y.x,Y.y),G=!1;break;case Jie:this.zoom(Bke(d),e),G=!1;break;case Yie:if(!Y.x||!Y.y){G=!1;break}Q=sre(this.cropper),E=Z.startX-Q.left,y=Z.startY-Q.top,w=l.minWidth,I=l.minHeight,Y.x>0?f=Y.y>0?WS:VS:Y.x<0&&(E-=w,f=Y.y>0?HS:BS),Y.y<0&&(y-=I),this.cropped||(bu(this.cropBox,Ea),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0));break}G&&(l.width=w,l.height=I,l.left=E,l.top=y,this.action=f,this.renderCropBox()),as(d,function(ce){ce.startX=ce.endX,ce.startY=ce.endY})}},nLe={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&xs(this.dragBox,Y1),bu(this.cropBox,Ea),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=Sr({},this.initialImageData),this.canvasData=Sr({},this.initialCanvasData),this.cropBoxData=Sr({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(Sr(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),bu(this.dragBox,Y1),xs(this.cropBox,Ea)),this},replace:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return!this.disabled&&e&&(this.isImg&&(this.element.src=e),n?(this.url=e,this.image.src=e,this.ready&&(this.viewBoxImage.src=e,as(this.previews,function(r){r.getElementsByTagName("img")[0].src=e}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(e))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,bu(this.cropper,bq)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,xs(this.cropper,bq)),this},destroy:function(){var e=this.element;return e[vr]?(e[vr]=void 0,this.isImg&&this.replaced&&(e.src=this.originalUrl),this.uncreate(),this):this},move:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=this.canvasData,c=r.left,l=r.top;return this.moveTo(rF(e)?e:c+Number(e),rF(n)?n:l+Number(n))},moveTo:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=this.canvasData,c=!1;return e=Number(e),n=Number(n),this.ready&&!this.disabled&&this.options.movable&&(Bn(e)&&(r.left=e,c=!0),Bn(n)&&(r.top=n,c=!0),c&&this.renderCanvas(!0)),this},zoom:function(e,n){var r=this.canvasData;return e=Number(e),e<0?e=1/(1-e):e=1+e,this.zoomTo(r.width*e/r.naturalWidth,null,n)},zoomTo:function(e,n,r){var c=this.options,l=this.canvasData,d=l.width,f=l.height,m=l.naturalWidth,E=l.naturalHeight;if(e=Number(e),e>=0&&this.ready&&!this.disabled&&c.zoomable){var y=m*e,w=E*e;if(iv(this.element,PV,{ratio:e,oldRatio:d/m,originalEvent:r})===!1)return this;if(r){var I=this.pointers,P=sre(this.cropper),k=I&&Object.keys(I).length?Wke(I):{pageX:r.pageX,pageY:r.pageY};l.left-=(y-d)*((k.pageX-P.left-l.left)/d),l.top-=(w-f)*((k.pageY-P.top-l.top)/f)}else HE(n)&&Bn(n.x)&&Bn(n.y)?(l.left-=(y-d)*((n.x-l.left)/d),l.top-=(w-f)*((n.y-l.top)/f)):(l.left-=(y-d)/2,l.top-=(w-f)/2);l.width=y,l.height=w,this.renderCanvas(!0)}return this},rotate:function(e){return this.rotateTo((this.imageData.rotate||0)+Number(e))},rotateTo:function(e){return e=Number(e),Bn(e)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=e%360,this.renderCanvas(!0,!0)),this},scaleX:function(e){var n=this.imageData.scaleY;return this.scale(e,Bn(n)?n:1)},scaleY:function(e){var n=this.imageData.scaleX;return this.scale(Bn(n)?n:1,e)},scale:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=this.imageData,c=!1;return e=Number(e),n=Number(n),this.ready&&!this.disabled&&this.options.scalable&&(Bn(e)&&(r.scaleX=e,c=!0),Bn(n)&&(r.scaleY=n,c=!0),c&&this.renderCanvas(!0,!0)),this},getData:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.options,r=this.imageData,c=this.canvasData,l=this.cropBoxData,d;if(this.ready&&this.cropped){d={x:l.left-c.left,y:l.top-c.top,width:l.width,height:l.height};var f=r.width/r.naturalWidth;if(as(d,function(y,w){d[w]=y/f}),e){var m=Math.round(d.y+d.height),E=Math.round(d.x+d.width);d.x=Math.round(d.x),d.y=Math.round(d.y),d.width=E-d.x,d.height=m-d.y}}else d={x:0,y:0,width:0,height:0};return n.rotatable&&(d.rotate=r.rotate||0),n.scalable&&(d.scaleX=r.scaleX||1,d.scaleY=r.scaleY||1),d},setData:function(e){var n=this.options,r=this.imageData,c=this.canvasData,l={};if(this.ready&&!this.disabled&&HE(e)){var d=!1;n.rotatable&&Bn(e.rotate)&&e.rotate!==r.rotate&&(r.rotate=e.rotate,d=!0),n.scalable&&(Bn(e.scaleX)&&e.scaleX!==r.scaleX&&(r.scaleX=e.scaleX,d=!0),Bn(e.scaleY)&&e.scaleY!==r.scaleY&&(r.scaleY=e.scaleY,d=!0)),d&&this.renderCanvas(!0,!0);var f=r.width/r.naturalWidth;Bn(e.x)&&(l.left=e.x*f+c.left),Bn(e.y)&&(l.top=e.y*f+c.top),Bn(e.width)&&(l.width=e.width*f),Bn(e.height)&&(l.height=e.height*f),this.setCropBoxData(l)}return this},getContainerData:function(){return this.ready?Sr({},this.containerData):{}},getImageData:function(){return this.sized?Sr({},this.imageData):{}},getCanvasData:function(){var e=this.canvasData,n={};return this.ready&&as(["left","top","width","height","naturalWidth","naturalHeight"],function(r){n[r]=e[r]}),n},setCanvasData:function(e){var n=this.canvasData,r=n.aspectRatio;return this.ready&&!this.disabled&&HE(e)&&(Bn(e.left)&&(n.left=e.left),Bn(e.top)&&(n.top=e.top),Bn(e.width)?(n.width=e.width,n.height=e.width/r):Bn(e.height)&&(n.height=e.height,n.width=e.height*r),this.renderCanvas(!0)),this},getCropBoxData:function(){var e=this.cropBoxData,n;return this.ready&&this.cropped&&(n={left:e.left,top:e.top,width:e.width,height:e.height}),n||{}},setCropBoxData:function(e){var n=this.cropBoxData,r=this.options.aspectRatio,c,l;return this.ready&&this.cropped&&!this.disabled&&HE(e)&&(Bn(e.left)&&(n.left=e.left),Bn(e.top)&&(n.top=e.top),Bn(e.width)&&e.width!==n.width&&(c=!0,n.width=e.width),Bn(e.height)&&e.height!==n.height&&(l=!0,n.height=e.height),r&&(c?n.height=n.width/r:l&&(n.width=n.height*r)),this.renderCropBox()),this},getCroppedCanvas:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var n=this.canvasData,r=$ke(this.image,this.imageData,n,e);if(!this.cropped)return r;var c=this.getData(e.rounded),l=c.x,d=c.y,f=c.width,m=c.height,E=r.width/Math.floor(n.naturalWidth);E!==1&&(l*=E,d*=E,f*=E,m*=E);var y=f/m,w=Sf({aspectRatio:y,width:e.maxWidth||1/0,height:e.maxHeight||1/0}),I=Sf({aspectRatio:y,width:e.minWidth||0,height:e.minHeight||0},"cover"),P=Sf({aspectRatio:y,width:e.width||(E!==1?r.width:f),height:e.height||(E!==1?r.height:m)}),k=P.width,M=P.height;k=Math.min(w.width,Math.max(I.width,k)),M=Math.min(w.height,Math.max(I.height,M));var K=document.createElement("canvas"),W=K.getContext("2d");K.width=nv(k),K.height=nv(M),W.fillStyle=e.fillColor||"transparent",W.fillRect(0,0,k,M);var V=e.imageSmoothingEnabled,G=V===void 0?!0:V,Q=e.imageSmoothingQuality;W.imageSmoothingEnabled=G,Q&&(W.imageSmoothingQuality=Q);var Z=r.width,Y=r.height,oe=l,ce=d,Se,xe,je,Ge,ze,Ke;oe<=-f||oe>Z?(oe=0,Se=0,je=0,ze=0):oe<=0?(je=-oe,oe=0,Se=Math.min(Z,f+oe),ze=Se):oe<=Z&&(je=0,Se=Math.min(f,Z-oe),ze=Se),Se<=0||ce<=-m||ce>Y?(ce=0,xe=0,Ge=0,Ke=0):ce<=0?(Ge=-ce,ce=0,xe=Math.min(Y,m+ce),Ke=xe):ce<=Y&&(Ge=0,xe=Math.min(m,Y-ce),Ke=xe);var He=[oe,ce,Se,xe];if(ze>0&&Ke>0){var be=k/f;He.push(je*be,Ge*be,ze*be,Ke*be)}return W.drawImage.apply(W,[r].concat(Kie(He.map(function(Oe){return Math.floor(nv(Oe))})))),K},setAspectRatio:function(e){var n=this.options;return!this.disabled&&!rF(e)&&(n.aspectRatio=Math.max(0,e)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(e){var n=this.options,r=this.dragBox,c=this.face;if(this.ready&&!this.disabled){var l=e===B5,d=n.movable&&e===Qie;e=l||d?e:Zie,n.dragMode=e,cb(r,ab,e),$E(r,CV,l),$E(r,RV,d),n.cropBoxMovable||(cb(c,ab,e),$E(c,CV,l),$E(c,RV,d))}return this}},iLe=Nu.Cropper,are=function(){function t(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(mke(this,t),!e||!Nke.test(e.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=e,this.options=Sr({},Dq,HE(n)&&n),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return gke(t,[{key:"init",value:function(){var n=this.element,r=n.tagName.toLowerCase(),c;if(!n[vr]){if(n[vr]=this,r==="img"){if(this.isImg=!0,c=n.getAttribute("src")||"",this.originalUrl=c,!c)return;c=n.src}else r==="canvas"&&window.HTMLCanvasElement&&(c=n.toDataURL());this.load(c)}}},{key:"load",value:function(n){var r=this;if(n){this.url=n,this.imageData={};var c=this.element,l=this.options;if(!l.rotatable&&!l.scalable&&(l.checkOrientation=!1),!l.checkOrientation||!window.ArrayBuffer){this.clone();return}if(Ake.test(n)){Oke.test(n)?this.read(Kke(n)):this.clone();return}var d=new XMLHttpRequest,f=this.clone.bind(this);this.reloading=!0,this.xhr=d,d.onabort=f,d.onerror=f,d.ontimeout=f,d.onprogress=function(){d.getResponseHeader("content-type")!==xq&&d.abort()},d.onload=function(){r.read(d.response)},d.onloadend=function(){r.reloading=!1,r.xhr=null},l.checkCrossOrigin&&Lq(n)&&c.crossOrigin&&(n=Mq(n)),d.open("GET",n,!0),d.responseType="arraybuffer",d.withCredentials=c.crossOrigin==="use-credentials",d.send()}}},{key:"read",value:function(n){var r=this.options,c=this.imageData,l=Yke(n),d=0,f=1,m=1;if(l>1){this.url=qke(n,xq);var E=Xke(l);d=E.rotate,f=E.scaleX,m=E.scaleY}r.rotatable&&(c.rotate=d),r.scalable&&(c.scaleX=f,c.scaleY=m),this.clone()}},{key:"clone",value:function(){var n=this.element,r=this.url,c=n.crossOrigin,l=r;this.options.checkCrossOrigin&&Lq(r)&&(c||(c="anonymous"),l=Mq(r)),this.crossOrigin=c,this.crossOriginUrl=l;var d=document.createElement("img");c&&(d.crossOrigin=c),d.src=l||r,d.alt=n.alt||"The image to crop",this.image=d,d.onload=this.start.bind(this),d.onerror=this.stop.bind(this),xs(d,wq),n.parentNode.insertBefore(d,n.nextSibling)}},{key:"start",value:function(){var n=this,r=this.image;r.onload=null,r.onerror=null,this.sizing=!0;var c=Nu.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(Nu.navigator.userAgent),l=function(E,y){Sr(n.imageData,{naturalWidth:E,naturalHeight:y,aspectRatio:E/y}),n.initialImageData=Sr({},n.imageData),n.sizing=!1,n.sized=!0,n.build()};if(r.naturalWidth&&!c){l(r.naturalWidth,r.naturalHeight);return}var d=document.createElement("img"),f=document.body||document.documentElement;this.sizingImage=d,d.onload=function(){l(d.width,d.height),c||f.removeChild(d)},d.src=r.src,c||(d.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",f.appendChild(d))}},{key:"stop",value:function(){var n=this.image;n.onload=null,n.onerror=null,n.parentNode.removeChild(n),this.image=null}},{key:"build",value:function(){if(!(!this.sized||this.ready)){var n=this.element,r=this.options,c=this.image,l=n.parentNode,d=document.createElement("div");d.innerHTML=Pke;var f=d.querySelector(".".concat(vr,"-container")),m=f.querySelector(".".concat(vr,"-canvas")),E=f.querySelector(".".concat(vr,"-drag-box")),y=f.querySelector(".".concat(vr,"-crop-box")),w=y.querySelector(".".concat(vr,"-face"));this.container=l,this.cropper=f,this.canvas=m,this.dragBox=E,this.cropBox=y,this.viewBox=f.querySelector(".".concat(vr,"-view-box")),this.face=w,m.appendChild(c),xs(n,Ea),l.insertBefore(f,n.nextSibling),bu(c,wq),this.initPreview(),this.bind(),r.initialAspectRatio=Math.max(0,r.initialAspectRatio)||NaN,r.aspectRatio=Math.max(0,r.aspectRatio)||NaN,r.viewMode=Math.max(0,Math.min(3,Math.round(r.viewMode)))||0,xs(y,Ea),r.guides||xs(y.getElementsByClassName("".concat(vr,"-dashed")),Ea),r.center||xs(y.getElementsByClassName("".concat(vr,"-center")),Ea),r.background&&xs(f,"".concat(vr,"-bg")),r.highlight||xs(w,bke),r.cropBoxMovable&&(xs(w,RV),cb(w,ab,V5)),r.cropBoxResizable||(xs(y.getElementsByClassName("".concat(vr,"-line")),Ea),xs(y.getElementsByClassName("".concat(vr,"-point")),Ea)),this.render(),this.ready=!0,this.setDragMode(r.dragMode),r.autoCrop&&this.crop(),this.setData(r.data),ga(r.ready)&&Ic(n,Oq,r.ready,{once:!0}),iv(n,Oq)}}},{key:"unbuild",value:function(){if(this.ready){this.ready=!1,this.unbind(),this.resetPreview();var n=this.cropper.parentNode;n&&n.removeChild(this.cropper),bu(this.element,Ea)}}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=iLe,t}},{key:"setDefaults",value:function(n){Sr(Dq,HE(n)&&n)}}]),t}();Sr(are.prototype,Jke,Qke,Zke,eLe,tLe,nLe);var xm=function(){return xm=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var c in e=arguments[n])Object.prototype.hasOwnProperty.call(e,c)&&(t[c]=e[c]);return t},xm.apply(this,arguments)};function oF(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function"){var c=0;for(r=Object.getOwnPropertySymbols(t);c<r.length;c++)e.indexOf(r[c])<0&&Object.prototype.propertyIsEnumerable.call(t,r[c])&&(n[r[c]]=t[r[c]])}return n}var rLe=["aspectRatio","autoCrop","autoCropArea","background","center","checkCrossOrigin","checkOrientation","cropBoxMovable","cropBoxResizable","data","dragMode","guides","highlight","initialAspectRatio","minCanvasHeight","minCanvasWidth","minContainerHeight","minContainerWidth","minCropBoxHeight","minCropBoxWidth","modal","movable","preview","responsive","restore","rotatable","scalable","toggleDragModeOnDblclick","viewMode","wheelZoomRatio","zoomOnTouch","zoomOnWheel","zoomable","cropstart","cropmove","cropend","crop","zoom","ready"],sLe={opacity:0,maxWidth:"100%"},cre=At.forwardRef(function(t,e){var n=oF(t,[]),r=n.dragMode,c=r===void 0?"crop":r,l=n.src,d=n.style,f=n.className,m=n.crossOrigin,E=n.scaleX,y=n.scaleY,w=n.enable,I=n.zoomTo,P=n.rotateTo,k=n.alt,M=k===void 0?"picture":k,K=n.ready,W=n.onInitialized,V=oF(n,["dragMode","src","style","className","crossOrigin","scaleX","scaleY","enable","zoomTo","rotateTo","alt","ready","onInitialized"]),G={scaleY:y,scaleX:E,enable:w,zoomTo:I,rotateTo:P},Q=function(){for(var Y=[],oe=0;oe<arguments.length;oe++)Y[oe]=arguments[oe];var ce=$.useRef(null);return At.useEffect(function(){Y.forEach(function(Se){Se&&(typeof Se=="function"?Se(ce.current):Se.current=ce.current)})},[Y]),ce}(e,$.useRef(null));$.useEffect(function(){var Y;!((Y=Q.current)===null||Y===void 0)&&Y.cropper&&typeof I=="number"&&Q.current.cropper.zoomTo(I)},[n.zoomTo]),$.useEffect(function(){var Y;!((Y=Q.current)===null||Y===void 0)&&Y.cropper&&l!==void 0&&Q.current.cropper.reset().clear().replace(l)},[l]),$.useEffect(function(){if(Q.current!==null){var Y=new are(Q.current,xm(xm({dragMode:c},V),{ready:function(oe){oe.currentTarget!==null&&function(ce,Se){Se===void 0&&(Se={});var xe=Se.enable,je=xe===void 0||xe,Ge=Se.scaleX,ze=Ge===void 0?1:Ge,Ke=Se.scaleY,He=Ke===void 0?1:Ke,be=Se.zoomTo,Oe=be===void 0?0:be,_e=Se.rotateTo;je?ce.enable():ce.disable(),ce.scaleX(ze),ce.scaleY(He),_e!==void 0&&ce.rotateTo(_e),Oe>0&&ce.zoomTo(Oe)}(oe.currentTarget.cropper,G),K&&K(oe)}}));W&&W(Y)}return function(){var oe,ce;(ce=(oe=Q.current)===null||oe===void 0?void 0:oe.cropper)===null||ce===void 0||ce.destroy()}},[Q]);var Z=function(Y){return rLe.reduce(function(oe,ce){var Se=oe,xe=ce;return Se[xe],oF(Se,[typeof xe=="symbol"?xe:xe+""])},Y)}(xm(xm({},V),{crossOrigin:m,src:l,alt:M}));return At.createElement("div",{style:d,className:f},At.createElement("img",xm({},Z,{style:sLe,ref:Q})))});const oLe=()=>{const{user:t}=Si(V=>V.authReducer.authData),e=Si(V=>V.postReducer.uploading),n=Si(V=>V.postReducer.error),r=bi(),[c,l]=$.useState(null),[d,f]=$.useState(null),[m,E]=$.useState(null),y=$.useRef(),w=$.useRef(),I=$.useRef(),P=async V=>{if(V.preventDefault(),!I.current.value&&!c)return fe.error(R.jsx("b",{children:"Please Provide the Details!"}));if(I.current.value){if(!c)return fe.error(R.jsx("b",{children:"Please Provide an Image...!"}))}else return fe.error(R.jsx("b",{children:"Please Provide Description..!"}));const G={user:t._id,description:I.current.value},Q=d?m:c;if(Q&&k(Q)){const Z=new FormData;Z.append("file",Q.file);try{const Y=await r(zie(Z));if(Y&&Y.url){G.image=Y.url;try{if(await r(pke(G)),n)fe.error(R.jsx("b",{children:"Failed to upload post"}));else return M(),fe.success(R.jsx("b",{children:"Post uploaded successfully..!"}))}catch(oe){fe.error(R.jsx("b",{children:"Failed to Upload"})),console.log(oe)}}else fe.error(R.jsx("b",{children:"Failed to Upload Image"}))}catch(Y){fe.error(R.jsxs("b",{children:["Failed to Upload Image...!",n]})),console.log(Y)}}},k=V=>["image/jpeg","image/png","image/jpg"].includes(V.file.type)?V.file.size>4194304?(fe.error(R.jsx("b",{children:"The image size cannot exceed 2MB"})),!1):!0:(fe.error(R.jsx("b",{children:"Only JPEG, JPG and PNG images are allowed"})),!1),M=()=>{l(null),f(null),I.current.value=""},K=V=>{if(f(null),V.target.files&&V.target.files[0]){let G=V.target.files[0];const Q=G.name.split(".").pop().toLowerCase();if(["jpg","jpeg","png"].includes(Q))l({name:G.name,url:URL.createObjectURL(G),file:G});else return l(null),fe.error(R.jsx("b",{children:"Invalid file type. Please select a JPG, JPEG, or PNG image."}))}},W=()=>{var V,G;if(typeof((V=w.current)==null?void 0:V.cropper)<"u"){fe.success(R.jsx("b",{children:"Cropped!!"}));const Q=(G=w.current)==null?void 0:G.cropper.getCroppedCanvas();f(Q.toDataURL()),Q.toBlob(function(Z){const Y=new File([Z],c.name,{type:Z.type});E({file:Y})},c.type)}};return R.jsxs(R.Fragment,{children:[R.jsx(ku,{position:"top-center",reverseOrder:!1}),R.jsxs("div",{className:"PostShare",children:[R.jsx("img",{src:t.profileimage||Gr,alt:""}),R.jsxs(dn.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5},children:[R.jsx("input",{type:"text",name:"description",placeholder:"What's happening",ref:I}),R.jsxs("div",{className:"postOptions",children:[R.jsxs("div",{className:"option",style:{color:"var(--photo)"},onClick:()=>y.current.click(),children:[R.jsx(uke,{}),"Photo"]}),R.jsx("button",{className:"button ps-button",onClick:P,disabled:e,children:e?"Sharing...":"Share"}),R.jsx("div",{style:{display:"none"},children:R.jsx("input",{type:"file",name:"myImage",ref:y,onChange:K,accept:"image/*"})})]}),c&&R.jsxs("div",{children:[R.jsx("button",{className:"crop-button",onClick:W,children:R.jsx("span",{className:"material-symbols-outlined",children:"screenshot_region"})}),R.jsx("button",{className:"close-button",onClick:()=>{l(null),f(null)},children:R.jsx("span",{className:"material-symbols-outlined",children:"close "})}),R.jsx(cre,{ref:w,src:c.url,aspectRatio:2,background:!1,responsive:!0})]}),d&&R.jsxs(R.Fragment,{children:[R.jsx("span",{children:"Preview"}),R.jsxs("div",{className:"previewImage bg-dark",children:[R.jsx(hke,{onClick:()=>f(null)}),R.jsx("img",{src:d,alt:"Cropped"})]})]})]})]})]})},aLe=()=>R.jsxs("div",{className:"PostSide",children:[window.innerWidth<930&&R.jsx(Xne,{}),R.jsx(oLe,{}),R.jsx(lke,{})]});function lre({follower:t}){const e=Ia(),n=bi(),{user:r}=Si(y=>y.authReducer.authData),[c,l]=$.useState(r==null?void 0:r.following.includes(t==null?void 0:t._id)),[d,f]=$.useState(!1),m=async()=>{const y=fe.loading("Following...");f(!0);try{const w=await n(Wb(t==null?void 0:t._id,r._id));f(!1),console.log(w),w!=null&&w.success?(fe.success(R.jsx("b",{children:w==null?void 0:w.message})),l(!c)):fe.error(R.jsx("b",{children:w==null?void 0:w.error})),fe.dismiss(y)}catch(w){f(!1),fe.dismiss(y),fe.error(R.jsx("b",{children:"Cannot follow at the moment!"})),console.error("Error:",w)}},E=async()=>{const y=fe.loading("Unfollowing...");try{const w=await n(Hb(t==null?void 0:t._id,r._id));console.log(w),w!=null&&w.success?(fe.success(R.jsx("b",{children:w==null?void 0:w.message})),l(!c)):fe.error(R.jsx("b",{children:w==null?void 0:w.error})),fe.dismiss(y)}catch(w){fe.dismiss(y),fe.error(R.jsx("b",{children:"Can't Unfollow at the moment!"})),console.error("Error:",w)}};return R.jsxs(R.Fragment,{children:[R.jsx(ku,{position:"top-center",reverseOrder:!1}),t._id!==r._id&&R.jsxs(dn.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{duration:.5},className:"follower pb-3 gap-1",children:[R.jsxs("div",{onClick:()=>e(`/profile/${t==null?void 0:t._id}`),style:{cursor:"pointer"},children:[R.jsx("img",{src:(t==null?void 0:t.profileimage)||Gr,alt:"",className:"followerImage"}),R.jsxs("div",{className:"name",children:[R.jsx("span",{children:t==null?void 0:t.fullname}),R.jsxs("span",{children:["@",t==null?void 0:t.username]})]})]}),R.jsx("button",{onClick:c?E:m,disabled:d,className:"button fc-button",children:c?"Unfollow":"Follow"})]})]})}lre.propTypes={follower:Le.shape({_id:Le.string.isRequired,profileimage:Le.string.isRequired,fullname:Le.string.isRequired,username:Le.string.isRequired}).isRequired};const ure=()=>{const t=qd(),[e,n]=$.useState([]);return $.useEffect(()=>{X1e().then(({data:r})=>{n(r)})},[]),R.jsx("div",{className:"FollowersCard px-1",style:t.pathname.includes("/profile")?{width:"40%",paddingRight:"2rem"}:{},children:R.jsxs(dn.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5},children:[R.jsx("h3",{children:"People around you!"}),e==null?void 0:e.map(r=>R.jsx(lre,{follower:r},r==null?void 0:r._id))]})})},Uq="/assets/cover-79621e06.jpg",cLe="/assets/icon-flatPhLgOut-1332a496.svg",lLe="/assets/icon-flatEdit-d369a836.svg",uLe="/assets/icon-flatEditProfile-f171e1db.svg",dLe="/assets/icon-flatEditCoverImg-70ebe818.svg";function FP({postDtl:t,updateSavedPosts:e}){var Qt,kt,Lt,Ut,Dn;const{user:n}=Si(xt=>xt.authReducer.authData),r=bi(),c=Ia(),l=qd(),[d,f]=$.useState(!1),[m,E]=$.useState(!1),[y,w]=$.useState([]),[I,P]=$.useState(!1),[k,M]=$.useState(!1),[K,W]=$.useState((Qt=t==null?void 0:t.likes)==null?void 0:Qt.includes(n._id)),[V,G]=$.useState((kt=n==null?void 0:n.saved)==null?void 0:kt.includes(t._id)),[Q,Z]=$.useState(t==null?void 0:t.likes.length),[Y,oe]=$.useState(""),[ce,Se]=$.useState(!1),[xe,je]=$.useState(!1),[Ge,ze]=$.useState(!1),[Ke,He]=$.useState(!1),[be,Oe]=$.useState({description:t.description}),[_e,We]=$.useState(""),[Ie,De]=$.useState((Lt=n==null?void 0:n.following)==null?void 0:Lt.includes(t.user._id)),Ue=()=>E(!1),rt=()=>je(!1),gt=()=>f(!1),ft=()=>{f(!0),rt()},Ft=()=>{He(!1),Oe({description:t==null?void 0:t.description})},qt=()=>{ze(!1)},ti=async()=>{if(!Y.trim())return fe.error(R.jsx("b",{children:"Comment cannot be empty!"}));const xt={text:Y,user:n._id,postId:t==null?void 0:t._id,postUserId:t==null?void 0:t.user._id};try{const Mt=fe.loading("Commenting...");(await r(iie(xt))).success?(fe.dismiss(Mt),fe.success(R.jsx("b",{children:"Comment added...!"})),oe("")):(fe.dismiss(Mt),fe.error(R.jsx("b",{children:"Failed to add comment...!"})))}catch(Mt){console.log(Mt)}},Vt=()=>{var xt,Mt;if(!K&&n._id!==((xt=t==null?void 0:t.user)==null?void 0:xt._id)){const Nt={senderId:n._id,receiverId:(Mt=t==null?void 0:t.user)==null?void 0:Mt._id,text:"Liked your Post",url:t==null?void 0:t.image};ng(Nt).then(({data:ni})=>{var vs;_a.emit("get-notification",{to:Nt.receiverId||((vs=ni==null?void 0:ni.user)==null?void 0:vs._id),from:{id:Nt.senderId||n._id,profileimage:n.profileimage,username:n.username},text:Nt.text,url:ni==null?void 0:ni.image})})}W(Nt=>!Nt),Z(K?Nt=>Nt-1:Nt=>Nt+1),r(Zne(t._id,n._id))},xn=async()=>{try{M(!0);const xt=await Jne(t==null?void 0:t._id);xt.data&&(w(xt.data.likes),M(!1),P(!0))}catch(xt){M(!1),console.log(xt),fe.error(R.jsx("b",{children:"Couldn't get the details"}))}},En=async()=>{const xt=fe.loading("Deleting...");try{const Mt=await r(y5(t._id,n._id,"user"));fe.dismiss(xt),Mt.success?fe.success(R.jsx("b",{children:"Post Deleted...!"})):fe.error(R.jsx("b",{children:"Failed to delete...!"}))}catch(Mt){fe.error(R.jsx("b",{children:"Something went wrong!"})),console.error("Error:",Mt)}},Di=async()=>{const{description:xt}=be;if(!xt.trim()){fe.error(R.jsx("b",{children:"Description cannot be empty!"}));return}const Mt=fe.loading("Updating...");try{const Nt=await r(eie(t._id,n._id,be));fe.dismiss(Mt),Nt.success?(He(!1),fe.success(R.jsx("b",{children:"Post Updated...!"}))):fe.error(R.jsx("b",{children:"Post Update Failed...!"}))}catch(Nt){fe.error(R.jsx("b",{children:"Something went wrong while updating!"})),console.error("Error:",Nt)}},ui=async()=>{if(!_e.trim())return fe.error(R.jsx("b",{children:"cannot send empty report!"}));const xt=fe.loading("Reporting...");try{const Mt=await r(T5(n._id,"post",t._id,_e));fe.dismiss(xt),Mt.success?(ze(!1),fe.success(R.jsx("b",{children:"Post Reported...!"}))):fe.error(R.jsx("b",{children:"Post Report Failed...!"}))}catch(Mt){fe.error(R.jsx("b",{children:"Something went wrong while updating!"})),console.error("Error:",Mt)}},rn=100,Rn=xt=>{const Mt=xt.target.value;Mt.length<=rn&&We(Mt)},us=100,di=xt=>{const Mt=xt.target.value;Mt.length<=us&&Oe({...be,[xt.target.name]:Mt})},Go=async()=>{const xt=fe.loading("Saving...");rt();try{const Mt=await r(tie(n._id,t._id,V));fe.dismiss(xt),Mt.success?(G(!V),fe.success(R.jsx("b",{children:Mt.message})),Mt.message=="Post unsaved successfully."&&e(t._id)):fe.error(R.jsx("b",{children:Mt.error}))}catch(Mt){fe.error(R.jsx("b",{children:"Something went wrong while saving!"})),console.error("Error:",Mt)}},qr=async()=>{var Mt;const xt=fe.loading("Following...");rt();try{const Nt=await r(Wb(t.user._id,n._id));if(console.log(Nt),Nt.success){const ni={senderId:n._id,receiverId:(Mt=t==null?void 0:t.user)==null?void 0:Mt._id,text:"Started following you"};ng(ni).then(({data:vs})=>{var Ci;_a.emit("get-notification",{to:ni.receiverId||((Ci=vs==null?void 0:vs.user)==null?void 0:Ci._id),from:{id:ni.senderId||n._id,profileimage:n.profileimage,username:n.username},text:ni.text})}),fe.success(R.jsx("b",{children:Nt.message})),De(!Ie)}else fe.error(R.jsx("b",{children:Nt.error}));fe.dismiss(xt)}catch(Nt){fe.dismiss(xt),fe.error(R.jsx("b",{children:"Cannot follow at the moment!"})),console.error("Error:",Nt)}},Zi=async()=>{const xt=fe.loading("Unfollowing...");gt(),rt();try{const Mt=await r(Hb(t.user._id,n._id));Mt.success?(fe.success(R.jsx("b",{children:Mt.message})),De(!Ie)):fe.error(R.jsx("b",{children:Mt.error})),fe.dismiss(xt)}catch(Mt){fe.dismiss(xt),fe.error(R.jsx("b",{children:"Can't Unfollow at the moment!"})),console.error("Error:",Mt)}},wi=()=>{Se(!0)},Ne=()=>je(!0),dt=()=>{ze(!0),je(!1)},Et=()=>{He(!0),je(!1)},st=()=>{Se(!1)},Ot=()=>{E(!0)};return R.jsxs(R.Fragment,{children:[R.jsx(ku,{position:"top-center",reverseOrder:!1}),R.jsx("img",{onClick:()=>Ot(),src:t.image,alt:"",className:l.pathname.includes("/profile")?"image-height":""},t._id),R.jsx(ln,{show:d,onHide:gt,children:R.jsxs(ln.Body,{style:{width:"10rem"},children:[R.jsx("img",{src:t.user.profileimage||Gr,alt:""}),R.jsx("span",{className:"lg-text pb-2",children:Ie?"Unfollow this user?":"Follow this User?"}),R.jsxs("div",{className:"cover",children:[R.jsx("button",{className:"button modalButton",onClick:gt,children:"No!"}),R.jsx("button",{className:"button modalButton",onClick:Zi,children:"Yes!"})]})]})}),R.jsx(ln,{show:xe,onHide:rt,className:"modal-postion",children:R.jsxs(ln.Body,{children:[((Ut=t.user)==null?void 0:Ut._id)!==n._id&&R.jsxs(R.Fragment,{children:[R.jsx("span",{onClick:Ie?ft:qr,className:"linear-gradient-text",children:Ie?"Unfollow":"Follow"}),R.jsx("hr",{}),R.jsx("span",{onClick:dt,className:"linear-gradient-text",children:"Report Post"}),R.jsx("hr",{})]}),R.jsx("span",{className:"linear-gradient-text",onClick:Go,children:V?"Unsave":"Save"}),((Dn=t.user)==null?void 0:Dn._id)===n._id&&R.jsxs(R.Fragment,{children:[R.jsx("hr",{}),R.jsx("button",{onClick:Et,className:"linear-gradient-text",children:"Edit"}),R.jsx("hr",{}),R.jsx("span",{onClick:En,className:"linear-gradient-text",children:"Delete"})]})]})}),R.jsx(ln,{show:Ke,onHide:Ft,className:"modal-postion",children:R.jsxs(ln.Body,{style:{width:"17rem"},children:[R.jsx("label",{className:"pt-2 pb-3 linear-gradient-text",children:"Edit Description?"}),R.jsxs("div",{className:"Search",children:[R.jsx("input",{type:"text",name:"description",value:be.description,onChange:di}),R.jsx("span",{onClick:Di,className:"material-symbols-outlined",children:"update"})]}),R.jsx("div",{style:{display:"flex"},children:R.jsxs("span",{className:"lg-text",children:[us-be.description.length," / ",us]})})]})}),R.jsx(ln,{show:Ge,onHide:qt,className:"modal-postion",children:R.jsxs(ln.Body,{style:{width:"17rem"},children:[R.jsx("label",{className:"pt-2 pb-3 linear-gradient-text",children:"Provide Reason!"}),R.jsxs("div",{className:"Search",children:[R.jsx("textarea",{type:"text",name:"report",onChange:Rn}),R.jsx("span",{onClick:ui,className:"material-symbols-outlined",children:"report"})]}),R.jsx("div",{style:{display:"flex"},children:R.jsxs("span",{className:"lg-text",children:[rn-_e.length," / ",rn]})})]})}),R.jsx(ln,{show:m,onHide:Ue,style:{marginTop:"3%"},children:R.jsx(ln.Body,{className:"modal-bodywidth",children:R.jsx("div",{className:"Posts",children:R.jsxs("div",{className:"Post lg-bg",style:{textAlign:"left"},children:[R.jsxs("div",{className:"header",children:[R.jsx("div",{className:"contents",children:R.jsxs("button",{onClick:()=>c(`/profile/${t==null?void 0:t.user._id}`),children:[R.jsx("img",{className:"image",src:(t==null?void 0:t.user.profileimage)||Gr,alt:"profile"}),R.jsx("span",{children:t.user.username})]})}),R.jsx("button",{onClick:Ne,children:R.jsx("img",{className:"dot-image",src:Tie,alt:""})})]}),R.jsx("img",{src:t==null?void 0:t.image,alt:""}),R.jsxs("div",{className:"postReact",children:[R.jsx("img",{src:K?LP:I5,alt:"",style:{cursor:"pointer"},onClick:Vt}),R.jsx("img",{style:{width:"1.8rem"},src:Sie,alt:"comment",onClick:wi})]}),R.jsxs("span",{onClick:xn,style:{color:"var(--gray)",fontSize:"12px"},children:[Q," likes",R.jsx(tv,{loading:k,color:"orange",speedMultiplier:1})]}),R.jsxs("div",{className:"detail",children:[R.jsx("span",{children:R.jsx("b",{children:(t==null?void 0:t.user.username)||"noNameAvailable"})}),R.jsxs("span",{children:[" ",t==null?void 0:t.description]})]}),R.jsxs("div",{className:"comment",children:[R.jsx("input",{type:"text",placeholder:"Add a comment...",value:Y,onChange:xt=>oe(xt.target.value)}),R.jsx("img",{src:yie,onClick:ti})]}),(t==null?void 0:t.comments.length)!==0&&R.jsx("span",{onClick:wi,className:"lg-text viewCmt",children:"View all comments"})]})})})}),R.jsx(UP,{showCmt:ce,handleCmtClose:st,data:t}),y.length!==0&&R.jsx(ob,{currUser:n,usersToShow:I,userDetails:y,setUsersToShow:P})]})}FP.propTypes={postDtl:Le.shape({_id:Le.string.isRequired,image:Le.string.isRequired,description:Le.string.isRequired,comments:Le.array.isRequired,likes:Le.array.isRequired,user:Le.shape({username:Le.string.isRequired,profileimage:Le.string.isRequired,_id:Le.string.isRequired})}).isRequired,updateSavedPosts:Le.func};function dre({editOpened:t,setEditOpened:e,data:n,updateCurrUser:r}){const c=bi(),{user:l}=Si(I=>I.authReducer.authData),[d,f]=$.useState({username:n.username,fullname:n.fullname,bio:n.bio}),m=()=>{e(!1),f({username:n.username,fullname:n.fullname,bio:n.bio})},E=50,y=I=>{const{name:P,value:k}=I.target;if(P==="bio"&&k.length>E)return fe.error(R.jsx("b",{children:"Maximum characters reached!"}));f(M=>({...M,[P]:k}))},w=async()=>{e(!1);const I=fe.loading("Updating...");try{const P=await c(XNe(l._id,d));fe.dismiss(I),P.success?(r(d),fe.success(R.jsx("b",{children:P.message}))):fe.error(R.jsx("b",{children:P.error}))}catch(P){console.log(P,"///")}};return R.jsxs(R.Fragment,{children:[R.jsx(ku,{position:"top-center",reverseOrder:!1}),R.jsx(ln,{show:t,onHide:m,children:R.jsxs(ln.Body,{style:{width:"17rem"},children:[R.jsx("label",{className:"pt-2 pb-3 linear-gradient-text",children:"Edit Profile?"}),R.jsx("div",{style:{display:"flex"},children:R.jsx("span",{className:"lg-text",children:"User Name:"})}),R.jsx("div",{className:"Search my-2",children:R.jsx("input",{type:"text",name:"username",value:d.username,onChange:y})}),R.jsx("div",{style:{display:"flex"},children:R.jsx("span",{className:"lg-text",children:"Full Name:"})}),R.jsx("div",{className:"Search my-2",children:R.jsx("input",{type:"text",name:"fullname",value:d.fullname,onChange:y})}),R.jsx("div",{style:{display:"flex"},children:R.jsx("span",{className:"lg-text",children:"Bio:"})}),R.jsx("div",{className:"Search my-2",children:R.jsx("textarea",{style:{width:"100%"},type:"text",name:"bio",value:d.bio,onChange:y})}),R.jsx("div",{style:{display:"flex"},children:R.jsxs("span",{className:"lg-text",children:[E-d.bio.length," / ",E]})}),R.jsxs("div",{className:"d-flex flex-row-reverse",children:[R.jsx("button",{className:"button modalButton",onClick:w,children:"Yes!"}),R.jsx("button",{className:"button modalButton  mx-3",onClick:m,children:"No!"})]})]})})]})}dre.propTypes={editOpened:Le.bool.isRequired,setEditOpened:Le.func.isRequired,data:Le.shape({username:Le.string,fullname:Le.string,bio:Le.string}),updateCurrUser:Le.func.isRequired};const H5=({location:t})=>{var xt,Mt,Nt,ni,vs,Ci,bg,sp,op;const e=bi(),n=Ia(),{user:r}=Si(sn=>sn.authReducer.authData),{id:c}=q0e(),[l,d]=$.useState([]),[f,m]=$.useState(!1),[E,y]=$.useState(null),[w,I]=$.useState(null),[P,k]=$.useState(!1),[M,K]=$.useState([]),[W,V]=$.useState(!1),[G,Q]=$.useState([]),[Z,Y]=$.useState(!0),[oe,ce]=$.useState(!1),[Se,xe]=$.useState(!1),[je,Ge]=$.useState(!1),[ze,Ke]=$.useState(!1),[He,be]=$.useState(!1),[Oe,_e]=$.useState(r==null?void 0:r.following.includes(c)),[We,Ie]=$.useState(!1),[De,Ue]=$.useState(!1),[rt,gt]=$.useState(null),[ft,Ft]=$.useState((xt=l==null?void 0:l.user)==null?void 0:xt.profileimage),[qt,ti]=$.useState((Mt=l==null?void 0:l.user)==null?void 0:Mt.coverimage),[Vt,xn]=$.useState(null),En=$.useRef(null),Di=$.useRef(),ui=sn=>{t==="profile"&&(En.current.value=null,En.current.click(),Ue(sn==="profile"))},rn=sn=>{if(sn.target.files&&sn.target.files[0]){let hn=sn.target.files[0];console.log(hn,"image");const wr=hn.name.split(".").pop().toLowerCase();if(["jpg","jpeg","png"].includes(wr))gt({name:hn.name,url:URL.createObjectURL(hn),file:hn}),wi();else return gt(null),fe.error(R.jsx("b",{children:"Invalid file type. Please select a JPG, JPEG, or PNG image."}))}},Rn=sn=>["image/jpeg","image/png","image/jpg"].includes(sn.file.type)?sn.file.size>4194304?(fe.error(R.jsx("b",{children:"The image size cannot exceed 4MB"})),!1):!0:(fe.error(R.jsx("b",{children:"Only JPEG, JPG and PNG images are allowed"})),!1),us=()=>{gt(null),xn(null)},di=async sn=>{var hn,wr;if(sn.preventDefault(),!rt)return fe.error(R.jsx("b",{children:"Please Provide an Image...!"}));if(typeof((hn=Di.current)==null?void 0:hn.cropper)<"u"){const Yr=(wr=Di.current)==null?void 0:wr.cropper.getCroppedCanvas();De?Ft(Yr.toDataURL()):ti(Yr.toDataURL()),Yr.toBlob(function(Ko){const Xs=new File([Ko],rt.name,{type:Ko.type});xn({file:Xs})},rt.type)}};$.useEffect(()=>{if(Vt&&Rn(Vt)){const sn=new FormData;sn.append("file",Vt.file);try{(async()=>{const wr=fe.loading(R.jsx("b",{children:"uploading...!"}));Ge(!0);const Yr=await e(zie(sn));if(Yr&&Yr.url){const Ko=Yr.url;try{const Xs=await e(De?JNe(r._id,Ko):QNe(r._id,Ko));fe.dismiss(wr),Xs.success?(Zi(),Ge(!1),us(),fe.success(R.jsxs("b",{children:[De?"Profile":"Cover"," Pic Uploaded...!"]})),l.posts.map(ap=>{De?ap.user.profileimage=Ko:ap.user.coverimage=Ko})):(Zi(),Ge(!1),fe.error(R.jsx("b",{children:"Failed to upload pic"})))}catch(Xs){Zi(),fe.dismiss(wr),Ge(!1),fe.error(R.jsx("b",{children:"Failed to Upload"})),console.log(Xs)}}else Zi(),fe.dismiss(wr),Ge(!1),console.log("error aaahne"),fe.error(R.jsx("b",{children:"Failed to Upload Image"}))})()}catch(hn){Zi(),Ge(!1),fe.error(R.jsx("b",{children:"Failed to Upload Image...!"})),console.log(hn)}}},[Vt]);const Go=()=>{m(!f)},qr=()=>Ke(!1),Zi=()=>be(!1),wi=()=>be(!0),Ne=()=>Ke(!0),dt=()=>{Ie(!0)},Et=async()=>{var sn;try{ce(!0);const hn=await iNe((sn=l==null?void 0:l.user)==null?void 0:sn._id);hn.data&&(K(hn.data.followers),ce(!1),k(!0))}catch(hn){ce(!1),console.log(hn),fe.error(R.jsx("b",{children:"Couldn't get the details"}))}},st=async()=>{var sn;try{xe(!0);const hn=await rNe((sn=l==null?void 0:l.user)==null?void 0:sn._id);hn.data&&(Q(hn.data.following),xe(!1),V(!0))}catch(hn){xe(!1),console.log(hn),fe.error(R.jsx("b",{children:"Couldn't get the details"}))}},Ot={display:"block",margin:"auto",marginTop:"20%"},Qt=`truncate-text ${f?"show-full-text":""}`;$.useEffect(()=>{(c||r._id)&&yNe(c||r._id).then(sn=>{Y(!1),d(sn.data),y(sn.data.user.followers.length),I(sn.data.user.following.length)}).catch(()=>{Y(!1)})},[c,r._id]);const kt=async()=>{const sn=fe.loading("Following...");try{const hn=await e(Wb(c,r._id));if(hn.success){const wr={senderId:r._id,receiverId:c,text:"Started following you"};ng(wr).then(({data:Yr})=>{var Ko;_a.emit("get-notification",{to:wr.receiverId||((Ko=Yr==null?void 0:Yr.user)==null?void 0:Ko._id),from:{id:wr.senderId||r._id,profileimage:r.profileimage,username:r.username},text:wr.text})}),fe.success(R.jsx("b",{children:hn.message})),_e(!Oe),I(Yr=>Yr+1),y(Yr=>Yr+1)}else fe.error(R.jsx("b",{children:hn.error}));fe.dismiss(sn)}catch(hn){fe.dismiss(sn),fe.error(R.jsx("b",{children:"Cannot follow at the moment!"})),console.error("Error:",hn)}},Lt=async()=>{const sn=fe.loading("Unfollowing...");qr();try{const hn=await e(Hb(c,r._id));hn.success?(e(Qne(r._id)),fe.success(R.jsx("b",{children:hn.message})),_e(!Oe),y(wr=>wr-1),I(wr=>wr-1)):fe.error(R.jsx("b",{children:hn.error})),fe.dismiss(sn)}catch(hn){fe.dismiss(sn),fe.error(R.jsx("b",{children:"Can't Unfollow at the moment!"})),console.error("Error:",hn)}},Ut=sn=>{console.log(sn),d(hn=>({...hn,user:{...hn.user,...sn}}))},Dn=()=>{var sn;e({type:"CURRENT_CHAT_USER",data:(sn=l==null?void 0:l.user)==null?void 0:sn._id}),n("/chat")};return R.jsxs("div",{className:"ProfileCard",style:t==="profile"?{overflowY:"auto",boxShadow:" rgb(208,86,155,0.3) 0px 0px 100px"}:{},children:[R.jsx(dn.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5},children:R.jsxs("div",{className:"ProfileImages",children:[R.jsx("img",{className:t==="profile"?"profileCover":"",src:Z?Uq:qt||((Nt=l==null?void 0:l.user)==null?void 0:Nt.coverimage)||Uq,alt:"cover image"}),t==="profile"&&((ni=l==null?void 0:l.user)==null?void 0:ni._id)===r._id&&R.jsxs("span",{children:[R.jsx("img",{onClick:()=>ui("cover"),src:dLe,className:"editCover-icon",alt:"coverEdit"}),R.jsx("img",{className:"logoutBtn",onClick:()=>e(Bi()),src:cLe,alt:"logout"})]}),R.jsx("img",{className:t==="profile"?"profileImg":"",src:Z?Gr:ft||((vs=l==null?void 0:l.user)==null?void 0:vs.profileimage)||Gr,alt:"profile image"}),t==="profile"&&((Ci=l==null?void 0:l.user)==null?void 0:Ci._id)===r._id&&R.jsx("img",{onClick:()=>ui("profile"),className:"editProfile-icon",src:uLe,alt:"porfileEdit"}),R.jsx("input",{type:"file",accept:"image/*",style:{display:"none"},ref:En,onChange:rn})]})}),R.jsx(ln,{show:He,onHide:Zi,backdrop:"static",keyboard:!1,children:R.jsxs(ln.Body,{children:[R.jsx(cre,{className:"editPrImg",ref:Di,src:rt==null?void 0:rt.url,aspectRatio:De?1:2,background:!1,responsive:!0}),R.jsxs("div",{className:"d-flex flex-row-reverse py-3 px-2 gap-2",children:[R.jsx("button",{className:"button modaButton px-3 py-1",onClick:di,disabled:je,children:"Crop and Update"}),R.jsx("button",{onClick:()=>{gt(null),Ft(null),xn(null),Zi()},className:"button modaButton px-3 py-1",disabled:je,children:"Cancel"})]})]})}),R.jsx(ln,{show:ze,onHide:qr,children:R.jsxs(ln.Body,{style:{width:"10rem"},children:[R.jsx("img",{src:r.profileimage||Gr,alt:""}),R.jsx("span",{className:"lg-text pb-2",children:Oe?"Unfollow this user?":"Follow this User?"}),R.jsxs("div",{className:"cover",children:[R.jsx("button",{className:"button modalButton",onClick:qr,children:"No!"}),R.jsx("button",{className:"button modalButton",onClick:Lt,children:"Yes!"})]})]})}),(l==null?void 0:l.user)&&R.jsx(dre,{editOpened:We,setEditOpened:Ie,data:l==null?void 0:l.user,updateCurrUser:Ut}),Z?R.jsx(tv,{loading:Z,cssOverride:Ot,color:"orange",speedMultiplier:1}):R.jsxs(R.Fragment,{children:[R.jsx(dn.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5},children:R.jsxs("div",{className:"ProfileName",children:[R.jsxs("span",{children:[R.jsx("span",{style:t==="profile"?{fontSize:"20px",padding:"0 14px"}:{},children:(bg=l.user)==null?void 0:bg.username}),r._id==l.user._id&&t==="profile"&&R.jsx("img",{onClick:dt,style:{width:"2em",position:"absolute",cursor:"pointer"},src:lLe,alt:"edit"})]}),r._id!==l.user._id&&R.jsxs("span",{className:"d-flex gap-3",children:[Oe?R.jsx("button",{className:"button px-2 py-1",onClick:Ne,children:"Unfollow"}):R.jsx("button",{className:"button px-2 py-1",onClick:kt,children:"Follow"}),R.jsx("button",{className:"button px-2 py-1",onClick:Dn,children:"Message"})]}),R.jsx("span",{children:(sp=l.user)==null?void 0:sp.fullname}),R.jsx("span",{className:Qt,onClick:Go,children:((op=l.user)==null?void 0:op.bio)||"Write about yourself😊"})]})}),R.jsxs("div",{className:"followStatus",children:[R.jsx("hr",{}),R.jsxs("div",{children:[R.jsxs("div",{className:"follow",onClick:Et,children:[R.jsx("span",{children:E}),R.jsx("span",{children:"Followers"}),R.jsx(tv,{loading:oe,color:"orange",speedMultiplier:1})]}),R.jsx("div",{className:"vl"}),R.jsxs("div",{className:"follow",onClick:st,children:[R.jsx("span",{children:w}),R.jsx("span",{children:"Followings"}),R.jsx(tv,{loading:Se,color:"orange",speedMultiplier:1})]}),P&&R.jsx(ob,{currUser:l==null?void 0:l.user,usersToShow:P,userDetails:M,setUsersToShow:k}),W&&R.jsx(ob,{currUser:r,usersToShow:W,userDetails:G,setUsersToShow:V}),l.user&&R.jsxs(R.Fragment,{children:[R.jsx("div",{className:"vl"}),R.jsxs("div",{className:"follow",children:[R.jsx("span",{children:l.posts.length}),R.jsx("span",{children:"Posts"})]})]})]}),R.jsx("hr",{}),t==="home"&&R.jsx("span",{className:"profileView",children:R.jsx(df,{to:`/profile/${r._id}`,style:{textDecoration:"none",color:"inherit"},children:"My Profile"})}),R.jsx(dn.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5},children:t==="profile"&&R.jsx("div",{className:"Post mb-3",children:R.jsxs("div",{className:"explore",children:[l==null?void 0:l.posts.map(sn=>R.jsx(FP,{postDtl:sn},sn._id)),(l==null?void 0:l.posts.length)<1&&R.jsxs("b",{className:"d-flex flex-row",children:["No Posts Yet!",R.jsx("span",{className:"material-symbols-outlined",children:"photo_camera"})]})]})})})]})]})]})};H5.propTypes={location:Le.string.isRequired};const hre=({location:t})=>($.useEffect(()=>{const e=document.querySelector(".ProfileSide");e.classList.add("initial"),setTimeout(()=>{e.classList.remove("initial")},100)},[]),R.jsxs("div",{className:"ProfileSide",style:{animationDelay:"0.5s"},children:[R.jsx(Xne,{}),R.jsx(H5,{location:t}),R.jsx(ure,{})]}));hre.propTypes={location:Le.string.isRequired};const fre="/assets/logo-side-201e89c7.png",hLe="/assets/icon-flatHome-2b7700dc.svg",fLe="/assets/icon-flatChat-5455030a.svg",pLe="/assets/icon-flatSaved-4886b249.svg",mLe="/assets/icon-flatProfile-6ba9075b.svg",gLe="/assets/icon-flatLogout-42c258ff.svg",_Le="/assets/icon-flatExplore-7527a63a.svg";function ELe(){const t=bi(),{user:e}=Si(c=>c.authReducer.authData),n=()=>document.body.classList.toggle("open");$.useEffect(()=>{const c=document.querySelector(".sidebar");c.classList.add("initial"),setTimeout(()=>{c.classList.remove("initial")},100)},[]);const r=()=>{t(Bi())};return R.jsx(dn.aside,{className:"sidebar",children:R.jsxs("div",{className:"sidebar-inner",children:[R.jsxs("header",{className:"sidebar-header",children:[R.jsx("button",{type:"button",className:"sidebar-burger",onClick:n}),R.jsx("img",{src:fre,className:"sidebar-logo"})]}),R.jsxs("nav",{className:"sidebar-nav",children:[R.jsxs("button",{type:"button",children:[R.jsx(df,{className:"material-symbols-outlined",to:"../home",children:R.jsx("img",{style:{width:"2rem"},src:hLe,alt:"home"})}),R.jsx("span",{children:"Home"})]}),R.jsxs("button",{type:"button",children:[R.jsx(df,{className:"material-symbols-outlined",to:"/chat",children:R.jsx("img",{style:{width:"2rem"},src:fLe,alt:"chat"})}),R.jsx("span",{style:{animationDelay:"0.1s"},children:"Messages"})]}),R.jsxs("button",{type:"button",children:[R.jsx(df,{className:"material-symbols-outlined",to:"/explore",children:R.jsx("img",{style:{width:"2rem"},src:_Le,alt:"explore"})}),R.jsx("span",{style:{animationDelay:"0.1s"},children:"Explore"})]}),R.jsxs("button",{type:"button",children:[R.jsx(df,{className:"material-symbols-outlined",to:"/saved",children:R.jsx("img",{style:{width:"2rem"},src:pLe,alt:"saved"})}),R.jsx("span",{style:{animationDelay:"0.3s"},children:"Saved"})]}),R.jsxs("button",{type:"button",children:[R.jsx(df,{className:"material-symbols-outlined",to:`/profile/${e._id}`,children:R.jsx("img",{style:{width:"2rem"},src:mLe,alt:"profile"})}),R.jsx("span",{style:{animationDelay:"0.5s"},children:"Profile"})]})]}),R.jsx("footer",{className:"sidebar-footer",children:R.jsxs("button",{type:"button",onClick:r,children:[R.jsx("i",{className:"material-symbols-outlined",children:R.jsx("img",{style:{width:"1.8rem"},src:gLe,alt:"logout"})}),R.jsx("span",{children:"Logout"})]})})]})})}function vLe(){const t=Ia(),e=qd(),{user:n}=Si(r=>r.authReducer.authData);return $.useEffect(()=>{const r=document.querySelector(".bottombar");r.classList.add("initial"),setTimeout(()=>{r.classList.remove("initial")},100)},[]),R.jsx(dn.aside,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{duration:.5},className:"bottombar",children:R.jsxs("div",{className:"tabs",children:[R.jsx("input",{id:"tab-1",type:"radio",name:"group",defaultChecked:e.pathname.includes("/home")}),R.jsx("input",{id:"tab-2",type:"radio",name:"group",defaultChecked:e.pathname.includes("/chat")}),R.jsx("input",{id:"tab-3",type:"radio",name:"group",defaultChecked:e.pathname.includes("/explore")}),R.jsx("input",{id:"tab-4",type:"radio",name:"group",defaultChecked:e.pathname.includes("/saved")}),R.jsx("input",{id:"tab-5",type:"radio",name:"group",defaultChecked:e.pathname.includes("/profile")}),R.jsxs("div",{className:"buttons",children:[R.jsx(dn.label,{whileHover:{scale:1.3},transition:{duration:.3},onClick:()=>t("/home"),className:"material-symbols-outlined",htmlFor:"tab-1",children:"Home"}),R.jsx(dn.label,{whileHover:{scale:1.3},transition:{duration:.3},onClick:()=>t("/chat"),className:"material-symbols-outlined",htmlFor:"tab-2",children:"Chat"}),R.jsx(dn.label,{whileHover:{scale:1.3},transition:{duration:.3},onClick:()=>t("/explore"),className:"material-symbols-outlined",htmlFor:"tab-3",children:"Explore"}),R.jsx(dn.label,{whileHover:{scale:1.3},transition:{duration:.3},onClick:()=>t("/saved"),className:"material-symbols-outlined",htmlFor:"tab-4",children:"Bookmark"}),R.jsx(dn.label,{whileHover:{scale:1.3},transition:{duration:.3},onClick:()=>t(`/profile/${n._id}`),className:"material-symbols-outlined",htmlFor:"tab-5",children:"Person"}),R.jsx("div",{className:"underline"})]})]})})}function yLe(){const{allPosts:t,loading:e,hasMorePosts:n}=Si(k=>k.postReducer),{user:r}=Si(k=>k.authReducer.authData),c=bi(),l=localStorage.getItem("expPage"),d=l?parseInt(l,10):1,[f,m]=$.useState(d),[E,y]=$.useState(!1),I=k5(async()=>{if(!E){y(!0);try{window.innerHeight+document.documentElement.scrollTop+1>=document.documentElement.scrollHeight&&n&&m(k=>k+1)}catch(k){console.log(k)}}},1e3),P={display:"block",margin:"auto"};return $.useEffect(()=>{localStorage.getItem("expPage")!==String(f)&&(c(ONe(r._id,f)),localStorage.setItem("expPage",f))},[f,c,r._id]),$.useEffect(()=>(window.addEventListener("scroll",I),()=>{window.removeEventListener("scroll",I),y(!1)}),[E]),R.jsx(R.Fragment,{children:R.jsxs("div",{className:"Post",children:[R.jsx("b",{style:{fontSize:"large"},className:"lg-text",children:"Explore Posts"}),R.jsx("div",{className:"explore",children:t.map(k=>R.jsx(FP,{postDtl:k},k._id))}),R.jsx(S5,{loading:e,cssOverride:P,color:"orange"})]})})}function SLe(){const{user:t}=Si(m=>m.authReducer.authData),[e,n]=$.useState([]),[r,c]=$.useState(!0),l=bi(),d=m=>{const E=e.filter(y=>y._id!==m);n(E)};$.useEffect(()=>{c(!0),vNe(t._id).then(m=>{c(!1),n(m.data)}).catch(m=>{console.log(m),m.response.data.error==="Token has expired"&&l(Bi()),c(!1),fe.error(R.jsx("b",{children:"Error loading saved Posts!"}))})},[]);const f={display:"block",margin:"20% auto"};return R.jsxs(R.Fragment,{children:[R.jsx($b,{loading:r,cssOverride:f,color:"orange",speedMultiplier:1}),!r&&R.jsx(R.Fragment,{children:R.jsxs("div",{className:"Post",children:[R.jsx("b",{style:{fontSize:"large"},className:"lg-text",children:"Saved Posts"}),R.jsxs("div",{className:"explore",children:[e==null?void 0:e.map(m=>R.jsx(FP,{postDtl:m,updateSavedPosts:d},m._id)),(e==null?void 0:e.length)<1&&!r&&R.jsxs("b",{className:"d-flex flex-row",children:["You haven't saved any posts!"," ",R.jsx("span",{className:"material-symbols-outlined",children:"photo_camera"})]})]})]})})]})}const pre=ip(),TLe=t=>pre.post("/chat/",t),bLe=t=>pre.get(`/chat/${t}`);var mre={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(Gt,function(){function n(o,i){return i.forEach(function(s){s&&typeof s!="string"&&!Array.isArray(s)&&Object.keys(s).forEach(function(a){if(a!=="default"&&!(a in o)){var u=Object.getOwnPropertyDescriptor(s,a);Object.defineProperty(o,a,u.get?u:{enumerable:!0,get:function(){return s[a]}})}})}),Object.freeze(o)}let r=!0,c=!0;function l(o,i,s){const a=o.match(i);return a&&a.length>=s&&parseInt(a[s],10)}function d(o,i,s){if(!o.RTCPeerConnection)return;const a=o.RTCPeerConnection.prototype,u=a.addEventListener;a.addEventListener=function(p,_){if(p!==i)return u.apply(this,arguments);const v=T=>{const b=s(T);b&&(_.handleEvent?_.handleEvent(b):_(b))};return this._eventMap=this._eventMap||{},this._eventMap[i]||(this._eventMap[i]=new Map),this._eventMap[i].set(_,v),u.apply(this,[p,v])};const h=a.removeEventListener;a.removeEventListener=function(p,_){if(p!==i||!this._eventMap||!this._eventMap[i])return h.apply(this,arguments);if(!this._eventMap[i].has(_))return h.apply(this,arguments);const v=this._eventMap[i].get(_);return this._eventMap[i].delete(_),this._eventMap[i].size===0&&delete this._eventMap[i],Object.keys(this._eventMap).length===0&&delete this._eventMap,h.apply(this,[p,v])},Object.defineProperty(a,"on"+i,{get(){return this["_on"+i]},set(p){this["_on"+i]&&(this.removeEventListener(i,this["_on"+i]),delete this["_on"+i]),p&&this.addEventListener(i,this["_on"+i]=p)},enumerable:!0,configurable:!0})}function f(o){return typeof o!="boolean"?new Error("Argument type: "+typeof o+". Please use a boolean."):(r=o,o?"adapter.js logging disabled":"adapter.js logging enabled")}function m(o){return typeof o!="boolean"?new Error("Argument type: "+typeof o+". Please use a boolean."):(c=!o,"adapter.js deprecation warnings "+(o?"disabled":"enabled"))}function E(){if(typeof window=="object"){if(r)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function y(o,i){c&&console.warn(o+" is deprecated, please use "+i+" instead.")}function w(o){return Object.prototype.toString.call(o)==="[object Object]"}function I(o){return w(o)?Object.keys(o).reduce(function(i,s){const a=w(o[s]),u=a?I(o[s]):o[s],h=a&&!Object.keys(u).length;return u===void 0||h?i:Object.assign(i,{[s]:u})},{}):o}function P(o,i,s){i&&!s.has(i.id)&&(s.set(i.id,i),Object.keys(i).forEach(a=>{a.endsWith("Id")?P(o,o.get(i[a]),s):a.endsWith("Ids")&&i[a].forEach(u=>{P(o,o.get(u),s)})}))}function k(o,i,s){const a=s?"outbound-rtp":"inbound-rtp",u=new Map;if(i===null)return u;const h=[];return o.forEach(p=>{p.type==="track"&&p.trackIdentifier===i.id&&h.push(p)}),h.forEach(p=>{o.forEach(_=>{_.type===a&&_.trackId===p.id&&P(o,_,u)})}),u}const M=E;function K(o,i){const s=o&&o.navigator;if(!s.mediaDevices)return;const a=function(p){if(typeof p!="object"||p.mandatory||p.optional)return p;const _={};return Object.keys(p).forEach(v=>{if(v==="require"||v==="advanced"||v==="mediaSource")return;const T=typeof p[v]=="object"?p[v]:{ideal:p[v]};T.exact!==void 0&&typeof T.exact=="number"&&(T.min=T.max=T.exact);const b=function(C,N){return C?C+N.charAt(0).toUpperCase()+N.slice(1):N==="deviceId"?"sourceId":N};if(T.ideal!==void 0){_.optional=_.optional||[];let C={};typeof T.ideal=="number"?(C[b("min",v)]=T.ideal,_.optional.push(C),C={},C[b("max",v)]=T.ideal,_.optional.push(C)):(C[b("",v)]=T.ideal,_.optional.push(C))}T.exact!==void 0&&typeof T.exact!="number"?(_.mandatory=_.mandatory||{},_.mandatory[b("",v)]=T.exact):["min","max"].forEach(C=>{T[C]!==void 0&&(_.mandatory=_.mandatory||{},_.mandatory[b(C,v)]=T[C])})}),p.advanced&&(_.optional=(_.optional||[]).concat(p.advanced)),_},u=function(p,_){if(i.version>=61)return _(p);if((p=JSON.parse(JSON.stringify(p)))&&typeof p.audio=="object"){const v=function(T,b,C){b in T&&!(C in T)&&(T[C]=T[b],delete T[b])};v((p=JSON.parse(JSON.stringify(p))).audio,"autoGainControl","googAutoGainControl"),v(p.audio,"noiseSuppression","googNoiseSuppression"),p.audio=a(p.audio)}if(p&&typeof p.video=="object"){let v=p.video.facingMode;v=v&&(typeof v=="object"?v:{ideal:v});const T=i.version<66;if(v&&(v.exact==="user"||v.exact==="environment"||v.ideal==="user"||v.ideal==="environment")&&(!s.mediaDevices.getSupportedConstraints||!s.mediaDevices.getSupportedConstraints().facingMode||T)){let b;if(delete p.video.facingMode,v.exact==="environment"||v.ideal==="environment"?b=["back","rear"]:v.exact!=="user"&&v.ideal!=="user"||(b=["front"]),b)return s.mediaDevices.enumerateDevices().then(C=>{let N=(C=C.filter(x=>x.kind==="videoinput")).find(x=>b.some(B=>x.label.toLowerCase().includes(B)));return!N&&C.length&&b.includes("back")&&(N=C[C.length-1]),N&&(p.video.deviceId=v.exact?{exact:N.deviceId}:{ideal:N.deviceId}),p.video=a(p.video),M("chrome: "+JSON.stringify(p)),_(p)})}p.video=a(p.video)}return M("chrome: "+JSON.stringify(p)),_(p)},h=function(p){return i.version>=64?p:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[p.name]||p.name,message:p.message,constraint:p.constraint||p.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(s.getUserMedia=(function(p,_,v){u(p,T=>{s.webkitGetUserMedia(T,_,b=>{v&&v(h(b))})})}).bind(s),s.mediaDevices.getUserMedia){const p=s.mediaDevices.getUserMedia.bind(s.mediaDevices);s.mediaDevices.getUserMedia=function(_){return u(_,v=>p(v).then(T=>{if(v.audio&&!T.getAudioTracks().length||v.video&&!T.getVideoTracks().length)throw T.getTracks().forEach(b=>{b.stop()}),new DOMException("","NotFoundError");return T},T=>Promise.reject(h(T))))}}}function W(o){o.MediaStream=o.MediaStream||o.webkitMediaStream}function V(o){if(typeof o=="object"&&o.RTCPeerConnection&&!("ontrack"in o.RTCPeerConnection.prototype)){Object.defineProperty(o.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(s){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=s)},enumerable:!0,configurable:!0});const i=o.RTCPeerConnection.prototype.setRemoteDescription;o.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=s=>{s.stream.addEventListener("addtrack",a=>{let u;u=o.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(p=>p.track&&p.track.id===a.track.id):{track:a.track};const h=new Event("track");h.track=a.track,h.receiver=u,h.transceiver={receiver:u},h.streams=[s.stream],this.dispatchEvent(h)}),s.stream.getTracks().forEach(a=>{let u;u=o.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(p=>p.track&&p.track.id===a.id):{track:a};const h=new Event("track");h.track=a,h.receiver=u,h.transceiver={receiver:u},h.streams=[s.stream],this.dispatchEvent(h)})},this.addEventListener("addstream",this._ontrackpoly)),i.apply(this,arguments)}}else d(o,"track",i=>(i.transceiver||Object.defineProperty(i,"transceiver",{value:{receiver:i.receiver}}),i))}function G(o){if(typeof o=="object"&&o.RTCPeerConnection&&!("getSenders"in o.RTCPeerConnection.prototype)&&"createDTMFSender"in o.RTCPeerConnection.prototype){const i=function(u,h){return{track:h,get dtmf(){return this._dtmf===void 0&&(h.kind==="audio"?this._dtmf=u.createDTMFSender(h):this._dtmf=null),this._dtmf},_pc:u}};if(!o.RTCPeerConnection.prototype.getSenders){o.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const u=o.RTCPeerConnection.prototype.addTrack;o.RTCPeerConnection.prototype.addTrack=function(p,_){let v=u.apply(this,arguments);return v||(v=i(this,p),this._senders.push(v)),v};const h=o.RTCPeerConnection.prototype.removeTrack;o.RTCPeerConnection.prototype.removeTrack=function(p){h.apply(this,arguments);const _=this._senders.indexOf(p);_!==-1&&this._senders.splice(_,1)}}const s=o.RTCPeerConnection.prototype.addStream;o.RTCPeerConnection.prototype.addStream=function(u){this._senders=this._senders||[],s.apply(this,[u]),u.getTracks().forEach(h=>{this._senders.push(i(this,h))})};const a=o.RTCPeerConnection.prototype.removeStream;o.RTCPeerConnection.prototype.removeStream=function(u){this._senders=this._senders||[],a.apply(this,[u]),u.getTracks().forEach(h=>{const p=this._senders.find(_=>_.track===h);p&&this._senders.splice(this._senders.indexOf(p),1)})}}else if(typeof o=="object"&&o.RTCPeerConnection&&"getSenders"in o.RTCPeerConnection.prototype&&"createDTMFSender"in o.RTCPeerConnection.prototype&&o.RTCRtpSender&&!("dtmf"in o.RTCRtpSender.prototype)){const i=o.RTCPeerConnection.prototype.getSenders;o.RTCPeerConnection.prototype.getSenders=function(){const s=i.apply(this,[]);return s.forEach(a=>a._pc=this),s},Object.defineProperty(o.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Q(o){if(!o.RTCPeerConnection)return;const i=o.RTCPeerConnection.prototype.getStats;o.RTCPeerConnection.prototype.getStats=function(){const[s,a,u]=arguments;if(arguments.length>0&&typeof s=="function")return i.apply(this,arguments);if(i.length===0&&(arguments.length===0||typeof s!="function"))return i.apply(this,[]);const h=function(_){const v={};return _.result().forEach(T=>{const b={id:T.id,timestamp:T.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[T.type]||T.type};T.names().forEach(C=>{b[C]=T.stat(C)}),v[b.id]=b}),v},p=function(_){return new Map(Object.keys(_).map(v=>[v,_[v]]))};if(arguments.length>=2){const _=function(v){a(p(h(v)))};return i.apply(this,[_,s])}return new Promise((_,v)=>{i.apply(this,[function(T){_(p(h(T)))},v])}).then(a,u)}}function Z(o){if(!(typeof o=="object"&&o.RTCPeerConnection&&o.RTCRtpSender&&o.RTCRtpReceiver))return;if(!("getStats"in o.RTCRtpSender.prototype)){const s=o.RTCPeerConnection.prototype.getSenders;s&&(o.RTCPeerConnection.prototype.getSenders=function(){const u=s.apply(this,[]);return u.forEach(h=>h._pc=this),u});const a=o.RTCPeerConnection.prototype.addTrack;a&&(o.RTCPeerConnection.prototype.addTrack=function(){const u=a.apply(this,arguments);return u._pc=this,u}),o.RTCRtpSender.prototype.getStats=function(){const u=this;return this._pc.getStats().then(h=>k(h,u.track,!0))}}if(!("getStats"in o.RTCRtpReceiver.prototype)){const s=o.RTCPeerConnection.prototype.getReceivers;s&&(o.RTCPeerConnection.prototype.getReceivers=function(){const a=s.apply(this,[]);return a.forEach(u=>u._pc=this),a}),d(o,"track",a=>(a.receiver._pc=a.srcElement,a)),o.RTCRtpReceiver.prototype.getStats=function(){const a=this;return this._pc.getStats().then(u=>k(u,a.track,!1))}}if(!("getStats"in o.RTCRtpSender.prototype)||!("getStats"in o.RTCRtpReceiver.prototype))return;const i=o.RTCPeerConnection.prototype.getStats;o.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof o.MediaStreamTrack){const s=arguments[0];let a,u,h;return this.getSenders().forEach(p=>{p.track===s&&(a?h=!0:a=p)}),this.getReceivers().forEach(p=>(p.track===s&&(u?h=!0:u=p),p.track===s)),h||a&&u?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):a?a.getStats():u?u.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return i.apply(this,arguments)}}function Y(o){o.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(h=>this._shimmedLocalStreams[h][0])};const i=o.RTCPeerConnection.prototype.addTrack;o.RTCPeerConnection.prototype.addTrack=function(h,p){if(!p)return i.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const _=i.apply(this,arguments);return this._shimmedLocalStreams[p.id]?this._shimmedLocalStreams[p.id].indexOf(_)===-1&&this._shimmedLocalStreams[p.id].push(_):this._shimmedLocalStreams[p.id]=[p,_],_};const s=o.RTCPeerConnection.prototype.addStream;o.RTCPeerConnection.prototype.addStream=function(h){this._shimmedLocalStreams=this._shimmedLocalStreams||{},h.getTracks().forEach(v=>{if(this.getSenders().find(T=>T.track===v))throw new DOMException("Track already exists.","InvalidAccessError")});const p=this.getSenders();s.apply(this,arguments);const _=this.getSenders().filter(v=>p.indexOf(v)===-1);this._shimmedLocalStreams[h.id]=[h].concat(_)};const a=o.RTCPeerConnection.prototype.removeStream;o.RTCPeerConnection.prototype.removeStream=function(h){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[h.id],a.apply(this,arguments)};const u=o.RTCPeerConnection.prototype.removeTrack;o.RTCPeerConnection.prototype.removeTrack=function(h){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},h&&Object.keys(this._shimmedLocalStreams).forEach(p=>{const _=this._shimmedLocalStreams[p].indexOf(h);_!==-1&&this._shimmedLocalStreams[p].splice(_,1),this._shimmedLocalStreams[p].length===1&&delete this._shimmedLocalStreams[p]}),u.apply(this,arguments)}}function oe(o,i){if(!o.RTCPeerConnection)return;if(o.RTCPeerConnection.prototype.addTrack&&i.version>=65)return Y(o);const s=o.RTCPeerConnection.prototype.getLocalStreams;o.RTCPeerConnection.prototype.getLocalStreams=function(){const v=s.apply(this);return this._reverseStreams=this._reverseStreams||{},v.map(T=>this._reverseStreams[T.id])};const a=o.RTCPeerConnection.prototype.addStream;o.RTCPeerConnection.prototype.addStream=function(v){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},v.getTracks().forEach(T=>{if(this.getSenders().find(b=>b.track===T))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[v.id]){const T=new o.MediaStream(v.getTracks());this._streams[v.id]=T,this._reverseStreams[T.id]=v,v=T}a.apply(this,[v])};const u=o.RTCPeerConnection.prototype.removeStream;function h(v,T){let b=T.sdp;return Object.keys(v._reverseStreams||[]).forEach(C=>{const N=v._reverseStreams[C],x=v._streams[N.id];b=b.replace(new RegExp(x.id,"g"),N.id)}),new RTCSessionDescription({type:T.type,sdp:b})}o.RTCPeerConnection.prototype.removeStream=function(v){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},u.apply(this,[this._streams[v.id]||v]),delete this._reverseStreams[this._streams[v.id]?this._streams[v.id].id:v.id],delete this._streams[v.id]},o.RTCPeerConnection.prototype.addTrack=function(v,T){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const b=[].slice.call(arguments,1);if(b.length!==1||!b[0].getTracks().find(N=>N===v))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(N=>N.track===v))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const C=this._streams[T.id];if(C)C.addTrack(v),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const N=new o.MediaStream([v]);this._streams[T.id]=N,this._reverseStreams[N.id]=T,this.addStream(N)}return this.getSenders().find(N=>N.track===v)},["createOffer","createAnswer"].forEach(function(v){const T=o.RTCPeerConnection.prototype[v],b={[v](){const C=arguments;return arguments.length&&typeof arguments[0]=="function"?T.apply(this,[N=>{const x=h(this,N);C[0].apply(null,[x])},N=>{C[1]&&C[1].apply(null,N)},arguments[2]]):T.apply(this,arguments).then(N=>h(this,N))}};o.RTCPeerConnection.prototype[v]=b[v]});const p=o.RTCPeerConnection.prototype.setLocalDescription;o.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(v,T){let b=T.sdp;return Object.keys(v._reverseStreams||[]).forEach(C=>{const N=v._reverseStreams[C],x=v._streams[N.id];b=b.replace(new RegExp(N.id,"g"),x.id)}),new RTCSessionDescription({type:T.type,sdp:b})}(this,arguments[0]),p.apply(this,arguments)):p.apply(this,arguments)};const _=Object.getOwnPropertyDescriptor(o.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(o.RTCPeerConnection.prototype,"localDescription",{get(){const v=_.get.apply(this);return v.type===""?v:h(this,v)}}),o.RTCPeerConnection.prototype.removeTrack=function(v){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!v._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(v._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let T;this._streams=this._streams||{},Object.keys(this._streams).forEach(b=>{this._streams[b].getTracks().find(C=>v.track===C)&&(T=this._streams[b])}),T&&(T.getTracks().length===1?this.removeStream(this._reverseStreams[T.id]):T.removeTrack(v.track),this.dispatchEvent(new Event("negotiationneeded")))}}function ce(o,i){!o.RTCPeerConnection&&o.webkitRTCPeerConnection&&(o.RTCPeerConnection=o.webkitRTCPeerConnection),o.RTCPeerConnection&&i.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(s){const a=o.RTCPeerConnection.prototype[s],u={[s](){return arguments[0]=new(s==="addIceCandidate"?o.RTCIceCandidate:o.RTCSessionDescription)(arguments[0]),a.apply(this,arguments)}};o.RTCPeerConnection.prototype[s]=u[s]})}function Se(o,i){d(o,"negotiationneeded",s=>{const a=s.target;if(!(i.version<72||a.getConfiguration&&a.getConfiguration().sdpSemantics==="plan-b")||a.signalingState==="stable")return s})}var xe=Object.freeze({__proto__:null,fixNegotiationNeeded:Se,shimAddTrackRemoveTrack:oe,shimAddTrackRemoveTrackWithNative:Y,shimGetDisplayMedia:function(o,i){o.navigator.mediaDevices&&"getDisplayMedia"in o.navigator.mediaDevices||o.navigator.mediaDevices&&(typeof i=="function"?o.navigator.mediaDevices.getDisplayMedia=function(s){return i(s).then(a=>{const u=s.video&&s.video.width,h=s.video&&s.video.height,p=s.video&&s.video.frameRate;return s.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:a,maxFrameRate:p||3}},u&&(s.video.mandatory.maxWidth=u),h&&(s.video.mandatory.maxHeight=h),o.navigator.mediaDevices.getUserMedia(s)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))},shimGetSendersWithDtmf:G,shimGetStats:Q,shimGetUserMedia:K,shimMediaStream:W,shimOnTrack:V,shimPeerConnection:ce,shimSenderReceiverGetStats:Z});function je(o,i){const s=o&&o.navigator,a=o&&o.MediaStreamTrack;if(s.getUserMedia=function(u,h,p){y("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),s.mediaDevices.getUserMedia(u).then(h,p)},!(i.version>55&&"autoGainControl"in s.mediaDevices.getSupportedConstraints())){const u=function(p,_,v){_ in p&&!(v in p)&&(p[v]=p[_],delete p[_])},h=s.mediaDevices.getUserMedia.bind(s.mediaDevices);if(s.mediaDevices.getUserMedia=function(p){return typeof p=="object"&&typeof p.audio=="object"&&(p=JSON.parse(JSON.stringify(p)),u(p.audio,"autoGainControl","mozAutoGainControl"),u(p.audio,"noiseSuppression","mozNoiseSuppression")),h(p)},a&&a.prototype.getSettings){const p=a.prototype.getSettings;a.prototype.getSettings=function(){const _=p.apply(this,arguments);return u(_,"mozAutoGainControl","autoGainControl"),u(_,"mozNoiseSuppression","noiseSuppression"),_}}if(a&&a.prototype.applyConstraints){const p=a.prototype.applyConstraints;a.prototype.applyConstraints=function(_){return this.kind==="audio"&&typeof _=="object"&&(_=JSON.parse(JSON.stringify(_)),u(_,"autoGainControl","mozAutoGainControl"),u(_,"noiseSuppression","mozNoiseSuppression")),p.apply(this,[_])}}}}function Ge(o){typeof o=="object"&&o.RTCTrackEvent&&"receiver"in o.RTCTrackEvent.prototype&&!("transceiver"in o.RTCTrackEvent.prototype)&&Object.defineProperty(o.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function ze(o,i){if(typeof o!="object"||!o.RTCPeerConnection&&!o.mozRTCPeerConnection)return;!o.RTCPeerConnection&&o.mozRTCPeerConnection&&(o.RTCPeerConnection=o.mozRTCPeerConnection),i.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(u){const h=o.RTCPeerConnection.prototype[u],p={[u](){return arguments[0]=new(u==="addIceCandidate"?o.RTCIceCandidate:o.RTCSessionDescription)(arguments[0]),h.apply(this,arguments)}};o.RTCPeerConnection.prototype[u]=p[u]});const s={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},a=o.RTCPeerConnection.prototype.getStats;o.RTCPeerConnection.prototype.getStats=function(){const[u,h,p]=arguments;return a.apply(this,[u||null]).then(_=>{if(i.version<53&&!h)try{_.forEach(v=>{v.type=s[v.type]||v.type})}catch(v){if(v.name!=="TypeError")throw v;_.forEach((T,b)=>{_.set(b,Object.assign({},T,{type:s[T.type]||T.type}))})}return _}).then(h,p)}}function Ke(o){if(typeof o!="object"||!o.RTCPeerConnection||!o.RTCRtpSender||o.RTCRtpSender&&"getStats"in o.RTCRtpSender.prototype)return;const i=o.RTCPeerConnection.prototype.getSenders;i&&(o.RTCPeerConnection.prototype.getSenders=function(){const a=i.apply(this,[]);return a.forEach(u=>u._pc=this),a});const s=o.RTCPeerConnection.prototype.addTrack;s&&(o.RTCPeerConnection.prototype.addTrack=function(){const a=s.apply(this,arguments);return a._pc=this,a}),o.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function He(o){if(typeof o!="object"||!o.RTCPeerConnection||!o.RTCRtpSender||o.RTCRtpSender&&"getStats"in o.RTCRtpReceiver.prototype)return;const i=o.RTCPeerConnection.prototype.getReceivers;i&&(o.RTCPeerConnection.prototype.getReceivers=function(){const s=i.apply(this,[]);return s.forEach(a=>a._pc=this),s}),d(o,"track",s=>(s.receiver._pc=s.srcElement,s)),o.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function be(o){o.RTCPeerConnection&&!("removeStream"in o.RTCPeerConnection.prototype)&&(o.RTCPeerConnection.prototype.removeStream=function(i){y("removeStream","removeTrack"),this.getSenders().forEach(s=>{s.track&&i.getTracks().includes(s.track)&&this.removeTrack(s)})})}function Oe(o){o.DataChannel&&!o.RTCDataChannel&&(o.RTCDataChannel=o.DataChannel)}function _e(o){if(typeof o!="object"||!o.RTCPeerConnection)return;const i=o.RTCPeerConnection.prototype.addTransceiver;i&&(o.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let s=arguments[1]&&arguments[1].sendEncodings;s===void 0&&(s=[]),s=[...s];const a=s.length>0;a&&s.forEach(h=>{if("rid"in h&&!/^[a-z0-9]{0,16}$/i.test(h.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in h&&!(parseFloat(h.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in h&&!(parseFloat(h.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const u=i.apply(this,arguments);if(a){const{sender:h}=u,p=h.getParameters();(!("encodings"in p)||p.encodings.length===1&&Object.keys(p.encodings[0]).length===0)&&(p.encodings=s,h.sendEncodings=s,this.setParametersPromises.push(h.setParameters(p).then(()=>{delete h.sendEncodings}).catch(()=>{delete h.sendEncodings})))}return u})}function We(o){if(typeof o!="object"||!o.RTCRtpSender)return;const i=o.RTCRtpSender.prototype.getParameters;i&&(o.RTCRtpSender.prototype.getParameters=function(){const s=i.apply(this,arguments);return"encodings"in s||(s.encodings=[].concat(this.sendEncodings||[{}])),s})}function Ie(o){if(typeof o!="object"||!o.RTCPeerConnection)return;const i=o.RTCPeerConnection.prototype.createOffer;o.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>i.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):i.apply(this,arguments)}}function De(o){if(typeof o!="object"||!o.RTCPeerConnection)return;const i=o.RTCPeerConnection.prototype.createAnswer;o.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>i.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):i.apply(this,arguments)}}var Ue=Object.freeze({__proto__:null,shimAddTransceiver:_e,shimCreateAnswer:De,shimCreateOffer:Ie,shimGetDisplayMedia:function(o,i){o.navigator.mediaDevices&&"getDisplayMedia"in o.navigator.mediaDevices||o.navigator.mediaDevices&&(o.navigator.mediaDevices.getDisplayMedia=function(s){if(!s||!s.video){const a=new DOMException("getDisplayMedia without video constraints is undefined");return a.name="NotFoundError",a.code=8,Promise.reject(a)}return s.video===!0?s.video={mediaSource:i}:s.video.mediaSource=i,o.navigator.mediaDevices.getUserMedia(s)})},shimGetParameters:We,shimGetUserMedia:je,shimOnTrack:Ge,shimPeerConnection:ze,shimRTCDataChannel:Oe,shimReceiverGetStats:He,shimRemoveStream:be,shimSenderGetStats:Ke});function rt(o){if(typeof o=="object"&&o.RTCPeerConnection){if("getLocalStreams"in o.RTCPeerConnection.prototype||(o.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in o.RTCPeerConnection.prototype)){const i=o.RTCPeerConnection.prototype.addTrack;o.RTCPeerConnection.prototype.addStream=function(s){this._localStreams||(this._localStreams=[]),this._localStreams.includes(s)||this._localStreams.push(s),s.getAudioTracks().forEach(a=>i.call(this,a,s)),s.getVideoTracks().forEach(a=>i.call(this,a,s))},o.RTCPeerConnection.prototype.addTrack=function(s,...a){return a&&a.forEach(u=>{this._localStreams?this._localStreams.includes(u)||this._localStreams.push(u):this._localStreams=[u]}),i.apply(this,arguments)}}"removeStream"in o.RTCPeerConnection.prototype||(o.RTCPeerConnection.prototype.removeStream=function(i){this._localStreams||(this._localStreams=[]);const s=this._localStreams.indexOf(i);if(s===-1)return;this._localStreams.splice(s,1);const a=i.getTracks();this.getSenders().forEach(u=>{a.includes(u.track)&&this.removeTrack(u)})})}}function gt(o){if(typeof o=="object"&&o.RTCPeerConnection&&("getRemoteStreams"in o.RTCPeerConnection.prototype||(o.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in o.RTCPeerConnection.prototype))){Object.defineProperty(o.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(s){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=s),this.addEventListener("track",this._onaddstreampoly=a=>{a.streams.forEach(u=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(u))return;this._remoteStreams.push(u);const h=new Event("addstream");h.stream=u,this.dispatchEvent(h)})})}});const i=o.RTCPeerConnection.prototype.setRemoteDescription;o.RTCPeerConnection.prototype.setRemoteDescription=function(){const s=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(a){a.streams.forEach(u=>{if(s._remoteStreams||(s._remoteStreams=[]),s._remoteStreams.indexOf(u)>=0)return;s._remoteStreams.push(u);const h=new Event("addstream");h.stream=u,s.dispatchEvent(h)})}),i.apply(s,arguments)}}}function ft(o){if(typeof o!="object"||!o.RTCPeerConnection)return;const i=o.RTCPeerConnection.prototype,s=i.createOffer,a=i.createAnswer,u=i.setLocalDescription,h=i.setRemoteDescription,p=i.addIceCandidate;i.createOffer=function(v,T){const b=arguments.length>=2?arguments[2]:arguments[0],C=s.apply(this,[b]);return T?(C.then(v,T),Promise.resolve()):C},i.createAnswer=function(v,T){const b=arguments.length>=2?arguments[2]:arguments[0],C=a.apply(this,[b]);return T?(C.then(v,T),Promise.resolve()):C};let _=function(v,T,b){const C=u.apply(this,[v]);return b?(C.then(T,b),Promise.resolve()):C};i.setLocalDescription=_,_=function(v,T,b){const C=h.apply(this,[v]);return b?(C.then(T,b),Promise.resolve()):C},i.setRemoteDescription=_,_=function(v,T,b){const C=p.apply(this,[v]);return b?(C.then(T,b),Promise.resolve()):C},i.addIceCandidate=_}function Ft(o){const i=o&&o.navigator;if(i.mediaDevices&&i.mediaDevices.getUserMedia){const s=i.mediaDevices,a=s.getUserMedia.bind(s);i.mediaDevices.getUserMedia=u=>a(qt(u))}!i.getUserMedia&&i.mediaDevices&&i.mediaDevices.getUserMedia&&(i.getUserMedia=(function(s,a,u){i.mediaDevices.getUserMedia(s).then(a,u)}).bind(i))}function qt(o){return o&&o.video!==void 0?Object.assign({},o,{video:I(o.video)}):o}function ti(o){if(!o.RTCPeerConnection)return;const i=o.RTCPeerConnection;o.RTCPeerConnection=function(s,a){if(s&&s.iceServers){const u=[];for(let h=0;h<s.iceServers.length;h++){let p=s.iceServers[h];!p.hasOwnProperty("urls")&&p.hasOwnProperty("url")?(y("RTCIceServer.url","RTCIceServer.urls"),p=JSON.parse(JSON.stringify(p)),p.urls=p.url,delete p.url,u.push(p)):u.push(s.iceServers[h])}s.iceServers=u}return new i(s,a)},o.RTCPeerConnection.prototype=i.prototype,"generateCertificate"in i&&Object.defineProperty(o.RTCPeerConnection,"generateCertificate",{get:()=>i.generateCertificate})}function Vt(o){typeof o=="object"&&o.RTCTrackEvent&&"receiver"in o.RTCTrackEvent.prototype&&!("transceiver"in o.RTCTrackEvent.prototype)&&Object.defineProperty(o.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function xn(o){const i=o.RTCPeerConnection.prototype.createOffer;o.RTCPeerConnection.prototype.createOffer=function(s){if(s){s.offerToReceiveAudio!==void 0&&(s.offerToReceiveAudio=!!s.offerToReceiveAudio);const a=this.getTransceivers().find(h=>h.receiver.track.kind==="audio");s.offerToReceiveAudio===!1&&a?a.direction==="sendrecv"?a.setDirection?a.setDirection("sendonly"):a.direction="sendonly":a.direction==="recvonly"&&(a.setDirection?a.setDirection("inactive"):a.direction="inactive"):s.offerToReceiveAudio!==!0||a||this.addTransceiver("audio",{direction:"recvonly"}),s.offerToReceiveVideo!==void 0&&(s.offerToReceiveVideo=!!s.offerToReceiveVideo);const u=this.getTransceivers().find(h=>h.receiver.track.kind==="video");s.offerToReceiveVideo===!1&&u?u.direction==="sendrecv"?u.setDirection?u.setDirection("sendonly"):u.direction="sendonly":u.direction==="recvonly"&&(u.setDirection?u.setDirection("inactive"):u.direction="inactive"):s.offerToReceiveVideo!==!0||u||this.addTransceiver("video",{direction:"recvonly"})}return i.apply(this,arguments)}}function En(o){typeof o!="object"||o.AudioContext||(o.AudioContext=o.webkitAudioContext)}var Di=Object.freeze({__proto__:null,shimAudioContext:En,shimCallbacksAPI:ft,shimConstraints:qt,shimCreateOfferLegacy:xn,shimGetUserMedia:Ft,shimLocalStreamsAPI:rt,shimRTCIceServerUrls:ti,shimRemoteStreamsAPI:gt,shimTrackEventTransceiver:Vt}),ui=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Gt<"u"?Gt:typeof self<"u"?self:{};function rn(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var Rn={exports:{}};(function(o){const i={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};i.localCName=i.generateIdentifier(),i.splitLines=function(s){return s.trim().split(`
`).map(a=>a.trim())},i.splitSections=function(s){return s.split(`
m=`).map((a,u)=>(u>0?"m="+a:a).trim()+`\r
`)},i.getDescription=function(s){const a=i.splitSections(s);return a&&a[0]},i.getMediaSections=function(s){const a=i.splitSections(s);return a.shift(),a},i.matchPrefix=function(s,a){return i.splitLines(s).filter(u=>u.indexOf(a)===0)},i.parseCandidate=function(s){let a;a=s.indexOf("a=candidate:")===0?s.substring(12).split(" "):s.substring(10).split(" ");const u={foundation:a[0],component:{1:"rtp",2:"rtcp"}[a[1]]||a[1],protocol:a[2].toLowerCase(),priority:parseInt(a[3],10),ip:a[4],address:a[4],port:parseInt(a[5],10),type:a[7]};for(let h=8;h<a.length;h+=2)switch(a[h]){case"raddr":u.relatedAddress=a[h+1];break;case"rport":u.relatedPort=parseInt(a[h+1],10);break;case"tcptype":u.tcpType=a[h+1];break;case"ufrag":u.ufrag=a[h+1],u.usernameFragment=a[h+1];break;default:u[a[h]]===void 0&&(u[a[h]]=a[h+1])}return u},i.writeCandidate=function(s){const a=[];a.push(s.foundation);const u=s.component;u==="rtp"?a.push(1):u==="rtcp"?a.push(2):a.push(u),a.push(s.protocol.toUpperCase()),a.push(s.priority),a.push(s.address||s.ip),a.push(s.port);const h=s.type;return a.push("typ"),a.push(h),h!=="host"&&s.relatedAddress&&s.relatedPort&&(a.push("raddr"),a.push(s.relatedAddress),a.push("rport"),a.push(s.relatedPort)),s.tcpType&&s.protocol.toLowerCase()==="tcp"&&(a.push("tcptype"),a.push(s.tcpType)),(s.usernameFragment||s.ufrag)&&(a.push("ufrag"),a.push(s.usernameFragment||s.ufrag)),"candidate:"+a.join(" ")},i.parseIceOptions=function(s){return s.substring(14).split(" ")},i.parseRtpMap=function(s){let a=s.substring(9).split(" ");const u={payloadType:parseInt(a.shift(),10)};return a=a[0].split("/"),u.name=a[0],u.clockRate=parseInt(a[1],10),u.channels=a.length===3?parseInt(a[2],10):1,u.numChannels=u.channels,u},i.writeRtpMap=function(s){let a=s.payloadType;s.preferredPayloadType!==void 0&&(a=s.preferredPayloadType);const u=s.channels||s.numChannels||1;return"a=rtpmap:"+a+" "+s.name+"/"+s.clockRate+(u!==1?"/"+u:"")+`\r
`},i.parseExtmap=function(s){const a=s.substring(9).split(" ");return{id:parseInt(a[0],10),direction:a[0].indexOf("/")>0?a[0].split("/")[1]:"sendrecv",uri:a[1],attributes:a.slice(2).join(" ")}},i.writeExtmap=function(s){return"a=extmap:"+(s.id||s.preferredId)+(s.direction&&s.direction!=="sendrecv"?"/"+s.direction:"")+" "+s.uri+(s.attributes?" "+s.attributes:"")+`\r
`},i.parseFmtp=function(s){const a={};let u;const h=s.substring(s.indexOf(" ")+1).split(";");for(let p=0;p<h.length;p++)u=h[p].trim().split("="),a[u[0].trim()]=u[1];return a},i.writeFmtp=function(s){let a="",u=s.payloadType;if(s.preferredPayloadType!==void 0&&(u=s.preferredPayloadType),s.parameters&&Object.keys(s.parameters).length){const h=[];Object.keys(s.parameters).forEach(p=>{s.parameters[p]!==void 0?h.push(p+"="+s.parameters[p]):h.push(p)}),a+="a=fmtp:"+u+" "+h.join(";")+`\r
`}return a},i.parseRtcpFb=function(s){const a=s.substring(s.indexOf(" ")+1).split(" ");return{type:a.shift(),parameter:a.join(" ")}},i.writeRtcpFb=function(s){let a="",u=s.payloadType;return s.preferredPayloadType!==void 0&&(u=s.preferredPayloadType),s.rtcpFeedback&&s.rtcpFeedback.length&&s.rtcpFeedback.forEach(h=>{a+="a=rtcp-fb:"+u+" "+h.type+(h.parameter&&h.parameter.length?" "+h.parameter:"")+`\r
`}),a},i.parseSsrcMedia=function(s){const a=s.indexOf(" "),u={ssrc:parseInt(s.substring(7,a),10)},h=s.indexOf(":",a);return h>-1?(u.attribute=s.substring(a+1,h),u.value=s.substring(h+1)):u.attribute=s.substring(a+1),u},i.parseSsrcGroup=function(s){const a=s.substring(13).split(" ");return{semantics:a.shift(),ssrcs:a.map(u=>parseInt(u,10))}},i.getMid=function(s){const a=i.matchPrefix(s,"a=mid:")[0];if(a)return a.substring(6)},i.parseFingerprint=function(s){const a=s.substring(14).split(" ");return{algorithm:a[0].toLowerCase(),value:a[1].toUpperCase()}},i.getDtlsParameters=function(s,a){return{role:"auto",fingerprints:i.matchPrefix(s+a,"a=fingerprint:").map(i.parseFingerprint)}},i.writeDtlsParameters=function(s,a){let u="a=setup:"+a+`\r
`;return s.fingerprints.forEach(h=>{u+="a=fingerprint:"+h.algorithm+" "+h.value+`\r
`}),u},i.parseCryptoLine=function(s){const a=s.substring(9).split(" ");return{tag:parseInt(a[0],10),cryptoSuite:a[1],keyParams:a[2],sessionParams:a.slice(3)}},i.writeCryptoLine=function(s){return"a=crypto:"+s.tag+" "+s.cryptoSuite+" "+(typeof s.keyParams=="object"?i.writeCryptoKeyParams(s.keyParams):s.keyParams)+(s.sessionParams?" "+s.sessionParams.join(" "):"")+`\r
`},i.parseCryptoKeyParams=function(s){if(s.indexOf("inline:")!==0)return null;const a=s.substring(7).split("|");return{keyMethod:"inline",keySalt:a[0],lifeTime:a[1],mkiValue:a[2]?a[2].split(":")[0]:void 0,mkiLength:a[2]?a[2].split(":")[1]:void 0}},i.writeCryptoKeyParams=function(s){return s.keyMethod+":"+s.keySalt+(s.lifeTime?"|"+s.lifeTime:"")+(s.mkiValue&&s.mkiLength?"|"+s.mkiValue+":"+s.mkiLength:"")},i.getCryptoParameters=function(s,a){return i.matchPrefix(s+a,"a=crypto:").map(i.parseCryptoLine)},i.getIceParameters=function(s,a){const u=i.matchPrefix(s+a,"a=ice-ufrag:")[0],h=i.matchPrefix(s+a,"a=ice-pwd:")[0];return u&&h?{usernameFragment:u.substring(12),password:h.substring(10)}:null},i.writeIceParameters=function(s){let a="a=ice-ufrag:"+s.usernameFragment+`\r
a=ice-pwd:`+s.password+`\r
`;return s.iceLite&&(a+=`a=ice-lite\r
`),a},i.parseRtpParameters=function(s){const a={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},u=i.splitLines(s)[0].split(" ");a.profile=u[2];for(let p=3;p<u.length;p++){const _=u[p],v=i.matchPrefix(s,"a=rtpmap:"+_+" ")[0];if(v){const T=i.parseRtpMap(v),b=i.matchPrefix(s,"a=fmtp:"+_+" ");switch(T.parameters=b.length?i.parseFmtp(b[0]):{},T.rtcpFeedback=i.matchPrefix(s,"a=rtcp-fb:"+_+" ").map(i.parseRtcpFb),a.codecs.push(T),T.name.toUpperCase()){case"RED":case"ULPFEC":a.fecMechanisms.push(T.name.toUpperCase())}}}i.matchPrefix(s,"a=extmap:").forEach(p=>{a.headerExtensions.push(i.parseExtmap(p))});const h=i.matchPrefix(s,"a=rtcp-fb:* ").map(i.parseRtcpFb);return a.codecs.forEach(p=>{h.forEach(_=>{p.rtcpFeedback.find(v=>v.type===_.type&&v.parameter===_.parameter)||p.rtcpFeedback.push(_)})}),a},i.writeRtpDescription=function(s,a){let u="";u+="m="+s+" ",u+=a.codecs.length>0?"9":"0",u+=" "+(a.profile||"UDP/TLS/RTP/SAVPF")+" ",u+=a.codecs.map(p=>p.preferredPayloadType!==void 0?p.preferredPayloadType:p.payloadType).join(" ")+`\r
`,u+=`c=IN IP4 0.0.0.0\r
`,u+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,a.codecs.forEach(p=>{u+=i.writeRtpMap(p),u+=i.writeFmtp(p),u+=i.writeRtcpFb(p)});let h=0;return a.codecs.forEach(p=>{p.maxptime>h&&(h=p.maxptime)}),h>0&&(u+="a=maxptime:"+h+`\r
`),a.headerExtensions&&a.headerExtensions.forEach(p=>{u+=i.writeExtmap(p)}),u},i.parseRtpEncodingParameters=function(s){const a=[],u=i.parseRtpParameters(s),h=u.fecMechanisms.indexOf("RED")!==-1,p=u.fecMechanisms.indexOf("ULPFEC")!==-1,_=i.matchPrefix(s,"a=ssrc:").map(N=>i.parseSsrcMedia(N)).filter(N=>N.attribute==="cname"),v=_.length>0&&_[0].ssrc;let T;const b=i.matchPrefix(s,"a=ssrc-group:FID").map(N=>N.substring(17).split(" ").map(x=>parseInt(x,10)));b.length>0&&b[0].length>1&&b[0][0]===v&&(T=b[0][1]),u.codecs.forEach(N=>{if(N.name.toUpperCase()==="RTX"&&N.parameters.apt){let x={ssrc:v,codecPayloadType:parseInt(N.parameters.apt,10)};v&&T&&(x.rtx={ssrc:T}),a.push(x),h&&(x=JSON.parse(JSON.stringify(x)),x.fec={ssrc:v,mechanism:p?"red+ulpfec":"red"},a.push(x))}}),a.length===0&&v&&a.push({ssrc:v});let C=i.matchPrefix(s,"b=");return C.length&&(C=C[0].indexOf("b=TIAS:")===0?parseInt(C[0].substring(7),10):C[0].indexOf("b=AS:")===0?1e3*parseInt(C[0].substring(5),10)*.95-16e3:void 0,a.forEach(N=>{N.maxBitrate=C})),a},i.parseRtcpParameters=function(s){const a={},u=i.matchPrefix(s,"a=ssrc:").map(_=>i.parseSsrcMedia(_)).filter(_=>_.attribute==="cname")[0];u&&(a.cname=u.value,a.ssrc=u.ssrc);const h=i.matchPrefix(s,"a=rtcp-rsize");a.reducedSize=h.length>0,a.compound=h.length===0;const p=i.matchPrefix(s,"a=rtcp-mux");return a.mux=p.length>0,a},i.writeRtcpParameters=function(s){let a="";return s.reducedSize&&(a+=`a=rtcp-rsize\r
`),s.mux&&(a+=`a=rtcp-mux\r
`),s.ssrc!==void 0&&s.cname&&(a+="a=ssrc:"+s.ssrc+" cname:"+s.cname+`\r
`),a},i.parseMsid=function(s){let a;const u=i.matchPrefix(s,"a=msid:");if(u.length===1)return a=u[0].substring(7).split(" "),{stream:a[0],track:a[1]};const h=i.matchPrefix(s,"a=ssrc:").map(p=>i.parseSsrcMedia(p)).filter(p=>p.attribute==="msid");return h.length>0?(a=h[0].value.split(" "),{stream:a[0],track:a[1]}):void 0},i.parseSctpDescription=function(s){const a=i.parseMLine(s),u=i.matchPrefix(s,"a=max-message-size:");let h;u.length>0&&(h=parseInt(u[0].substring(19),10)),isNaN(h)&&(h=65536);const p=i.matchPrefix(s,"a=sctp-port:");if(p.length>0)return{port:parseInt(p[0].substring(12),10),protocol:a.fmt,maxMessageSize:h};const _=i.matchPrefix(s,"a=sctpmap:");if(_.length>0){const v=_[0].substring(10).split(" ");return{port:parseInt(v[0],10),protocol:v[1],maxMessageSize:h}}},i.writeSctpDescription=function(s,a){let u=[];return u=s.protocol!=="DTLS/SCTP"?["m="+s.kind+" 9 "+s.protocol+" "+a.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+a.port+`\r
`]:["m="+s.kind+" 9 "+s.protocol+" "+a.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+a.port+" "+a.protocol+` 65535\r
`],a.maxMessageSize!==void 0&&u.push("a=max-message-size:"+a.maxMessageSize+`\r
`),u.join("")},i.generateSessionId=function(){return Math.random().toString().substr(2,22)},i.writeSessionBoilerplate=function(s,a,u){let h;const p=a!==void 0?a:2;return h=s||i.generateSessionId(),`v=0\r
o=`+(u||"thisisadapterortc")+" "+h+" "+p+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},i.getDirection=function(s,a){const u=i.splitLines(s);for(let h=0;h<u.length;h++)switch(u[h]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return u[h].substring(2)}return a?i.getDirection(a):"sendrecv"},i.getKind=function(s){return i.splitLines(s)[0].split(" ")[0].substring(2)},i.isRejected=function(s){return s.split(" ",2)[1]==="0"},i.parseMLine=function(s){const a=i.splitLines(s)[0].substring(2).split(" ");return{kind:a[0],port:parseInt(a[1],10),protocol:a[2],fmt:a.slice(3).join(" ")}},i.parseOLine=function(s){const a=i.matchPrefix(s,"o=")[0].substring(2).split(" ");return{username:a[0],sessionId:a[1],sessionVersion:parseInt(a[2],10),netType:a[3],addressType:a[4],address:a[5]}},i.isValidSDP=function(s){if(typeof s!="string"||s.length===0)return!1;const a=i.splitLines(s);for(let u=0;u<a.length;u++)if(a[u].length<2||a[u].charAt(1)!=="=")return!1;return!0},o.exports=i})(Rn);var us=Rn.exports,di=rn(us),Go=n({__proto__:null,default:di},[us]);function qr(o){if(!o.RTCIceCandidate||o.RTCIceCandidate&&"foundation"in o.RTCIceCandidate.prototype)return;const i=o.RTCIceCandidate;o.RTCIceCandidate=function(s){if(typeof s=="object"&&s.candidate&&s.candidate.indexOf("a=")===0&&((s=JSON.parse(JSON.stringify(s))).candidate=s.candidate.substr(2)),s.candidate&&s.candidate.length){const a=new i(s),u=di.parseCandidate(s.candidate),h=Object.assign(a,u);return h.toJSON=function(){return{candidate:h.candidate,sdpMid:h.sdpMid,sdpMLineIndex:h.sdpMLineIndex,usernameFragment:h.usernameFragment}},h}return new i(s)},o.RTCIceCandidate.prototype=i.prototype,d(o,"icecandidate",s=>(s.candidate&&Object.defineProperty(s,"candidate",{value:new o.RTCIceCandidate(s.candidate),writable:"false"}),s))}function Zi(o){!o.RTCIceCandidate||o.RTCIceCandidate&&"relayProtocol"in o.RTCIceCandidate.prototype||d(o,"icecandidate",i=>{if(i.candidate){const s=di.parseCandidate(i.candidate.candidate);s.type==="relay"&&(i.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[s.priority>>24])}return i})}function wi(o,i){if(!o.RTCPeerConnection)return;"sctp"in o.RTCPeerConnection.prototype||Object.defineProperty(o.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const s=function(_){if(!_||!_.sdp)return!1;const v=di.splitSections(_.sdp);return v.shift(),v.some(T=>{const b=di.parseMLine(T);return b&&b.kind==="application"&&b.protocol.indexOf("SCTP")!==-1})},a=function(_){const v=_.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(v===null||v.length<2)return-1;const T=parseInt(v[1],10);return T!=T?-1:T},u=function(_){let v=65536;return i.browser==="firefox"&&(v=i.version<57?_===-1?16384:2147483637:i.version<60?i.version===57?65535:65536:2147483637),v},h=function(_,v){let T=65536;i.browser==="firefox"&&i.version===57&&(T=65535);const b=di.matchPrefix(_.sdp,"a=max-message-size:");return b.length>0?T=parseInt(b[0].substr(19),10):i.browser==="firefox"&&v!==-1&&(T=2147483637),T},p=o.RTCPeerConnection.prototype.setRemoteDescription;o.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,i.browser==="chrome"&&i.version>=76){const{sdpSemantics:_}=this.getConfiguration();_==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(s(arguments[0])){const _=a(arguments[0]),v=u(_),T=h(arguments[0],_);let b;b=v===0&&T===0?Number.POSITIVE_INFINITY:v===0||T===0?Math.max(v,T):Math.min(v,T);const C={};Object.defineProperty(C,"maxMessageSize",{get:()=>b}),this._sctp=C}return p.apply(this,arguments)}}function Ne(o){if(!o.RTCPeerConnection||!("createDataChannel"in o.RTCPeerConnection.prototype))return;function i(a,u){const h=a.send;a.send=function(){const p=arguments[0],_=p.length||p.size||p.byteLength;if(a.readyState==="open"&&u.sctp&&_>u.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+u.sctp.maxMessageSize+" bytes)");return h.apply(a,arguments)}}const s=o.RTCPeerConnection.prototype.createDataChannel;o.RTCPeerConnection.prototype.createDataChannel=function(){const a=s.apply(this,arguments);return i(a,this),a},d(o,"datachannel",a=>(i(a.channel,a.target),a))}function dt(o){if(!o.RTCPeerConnection||"connectionState"in o.RTCPeerConnection.prototype)return;const i=o.RTCPeerConnection.prototype;Object.defineProperty(i,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(i,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(s){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),s&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=s)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(s=>{const a=i[s];i[s]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=u=>{const h=u.target;if(h._lastConnectionState!==h.connectionState){h._lastConnectionState=h.connectionState;const p=new Event("connectionstatechange",u);h.dispatchEvent(p)}return u},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),a.apply(this,arguments)}})}function Et(o,i){if(!o.RTCPeerConnection||i.browser==="chrome"&&i.version>=71||i.browser==="safari"&&i.version>=605)return;const s=o.RTCPeerConnection.prototype.setRemoteDescription;o.RTCPeerConnection.prototype.setRemoteDescription=function(a){if(a&&a.sdp&&a.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const u=a.sdp.split(`
`).filter(h=>h.trim()!=="a=extmap-allow-mixed").join(`
`);o.RTCSessionDescription&&a instanceof o.RTCSessionDescription?arguments[0]=new o.RTCSessionDescription({type:a.type,sdp:u}):a.sdp=u}return s.apply(this,arguments)}}function st(o,i){if(!o.RTCPeerConnection||!o.RTCPeerConnection.prototype)return;const s=o.RTCPeerConnection.prototype.addIceCandidate;s&&s.length!==0&&(o.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(i.browser==="chrome"&&i.version<78||i.browser==="firefox"&&i.version<68||i.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():s.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Ot(o,i){if(!o.RTCPeerConnection||!o.RTCPeerConnection.prototype)return;const s=o.RTCPeerConnection.prototype.setLocalDescription;s&&s.length!==0&&(o.RTCPeerConnection.prototype.setLocalDescription=function(){let a=arguments[0]||{};if(typeof a!="object"||a.type&&a.sdp)return s.apply(this,arguments);if(a={type:a.type,sdp:a.sdp},!a.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":a.type="offer";break;default:a.type="answer"}return a.sdp||a.type!=="offer"&&a.type!=="answer"?s.apply(this,[a]):(a.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(u=>s.apply(this,[u]))})}var Qt=Object.freeze({__proto__:null,removeExtmapAllowMixed:Et,shimAddIceCandidateNullOrEmpty:st,shimConnectionState:dt,shimMaxMessageSize:wi,shimParameterlessSetLocalDescription:Ot,shimRTCIceCandidate:qr,shimRTCIceCandidateRelayProtocol:Zi,shimSendThrowTypeError:Ne});(function({window:o}={},i={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const s=E,a=function(h){const p={browser:null,version:null};if(h===void 0||!h.navigator)return p.browser="Not a browser.",p;const{navigator:_}=h;if(_.mozGetUserMedia)p.browser="firefox",p.version=l(_.userAgent,/Firefox\/(\d+)\./,1);else if(_.webkitGetUserMedia||h.isSecureContext===!1&&h.webkitRTCPeerConnection)p.browser="chrome",p.version=l(_.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!h.RTCPeerConnection||!_.userAgent.match(/AppleWebKit\/(\d+)\./))return p.browser="Not a supported browser.",p;p.browser="safari",p.version=l(_.userAgent,/AppleWebKit\/(\d+)\./,1),p.supportsUnifiedPlan=h.RTCRtpTransceiver&&"currentDirection"in h.RTCRtpTransceiver.prototype}return p}(o),u={browserDetails:a,commonShim:Qt,extractVersion:l,disableLog:f,disableWarnings:m,sdp:Go};switch(a.browser){case"chrome":if(!xe||!ce||!i.shimChrome)return s("Chrome shim is not included in this adapter release."),u;if(a.version===null)return s("Chrome shim can not determine version, not shimming."),u;s("adapter.js shimming chrome."),u.browserShim=xe,st(o,a),Ot(o),K(o,a),W(o),ce(o,a),V(o),oe(o,a),G(o),Q(o),Z(o),Se(o,a),qr(o),Zi(o),dt(o),wi(o,a),Ne(o),Et(o,a);break;case"firefox":if(!Ue||!ze||!i.shimFirefox)return s("Firefox shim is not included in this adapter release."),u;s("adapter.js shimming firefox."),u.browserShim=Ue,st(o,a),Ot(o),je(o,a),ze(o,a),Ge(o),be(o),Ke(o),He(o),Oe(o),_e(o),We(o),Ie(o),De(o),qr(o),dt(o),wi(o,a),Ne(o);break;case"safari":if(!Di||!i.shimSafari)return s("Safari shim is not included in this adapter release."),u;s("adapter.js shimming safari."),u.browserShim=Di,st(o,a),Ot(o),ti(o),xn(o),ft(o),rt(o),gt(o),Vt(o),Ft(o),En(o),qr(o),Zi(o),wi(o,a),Ne(o),Et(o,a);break;default:s("Unsupported browser!")}})({window:typeof window>"u"?void 0:window});var kt=function(o){try{return!!o()}catch{return!0}},Lt=!kt(function(){var o=(function(){}).bind();return typeof o!="function"||o.hasOwnProperty("prototype")}),Ut=Lt,Dn=Function.prototype,xt=Dn.call,Mt=Ut&&Dn.bind.bind(xt,xt),Nt=Ut?Mt:function(o){return function(){return xt.apply(o,arguments)}},ni=Nt({}.isPrototypeOf),vs=function(o){return o&&o.Math==Math&&o},Ci=vs(typeof globalThis=="object"&&globalThis)||vs(typeof window=="object"&&window)||vs(typeof self=="object"&&self)||vs(typeof ui=="object"&&ui)||function(){return this}()||ui||Function("return this")(),bg=Lt,sp=Function.prototype,op=sp.apply,sn=sp.call,hn=typeof Reflect=="object"&&Reflect.apply||(bg?sn.bind(op):function(){return sn.apply(op,arguments)}),wr=Nt,Yr=wr({}.toString),Ko=wr("".slice),Xs=function(o){return Ko(Yr(o),8,-1)},ap=Xs,QP=Nt,Wv=function(o){if(ap(o)==="Function")return QP(o)},Hv=typeof document=="object"&&document.all,Jd={all:Hv,IS_HTMLDDA:Hv===void 0&&Hv!==void 0},ZP=Jd.all,dr=Jd.IS_HTMLDDA?function(o){return typeof o=="function"||o===ZP}:function(o){return typeof o=="function"},cp={},lc=!kt(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),ex=Lt,wg=Function.prototype.call,ys=ex?wg.bind(wg):function(){return wg.apply(wg,arguments)},$v={},Jb={}.propertyIsEnumerable,Qb=Object.getOwnPropertyDescriptor,Zb=Qb&&!Jb.call({1:2},1);$v.f=Zb?function(o){var i=Qb(this,o);return!!i&&i.enumerable}:Jb;var Cl,Cg,Uu=function(o,i){return{enumerable:!(1&o),configurable:!(2&o),writable:!(4&o),value:i}},tx=kt,nx=Xs,zv=Object,Rg=Nt("".split),Gv=tx(function(){return!zv("z").propertyIsEnumerable(0)})?function(o){return nx(o)=="String"?Rg(o,""):zv(o)}:zv,ju=function(o){return o==null},ix=ju,rx=TypeError,lp=function(o){if(ix(o))throw rx("Can't call method on "+o);return o},ew=Gv,tw=lp,Rl=function(o){return ew(tw(o))},nw=dr,sx=Jd.all,qo=Jd.IS_HTMLDDA?function(o){return typeof o=="object"?o!==null:nw(o)||o===sx}:function(o){return typeof o=="object"?o!==null:nw(o)},Fu={},Ig=Fu,Ag=Ci,iw=dr,Og=function(o){return iw(o)?o:void 0},Js=function(o,i){return arguments.length<2?Og(Ig[o])||Og(Ag[o]):Ig[o]&&Ig[o][i]||Ag[o]&&Ag[o][i]},Il=typeof navigator<"u"&&String(navigator.userAgent)||"",up=Ci,Ng=Il,rw=up.process,Kv=up.Deno,qv=rw&&rw.versions||Kv&&Kv.version,Pg=qv&&qv.v8;Pg&&(Cg=(Cl=Pg.split("."))[0]>0&&Cl[0]<4?1:+(Cl[0]+Cl[1])),!Cg&&Ng&&(!(Cl=Ng.match(/Edge\/(\d+)/))||Cl[1]>=74)&&(Cl=Ng.match(/Chrome\/(\d+)/))&&(Cg=+Cl[1]);var Vu=Cg,Yv=Vu,Xv=kt,Jv=Ci.String,Aa=!!Object.getOwnPropertySymbols&&!Xv(function(){var o=Symbol();return!Jv(o)||!(Object(o)instanceof Symbol)||!Symbol.sham&&Yv&&Yv<41}),Qv=Aa&&!Symbol.sham&&typeof Symbol.iterator=="symbol",sw=Js,ox=dr,ow=ni,aw=Object,Qd=Qv?function(o){return typeof o=="symbol"}:function(o){var i=sw("Symbol");return ox(i)&&ow(i.prototype,aw(o))},cw=String,Zd=function(o){try{return cw(o)}catch{return"Object"}},ax=dr,cx=Zd,lw=TypeError,Yo=function(o){if(ax(o))return o;throw lw(cx(o)+" is not a function")},lx=Yo,ux=ju,Zv=function(o,i){var s=o[i];return ux(s)?void 0:lx(s)},dp=ys,ey=dr,ty=qo,dx=TypeError,uw={exports:{}},dw=Ci,ki=Object.defineProperty,Ri=function(o,i){try{ki(dw,o,{value:i,configurable:!0,writable:!0})}catch{dw[o]=i}return i},hw="__core-js_shared__",ny=Ci[hw]||Ri(hw,{}),fw=ny;(uw.exports=function(o,i){return fw[o]||(fw[o]=i!==void 0?i:{})})("versions",[]).push({version:"3.31.1",mode:"pure",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.1/LICENSE",source:"https://github.com/zloirock/core-js"});var eh=uw.exports,hx=lp,fx=Object,Al=function(o){return fx(hx(o))},px=Al,ds=Nt({}.hasOwnProperty),Xr=Object.hasOwn||function(o,i){return ds(px(o),i)},Bu=Nt,pw=0,iy=Math.random(),Xo=Bu(1 .toString),xg=function(o){return"Symbol("+(o===void 0?"":o)+")_"+Xo(++pw+iy,36)},mw=eh,ry=Xr,gw=xg,_w=Aa,Ew=Qv,Jr=Ci.Symbol,sy=mw("wks"),Jo=Ew?Jr.for||Jr:Jr&&Jr.withoutSetter||gw,Wi=function(o){return ry(sy,o)||(sy[o]=_w&&ry(Jr,o)?Jr[o]:Jo("Symbol."+o)),sy[o]},vw=ys,Bc=qo,hp=Qd,oy=Zv,Hi=function(o,i){var s,a;if(i==="string"&&ey(s=o.toString)&&!ty(a=dp(s,o))||ey(s=o.valueOf)&&!ty(a=dp(s,o))||i!=="string"&&ey(s=o.toString)&&!ty(a=dp(s,o)))return a;throw dx("Can't convert object to primitive value")},Ol=TypeError,ay=Wi("toPrimitive"),mx=function(o,i){if(!Bc(o)||hp(o))return o;var s,a=oy(o,ay);if(a){if(i===void 0&&(i="default"),s=vw(a,o,i),!Bc(s)||hp(s))return s;throw Ol("Can't convert object to primitive value")}return i===void 0&&(i="number"),Hi(o,i)},cy=Qd,Dg=function(o){var i=mx(o,"string");return cy(i)?i:i+""},yw=qo,ly=Ci.document,Sw=yw(ly)&&yw(ly.createElement),th=function(o){return Sw?ly.createElement(o):{}},nh=th,Tw=!lc&&!kt(function(){return Object.defineProperty(nh("div"),"a",{get:function(){return 7}}).a!=7}),bw=lc,ww=ys,uy=$v,dy=Uu,Cw=Rl,gx=Dg,hy=Xr,fy=Tw,Rw=Object.getOwnPropertyDescriptor;cp.f=bw?Rw:function(o,i){if(o=Cw(o),i=gx(i),fy)try{return Rw(o,i)}catch{}if(hy(o,i))return dy(!ww(uy.f,o,i),o[i])};var Iw=kt,Ao=dr,py=/#|\.prototype\./,Wc=function(o,i){var s=Ow[Aw(o)];return s==Ex||s!=_x&&(Ao(i)?Iw(i):!!i)},Aw=Wc.normalize=function(o){return String(o).replace(py,".").toLowerCase()},Ow=Wc.data={},_x=Wc.NATIVE="N",Ex=Wc.POLYFILL="P",Nw=Wc,vx=Yo,yx=Lt,ih=Wv(Wv.bind),fp=function(o,i){return vx(o),i===void 0?o:yx?ih(o,i):function(){return o.apply(i,arguments)}},Qo={},kg=lc&&kt(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),Pw=qo,Nl=String,Lg=TypeError,Oa=function(o){if(Pw(o))return o;throw Lg(Nl(o)+" is not an object")},Sx=lc,Tx=Tw,rh=kg,Qs=Oa,my=Dg,bx=TypeError,gy=Object.defineProperty,wx=Object.getOwnPropertyDescriptor,_y="enumerable",Ey="configurable",Pl="writable";Qo.f=Sx?rh?function(o,i,s){if(Qs(o),i=my(i),Qs(s),typeof o=="function"&&i==="prototype"&&"value"in s&&Pl in s&&!s[Pl]){var a=wx(o,i);a&&a[Pl]&&(o[i]=s.value,s={configurable:Ey in s?s[Ey]:a[Ey],enumerable:_y in s?s[_y]:a[_y],writable:!1})}return gy(o,i,s)}:gy:function(o,i,s){if(Qs(o),i=my(i),Qs(s),Tx)try{return gy(o,i,s)}catch{}if("get"in s||"set"in s)throw bx("Accessors not supported");return"value"in s&&(o[i]=s.value),o};var we=Qo,$e=Uu,Pe=lc?function(o,i,s){return we.f(o,i,$e(1,s))}:function(o,i,s){return o[i]=s,o},vt=Ci,on=hn,Xn=Wv,Mr=dr,gi=cp.f,vy=Nw,sh=Fu,Zo=fp,Hc=Pe,xw=Xr,oh=function(o){var i=function(s,a,u){if(this instanceof i){switch(arguments.length){case 0:return new o;case 1:return new o(s);case 2:return new o(s,a)}return new o(s,a,u)}return on(o,this,arguments)};return i.prototype=o.prototype,i},Kn=function(o,i){var s,a,u,h,p,_,v,T,b,C=o.target,N=o.global,x=o.stat,B=o.proto,F=N?vt:x?vt[C]:(vt[C]||{}).prototype,H=N?sh:sh[C]||Hc(sh,C,{})[C],J=H.prototype;for(h in i)a=!(s=vy(N?h:C+(x?".":"#")+h,o.forced))&&F&&xw(F,h),_=H[h],a&&(v=o.dontCallGetSet?(b=gi(F,h))&&b.value:F[h]),p=a&&v?v:i[h],a&&typeof _==typeof p||(T=o.bind&&a?Zo(p,vt):o.wrap&&a?oh(p):B&&Mr(p)?Xn(p):p,(o.sham||p&&p.sham||_&&_.sham)&&Hc(T,"sham",!0),Hc(H,h,T),B&&(xw(sh,u=C+"Prototype")||Hc(sh,u,{}),Hc(sh[u],h,p),o.real&&J&&(s||!J[h])&&Hc(J,h,p)))},Mg=Math.ceil,ai=Math.floor,Cx=Math.trunc||function(o){var i=+o;return(i>0?ai:Mg)(i)},Ug=function(o){var i=+o;return i!=i||i===0?0:Cx(i)},jg=Ug,Rx=Math.max,Ix=Math.min,Dw=function(o,i){var s=jg(o);return s<0?Rx(s+i,0):Ix(s,i)},Fg=Ug,xl=Math.min,Vg=function(o){return o>0?xl(Fg(o),9007199254740991):0},Dl=function(o){return Vg(o.length)},Bg=Rl,kw=Dw,Lw=Dl,pp=function(o){return function(i,s,a){var u,h=Bg(i),p=Lw(h),_=kw(a,p);if(o&&s!=s){for(;p>_;)if((u=h[_++])!=u)return!0}else for(;p>_;_++)if((o||_ in h)&&h[_]===s)return o||_||0;return!o&&-1}},yy={includes:pp(!0),indexOf:pp(!1)},mp=yy.includes;Kn({target:"Array",proto:!0,forced:kt(function(){return!Array(1).includes()})},{includes:function(o){return mp(this,o,arguments.length>1?arguments[1]:void 0)}});var Wu=Fu,uc=function(o){return Wu[o+"Prototype"]},Ax=uc("Array").includes,Ox=qo,Nx=Xs,Wg=Wi("match"),Hg=function(o){var i;return Ox(o)&&((i=o[Wg])!==void 0?!!i:Nx(o)=="RegExp")},Sy=TypeError,Mw={};Mw[Wi("toStringTag")]="z";var $g=String(Mw)==="[object z]",Px=$g,xx=dr,hr=Xs,Ss=Wi("toStringTag"),Dx=Object,kx=hr(function(){return arguments}())=="Arguments",kl=Px?hr:function(o){var i,s,a;return o===void 0?"Undefined":o===null?"Null":typeof(s=function(u,h){try{return u[h]}catch{}}(i=Dx(o),Ss))=="string"?s:kx?hr(i):(a=hr(i))=="Object"&&xx(i.callee)?"Arguments":a},Lx=kl,Ty=String,Oo=function(o){if(Lx(o)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return Ty(o)},by=Wi("match"),ah=Kn,gp=function(o){if(Hg(o))throw Sy("The method doesn't accept regular expressions");return o},_p=lp,Ep=Oo,ch=function(o){var i=/./;try{"/./"[o](i)}catch{try{return i[by]=!1,"/./"[o](i)}catch{}}return!1},Mx=Nt("".indexOf);ah({target:"String",proto:!0,forced:!ch("includes")},{includes:function(o){return!!~Mx(Ep(_p(this)),Ep(gp(o)),arguments.length>1?arguments[1]:void 0)}});var Ux=uc("String").includes,Uw=ni,jx=Ax,Fx=Ux,lh=Array.prototype,Hu=String.prototype,ot=rn(function(o){var i=o.includes;return o===lh||Uw(lh,o)&&i===lh.includes?jx:typeof o=="string"||o===Hu||Uw(Hu,o)&&i===Hu.includes?Fx:i}),ne={exports:{}},uh=Kn,zg=lc,No=Qo.f;uh({target:"Object",stat:!0,forced:Object.defineProperty!==No,sham:!zg},{defineProperty:No});var On=Fu.Object,Vx=ne.exports=function(o,i,s){return On.defineProperty(o,i,s)};On.defineProperty.sham&&(Vx.sham=!0);var Bx=rn(ne.exports),Wx=Xs,$c=Array.isArray||function(o){return Wx(o)=="Array"},Hx=TypeError,$x=Dg,zx=Qo,Gx=Uu,jw=function(o,i,s){var a=$x(i);a in o?zx.f(o,a,Gx(0,s)):o[a]=s},zc=dr,wy=ny,Kx=Nt(Function.toString);zc(wy.inspectSource)||(wy.inspectSource=function(o){return Kx(o)});var Fw=wy.inspectSource,qx=Nt,Yx=kt,dc=dr,Xx=kl,Jx=Fw,Vw=function(){},Qx=[],Bw=Js("Reflect","construct"),Gc=/^\s*(?:class|function)\b/,Zx=qx(Gc.exec),eD=!Gc.exec(Vw),Ms=function(o){if(!dc(o))return!1;try{return Bw(Vw,Qx,o),!0}catch{return!1}},Ww=function(o){if(!dc(o))return!1;switch(Xx(o)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return eD||!!Zx(Gc,Jx(o))}catch{return!0}};Ww.sham=!0;var Hw=!Bw||Yx(function(){var o;return Ms(Ms.call)||!Ms(Object)||!Ms(function(){o=!0})||o})?Ww:Ms,$w=$c,tD=Hw,nD=qo,zw=Wi("species"),Cy=Array,iD=function(o){var i;return $w(o)&&(i=o.constructor,(tD(i)&&(i===Cy||$w(i.prototype))||nD(i)&&(i=i[zw])===null)&&(i=void 0)),i===void 0?Cy:i},Gw=function(o,i){return new(iD(o))(i===0?0:i)},Ry=kt,vp=Vu,Gg=Wi("species"),rD=Kn,Kw=kt,sD=$c,Kc=qo,Iy=Al,$u=Dl,Po=function(o){if(o>9007199254740991)throw Hx("Maximum allowed index exceeded");return o},qw=jw,Yw=Gw,Xw=function(o){return vp>=51||!Ry(function(){var i=[];return(i.constructor={})[Gg]=function(){return{foo:1}},i[o](Boolean).foo!==1})},yp=Vu,qc=Wi("isConcatSpreadable"),Jw=yp>=51||!Kw(function(){var o=[];return o[qc]=!1,o.concat()[0]!==o}),oD=function(o){if(!Kc(o))return!1;var i=o[qc];return i!==void 0?!!i:sD(o)};rD({target:"Array",proto:!0,arity:1,forced:!Jw||!Xw("concat")},{concat:function(o){var i,s,a,u,h,p=Iy(this),_=Yw(p,0),v=0;for(i=-1,a=arguments.length;i<a;i++)if(oD(h=i===-1?p:arguments[i]))for(u=$u(h),Po(v+u),s=0;s<u;s++,v++)s in h&&qw(_,v,h[s]);else Po(v+1),qw(_,v++,h);return _.length=v,_}});var dh={},Kg={},qg=Xr,hs=Rl,Ay=yy.indexOf,Qw=Kg,Na=Nt([].push),Yg=function(o,i){var s,a=hs(o),u=0,h=[];for(s in a)!qg(Qw,s)&&qg(a,s)&&Na(h,s);for(;i.length>u;)qg(a,s=i[u++])&&(~Ay(h,s)||Na(h,s));return h},hh=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],zu=Yg,Zw=hh,Ts=Object.keys||function(o){return zu(o,Zw)},Oy=lc,aD=kg,cD=Qo,lD=Oa,Ny=Rl,uD=Ts;dh.f=Oy&&!aD?Object.defineProperties:function(o,i){lD(o);for(var s,a=Ny(i),u=uD(i),h=u.length,p=0;h>p;)cD.f(o,s=u[p++],a[s]);return o};var Ll,Py=Js("document","documentElement"),dD=xg,eC=eh("keys"),Ml=function(o){return eC[o]||(eC[o]=dD(o))},hD=Oa,fD=dh,Xg=hh,tC=Kg,pD=Py,mD=th,xy="prototype",Jg="script",Qg=Ml("IE_PROTO"),Dy=function(){},Zg=function(o){return"<"+Jg+">"+o+"</"+Jg+">"},ky=function(o){o.write(Zg("")),o.close();var i=o.parentWindow.Object;return o=null,i},Sp=function(){try{Ll=new ActiveXObject("htmlfile")}catch{}var o,i,s;Sp=typeof document<"u"?document.domain&&Ll?ky(Ll):(i=mD("iframe"),s="java"+Jg+":",i.style.display="none",pD.appendChild(i),i.src=String(s),(o=i.contentWindow.document).open(),o.write(Zg("document.F=Object")),o.close(),o.F):ky(Ll);for(var a=Xg.length;a--;)delete Sp[xy][Xg[a]];return Sp()};tC[Qg]=!0;var Tp=Object.create||function(o,i){var s;return o!==null?(Dy[xy]=hD(o),s=new Dy,Dy[xy]=null,s[Qg]=o):s=Sp(),i===void 0?s:fD.f(s,i)},Gu={},gD=Yg,nC=hh.concat("length","prototype");Gu.f=Object.getOwnPropertyNames||function(o){return gD(o,nC)};var Ly={},iC=Dw,rC=Dl,_D=jw,My=Array,sC=Math.max,e_=function(o,i,s){for(var a=rC(o),u=iC(i,a),h=iC(s===void 0?a:s,a),p=My(sC(h-u,0)),_=0;u<h;u++,_++)_D(p,_,o[u]);return p.length=_,p},ED=Xs,Uy=Rl,vn=Gu.f,vD=e_,oC=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];Ly.f=function(o){return oC&&ED(o)=="Window"?function(i){try{return vn(i)}catch{return vD(oC)}}(o):vn(Uy(o))};var Ul={};Ul.f=Object.getOwnPropertySymbols;var aC=Pe,bp=function(o,i,s,a){return a&&a.enumerable?o[i]=s:aC(o,i,s),o},yD=Qo,xo=function(o,i,s){return yD.f(o,i,s)},fh={},t_=Wi;fh.f=t_;var ph,mh,wp,Zs=Fu,jl=Xr,jy=fh,cC=Qo.f,Li=function(o){var i=Zs.Symbol||(Zs.Symbol={});jl(i,o)||cC(i,o,{value:jy.f(o)})},lC=ys,Fy=Js,uC=Wi,Vy=bp,n_=function(){var o=Fy("Symbol"),i=o&&o.prototype,s=i&&i.valueOf,a=uC("toPrimitive");i&&!i[a]&&Vy(i,a,function(u){return lC(s,this)},{arity:1})},Fl=kl,SD=$g?{}.toString:function(){return"[object "+Fl(this)+"]"},Vl=$g,dC=Qo.f,hC=Pe,By=Xr,TD=SD,fC=Wi("toStringTag"),gh=function(o,i,s,a){if(o){var u=s?o:o.prototype;By(u,fC)||dC(u,fC,{configurable:!0,value:i}),a&&!Vl&&hC(u,"toString",TD)}},pC=dr,Wy=Ci.WeakMap,bD=pC(Wy)&&/native code/.test(String(Wy)),Hy=Ci,mC=qo,eo=Pe,ea=Xr,$y=ny,wD=Ml,i_=Kg,Ku="Object already initialized",r_=Hy.TypeError,gC=Hy.WeakMap;if(bD||$y.state){var hc=$y.state||($y.state=new gC);hc.get=hc.get,hc.has=hc.has,hc.set=hc.set,ph=function(o,i){if(hc.has(o))throw r_(Ku);return i.facade=o,hc.set(o,i),i},mh=function(o){return hc.get(o)||{}},wp=function(o){return hc.has(o)}}else{var qu=wD("state");i_[qu]=!0,ph=function(o,i){if(ea(o,qu))throw r_(Ku);return i.facade=o,eo(o,qu,i),i},mh=function(o){return ea(o,qu)?o[qu]:{}},wp=function(o){return ea(o,qu)}}var Yc={set:ph,get:mh,has:wp,enforce:function(o){return wp(o)?mh(o):ph(o,{})},getterFor:function(o){return function(i){var s;if(!mC(i)||(s=mh(i)).type!==o)throw r_("Incompatible receiver, "+o+" required");return s}}},Cp=fp,CD=Gv,_C=Al,EC=Dl,s_=Gw,zy=Nt([].push),Pa=function(o){var i=o==1,s=o==2,a=o==3,u=o==4,h=o==6,p=o==7,_=o==5||h;return function(v,T,b,C){for(var N,x,B=_C(v),F=CD(B),H=Cp(T,b),J=EC(F),ee=0,se=C||s_,ye=i?se(v,J):s||p?se(v,0):void 0;J>ee;ee++)if((_||ee in F)&&(x=H(N=F[ee],ee,B),o))if(i)ye[ee]=x;else if(x)switch(o){case 3:return!0;case 5:return N;case 6:return ee;case 2:zy(ye,N)}else switch(o){case 4:return!1;case 7:zy(ye,N)}return h?-1:a||u?u:ye}},Gy={forEach:Pa(0),map:Pa(1),filter:Pa(2),some:Pa(3),every:Pa(4),find:Pa(5),findIndex:Pa(6),filterReject:Pa(7)},Yu=Kn,Ky=Ci,o_=ys,a_=Nt,Xu=lc,Bl=Aa,RD=kt,Ur=Xr,Xc=ni,c_=Oa,Rp=Rl,qy=Dg,vC=Oo,Yy=Uu,Ip=Tp,fc=Ts,Xy=Gu,l_=Ly,Jy=Ul,Ap=cp,Ju=Qo,Bt=dh,Op=$v,u_=bp,Qu=xo,Qy=eh,d_=Kg,Zy=xg,bs=Wi,ID=fh,AD=Li,yC=n_,OD=gh,e0=Yc,h_=Gy.forEach,to=Ml("hidden"),f_="Symbol",Do="prototype",Us=e0.set,p_=e0.getterFor(f_),xa=Object[Do],Jc=Ky.Symbol,m_=Jc&&Jc[Do],ND=Ky.TypeError,Zu=Ky.QObject,t0=Ap.f,Wl=Ju.f,SC=l_.f,PD=Op.f,TC=a_([].push),Qc=Qy("symbols"),_h=Qy("op-symbols"),bC=Qy("wks"),n0=!Zu||!Zu[Do]||!Zu[Do].findChild,Np=Xu&&RD(function(){return Ip(Wl({},"a",{get:function(){return Wl(this,"a",{value:7}).a}})).a!=7})?function(o,i,s){var a=t0(xa,i);a&&delete xa[i],Wl(o,i,s),a&&o!==xa&&Wl(xa,i,a)}:Wl,g_=function(o,i){var s=Qc[o]=Ip(m_);return Us(s,{type:f_,tag:o,description:i}),Xu||(s.description=i),s},Hl=function(o,i,s){o===xa&&Hl(_h,i,s),c_(o);var a=qy(i);return c_(s),Ur(Qc,a)?(s.enumerable?(Ur(o,to)&&o[to][a]&&(o[to][a]=!1),s=Ip(s,{enumerable:Yy(0,!1)})):(Ur(o,to)||Wl(o,to,Yy(1,{})),o[to][a]=!0),Np(o,a,s)):Wl(o,a,s)},Pp=function(o,i){c_(o);var s=Rp(i),a=fc(s).concat(s0(s));return h_(a,function(u){Xu&&!o_(i0,s,u)||Hl(o,u,s[u])}),o},i0=function(o){var i=qy(o),s=o_(PD,this,i);return!(this===xa&&Ur(Qc,i)&&!Ur(_h,i))&&(!(s||!Ur(this,i)||!Ur(Qc,i)||Ur(this,to)&&this[to][i])||s)},r0=function(o,i){var s=Rp(o),a=qy(i);if(s!==xa||!Ur(Qc,a)||Ur(_h,a)){var u=t0(s,a);return!u||!Ur(Qc,a)||Ur(s,to)&&s[to][a]||(u.enumerable=!0),u}},xp=function(o){var i=SC(Rp(o)),s=[];return h_(i,function(a){Ur(Qc,a)||Ur(d_,a)||TC(s,a)}),s},s0=function(o){var i=o===xa,s=SC(i?_h:Rp(o)),a=[];return h_(s,function(u){!Ur(Qc,u)||i&&!Ur(xa,u)||TC(a,Qc[u])}),a};Bl||(Jc=function(){if(Xc(m_,this))throw ND("Symbol is not a constructor");var o=arguments.length&&arguments[0]!==void 0?vC(arguments[0]):void 0,i=Zy(o),s=function(a){this===xa&&o_(s,_h,a),Ur(this,to)&&Ur(this[to],i)&&(this[to][i]=!1),Np(this,i,Yy(1,a))};return Xu&&n0&&Np(xa,i,{configurable:!0,set:s}),g_(i,o)},u_(m_=Jc[Do],"toString",function(){return p_(this).tag}),u_(Jc,"withoutSetter",function(o){return g_(Zy(o),o)}),Op.f=i0,Ju.f=Hl,Bt.f=Pp,Ap.f=r0,Xy.f=l_.f=xp,Jy.f=s0,ID.f=function(o){return g_(bs(o),o)},Xu&&Qu(m_,"description",{configurable:!0,get:function(){return p_(this).description}})),Yu({global:!0,constructor:!0,wrap:!0,forced:!Bl,sham:!Bl},{Symbol:Jc}),h_(fc(bC),function(o){AD(o)}),Yu({target:f_,stat:!0,forced:!Bl},{useSetter:function(){n0=!0},useSimple:function(){n0=!1}}),Yu({target:"Object",stat:!0,forced:!Bl,sham:!Xu},{create:function(o,i){return i===void 0?Ip(o):Pp(Ip(o),i)},defineProperty:Hl,defineProperties:Pp,getOwnPropertyDescriptor:r0}),Yu({target:"Object",stat:!0,forced:!Bl},{getOwnPropertyNames:xp}),yC(),OD(Jc,f_),d_[to]=!0;var Da=Aa&&!!Symbol.for&&!!Symbol.keyFor,ed=Kn,xD=Js,wC=Xr,DD=Oo,CC=eh,kD=Da,o0=CC("string-to-symbol-registry"),LD=CC("symbol-to-string-registry");ed({target:"Symbol",stat:!0,forced:!kD},{for:function(o){var i=DD(o);if(wC(o0,i))return o0[i];var s=xD("Symbol")(i);return o0[i]=s,LD[s]=i,s}});var MD=Kn,UD=Xr,jD=Qd,FD=Zd,VD=Da,RC=eh("symbol-to-string-registry");MD({target:"Symbol",stat:!0,forced:!VD},{keyFor:function(o){if(!jD(o))throw TypeError(FD(o)+" is not a symbol");if(UD(RC,o))return RC[o]}});var a0=Nt([].slice),c0=$c,IC=dr,AC=Xs,BD=Oo,OC=Nt([].push),NC=Kn,PC=Js,xC=hn,WD=ys,Dp=Nt,DC=kt,kC=dr,ko=Qd,LC=a0,HD=function(o){if(IC(o))return o;if(c0(o)){for(var i=o.length,s=[],a=0;a<i;a++){var u=o[a];typeof u=="string"?OC(s,u):typeof u!="number"&&AC(u)!="Number"&&AC(u)!="String"||OC(s,BD(u))}var h=s.length,p=!0;return function(_,v){if(p)return p=!1,v;if(c0(this))return v;for(var T=0;T<h;T++)if(s[T]===_)return v}}},$D=Aa,MC=String,$l=PC("JSON","stringify"),__=Dp(/./.exec),UC=Dp("".charAt),zD=Dp("".charCodeAt),l0=Dp("".replace),GD=Dp(1 .toString),KD=/[\uD800-\uDFFF]/g,jC=/^[\uD800-\uDBFF]$/,FC=/^[\uDC00-\uDFFF]$/,VC=!$D||DC(function(){var o=PC("Symbol")();return $l([o])!="[null]"||$l({a:o})!="{}"||$l(Object(o))!="{}"}),BC=DC(function(){return $l("\uDF06\uD834")!=='"\\udf06\\ud834"'||$l("\uDEAD")!=='"\\udead"'}),qD=function(o,i){var s=LC(arguments),a=HD(i);if(kC(a)||o!==void 0&&!ko(o))return s[1]=function(u,h){if(kC(a)&&(h=WD(a,this,MC(u),h)),!ko(h))return h},xC($l,null,s)},YD=function(o,i,s){var a=UC(s,i-1),u=UC(s,i+1);return __(jC,o)&&!__(FC,u)||__(FC,o)&&!__(jC,a)?"\\u"+GD(zD(o,0),16):o};$l&&NC({target:"JSON",stat:!0,arity:3,forced:VC||BC},{stringify:function(o,i,s){var a=LC(arguments),u=xC(VC?qD:$l,null,a);return BC&&typeof u=="string"?l0(u,KD,YD):u}});var WC=Ul,XD=Al;Kn({target:"Object",stat:!0,forced:!Aa||kt(function(){WC.f(1)})},{getOwnPropertySymbols:function(o){var i=WC.f;return i?i(XD(o)):[]}}),Li("asyncIterator"),Li("hasInstance"),Li("isConcatSpreadable"),Li("iterator"),Li("match"),Li("matchAll"),Li("replace"),Li("search"),Li("species"),Li("split");var JD=n_;Li("toPrimitive"),JD();var QD=Js,ZD=gh;Li("toStringTag"),ZD(QD("Symbol"),"Symbol"),Li("unscopables"),gh(Ci.JSON,"JSON",!0);var td,HC,$C,ek=Fu.Symbol,Eh={},u0=lc,tk=Xr,E_=Function.prototype,zC=u0&&Object.getOwnPropertyDescriptor,d0=tk(E_,"name"),GC={EXISTS:d0,PROPER:d0&&(function(){}).name==="something",CONFIGURABLE:d0&&(!u0||u0&&zC(E_,"name").configurable)},nk=!kt(function(){function o(){}return o.prototype.constructor=null,Object.getPrototypeOf(new o)!==o.prototype}),ik=Xr,rk=dr,sk=Al,ok=nk,KC=Ml("IE_PROTO"),v_=Object,ak=v_.prototype,vh=ok?v_.getPrototypeOf:function(o){var i=sk(o);if(ik(i,KC))return i[KC];var s=i.constructor;return rk(s)&&i instanceof s?s.prototype:i instanceof v_?ak:null},ck=kt,lk=dr,uk=qo,dk=Tp,qC=vh,hk=bp,h0=Wi("iterator"),YC=!1;[].keys&&("next"in($C=[].keys())?(HC=qC(qC($C)))!==Object.prototype&&(td=HC):YC=!0);var fk=!uk(td)||ck(function(){var o={};return td[h0].call(o)!==o});lk((td=fk?{}:dk(td))[h0])||hk(td,h0,function(){return this});var XC={IteratorPrototype:td,BUGGY_SAFARI_ITERATORS:YC},pk=XC.IteratorPrototype,mk=Tp,gk=Uu,_k=gh,Ek=Eh,vk=function(){return this},JC=Nt,QC=Yo,yk=dr,Sk=String,Tk=TypeError,bk=function(o,i,s){try{return JC(QC(Object.getOwnPropertyDescriptor(o,i)[s]))}catch{}},y_=Oa,wk=function(o){if(typeof o=="object"||yk(o))return o;throw Tk("Can't set "+Sk(o)+" as a prototype")},Ck=Object.setPrototypeOf||("__proto__"in{}?function(){var o,i=!1,s={};try{(o=bk(Object.prototype,"__proto__","set"))(s,[]),i=s instanceof Array}catch{}return function(a,u){return y_(a),wk(u),i?o(a,u):a.__proto__=u,a}}():void 0),Rk=Kn,Ik=ys,Ak=GC,Ok=function(o,i,s,a){var u=i+" Iterator";return o.prototype=mk(pk,{next:gk(+!a,s)}),_k(o,u,!1,!0),Ek[u]=vk,o},Nk=vh,Pk=gh,ZC=bp,eR=Eh,xk=XC,S_=Ak.PROPER,T_=xk.BUGGY_SAFARI_ITERATORS,b_=Wi("iterator"),f0="keys",yh="values",p0="entries",tR=function(){return this},m0=function(o,i,s,a,u,h,p){Ok(s,i,a);var _,v,T,b=function(J){if(J===u&&F)return F;if(!T_&&J in x)return x[J];switch(J){case f0:case yh:case p0:return function(){return new s(this,J)}}return function(){return new s(this)}},C=i+" Iterator",N=!1,x=o.prototype,B=x[b_]||x["@@iterator"]||u&&x[u],F=!T_&&B||b(u),H=i=="Array"&&x.entries||B;if(H&&(_=Nk(H.call(new o)))!==Object.prototype&&_.next&&(Pk(_,C,!0,!0),eR[C]=tR),S_&&u==yh&&B&&B.name!==yh&&(N=!0,F=function(){return Ik(B,this)}),u)if(v={values:b(yh),keys:h?F:b(f0),entries:b(p0)},p)for(T in v)(T_||N||!(T in x))&&ZC(x,T,v[T]);else Rk({target:i,proto:!0,forced:T_||N},v);return p&&x[b_]!==F&&ZC(x,b_,F,{name:u}),eR[i]=F,v},g0=function(o,i){return{value:o,done:i}},Dk=Rl,nR=Eh,iR=Yc;Qo.f;var w_=m0,kp=g0,rR="Array Iterator",kk=iR.set,_0=iR.getterFor(rR);w_(Array,"Array",function(o,i){kk(this,{type:rR,target:Dk(o),index:0,kind:i})},function(){var o=_0(this),i=o.target,s=o.kind,a=o.index++;return!i||a>=i.length?(o.target=void 0,kp(void 0,!0)):kp(s=="keys"?a:s=="values"?i[a]:[a,i[a]],!1)},"values"),nR.Arguments=nR.Array;var sR={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Lk=Ci,Mk=kl,Uk=Pe,oR=Eh,aR=Wi("toStringTag");for(var E0 in sR){var cR=Lk[E0],v0=cR&&cR.prototype;v0&&Mk(v0)!==aR&&Uk(v0,aR,E0),oR[E0]=oR.Array}var jk=ek,Fk=Wi,Vk=Qo.f,lR=Fk("metadata"),ta=Function.prototype;ta[lR]===void 0&&Vk(ta,lR,{value:null}),Li("dispose"),Li("metadata");var Bk=jk;Li("asyncDispose");var Wk=Nt,Zc=Js("Symbol"),un=Zc.keyFor,Hk=Wk(Zc.prototype.valueOf),js=Zc.isRegisteredSymbol||function(o){try{return un(Hk(o))!==void 0}catch{return!1}};Kn({target:"Symbol",stat:!0},{isRegisteredSymbol:js});for(var Cr=eh,uR=Js,zl=Nt,$k=Qd,zk=Wi,C_=uR("Symbol"),dR=C_.isWellKnownSymbol,hR=uR("Object","getOwnPropertyNames"),y0=zl(C_.prototype.valueOf),fR=Cr("wks"),ka=0,S0=hR(C_),R_=S0.length;ka<R_;ka++)try{var $i=S0[ka];$k(C_[$i])&&zk($i)}catch{}var er=function(o){if(dR&&dR(o))return!0;try{for(var i=y0(o),s=0,a=hR(fR),u=a.length;s<u;s++)if(fR[a[s]]==i)return!0}catch{}return!1};Kn({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:er}),Li("matcher"),Li("observable"),Kn({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:js}),Kn({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:er}),Li("metadataKey"),Li("patternMatch"),Li("replaceAll");var nd=rn(Bk),T0=Nt,Gk=Ug,Kk=Oo,qk=lp,Yk=T0("".charAt),pR=T0("".charCodeAt),mR=T0("".slice),Sh=function(o){return function(i,s){var a,u,h=Kk(qk(i)),p=Gk(s),_=h.length;return p<0||p>=_?o?"":void 0:(a=pR(h,p))<55296||a>56319||p+1===_||(u=pR(h,p+1))<56320||u>57343?o?Yk(h,p):a:o?mR(h,p,p+2):u-56320+(a-55296<<10)+65536}},b0={codeAt:Sh(!1),charAt:Sh(!0)}.charAt,Xk=Oo,w0=Yc,I_=m0,no=g0,id="String Iterator",Jk=w0.set,Qk=w0.getterFor(id);I_(String,"String",function(o){Jk(this,{type:id,string:Xk(o),index:0})},function(){var o,i=Qk(this),s=i.string,a=i.index;return a>=s.length?no(void 0,!0):(o=b0(s,a),i.index+=o.length,no(o,!1))});var gR=rn(fh.f("iterator"));function Lp(o){return Lp=typeof nd=="function"&&typeof gR=="symbol"?function(i){return typeof i}:function(i){return i&&typeof nd=="function"&&i.constructor===nd&&i!==nd.prototype?"symbol":typeof i},Lp(o)}var Zk=rn(fh.f("toPrimitive"));function _R(o){var i=function(s,a){if(Lp(s)!=="object"||s===null)return s;var u=s[Zk];if(u!==void 0){var h=u.call(s,a||"default");if(Lp(h)!=="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(s)}(o,"string");return Lp(i)==="symbol"?i:String(i)}function O(o,i,s){return(i=_R(i))in o?Bx(o,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[i]=s,o}var mn=uc("Array").keys,ER=kl,na=Xr,vR=ni,eL=mn,qn=Array.prototype,tL={DOMTokenList:!0,NodeList:!0},Fs=rn(function(o){var i=o.keys;return o===qn||vR(qn,o)&&i===qn.keys||na(tL,ER(o))?eL:i}),Mp=Zd,nL=TypeError,yR=e_,iL=Math.floor,C0=function(o,i){var s=o.length,a=iL(s/2);return s<8?rL(o,i):sL(o,C0(yR(o,0,a),i),C0(yR(o,a),i),i)},rL=function(o,i){for(var s,a,u=o.length,h=1;h<u;){for(a=h,s=o[h];a&&i(o[a-1],s)>0;)o[a]=o[--a];a!==h++&&(o[a]=s)}return o},sL=function(o,i,s,a){for(var u=i.length,h=s.length,p=0,_=0;p<u||_<h;)o[p+_]=p<u&&_<h?a(i[p],s[_])<=0?i[p++]:s[_++]:p<u?i[p++]:s[_++];return o},oL=C0,aL=kt,SR=function(o,i){var s=[][o];return!!s&&aL(function(){s.call(null,i||function(){return 1},1)})},TR=Il.match(/firefox\/(\d+)/i),cL=!!TR&&+TR[1],lL=/MSIE|Trident/.test(Il),bR=Il.match(/AppleWebKit\/(\d+)\./),R0=!!bR&&+bR[1],uL=Kn,A_=Nt,dL=Yo,hL=Al,wR=Dl,Qr=function(o,i){if(!delete o[i])throw nL("Cannot delete property "+Mp(i)+" of "+Mp(o))},Vs=Oo,I0=kt,fL=oL,pL=SR,A0=cL,mL=lL,CR=Vu,RR=R0,el=[],IR=A_(el.sort),gL=A_(el.push),_L=I0(function(){el.sort(void 0)}),AR=I0(function(){el.sort(null)}),OR=pL("sort"),NR=!I0(function(){if(CR)return CR<70;if(!(A0&&A0>3)){if(mL)return!0;if(RR)return RR<603;var o,i,s,a,u="";for(o=65;o<76;o++){switch(i=String.fromCharCode(o),o){case 66:case 69:case 70:case 72:s=3;break;case 68:case 71:s=4;break;default:s=2}for(a=0;a<47;a++)el.push({k:i+a,v:s})}for(el.sort(function(h,p){return p.v-h.v}),a=0;a<el.length;a++)i=el[a].k.charAt(0),u.charAt(u.length-1)!==i&&(u+=i);return u!=="DGBEFHACIJK"}});uL({target:"Array",proto:!0,forced:_L||!AR||!OR||!NR},{sort:function(o){o!==void 0&&dL(o);var i=hL(this);if(NR)return o===void 0?IR(i):IR(i,o);var s,a,u=[],h=wR(i);for(a=0;a<h;a++)a in i&&gL(u,i[a]);for(fL(u,function(p){return function(_,v){return v===void 0?-1:_===void 0?1:p!==void 0?+p(_,v)||0:Vs(_)>Vs(v)?1:-1}}(o)),s=wR(u),a=0;a<s;)i[a]=u[a++];for(;a<h;)Qr(i,a++);return i}});var EL=uc("Array").sort,vL=ni,yL=EL,Gl=Array.prototype,Up=rn(function(o){var i=o.sort;return o===Gl||vL(Gl,o)&&i===Gl.sort?yL:i}),SL=Js,TL=Gu,bL=Ul,wL=Oa,PR=Nt([].concat),xR=SL("Reflect","ownKeys")||function(o){var i=TL.f(wL(o)),s=bL.f;return s?PR(i,s(o)):i},DR=Xr,CL=xR,RL=cp,IL=Qo,AL=qo,OL=Pe,kR=Error,NL=Nt("".replace),PL=String(kR("zxcasd").stack),LR=/\n\s*at [^:]*:[^\n]*/,xL=LR.test(PL),DL=Uu,kL=!kt(function(){var o=Error("a");return!("stack"in o)||(Object.defineProperty(o,"stack",DL(1,7)),o.stack!==7)}),LL=Pe,ML=function(o,i){if(xL&&typeof o=="string"&&!kR.prepareStackTrace)for(;i--;)o=NL(o,LR,"");return o},UL=kL,MR=Error.captureStackTrace,jL=Eh,FL=Wi("iterator"),VL=Array.prototype,BL=kl,UR=Zv,WL=ju,HL=Eh,$L=Wi("iterator"),O_=function(o){if(!WL(o))return UR(o,$L)||UR(o,"@@iterator")||HL[BL(o)]},jR=ys,FR=Yo,zL=Oa,GL=Zd,KL=O_,O0=TypeError,qL=ys,VR=Oa,YL=Zv,io=fp,N0=ys,XL=Oa,JL=Zd,QL=function(o){return o!==void 0&&(jL.Array===o||VL[FL]===o)},ZL=Dl,N_=ni,eM=function(o,i){var s=arguments.length<2?KL(o):i;if(FR(s))return zL(jR(s,o));throw O0(GL(o)+" is not iterable")},P0=O_,BR=function(o,i,s){var a,u;VR(o);try{if(!(a=YL(o,"return"))){if(i==="throw")throw s;return s}a=qL(a,o)}catch(h){u=!0,a=h}if(i==="throw")throw s;if(u)throw a;return VR(a),s},tM=TypeError,P_=function(o,i){this.stopped=o,this.result=i},WR=P_.prototype,Th=function(o,i,s){var a,u,h,p,_,v,T,b=s&&s.that,C=!(!s||!s.AS_ENTRIES),N=!(!s||!s.IS_RECORD),x=!(!s||!s.IS_ITERATOR),B=!(!s||!s.INTERRUPTED),F=io(i,b),H=function(ee){return a&&BR(a,"normal",ee),new P_(!0,ee)},J=function(ee){return C?(XL(ee),B?F(ee[0],ee[1],H):F(ee[0],ee[1])):B?F(ee,H):F(ee)};if(N)a=o.iterator;else if(x)a=o;else{if(!(u=P0(o)))throw tM(JL(o)+" is not iterable");if(QL(u)){for(h=0,p=ZL(o);p>h;h++)if((_=J(o[h]))&&N_(WR,_))return _;return new P_(!1)}a=eM(o,u)}for(v=N?o.next:a.next;!(T=N0(v,a)).done;){try{_=J(T.value)}catch(ee){BR(a,"throw",ee)}if(typeof _=="object"&&_&&N_(WR,_))return _}return new P_(!1)},nM=Oo,iM=Kn,rM=ni,x0=vh,bh=Ck,sM=function(o,i,s){for(var a=CL(i),u=IL.f,h=RL.f,p=0;p<a.length;p++){var _=a[p];DR(o,_)||s&&DR(s,_)||u(o,_,h(i,_))}},HR=Tp,D0=Pe,k0=Uu,oM=function(o,i){AL(i)&&"cause"in i&&OL(o,"cause",i.cause)},aM=function(o,i,s,a){UL&&(MR?MR(o,i):LL(o,"stack",ML(s,a)))},cM=Th,lM=function(o,i){return o===void 0?arguments.length<2?"":i:nM(o)},uM=Wi("toStringTag"),x_=Error,dM=[].push,wh=function(o,i){var s,a=rM(L0,this);bh?s=bh(x_(),a?x0(this):L0):(s=a?this:HR(L0),D0(s,uM,"Error")),i!==void 0&&D0(s,"message",lM(i)),aM(s,wh,s.stack,1),arguments.length>2&&oM(s,arguments[2]);var u=[];return cM(o,dM,{that:u}),D0(s,"errors",u),s};bh?bh(wh,x_):sM(wh,x_,{name:!0});var L0=wh.prototype=HR(x_.prototype,{constructor:k0(1,wh),message:k0(1,""),name:k0(1,"AggregateError")});iM({global:!0,constructor:!0,arity:2},{AggregateError:wh});var jp,Ch,$R,M0,Fp=typeof process<"u"&&Xs(process)=="process",hM=Js,fM=xo,pM=lc,g=Wi("species"),S=ni,A=TypeError,U=Hw,q=Zd,re=TypeError,de=Oa,ge=function(o){if(U(o))return o;throw re(q(o)+" is not a constructor")},Re=ju,Ye=Wi("species"),Xe=function(o,i){var s,a=de(o).constructor;return a===void 0||Re(s=de(a)[Ye])?i:ge(s)},tt=TypeError,pt=/(?:ipad|iphone|ipod).*applewebkit/i.test(Il),_t=Ci,Ht=hn,yn=fp,Wt=dr,Nn=Xr,kn=kt,ro=Py,Bs=a0,so=th,Rr=function(o,i){if(o<i)throw tt("Not enough arguments");return o},La=pt,tl=Fp,D_=_t.setImmediate,mM=_t.clearImmediate,Soe=_t.process,gM=_t.Dispatch,Toe=_t.Function,b6=_t.MessageChannel,boe=_t.String,_M=0,U0={},w6="onreadystatechange";kn(function(){jp=_t.location});var EM=function(o){if(Nn(U0,o)){var i=U0[o];delete U0[o],i()}},vM=function(o){return function(){EM(o)}},C6=function(o){EM(o.data)},R6=function(o){_t.postMessage(boe(o),jp.protocol+"//"+jp.host)};D_&&mM||(D_=function(o){Rr(arguments.length,1);var i=Wt(o)?o:Toe(o),s=Bs(arguments,1);return U0[++_M]=function(){Ht(i,void 0,s)},Ch(_M),_M},mM=function(o){delete U0[o]},tl?Ch=function(o){Soe.nextTick(vM(o))}:gM&&gM.now?Ch=function(o){gM.now(vM(o))}:b6&&!La?(M0=($R=new b6).port2,$R.port1.onmessage=C6,Ch=yn(M0.postMessage,M0)):_t.addEventListener&&Wt(_t.postMessage)&&!_t.importScripts&&jp&&jp.protocol!=="file:"&&!kn(R6)?(Ch=R6,_t.addEventListener("message",C6,!1)):Ch=w6 in so("script")?function(o){ro.appendChild(so("script"))[w6]=function(){ro.removeChild(this),EM(o)}}:function(o){setTimeout(vM(o),0)});var I6={set:D_,clear:mM},A6=function(){this.head=null,this.tail=null};A6.prototype={add:function(o){var i={item:o,next:null},s=this.tail;s?s.next=i:this.head=i,this.tail=i},get:function(){var o=this.head;if(o)return(this.head=o.next)===null&&(this.tail=null),o.item}};var k_,yM,SM,TM,O6,N6=A6,woe=/ipad|iphone|ipod/i.test(Il)&&typeof Pebble<"u",Coe=/web0s(?!.*chrome)/i.test(Il),Vp=Ci,P6=fp,Roe=cp.f,bM=I6.set,Ioe=N6,Aoe=pt,Ooe=woe,Noe=Coe,wM=Fp,x6=Vp.MutationObserver||Vp.WebKitMutationObserver,D6=Vp.document,k6=Vp.process,zR=Vp.Promise,L6=Roe(Vp,"queueMicrotask"),CM=L6&&L6.value;if(!CM){var GR=new Ioe,KR=function(){var o,i;for(wM&&(o=k6.domain)&&o.exit();i=GR.get();)try{i()}catch(s){throw GR.head&&k_(),s}o&&o.enter()};Aoe||wM||Noe||!x6||!D6?!Ooe&&zR&&zR.resolve?((TM=zR.resolve(void 0)).constructor=zR,O6=P6(TM.then,TM),k_=function(){O6(KR)}):wM?k_=function(){k6.nextTick(KR)}:(bM=P6(bM,Vp),k_=function(){bM(KR)}):(yM=!0,SM=D6.createTextNode(""),new x6(KR).observe(SM,{characterData:!0}),k_=function(){SM.data=yM=!yM}),CM=function(o){GR.head||k_(),GR.add(o)}}var Poe=CM,L_=function(o){try{return{error:!1,value:o()}}catch(i){return{error:!0,value:i}}},Bp=Ci.Promise,M6=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",xoe=!M6&&!Fp&&typeof window=="object"&&typeof document=="object",Doe=Ci,j0=Bp,koe=dr,Loe=Nw,Moe=Fw,Uoe=Wi,joe=xoe,Foe=M6,RM=Vu,U6=j0&&j0.prototype,Voe=Uoe("species"),j6=!1,F6=koe(Doe.PromiseRejectionEvent),Boe=Loe("Promise",function(){var o=Moe(j0),i=o!==String(j0);if(!i&&RM===66||!U6.catch||!U6.finally)return!0;if(!RM||RM<51||!/native code/.test(o)){var s=new j0(function(u){u(1)}),a=function(u){u(function(){},function(){})};if((s.constructor={})[Voe]=a,!(j6=s.then(function(){})instanceof a))return!0}return!i&&(joe||Foe)&&!F6}),F0={CONSTRUCTOR:Boe,REJECTION_EVENT:F6,SUBCLASSING:j6},Kl={},V6=Yo,Woe=TypeError,Hoe=function(o){var i,s;this.promise=new o(function(a,u){if(i!==void 0||s!==void 0)throw Woe("Bad Promise constructor");i=a,s=u}),this.resolve=V6(i),this.reject=V6(s)};Kl.f=function(o){return new Hoe(o)};var IM,B6,$oe=Kn,qR=Fp,Rh=Ci,V0=ys,zoe=bp,Goe=gh,Koe=function(o){var i=hM(o);pM&&i&&!i[g]&&fM(i,g,{configurable:!0,get:function(){return this}})},qoe=Yo,AM=dr,Yoe=qo,Xoe=function(o,i){if(S(i,o))return o;throw A("Incorrect invocation")},Joe=Xe,W6=I6.set,OM=Poe,Qoe=function(o,i){try{arguments.length==1?console.error(o):console.error(o,i)}catch{}},Zoe=L_,eae=N6,H6=Yc,NM=Bp,$6=F0,z6=Kl,YR="Promise",G6=$6.CONSTRUCTOR,tae=$6.REJECTION_EVENT,PM=H6.getterFor(YR),nae=H6.set,iae=NM&&NM.prototype,B0=NM,xM=iae,K6=Rh.TypeError,DM=Rh.document,kM=Rh.process,LM=z6.f,rae=LM,sae=!!(DM&&DM.createEvent&&Rh.dispatchEvent),q6="unhandledrejection",Y6=function(o){var i;return!(!Yoe(o)||!AM(i=o.then))&&i},X6=function(o,i){var s,a,u,h=i.value,p=i.state==1,_=p?o.ok:o.fail,v=o.resolve,T=o.reject,b=o.domain;try{_?(p||(i.rejection===2&&aae(i),i.rejection=1),_===!0?s=h:(b&&b.enter(),s=_(h),b&&(b.exit(),u=!0)),s===o.promise?T(K6("Promise-chain cycle")):(a=Y6(s))?V0(a,s,v,T):v(s)):T(h)}catch(C){b&&!u&&b.exit(),T(C)}},J6=function(o,i){o.notified||(o.notified=!0,OM(function(){for(var s,a=o.reactions;s=a.get();)X6(s,o);o.notified=!1,i&&!o.rejection&&oae(o)}))},Q6=function(o,i,s){var a,u;sae?((a=DM.createEvent("Event")).promise=i,a.reason=s,a.initEvent(o,!1,!0),Rh.dispatchEvent(a)):a={promise:i,reason:s},!tae&&(u=Rh["on"+o])?u(a):o===q6&&Qoe("Unhandled promise rejection",s)},oae=function(o){V0(W6,Rh,function(){var i,s=o.facade,a=o.value;if(Z6(o)&&(i=Zoe(function(){qR?kM.emit("unhandledRejection",a,s):Q6(q6,s,a)}),o.rejection=qR||Z6(o)?2:1,i.error))throw i.value})},Z6=function(o){return o.rejection!==1&&!o.parent},aae=function(o){V0(W6,Rh,function(){var i=o.facade;qR?kM.emit("rejectionHandled",i):Q6("rejectionhandled",i,o.value)})},M_=function(o,i,s){return function(a){o(i,a,s)}},U_=function(o,i,s){o.done||(o.done=!0,s&&(o=s),o.value=i,o.state=2,J6(o,!0))},MM=function(o,i,s){if(!o.done){o.done=!0,s&&(o=s);try{if(o.facade===i)throw K6("Promise can't be resolved itself");var a=Y6(i);a?OM(function(){var u={done:!1};try{V0(a,i,M_(MM,u,o),M_(U_,u,o))}catch(h){U_(u,h,o)}}):(o.value=i,o.state=1,J6(o,!1))}catch(u){U_({done:!1},u,o)}}};G6&&(xM=(B0=function(o){Xoe(this,xM),qoe(o),V0(IM,this);var i=PM(this);try{o(M_(MM,i),M_(U_,i))}catch(s){U_(i,s)}}).prototype,(IM=function(o){nae(this,{type:YR,done:!1,notified:!1,parent:!1,reactions:new eae,rejection:!1,state:0,value:void 0})}).prototype=zoe(xM,"then",function(o,i){var s=PM(this),a=LM(Joe(this,B0));return s.parent=!0,a.ok=!AM(o)||o,a.fail=AM(i)&&i,a.domain=qR?kM.domain:void 0,s.state==0?s.reactions.add(a):OM(function(){X6(a,s)}),a.promise}),B6=function(){var o=new IM,i=PM(o);this.promise=o,this.resolve=M_(MM,i),this.reject=M_(U_,i)},z6.f=LM=function(o){return o===B0||o===void 0?new B6(o):rae(o)}),$oe({global:!0,constructor:!0,wrap:!0,forced:G6},{Promise:B0}),Goe(B0,YR,!1,!0),Koe(YR);var e8=Wi("iterator"),t8=!1;try{var cae=0,n8={next:function(){return{done:!!cae++}},return:function(){t8=!0}};n8[e8]=function(){return this},Array.from(n8,function(){throw 2})}catch{}var lae=Bp,uae=function(o,i){if(!i&&!t8)return!1;var s=!1;try{var a={};a[e8]=function(){return{next:function(){return{done:s=!0}}}},o(a)}catch{}return s},XR=F0.CONSTRUCTOR||!uae(function(o){lae.all(o).then(void 0,function(){})}),dae=ys,hae=Yo,fae=Kl,pae=L_,mae=Th;Kn({target:"Promise",stat:!0,forced:XR},{all:function(o){var i=this,s=fae.f(i),a=s.resolve,u=s.reject,h=pae(function(){var p=hae(i.resolve),_=[],v=0,T=1;mae(o,function(b){var C=v++,N=!1;T++,dae(p,i,b).then(function(x){N||(N=!0,_[C]=x,--T||a(_))},u)}),--T||a(_)});return h.error&&u(h.value),s.promise}});var gae=Kn,_ae=F0.CONSTRUCTOR;Bp&&Bp.prototype,gae({target:"Promise",proto:!0,forced:_ae,real:!0},{catch:function(o){return this.then(void 0,o)}});var Eae=ys,vae=Yo,yae=Kl,Sae=L_,Tae=Th;Kn({target:"Promise",stat:!0,forced:XR},{race:function(o){var i=this,s=yae.f(i),a=s.reject,u=Sae(function(){var h=vae(i.resolve);Tae(o,function(p){Eae(h,i,p).then(s.resolve,a)})});return u.error&&a(u.value),s.promise}});var bae=ys,wae=Kl;Kn({target:"Promise",stat:!0,forced:F0.CONSTRUCTOR},{reject:function(o){var i=wae.f(this);return bae(i.reject,void 0,o),i.promise}});var Cae=Oa,Rae=qo,Iae=Kl,i8=function(o,i){if(Cae(o),Rae(i)&&i.constructor===o)return i;var s=Iae.f(o);return(0,s.resolve)(i),s.promise},Aae=Kn,Oae=Bp,Nae=F0.CONSTRUCTOR,Pae=i8,xae=Js("Promise"),Dae=!Nae;Aae({target:"Promise",stat:!0,forced:!0},{resolve:function(o){return Pae(Dae&&this===xae?Oae:this,o)}});var kae=ys,Lae=Yo,Mae=Kl,Uae=L_,jae=Th;Kn({target:"Promise",stat:!0,forced:XR},{allSettled:function(o){var i=this,s=Mae.f(i),a=s.resolve,u=s.reject,h=Uae(function(){var p=Lae(i.resolve),_=[],v=0,T=1;jae(o,function(b){var C=v++,N=!1;T++,kae(p,i,b).then(function(x){N||(N=!0,_[C]={status:"fulfilled",value:x},--T||a(_))},function(x){N||(N=!0,_[C]={status:"rejected",reason:x},--T||a(_))})}),--T||a(_)});return h.error&&u(h.value),s.promise}});var Fae=ys,Vae=Yo,Bae=Js,Wae=Kl,Hae=L_,$ae=Th,r8="No one promise resolved";Kn({target:"Promise",stat:!0,forced:XR},{any:function(o){var i=this,s=Bae("AggregateError"),a=Wae.f(i),u=a.resolve,h=a.reject,p=Hae(function(){var _=Vae(i.resolve),v=[],T=0,b=1,C=!1;$ae(o,function(N){var x=T++,B=!1;b++,Fae(_,i,N).then(function(F){B||C||(C=!0,u(F))},function(F){B||C||(B=!0,v[x]=F,--b||h(new s(v,r8)))})}),--b||h(new s(v,r8))});return p.error&&h(p.value),a.promise}});var zae=Kn,UM=Bp,Gae=kt,Kae=Js,qae=dr,Yae=Xe,s8=i8,Xae=UM&&UM.prototype;zae({target:"Promise",proto:!0,real:!0,forced:!!UM&&Gae(function(){Xae.finally.call({then:function(){}},function(){})})},{finally:function(o){var i=Yae(this,Kae("Promise")),s=qae(o);return this.then(s?function(a){return s8(i,o()).then(function(){return a})}:o,s?function(a){return s8(i,o()).then(function(){throw a})}:o)}});var o8=Fu.Promise,le=rn(o8);const Jae=()=>{};function W0(){const o={promise:void 0,isResolved:!1,isRejected:!1,isFinished:!1,resolve:void 0,reject:void 0,cancel:Jae};return o.promise=new le((i,s)=>{o.resolve=a=>{o.isFinished||(o.isResolved=!0,o.isFinished=!0,i(a),o.value=a)},o.reject=a=>{o.isFinished||(o.isRejected=!0,o.isFinished=!0,s(a))}}),o}const JR=new Map,QR=new Map,ql=new Map;var tr,an;(function(o){o.WIN_10="Windows 10",o.WIN_81="Windows 8.1",o.WIN_8="Windows 8",o.WIN_7="Windows 7",o.WIN_VISTA="Windows Vista",o.WIN_SERVER_2003="Windows Server 2003",o.WIN_XP="Windows XP",o.WIN_2000="Windows 2000",o.ANDROID="Android",o.HARMONY_OS="HarmonyOS",o.OPEN_BSD="Open BSD",o.SUN_OS="Sun OS",o.LINUX="Linux",o.IOS="iOS",o.MAC_OS="Mac OS",o.QNX="QNX",o.UNIX="UNIX",o.BEOS="BeOS",o.OS_2="OS/2",o.SEARCH_BOT="Search Bot"})(tr||(tr={})),function(o){o.CHROME="Chrome",o.SAFARI="Safari",o.EDGE="Edge",o.FIREFOX="Firefox",o.OPERA="OPR",o.QQ="QQBrowser",o.WECHAT="MicroMessenger"}(an||(an={}));var jM={exports:{}};(function(o,i){(function(s,a){var u="function",h="undefined",p="object",_="string",v="major",T="model",b="name",C="type",N="vendor",x="version",B="architecture",F="console",H="mobile",J="tablet",ee="smarttv",se="wearable",ye="embedded",me="Amazon",ue="Apple",he="ASUS",pe="BlackBerry",Ve="Browser",Me="Chrome",wt="Firefox",zt="Google",si="Huawei",ji="LG",Fn="Microsoft",jo="Motorola",Ce="Opera",ke="Samsung",Ze="Sharp",yt="Sony",tn="Xiaomi",Fe="Zebra",L="Facebook",X="Chromium OS",ie="Mac OS",Ae=function(pi){for(var Fi={},Vn=0;Vn<pi.length;Vn++)Fi[pi[Vn].toUpperCase()]=pi[Vn];return Fi},Tt=function(pi,Fi){return typeof pi===_&&Mn(Fi).indexOf(Mn(pi))!==-1},Mn=function(pi){return pi.toLowerCase()},$r=function(pi,Fi){if(typeof pi===_)return pi=pi.replace(/^\s\s*/,""),typeof Fi===h?pi:pi.substring(0,350)},Fo=function(pi,Fi){for(var Vn,Vo,lu,mi,nn,mo,Jh=0;Jh<Fi.length&&!nn;){var ol=Fi[Jh],l9=Fi[Jh+1];for(Vn=Vo=0;Vn<ol.length&&!nn&&ol[Vn];)if(nn=ol[Vn++].exec(pi))for(lu=0;lu<l9.length;lu++)mo=nn[++Vo],typeof(mi=l9[lu])===p&&mi.length>0?mi.length===2?typeof mi[1]==u?this[mi[0]]=mi[1].call(this,mo):this[mi[0]]=mi[1]:mi.length===3?typeof mi[1]!==u||mi[1].exec&&mi[1].test?this[mi[0]]=mo?mo.replace(mi[1],mi[2]):a:this[mi[0]]=mo?mi[1].call(this,mo,mi[2]):a:mi.length===4&&(this[mi[0]]=mo?mi[3].call(this,mo.replace(mi[1],mi[2])):a):this[mi]=mo||a;Jh+=2}},md=function(pi,Fi){for(var Vn in Fi)if(typeof Fi[Vn]===p&&Fi[Vn].length>0){for(var Vo=0;Vo<Fi[Vn].length;Vo++)if(Tt(Fi[Vn][Vo],pi))return Vn==="?"?a:Vn}else if(Tt(Fi[Vn],pi))return Vn==="?"?a:Vn;return pi},EA={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},vA={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[x,[b,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[x,[b,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[b,x],[/opios[\/ ]+([\w\.]+)/i],[x,[b,Ce+" Mini"]],[/\bopr\/([\w\.]+)/i],[x,[b,Ce]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[b,x],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[x,[b,"UC"+Ve]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[x,[b,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[x,[b,"WeChat"]],[/konqueror\/([\w\.]+)/i],[x,[b,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[x,[b,"IE"]],[/yabrowser\/([\w\.]+)/i],[x,[b,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[b,/(.+)/,"$1 Secure "+Ve],x],[/\bfocus\/([\w\.]+)/i],[x,[b,wt+" Focus"]],[/\bopt\/([\w\.]+)/i],[x,[b,Ce+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[x,[b,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[x,[b,"Dolphin"]],[/coast\/([\w\.]+)/i],[x,[b,Ce+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[x,[b,"MIUI "+Ve]],[/fxios\/([-\w\.]+)/i],[x,[b,wt]],[/\bqihu|(qi?ho?o?|360)browser/i],[[b,"360 "+Ve]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[b,/(.+)/,"$1 "+Ve],x],[/(comodo_dragon)\/([\w\.]+)/i],[[b,/_/g," "],x],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[b,x],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[b],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[b,L],x],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[b,x],[/\bgsa\/([\w\.]+) .*safari\//i],[x,[b,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[x,[b,Me+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[b,Me+" WebView"],x],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[x,[b,"Android "+Ve]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[b,x],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[x,[b,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[x,b],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[b,[x,md,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[b,x],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[b,"Netscape"],x],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[x,[b,wt+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[b,x],[/(cobalt)\/([\w\.]+)/i],[b,[x,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[B,"amd64"]],[/(ia32(?=;))/i],[[B,Mn]],[/((?:i[346]|x)86)[;\)]/i],[[B,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[B,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[B,"armhf"]],[/windows (ce|mobile); ppc;/i],[[B,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[B,/ower/,"",Mn]],[/(sun4\w)[;\)]/i],[[B,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[B,Mn]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[T,[N,ke],[C,J]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[T,[N,ke],[C,H]],[/\((ip(?:hone|od)[\w ]*);/i],[T,[N,ue],[C,H]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[T,[N,ue],[C,J]],[/(macintosh);/i],[T,[N,ue]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[T,[N,Ze],[C,H]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[T,[N,si],[C,J]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[T,[N,si],[C,H]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[T,/_/g," "],[N,tn],[C,H]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[T,/_/g," "],[N,tn],[C,J]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[T,[N,"OPPO"],[C,H]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[T,[N,"Vivo"],[C,H]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[T,[N,"Realme"],[C,H]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[T,[N,jo],[C,H]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[T,[N,jo],[C,J]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[T,[N,ji],[C,J]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[T,[N,ji],[C,H]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[T,[N,"Lenovo"],[C,J]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[T,/_/g," "],[N,"Nokia"],[C,H]],[/(pixel c)\b/i],[T,[N,zt],[C,J]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[T,[N,zt],[C,H]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[T,[N,yt],[C,H]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[T,"Xperia Tablet"],[N,yt],[C,J]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[T,[N,"OnePlus"],[C,H]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[T,[N,me],[C,J]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[T,/(.+)/g,"Fire Phone $1"],[N,me],[C,H]],[/(playbook);[-\w\),; ]+(rim)/i],[T,N,[C,J]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[T,[N,pe],[C,H]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[T,[N,he],[C,J]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[T,[N,he],[C,H]],[/(nexus 9)/i],[T,[N,"HTC"],[C,J]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[N,[T,/_/g," "],[C,H]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[T,[N,"Acer"],[C,J]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[T,[N,"Meizu"],[C,H]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[N,T,[C,H]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[N,T,[C,J]],[/(surface duo)/i],[T,[N,Fn],[C,J]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[T,[N,"Fairphone"],[C,H]],[/(u304aa)/i],[T,[N,"AT&T"],[C,H]],[/\bsie-(\w*)/i],[T,[N,"Siemens"],[C,H]],[/\b(rct\w+) b/i],[T,[N,"RCA"],[C,J]],[/\b(venue[\d ]{2,7}) b/i],[T,[N,"Dell"],[C,J]],[/\b(q(?:mv|ta)\w+) b/i],[T,[N,"Verizon"],[C,J]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[T,[N,"Barnes & Noble"],[C,J]],[/\b(tm\d{3}\w+) b/i],[T,[N,"NuVision"],[C,J]],[/\b(k88) b/i],[T,[N,"ZTE"],[C,J]],[/\b(nx\d{3}j) b/i],[T,[N,"ZTE"],[C,H]],[/\b(gen\d{3}) b.+49h/i],[T,[N,"Swiss"],[C,H]],[/\b(zur\d{3}) b/i],[T,[N,"Swiss"],[C,J]],[/\b((zeki)?tb.*\b) b/i],[T,[N,"Zeki"],[C,J]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[N,"Dragon Touch"],T,[C,J]],[/\b(ns-?\w{0,9}) b/i],[T,[N,"Insignia"],[C,J]],[/\b((nxa|next)-?\w{0,9}) b/i],[T,[N,"NextBook"],[C,J]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[N,"Voice"],T,[C,H]],[/\b(lvtel\-)?(v1[12]) b/i],[[N,"LvTel"],T,[C,H]],[/\b(ph-1) /i],[T,[N,"Essential"],[C,H]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[T,[N,"Envizen"],[C,J]],[/\b(trio[-\w\. ]+) b/i],[T,[N,"MachSpeed"],[C,J]],[/\btu_(1491) b/i],[T,[N,"Rotor"],[C,J]],[/(shield[\w ]+) b/i],[T,[N,"Nvidia"],[C,J]],[/(sprint) (\w+)/i],[N,T,[C,H]],[/(kin\.[onetw]{3})/i],[[T,/\./g," "],[N,Fn],[C,H]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[T,[N,Fe],[C,J]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[T,[N,Fe],[C,H]],[/smart-tv.+(samsung)/i],[N,[C,ee]],[/hbbtv.+maple;(\d+)/i],[[T,/^/,"SmartTV"],[N,ke],[C,ee]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[N,ji],[C,ee]],[/(apple) ?tv/i],[N,[T,ue+" TV"],[C,ee]],[/crkey/i],[[T,Me+"cast"],[N,zt],[C,ee]],[/droid.+aft(\w)( bui|\))/i],[T,[N,me],[C,ee]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[T,[N,Ze],[C,ee]],[/(bravia[\w ]+)( bui|\))/i],[T,[N,yt],[C,ee]],[/(mitv-\w{5}) bui/i],[T,[N,tn],[C,ee]],[/Hbbtv.*(technisat) (.*);/i],[N,T,[C,ee]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[N,$r],[T,$r],[C,ee]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[C,ee]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[N,T,[C,F]],[/droid.+; (shield) bui/i],[T,[N,"Nvidia"],[C,F]],[/(playstation [345portablevi]+)/i],[T,[N,yt],[C,F]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[T,[N,Fn],[C,F]],[/((pebble))app/i],[N,T,[C,se]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[T,[N,ue],[C,se]],[/droid.+; (glass) \d/i],[T,[N,zt],[C,se]],[/droid.+; (wt63?0{2,3})\)/i],[T,[N,Fe],[C,se]],[/(quest( 2| pro)?)/i],[T,[N,L],[C,se]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[N,[C,ye]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[T,[C,H]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[T,[C,J]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[C,J]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[C,H]],[/(android[-\w\. ]{0,9});.+buil/i],[T,[N,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[x,[b,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[x,[b,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[b,x],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[x,b]],os:[[/microsoft (windows) (vista|xp)/i],[b,x],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[b,[x,md,EA]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[b,"Windows"],[x,md,EA]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[x,/_/g,"."],[b,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[b,ie],[x,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[x,b],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[b,x],[/\(bb(10);/i],[x,[b,pe]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[x,[b,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[x,[b,wt+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[x,[b,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[x,[b,"watchOS"]],[/crkey\/([\d\.]+)/i],[x,[b,Me+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[b,X],x],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[b,x],[/(sunos) ?([\w\.\d]*)/i],[[b,"Solaris"],x],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[b,x]]},qa=function(pi,Fi){if(typeof pi===p&&(Fi=pi,pi=a),!(this instanceof qa))return new qa(pi,Fi).getResult();var Vn=typeof s!==h&&s.navigator?s.navigator:a,Vo=pi||(Vn&&Vn.userAgent?Vn.userAgent:""),lu=Vn&&Vn.userAgentData?Vn.userAgentData:a,mi=Fi?function(nn,mo){var Jh={};for(var ol in nn)mo[ol]&&mo[ol].length%2==0?Jh[ol]=mo[ol].concat(nn[ol]):Jh[ol]=nn[ol];return Jh}(vA,Fi):vA;return this.getBrowser=function(){var nn={};return nn[b]=a,nn[x]=a,Fo.call(nn,Vo,mi.browser),nn[v]=function(mo){return typeof mo===_?mo.replace(/[^\d\.]/g,"").split(".")[0]:a}(nn[x]),Vn&&Vn.brave&&typeof Vn.brave.isBrave==u&&(nn[b]="Brave"),nn},this.getCPU=function(){var nn={};return nn[B]=a,Fo.call(nn,Vo,mi.cpu),nn},this.getDevice=function(){var nn={};return nn[N]=a,nn[T]=a,nn[C]=a,Fo.call(nn,Vo,mi.device),!nn[C]&&lu&&lu.mobile&&(nn[C]=H),nn[T]=="Macintosh"&&Vn&&typeof Vn.standalone!==h&&Vn.maxTouchPoints&&Vn.maxTouchPoints>2&&(nn[T]="iPad",nn[C]=J),nn},this.getEngine=function(){var nn={};return nn[b]=a,nn[x]=a,Fo.call(nn,Vo,mi.engine),nn},this.getOS=function(){var nn={};return nn[b]=a,nn[x]=a,Fo.call(nn,Vo,mi.os),!nn[b]&&lu&&lu.platform!="Unknown"&&(nn[b]=lu.platform.replace(/chrome os/i,X).replace(/macos/i,ie)),nn},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return Vo},this.setUA=function(nn){return Vo=typeof nn===_&&nn.length>350?$r(nn,350):nn,this},this.setUA(Vo),this};qa.VERSION="0.7.34",qa.BROWSER=Ae([b,x,v]),qa.CPU=Ae([B]),qa.DEVICE=Ae([T,N,C,F,H,ee,J,se,ye]),qa.ENGINE=qa.OS=Ae([b,x]),o.exports&&(i=o.exports=qa),i.UAParser=qa;var Xh=typeof s!==h&&(s.jQuery||s.Zepto);if(Xh&&!Xh.ua){var gE=new qa;Xh.ua=gE.getResult(),Xh.ua.get=function(){return gE.getUA()},Xh.ua.set=function(pi){gE.setUA(pi);var Fi=gE.getResult();for(var Vn in Fi)Xh.ua[Vn]=Fi[Vn]}}})(typeof window=="object"?window:ui)})(jM,jM.exports);const FM=new(rn(jM.exports));let rd=FM.getResult(),VM=null;function Zt(o){if(!VM){o&&FM.setUA(o),rd=FM.getResult();const i=function(h){if(h.engine.name==="Blink"&&h.browser.name!=="WeChat")return an.CHROME;switch(h.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return an.CHROME;case"Safari":case"Mobile Safari":return an.SAFARI;case"Edge":return an.EDGE;case"Firefox":return an.FIREFOX;case"QQBrowser":return an.QQ;case"Opera":return an.OPERA;case"WeChat":return an.WECHAT;default:return h.browser.name||""}}(rd),s=function(h){let p;return p=h.engine.name==="Blink"?h.engine.version||"":h.browser.version||"",p.split(".")[0]}(rd),a=function(h){return h.os.name==="Windows"?h.os.version?h.os.name+" "+h.os.version:h.os.name:h.os.name||""}(rd),u=rd.os.version;if(!(i&&s&&a&&u))return{name:i,version:s,os:a,osVersion:u};VM={name:i,version:s,os:a,osVersion:u}}return VM}function ZR(){return Zt().os}function a8(){const o=Zt();return"".concat(o.os," ").concat(o.osVersion)}function eI(){const o=Zt();return!!(rd.engine.name==="WebKit"&&o.os===tr.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&o.name!==an.SAFARI||ps()&&o.name!==an.SAFARI)}function Qae(){const o=Zt();if(eI()){if(o.os===tr.MAC_OS)return!0;if(o.os===tr.IOS){const i=rd.os.version&&rd.os.version.split(".");if(i&&Number(i[0])===14&&i[1]&&Number(i[1])>=3||i&&Number(i[0])>14)return!0}}return!1}function Zae(){return rd.engine.name==="WebKit"}function BM(){return Zt().name===an.CHROME}function fs(){return Zt().name===an.SAFARI}function jn(){return Zt().name===an.FIREFOX}function ps(){return Zt().os===tr.IOS}function WM(o){const i=Zt();return!(i.name!==an.CHROME||!i.osVersion)&&Number(i.version)>=o}function c8(o){const i=Zt();return!(i.name!==an.EDGE||!i.osVersion)&&Number(i.version)>=o}function l8(o){const i=Zt();return!(i.name!==an.OPERA||!i.osVersion)&&Number(i.version)>=o}function u8(){const o=Zt();return!(o.name!==an.CHROME||!o.osVersion)&&Number(o.version)<=90}function d8(){const o=Zt();if(o.os!==tr.IOS||!o.osVersion)return!1;const i=o.osVersion.split(".");return Number(i[0])<14||Number(i[0])===14&&Number(i[1])<=6}function j_(){const o=Zt();if(o.os!==tr.IOS||!o.osVersion)return!1;const i=o.osVersion.split(".");return Number(i[0])===15}function HM(){const o=Zt();if(o.os!==tr.IOS||!o.osVersion)return!1;const i=o.osVersion.split(".");return Number(i[0])===16}function h8(){const o=Zt();if(o.os!==tr.IOS||!o.osVersion)return!1;const i=o.osVersion.split(".");return Number(i[0])===15&&Number(i[1])>=1}function Yl(){return fs()&&navigator.maxTouchPoints>0}function f8(){return Zt().name===an.WECHAT}function p8(){return window.navigator.appVersion&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)!==null&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function Ih(){const o=Zt();return o.name===an.EDGE||o.name===an.SAFARI?!1:!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function tI(){return ZR()===tr.ANDROID}function H0(){const o=Zt();return tI()&&(o.name===an.CHROME||o.name===an.WECHAT||/chrome|chromium/i.test(navigator.userAgent))}var z;(function(o){o.UNEXPECTED_ERROR="UNEXPECTED_ERROR",o.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",o.TIMEOUT="TIMEOUT",o.INVALID_PARAMS="INVALID_PARAMS",o.NOT_READABLE="NOT_READABLE",o.NOT_SUPPORTED="NOT_SUPPORTED",o.INVALID_OPERATION="INVALID_OPERATION",o.OPERATION_ABORTED="OPERATION_ABORTED",o.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",o.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",o.ADD_CANDIDATE_FAILED="ADD_CANDIDATE_FAILED",o.DATACHANNEL_FAILED="DATACHANNEL_FAILED",o.NETWORK_ERROR="NETWORK_ERROR",o.NETWORK_TIMEOUT="NETWORK_TIMEOUT",o.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",o.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",o.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",o.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",o.ELECTRON_IS_NULL="ELECTRON_IS_NULL",o.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",o.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",o.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",o.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",o.PERMISSION_DENIED="PERMISSION_DENIED",o.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",o.TRACK_IS_DISABLED="TRACK_IS_DISABLED",o.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",o.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",o.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",o.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",o.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",o.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",o.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",o.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",o.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",o.UID_CONFLICT="UID_CONFLICT",o.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",o.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",o.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",o.INVALID_TRACK="INVALID_TRACK",o.SENDER_NOT_FOUND="SENDER_NOT_FOUND",o.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",o.SET_ANSWER_FAILED="SET_ANSWER_FAILED",o.ICE_FAILED="ICE_FAILED",o.PC_CLOSED="PC_CLOSED",o.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",o.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",o.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",o.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",o.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",o.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",o.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",o.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",o.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",o.INVALID_REMOTE_USER="INVALID_REMOTE_USER",o.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",o.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",o.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",o.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",o.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",o.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",o.WS_ABORT="WS_ABORT",o.WS_DISCONNECT="WS_DISCONNECT",o.WS_ERR="WS_ERR",o.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",o.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",o.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",o.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",o.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",o.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",o.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",o.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",o.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",o.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",o.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",o.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",o.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",o.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",o.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",o.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",o.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",o.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",o.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",o.INVALID_PLUGIN="INVALID_PLUGIN",o.DISCONNECT_P2P="DISCONNECT_P2P",o.INIT_WEBSOCKET_TIMEOUT="INIT_WEBSOCKET_TIMEOUT",o.CONVERTING_IMAGEDATA_TO_BLOB_FAILED="CONVERTING_IMAGEDATA_TO_BLOB_FAILED",o.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED="CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED",o.INIT_DATACHANNEL_TIMEOUT="INIT_DATACHANNEL_TIMEOUT",o.DATACHANNEL_CONNECTION_TIMEOUT="DATACHANNEL_CONNECTION_TIMEOUT",o.PROHIBITED_OPERATION="PROHIBITED_OPERATION",o.IMAGE_MODERATION_UPLOAD_FAILED="IMAGE_MODERATION_UPLOAD_FAILED"})(z||(z={}));let Ee=class extends Error{constructor(o){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",s=arguments.length>2?arguments[2]:void 0;super(i),O(this,"code",void 0),O(this,"message",void 0),O(this,"data",void 0),O(this,"name","AgoraRTCException"),this.code=o,this.message="AgoraRTCError ".concat(this.code,": ").concat(i),this.data=s}toString(){return this.data?"data: ".concat(JSON.stringify(this.data),`
`).concat(this.stack):"".concat(this.stack)}print(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error",i=arguments.length>1?arguments[1]:void 0;return o==="error"&&(i||console).error(this.toString()),o==="warning"&&(i||console).warn(this.toString()),this}throw(o){throw this.print("error",o),this}};function Wp(o,i){if(typeof o!="boolean")throw new Ee(z.INVALID_PARAMS,"Invalid ".concat(i,": The value is of the boolean type."))}function nr(o,i,s){if(!ot(s).call(s,o))throw new Ee(z.INVALID_PARAMS,"".concat(i," can only be set as ").concat(JSON.stringify(s)))}function Tn(o,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1e4;if(o<s||o>a||(!(arguments.length>4&&arguments[4]!==void 0)||arguments[4])&&!function(u){return typeof u=="number"&&u%1==0}(o))throw new Ee(z.INVALID_PARAMS,"invalid ".concat(i,": the value range is [").concat(s,", ").concat(a,"]. integer only"))}function $M(o,i){if(typeof o!="number"){if(!(o.min||o.max||o.ideal||o.exact))throw new Ee(z.INVALID_PARAMS,"".concat(i," is not a valid ConstrainLong"));o.min!==void 0&&Tn(o.min,"".concat(i,".min"),0,1/0),o.max!==void 0&&Tn(o.max,"".concat(i,".max"),1,1/0),o.exact!==void 0&&Tn(o.exact,"".concat(i,".exact"),1,1/0),o.ideal!==void 0&&Tn(o.ideal,"".concat(i,".ideal"),1,1/0)}else Tn(o,i,1,1/0)}function jr(o,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:255,u=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];if(o==null)throw new Ee(z.INVALID_PARAMS,"".concat(i||"param"," cannot be empty"));if(!m8(o,s,a,u))throw new Ee(z.INVALID_PARAMS,"Invalid ".concat(i||"string param",": Length of the string: [").concat(s,",").concat(a,"].").concat(u?" ASCII characters only.":""))}function sd(o,i){if(!Array.isArray(o))throw new Ee(z.INVALID_PARAMS,"".concat(i," should be an array"))}function Jn(o){return o==null}function m8(o){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:255,a=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];return typeof o=="string"&&o.length<=s&&o.length>=i&&(!a||function(u){if(typeof u!="string")return!1;for(let h=0;h<u.length;h+=1){const p=u.charCodeAt(h);if(p<0||p>255)return!1}return!0}(o))}function g8(o,i,s){if("getBigUint64"in DataView.prototype)return o.getBigUint64(i,s);const a=o.getUint32(i,s),u=o.getUint32(i+4,s),h=+!!s,p=+!s;return BigInt(a*p+u*h)<<BigInt(32)|BigInt(a*h+u*p)}function _8(o,i,s,a){if("setBigUint64"in DataView.prototype)return o.setBigUint64(i,s,a);const u=Number(s>>BigInt(32)),h=Number(s&BigInt(4294967295));a?(o.setUint32(i+4,u,a),o.setUint32(i,h,a)):(o.setUint32(i,u,a),o.setUint32(i+4,h,a))}var F_,nI;(function(o){o.COVERED="COVERED",o.POSITION="POSITION",o.SIZE="SIZE",o.STYLE="STYLE"})(F_||(F_={})),function(o){o.UNMOUNTED="UNMOUNTED",o.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT"}(nI||(nI={}));const E8=new class{constructor(){O(this,"_clientSize",null),O(this,"getClientWidth",()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth),O(this,"getClientHeight",()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight),O(this,"getStyle",o=>window.getComputedStyle(o,null)),O(this,"checkCssVisibleProperty",o=>{var i;let s=!0;const a=this.getStyle(o),{display:u,visibility:h,opacity:p,filter:_}=a;return(u==="none"||ot(i=["hidden","collapse"]).call(i,h)||Number(p)<.1)&&(s=!1),s?(_&&_.split(" ").filter(v=>{var T;const b=v.split("(")[0];return ot(T=["brightness","blur","opacity"]).call(T,b)}).map(v=>{const[T,b]=v.split(/\(|\)/);return[T,Number(b.match(/^[0-9\.]+/))]}).forEach(v=>{const[T,b]=v;switch(T){case"brightness":(b<.1||b>3)&&(s=!1);break;case"blur":b>3&&(s=!1);break;case"opacity":b<.1&&(s=!1)}}),s):!1}),O(this,"checkPropertyUpToAllParentNodes",(o,i)=>{let s=!0,a=!0;const u=p=>i(p);let h=o;for(;h&&a;)u(h)||(s=!1,a=!1),h=h.parentElement,h||(a=!1);return s}),O(this,"checkActualCssVisibleIncludeInherit",o=>this.checkPropertyUpToAllParentNodes(o,this.checkCssVisibleProperty)),O(this,"getSizeAboutClient",o=>{const{width:i,height:s,left:a,right:u,top:h,bottom:p}=o.getBoundingClientRect(),_=this.getClientWidth(),v=this.getClientHeight();return{width:i,height:s,left:a,right:u,top:h,bottom:p,clientWidth:_,clientHeight:v,clientMin:Math.min(_,v)}}),O(this,"checkActualSize",()=>{const{width:o,height:i,clientMin:s}=this._clientSize;return this.checkSizeIsVisible(o,i,s)}),O(this,"elementFromPoint",(o,i)=>document.elementFromPoint?document.elementFromPoint(o,i):null),O(this,"checkCoverForAPoint",(o,i,s)=>{const a=this.elementFromPoint(o,i);return a!==null&&a!==s}),O(this,"getPointPositionList",()=>{const{width:o,height:i,left:s,top:a}=this._clientSize,u=o/6,h=i/6,p=[],_=10**6;for(let v=0;v<5;v++)for(let T=0;T<5;T++){const b=(s*_+(v===0?.1:v===4?(u*v*_-1e5)/_:u*v)*_)/_,C=(a*_+(T===0?.1:T===4?(h*T*_-1e5)/_:h*T)*_)/_;p.push({x:b,y:C})}return[...p]}),O(this,"checkElementCover",o=>this.getPointPositionList().map(i=>this.checkCoverForAPoint(i.x,i.y,o)).filter(i=>!!i).length>6),O(this,"checkSizeIsVisible",(o,i,s)=>(o>50||s/o<=10)&&(i>50||s/i<=10)),O(this,"checkSizeOfPartInClient",()=>{const{left:o,right:i,top:s,bottom:a,clientHeight:u,clientWidth:h,clientMin:p}=this._clientSize;let _,v,T,b;if(o<0)_=0;else{if(!(o<h))return!1;_=o}if(i<0)return!1;if(v=i<h?i:h,s<0)T=0;else{if(!(s<u))return!1;T=s}if(a<0)return!1;b=a<u?a:u;const C=v-_,N=b-T;return this.checkSizeIsVisible(C,N,p)}),O(this,"returnHiddenResult",o=>(this._clientSize=null,{visible:!1,reason:o})),O(this,"checkOneElementVisible",o=>{if(o instanceof HTMLElement){if(this.checkElementIsMountedOnDom(o)){if(this.checkActualCssVisibleIncludeInherit(o)){if(this._clientSize=this.getSizeAboutClient(o),this.checkElementCover(o))return this.returnHiddenResult(F_.COVERED);{const i=this.checkActualSize(),s=this.checkSizeOfPartInClient();return i&&!s?this.returnHiddenResult(F_.POSITION):i?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(F_.SIZE)}}return this.returnHiddenResult(F_.STYLE)}return this.returnHiddenResult(nI.UNMOUNTED)}return this.returnHiddenResult(nI.INVALID_HTML_ELEMENT)}),O(this,"checkElementIsMountedOnDom",o=>this.checkPropertyUpToAllParentNodes(o,i=>i.nodeName.toUpperCase()!=="HTML"?i.parentElement!==null:!!document.documentElement))}};function zM(o){return new TextEncoder().encode(o)}const v8=function(o,i){const s=new Uint8Array(o.byteLength+i.byteLength);return s.set(new Uint8Array(o),0),s.set(new Uint8Array(i),o.byteLength),s},ece=async o=>{const i=function(h){const p=window.atob(h),_=new Uint8Array(new ArrayBuffer(p.length));for(let v=0;v<p.length;v+=1)_[v]=p.charCodeAt(v);return _}(`MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu
STM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+
HvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy
xQiYDz3vqa6bP29adwIDAQAB`),s=await window.crypto.subtle.importKey("spki",i,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),a=zM(o),u=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},s,a);return function(h){let p="";for(let _=0;_<h.length;_+=1)p+=String.fromCharCode(h[_]);return window.btoa(p)}(new Uint8Array(u))},tce=async o=>function(i,s){let a="";return new Uint8Array(i).forEach(u=>{a+=u.toString(s).padStart(2,"0")}),a}(await crypto.subtle.digest("SHA-256",zM(o)),16);class Hn{constructor(){O(this,"_events",{}),O(this,"addListener",this.on)}getListeners(i){return this._events[i]?this._events[i].map(s=>s.listener):[]}on(i,s){this._events[i]||(this._events[i]=[]);const a=this._events[i];this._indexOfListener(a,s)===-1&&a.push({listener:s,once:!1})}once(i,s){this._events[i]||(this._events[i]=[]);const a=this._events[i];this._indexOfListener(a,s)===-1&&a.push({listener:s,once:!0})}off(i,s){if(!this._events[i])return;const a=this._events[i],u=this._indexOfListener(a,s);u!==-1&&a.splice(u,1),this._events[i].length===0&&delete this._events[i]}removeAllListeners(i){i?delete this._events[i]:this._events={}}emit(i){this._events[i]||(this._events[i]=[]);const s=this._events[i].map(p=>p);for(var a=arguments.length,u=new Array(a>1?a-1:0),h=1;h<a;h++)u[h-1]=arguments[h];for(let p=0;p<s.length;p+=1){const _=s[p];_.once&&this.off(i,_.listener),_.listener.apply(this,u||[])}}safeEmit(i){for(var s=arguments.length,a=new Array(s>1?s-1:0),u=1;u<s;u++)a[u-1]=arguments[u];[...this._events[i]||[]].forEach(h=>{h.once&&this.off(i,h.listener);try{h.listener.apply(this,a)}catch(p){console.error("safeEmit event:".concat(i," error ").concat(p==null?void 0:p.toString()))}})}_indexOfListener(i,s){let a=i.length;for(;a--;)if(i[a].listener===s)return a;return-1}}let $0=null;function y8(){if($0)return $0;if(window.electron)return $0=window.electron;if(!window.require)return null;try{return $0=window.require("electron"),$0}catch{return null}}var Mi,Yn,GM,Pt,Dt,ir,ms,od;function S8(o){return Tn(o.timeout,"config.timeout",0,1e5),Tn(o.timeoutFactor,"config.timeoutFactor",0,100,!1),Tn(o.maxRetryCount,"config.maxRetryConfig",0,1/0),Tn(o.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}function V_(o){if(!Array.isArray(o)||o.length<1)return!1;try{o.forEach(i=>{if(!i.urls)throw Error()})}catch{return!1}return!0}function T8(o){return jr(o.turnServerURL,"turnServerURL"),jr(o.username,"username"),jr(o.password,"password"),o.udpport&&Tn(o.udpport,"udpport",1,99999,!0),o.forceturn&&Wp(o.forceturn,"forceturn"),o.security&&Wp(o.security,"security"),o.tcpport&&Tn(o.tcpport,"tcpport",1,99999,!0),!0}function b8(o){return o.level!==void 0&&nr(o.level,"level",[1,2,3]),o.delay!==void 0&&Tn(o.delay,"delay",0,3e3,!0),!0}function Qn(o,i){for(var s=arguments.length,a=new Array(s>2?s-2:0),u=2;u<s;u++)a[u-2]=arguments[u];return o.getListeners(i).length===0?le.reject(new Ee(z.UNEXPECTED_ERROR,"can not emit promise")):new le((h,p)=>{o.emit(i,...a,h,p)})}function bn(o,i){if(o.getListeners(i).length===0)return le.resolve();for(var s=arguments.length,a=new Array(s>2?s-2:0),u=2;u<s;u++)a[u-2]=arguments[u];return Qn(o,i,...a)}function oo(o,i){if(o.getListeners(i).length===0)return null;for(var s=arguments.length,a=new Array(s>2?s-2:0),u=2;u<s;u++)a[u-2]=arguments[u];return ad(o,i,...a)}function ad(o,i){let s=null,a=null;for(var u=arguments.length,h=new Array(u>2?u-2:0),p=2;p<u;p++)h[p-2]=arguments[p];if(o.emit(i,...h,_=>{s=_},_=>{a=_}),a!==null)throw a;if(s===null)throw new Ee(z.UNEXPECTED_ERROR,"handler is not sync");return s}(function(o){o.CREATE_CLIENT="createClient",o.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",o.SET_AREA="setArea",o.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",o.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",o.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",o.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",o.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",o.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",o.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",o.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",o.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",o.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",o.START_PROXY_SERVER="Client.startProxyServer",o.STOP_PROXY_SERVER="Client.stopProxyServer",o.SET_PROXY_SERVER="Client.setProxyServer",o.SET_TURN_SERVER="Client.setTurnServer",o.SET_CLIENT_ROLE="Client.setClientRole",o.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",o.ENABLE_DUAL_STREAM="Client.enableDualStream",o.DISABLE_DUAL_STREAM="Client.disableDualStream",o.JOIN="Client.join",o.LEAVE="Client.leave",o.PUBLISH="Client.publish",o.UNPUBLISH="Client.unpublish",o.SUBSCRIBE="Client.subscribe",o.MASS_SUBSCRIBE="Client.massSubscribe",o.MASS_UNSUBSCRIBE="Client.massUnsubscribe",o.UNSUBSCRIBE="Client.unsubscribe",o.RENEW_TOKEN="Client.renewToken",o.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",o.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",o.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",o.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",o.INSPECT_VIDEO_CONTENT="Client.inspectVideoContent",o.STOP_INSPECT_VIDEO_CONTENT="Client.stopInspectVideoContent",o.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",o.DATACHANNEL_FAILBACK="Client._datachannelFailback",o.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",o.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",o.START_LIVE_STREAMING="Client.startLiveStreaming",o.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",o.STOP_LIVE_STREAMING="Client.stopLiveStreaming",o.ADD_INJECT_STREAM_URL="Client.addInjectStreamUrl",o.REMOVE_INJECT_STREAM_URL="Client.removeInjectStreamUrl",o.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",o.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",o.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",o.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",o.SET_CONFIG_DISTRIBUTE="_configDistribute",o.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",o.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",o.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",o.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",o.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",o.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",o.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",o.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",o.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",o.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",o.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",o.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",o.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",o.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",o.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",o.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",o.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",o.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",o.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",o.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",o.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",o.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",o.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",o.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",o.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",o.STREAM_TYPE_CHANGE="streamTypeChange",o.CONNECTION_STATE_CHANGE="connectionStateChange",o.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage",o.IMAGE_MODERATION_UPLOAD="imageModerationUpload"})(Mi||(Mi={})),function(o){o.TRACER="tracer"}(Yn||(Yn={})),function(o){o[o.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",o[o.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",o[o.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY"}(GM||(GM={})),function(o){o.LEAVE="LEAVE",o.NETWORK_ERROR="NETWORK_ERROR",o.SERVER_ERROR="SERVER_ERROR",o.UID_BANNED="UID_BANNED",o.IP_BANNED="IP_BANNED",o.CHANNEL_BANNED="CHANNEL_BANNED",o.FALLBACK="FALLBACK",o.LICENSE_MISSING="LICENSE_MISSING",o.LICENSE_EXPIRED="LICENSE_EXPIRED",o.LICENSE_MINUTES_EXCEEDED="LICENSE_MINUTES_EXCEEDED",o.LICENSE_PERIOD_INVALID="LICENSE_PERIOD_INVALID",o.LICENSE_MULTIPLE_SDK_SERVICE="LICENSE_MULTIPLE_SDK_SERVICE",o.LICENSE_ILLEGAL="LICENSE_ILLEGAL",o.TOKEN_EXPIRE="TOKEN_EXPIRE"}(Pt||(Pt={})),function(o){o.CONNECTION_STATE_CHANGE="connection-state-change",o.MEDIA_RECONNECT_START="media-reconnect-start",o.MEDIA_RECONNECT_END="media-reconnect-end",o.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",o.USER_JOINED="user-joined",o.USER_LEAVED="user-left",o.USER_PUBLISHED="user-published",o.USER_UNPUBLISHED="user-unpublished",o.USER_INFO_UPDATED="user-info-updated",o.CLIENT_BANNED="client-banned",o.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",o.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",o.VOLUME_INDICATOR="volume-indicator",o.CRYPT_ERROR="crypt-error",o.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",o.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",o.NETWORK_QUALITY="network-quality",o.STREAM_TYPE_CHANGED="stream-type-changed",o.STREAM_FALLBACK="stream-fallback",o.RECEIVE_METADATA="receive-metadata",o.STREAM_MESSAGE="stream-message",o.LIVE_STREAMING_ERROR="live-streaming-error",o.LIVE_STREAMING_WARNING="live-streaming-warning",o.INJECT_STREAM_STATUS="stream-inject-status",o.EXCEPTION="exception",o.ERROR="error",o.P2P_LOST="p2p_lost",o.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",o.CHANNEL_FALLBACK_TO_WEBSOCKET="channel-fallback-to-websocket",o.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",o.PUBLISHED_USER_LIST="published-user-list",o.CONTENT_INSPECT_CONNECTION_STATE_CHANGE="content-inspect-connection-state-change",o.CONTENT_INSPECT_ERROR="content-inspect-error",o.CONTENT_INSPECT_RESULT="content-inspect-result",o.IMAGE_MODERATION_CONNECTION_STATE_CHANGE="image-moderation-connection-state-change"}(Dt||(Dt={})),function(o){o.NETWORK_ERROR="NETWORK_ERROR",o.SERVER_ERROR="SERVER_ERROR",o.MULTI_IP="MULTI_IP",o.TIMEOUT="TIMEOUT",o.OFFLINE="OFFLINE",o.LEAVE="LEAVE",o.P2P_FAILED="P2P_FAILED",o.FALLBACK="FALLBACK"}(ir||(ir={})),function(o){o.ONLINE="ONLINE",o.OFFLINE="OFFLINE"}(ms||(ms={})),function(o){o.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",o.ONLINE="ONLINE",o.OFFLINE="OFFLINE"}(od||(od={}));const Ii=new class extends Hn{set networkState(o){this.emit(od.NETWORK_STATE_CHANGE,o,this._networkState),o===ms.ONLINE?this.emit(od.ONLINE):o===ms.OFFLINE&&(this.onlineWaiter=new le(i=>{this.once(od.ONLINE,()=>{this.onlineWaiter=void 0,i(ms.ONLINE)})}),this.emit(od.OFFLINE)),this._networkState=o}get networkState(){return this._networkState}get isOnline(){return this._networkState===ms.ONLINE}constructor(){super(),O(this,"_moduleName","network-indicator"),O(this,"_networkState",ms.ONLINE),O(this,"onlineWaiter",void 0),window.addEventListener("online",()=>{this.networkState=ms.ONLINE}),window.addEventListener("offline",()=>{this.networkState=ms.OFFLINE})}};function w8(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function Hp(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?w8(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):w8(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}function KM(o,i){const s=o.indexOf(i);s!==-1&&o.splice(s,1)}function B_(o){const i=[];return o.forEach(s=>{i.indexOf(s)===-1&&i.push(s)}),i}function pc(o){le!==void 0?le.resolve().then(o):setTimeout(o,0)}function Ai(o){return JSON.parse(JSON.stringify(o))}function $p(o){try{return Ai(o)}catch{return o}}const C8={};function z0(o,i){C8[i]||(C8[i]=!0,o())}function iI(o){const i=window.atob(o),s=new Uint8Array(new ArrayBuffer(i.length));for(let a=0;a<i.length;a+=1)s[a]=i.charCodeAt(a);return s}function rI(o){let i="";for(let s=0;s<o.length;s+=1)i+=String.fromCharCode(o[s]);return window.btoa(i)}function Xl(o){return window.TextEncoder?new TextEncoder().encode(o).length:o.length}function R8(o){let i=0;return/DingTalk/i.test(navigator.userAgent)&&o.realFormData&&(o=o.realFormData),o.forEach(s=>{i+=typeof s=="string"?Xl(s):s.size}),i+138}function nce(o){const i=new Ee(z.TIMEOUT,"timeout");return new le((s,a)=>{window.setTimeout(()=>a(i),o)})}function xr(o){return new le(i=>{window.setTimeout(i,o)})}function wn(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:7,i=arguments.length>1?arguments[1]:void 0;const s=Math.random().toString(16).substr(2,o).toLowerCase();return s.length===o?"".concat(i).concat(s):"".concat(i).concat(s)+wn(o-s.length,"")}function qM(){return wn(32,"").toUpperCase()}const sI=()=>{},I8=new class{constructor(){O(this,"fnMap",new Map)}throttleByKey(o,i,s,a){for(var u=arguments.length,h=new Array(u>4?u-4:0),p=4;p<u;p++)h[p-4]=arguments[p];if(this.fnMap.has(i)){const _=this.fnMap.get(i);if(_.threshold!==s){_.fn(..._.args),clearTimeout(_.timer);const v=window.setTimeout(()=>{const T=this.fnMap.get(i);T&&T.fn(...T.args),this.fnMap.delete(i)},s);this.fnMap.set(i,{fn:o,threshold:s,timer:v,args:h,skipFn:a})}else _.skipFn&&_.skipFn(..._.args),this.fnMap.set(i,Hp(Hp({},_),{},{fn:o,args:h,skipFn:a}))}else{const _=window.setTimeout(()=>{const v=this.fnMap.get(i);v&&v.fn(...v.args),this.fnMap.delete(i)},s);this.fnMap.set(i,{fn:o,threshold:s,timer:_,args:h,skipFn:a})}}},A8=I8.throttleByKey.bind(I8);function O8(o){return typeof o=="object"&&o!==null&&!(o instanceof RegExp)}function YM(o,i){if(!O8(o)||!O8(i)||Array.isArray(o)&&!Array.isArray(i)||!Array.isArray(o)&&Array.isArray(i))return i;if(Array.isArray(i)&&Array.isArray(o)){const s=[...o];for(let a=0;a<i.length;a++)s[a]=YM(o[a],i[a]);return s}{const s=Hp({},o);for(const a in i)Object.prototype.hasOwnProperty.call(i,a)&&(Object.prototype.hasOwnProperty.call(o,a)?s[a]=YM(o[a],i[a]):s[a]=i[a]);return s}}let ice=1,oI=console;class fr{static setLogger(i){oI=i}constructor(i){O(this,"lockingPromise",le.resolve()),O(this,"locks",0),O(this,"name",""),O(this,"lockId",void 0),this.lockId=ice++,i&&(this.name=i),oI.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is created."))}get isLocked(){return this.locks>0}lock(i){let s;this.locks+=1,oI.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is locked, current queue ").concat(this.locks,". ").concat(typeof i=="string"?i:""));const a=new le(h=>{s=()=>{this.locks-=1,oI.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is not locked, current queue ").concat(this.locks,". ").concat(typeof i=="string"?i:"")),h()}}),u=this.lockingPromise.then(()=>s);return this.lockingPromise=this.lockingPromise.then(()=>a),u}}function W_(o,i){return function(s,a,u){const h=u.value;if(typeof h!="function")throw new Error("Cannot use mutex on object property.");return u.value=async function(){const p=this[i];if(!p)throw new Error("mutex property key ".concat(i," doesn't exist on ").concat(o));const _=await p.lock("From ".concat(o,".").concat(a));try{for(var v=arguments.length,T=new Array(v),b=0;b<v;b++)T[b]=arguments[b];return await h.apply(this,T)}finally{_()}},u}}const Oi={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function aI(o,i){const s=Math.floor(i.timeout*Math.pow(i.timeoutFactor,o));return Math.min(i.maxRetryTimeout,s)}function nl(o,i,s,a){const u=Object.assign({},Oi,a);let h=u.timeout;const p=async()=>{await function(T){return new le(b=>{window.setTimeout(b,T)})}(h),h*=u.timeoutFactor,h=Math.min(u.maxRetryTimeout,h)};let _=!1;const v=new le(async(T,b)=>{i=i||(()=>!1),s=s||(()=>!0);for(let C=0;C<u.maxRetryCount;C+=1){if(_)return b(new Ee(z.OPERATION_ABORTED));try{const N=await o();if(!i(N,C)||C+1===u.maxRetryCount)return T(N);await p()}catch(N){if(!s(N,C)||C+1===u.maxRetryCount)return b(N);await p()}}});return v.cancel=()=>_=!0,v}var rce=Yo,sce=Al,oce=Gv,ace=Dl,cce=TypeError,N8=function(o){return function(i,s,a,u){rce(s);var h=sce(i),p=oce(h),_=ace(h),v=o?_-1:0,T=o?-1:1;if(a<2)for(;;){if(v in p){u=p[v],v+=T;break}if(v+=T,o?v<0:_<=v)throw cce("Reduce of empty array with no initial value")}for(;o?v>=0:_>v;v+=T)v in p&&(u=s(u,p[v],v,h));return u}},lce={left:N8(!1),right:N8(!0)}.left;Kn({target:"Array",proto:!0,forced:!Fp&&Vu>79&&Vu<83||!SR("reduce")},{reduce:function(o){var i=arguments.length;return lce(this,o,i,i>1?arguments[1]:void 0)}});var uce=uc("Array").reduce,dce=ni,hce=uce,XM=Array.prototype,zp=rn(function(o){var i=o.reduce;return o===XM||dce(XM,o)&&i===XM.reduce?hce:i});let JM=class{constructor(o){O(this,"input",[]),O(this,"size",void 0),this.size=o}add(o){this.input.push(o),this.input.length>this.size&&this.input.splice(0,1)}mean(){var o;return this.input.length===0?0:zp(o=this.input).call(o,(i,s)=>i+s)/this.input.length}};var QM,ZM={exports:{}},P8=function(o,i){return function(){for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];return o.apply(i,s)}},fce=P8,e2=Object.prototype.toString,t2=(QM=Object.create(null),function(o){var i=e2.call(o);return QM[i]||(QM[i]=i.slice(8,-1).toLowerCase())});function Gp(o){return o=o.toLowerCase(),function(i){return t2(i)===o}}function n2(o){return Array.isArray(o)}function cI(o){return o===void 0}var x8=Gp("ArrayBuffer");function D8(o){return o!==null&&typeof o=="object"}function lI(o){if(t2(o)!=="object")return!1;var i=Object.getPrototypeOf(o);return i===null||i===Object.prototype}var pce=Gp("Date"),mce=Gp("File"),gce=Gp("Blob"),_ce=Gp("FileList");function i2(o){return e2.call(o)==="[object Function]"}var Ece=Gp("URLSearchParams");function r2(o,i){if(o!=null)if(typeof o!="object"&&(o=[o]),n2(o))for(var s=0,a=o.length;s<a;s++)i.call(null,o[s],s,o);else for(var u in o)Object.prototype.hasOwnProperty.call(o,u)&&i.call(null,o[u],u,o)}var s2,vce=(s2=typeof Uint8Array<"u"&&Object.getPrototypeOf(Uint8Array),function(o){return s2&&o instanceof s2}),Ws={isArray:n2,isArrayBuffer:x8,isBuffer:function(o){return o!==null&&!cI(o)&&o.constructor!==null&&!cI(o.constructor)&&typeof o.constructor.isBuffer=="function"&&o.constructor.isBuffer(o)},isFormData:function(o){var i="[object FormData]";return o&&(typeof FormData=="function"&&o instanceof FormData||e2.call(o)===i||i2(o.toString)&&o.toString()===i)},isArrayBufferView:function(o){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(o):o&&o.buffer&&x8(o.buffer)},isString:function(o){return typeof o=="string"},isNumber:function(o){return typeof o=="number"},isObject:D8,isPlainObject:lI,isUndefined:cI,isDate:pce,isFile:mce,isBlob:gce,isFunction:i2,isStream:function(o){return D8(o)&&i2(o.pipe)},isURLSearchParams:Ece,isStandardBrowserEnv:function(){return(typeof navigator>"u"||navigator.product!=="ReactNative"&&navigator.product!=="NativeScript"&&navigator.product!=="NS")&&typeof window<"u"&&typeof document<"u"},forEach:r2,merge:function o(){var i={};function s(h,p){lI(i[p])&&lI(h)?i[p]=o(i[p],h):lI(h)?i[p]=o({},h):n2(h)?i[p]=h.slice():i[p]=h}for(var a=0,u=arguments.length;a<u;a++)r2(arguments[a],s);return i},extend:function(o,i,s){return r2(i,function(a,u){o[u]=s&&typeof a=="function"?fce(a,s):a}),o},trim:function(o){return o.trim?o.trim():o.replace(/^\s+|\s+$/g,"")},stripBOM:function(o){return o.charCodeAt(0)===65279&&(o=o.slice(1)),o},inherits:function(o,i,s,a){o.prototype=Object.create(i.prototype,a),o.prototype.constructor=o,s&&Object.assign(o.prototype,s)},toFlatObject:function(o,i,s){var a,u,h,p={};i=i||{};do{for(u=(a=Object.getOwnPropertyNames(o)).length;u-- >0;)p[h=a[u]]||(i[h]=o[h],p[h]=!0);o=Object.getPrototypeOf(o)}while(o&&(!s||s(o,i))&&o!==Object.prototype);return i},kindOf:t2,kindOfTest:Gp,endsWith:function(o,i,s){o=String(o),(s===void 0||s>o.length)&&(s=o.length),s-=i.length;var a=o.indexOf(i,s);return a!==-1&&a===s},toArray:function(o){if(!o)return null;var i=o.length;if(cI(i))return null;for(var s=new Array(i);i-- >0;)s[i]=o[i];return s},isTypedArray:vce,isFileList:_ce},H_=Ws;function k8(o){return encodeURIComponent(o).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var L8=function(o,i,s){if(!i)return o;var a;if(s)a=s(i);else if(H_.isURLSearchParams(i))a=i.toString();else{var u=[];H_.forEach(i,function(p,_){p!=null&&(H_.isArray(p)?_+="[]":p=[p],H_.forEach(p,function(v){H_.isDate(v)?v=v.toISOString():H_.isObject(v)&&(v=JSON.stringify(v)),u.push(k8(_)+"="+k8(v))}))}),a=u.join("&")}if(a){var h=o.indexOf("#");h!==-1&&(o=o.slice(0,h)),o+=(o.indexOf("?")===-1?"?":"&")+a}return o},yce=Ws;function uI(){this.handlers=[]}uI.prototype.use=function(o,i,s){return this.handlers.push({fulfilled:o,rejected:i,synchronous:!!s&&s.synchronous,runWhen:s?s.runWhen:null}),this.handlers.length-1},uI.prototype.eject=function(o){this.handlers[o]&&(this.handlers[o]=null)},uI.prototype.forEach=function(o){yce.forEach(this.handlers,function(i){i!==null&&o(i)})};var M8,U8,Sce=uI,Tce=Ws;function $_(){if(U8)return M8;U8=1;var o=Ws;function i(u,h,p,_,v){Error.call(this),this.message=u,this.name="AxiosError",h&&(this.code=h),p&&(this.config=p),_&&(this.request=_),v&&(this.response=v)}o.inherits(i,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var s=i.prototype,a={};return["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach(function(u){a[u]={value:u}}),Object.defineProperties(i,a),Object.defineProperty(s,"isAxiosError",{value:!0}),i.from=function(u,h,p,_,v,T){var b=Object.create(s);return o.toFlatObject(u,b,function(C){return C!==Error.prototype}),i.call(b,u.message,h,p,_,v),b.name=u.name,T&&Object.assign(b,T),b},M8=i}var o2,j8,F8,V8,a2,B8,W8={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1};function H8(){if(j8)return o2;j8=1;var o=Ws;return o2=function(i,s){s=s||new FormData;var a=[];function u(h){return h===null?"":o.isDate(h)?h.toISOString():o.isArrayBuffer(h)||o.isTypedArray(h)?typeof Blob=="function"?new Blob([h]):Buffer.from(h):h}return function h(p,_){if(o.isPlainObject(p)||o.isArray(p)){if(a.indexOf(p)!==-1)throw Error("Circular reference detected in "+_);a.push(p),o.forEach(p,function(v,T){if(!o.isUndefined(v)){var b,C=_?_+"."+T:T;if(v&&!_&&typeof v=="object"){if(o.endsWith(T,"{}"))v=JSON.stringify(v);else if(o.endsWith(T,"[]")&&(b=o.toArray(v)))return void b.forEach(function(N){!o.isUndefined(N)&&s.append(C,u(N))})}h(v,C)}}),a.pop()}else s.append(_,u(p))}(i),s},o2}function bce(){if(V8)return F8;V8=1;var o=$_();return F8=function(i,s,a){var u=a.config.validateStatus;a.status&&u&&!u(a.status)?s(new o("Request failed with status code "+a.status,[o.ERR_BAD_REQUEST,o.ERR_BAD_RESPONSE][Math.floor(a.status/100)-4],a.config,a.request,a)):i(a)}}function wce(){if(B8)return a2;B8=1;var o=Ws;return a2=o.isStandardBrowserEnv()?{write:function(i,s,a,u,h,p){var _=[];_.push(i+"="+encodeURIComponent(s)),o.isNumber(a)&&_.push("expires="+new Date(a).toGMTString()),o.isString(u)&&_.push("path="+u),o.isString(h)&&_.push("domain="+h),p===!0&&_.push("secure"),document.cookie=_.join("; ")},read:function(i){var s=document.cookie.match(new RegExp("(^|;\\s*)("+i+")=([^;]*)"));return s?decodeURIComponent(s[3]):null},remove:function(i){this.write(i,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},a2}var c2,$8,z8,G8,K8,q8,Y8,X8,l2,J8,Q8,Z8,Cce=function(o){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(o)},Rce=function(o,i){return i?o.replace(/\/+$/,"")+"/"+i.replace(/^\/+/,""):o},eW=function(o,i){return o&&!Cce(i)?Rce(o,i):i};function Ice(){if($8)return c2;$8=1;var o=Ws,i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];return c2=function(s){var a,u,h,p={};return s&&o.forEach(s.split(`
`),function(_){if(h=_.indexOf(":"),a=o.trim(_.substr(0,h)).toLowerCase(),u=o.trim(_.substr(h+1)),a){if(p[a]&&i.indexOf(a)>=0)return;p[a]=a==="set-cookie"?(p[a]?p[a]:[]).concat([u]):p[a]?p[a]+", "+u:u}}),p},c2}function Ace(){if(G8)return z8;G8=1;var o=Ws;return z8=o.isStandardBrowserEnv()?function(){var i,s=/(msie|trident)/i.test(navigator.userAgent),a=document.createElement("a");function u(h){var p=h;return s&&(a.setAttribute("href",p),p=a.href),a.setAttribute("href",p),{href:a.href,protocol:a.protocol?a.protocol.replace(/:$/,""):"",host:a.host,search:a.search?a.search.replace(/^\?/,""):"",hash:a.hash?a.hash.replace(/^#/,""):"",hostname:a.hostname,port:a.port,pathname:a.pathname.charAt(0)==="/"?a.pathname:"/"+a.pathname}}return i=u(window.location.href),function(h){var p=o.isString(h)?u(h):h;return p.protocol===i.protocol&&p.host===i.host}}():function(){return!0}}function dI(){if(q8)return K8;q8=1;var o=$_();function i(s){o.call(this,s??"canceled",o.ERR_CANCELED),this.name="CanceledError"}return Ws.inherits(i,o,{__CANCEL__:!0}),K8=i}function Oce(){return X8||(X8=1,Y8=function(o){var i=/^([-+\w]{1,25})(:?\/\/|:)/.exec(o);return i&&i[1]||""}),Y8}function Nce(){if(J8)return l2;J8=1;var o=Ws,i=bce(),s=wce(),a=L8,u=eW,h=Ice(),p=Ace(),_=W8,v=$_(),T=dI(),b=Oce();return l2=function(C){return new Promise(function(N,x){var B,F=C.data,H=C.headers,J=C.responseType;function ee(){C.cancelToken&&C.cancelToken.unsubscribe(B),C.signal&&C.signal.removeEventListener("abort",B)}o.isFormData(F)&&o.isStandardBrowserEnv()&&delete H["Content-Type"];var se=new XMLHttpRequest;if(C.auth){var ye=C.auth.username||"",me=C.auth.password?unescape(encodeURIComponent(C.auth.password)):"";H.Authorization="Basic "+btoa(ye+":"+me)}var ue=u(C.baseURL,C.url);function he(){if(se){var Me="getAllResponseHeaders"in se?h(se.getAllResponseHeaders()):null,wt={data:J&&J!=="text"&&J!=="json"?se.response:se.responseText,status:se.status,statusText:se.statusText,headers:Me,config:C,request:se};i(function(zt){N(zt),ee()},function(zt){x(zt),ee()},wt),se=null}}if(se.open(C.method.toUpperCase(),a(ue,C.params,C.paramsSerializer),!0),se.timeout=C.timeout,"onloadend"in se?se.onloadend=he:se.onreadystatechange=function(){se&&se.readyState===4&&(se.status!==0||se.responseURL&&se.responseURL.indexOf("file:")===0)&&setTimeout(he)},se.onabort=function(){se&&(x(new v("Request aborted",v.ECONNABORTED,C,se)),se=null)},se.onerror=function(){x(new v("Network Error",v.ERR_NETWORK,C,se,se)),se=null},se.ontimeout=function(){var Me=C.timeout?"timeout of "+C.timeout+"ms exceeded":"timeout exceeded",wt=C.transitional||_;C.timeoutErrorMessage&&(Me=C.timeoutErrorMessage),x(new v(Me,wt.clarifyTimeoutError?v.ETIMEDOUT:v.ECONNABORTED,C,se)),se=null},o.isStandardBrowserEnv()){var pe=(C.withCredentials||p(ue))&&C.xsrfCookieName?s.read(C.xsrfCookieName):void 0;pe&&(H[C.xsrfHeaderName]=pe)}"setRequestHeader"in se&&o.forEach(H,function(Me,wt){F===void 0&&wt.toLowerCase()==="content-type"?delete H[wt]:se.setRequestHeader(wt,Me)}),o.isUndefined(C.withCredentials)||(se.withCredentials=!!C.withCredentials),J&&J!=="json"&&(se.responseType=C.responseType),typeof C.onDownloadProgress=="function"&&se.addEventListener("progress",C.onDownloadProgress),typeof C.onUploadProgress=="function"&&se.upload&&se.upload.addEventListener("progress",C.onUploadProgress),(C.cancelToken||C.signal)&&(B=function(Me){se&&(x(!Me||Me&&Me.type?new T:Me),se.abort(),se=null)},C.cancelToken&&C.cancelToken.subscribe(B),C.signal&&(C.signal.aborted?B():C.signal.addEventListener("abort",B))),F||(F=null);var Ve=b(ue);Ve&&["http","https","file"].indexOf(Ve)===-1?x(new v("Unsupported protocol "+Ve+":",v.ERR_BAD_REQUEST,C)):se.send(F)})},l2}var ws=Ws,tW=function(o,i){Tce.forEach(o,function(s,a){a!==i&&a.toUpperCase()===i.toUpperCase()&&(o[i]=s,delete o[a])})},nW=$_(),Pce=W8,xce=H8(),Dce={"Content-Type":"application/x-www-form-urlencoded"};function iW(o,i){!ws.isUndefined(o)&&ws.isUndefined(o["Content-Type"])&&(o["Content-Type"]=i)}var rW,hI={transitional:Pce,adapter:((typeof XMLHttpRequest<"u"||typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]")&&(rW=Nce()),rW),transformRequest:[function(o,i){if(tW(i,"Accept"),tW(i,"Content-Type"),ws.isFormData(o)||ws.isArrayBuffer(o)||ws.isBuffer(o)||ws.isStream(o)||ws.isFile(o)||ws.isBlob(o))return o;if(ws.isArrayBufferView(o))return o.buffer;if(ws.isURLSearchParams(o))return iW(i,"application/x-www-form-urlencoded;charset=utf-8"),o.toString();var s,a=ws.isObject(o),u=i&&i["Content-Type"];if((s=ws.isFileList(o))||a&&u==="multipart/form-data"){var h=this.env&&this.env.FormData;return xce(s?{"files[]":o}:o,h&&new h)}return a||u==="application/json"?(iW(i,"application/json"),function(p,_,v){if(ws.isString(p))try{return(_||JSON.parse)(p),ws.trim(p)}catch(T){if(T.name!=="SyntaxError")throw T}return(v||JSON.stringify)(p)}(o)):o}],transformResponse:[function(o){var i=this.transitional||hI.transitional,s=i&&i.silentJSONParsing,a=i&&i.forcedJSONParsing,u=!s&&this.responseType==="json";if(u||a&&ws.isString(o)&&o.length)try{return JSON.parse(o)}catch(h){if(u)throw h.name==="SyntaxError"?nW.from(h,nW.ERR_BAD_RESPONSE,this,null,this.response):h}return o}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Z8?Q8:(Z8=1,Q8=null)},validateStatus:function(o){return o>=200&&o<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};ws.forEach(["delete","get","head"],function(o){hI.headers[o]={}}),ws.forEach(["post","put","patch"],function(o){hI.headers[o]=ws.merge(Dce)});var sW,oW,u2=hI,kce=Ws,Lce=u2;function aW(){return oW?sW:(oW=1,sW=function(o){return!(!o||!o.__CANCEL__)})}var cW=Ws,d2=function(o,i,s){var a=this||Lce;return kce.forEach(s,function(u){o=u.call(a,o,i)}),o},Mce=aW(),Uce=u2,jce=dI();function h2(o){if(o.cancelToken&&o.cancelToken.throwIfRequested(),o.signal&&o.signal.aborted)throw new jce}var lW,uW,Ma=Ws,dW=function(o,i){i=i||{};var s={};function a(T,b){return Ma.isPlainObject(T)&&Ma.isPlainObject(b)?Ma.merge(T,b):Ma.isPlainObject(b)?Ma.merge({},b):Ma.isArray(b)?b.slice():b}function u(T){return Ma.isUndefined(i[T])?Ma.isUndefined(o[T])?void 0:a(void 0,o[T]):a(o[T],i[T])}function h(T){if(!Ma.isUndefined(i[T]))return a(void 0,i[T])}function p(T){return Ma.isUndefined(i[T])?Ma.isUndefined(o[T])?void 0:a(void 0,o[T]):a(void 0,i[T])}function _(T){return T in i?a(o[T],i[T]):T in o?a(void 0,o[T]):void 0}var v={url:h,method:h,data:h,baseURL:p,transformRequest:p,transformResponse:p,paramsSerializer:p,timeout:p,timeoutMessage:p,withCredentials:p,adapter:p,responseType:p,xsrfCookieName:p,xsrfHeaderName:p,onUploadProgress:p,onDownloadProgress:p,decompress:p,maxContentLength:p,maxBodyLength:p,beforeRedirect:p,transport:p,httpAgent:p,httpsAgent:p,cancelToken:p,socketPath:p,responseEncoding:p,validateStatus:_};return Ma.forEach(Object.keys(o).concat(Object.keys(i)),function(T){var b=v[T]||u,C=b(T);Ma.isUndefined(C)&&b!==_||(s[T]=C)}),s};function hW(){return uW?lW:(uW=1,lW={version:"0.27.2"})}var Fce=hW().version,Ah=$_(),f2={};["object","boolean","number","function","string","symbol"].forEach(function(o,i){f2[o]=function(s){return typeof s===o||"a"+(i<1?"n ":" ")+o}});var fW={};f2.transitional=function(o,i,s){function a(u,h){return"[Axios v"+Fce+"] Transitional option '"+u+"'"+h+(s?". "+s:"")}return function(u,h,p){if(o===!1)throw new Ah(a(h," has been removed"+(i?" in "+i:"")),Ah.ERR_DEPRECATED);return i&&!fW[h]&&(fW[h]=!0,console.warn(a(h," has been deprecated since v"+i+" and will be removed in the near future"))),!o||o(u,h,p)}};var pW,mW,gW,_W,EW,vW,Vce={assertOptions:function(o,i,s){if(typeof o!="object")throw new Ah("options must be an object",Ah.ERR_BAD_OPTION_VALUE);for(var a=Object.keys(o),u=a.length;u-- >0;){var h=a[u],p=i[h];if(p){var _=o[h],v=_===void 0||p(_,h,o);if(v!==!0)throw new Ah("option "+h+" must be "+v,Ah.ERR_BAD_OPTION_VALUE)}else if(s!==!0)throw new Ah("Unknown option "+h,Ah.ERR_BAD_OPTION)}},validators:f2},yW=Ws,Bce=L8,SW=Sce,TW=function(o){return h2(o),o.headers=o.headers||{},o.data=d2.call(o,o.data,o.headers,o.transformRequest),o.headers=cW.merge(o.headers.common||{},o.headers[o.method]||{},o.headers),cW.forEach(["delete","get","head","post","put","patch","common"],function(i){delete o.headers[i]}),(o.adapter||Uce.adapter)(o).then(function(i){return h2(o),i.data=d2.call(o,i.data,i.headers,o.transformResponse),i},function(i){return Mce(i)||(h2(o),i&&i.response&&(i.response.data=d2.call(o,i.response.data,i.response.headers,o.transformResponse))),Promise.reject(i)})},fI=dW,Wce=eW,bW=Vce,z_=bW.validators;function G_(o){this.defaults=o,this.interceptors={request:new SW,response:new SW}}G_.prototype.request=function(o,i){typeof o=="string"?(i=i||{}).url=o:i=o||{},(i=fI(this.defaults,i)).method?i.method=i.method.toLowerCase():this.defaults.method?i.method=this.defaults.method.toLowerCase():i.method="get";var s=i.transitional;s!==void 0&&bW.assertOptions(s,{silentJSONParsing:z_.transitional(z_.boolean),forcedJSONParsing:z_.transitional(z_.boolean),clarifyTimeoutError:z_.transitional(z_.boolean)},!1);var a=[],u=!0;this.interceptors.request.forEach(function(C){typeof C.runWhen=="function"&&C.runWhen(i)===!1||(u=u&&C.synchronous,a.unshift(C.fulfilled,C.rejected))});var h,p=[];if(this.interceptors.response.forEach(function(C){p.push(C.fulfilled,C.rejected)}),!u){var _=[TW,void 0];for(Array.prototype.unshift.apply(_,a),_=_.concat(p),h=Promise.resolve(i);_.length;)h=h.then(_.shift(),_.shift());return h}for(var v=i;a.length;){var T=a.shift(),b=a.shift();try{v=T(v)}catch(C){b(C);break}}try{h=TW(v)}catch(C){return Promise.reject(C)}for(;p.length;)h=h.then(p.shift(),p.shift());return h},G_.prototype.getUri=function(o){o=fI(this.defaults,o);var i=Wce(o.baseURL,o.url);return Bce(i,o.params,o.paramsSerializer)},yW.forEach(["delete","get","head","options"],function(o){G_.prototype[o]=function(i,s){return this.request(fI(s||{},{method:o,url:i,data:(s||{}).data}))}}),yW.forEach(["post","put","patch"],function(o){function i(s){return function(a,u,h){return this.request(fI(h||{},{method:o,headers:s?{"Content-Type":"multipart/form-data"}:{},url:a,data:u}))}}G_.prototype[o]=i(),G_.prototype[o+"Form"]=i(!0)});var wW=Ws,Hce=P8,pI=G_,$ce=dW,ia=function o(i){var s=new pI(i),a=Hce(pI.prototype.request,s);return wW.extend(a,pI.prototype,s),wW.extend(a,s),a.create=function(u){return o($ce(i,u))},a}(u2);ia.Axios=pI,ia.CanceledError=dI(),ia.CancelToken=function(){if(mW)return pW;mW=1;var o=dI();function i(s){if(typeof s!="function")throw new TypeError("executor must be a function.");var a;this.promise=new Promise(function(h){a=h});var u=this;this.promise.then(function(h){if(u._listeners){var p,_=u._listeners.length;for(p=0;p<_;p++)u._listeners[p](h);u._listeners=null}}),this.promise.then=function(h){var p,_=new Promise(function(v){u.subscribe(v),p=v}).then(h);return _.cancel=function(){u.unsubscribe(p)},_},s(function(h){u.reason||(u.reason=new o(h),a(u.reason))})}return i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.prototype.subscribe=function(s){this.reason?s(this.reason):this._listeners?this._listeners.push(s):this._listeners=[s]},i.prototype.unsubscribe=function(s){if(this._listeners){var a=this._listeners.indexOf(s);a!==-1&&this._listeners.splice(a,1)}},i.source=function(){var s;return{token:new i(function(a){s=a}),cancel:s}},pW=i}(),ia.isCancel=aW(),ia.VERSION=hW().version,ia.toFormData=H8(),ia.AxiosError=$_(),ia.Cancel=ia.CanceledError,ia.all=function(o){return Promise.all(o)},ia.spread=_W?gW:(_W=1,gW=function(o){return function(i){return o.apply(null,i)}}),ia.isAxiosError=function(){if(vW)return EW;vW=1;var o=Ws;return EW=function(i){return o.isObject(i)&&i.isAxiosError===!0}}(),ZM.exports=ia,ZM.exports.default=ia;var ao=rn(ZM.exports);function CW(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function RW(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?CW(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):CW(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}let mI,gI=0,p2=0;function m2(o,i,s,a){return new le((u,h)=>{i.responseType=i.responseType||"json",i.data&&!s?(i.data=JSON.stringify(i.data),gI+=Xl(i.data)):s&&(i.data.size?gI+=i.data.size:i.data instanceof FormData?gI+=R8(i.data):gI+=Xl(JSON.stringify(i.data))),i.headers=i.headers||{},i.headers["Content-Type"]=i.headers["Content-Type"]||"application/json",i.method="POST",i.url=o,ao.request(i).then(p=>{typeof p.data=="string"?p2+=Xl(p.data):p.data instanceof ArrayBuffer||p.data instanceof Uint8Array?p2+=p.data.byteLength:p2+=Xl(JSON.stringify(p.data)),a&&u({data:p.data,headers:p.headers}),u(p.data)}).catch(p=>{ao.isCancel(p)?h(new Ee(z.OPERATION_ABORTED,"cancel token canceled")):p.code==="ECONNABORTED"?h(new Ee(z.NETWORK_TIMEOUT,p.message)):p.response?h(new Ee(z.NETWORK_RESPONSE_ERROR,p.response.status)):h(new Ee(z.NETWORK_ERROR,p.message))})})}async function zce(o,i){const s=new Blob([i.data],{type:"buffer"});return await m2(o,RW(RW({},i),{},{data:s,headers:{"Content-Type":"application/octet-stream"}}),!0)}const Gce=()=>(mI||mI||(mI=(window.location.protocol.split(":")[0]||"").toUpperCase(),mI))==="HTTPS",IW=()=>window.isSecureContext!==void 0;function AW(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function at(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?AW(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):AW(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}var jt;(function(o){o.SET_SESSION_ID="SET_SESSION_ID",o.SET_P2P_ID="SET_P2P_id",o.SET_DC_ID="SET_DC_id",o.SET_UID="SET_UID",o.SET_PUB_ID="SET_PUB_ID",o.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",o.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",o.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",o.AVOID_JOIN_START="AVOID_JOIN_START",o.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",o.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",o.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",o.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",o.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",o.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",o.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",o.KEY_METRIC_DESCRIPTION_START="KEY_METRIC_DESCRIPTION_START",o.KEY_METRIC_ICE_CONNECTION_END="KEY_METRIC_ICE_CONNECTION_END",o.KEY_METRIC_SIGNAL_CHANNEL_OPEN="KEY_METRIC_SIGNAL_CHANNEL_OPEN",o.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",o.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",o.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",o.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",o.RESET_KEY_METRICS="RESET_KEY_METRICS",o.SET_USE_DATACHANNEL="SET_USE_DATACHANNEL",o.SET_USE_P2P="SET_USE_P2P"})(jt||(jt={}));class Kce{constructor(i,s,a,u){O(this,"state",void 0),this.state={codec:i,audioCodec:s,mode:a,clientId:u,sessionId:null,p2pId:0,dcId:0,pubId:0,subId:0,avoidJoinStart:0,keyMetrics:{publish:[],subscribe:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled",useDataChannel:!1,useP2P:!1}}dispatch(i){this.state=function(s,a){switch(a.type){case jt.SET_SESSION_ID:return at(at({},s),{},{sessionId:a.sessionId});case jt.SET_P2P_ID:return at(at({},s),{},{p2pId:a.p2pId});case jt.SET_UID:return at(at({},s),{},{uid:a.uid});case jt.SET_PUB_ID:return at(at({},s),{},{pubId:a.pubId});case jt.KEY_METRIC_CLIENT_CREATED:return at(at({},s),{},{keyMetrics:at(at({},s.keyMetrics),{},{clientCreated:a.metric})});case jt.KEY_METRIC_JOIN_START:return at(at({},s),{},{keyMetrics:at(at({},s.keyMetrics),{},{joinStart:a.metric})});case jt.AVOID_JOIN_START:return at(at({},s),{},{avoidJoinStart:a.avoidJoinStart});case jt.KEY_METRIC_JOIN_END:return at(at({},s),{},{keyMetrics:at(at({},s.keyMetrics),{},{joinEnd:a.metric})});case jt.KEY_METRIC_REQUEST_AP_START:return at(at({},s),{},{keyMetrics:at(at({},s.keyMetrics),{},{requestAPStart:a.metric})});case jt.KEY_METRIC_REQUEST_AP_END:return at(at({},s),{},{keyMetrics:at(at({},s.keyMetrics),{},{requestAPEnd:a.metric})});case jt.KEY_METRIC_JOIN_GATEWAY_START:return at(at({},s),{},{keyMetrics:at(at({},s.keyMetrics),{},{joinGatewayStart:a.metric})});case jt.KEY_METRIC_JOIN_GATEWAY_END:return at(at({},s),{},{keyMetrics:at(at({},s.keyMetrics),{},{joinGatewayEnd:a.metric})});case jt.KEY_METRIC_PEER_CONNECTION_START:return at(at({},s),{},{keyMetrics:at(at({},s.keyMetrics),{},{peerConnectionStart:a.metric})});case jt.KEY_METRIC_PEER_CONNECTION_END:return at(at({},s),{},{keyMetrics:at(at({},s.keyMetrics),{},{peerConnectionEnd:a.metric})});case jt.KEY_METRIC_DESCRIPTION_START:return at(at({},s),{},{keyMetrics:at(at({},s.keyMetrics),{},{descriptionStart:a.metric})});case jt.KEY_METRIC_SIGNAL_CHANNEL_OPEN:return at(at({},s),{},{keyMetrics:at(at({},s.keyMetrics),{},{signalChannelOpen:a.metric})});case jt.KEY_METRIC_ICE_CONNECTION_END:return at(at({},s),{},{keyMetrics:at(at({},s.keyMetrics),{},{iceConnectionEnd:a.metric})});case jt.KEY_METRIC_PUBLISH:{const u=s.keyMetrics.publish,h=u.findIndex(p=>p.trackId===a.metric.trackId);return h!==-1?(u[h]=at(at({},u[h]),a.metric),at(at({},s),{},{keyMetrics:at(at({},s.keyMetrics),{},{publish:[...u]})})):at(at({},s),{},{keyMetrics:at(at({},s.keyMetrics),{},{publish:[...s.keyMetrics.publish,a.metric]})})}case jt.KEY_METRIC_SUBSCRIBE:{const u=s.keyMetrics.subscribe,h=u.findIndex(p=>p.userId===a.metric.userId&&p.type===a.metric.type);return h!==-1?(u[h]=at(at({},u[h]),a.metric),at(at({},s),{},{keyMetrics:at(at({},s.keyMetrics),{},{subscribe:[...u]})})):at(at({},s),{},{keyMetrics:at(at({},s.keyMetrics),{},{subscribe:[...s.keyMetrics.subscribe,a.metric]})})}case jt.SET_CLOUD_PROXY_SERVER_MODE:return s.cloudProxyServerMode=a.mode,s;case jt.RECORD_JOIN_CHANNEL_SERVICE:return typeof a.index!="number"?s.joinChannelServiceRecords=[...s.joinChannelServiceRecords,a.record]:(s.joinChannelServiceRecords[a.index]=at(at({},s.joinChannelServiceRecords[a.index]),a.record),s.joinChannelServiceRecords=[...s.joinChannelServiceRecords]),s;case jt.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return s.joinChannelServiceRecords=[],s;case jt.RESET_KEY_METRICS:return s.keyMetrics={publish:[],subscribe:[]},s;case jt.SET_USE_DATACHANNEL:return at(at({},s),{},{useDataChannel:a.val});case jt.SET_USE_P2P:return at(at({},s),{},{useP2P:a.val});default:return s}}(this.state,i)}set sessionId(i){this.dispatch({type:jt.SET_SESSION_ID,sessionId:i})}get sessionId(){return this.state.sessionId}set codec(i){this.state.codec=i}get codec(){return this.state.codec}get audioCodec(){return this.state.audioCodec}get clientId(){return this.state.clientId}set p2pId(i){this.dispatch({type:jt.SET_P2P_ID,p2pId:i})}get p2pId(){return this.state.p2pId}set dcId(i){this.dispatch({type:jt.SET_DC_ID,dcId:i})}get dcId(){return this.state.dcId}set uid(i){this.dispatch({type:jt.SET_UID,uid:i})}get uid(){return this.state.uid}set pubId(i){this.dispatch({type:jt.SET_PUB_ID,pubId:i})}get pubId(){return this.state.pubId}set cloudProxyServerMode(i){this.dispatch({type:jt.SET_CLOUD_PROXY_SERVER_MODE,mode:i})}get cloudProxyServerMode(){return this.state.cloudProxyServerMode}set useDataChannel(i){this.dispatch({type:jt.SET_USE_DATACHANNEL,val:i})}get useDataChannel(){return this.state.useDataChannel}set useP2P(i){this.dispatch({type:jt.SET_USE_P2P,val:i})}get useP2P(){return this.state.useP2P}clientCreated(){this.dispatch({type:jt.KEY_METRIC_CLIENT_CREATED,metric:Date.now()})}joinStart(){this.dispatch({type:jt.KEY_METRIC_JOIN_START,metric:Date.now()})}joinEnd(){this.dispatch({type:jt.KEY_METRIC_JOIN_END,metric:Date.now()})}requestAPStart(){this.dispatch({type:jt.KEY_METRIC_REQUEST_AP_START,metric:Date.now()})}requestAPEnd(){this.dispatch({type:jt.KEY_METRIC_REQUEST_AP_END,metric:Date.now()})}joinGatewayStart(){this.dispatch({type:jt.KEY_METRIC_JOIN_GATEWAY_START,metric:Date.now()})}joinGatewayEnd(){this.dispatch({type:jt.KEY_METRIC_JOIN_GATEWAY_END,metric:Date.now()})}peerConnectionStart(){this.dispatch({type:jt.KEY_METRIC_PEER_CONNECTION_START,metric:Date.now()})}peerConnectionEnd(){this.dispatch({type:jt.KEY_METRIC_PEER_CONNECTION_END,metric:Date.now()})}descriptionStart(){this.dispatch({type:jt.KEY_METRIC_DESCRIPTION_START,metric:Date.now()})}signalChannelOpen(){this.dispatch({type:jt.KEY_METRIC_SIGNAL_CHANNEL_OPEN,metric:Date.now()})}iceConnectionEnd(){this.dispatch({type:jt.KEY_METRIC_ICE_CONNECTION_END,metric:Date.now()})}publish(i,s,a,u){this.dispatch({type:jt.KEY_METRIC_PUBLISH,metric:at(at({trackId:i,type:s},a&&{publishStart:a}),u&&{publishEnd:u})})}subscribe(i,s,a,u,h,p,_){this.dispatch({type:jt.KEY_METRIC_SUBSCRIBE,metric:at(at(at(at(at({userId:i,type:s},a&&{subscribeStart:a}),u&&{subscribeEnd:u}),h&&{firstFrame:h}),p&&{streamAdded:p}),_&&{firstDecoded:_})})}massSubscribe(i,s,a,u){i.forEach(h=>{this.dispatch({type:jt.KEY_METRIC_SUBSCRIBE,metric:at(at(at({userId:h.userId,type:h.type},s&&{subscribeStart:s}),a&&{subscribeEnd:a}),u&&{firstFrame:u})})})}get keyMetrics(){return this.state.keyMetrics}recordJoinChannelService(i,s){i.service==="gateway"&&Array.isArray(i.urls)&&(i.urls=i.urls.map(a=>a.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2")));try{return typeof s!="number"?(this.dispatch({type:jt.RECORD_JOIN_CHANNEL_SERVICE,record:at(at({},i),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.state.joinChannelServiceRecords.length-1):(s<0||s>=this.state.joinChannelServiceRecords.length||this.dispatch({type:jt.RECORD_JOIN_CHANNEL_SERVICE,record:i,index:s}),s)}catch{return 0}}resetJoinChannelServiceRecords(){this.dispatch({type:jt.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.dispatch({type:jt.RESET_KEY_METRICS})}get joinChannelServiceRecords(){try{return this.state.joinChannelServiceRecords}catch{return[]}}get avoidJoinStart(){return this.state.avoidJoinStart}set avoidJoinStart(i){this.dispatch({type:jt.AVOID_JOIN_START,avoidJoinStart:i})}}const Ua=function(o){if(o.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return o;const i=o.match(/([0-9]+\.[0-9]+\.[0-9]+)\-alpha\.([0-9]+)/);if(i&&i[1]&&i[2]){const a=i[1],u=i[2];return"".concat(a,".").concat(u)}const s=o.match(/([0-9]+\.[0-9]+\.[0-9]+)\-special\.([0-9]+)/);if(s&&s[1]&&s[2]){const a=s[1],u=s[2];return"".concat(a,".").concat(100*(Number(u)+1))}return"4.0.0.999"}("4.19.3"),g2=function(){try{return JSON.parse("true")===!0}catch{return!0}}(),_2="v4.19.3-0-gb2ca8ca7(11/2/2023, 2:57:33 PM)",Cs={PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",ENABLE_EVENT_REPORT:!0,GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,UPLOAD_LOG:!1,NOT_REPORT_EVENT:[],SUBSCRIBE_TWCC:!1,PUBLISH_TWCC:!1,PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,ENABLE_CONFIG_DISTRIBUTE:!0,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],WORKER_DOMAIN:"edge.agora.io",TURN_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,GET_VOLUME_OF_MUTED_AUDIO_TRACK:!1,STATS_UPDATE_INTERVAL:250,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,PRELOAD_MEDIA_COUNT:0,USE_PUB_RTX:!1,USE_SUB_RTX:!1,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,CHECK_LOCAL_STATS_INTERVAL:100,PROFILE_SWITCH_INTERVAL:2e3,UNSUPPORTED_VIDEO_CODEC:[],ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,CLOSE_AFB_FOR_LOCAL_AP:!0,JOIN_MAX_CONCURRENCY:6,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_GATEWAY_TRY_443PORT_DURATION:2e3,JOIN_GATEWAY_USE_443PORT_ONLY:!1,JOIN_GATEWAY_USE_DUAL_DOMAIN:!0,JOIN_GATEWAY_FALLBACK_PORT:443,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,CSP_DETECTED_HOSTNAME_LIST:["agora.io","sd-rtn.com"],REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!0,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,X_GOOGLE_START_BITRATE:void 0,NEW_REPORT_SERVER:!1,NEW_REPORT_SERVER_DOMAINS:["data-reporting.agora.io","data-reporting.agora.io"],VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT:3e5,VIDEO_INSPECT_INTERVAL_MINIMUM:1e3,VIDEO_INSPECT_QUALITY_RATIO:.9,VIDEO_INSPECT_WORKER_MANAGER_HOST:"edge.agora.io",VIDEO_INSPECT_WORKER_MANAGER_PORT:"",VIDEO_INSPECT_WORKER_PORT:"",SHOW_VIDEO_INSPECT_WORKER_MESSAGE:!1,STATS_COLLECTOR_PORT:443,FORCE_TURN_TCP:!1,SUBSCRIBE_AUDIO_FILTER_TOPN:void 0,ENABLE_PUBLISH_AUDIO_FILTER:void 0,DISABLE_FEC:void 0,WEBAUDIO_INIT_OPTIONS:void 0,FILTER_VIDEO_FEC:!0,FILTER_AUDIO_FEC:!1,CHROME_DUAL_STREAM_USE_ENCODING:!0,DISABLE_DUAL_STREAM_USE_ENCODING:!1,EXTENSION_USAGE_UPLOAD_INTERVAL:1e4,ICE_RESTART:!0,ICE_RESTART_INTERVAL:1e4,NEW_ICE_RESTART:!1,ENABLE_USER_LICENSE_CHECK:!0,SIGNAL_CHANNEL:0,TRANSMITTER_INITIAL_RTT:30,TRANSMITTER_INITIAL_RTO:30,TRANSMITTER_MAX_BATCH_ACK_COUNT:2,TRANSMITTER_MAX_RTO:500,DATACHANNEL_COMPRESS:!1,FINGERPRINT:null,DC_JOIN_WITH_FAILBACK:5e3,ENABLE_VIDEO_FRAME_CALLBACK:!0,VIDEO_FREEZE_DURATION:500,SPATIALIZER_PARAMETERS:{},UPLOAD_LOG_INTERVAL:3e3,UPLOAD_LOG_REQUEST_RETRY_INTERVAL:2e3,UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL:2e4,UPLOAD_LOG_TRY_INTERVAL_WHILE_OFF:5e3,UPLOAD_LOG_RETRY_INTERVAL_V1:1e4,UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1:200,UPLOAD_LOG_LENGTH_EACH_TIME:10,APP_TYPE:0,DISABLE_WEBAUDIO:!1,CHANNEL_MEDIA_RELAY_SERVERS:void 0,KEEP_LAST_FRAME:!0,FORWARD_P2P_CREATION:!0,SYNC_GROUP:!0,BLOCK_LOCAL_CLIENT:!1,AP_AREA:!0,SVC:[],ENABLE_ENCODED_TRANSFORM:!1,IMAGE_MODERATION_WORKER_HOST:"edge.agora.io",IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT:3e5,IMAGE_MODERATION_INTERVAL_MINIMUM:1e3,SHOW_IMAGE_MODERATION_WORKER_MESSAGE:!1,IMAGE_MODERATION_QUALITY_RATIO:.9,IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL:5e3,SHOW_GLOBAL_CLIENT_LIST:!1,RTM2_FLAG:void 0,AP_RTM:!1,ENABLE_DATASTREAM_2:!1,DATASTREAM_MAX_RETRANSMITS:10,ENABLE_USER_AUTO_REBALANCE_CHECK:!0,ENABLE_INSTANT_VIDEO:!1,ENABLE_NTP_REPORT:!1,USE_XR:!1,TCP_CANDIDATE_ONLY:!1,EXTERNAL_SIGNAL_REQUEST_TIMEOUT:1e4,P2P:!1,SHOW_P2P_LOG:!1,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0},FILTER_VIDEO_CODEC:[]};function Sn(o,i,s){var a,u;ot(a=Object.keys(Cs)).call(a,o)&&(!s&&ot(u=Object.keys(Oh)).call(u,o)||(Cs[o]=i))}function te(o){return Cs[o]}const Oh={};var Kp,OW;(function(o){o.h264="h264",o.h265="h265",o.vp8="vp8",o.vp9="vp9",o.av1="av1"})(Kp||(Kp={})),function(o){o.opus="opus",o.pcma="pcma",o.pcmu="pcmu",o.g722="g722"}(OW||(OW={}));const _I=new class extends Hn{reportLogUploadError(o){this.emit("REPORT_LOG_UPLOAD",o)}};class qce{constructor(i){O(this,"logger",void 0),O(this,"prefixLists",[]),this.logger=i}debug(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];this.logger.debug(...this.prefixLists,...s)}info(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];this.logger.info(...this.prefixLists,...s)}warning(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];this.logger.warning(...this.prefixLists,...s)}error(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];this.logger.error(...this.prefixLists,...s)}prefix(i){return this.prefixLists.push(i),this}popPrefix(){return this.prefixLists.pop(),this}}function E2(){const o=new Date;return o.toTimeString().split(" ")[0]+":"+o.getMilliseconds()}function NW(){const o=new Date,i=/((\d+:){2}\d+)/.exec(new Date().toUTCString());return i?(i==null?void 0:i[0])+":"+o.getUTCMilliseconds():o.toTimeString().split(" ")[0]+":"+o.getMilliseconds()}const ja={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},EI=Date.now(),G0=o=>{for(const i in ja)if(Object.prototype.hasOwnProperty.call(ja,i)&&ja[i]===o)return i;return"DEFAULT"},D=new class{constructor(){O(this,"proxyServerURL",void 0),O(this,"logLevel",ja.DEBUG),O(this,"uploadState","collecting"),O(this,"uploadLogWaitingList",[]),O(this,"uploadLogUploadingList",[]),O(this,"uploadErrorCount",0),O(this,"currentLogID",0),O(this,"url",void 0),O(this,"extLog",(o,i)=>{this.appendLogToWaitingList(o,...i)})}debug(){for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];const a=[ja.DEBUG].concat(i);this.log.apply(this,a)}info(){for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];const a=[ja.INFO].concat(i);this.log.apply(this,a)}warning(){for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];const a=[ja.WARNING].concat(i);this.log.apply(this,a)}warn(){this.warning(...arguments)}error(){for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];const a=[ja.ERROR].concat(i);this.log.apply(this,a)}upload(){for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];const a=[ja.DEBUG].concat(i);this.uploadLog.apply(this,a)}setLogLevel(o){o=Math.min(Math.max(0,o),4),this.logLevel=o}enableLogUpload(){Sn("UPLOAD_LOG",!0)}disableLogUpload(){Sn("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(o){this.proxyServerURL=o}prefix(o){return new qce(this).prefix(o)}log(){for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];if(Date.now()-EI<100)return void setTimeout(()=>{this.log(...i)},Date.now()-EI);const a=Math.max(0,Math.min(4,i[0]));if(i[0]=E2()+" Agora-SDK [".concat(G0(a),"]:"),this.appendLogToWaitingList(a,...i),a<this.logLevel)return;const u=E2()+" %cAgora-SDK [".concat(G0(a),"]:");let h=[];if(!te("USE_NEW_LOG"))switch(a){case ja.DEBUG:h=[u,"color: #64B5F6;"].concat(i.slice(1)),console.log.apply(console,h);break;case ja.INFO:h=[u,"color: #1E88E5; font-weight: bold;"].concat(i.slice(1)),console.log.apply(console,h);break;case ja.WARNING:h=[u,"color: #FB8C00; font-weight: bold;"].concat(i.slice(1)),console.warn.apply(console,h);break;case ja.ERROR:h=[u,"color: #B00020; font-weight: bold;"].concat(i.slice(1)),console.error.apply(console,h)}}uploadLog(){for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];if(Date.now()-EI<100)return void setTimeout(()=>{this.uploadLog(...i)},Date.now()-EI);const a=Math.max(0,Math.min(4,i[0]));i[0]=E2()+" Agora-SDK [".concat(G0(a),"]:"),this.appendLogToWaitingList(a,...i)}appendLogToWaitingList(o){if(!te("UPLOAD_LOG"))return;for(var i=arguments.length,s=new Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];Array.isArray(s[0])?s[0][0]=NW()+" Agora-SDK [".concat(G0(o),"]:"):s[0]=NW()+" Agora-SDK [".concat(G0(o),"]:");let u="";s.forEach(h=>{typeof h=="object"&&(h=JSON.stringify(h)),u+="".concat(h," ")}),this.uploadLogWaitingList.push({payload_str:u,log_level:o,log_item_id:this.currentLogID++}),this.uploadState==="uploading"&&this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}async uploadLogs(){const o=this.uploadLogUploadingList,i={sdk_version:Ua,process_id:te("PROCESS_ID"),payload:JSON.stringify(o)};return nl(async()=>{const s=await ao.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat(te("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(te("LOG_UPLOAD_SERVER"),"/upload/v1")),i,{responseType:"text"});if(s.data!=="OK"){const a=new Error("unexpected upload log response");throw a.response=s,a}},()=>(this.uploadLogUploadingList=[],!1),s=>(s.response?_I.reportLogUploadError({status:s.response.status,data:s.response.data,headers:s.response.headers,message:s.message}):s.request?_I.reportLogUploadError({status:s.request.status,message:s.message}):_I.reportLogUploadError({status:-1,message:s.message}),!0),{timeout:te("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:te("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})}uploadLogInterval(){this.uploadLogUploadingList.length===0&&this.uploadLogWaitingList.length===0||(this.uploadLogUploadingList.length===0&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,te("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then(()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout(()=>this.uploadLogInterval(),te("UPLOAD_LOG_INTERVAL"))}).catch(o=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout(()=>this.uploadLogInterval(),te("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout(()=>this.uploadLogInterval(),te("UPLOAD_LOG_RETRY_INTERVAL_V1"))}))}};var PW,xW;function Yce(o){return jr(o.reportId,"params.reportId",0,100,!1),jr(o.category,"params.category",0,100,!1),jr(o.event,"params.event",0,100,!1),jr(o.label,"params.label",0,100,!1),Tn(o.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}(function(o){o.FREE="free",o.UPLOADING="uploading"})(PW||(PW={})),function(o){o[o.MISC=0]="MISC",o[o.INTERNAL_EVENT=1]="INTERNAL_EVENT",o[o.PUBLIC_EVENT=2]="PUBLIC_EVENT",o[o.WEB_EVENT=3]="WEB_EVENT",o[o.INTERNAL_API=4]="INTERNAL_API",o[o.WEB_API=5]="WEB_API",o[o.PUBLIC_API=6]="PUBLIC_API"}(xW||(xW={}));const Xce={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};var rr,$n,DW,kW;function LW(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function Rt(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?LW(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):LW(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}(function(o){o.PUBLISH="publish",o.SUBSCRIBE="subscribe",o.WS_COMPRESSOR_INIT="ws_compressor_init",o.SESSION_INIT="session_init",o.JOIN_CHOOSE_SERVER="join_choose_server",o.REQ_USER_ACCOUNT="req_user_account",o.JOIN_GATEWAY="join_gateway",o.REJOIN_GATEWAY="rejoin_gateway",o.STREAM_SWITCH="stream_switch",o.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",o.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",o.FIRST_VIDEO_RECEIVED="first_video_received",o.FIRST_AUDIO_RECEIVED="first_audio_received",o.FIRST_VIDEO_DECODE="first_video_decode",o.FIRST_AUDIO_DECODE="first_audio_decode",o.ON_ADD_AUDIO_STREAM="on_add_audio_stream",o.ON_ADD_VIDEO_STREAM="on_add_video_stream",o.ON_UPDATE_STREAM="on_update_stream",o.ON_REMOVE_STREAM="on_remove_stream",o.USER_ANALYTICS="req_user_analytics",o.PC_STATS="pc_stats"})(rr||(rr={})),function(o){o.SESSION="io.agora.pb.Wrtc.Session",o.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",o.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",o.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",o.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",o.PUBLISH="io.agora.pb.Wrtc.Publish",o.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",o.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",o.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",o.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",o.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",o.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",o.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",o.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",o.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",o.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",o.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",o.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",o.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",o.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",o.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",o.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",o.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",o.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",o.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",o.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",o.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",o.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",o.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",o.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed",o.PC_STATS="io.agora.pb.Wrtc.PCStats"}($n||($n={})),function(o){o[o.WORKER_EVENT=156]="WORKER_EVENT",o[o.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"}(DW||(DW={})),function(o){o[o.SESSION=26]="SESSION",o[o.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",o[o.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",o[o.JOIN_GATEWAY=28]="JOIN_GATEWAY",o[o.PUBLISH=30]="PUBLISH",o[o.SUBSCRIBE=29]="SUBSCRIBE",o[o.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",o[o.STREAM_SWITCH=32]="STREAM_SWITCH",o[o.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",o[o.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",o[o.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",o[o.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",o[o.API_INVOKE=41]="API_INVOKE",o[o.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",o[o.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",o[o.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",o[o.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",o[o.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",o[o.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",o[o.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",o[o.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",o[o.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",o[o.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",o[o.WORKER_EVENT=156]="WORKER_EVENT",o[o.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",o[o.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",o[o.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",o[o.USER_ANALYTICS=1e4]="USER_ANALYTICS",o[o.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED"}(kW||(kW={}));class K0{constructor(){O(this,"baseInfoMap",new Map),O(this,"proxyServer",void 0),O(this,"eventUploadTimer",void 0),O(this,"setSessionIdTimer",void 0),O(this,"url",void 0),O(this,"backupUrl",void 0),O(this,"_appId",void 0),O(this,"keyEventUploadPendingItems",[]),O(this,"normalEventUploadPendingItems",[]),O(this,"apiInvokeUploadPendingItems",[]),O(this,"apiInvokeCount",0),O(this,"ltsList",[]),O(this,"lastSendNormalEventTime",Date.now()),O(this,"customReportCounterTimer",void 0),O(this,"customReportCount",0),O(this,"extApiInvoke",async i=>{for(const s of i){const a=Rt(Rt({},s),{},{sid:null,invokeId:++this.apiInvokeCount,tag:Yn.TRACER});this.sendApiInvoke(a)}}),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),te("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),te("EVENT_REPORT_SEND_INTERVAL"))}getBaseInfoBySessionId(i){return this.baseInfoMap.get(i)}adjustSessionStartTime(i){if(!this.baseInfoMap.has(i)&&!this.baseInfoMap.get(i))return void D.error("adjust session ".concat(i," start time, sid is not exist or info is undefined"));const s=this.baseInfoMap.get(i),a=Date.now(),u=s.startTime;s.startTime=a,D.debug("rewrite session ".concat(i," startTime: ").concat(a," , ").concat(a-u,"ms")),this.baseInfoMap.set(i,s)}setAppId(i){this._appId=i}reportApiInvoke(i,s,a){s.timeout=s.timeout||6e4,s.reportResult=s.reportResult===void 0||s.reportResult;const u=Date.now();this.apiInvokeCount+=1;const h=this.apiInvokeCount,p=()=>({tag:s.tag,invokeId:h,sid:i,name:s.name,apiInvokeTime:u,options:s.options,states:s.states||null}),_=!!te("SHOW_REPORT_INVOKER_LOG");_&&D.info("".concat(s.name," start"),s.options);let v=!1;xr(s.timeout).then(()=>{v||(this.sendApiInvoke(Rt(Rt({},p()),{},{error:z.API_INVOKE_TIMEOUT,success:!1})),D.debug("".concat(s.name," timeout")))});const T=new Ee(z.UNEXPECTED_ERROR,"".concat(s.name,": this api invoke is end"));return{onSuccess:b=>{const C=()=>{if(v)throw T;return v=!0,this.sendApiInvoke(Rt(Rt({},p()),{},{success:!0},s.reportResult&&{result:b})),_&&D.info("".concat(s.name," onSuccess")),b};return a?A8(C,s.name+"Success",a,()=>v=!0):C()},onError:b=>{const C=()=>{if(v)throw b;v=!0,this.sendApiInvoke(Rt(Rt({},p()),{},{success:!1,error:b})),_&&D.info("".concat(s.name," onFailure"),b.toString())};return a?A8(C,s.name+"Error",a,()=>v=!0):C()}}}sessionInit(i,s){if(this.baseInfoMap.has(i))return;const a=Date.now(),u=this.createBaseInfo(i,a);u.cname=s.cname;const h=Object.assign({},{willUploadConsoleLog:te("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:g2?"global":"oversea",areas:te("AREAS")&&te("AREAS").join(",")},s.extend),p=Date.now(),_=Rt(Rt({},u),{},{eventType:rr.SESSION_INIT,appid:s.appid,browser:navigator.userAgent,build:_2,lts:p,elapse:p-a,extend:JSON.stringify(h),mode:s.mode,process:te("PROCESS_ID"),appType:te("APP_TYPE"),success:!0,version:Ua});this.send({type:$n.SESSION,data:_},!0)}joinChooseServer(i,s){const a=this.baseInfoMap.get(i);if(!a)return;const u=a.info,h=Date.now(),p=Rt(Rt({},u),{},{eventType:rr.JOIN_CHOOSE_SERVER,lts:h,eventElapse:h-s.lts,chooseServerAddr:s.csAddr,errorCode:s.ec,elapse:h-a.startTime,success:s.succ,chooseServerAddrList:JSON.stringify(s.serverList),uid:s.uid?parseInt(s.uid):null,cid:s.cid?parseInt(s.cid):null,chooseServerIp:s.csIp||"",opid:s.opid,unilbsServerIds:s.unilbsServerIds,extend:s.extend||void 0,isHttp3:s.isHttp3});this.send({type:$n.JOIN_CHOOSE_SERVER,data:p},!0)}reqUserAccount(i,s){const a=this.baseInfoMap.get(i);if(!a)return;const u=a.info,h=Date.now(),p=Rt(Rt({},u),{},{eventType:rr.REQ_USER_ACCOUNT,lts:h,success:s.success,serverAddress:s.serverAddr,stringUid:s.stringUid,uid:s.uid,errorCode:s.errorCode,elapse:h-a.startTime,eventElapse:h-s.lts,extend:JSON.stringify(s.extend)});this.send({type:$n.REQ_USER_ACCOUNT,data:p},!0)}joinGateway(i,s){const a=this.baseInfoMap.get(i);if(!a)return;const u=a.info;s.vid&&(u.vid=s.vid),u.uid=s.uid,u.cid=s.cid;const h=Date.now(),{firstSuccess:p,avoidJoinStartTime:_,isProxy:v,addr:T}=s,b=h-(p&&_?_:a.startTime),C=Rt(Rt({},u),{},{eventType:rr.JOIN_GATEWAY,lts:h,gatewayAddr:s.addr,success:s.succ,errorCode:s.ec,elapse:b,eventElapse:h-s.lts,firstSuccess:p,signalChannel:s.signalChannel}),N=C.success?1:0;if(s.succ&&(a.lastJoinSuccessTime=h),p)this.send({type:$n.JOIN_GATEWAY,data:C},!0);else{let x;if(T)if(v){const F=T.match(/h=(\d{1,3}-){3}\d{1,3}/g),H=T.match(/p=[0-9]{1,6}/g);x={isSuccess:N,gatewayIp:F&&F.length?F[0].split("=")[1].replace(/-/g,"."):"",port:H&&H.length?H[0].split("=")[1]:"",isProxy:v?1:0}}else{const F=T.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),H=T.match(/(:|p=)[0-9]{1,6}/g);x={isSuccess:N,gatewayIp:F&&F.length?F[0].split("//")[1].replace(/-/g,"."):"",port:H&&H.length?H[0].split(/:|p=/g)[1]:"",isProxy:v?1:0}}else x={isSuccess:N,gatewayIp:"",port:"",isProxy:v?1:0};delete C.success,delete C.eventType,delete C.firstSuccess,C.vid=Number(C.vid);const B=Object.assign({},C,x,{eventType:rr.REJOIN_GATEWAY});this.send({type:$n.RE_JOIN_GATEWAY,data:B},!0)}}joinChannelTimeout(i,s){const a=this.baseInfoMap.get(i);if(!a)return;const u=Date.now(),h=Rt(Rt({},a.info),{},{lts:u,timeout:s,elapse:u-a.startTime});this.send({type:$n.JOIN_CHANNEL_TIMEOUT,data:h},!0)}publish(i,s){const a=this.baseInfoMap.get(i);if(!a)return;const u=a.info,h=Date.now(),p=Rt(Rt({},u),{},{eventType:rr.PUBLISH,lts:h,eventElapse:s.eventElapse,elapse:h-a.startTime,success:s.succ,errorCode:s.ec,videoName:s.videoName,audioName:s.audioName,screenName:s.screenName,screenshare:s.screenshare,audio:s.audio,video:s.video,p2pid:s.p2pid,publishRequestid:s.publishRequestid});this.send({type:$n.PUBLISH,data:p},!0)}subscribe(i,s,a){const u=this.baseInfoMap.get(i);if(!u)return;const h=u.info,p=Date.now(),_=Rt(Rt({},h),{},{eventType:rr.SUBSCRIBE,lts:p,eventElapse:s.eventElapse,elapse:p-u.startTime,success:s.succ,errorCode:s.ec,video:s.video,audio:s.audio,subscribeRequestid:s.subscribeRequestid,p2pid:s.p2pid},a&&{extend:JSON.stringify({isMassSubscribe:!0})});typeof s.peerid=="string"?_.peerSuid=s.peerid:_.peer=s.peerid,this.send({type:$n.SUBSCRIBE,data:_},!0)}wsCompressorInit(i){var s;const a=[...Fs(s=this.baseInfoMap).call(s)],u=a.length?a[0]:"UnableToGetSid",h=this.baseInfoMap.get(u);if(!h)return;const p=h.info,_=Date.now(),v=Rt(Rt({},p),{},{eventType:rr.WS_COMPRESSOR_INIT,lts:_,eventElapse:i.eventElapse,elapse:_-h.startTime,status:i.status?1:2});this.send({type:$n.WS_COMPRESSOR_INIT,data:v},!0)}firstRemoteVideoDecode(i,s,a,u){const h=this.baseInfoMap.get(i);if(!h)return;const p=h.info,_=Date.now(),v=Rt(Rt(Rt({},p),u),{},{elapse:_-h.startTime,eventType:s,lts:_,firstDecodeFrame:Math.max(_-h.startTime,0),apEnd:Math.max(u.apEnd-h.startTime,0),apStart:Math.max(u.apStart-h.startTime,0),joinGwEnd:Math.max(u.joinGwEnd-h.startTime,0),joinGwStart:Math.max(u.joinGwStart-h.startTime,0),pcEnd:Math.max(u.pcEnd-h.startTime,0),pcStart:Math.max(u.pcStart-h.startTime,0),subscriberEnd:Math.max(u.subscriberEnd-h.startTime,0),subscriberStart:Math.max(u.subscriberStart-h.startTime,0),videoAddNotify:Math.max(u.videoAddNotify-h.startTime,0)});this.send({type:a,data:v},!0)}firstRemoteFrame(i,s,a,u){const h=this.baseInfoMap.get(i);if(!h)return;const p=h.info,_=Date.now(),v=Rt(Rt(Rt({},p),u),{},{elapse:_-h.startTime,eventType:s,lts:_});this.send({type:a,data:v},!0)}pcStats(i,s){const a=this.baseInfoMap.get(i);if(!a)return;const u=a.info,h=Date.now(),p=Rt(Rt(Rt({},u),s),{},{vid:u.vid===void 0?0:Number(u.vid),elapse:h-a.startTime,eventType:rr.PC_STATS,lts:h});this.send({type:$n.PC_STATS,data:p},!0)}updateRemoteRTPCapabilities(i,s){this.reportApiInvoke(i,{name:"Client.updateRemoteRTPCapabilities",options:s,tag:Yn.TRACER}).onSuccess()}onGatewayStream(i,s,a,u){const h=this.baseInfoMap.get(i);if(!h)return;const p=h.info,_=Date.now(),v=Rt(Rt(Rt({},p),u),{},{eventType:s,lts:_});this.send({type:a,data:v},!0)}streamSwitch(i,s){const a=this.baseInfoMap.get(i);if(!a)return;const u=a.info,h=Date.now(),p=Rt(Rt({},u),{},{eventType:rr.STREAM_SWITCH,lts:h,isDual:s.isdual,elapse:h-a.startTime,success:s.succ});this.send({type:$n.STREAM_SWITCH,data:p},!0)}requestProxyAppCenter(i,s){const a=this.baseInfoMap.get(i);if(!a)return;const u=a.info,h=Date.now(),p=Rt(Rt({},u),{},{eventType:rr.REQUEST_PROXY_APPCENTER,lts:h,eventElapse:h-s.lts,elapse:h-a.startTime,APAddr:s.APAddr,workerManagerList:s.workerManagerList,response:s.response,errorCode:s.ec,success:s.succ});this.send({type:$n.REQUEST_PROXY_APPCENTER,data:p},!0)}requestProxyWorkerManager(i,s){const a=this.baseInfoMap.get(i);if(!a)return;const u=a.info,h=Date.now(),p=Rt(Rt({},u),{},{eventType:rr.REQUEST_PROXY_WORKER_MANAGER,lts:h,eventElapse:h-s.lts,elapse:h-a.startTime,workerManagerAddr:s.workerManagerAddr,response:s.response,errorCode:s.ec,success:s.succ});this.send({type:$n.REQUEST_PROXY_WORKER_MANAGER,data:p},!0)}setProxyServer(i){this.proxyServer=i,i?D.debug("reportProxyServerurl: ".concat(i)):D.debug("disable reportProxyServerurl: ".concat(i))}peerPublishStatus(i,s){const a=this.baseInfoMap.get(i);if(!a)return;const u=a.info,h=Date.now(),p=Rt(Rt({},u),{},{subscribeElapse:s.subscribeElapse,peer:s.peer,peerPublishDuration:Math.max(s.audioPublishDuration,s.videoPublishDuration),audiotag:s.audioPublishDuration>0?1:-1,videotag:s.videoPublishDuration>0?1:-1,lts:h,elapse:h-a.startTime,joinChannelSuccessElapse:h-(a.lastJoinSuccessTime||h),peerPublishDurationVideo:s.videoPublishDuration,peerPublishDurationAudio:s.audioPublishDuration});this.send({type:$n.PEER_PUBLISH_STATUS,data:p},!0)}workerEvent(i,s){const a=this.baseInfoMap.get(i);if(!a)return;const u=a.info,h=Date.now();(function(_,v,T){const b=_[v];if(!b||typeof b!="string")return[_];_[v]="";const C=Xl(JSON.stringify(_));let N=0;const x=[];let B=0;for(let F=0;F<b.length;F++)B+=b.charCodeAt(F)<=127?1:3,B<=T-C||(x[x.length]=Hp(Hp({},_),{},{[v]:b.substring(N,F)}),N=F,B=b.charCodeAt(F)<=127?1:3);return N!==b.length-1&&(x[x.length]=Hp(Hp({},_),{},{[v]:b.substring(N)})),x})(Rt(Rt(Rt({},u),s),{},{elapse:h-a.startTime,lts:h,productType:"WebRTC"}),"payload",1300).forEach(_=>this.send({type:$n.WORKER_EVENT,data:_},!0))}apworkerEvent(i,s){const a=this.baseInfoMap.get(i);if(!a)return;const u=a.info,h=Date.now(),p=Rt(Rt(Rt({},u),s),{},{elapse:h-a.startTime,lts:h});this.send({type:$n.AP_WORKER_EVENT,data:p},!0)}joinWebProxyAP(i,s){const a=this.baseInfoMap.get(i);if(!a)return;const u=a.info,h=Date.now(),p=Rt(Rt(Rt({},u),s),{},{elapse:h-a.startTime,lts:h,extend:s.extend||void 0});this.send({type:$n.JOIN_WEB_PROXY_AP,data:p},!0)}WebSocketQuit(i,s){const a=this.baseInfoMap.get(i);if(!a)return;const u=a.info,h=Date.now(),p=Rt(Rt(Rt({},u),s),{},{elapse:h-a.startTime,lts:h});this.send({type:$n.WEBSOCKET_QUIT,data:p},!0)}async sendCustomReportMessage(i,s){if(this.customReportCount+=s.length,this.customReportCount>te("CUSTOM_REPORT_LIMIT"))throw new Ee(z.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval(()=>{this.customReportCount=0},5e3));const a=Date.now(),u=s.map(h=>({type:$n.USER_ANALYTICS,data:Rt(Rt({sid:i},h),{},{lts:a})}));try{te("NEW_REPORT_SERVER")?await this.postDataToStatsCollector2(u):await this.postDataToStatsCollector(u)}catch(h){throw D.error("send custom report message failed",h.toString()),new Ee(z.CUSTOM_REPORT_SEND_FAILED,h.message)}}sendApiInvoke(i){const s=te("NOT_REPORT_EVENT");if(i.tag&&ot(s)&&ot(s).call(s,i.tag))return!1;if(i.sid===null)return this.apiInvokeUploadPendingItems.push(i),!1;const a=this.baseInfoMap.get(i.sid);if(!a)return this.apiInvokeUploadPendingItems.push(i),!1;const{cname:u,uid:h,cid:p}=a.info;let _;if(i.lts=i.lts||Date.now(),i.error)if(i.error instanceof Ee){const{code:T,message:b}=i.error;_=T||b||i.error.toString()}else _=i.error.toString();const v={invokeId:i.invokeId,sid:i.sid,cname:u,cid:p,uid:h,lts:i.lts,success:i.success,elapse:i.lts-a.startTime,execElapse:i.lts-i.apiInvokeTime,apiName:i.name,options:i.options?JSON.stringify(i.options):void 0,execStates:i.states?JSON.stringify(i.states):void 0,execResult:i.result?JSON.stringify(i.result):void 0,errorCode:i.error?_:void 0,errorMsg:i.error?JSON.stringify(i.error):void 0};return this.send({type:$n.API_INVOKE,data:v},!1),!0}appendSessionId(){K0.__CLIENT_LIST__.forEach(i=>{if(i._sessionId){const s=this.apiInvokeUploadPendingItems.length;for(let a=0;a<s;a++){const u=this.apiInvokeUploadPendingItems.shift();u&&(u.sid=i._sessionId,this.sendApiInvoke(Object.assign({},u)))}}})}send(i,s){if(s)return this.keyEventUploadPendingItems.push(i),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(i),this.normalEventUploadPendingItems.length>te("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(i,s){const a=[],u=[];for(;i.length;){const p=i.shift();a.length<20?a.push(p):u.push(p)}i.push(...u);for(const p of[...a]){var h;this.ltsList.indexOf(p.data.lts)!==-1?(p.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(p.data.lts)):(this.ltsList.push(p.data.lts),Up(h=this.ltsList).call(h,(_,v)=>_-v))}return s||(this.lastSendNormalEventTime=Date.now()),te("ENABLE_EVENT_REPORT")&&a.length&&(te("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(a):this.postDataToStatsCollector(a)).catch((p=>_=>{te("EVENT_REPORT_RETRY")&&(s?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(p):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(p),this.normalEventUploadPendingItems.length>te("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-te("NORMAL_EVENT_QUEUE_CAPACITY")),D.warning("report: drop normal events"))))})(a)),i}async postDataToStatsCollector2(i){Ii.networkState===ms.OFFLINE&&await le.race([Ii.onlineWaiter,xr(2*Oi.maxRetryTimeout)]);const s=h=>{let p=new Uint8Array;return h.forEach(_=>{const v=zM(JSON.stringify(_.data)),T=new ArrayBuffer(5),b=(N=>{let x=0;return Object.entries($n).forEach(B=>{let[F,H]=B;H===N.type&&(x=EventNameToID[F])}),x})(_),C=new DataView(T);C.setUint16(0,v.byteLength,!0),C.setUint8(2,255&b),C.setUint8(3,b>>>8&255),C.setUint8(4,b>>>16&255),p=v8(p,new Uint8Array(T)),p=v8(p,v)}),p},a="event";let u=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(te("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(a):"https://".concat(te("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(a);for(let h=0;h<2;h+=1){h===1&&(u=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(te("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(a):"https://".concat(te("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(a));try{await m2(u,{timeout:1e4,data:s(i),headers:Rt(Rt({biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},this._appId&&{appid:this._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(p){if(h===1)throw p;continue}return}}async postDataToStatsCollector(i){let s=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const a={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:i.map(p=>JSON.stringify(p)),vid:(p=>{const _=p&&p.data.sid&&this.baseInfoMap.get(p.data.sid);return _&&_.info.vid&&+_.info.vid||0})(i[0])};Ii.networkState===ms.OFFLINE&&await le.race([Ii.onlineWaiter,xr(2*Oi.maxRetryTimeout)]);const u=s?"/events/proto-raws":"/events/messages";let h=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(te("EVENT_REPORT_DOMAIN"),"&p=").concat(te("STATS_COLLECTOR_PORT"),"&d=").concat(u):"https://".concat(te("EVENT_REPORT_DOMAIN"),":").concat(te("STATS_COLLECTOR_PORT")).concat(u));for(let p=0;p<2;p+=1){p===1&&(h=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(te("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(te("STATS_COLLECTOR_PORT"),"&d=").concat(u):"https://".concat(te("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(te("STATS_COLLECTOR_PORT")).concat(u)));try{s?await zce(h,{timeout:1e4,data:a}):await m2(h,{timeout:1e4,data:a})}catch(_){if(p===1)throw _;continue}return}}createBaseInfo(i,s){const a=Object.assign({},Xce);return a.sid=i,this.baseInfoMap.set(i,{info:a,startTime:s}),a}reportResourceTiming(i,s){const a=performance.getEntriesByName(i),u=a[a.length-1];u&&this.reportApiInvoke(s,{name:"Client.resourceTiming",options:u,tag:Yn.TRACER}).onSuccess()}}function ht(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function(i,s,a){const u=a.value;if(typeof u=="function"){const h=o.className||i.__className__||(i.constructor.name==="AgoraRTCClient"?"Client":i.constructor.name);a.value=function(){for(var p=arguments.length,_=new Array(p),v=0;v<p;v++)_[v]=arguments[v];let T=_;if(o.argsMap)try{T=o.argsMap(this,..._)}catch(C){D.warning(C),T=[]}try{JSON.stringify(T)}catch{D.warning("arguments for method ".concat(h,".").concat(String(s)," not serializable for apiInvoke.")),T=[]}const b=(o.report||it).reportApiInvoke(this._sessionId||null,{name:"".concat(h,".").concat(String(s)),options:T,tag:Yn.TRACER,reportResult:o.reportResult},o.throttleTime);try{const C=u.apply(this,_);return C instanceof le?C.then(N=>(b.onSuccess(o.reportResult&&N),N)).catch(N=>{throw b.onError(N),N}):(b.onSuccess(o.reportResult&&C),C)}catch(C){throw b.onError(C),C}}}return a}}O(K0,"__CLIENT_LIST__",[]);const it=new K0;_I.on("REPORT_LOG_UPLOAD",o=>{o.networkState=Ii.networkState,it.reportApiInvoke(null,{name:"logUploadError",options:o,tag:Yn.TRACER})});const Jce=["CHINA","GLOBAL"],ra=function(){const o="us".concat("erna","me"),i="pa".concat("sswo","rd"),s=["t","s","t"];s.splice(1,0,"e");const a=s.join(""),u=[];for(let _=0;_<6;_++)u.push("1");const h=u.join(""),p={};return p[o]=a,p[i]=h,Object.assign(p,{turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1})}();window.DEFAULT_TURN_CONFIG=ra,g2||(Cs.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],Cs.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],Cs.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],Cs.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],Cs.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],Cs.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],Cs.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",Cs.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",Cs.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",Cs.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",Cs.AREAS=["NORTH_AMERICA","OVERSEA"]);const MW=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],Nh=[];function qp(o,i){return!!i&&Nh.some(s=>s.uid===o&&s.channelName===i)}K0.__CLIENT_LIST__=Nh;var v2,co,K_,q0,sa,Zr,lt,It,Be,nt,lo,St,UW,q_,mt,zi,Ph,Qce=uc("Array").values,Zce=kl,ele=Xr,tle=ni,nle=Qce,y2=Array.prototype,ile={DOMTokenList:!0,NodeList:!0},Jl=rn(function(o){var i=o.values;return o===y2||tle(y2,o)&&i===y2.values||ele(ile,Zce(o))?nle:i});function ve(o,i,s,a){var u,h=arguments.length,p=h<3?i:a===null?a=Object.getOwnPropertyDescriptor(i,s):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(o,i,s,a);else for(var _=o.length-1;_>=0;_--)(u=o[_])&&(p=(h<3?u(p):h>3?u(i,s,p):u(i,s))||p);return h>3&&p&&Object.defineProperty(i,s,p),p}function j(o,i){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,i)}(function(o){o.L1T1="L1T1",o.L1T2="L1T2",o.L1T3="L1T3",o.L2T1_KEY="L2T1_KEY",o.L2T2_KEY="L2T2_KEY",o.L2T3_KEY="L2T3_KEY",o.L3T1_KEY="L3T1_KEY",o.L3T2_KEY="L3T2_KEY",o.L3T3_KEY="L3T3_KEY"})(v2||(v2={})),function(o){o.CERTIFICATE="certificate",o.CODEC="codec",o.CANDIDATE_PAIR="candidate-pair",o.LOCAL_CANDIDATE="local-candidate",o.REMOTE_CANDIDATE="remote-candidate",o.INBOUND="inbound-rtp",o.TRACK="track",o.OUTBOUND="outbound-rtp",o.PC="peer-connection",o.REMOTE_INBOUND="remote-inbound-rtp",o.REMOTE_OUTBOUND="remote-outbound-rtp",o.TRANSPORT="transport",o.CSRC="csrc",o.DATA_CHANNEL="data-channel",o.STREAM="stream",o.SENDER="sender",o.RECEIVER="receiver"}(co||(co={})),function(o){o[o.ACCESS_POINT=101]="ACCESS_POINT",o[o.UNILBS=201]="UNILBS",o[o.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR"}(K_||(K_={})),function(o){o[o.IIIEGAL_APPID=1]="IIIEGAL_APPID",o[o.IIIEGAL_UID=2]="IIIEGAL_UID",o[o.INTERNAL_ERROR=3]="INTERNAL_ERROR"}(q0||(q0={})),function(o){o[o.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",o[o.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",o[o.INTERNAL_ERROR=8]="INTERNAL_ERROR",o[o.NO_AUTHORIZED=9]="NO_AUTHORIZED",o[o.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",o[o.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",o[o.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",o[o.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",o[o.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",o[o.USER_OVERLOAD=16]="USER_OVERLOAD",o[o.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",o[o.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND"}(sa||(sa={})),function(o){o[o.NO_FLAG_SET=100]="NO_FLAG_SET",o[o.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",o[o.INVALID_FALG_SET=102]="INVALID_FALG_SET",o[o.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",o[o.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",o[o.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",o[o.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",o[o.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",o[o.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",o[o.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",o[o.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",o[o.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",o[o.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",o[o.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",o[o.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",o[o.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",o[o.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",o[o.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",o[o.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV"}(Zr||(Zr={})),function(o){o[o.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",o[o.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",o[o.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",o[o.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",o[o.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",o[o.K_TICKET_INVALID=7]="K_TICKET_INVALID",o[o.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",o[o.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",o[o.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",o[o.K_UID_BANNED=14]="K_UID_BANNED",o[o.K_IP_BANNED=15]="K_IP_BANNED",o[o.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",o[o.K_AUTO_REBALANCE=28]="K_AUTO_REBALANCE",o[o.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",o[o.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",o[o.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",o[o.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",o[o.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",o[o.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",o[o.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",o[o.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",o[o.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",o[o.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",o[o.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",o[o.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",o[o.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",o[o.ERR_INVALID_UID=117]="ERR_INVALID_UID",o[o.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",o[o.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",o[o.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",o[o.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",o[o.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",o[o.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",o[o.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",o[o.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",o[o.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",o[o.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",o[o.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",o[o.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",o[o.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",o[o.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",o[o.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",o[o.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",o[o.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",o[o.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",o[o.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",o[o.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",o[o.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",o[o.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",o[o.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",o[o.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",o[o.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",o[o.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",o[o.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",o[o.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",o[o.ERR_LICENSE_MISSING=32769]="ERR_LICENSE_MISSING",o[o.ERR_LICENSE_EXPIRED=32771]="ERR_LICENSE_EXPIRED",o[o.ERR_LICENSE_MINUTES_EXCEEDED=32773]="ERR_LICENSE_MINUTES_EXCEEDED",o[o.ERR_LICENSE_PERIOD_INVALID=32774]="ERR_LICENSE_PERIOD_INVALID",o[o.ERR_LICENSE_MULTIPLE_SDK_SERVICE=32778]="ERR_LICENSE_MULTIPLE_SDK_SERVICE",o[o.ERR_LICENSE_ILLEGAL=32783]="ERR_LICENSE_ILLEGAL",o[o.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",o[o.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",o[o.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY"}(lt||(lt={})),function(o){o.CONNECTING="connecting",o.CONNECTED="connected",o.RECONNECTING="reconnecting",o.CLOSED="closed"}(It||(It={})),function(o){o.WS_CONNECTED="ws_connected",o.WS_RECONNECTING="ws_reconnecting",o.WS_CLOSED="ws_closed",o.WS_RECONNECT_WAITTING_FINISH="ws_reconnect_waitting_finish",o.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",o.ON_BINARY_DATA="on_binary_data",o.REQUEST_RECOVER="request_recover",o.REQUEST_JOIN_INFO="request_join_info",o.REQUEST_REJOIN_INFO="req_rejoin_info",o.IS_P2P_DISCONNECTED="is_p2p_dis",o.DISCONNECT_P2P="dis_p2p",o.ABORT_P2P_EXECUTION="abort_p2p_execution",o.NEED_RENEW_SESSION="need-sid",o.REPORT_JOIN_GATEWAY="report_join_gateway",o.REQUEST_TIMEOUT="request_timeout",o.REQUEST_SUCCESS="request_success",o.JOIN_RESPONSE="join_response",o.DATACHANNEL_PRECONNECT="datachannel_preconnect",o.DATACHANNEL_CONNECTING="datachannel_connecting",o.DATACHANNEL_FAILBACK="datachannel_failback",o.P2P_START="p2p_start",o.P2P_CONNECTION="p2p_connection",o.P2P_REMOTE_CANDIDATE_UPDATE="p2p_remote_candidate_update",o.P2P_SUBSCRIBE="p2p_subscribe",o.P2P_UNSUBSCRIBE="p2p_unsubscribe",o.P2P_EXCHANGE_SDP="p2p_exchange_sdp",o.P2P_ON_ADD_VIDEO_STREAM="p2p_on_add_video_stream",o.P2P_ON_ADD_AUDIO_STREAM="p2p_on_add_audio_stream"}(Be||(Be={})),function(o){o.PING="ping",o.PING_BACK="ping_back",o.JOIN="join_v3",o.REJOIN="rejoin_v3",o.LEAVE="leave",o.SET_CLIENT_ROLE="set_client_role",o.PUBLISH="publish",o.PUBLISH_DATASTREAM="publish_datastream",o.UNPUBLISH="unpublish",o.UNPUBLISH_DATASTREAM="unpublish_datastream",o.SUBSCRIBE="subscribe",o.SUBSCRIBE_DATASTREAM="subscribe_datastream",o.SUBSCRIBE_STREAMS="subscribe_streams",o.UNSUBSCRIBE="unsubscribe",o.UNSUBSCRIBE_DATASTREAM="unsubscribe_datastream",o.UNSUBSCRIBE_STREAMS="unsubscribe_streams",o.SUBSCRIBE_CHANGE="subscribe_change",o.TRAFFIC_STATS="traffic_stats",o.RENEW_TOKEN="renew_token",o.SWITCH_VIDEO_STREAM="switch_video_stream",o.DEFAULT_VIDEO_STREAM="default_video_stream",o.SET_FALLBACK_OPTION="set_fallback_option",o.GATEWAY_INFO="gateway_info",o.CONTROL="control",o.SEND_METADATA="send_metadata",o.DATA_STREAM="data_stream",o.PICK_SVC_LAYER="pick_svc_layer",o.RESTART_ICE="restart_ice",o.CONNECT_PC="connect_pc",o.SET_VIDEO_PROFILE="set_video_profile",o.SET_PARAMETER="set_parameter",o.SET_RTM2_FLAG="set_rtm2_flag"}(nt||(nt={})),function(o){o.PUBLISH_STATS="publish_stats",o.PUBLISH_RELATED_STATS="publish_related_stats",o.SUBSCRIBE_STATS="subscribe_stats",o.SUBSCRIBE_RELATED_STATS="subscribe_related_stats",o.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",o.DENOISER_STATS="denoiser_stats",o.TRANSPORT_STATS="transport_stats",o.EXTENSION_USAGE_STATS="extension_usage_stats"}(lo||(lo={})),function(o){o.ON_USER_ONLINE="on_user_online",o.ON_USER_OFFLINE="on_user_offline",o.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",o.ON_PUBLISH_STREAM="on_publish_stream",o.ON_UPLINK_STATS="on_uplink_stats",o.ON_P2P_LOST="on_p2p_lost",o.ON_REMOVE_STREAM="on_remove_stream",o.ON_ADD_AUDIO_STREAM="on_add_audio_stream",o.ON_ADD_VIDEO_STREAM="on_add_video_stream",o.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",o.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",o.ON_USER_BANNED="on_user_banned",o.ON_USER_LICENSE_BANNED="on_user_license_banned",o.ON_NOTIFICATION="on_notification",o.ON_CRYPT_ERROR="on_crypt_error",o.MUTE_AUDIO="mute_audio",o.MUTE_VIDEO="mute_video",o.UNMUTE_AUDIO="unmute_audio",o.UNMUTE_VIDEO="unmute_video",o.ON_P2P_OK="on_p2p_ok",o.RECEIVE_METADATA="receive_metadata",o.ON_DATA_STREAM="on_data_stream",o.ON_RTP_CAPABILITY_CHANGE="on_rtp_capability_change",o.ON_REMOTE_DATASTREAM_UPDATE="on_remote_datastream_update",o.ON_REMOTE_FULL_DATASTREAM_INFO="on_remote_full_datastream_info",o.ENABLE_LOCAL_VIDEO="enable_local_video",o.DISABLE_LOCAL_VIDEO="disable_local_video",o.ENABLE_LOCAL_AUDIO="enable_local_audio",o.DISABLE_LOCAL_AUDIO="disable_local_audio",o.ON_PUBLISHED_USER_LIST="on_published_user_list"}(St||(St={})),function(o){o.CONNECTION_STATE_CHANGE="CONNECTION_STATE_CHANGE",o.NEED_ANSWER="NEED_ANSWER",o.NEED_RENEGOTIATE="NEED_RENEGOTIATE",o.P2P_LOST="P2P_LOST",o.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",o.NEED_UNPUB="NEED_UNPUB",o.NEED_UNSUB="NEED_UNSUB",o.NEED_UPLOAD="NEED_UPLOAD",o.NEED_CONTROL="NEED_CONTROL",o.START_RECONNECT="START_RECONNECT",o.END_RECONNECT="END_RECONNECT",o.NEED_SIGNAL_RTT="NEED_SIGNAL_RTT"}(UW||(UW={})),function(o){o.SEND_ONLY="SEND_ONLY",o.RECEIVE_ONLY="RECEIVE_ONLY"}(q_||(q_={})),function(o){o.CONNECTED="websocket:connected",o.RECONNECTING="websocket:reconnecting",o.WILL_RECONNECT="websocket:will_reconnect",o.CLOSED="websocket:closed",o.FAILED="websocket:failed",o.ON_MESSAGE="websocket:on_message",o.REQUEST_NEW_URLS="websocket:request_new_urls",o.RECONNECT_WAITTING_FINISH="websocket:reconnect_waitting_finish",o.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection",o.ON_TOKEN_PRIVILEGE_DID_EXPIRE="websocket:on_token_privilege_did_expire"}(mt||(mt={}));class ae extends Ee{constructor(i){super(i,arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",arguments.length>2?arguments[2]:void 0),O(this,"name","AgoraRTCException")}print(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error";return super.print(i,D)}throw(){super.throw(D)}}function S2(o){if(typeof o!="string"||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(o))throw D.error("Invalid Channel Name ".concat(o)),new ae(z.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function T2(o){if(i=o,!(typeof i=="number"&&Math.floor(i)===i&&0<=i&&i<=4294967295||m8(o,1,255)))throw new ae(z.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");var i;typeof o=="string"&&D.warn("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}(function(o){o.TRANSCODE="mix_streaming",o.RAW="raw_streaming",o.INJECT="inject_streaming"})(zi||(zi={})),function(o){o[o.INJECT_STREAM_STATUS_START_SUCCESS=0]="INJECT_STREAM_STATUS_START_SUCCESS",o[o.INJECT_STREAM_STATUS_START_ALREADY_EXISTS=1]="INJECT_STREAM_STATUS_START_ALREADY_EXISTS",o[o.INJECT_STREAM_STATUS_START_UNAUTHORIZED=2]="INJECT_STREAM_STATUS_START_UNAUTHORIZED",o[o.INJECT_STREAM_STATUS_START_TIMEOUT=3]="INJECT_STREAM_STATUS_START_TIMEOUT",o[o.INJECT_STREAM_STATUS_START_FAILED=4]="INJECT_STREAM_STATUS_START_FAILED",o[o.INJECT_STREAM_STATUS_STOP_SUCCESS=5]="INJECT_STREAM_STATUS_STOP_SUCCESS",o[o.INJECT_STREAM_STATUS_STOP_NOT_FOUND=6]="INJECT_STREAM_STATUS_STOP_NOT_FOUND",o[o.INJECT_STREAM_STATUS_STOP_UNAUTHORIZED=7]="INJECT_STREAM_STATUS_STOP_UNAUTHORIZED",o[o.INJECT_STREAM_STATUS_STOP_TIMEOUT=8]="INJECT_STREAM_STATUS_STOP_TIMEOUT",o[o.INJECT_STREAM_STATUS_STOP_FAILED=9]="INJECT_STREAM_STATUS_STOP_FAILED",o[o.INJECT_STREAM_STATUS_BROKEN=10]="INJECT_STREAM_STATUS_BROKEN"}(Ph||(Ph={}));const rle={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},b2={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function w2(o,i){jr(o.url,"".concat(i,".url"),1,1e3,!1),Jn(o.x)||Tn(o.x,"".concat(i,".x"),0,1e4),Jn(o.y)||Tn(o.y,"".concat(i,".y"),0,1e4),Jn(o.width)||Tn(o.width,"".concat(i,".width"),0,1e4),Jn(o.height)||Tn(o.height,"".concat(i,".height"),0,1e4),Jn(o.zOrder)||Tn(o.zOrder,"".concat(i,".zOrder"),0,255),Jn(o.alpha)||Tn(o.alpha,"".concat(i,".alpha"),0,1,!1)}const sle={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""},ole={audioBitrate:48,audioChannels:2,audioVolume:100,audioSampleRate:48e3,height:0,width:0,videoBitrate:400,videoFramerate:15,videoGop:30};var mc,Y_,_i,jW,es,il,Rs,xh,gn,ii,Yp,Ui,vI,Yt;function FW(o){if(!o.channelName)throw new ae(z.INVALID_PARAMS,"invalid channelName in info");if(typeof o.uid!="number")throw new ae(z.INVALID_PARAMS,"invalid uid in info, uid must be a number");return o.token&&jr(o.token,"info.token",1,2047),T2(o.uid),S2(o.channelName),!0}(function(o){o.WARNING="@live_uap-warning",o.ERROR="@line_uap-error",o.PUBLISH_STREAM_STATUS="@live_uap-publish-status",o.INJECT_STREAM_STATUS="@live_uap-inject-status",o.WORKER_STATUS="@live_uap-worker-status",o.REQUEST_NEW_ADDRESS="@live_uap-request-address"})(mc||(mc={})),function(o){o.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager"}(Y_||(Y_={})),function(o){o[o.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",o[o.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",o[o.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",o[o.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",o[o.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",o[o.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",o[o.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",o[o.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",o[o.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",o[o.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",o[o.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",o[o.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",o[o.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",o[o.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",o[o.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",o[o.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",o[o.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",o[o.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",o[o.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",o[o.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",o[o.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN"}(_i||(_i={})),function(o){o.CONNECT_FAILED="connect failed",o.CONNECT_TIMEOUT="connect timeout",o.WS_DISCONNECTED="websocket disconnected",o.REQUEST_TIMEOUT="request timeout",o.REQUEST_FAILED="request failed",o.WAIT_STATUS_TIMEOUT="wait status timeout",o.WAIT_STATUS_ERROR="wait status error",o.BAD_STATE="bad state",o.WS_ABORT="ws abort",o.AP_REQUEST_TIMEOUT="AP request timeout",o.AP_JSON_PARSE_ERROR="AP json parse error",o.AP_REQUEST_ERROR="AP request error",o.AP_REQUEST_ABORT="AP request abort"}(jW||(jW={})),function(o){o[o.SetSdkProfile=0]="SetSdkProfile",o[o.SetSourceChannel=1]="SetSourceChannel",o[o.SetSourceUserId=2]="SetSourceUserId",o[o.SetDestChannel=3]="SetDestChannel",o[o.StartPacketTransfer=4]="StartPacketTransfer",o[o.StopPacketTransfer=5]="StopPacketTransfer",o[o.UpdateDestChannel=6]="UpdateDestChannel",o[o.Reconnect=7]="Reconnect",o[o.SetVideoProfile=8]="SetVideoProfile"}(es||(es={})),function(o){o.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",o.NETWORK_CONNECTED="NETWORK_CONNECTED",o.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",o.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",o.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",o.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",o.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",o.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",o.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",o.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE"}(il||(il={})),function(o){o.RELAY_STATE_IDLE="RELAY_STATE_IDLE",o.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",o.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",o.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE"}(Rs||(Rs={})),function(o){o.RELAY_OK="RELAY_OK",o.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",o.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",o.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED"}(xh||(xh={})),function(o){o.High="high",o.Low="low",o.Audio="audio",o.Screen="screen",o.ScreenLow="screen_low"}(gn||(gn={})),function(o){o.DISCONNECT="disconnect",o.CONNECTION_STATE_CHANGE="connection-state-change",o.NETWORK_QUALITY="network-quality",o.STREAM_TYPE_CHANGE="stream-type-change",o.IS_P2P_DISCONNECTED="is-p2p-dis",o.DISCONNECT_P2P="dis-p2p",o.REQUEST_NEW_GATEWAY_LIST="req-gate-url",o.NEED_RENEW_SESSION="need-sid",o.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",o.JOIN_RESPONSE="join-response",o.REQUEST_DC_CONNECTION_PARAMS="request-dc-connection-params",o.RESET_CONNECTION_EVENTS="reset-connection-events",o.DATACHANNEL_PRECONNECT="datachannel_preconnect",o.DATACHANNEL_FAILBACK="datachannel_failback",o.RESET_SIGNAL="reset-signal"}(ii||(ii={})),function(o){o.P2P_DISCONNECTED="P2P_DISCONNECTED",o.A_ROUND_WS_FAILED="A_ROUND_WS_FAILED",o.TIMEOUT="TIMEOUT",o.UNKNOWN_REASON="UNKNOWN_REASON"}(Yp||(Yp={})),function(o){o[o.Nothing=0]="Nothing",o[o.Audio=1]="Audio",o[o.LwoVideo=2]="LwoVideo",o[o.Video=4]="Video",o[o.Data=8]="Data",o[o.DataStream0=256]="DataStream0",o[o.DataStream1=512]="DataStream1",o[o.DataStream2=1024]="DataStream2",o[o.DataStream3=2048]="DataStream3",o[o.DataStream4=4096]="DataStream4",o[o.DataStream5=8192]="DataStream5",o[o.DataStream6=16384]="DataStream6",o[o.DataStream7=32768]="DataStream7"}(Ui||(Ui={})),function(o){o[o.websocket=0]="websocket",o[o.datachannel=1]="datachannel"}(vI||(vI={})),function(o){o.CHINA="CHINA",o.ASIA="ASIA",o.NORTH_AMERICA="NORTH_AMERICA",o.EUROPE="EUROPE",o.JAPAN="JAPAN",o.INDIA="INDIA",o.KOREA="KOREA",o.HKMC="HKMC",o.US="US",o.OCEANIA="OCEANIA",o.SOUTH_AMERICA="SOUTH_AMERICA",o.AFRICA="AFRICA",o.OVERSEA="OVERSEA",o.GLOBAL="GLOBAL",o.EXTENSIONS="EXTENSIONS"}(Yt||(Yt={}));const VW=[Yt.AFRICA,Yt.ASIA,Yt.CHINA,Yt.EUROPE,Yt.GLOBAL,Yt.INDIA,Yt.JAPAN,Yt.NORTH_AMERICA,Yt.OCEANIA,Yt.OVERSEA,Yt.SOUTH_AMERICA];var Ir;(function(o){o.CHINA="CN",o.ASIA="AS",o.NORTH_AMERICA="NA",o.EUROPE="EU",o.JAPAN="JP",o.INDIA="IN",o.KOREA="KR",o.HKMC="HK",o.US="US",o.OCEANIA="OC",o.SOUTH_AMERICA="SA",o.AFRICA="AF",o.OVERSEA="OVERSEA",o.GLOBAL="GLOBAL",o.EXTENSIONS="GLOBAL"})(Ir||(Ir={}));const yI={CHINA:{},ASIA:{CODE:Ir.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:Ir.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:Ir.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:Ir.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","	uap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:Ir.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:Ir.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:Ir.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:Ir.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:Ir.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:Ir.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:Ir.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:Ir.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:Ir.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]},EXTENSIONS:{}};var Y0,BW,Qe,Fr,rl,Te,Xt,ut,WW,oa,aa,Gi,Ql,hi,sl,HW,Lo,Fa,Dh,Pn,Zl,$W;g2&&(yI.CHINA={CODE:Ir.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]}),function(o){o.UPDATE_BITRATE_LIMIT="update_bitrate_limit"}(Y0||(Y0={}));class zW extends Hn{constructor(i,s){super(),O(this,"onICEConnectionStateChange",void 0),O(this,"onConnectionStateChange",void 0),O(this,"onDTLSTransportStateChange",void 0),O(this,"onDTLSTransportError",void 0),O(this,"onICETransportStateChange",void 0),O(this,"onFirstAudioReceived",void 0),O(this,"onFirstVideoReceived",void 0),O(this,"onFirstAudioDecoded",void 0),O(this,"onFirstVideoDecoded",void 0),O(this,"onFirstVideoDecodedTimeout",void 0),O(this,"onSelectedLocalCandidateChanged",void 0),O(this,"onSelectedRemoteCandidateChanged",void 0)}}class SI extends zW{constructor(i,s){super(i,s)}}(function(o){o.SEND="sendonly",o.RECV="recvonly",o.SENDRECV="sendrecv",o.INACTIVE="inactive"})(BW||(BW={})),function(o){o.VIDEO="video",o.AUDIO="audio"}(Qe||(Qe={})),function(o){o[o.UDP=0]="UDP",o[o.TCP=1]="TCP",o[o.RELAY=2]="RELAY"}(Fr||(Fr={})),function(o){o[o.FIRST_CONNECTION=0]="FIRST_CONNECTION",o[o.TCP_RESTART=1]="TCP_RESTART",o[o.RELAY_RESTART=2]="RELAY_RESTART",o[o.OLD_FIRST_CONNECTION=10]="OLD_FIRST_CONNECTION",o[o.OLD_RESTART=11]="OLD_RESTART",o[o.DISCONNECTED_OR_FAILED=20]="DISCONNECTED_OR_FAILED"}(rl||(rl={})),function(o){o.LocalVideoTrack="videoTrack",o.LocalAudioTrack="audioTrack",o.LocalVideoLowTrack="videoLowTrack"}(Te||(Te={})),function(o){o.New="new",o.Connected="connected",o.Reconnecting="reconnecting",o.Disconnected="disconnected"}(Xt||(Xt={})),function(o){o.StateChange="stateChange",o.IceConnectionStateChange="iceConnectionStateChange",o.RequestMuteLocal="requestMuteLocal",o.RequestUnmuteLocal="requestUnmuteLocal",o.RequestRePublish="requestRePublish",o.RequestRePublishDataChannel="requestRePublishDataChannel",o.RequestReSubscribe="requestReSubscribe",o.RequestUploadStats="requestUploadStats",o.MediaReconnectStart="MediaReconnectStart",o.MediaReconnectEnd="MediaReconnectEnd",o.NeedSignalRTT="NeedSignalRTT",o.RequestRestartICE="RequestRestartIce",o.PeerConnectionStateChange="PeerConnectionStateChange",o.RequestReconnect="RequestReconnect",o.RequestReconnectPC="RequestReconnectPC",o.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",o.P2PLost="P2PLost",o.UpdateVideoEncoder="UpdateVideoEncoder",o.ConnectionTypeChange="ConnectionTypeChange",o.RequestLowStreamParameter="RequestLowStreamParameter",o.QueryClientConnectionState="QueryClientConnectionState",o.LocalCandidate="LocalCandidate",o.RequestP2PMuteLocal="requestP2PMuteLocal",o.RequestP2PPublish="RequestP2PPublish",o.RequestP2PUnPublish="RequestP2PUnPublish",o.RequestP2PUnmuteRemote="RequestP2PUnmuteRemote",o.RequestP2PMuteRemote="RequestP2PMuteRemote",o.RequestP2PRestartICE="RequestP2PRestartICE"}(ut||(ut={})),function(o){o.MUTE_LOCAL_VIDEO="mute_local_video",o.MUTE_LOCAL_AUDIO="mute_local_audio",o.UNMUTE_LOCAL_VIDEO="unmute_local_video",o.UNMUTE_LOCAL_AUDIO="unmute_local_audio",o.MUTE_REMOTE_VIDEO="mute_remote_video",o.MUTE_REMOTE_AUDIO="mute_remote_audio",o.UNMUTE_REMOTE_VIDEO="unmute_remote_video",o.UNMUTE_REMOTE_AUDIO="unmute_remote_audio"}(WW||(WW={})),function(o){o.CONNECTING="CONNECTING",o.RECONNECTING="RECONNECTING",o.CONNECTED="CONNECTED",o.CLOSED="CLOSED"}(oa||(oa={})),function(o){o[o.CONNECT_AP=0]="CONNECT_AP",o[o.AP_CONNECTED=1]="AP_CONNECTED",o[o.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",o[o.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",o[o.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",o[o.CONNECT_WORKER=5]="CONNECT_WORKER",o[o.WORKER_CONNECTED=6]="WORKER_CONNECTED",o[o.CLOSED=7]="CLOSED"}(aa||(aa={})),function(o){o.CONNECTION_STATE_CHANGE="connection-state-change",o.STATE_CHANGE="state-change",o.INSPECT_RESULT="inspect-result",o.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",o.REQUEST_NEW_WORKER_URL="request-new-worker-url"}(Gi||(Gi={})),function(o){o.NETWORK_ERROR="NETWORK_ERROR",o.SERVER_ERROR="SERVER_ERROR",o.MULTI_IP="MULTI_IP",o.TIMEOUT="TIMEOUT",o.OFFLINE="OFFLINE",o.LEAVE="LEAVE",o.P2P_FAILED="P2P_FAILED",o.FALLBACK="FALLBACK"}(Ql||(Ql={})),function(o){o.CONNECTED="transmitter:connected",o.RECONNECTING="transmitter:reconnecting",o.WILL_RECONNECT="transmitter:will_reconnect",o.CLOSED="transmitter:closed",o.FAILED="transmitter:failed",o.ON_MESSAGE="transmitter:on_message",o.REQUEST_NEW_URLS="transmitter:request_new_urls",o.RECONNECT_WAITTING_FINISH="transmitter:reconnect_waitting_finish",o.RECONNECT_CREATE_CONNECTION="transmitter:reconnect_create_connection",o.ON_TOKEN_PRIVILEGE_DID_EXPIRE="transmitter:on_token_privilege_did_expire",o.TO_CONNECT_DATACHANNEL="transmitter:to_connect_datachannel",o.FAILBACK="transmitter:failback"}(hi||(hi={})),function(o){o.CAMERA_CHANGED="camera-changed",o.MICROPHONE_CHANGED="microphone-changed",o.PLAYBACK_DEVICE_CHANGED="playback-device-changed",o.AUDIO_AUTOPLAY_FAILED="audio-autoplay-failed",o.AUTOPLAY_FAILED="autoplay-failed",o.SECURITY_POLICY_VIOLATION="security-policy-violation"}(sl||(sl={})),function(o){o[o.APP_TYPE_INVALID_VALUE=-1]="APP_TYPE_INVALID_VALUE",o[o.APP_TYPE_NATIVE=0]="APP_TYPE_NATIVE",o[o.APP_TYPE_NATIVE_COCOS=1]="APP_TYPE_NATIVE_COCOS",o[o.APP_TYPE_NATIVE_UNITY=2]="APP_TYPE_NATIVE_UNITY",o[o.APP_TYPE_NATIVE_ELECTRON=3]="APP_TYPE_NATIVE_ELECTRON",o[o.APP_TYPE_NATIVE_FLUTTER=4]="APP_TYPE_NATIVE_FLUTTER",o[o.APP_TYPE_NATIVE_UNREAL=5]="APP_TYPE_NATIVE_UNREAL",o[o.APP_TYPE_NATIVE_XAMARIN=6]="APP_TYPE_NATIVE_XAMARIN",o[o.APP_TYPE_NATIVE_API_CLOUD=7]="APP_TYPE_NATIVE_API_CLOUD",o[o.APP_TYPE_NATIVE_REACT_NATIVE=8]="APP_TYPE_NATIVE_REACT_NATIVE",o[o.APP_TYPE_NATIVE_PYTHON=9]="APP_TYPE_NATIVE_PYTHON",o[o.APP_TYPE_NATIVE_COCOS_CREATOR=10]="APP_TYPE_NATIVE_COCOS_CREATOR",o[o.APP_TYPE_NATIVE_RUST=11]="APP_TYPE_NATIVE_RUST",o[o.APP_TYPE_NATIVE_C_SHARP=12]="APP_TYPE_NATIVE_C_SHARP",o[o.APP_TYPE_NATIVE_CEF=13]="APP_TYPE_NATIVE_CEF",o[o.APP_TYPE_NATIVE_UNI_APP=14]="APP_TYPE_NATIVE_UNI_APP",o[o.APP_TYPE_WEBRTC=1e3]="APP_TYPE_WEBRTC",o[o.APP_TYPE_WEBRTC_REACT=1001]="APP_TYPE_WEBRTC_REACT",o[o.APP_TYPE_WEBRTC_VUE=1002]="APP_TYPE_WEBRTC_VUE",o[o.APP_TYPE_WEBRTC_ANGULAR=1003]="APP_TYPE_WEBRTC_ANGULAR"}(HW||(HW={})),function(o){o.CONNECTING="CONNECTING",o.RECONNECTING="RECONNECTING",o.CONNECTED="CONNECTED",o.CLOSED="CLOSED"}(Lo||(Lo={})),function(o){o.CONNECTION_STATE_CHANGE="connection-state-change",o.STATE_CHANGE="state-change",o.INSPECT_RESULT="inspect-result",o.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",o.REQUEST_NEW_WORKER_URL="request-new-worker-url"}(Fa||(Fa={})),function(o){o[o.CONNECT_AP=0]="CONNECT_AP",o[o.AP_CONNECTED=1]="AP_CONNECTED",o[o.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",o[o.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",o[o.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",o[o.CONNECT_WORKER=5]="CONNECT_WORKER",o[o.WORKER_CONNECTED=6]="WORKER_CONNECTED",o[o.CLOSED=7]="CLOSED"}(Dh||(Dh={})),function(o){o.CALL="call",o.CANDIDATE="candidate",o.PUBLISH="publish",o.UNPUBLISH="unpublish",o.SUBSCRIBE="subscribe",o.UNSUBSCRIBE="unsubscribe",o.CONTROL="control",o.RESTART_ICE="restart_ice",o.ACK="ack",o.JOIN="join",o.EXCHANGE_SDP="exchange_sdp",o.DO_SUBSCRIBE="do_subscribe",o.DO_UNSUBSCRIBE="do_unsubscribe"}(Pn||(Pn={})),function(o){o.MUTE_LOCAL_AUDIO="mute_local_audio",o.MUTE_LOCAL_VIDEO="mute_local_video",o.UNMUTE_LOCAL_AUDIO="unmute_local_audio",o.UNMUTE_LOCAL_VIDEO="unmute_local_video"}(Zl||(Zl={})),function(o){o[o.SUCCESS=1]="SUCCESS",o[o.FAILED=0]="FAILED"}($W||($W={}));const ale={[K_.ACCESS_POINT]:{[Zr.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[Zr.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[Zr.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[Zr.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[Zr.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[Zr.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[Zr.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[Zr.NO_SERVICE_AVAILABLE_VOICE]:{desc:"no unilbs voice service available",retry:!0},[Zr.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[Zr.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[Zr.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[Zr.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[Zr.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[Zr.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[Zr.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[Zr.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[Zr.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[Zr.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[K_.UNILBS]:{[sa.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[sa.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[sa.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[sa.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[sa.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[sa.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[sa.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[sa.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[sa.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[sa.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[sa.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[sa.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1}},[K_.STRING_UID_ALLOCATOR]:{[q0.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[q0.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[q0.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function TI(o){const i=ale[Math.floor(o/1e4)];if(!i)return{desc:"unkonw error",retry:!1};const s=i[o%1e4];if(!s){if(Math.floor(o/1e4)===K_.ACCESS_POINT){const a=o%1e4;if(a.toString()[0]==="1")return{desc:o.toString(),retry:!1};if(a.toString()[0]==="2")return{desc:o.toString(),retry:!0}}return{desc:"unkonw error",retry:!1}}return s}const cle={[lt.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[lt.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[lt.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[lt.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[lt.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[lt.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[lt.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[lt.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[lt.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[lt.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[lt.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[lt.K_AUTO_REBALANCE]:{desc:"k_AUTO_REBALANCE",action:"recover"},[lt.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[lt.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[lt.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[lt.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[lt.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[lt.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[lt.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[lt.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[lt.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[lt.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[lt.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[lt.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[lt.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[lt.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[lt.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[lt.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[lt.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[lt.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[lt.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[lt.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[lt.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[lt.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[lt.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[lt.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[lt.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[lt.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[lt.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[lt.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[lt.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[lt.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[lt.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[lt.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[lt.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[lt.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[lt.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[lt.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[lt.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[lt.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[lt.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[lt.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[lt.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[lt.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[lt.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[lt.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[lt.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"},[lt.ERR_LICENSE_ILLEGAL]:{desc:"ERR_LICENSE_ILLEGAL",action:"quit"},[lt.ERR_LICENSE_MISSING]:{desc:"ERR_LICENSE_MISSING",action:"quit"},[lt.ERR_LICENSE_EXPIRED]:{desc:"ERR_LICENSE_EXPIRED",action:"quit"},[lt.ERR_LICENSE_MINUTES_EXCEEDED]:{desc:"ERR_LICENSE_MINUTES_EXCEEDED",action:"quit"},[lt.ERR_LICENSE_PERIOD_INVALID]:{desc:"ERR_LICENSE_PERIOD_INVALID",action:"quit"},[lt.ERR_LICENSE_MULTIPLE_SDK_SERVICE]:{desc:"ERR_LICENSE_MULTIPLE_SDK_SERVICE",action:"quit"}};function Xp(o){return cle[o]||{desc:"UNKNOW_ERROR_".concat(o),action:"failed"}}function GW(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function C2(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?GW(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):GW(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}function KW(o){return o.every(i=>i.readyState===WebSocket.CLOSED||i.readyState===WebSocket.CLOSING)}function qW(o,i){if(typeof o=="string")return o;const{proxy:s,host:a,port:u}=o;if(i){const h=te("JOIN_GATEWAY_FALLBACK_PORT")||443;return h===443?"wss://".concat(a,"/ws/?p=").concat(Number(u)+150):"wss://".concat(a,":").concat(h,"/ws/?p=").concat(Number(u)+150)}return s?"wss://".concat(s,"/ws/?h=").concat(a,"&p=").concat(u):"wss://".concat(a,":").concat(u)}const lle=/wss:\/\/(.+)\/ws\/\?h=(.+)&p=([0-9]+)\/?/,ule=/wss:\/\/(.+)\/ws\/\?p=([0-9]+)\/?/,dle=/wss:\/\/(.+):([0-9]+)\/?/,hle=/wss:\/\/(.[^\/]+)\/?/;let fle=0;class ple{constructor(i,s){O(this,"id",0),O(this,"store",void 0),O(this,"recordIndex",void 0),O(this,"websockets",[]),O(this,"try443PortDuration",2e3),O(this,"forceCloseWSDuration",5e3),O(this,"try443PortTimeout",null),O(this,"forceCloseTimeout",null),O(this,"isTry443PortFailed",!1),O(this,"isNormalPortFailed",!1),O(this,"useDoubleDomain",!1),O(this,"useProxy",!1),O(this,"startTime",Date.now()),this.id=++fle,this.try443PortDuration=te("JOIN_GATEWAY_TRY_443PORT_DURATION")||2e3,this.forceCloseWSDuration=i||5e3,this.store=s}closeAllWebsockets(){this.websockets.forEach(i=>{i.onopen=null,i.onclose=null,i.onmessage=null,i.close()}),this.websockets.length=0}clearTimeout(){this.forceCloseTimeout&&clearTimeout(this.forceCloseTimeout),this.try443PortTimeout&&clearTimeout(this.try443PortTimeout)}logger(){var i;const s=Date.now()-this.startTime;for(var a=arguments.length,u=new Array(a),h=0;h<a;h++)u[h]=arguments[h];D.debug("[choose-best-ws ".concat((i=this.store)===null||i===void 0?void 0:i.clientId," ").concat(this.id,"] ").concat(s,"ms:"),...u)}createWebSocket(i,s,a){this.logger("createWebSocket:",i,{isTry443Port:s,hasTimeoutDetection:a});const u=te("GATEWAY_DOMAINS"),h=Date.now(),p=[],_=u.find(b=>{var C;return ot(C=i.host).call(C,b)});_||(this.useDoubleDomain=!1);const v=[];if(this.useDoubleDomain)u.forEach(b=>{v.push(qW(C2(C2({},i),{},{host:i.host.replace(_,b)}),s))});else{const b=C2({},i);if(s&&_){const C=u.find(N=>N!==_);C&&(b.host=b.host.replace(_,C))}v.push(qW(b,s))}try{v.forEach(b=>{const C=new WebSocket(b);C.binaryType="arraybuffer",p.push(C),this.logger("ws is connecting:",C.url)})}catch(b){if(this.logger("ws create failed"),p.forEach(C=>C.close()),p.length=0,this.useDoubleDomain)return this.useDoubleDomain=!1,this.createWebSocket(i,s,a);if(!s&&Number(i.port)!==443)return this.createWebSocket(i,!0,a);throw new ae(z.WS_ERR,"init websocket failed! Error: ".concat(b.toString()))}const T=W0();return this.store&&this.store.recordJoinChannelService({urls:p.map(b=>b.url),service:"gateway"},this.recordIndex),p.forEach(b=>{b.onopen=()=>{this.logger("onopen: ws ".concat(b.url," open cost ").concat(Date.now()-h,"ms")),this.websockets.forEach(C=>{C!==b&&(C.onopen=null,C.onclose=null,C.onmessage=null,C.close(),this.logger("close backup websocket: ".concat(C.url)))}),this.websockets.length=0,T.resolve(b)},b.onclose=C=>{this.logger("onclose: ws ".concat(b.url," closed cost ").concat(Date.now()-h,"ms state: ").concat(b.readyState)),s?this.isTry443PortFailed=KW(p):this.isNormalPortFailed=KW(p),this.logger("443: ".concat(this.useProxy?"not try":this.isTry443PortFailed?"failed":"trying"," 47xx: ").concat(this.isNormalPortFailed?"failed":"trying")),(s&&this.isTry443PortFailed||!s&&(this.isTry443PortFailed||this.useProxy)&&this.isNormalPortFailed)&&(this.logger("onclose: all websocket is closed, ".concat(C.reason)),T.reject({code:C.code,reason:Yp.A_ROUND_WS_FAILED}))},b.onmessage=C=>this.logger("".concat(b.url," onmessage: ").concat(C.data))}),this.websockets.push(...p),a||(()=>{const b=()=>{this.logger("5s timeout close un-opens, isWebsocket created: ",T.isResolved),this.websockets.forEach(C=>C.readyState!==WebSocket.OPEN&&C.close())};if(s||this.useProxy)return this.logger("add 5s timeout at ".concat(s?"try-443":"proxy"," condition")),this.forceCloseTimeout=window.setTimeout(b,this.forceCloseWSDuration);this.try443PortTimeout=window.setTimeout(()=>{if(this.logger("2s timeout, isWebsocket created: ",T.isResolved),T.isResolved)return b();Zt().os===tr.MAC_OS&&jn()&&b(),this.createWebSocket(i,!0,!0).then(C=>T.resolve(C)).catch(C=>{this.isNormalPortFailed&&T.reject(C),this.logger("try 443 port to create ws failed")}),this.forceCloseTimeout=window.setTimeout(b,this.forceCloseWSDuration)},this.try443PortDuration)})(),T.promise}chooseBestWebsocket(i,s,a,u){return this.useDoubleDomain=!!s,typeof i=="string"&&(i=function(h){let p,_,v;return[,p,_,v]=h.match(lle)||[],p||([,_,v]=h.match(ule)||[]),_&&v||([,_,v]=h.match(dle)||[]),_&&v||([,_]=h.match(hle)||[]),_||D.warning("un-destructible url: ",h),{proxy:p,host:_,port:v||"443"}}(i)),this.recordIndex=u,this.useProxy=!!i.proxy,a&&this.useProxy&&(D.warn("cannot use 443 only when use proxy"),a=!1),this.createWebSocket(i,!!a,!1).finally(()=>this.clearTimeout())}}function YW(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}class XW extends Hn{get url(){return this.websocket&&this.websocket.url||null}get reconnectMode(){return this._reconnectMode}set reconnectMode(i){var s;ot(s=["tryNext","recover"]).call(s,i)&&this.resetReconnectCount(i),this._reconnectMode=i}get state(){return this._state}set state(i){i!==this._state&&(this._state=i,this._state==="reconnecting"?this.emit(mt.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(mt.CONNECTED):this._state==="closed"?this.emit(mt.CLOSED):this._state==="failed"&&this.emit(mt.FAILED))}resetReconnectCount(i){D.debug("websocket reset reconnect count, reason: "+i),this.reconnectCount=0}constructor(i,s){let a=arguments.length>2&&arguments[2]!==void 0&&arguments[2],u=arguments.length>3&&arguments[3]!==void 0&&arguments[3],h=arguments.length>4&&arguments[4]!==void 0&&arguments[4],p=arguments.length>5?arguments[5]:void 0;super(),O(this,"connectionID",0),O(this,"currentURLIndex",0),O(this,"urls",[]),O(this,"_reconnectMode","tryNext"),O(this,"reconnectReason",void 0),O(this,"_initMutex",new fr("websocket")),O(this,"name",void 0),O(this,"_state","closed"),O(this,"reconnectInterrupter",void 0),O(this,"websocket",void 0),O(this,"retryConfig",void 0),O(this,"reconnectCount",0),O(this,"forceCloseTimeout",5e3),O(this,"onlineReconnectListener",void 0),O(this,"useCompress",void 0),O(this,"tryDoubleDomain",!1),O(this,"use443PortOnly",!1),O(this,"wsInflateLength",0),O(this,"wsDeflateLength",0),O(this,"closeEstablishingWs",()=>{}),O(this,"store",void 0),O(this,"joinGatewayRecordIndex",void 0),this.store=p,this.name=i,this.retryConfig=function(C){for(var N=1;N<arguments.length;N++){var x=arguments[N]!=null?arguments[N]:{};N%2?YW(Object(x),!0).forEach(function(B){O(C,B,x[B])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(x)):YW(Object(x)).forEach(function(B){Object.defineProperty(C,B,Object.getOwnPropertyDescriptor(x,B))})}return C}({},s),this.useCompress=a,this.tryDoubleDomain=u,this.use443PortOnly=h;const{timeout:_,timeoutFactor:v}=s,T=Math.max(300,Math.floor(3*_/5)),b=Math.max(1.2,Math.floor(8*v)/10);ms.ONLINE&&(this.retryConfig.timeout=T,this.retryConfig.timeoutFactor=b),Ii.on(od.NETWORK_STATE_CHANGE,(C,N)=>{C!==N&&(this.resetReconnectCount("network state change: ".concat(N," -> ").concat(C)),C===ms.ONLINE?(this.retryConfig.timeout=T,this.retryConfig.timeoutFactor=b):(this.retryConfig.timeout=_,this.retryConfig.timeoutFactor=v))})}getConnection(){return this.websocket||void 0}async init(i){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const a=await this._initMutex.lock();this.forceCloseTimeout=s,this.urls=i,this.state="connecting";try{const u=W0(),h=this.urls[this.currentURLIndex];this.createWebSocketConnection(h).then(u.resolve).catch(u.reject),this.once(mt.CLOSED,()=>{u.reject(new Ee(z.WS_DISCONNECT))}),this.once(mt.CONNECTED,u.resolve),await u.promise}catch{}finally{a()}}close(i,s){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;const a=this.websocket;s?setTimeout(()=>a.close(),500):a.close(),this.websocket=void 0}this.state=i?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(i,s){if(!this.websocket)return void D.warning("[".concat(this.name,"] can not reconnect, no websocket"));i!==void 0&&(this.reconnectMode=i),D.debug("[".concat(this.name,"] reconnect is triggered initiative")),typeof this.joinGatewayRecordIndex=="number"&&this.store&&this.store.recordJoinChannelService({status:"error",errors:[new Error(s)]},this.joinGatewayRecordIndex);const a=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),a&&a.bind(this.websocket)({code:9999,reason:s})}sendMessage(i){let s=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new Ee(z.WS_ABORT,"websocket is not ready");try{s||(i=JSON.stringify(i)),this.websocket.send(i)}catch(a){throw new Ee(z.WS_ERR,"send websocket message error"+a.toString())}}setWsInflateData(i){this.wsDeflateLength=this.wsDeflateLength+i.originLength,this.wsInflateLength=this.wsInflateLength+i.compressedLength}getWsInflateData(){const i=this.wsInflateLength,s=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:i,wsDeflateLength:s}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}async createWebSocketConnection(i){var s;const a=W0();this.connectionID+=1,this.joinGatewayRecordIndex=void 0;const u=b=>{var C;(C=this.store)===null||C===void 0||C.signalChannelOpen(),D.debug("[".concat(this.name,"] websocket opened:"),b),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),a.resolve()},h=async b=>{var C;if(D.debug("[".concat(this.name,"] websocket close ").concat((C=this.websocket)===null||C===void 0?void 0:C.url,", code: ").concat(b.code,", reason: ").concat(b.reason,", current mode: ").concat(this.reconnectMode)),this.reconnectCount>=this.retryConfig.maxRetryCount)a.reject(new Ee(z.WS_DISCONNECT,"websocket close: ".concat(b.code))),this.close();else{this.state==="connected"&&(this.reconnectReason=b.reason,this.state="reconnecting");const N=oo(this,mt.WILL_RECONNECT,this.reconnectMode,b.reason)||this.reconnectMode,x=await this.reconnectWithAction(N);if(this.state==="closed")return void D.debug("[".concat(this.connectionID,"] ws is closed, no need to reconnect"));if(!x)return a.reject(new Ee(z.WS_DISCONNECT,"websocket reconnect failed: ".concat(b.code))),this.close(!0);a.resolve()}},p=b=>{this.emit(mt.ON_MESSAGE,b)},_=b=>{D.warn("[".concat(this.connectionID,"] ws open error ").concat(b))};this.websocket&&(this.websocket.onclose=null,this.websocket.close()),te("GATEWAY_WSS_ADDRESS")&&this.name.startsWith("gateway")&&(i=te("GATEWAY_WSS_ADDRESS")),D.debug("[".concat(this.name,"] start connect, url:"),i);const v=(s=this.store)===null||s===void 0?void 0:s.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});try{var T;const b=await this.chooseBestWebsocketConnection(i);this.websocket=b,u&&u(this.websocket.url),this.websocket.onclose=h,this.websocket.onmessage=p,this.websocket.onerror=_,(T=this.store)===null||T===void 0||T.recordJoinChannelService({endTs:Date.now(),status:"success"},v),this.joinGatewayRecordIndex=v}catch(b){const C=this.state==="closed",N=b instanceof Ee,x=N&&b.code===z.WS_ABORT,B=N&&b.code===z.WS_ERR,F=N?b.message:b&&(b.reason||b.toString());D.warning("[choose-best-ws] chooseBestWebsocket error: ".concat(F)),this.store&&this.store.recordJoinChannelService({endTs:Date.now(),status:x?"aborted":"error",errors:[b]},v),C||B?(a.reject(C?new Ee(z.WS_DISCONNECT,"websocket is closed: ".concat(F)):new Ee(z.WS_ERR,"init websocket failed: ".concat(F))),B&&D.error("[".concat(this.name,"] init websocket failed: ").concat(F))):h&&h(b)}return a.promise}async reconnectWithAction(i){let s=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this.reconnectCount>=this.retryConfig.maxRetryCount||this.urls.length===0||this.state==="closed")return!1;D.warning("[choose-best-ws] action: =>",i),this.onlineReconnectListener||Ii.isOnline||!Ii.onlineWaiter||(this.onlineReconnectListener=Ii.onlineWaiter.then(()=>{this.onlineReconnectListener=void 0}));let a=!0;if(this.reconnectInterrupter=()=>a=!1,s){const p=aI(this.reconnectCount,this.retryConfig);D.debug("[".concat(this.name,"] wait ").concat(p,"ms to reconnect websocket, mode: ").concat(i)),await le.race([xr(p),this.onlineReconnectListener||new le(()=>{})])}if(this._state==="closed"||!a)return!1;this.reconnectCount+=1;const u=async(p,_)=>{this.emit(mt.RECONNECT_CREATE_CONNECTION,_),await this.createWebSocketConnection(p)};try{if(i==="retry")this.emit(mt.RECONNECT_WAITTING_FINISH,i),await u(this.urls[this.currentURLIndex],i);else if(i==="tryNext"){if(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length)return this.reconnectWithAction("recover",!1);D.debug("[".concat(this.name,"] websocket url length: ").concat(this.urls.length," current index: ").concat(this.currentURLIndex)),this.emit(mt.RECONNECT_WAITTING_FINISH,i),await u(this.urls[this.currentURLIndex],i)}else i==="recover"&&(D.debug("[".concat(this.name,"] request new urls")),this.resetReconnectCount("recover mode"),this.emit(mt.RECONNECT_WAITTING_FINISH,i),this.urls=await Qn(this,mt.REQUEST_NEW_URLS),this.currentURLIndex=0,await u(this.urls[this.currentURLIndex],i))}catch(p){var h;D.error("[".concat(this.name,"] reconnect failed ").concat(p&&p.toString()));const _=p==null||(h=p.data)===null||h===void 0?void 0:h.desc;return Array.isArray(_)&&ot(_).call(_,"dynamic key expired")?(this.emit(mt.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):this.reconnectWithAction(i,s)}return!0}}class X0 extends XW{constructor(i,s){super(i,s,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(i,s){const a=W0(),u=function(p,_){return new ple(p,_)}(this.forceCloseTimeout,this.store);this.closeEstablishingWs=()=>{D.debug("[choose-best-ws] close establishing websockets"),u.closeAllWebsockets(),a.reject(new Ee(z.WS_ABORT,"choose best websocket aborted"))};const h=te("GATEWAY_DOMAINS");return D.debug("[choose-best-ws] currentDomain: ",i,", domains: ",h,"total: ".concat(this.urls.length),"current: ".concat(this.currentURLIndex+1)),u.chooseBestWebsocket(i,this.tryDoubleDomain,this.use443PortOnly,s).then(a.resolve).catch(a.reject),a.promise.finally(()=>{this.closeEstablishingWs=void 0})}}class J0 extends XW{constructor(i,s){super(i,s,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(i,s){return new le((a,u)=>{let h=!1;const p=[];this.closeEstablishingWs=()=>{D.debug("[choose-best-ws] close establishing websockets"),p.forEach(B=>{B.onclose=null,B.onopen=null,B.onmessage=null,B.close()}),u(new Ee(z.WS_ABORT,"choose best websocket aborted"))};const _=te("GATEWAY_DOMAINS");let v;const T=i.indexOf("?h="),b=_.find(B=>T!==-1?ot(i).call(i,B,T):ot(i).call(i,B));D.debug("[choose-best-ws] currentDomain: ",b,", domains: ",_);let C=!this.tryDoubleDomain||!b;if(!C&&b){var N;const B=Date.now();try{_.forEach(F=>{const H=T===-1?i.replace(b,F):i.substr(0,T)+i.substr(T).replace(b,F),J=new WebSocket(H);J.binaryType="arraybuffer",p.push(J),D.debug("[choose-best-ws] ws is connecting:",J.url)})}catch{for(D.debug("[choose-best-ws] ws create failed, fallback to single url"),p.forEach(H=>H.close());p.length;)p.pop();C=!0}(N=this.store)===null||N===void 0||N.recordJoinChannelService({urls:p.map(F=>F.url),service:"gateway"},s),p.forEach(F=>{F.onopen=()=>{if(h)return;const H=Date.now()-B;D.debug("[choose-best-ws] ws open cost ".concat(H,"ms")),p.filter(J=>J!==F).forEach(J=>{D.debug("[choose-best-ws]close backup websocket: ".concat(J.url)),J.close()}),h=!0,a(F)},F.onclose=H=>{v=H,!h&&(p.find(J=>!(J.readyState===WebSocket.CLOSED||J.readyState===WebSocket.CLOSING))||(D.debug("[choose-best-ws] all websocket is closed"),h=!0,u(v)))},F.onmessage=H=>{D.debug("[choose-best-ws]".concat(F.url," onmessage: ").concat(H.data))}}),xr(this.forceCloseTimeout).then(()=>{p.forEach(F=>{F.readyState!==WebSocket.OPEN&&F.close()})})}if(C){var x;let B;D.debug("[choose-best-ws] use single url: ",i),(x=this.store)===null||x===void 0||x.recordJoinChannelService({urls:[i],service:"gateway"},s);try{B=new WebSocket(i),p.push(B),B.binaryType="arraybuffer"}catch(F){const H=new Ee(z.WS_ERR,"init websocket failed! Error: ".concat(F.toString()));return D.error("[".concat(this.name,"]").concat(H)),void u(H)}B.onopen=()=>{a(B)},B.onclose=F=>{u(F)},B.onmessage=F=>{D.debug("[choose-best-ws]".concat(B.url," onmessage: ").concat(F.data))},xr(this.forceCloseTimeout).then(()=>{B&&B.readyState!==WebSocket.OPEN&&B.close()})}}).then(a=>(this.closeEstablishingWs=void 0,a)).catch(a=>{throw this.closeEstablishingWs=void 0,a})}}class JW extends Hn{get connectionState(){return this._connectionState}set connectionState(i){i!==this._connectionState&&(this._connectionState=i,i===It.CONNECTED?this.emit(Be.WS_CONNECTED):i===It.RECONNECTING?this.emit(Be.WS_RECONNECTING,this._websocketReconnectReason):i===It.CLOSED&&this.emit(Be.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(i,s){super(),O(this,"_disconnectedReason",void 0),O(this,"_websocketReconnectReason",void 0),O(this,"_connectionState",It.CLOSED),O(this,"reconnectToken",void 0),O(this,"websocket",void 0),O(this,"openConnectionTime",void 0),O(this,"clientId",void 0),O(this,"lastMsgTime",Date.now()),O(this,"uploadCache",[]),O(this,"uploadCacheInterval",void 0),O(this,"rttRolling",new JM(5)),O(this,"pingpongTimer",void 0),O(this,"wsInflateDataTimer",void 0),O(this,"pingpongTimeoutCount",0),O(this,"joinResponse",void 0),O(this,"multiIpOption",void 0),O(this,"initError",void 0),O(this,"spec",void 0),O(this,"store",void 0),O(this,"onWebsocketMessage",a=>{if(a.data instanceof ArrayBuffer)return void this.emit(Be.ON_BINARY_DATA,a.data);const u=JSON.parse(a.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(u,"_id")){const h="res-@".concat(u._id);this.emit(h,u._result,u._message)}else if(Object.prototype.hasOwnProperty.call(u,"_type")){if(this.emit(u._type,u._message),u._type===St.ON_NOTIFICATION&&this.handleNotification(u._message),u._type===St.ON_USER_BANNED)switch(u._message.error_code){case 14:this.close(Pt.UID_BANNED);break;case 15:this.close(Pt.IP_BANNED);break;case 16:this.close(Pt.CHANNEL_BANNED)}if(u._type===St.ON_USER_LICENSE_BANNED)switch(u._message.error_code){case lt.ERR_LICENSE_MISSING:this.close(Pt.LICENSE_MISSING);break;case lt.ERR_LICENSE_EXPIRED:this.close(Pt.LICENSE_EXPIRED);break;case lt.ERR_LICENSE_MINUTES_EXCEEDED:this.close(Pt.LICENSE_MINUTES_EXCEEDED);break;case lt.ERR_LICENSE_PERIOD_INVALID:this.close(Pt.LICENSE_PERIOD_INVALID);break;case lt.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(Pt.LICENSE_MULTIPLE_SDK_SERVICE);break;case lt.ERR_LICENSE_ILLEGAL:this.close(Pt.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=i.clientId,this.spec=i,this.store=s,this.websocket=new X0("gateway-".concat(this.clientId),this.spec.retryConfig,!0,te("JOIN_GATEWAY_USE_DUAL_DOMAIN"),te("JOIN_GATEWAY_USE_443PORT_ONLY"),s),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===It.CONNECTED&&this.reconnect("retry",ir.OFFLINE)})}async request(i,s,a,u){const h=wn(6,""),p={_id:h,_type:i,_message:s},_=this.websocket.connectionID,v=()=>new le((B,F)=>{if(this.connectionState===It.CONNECTED)return B();const H=()=>{this.off(Be.WS_CLOSED,J),B()},J=()=>{this.off(Be.WS_CONNECTED,H),F(new ae(z.WS_ABORT))};this.once(Be.WS_CONNECTED,H),this.once(Be.WS_CLOSED,J),i!==nt.PUBLISH&&i!==nt.SUBSCRIBE&&i!==nt.UNSUBSCRIBE&&i!==nt.UNPUBLISH&&i!==nt.CONTROL&&i!==nt.RESTART_ICE||this.once(Be.DISCONNECT_P2P,()=>{F(new ae(z.DISCONNECT_P2P))}),i!==nt.PUBLISH&&i!==nt.RESTART_ICE||this.once(Be.ABORT_P2P_EXECUTION,()=>{F(new ae(z.DISCONNECT_P2P))})});if(this.connectionState!==It.CONNECTING&&this.connectionState!==It.RECONNECTING||i===nt.JOIN||i===nt.REJOIN||await v(),this.websocket.sendMessage(p,!0),u)return;const T=new le((B,F)=>{let H=!1;const J=(se,ye)=>{H=!0,B({isSuccess:se==="success",message:ye||{}}),this.off(Be.WS_CLOSED,ee),this.off(Be.WS_RECONNECTING,ee),this.emit(Be.REQUEST_SUCCESS,i,s)};this.once("res-@".concat(h),J);const ee=()=>{F(new ae(z.WS_ABORT,"type: ".concat(i))),this.off(Be.WS_CLOSED,ee),this.off(Be.WS_RECONNECTING,ee),this.off("res-@".concat(h),J)};this.once(Be.WS_CLOSED,ee),this.once(Be.WS_RECONNECTING,ee),xr(te("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==_||H||(D.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(i)),this.emit(Be.REQUEST_TIMEOUT,i,s))})});let b=null;try{b=await T}catch(B){if(this.connectionState===It.CLOSED||i===nt.LEAVE)throw new ae(z.WS_ABORT);return!this.spec.forceWaitGatewayResponse||a?B.throw():i===nt.JOIN||i===nt.REJOIN?null:(await v(),await this.request(i,s))}if(b.isSuccess)return b.message;const C=Number(b.message.error_code||b.message.code),N=Xp(C),x=new ae(z.UNEXPECTED_RESPONSE,"".concat(N.desc,": ").concat(b.message.error_str),{code:C,data:b.message});return N.action==="success"?b.message:(D.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(i,", error_code: ").concat(C,", message: ").concat(N.desc,", action: ").concat(N.action)),C===lt.ERR_TOO_MANY_BROADCASTERS?((i===nt.JOIN||i===nt.REJOIN)&&(this.initError=x,this.close()),x.throw()):N.action==="failed"?x.throw():N.action==="quit"?(this.initError=x,this.close(),x.throw()):(C===lt.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=b.message.option,D.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",ir.MULTI_IP)):this.reconnect(N.action,ir.SERVER_ERROR),i===nt.JOIN||i===nt.REJOIN?null:await this.request(i,s)))}waitMessage(i,s){return new le(a=>{const u=h=>{(!s||s(h))&&(this.off(i,u),a(h))};this.on(i,u)})}upload(i,s){const a={_type:i,_message:s};try{this.websocket.sendMessage(a)}catch{const h=te("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(a),this.uploadCache.length>h&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==It.CONNECTED)return;const p=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(p._type,p._message)},te("UPLOAD_CACHE_INTERVAL")||2e3))}}send(i,s){const a={_type:i,_message:s};this.websocket.sendMessage(a)}init(i,s){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new le((a,u)=>{this.once(Be.WS_CONNECTED,()=>a(this.joinResponse)),this.once(Be.WS_CLOSED,()=>u(this.initError||new ae(z.WS_ABORT))),this.connectionState=It.CONNECTING,this.websocket.init(i).catch(u),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4)})}close(i){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=i||Pt.LEAVE,this.connectionState=It.CLOSED,D.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),i===Pt.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new X0("gateway-".concat(this.clientId),this.spec.retryConfig,!0,te("JOIN_GATEWAY_USE_DUAL_DOMAIN"),te("JOIN_GATEWAY_USE_443PORT_ONLY"),this.store),this.handleWebsocketEvents())}async join(){if(!this.joinResponse){this.emit(Be.ABORT_P2P_EXECUTION);const i=await Qn(this,Be.REQUEST_JOIN_INFO),s=await this.request(nt.JOIN,i);if(!s)return this.emit(Be.REPORT_JOIN_GATEWAY,Yp.TIMEOUT,this.url||""),!1;this.joinResponse=s,this.emit(Be.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=It.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new ae(z.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const i=ad(this,Be.REQUEST_REJOIN_INFO);i.token=this.reconnectToken;const s=await this.request(nt.REJOIN,i);return!!s&&(this.connectionState=It.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),s.peers&&s.peers.forEach(a=>{this.emit(St.ON_USER_ONLINE,{uid:a.uid}),a.audio&&this.emit(St.ON_ADD_AUDIO_STREAM,{uid:a.uid,uint_id:a.uint_id,audio:!0,ssrcId:a.audio_ssrc}),a.video&&this.emit(St.ON_ADD_VIDEO_STREAM,{uid:a.uid,uint_id:a.uint_id,video:!0,ssrcId:a.video_ssrc}),a.audio_mute?this.emit(St.MUTE_AUDIO,{uid:a.uid}):this.emit(St.UNMUTE_AUDIO,{uid:a.uid}),a.video_mute?this.emit(St.MUTE_VIDEO,{uid:a.uid}):this.emit(St.UNMUTE_VIDEO,{uid:a.uid}),a.audio_enable_local?this.emit(St.ENABLE_LOCAL_AUDIO,{uid:a.uid}):this.emit(St.DISABLE_LOCAL_AUDIO,{uid:a.uid}),a.video_enable_local?this.emit(St.ENABLE_LOCAL_VIDEO,{uid:a.uid}):this.emit(St.DISABLE_LOCAL_VIDEO,{uid:a.uid}),a.audio||a.video||this.emit(St.ON_REMOVE_STREAM,{uid:a.uid,uint_id:a.uint_id})}),!0)}reconnect(i,s){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(i,s)}handleNotification(i){D.debug("[".concat(this.clientId,"] receive notification: "),i);const s=Xp(i.code);if(s.action!=="success"){if(s.action!=="failed")return s.action==="quit"?(s.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(Pt.UID_BANNED),void this.close()):void this.reconnect(s.action,ir.SERVER_ERROR);D.error("[".concat(this.clientId,"] ignore error: "),s.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const i=te("PING_PONG_TIME_OUT"),s=Date.now();this.pingpongTimeoutCount>=i&&(D.warning("[".concat(this.clientId,"] PING-PONG Timeout. Last Socket Message: ").concat(s-this.lastMsgTime,"ms")),s-this.lastMsgTime>te("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",ir.TIMEOUT):this.request(nt.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const a=Date.now()-s;this.rttRolling.add(a),te("REPORT_STATS")&&this.send(nt.PING_BACK,{pingpongElapse:a})}).catch(a=>{})}handleWsInflateData(){const{wsInflateLength:i,wsDeflateLength:s}=this.websocket.getWsInflateData();i!==0&&s!==0&&this.upload(lo.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:s,ws_inflate_length:i})}handleWebsocketEvents(){this.websocket.on(mt.RECONNECT_WAITTING_FINISH,i=>{this.emit(Be.WS_RECONNECT_WAITTING_FINISH,i)}),this.websocket.on(mt.RECONNECT_CREATE_CONNECTION,i=>{this.emit(Be.WS_RECONNECT_CREATE_CONNECTION,i)}),this.websocket.on(mt.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(mt.CLOSED,()=>{this.connectionState=It.CLOSED}),this.websocket.on(mt.FAILED,()=>{this._disconnectedReason=Pt.NETWORK_ERROR,this.connectionState=It.CLOSED}),this.websocket.on(mt.RECONNECTING,i=>{this._websocketReconnectReason=i,this.joinResponse=void 0,this.connectionState===It.CONNECTED?this.connectionState=It.RECONNECTING:this.connectionState=It.CONNECTING}),this.websocket.on(mt.WILL_RECONNECT,(i,s,a)=>{const u=ad(this,Be.IS_P2P_DISCONNECTED),h=u||i!=="retry";u&&i==="retry"&&(D.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),i="tryNext",s=Yp.P2P_DISCONNECTED),h&&(D.debug("".concat(this.clientId," will renewSession, reconnect mode: ").concat(i)),this.emit(Be.REPORT_JOIN_GATEWAY,s||Yp.UNKNOWN_REASON,this.url||""),this.reconnectToken=void 0,this.emit(Be.NEED_RENEW_SESSION),this.emit(Be.DISCONNECT_P2P)),a(i)}),this.websocket.on(mt.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(i=>{D.warning("[".concat(this.clientId,"] rejoin failed ").concat(i)),this.reconnect("tryNext",ir.SERVER_ERROR)}):this.join().catch(i=>{if(this.emit(Be.REPORT_JOIN_GATEWAY,i.message||i.code||Yp.UNKNOWN_REASON,this.url||""),i instanceof ae&&i.code===z.UNEXPECTED_RESPONSE&&i.data.code===lt.ERR_NO_AUTHORIZED)return D.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",ir.SERVER_ERROR);D.error("[".concat(this.clientId,"] join gateway request failed"),i.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",ir.SERVER_ERROR):(this.initError=i,this.close())})}),this.websocket.on(mt.REQUEST_NEW_URLS,(i,s)=>{Qn(this,Be.REQUEST_RECOVER,this.multiIpOption).then(i).catch(s)}),this.websocket.on(mt.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(St.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})}}var QW=`	
\v\f\r                　\u2028\u2029\uFEFF`,mle=lp,gle=Oo,R2=QW,ZW=Nt("".replace),_le=RegExp("^["+R2+"]+"),Ele=RegExp("(^|[^"+R2+"])["+R2+"]+$"),I2=function(o){return function(i){var s=gle(mle(i));return 1&o&&(s=ZW(s,_le,"")),2&o&&(s=ZW(s,Ele,"$1")),s}},vle={start:I2(1),end:I2(2),trim:I2(3)},yle=GC.PROPER,Sle=kt,e7=QW,Tle=vle.trim;Kn({target:"String",proto:!0,forced:function(o){return Sle(function(){return!!e7[o]()||"​᠎"[o]()!=="​᠎"||yle&&e7[o].name!==o})}("trim")},{trim:function(){return Tle(this)}});var pr,mr,ble=uc("String").trim,wle=ni,Cle=ble,A2=String.prototype,O2=rn(function(o){var i=o.trim;return typeof o=="string"||o===A2||wle(A2,o)&&i===A2.trim?Cle:i});function X_(o,i,s){return{sampleRate:o,stereo:i,bitrate:s}}function $t(o,i,s,a,u){return{width:o,height:i,frameRate:s,bitrateMin:a,bitrateMax:u}}function gc(o,i,s,a,u){return{width:{max:o},height:{max:i},frameRate:s,bitrateMin:a,bitrateMax:u}}function N2(o,i){return{numSpatialLayers:o,numTemporalLayers:i}}(function(o){o[o.CHOOSE_SERVER=11]="CHOOSE_SERVER",o[o.CLOUD_PROXY=18]="CLOUD_PROXY",o[o.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",o[o.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK"})(pr||(pr={})),function(o){o.IOS_15_16_INTERRUPTION_START="ios15_16-interruption-start",o.IOS_15_16_INTERRUPTION_END="ios15_16-interruption-end",o.IOS_INTERRUPTION_START="ios-interruption-start",o.IOS_INTERRUPTION_END="ios-interruption-end",o.STATE_CHANGE="state-change"}(mr||(mr={}));const Rle={"90p":$t(160,90),"90p_1":$t(160,90),"120p":$t(160,120,15,30,65),"120p_1":$t(160,120,15,30,65),"120p_3":$t(120,120,15,30,50),"120p_4":$t(212,120),"180p":$t(320,180,15,30,140),"180p_1":$t(320,180,15,30,140),"180p_3":$t(180,180,15,30,100),"180p_4":$t(240,180,15,30,120),"240p":$t(320,240,15,40,200),"240p_1":$t(320,240,15,40,200),"240p_3":$t(240,240,15,40,140),"240p_4":$t(424,240,15,40,220),"360p":$t(640,360,15,80,400),"360p_1":$t(640,360,15,80,400),"360p_3":$t(360,360,15,80,260),"360p_4":$t(640,360,30,80,600),"360p_6":$t(360,360,30,80,400),"360p_7":$t(480,360,15,80,320),"360p_8":$t(480,360,30,80,490),"360p_9":$t(640,360,15,80,800),"360p_10":$t(640,360,24,80,800),"360p_11":$t(640,360,24,80,1e3),"480p":$t(640,480,15,100,500),"480p_1":$t(640,480,15,100,500),"480p_2":$t(640,480,30,100,1e3),"480p_3":$t(480,480,15,100,400),"480p_4":$t(640,480,30,100,750),"480p_6":$t(480,480,30,100,600),"480p_8":$t(848,480,15,100,610),"480p_9":$t(848,480,30,100,930),"480p_10":$t(640,480,10,100,400),"720p":$t(1280,720,15,120,1130),"720p_auto":$t(1280,720,30,900,3e3),"720p_1":$t(1280,720,15,120,1130),"720p_2":$t(1280,720,30,120,2e3),"720p_3":$t(1280,720,30,120,1710),"720p_5":$t(960,720,15,120,910),"720p_6":$t(960,720,30,120,1380),"1080p":$t(1920,1080,15,120,2080),"1080p_1":$t(1920,1080,15,120,2080),"1080p_2":$t(1920,1080,30,120,3e3),"1080p_3":$t(1920,1080,30,120,3150),"1080p_5":$t(1920,1080,60,120,4780),"1440p":$t(2560,1440,30,120,4850),"1440p_1":$t(2560,1440,30,120,4850),"1440p_2":$t(2560,1440,60,120,7350),"4k":$t(3840,2160,30,120,8910),"4k_1":$t(3840,2160,30,120,8910),"4k_3":$t(3840,2160,60,120,13500)},bI=[{scaleResolutionDownBy:2,width:1280,height:720,frameRate:30,bitrateMin:300,bitrateMax:900},{scaleResolutionDownBy:1.333333,width:1280,height:720,frameRate:30,bitrateMin:600,bitrateMax:2e3},{scaleResolutionDownBy:1,width:1280,height:720,frameRate:30,bitrateMin:900,bitrateMax:3e3}],Ile={"480p":gc(640,480,5),"480p_1":gc(640,480,5),"480p_2":gc(640,480,30),"480p_3":gc(640,480,15),"720p":gc(1280,720,5),"720p_auto":$t(1280,720,30,900,3e3),"720p_1":gc(1280,720,5),"720p_2":gc(1280,720,30),"720p_3":gc(1280,720,15),"1080p":gc(1920,1080,5),"1080p_1":gc(1920,1080,5),"1080p_2":gc(1920,1080,30),"1080p_3":gc(1920,1080,15)},Ale={"1SL1TL":N2(1,1),"3SL3TL":N2(3,3),"2SL3TL":N2(2,3)};function eu(o){return o||(o="480p_1"),typeof o=="string"?Object.assign({},Rle[o]):o}function P2(o){return typeof o=="string"?Object.assign({},Ile[o]):o}function wI(o){return typeof o=="string"?Object.assign({},Ale[o]):o}const Ole={speech_low_quality:X_(16e3,!1),speech_standard:X_(32e3,!1,18),music_standard:X_(48e3,!1),standard_stereo:X_(48e3,!0,56),high_quality:X_(48e3,!1,128),high_quality_stereo:X_(48e3,!0,192)};function CI(o){return typeof o=="string"?Object.assign({},Ole[o]):o}const J_=[];function t7(o){return nr(o,"mediaSource",["screen","window","application"]),!0}var qe,Ln,kh,RI,x2,Q_,Lh,Jp,uo,II;(function(o){o.NEED_RENEGOTIATE="@need_renegotiate",o.NEED_REPLACE_TRACK="@need_replace_track",o.NEED_CLOSE="@need_close",o.NEED_ENABLE_TRACK="@need_enable_track",o.NEED_DISABLE_TRACK="@need_disable_track",o.NEED_SESSION_ID="@need_sid",o.SET_OPTIMIZATION_MODE="@set_optimization_mode",o.GET_STATS="@get_stats",o.GET_RTC_STATS="@get_rtc_stats",o.GET_LOW_VIDEO_TRACK="@get_low_video_track",o.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",o.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",o.NEED_MUTE_TRACK="@need_mute_track",o.NEED_UNMUTE_TRACK="@need_unmute_track"})(qe||(qe={})),function(o){o.SCREEN_TRACK="screen_track",o.CUSTOM_TRACK="custome_track",o.LOW_STREAM="low_stream"}(Ln||(Ln={})),function(o){o[o.HIGH_STREAM=0]="HIGH_STREAM",o[o.LOW_STREAM=1]="LOW_STREAM"}(kh||(kh={})),function(o){o[o.HIGH_STREAM=0]="HIGH_STREAM",o[o.LOW_STREAM=1]="LOW_STREAM"}(RI||(RI={})),function(o){o[o.DISABLE=0]="DISABLE",o[o.LOW_STREAM=1]="LOW_STREAM",o[o.AUDIO_ONLY=2]="AUDIO_ONLY"}(x2||(x2={})),function(o){o.TRANSCEIVER_UPDATED="transceiver-updated"}(Q_||(Q_={})),function(o){o.SOURCE_STATE_CHANGE="source-state-change",o.TRACK_ENDED="track-ended",o.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",o.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",o.CLOSED="closed"}(Lh||(Lh={})),function(o){o.FIRST_FRAME_DECODED="first-frame-decoded",o.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status"}(Jp||(Jp={})),function(o){o.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",o.RECEIVE_TRACK_BUFFER="receive_track_buffer",o.ON_AUDIO_BUFFER="on_audio_buffer",o.UPDATE_SOURCE="update_source"}(uo||(uo={})),function(o){o.UPDATE_TRACK_SOURCE="update-track-source"}(II||(II={}));const D2={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,currentPacketLossRate:0},k2={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},n7={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},Nle={uplinkNetworkQuality:0,downlinkNetworkQuality:0},i7={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};var ts,ho,Qp,cd,ns;(function(o){o.ON_TRACK="on_track",o.ON_NODE="on_node"})(ts||(ts={})),function(o){o.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",o.REQUEST_CONSTRAINTS="request_constraints"}(ho||(ho={})),function(o){o.IDLE="IDLE",o.INITING="INITING",o.INITEND="INITEND"}(Qp||(Qp={})),function(o){o.STATE_CHANGE="state_change",o.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",o.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",o.CAMERA_DEVICE_CHANGED="cameraDeviceChanged"}(cd||(cd={})),function(o){o.NONE="none",o.INIT="init",o.CANPLAY="canplay",o.PLAYING="playing",o.PAUSED="paused",o.SUSPEND="suspend",o.STALLED="stalled",o.WAITING="waiting",o.ERROR="error",o.DESTROYED="destroyed",o.ABORT="abort",o.ENDED="ended",o.EMPTIED="emptied",o.LOADEDDATA="loadeddata"}(ns||(ns={}));const L2={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370};var Z_;(function(o){o.OPEN="open",o.MESSAGE="message",o.CLOSE="close",o.CLOSING="closing",o.ERROR="error"})(Z_||(Z_={}));class r7 extends Hn{constructor(i,s){super(),O(this,"_ID",void 0),O(this,"_rtpTransceiver",void 0),O(this,"_lowRtpTransceiver",void 0),O(this,"_hints",[]),O(this,"_isClosed",!1),O(this,"_originMediaStreamTrack",void 0),O(this,"_mediaStreamTrack",void 0),O(this,"_external",{}),this._ID=s||wn(8,"track-"),this._originMediaStreamTrack=i,this._mediaStreamTrack=i,function(a){ot(J_).call(J_,a)||J_.push(a)}(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(i){if(!i){const s=it.reportApiInvoke(null,{name:Mi.GET_MEDIA_STREAM_TRACK,options:[],tag:Yn.TRACER});this._mediaStreamTrack&&typeof this._mediaStreamTrack.label=="string"?s.onSuccess(this._mediaStreamTrack.label):s.onSuccess("")}return this._mediaStreamTrack}getRTCRtpTransceiver(i){return i===kh.LOW_STREAM?this._lowRtpTransceiver:this._rtpTransceiver}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,this._lowRtpTransceiver=void 0,this._rtpTransceiver=void 0,function(i){const s=J_.indexOf(i);s!==-1&&J_.splice(s,1)}(this),this.emit(Lh.CLOSED)}_updateRtpTransceiver(i,s){if(s===kh.LOW_STREAM){if(this._lowRtpTransceiver===i)return;this._lowRtpTransceiver=i}else{if(this._rtpTransceiver===i)return;this._rtpTransceiver=i}this.emit(Q_.TRANSCEIVER_UPDATED,i,s)}}class Vr extends r7{get isExternalTrack(){return this._isExternalTrack}get muted(){return this._muted}get enabled(){return this._enabled}get processorContext(){return this._processorContext}set processorContext(i){this._processorContext=i}constructor(i,s){super(i,s),O(this,"_enabled",!0),O(this,"_muted",!1),O(this,"_isExternalTrack",!1),O(this,"_isClosed",!1),O(this,"_enabledMutex",void 0),O(this,"processor",void 0),O(this,"_handleTrackEnded",()=>{this.onTrackEnded()}),this._enabledMutex=new fr("".concat(this.getTrackId())),i.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){var i,s;return(i=(s=this._originMediaStreamTrack)===null||s===void 0?void 0:s.label)!==null&&i!==void 0?i:""}close(){this._isClosed||(this.stop(),this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,D.debug("[".concat(this.getTrackId(),"] close")),this.emit(qe.NEED_CLOSE),super.close())}async _updateOriginMediaStreamTrack(i,s){let a=arguments.length>2&&arguments[2]!==void 0&&arguments[2];this._isExternalTrack=a,i!==this._originMediaStreamTrack&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),s&&this._originMediaStreamTrack.stop()),i.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=i,this._muted&&(this._originMediaStreamTrack.enabled=!1),this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await bn(this,qe.NEED_REPLACE_TRACK,this),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}))}_getDefaultPlayerConfig(){return{}}onTrackEnded(){D.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Lh.TRACK_ENDED)}stateCheck(i,s){if(D.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(i,": ").concat(s,"]")),Wp(s,i),this._enabled&&this._muted&&i==="enabled"&&s===!1)throw new Ee(z.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print("error",D);if(!this._enabled&&!this._muted&&i==="muted"&&s===!0)throw new Ee(z.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print("error",D)}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}function s7(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}const o7=window.AudioContext||window.webkitAudioContext;let ca=null;const _n=new class extends Hn{constructor(){super(...arguments),O(this,"prevState",void 0),O(this,"curState",void 0),O(this,"currentTime",void 0),O(this,"currentTimeStuckAt",void 0),O(this,"interruptDetectorTrack",void 0),O(this,"onLocalAudioTrackMute",()=>{D.info("ios15-interruption-start"),this.emit(mr.IOS_15_16_INTERRUPTION_START)}),O(this,"onLocalAudioTrackUnmute",async()=>{D.info("ios15-interruption-end"),this.curState!=="running"||this.duringInterruption?D.info("ios15-interruption-end-canceled"):(ca&&await ca.suspend(),this.emit(mr.IOS_15_16_INTERRUPTION_END))})}get duringInterruption(){return this.prevState==="running"&&this.curState==="interrupted"}bindInterruptDetectorTrack(o){D.debug("webaudio bindInterruptDetectorTrack ".concat(o.getTrackId())),this.interruptDetectorTrack||(this.interruptDetectorTrack=o,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(o){D.debug("webaudio unbindInterruptDetectorTrack ".concat(o.getTrackId())),this.interruptDetectorTrack&&this.interruptDetectorTrack===o&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function Ple(){if(!o7)return void D.error("your browser is not support web audio");D.info("create audio context");const o=function(i){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?s7(Object(a),!0).forEach(function(u){O(i,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(a)):s7(Object(a)).forEach(function(u){Object.defineProperty(i,u,Object.getOwnPropertyDescriptor(a,u))})}return i}({},te("WEBAUDIO_INIT_OPTIONS"));D.debug("audio context init option:",JSON.stringify(o)),ca=new o7(o),_n.curState=ca.state,ca.onstatechange=()=>{_n.prevState=_n.curState,_n.curState=ca?ca.state:void 0;const{prevState:i,curState:s}=_n,a=s==="running",u=s==="interrupted",h=i==="running",p=i==="suspended",_=i==="interrupted",v=Zt().osVersion;(ps()||Yl())&&h&&u&&(D.info("ios".concat(v,"-interruption-start")),_n.emit(mr.IOS_INTERRUPTION_START)),(ps()||Yl())&&(p||_)&&a&&(D.info("ios".concat(v,"-interruption-end")),_n.emit(mr.IOS_INTERRUPTION_END)),i!==s&&(D.debug("AudioContext State Change","".concat(i,"=>").concat(s)),_n.emit(mr.STATE_CHANGE))},setInterval(()=>{var i;const s=(i=ca)===null||i===void 0?void 0:i.currentTime;_n.currentTime!==s?(_n.currentTimeStuckAt&&(D.debug("AudioContext current time resume at ".concat(s)),_n.currentTimeStuckAt=void 0),_n.currentTime=s):(s!==_n.currentTimeStuckAt&&(it.reportApiInvoke(null,{name:"WEB_AUDIO_CURRENT_TIME_STUCK",options:{currentTime:s},tag:Yn.TRACER}).onSuccess(),D.warning("AudioContext current time stuck at ".concat(s))),_n.currentTimeStuckAt=s)},5e3),async function(i){const s=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let a,u=!1,h=!1,p=!1;function _(H){i.state==="running"?v(!1):ps()||Yl()?i.state==="suspended"&&(v(!0),H&&i.resume().then(b,b)):i.state!=="closed"&&(v(!0),H&&i.resume().then(b,b))}function v(H){if(u!==H){u=H;for(let J=0,ee=s;J<ee.length;J+=1){const se=ee[J];H?window.addEventListener(se,C,{capture:!0,passive:!0}):window.removeEventListener(se,C,{capture:!0,passive:!0})}}}function T(){_(!0)}function b(){_(!1)}function C(){_(!0)}function N(H){if(!p)if(a.paused)if(H){let J;x(!1),p=!0;try{J=a.play(),J?J.then(B,B):(a.addEventListener("playing",B),a.addEventListener("abort",B),a.addEventListener("error",B))}catch{B()}}else x(!0);else x(!1)}function x(H){if(h!==H){h=H;for(let J=0,ee=s;J<ee.length;J++){const se=ee[J];H?window.addEventListener(se,F,{capture:!0,passive:!0}):window.removeEventListener(se,F,{capture:!0,passive:!0})}}}function B(){a.removeEventListener("playing",B),a.removeEventListener("abort",B),a.removeEventListener("error",B),p=!1,N(!1)}function F(){N(!0)}if(ps()){const H=i.createMediaStreamDestination(),J=document.createElement("div");J.innerHTML="<audio x-webkit-airplay='deny'></audio>",a=J.children.item(0),a.controls=!1,a.disableRemotePlayback=!0,a.preload="auto",a.srcObject=H.stream,N(!0)}_n.on(mr.STATE_CHANGE,T),_(!1)}(ca)}function eE(){if(!ca){if(Ple(),!ca)throw new Ee(z.NOT_SUPPORTED,"can not create audio context");return ca}return ca}function a7(){return!!ca}function Zp(o){if(function(){if(M2!==null)return M2;const a=eE(),u=a.createBufferSource(),h=a.createGain(),p=a.createGain();u.connect(h),u.connect(p),u.disconnect(h);let _=!1;try{u.disconnect(h)}catch{_=!0}return u.disconnect(),M2=_,_}())return;const i=o.connect,s=o.disconnect;o.connect=(a,u,h)=>{var p;return o._inputNodes||(o._inputNodes=[]),ot(p=o._inputNodes).call(p,a)||(a instanceof AudioNode?(o._inputNodes.push(a),i.call(o,a,u,h)):i.call(o,a,u)),o},o.disconnect=(a,u,h)=>{s.call(o),a?KM(o._inputNodes,a):o._inputNodes=[];for(const p of o._inputNodes)i.call(o,p)}}let M2=null;function U2(o,i){let s=!1;const a=1/i;if(te("DISABLE_WEBAUDIO")){const u=window.setInterval(()=>{s?window.clearInterval(u):o(performance.now()/1e3)},1e3*a)}else{const u=eE();let h=u.createGain();h.gain.value=0,h.connect(u.destination);const p=()=>{if(s)return void(h=null);const _=u.createOscillator();_.onended=p,_.connect(h),_.start(0),_.stop(u.currentTime+a),o(u.currentTime)};p()}return()=>{s=!0}}const is={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1,supportDataChannel:!1,supportPCSetConfiguration:!1,supportWebRTCEncodedTransform:!1,supportWebRTCInsertableStream:!1};function In(){return is}class c7{constructor(){O(this,"context",void 0),O(this,"analyserNode",void 0),O(this,"sourceNode",void 0),this.context=eE(),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4}updateSource(i){if(i!==this.sourceNode){if(this.sourceNode)try{this.sourceNode.disconnect(this.analyserNode)}catch{}this.sourceNode=i,i==null||i.connect(this.analyserNode)}}getVolumeLevel(){if(!this.sourceNode||(!this.context||ps()||Yl()||this.context.state!=="running"&&this.context.resume(),!this.analyserNode))return 0;const i=new Float32Array(this.analyserNode.fftSize);if(this.analyserNode.getFloatTimeDomainData)this.analyserNode.getFloatTimeDomainData(i);else{const a=new Uint8Array(this.analyserNode.fftSize);this.analyserNode.getByteTimeDomainData(a);for(let u=0;u<i.length;++u)i[u]=a[u]/128-1}const s=zp(i).call(i,(a,u)=>a+u*u,0)/i.length;return Math.max(10*Math.log10(s)+100,0)/100}getAnalyserNode(){return this.analyserNode}rebuildAnalyser(){try{var i,s;(i=this.sourceNode)===null||i===void 0||i.disconnect(this.analyserNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4,(s=this.sourceNode)===null||s===void 0||s.connect(this.analyserNode)}catch{D.warning("rebuild analyser node failed.")}}destroy(){this.updateSource(void 0)}}class l7 extends Hn{get processSourceNode(){return this.sourceNode}set processedNode(i){var s;if(!this.isDestroyed&&this._processedNode!==i){try{var a;(a=this.sourceNode)===null||a===void 0||a.disconnect(this.outputNode)}catch{}(s=this._processedNode)===null||s===void 0||s.disconnect(),this._processedNode=i,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),O(this,"outputNode",void 0),O(this,"outputTrack",void 0),O(this,"isPlayed",!1),O(this,"context",void 0),O(this,"audioBufferNode",void 0),O(this,"destNode",void 0),O(this,"audioOutputLevel",0),O(this,"volumeLevelAnalyser",void 0),O(this,"_processedNode",void 0),O(this,"playNode",void 0),O(this,"isDestroyed",!1),O(this,"onNoAudioInput",void 0),O(this,"isNoAudioInput",!1),O(this,"_noAudioInputCount",0),this.context=eE(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),Zp(this.outputNode),this.volumeLevelAnalyser=new c7}startGetAudioBuffer(i){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(i),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=s=>{this.emit(uo.ON_AUDIO_BUFFER,function(a){for(let u=0;u<a.outputBuffer.numberOfChannels;u+=1){const h=a.outputBuffer.getChannelData(u);for(let p=0;p<h.length;p+=1)h[p]=0}return a.inputBuffer}(s))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!In().webAudioMediaStreamDest)throw new Ee(z.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(i){this.context.state!=="running"&&pc(()=>{_n.emit("autoplay-failed")}),this.isPlayed=!0,this.playNode=i||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch{}this.isPlayed=!1}getAccurateVolumeLevel(){return this.volumeLevelAnalyser.getVolumeLevel()}async checkHasAudioInput(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(i>5)return this.isNoAudioInput=!0,this.onNoAudioInput&&this.onNoAudioInput(),!1;ps()||Yl()?this.context.state==="suspended"&&this.context.resume():this.context.state!=="running"&&this.context.resume();const s=this.volumeLevelAnalyser.getAnalyserNode();let a;s.getFloatTimeDomainData?(a=new Float32Array(s.fftSize),s.getFloatTimeDomainData(a)):(a=new Uint8Array(s.fftSize),s.getByteTimeDomainData(a));let u=!1;for(let h=0;h<a.length;h++)a[h]!==0&&(u=!0);return u?(this.isNoAudioInput=!1,!0):(await xr(200),await this.checkHasAudioInput(i?i+1:1)&&u)}getAudioVolume(){return this.outputNode.gain.value}setVolume(i){this.outputNode.gain.setValueAtTime(i,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}disconnect(){var i,s;(i=this.processedNode)===null||i===void 0||i.disconnect(),(s=this.sourceNode)===null||s===void 0||s.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var i;this.processedNode?(i=this.processedNode)===null||i===void 0||i.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.volumeLevelAnalyser.updateSource(this.outputNode)}}class j2 extends l7{get isFreeze(){return!1}constructor(i,s,a){var u;if(super(),O(this,"sourceNode",void 0),O(this,"track",void 0),O(this,"clonedTrack",void 0),O(this,"audioElement",void 0),O(this,"isCurrentTrackCloned",!1),O(this,"isRemoteTrack",!1),O(this,"originVolumeLevelAnalyser",void 0),O(this,"rebuildWebAudio",async()=>{if(D.debug("ready to rebuild web audio, state:",this.context.state),this.isNoAudioInput&&await this.checkHasAudioInput(),!this.isNoAudioInput||this.isDestroyed)return document.body.removeEventListener("click",this.rebuildWebAudio,!0),void D.debug("rebuild web audio success, current volume status",this.getAccurateVolumeLevel());this.context.resume().then(()=>D.info("resume success")),D.debug("rebuild web audio because of ios 12 bugs"),this.disconnect();const _=this.track;this.track=this.track.clone(),this.isCurrentTrackCloned?_.stop():this.isCurrentTrackCloned=!0;const v=new MediaStream([this.track]);this.sourceNode=this.context.createMediaStreamSource(v),Zp(this.sourceNode),this.volumeLevelAnalyser.rebuildAnalyser();const T=this.outputNode.gain.value;this.outputNode=this.context.createGain(),this.outputNode.gain.setValueAtTime(T,this.context.currentTime),Zp(this.outputNode),this.emit(uo.UPDATE_SOURCE),this.connect(),this.audioElement.srcObject=v,this.isPlayed&&this.play(this.playNode),this.checkHasAudioInput()}),i.kind!=="audio")throw new Ee(z.UNEXPECTED_ERROR);this.track=i;const h=new MediaStream([this.track]);if(this.isRemoteTrack=!!s,this.sourceNode=this.context.createMediaStreamSource(h),Zp(this.sourceNode),a){const _=a.clone();_.enabled=!0,this.clonedTrack=_,D.debug("create an unmuted track ".concat(_.id," from the original track ").concat(a.id," to get the volume"));const v=this.context.createMediaStreamSource(new MediaStream([_]));Zp(v),this.originVolumeLevelAnalyser=new c7,this.originVolumeLevelAnalyser.updateSource(v)}this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=h;const p=Zt();s&&p.os===tr.IOS&&Number((u=p.osVersion)===null||u===void 0?void 0:u.split(".")[0])<15&&(_n.on(mr.STATE_CHANGE,()=>{this.context.state==="suspended"?document.body.addEventListener("click",this.rebuildWebAudio,!0):this.context.state==="running"&&this.rebuildWebAudio()}),this.checkHasAudioInput().then(_=>{_||document.body.addEventListener("click",this.rebuildWebAudio,!0)}))}updateTrack(i){this.sourceNode.disconnect(),this.track=i,this.isCurrentTrackCloned=!1;const s=new MediaStream([i]);this.sourceNode=this.context.createMediaStreamSource(s),Zp(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(uo.UPDATE_SOURCE),this.audioElement.srcObject=s}destroy(){var i;this.audioElement.srcObject=null,this.audioElement.remove(),_n.off("state-change",this.rebuildWebAudio),(i=this.originVolumeLevelAnalyser)===null||i===void 0||i.destroy(),this.clonedTrack=void 0,super.destroy()}createMediaStreamSourceNode(i){return this.context.createMediaStreamSource(new MediaStream([i]))}updateOriginTrack(i){const s=i.clone();s.enabled=!0,this.clonedTrack&&(this.clonedTrack.stop(),this.clonedTrack=s),D.debug("create an unmuted track ".concat(s.id," from the original track ").concat(i.id," to get the volume"));const a=this.context.createMediaStreamSource(new MediaStream([s]));Zp(a),this.originVolumeLevelAnalyser&&this.originVolumeLevelAnalyser.updateSource(a)}getOriginVolumeLevel(){return this.originVolumeLevelAnalyser?this.originVolumeLevelAnalyser.getVolumeLevel():this.getAccurateVolumeLevel()}}async function u7(o,i,s){const a=(h,p)=>h?typeof h!="number"?h.max||h.exact||h.ideal||h.min||p:h:p,u={audio:!!s&&{mandatory:{chromeMediaSource:"desktop"}},video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:o,maxHeight:a(i.height,1080),maxWidth:a(i.width,1920)}}};return i.frameRate&&typeof i.frameRate!="number"?(u.video.mandatory.maxFrameRate=i.frameRate.max,u.video.mandatory.minFrameRate=i.frameRate.min):typeof i.frameRate=="number"&&(u.video.mandatory.maxFrameRate=i.frameRate),await navigator.mediaDevices.getUserMedia(u)}async function xle(o,i){const s=await d7(o.mediaSource),{sourceId:a,audio:u}=await function(h){let p=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new le((_,v)=>{const T=document.createElement("div");T.innerText="share screen",T.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");const b=document.createElement("div");b.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");const C=document.createElement("div");C.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",C.setAttribute("style","height: 12%;");const N=document.createElement("div");N.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");const x=document.createElement("div");x.setAttribute("style","display: flex; justify-content: space-between; padding: 16px 0;");const B=document.createElement("button");B.innerHTML="cancel",B.setAttribute("style","width: 85px;"),B.onclick=()=>{document.body.removeChild(J);const ee=new Error("NotAllowedError");ee.name="NotAllowedError",v(ee)};let F=p;const H=document.createElement("div");if(p){const ee=document.createElement("input");ee.setAttribute("type","checkbox");const se=document.createElement("span");ee.setAttribute("style","margin-right: 6px;"),se.innerText="Share audio",ee.checked=F,ee.onchange=()=>{F=ee.checked},H.appendChild(ee),H.appendChild(se)}x.appendChild(H),x.appendChild(B),b.appendChild(C),b.appendChild(N),b.appendChild(x);const J=document.createElement("div");J.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),J.appendChild(T),J.appendChild(b),document.body.appendChild(J),h.map(ee=>{if(ee.id){const se=document.createElement("div");se.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let ye=ee.thumbnail;try{const{width:me}=ye.getSize();me>1920&&(ye=ye.resize({width:1920}))}catch(me){throw me&&me.message.startsWith("Illegal invocation")&&console.error("Operate thumbnail error, please try to set contextIsolation: false. (https://github.com/electron/electron/issues/34953)"),me}se.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+ye.toDataURL()+' /></div><span style="	height: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+ee.name.replace(/[\u00A0-\u9999<>\&]/g,function(me){return"&#"+me.charCodeAt(0)+";"})+"</span>",se.onclick=()=>{document.body.removeChild(J),_({sourceId:ee.id,audio:F})},N.appendChild(se)}})})}(s,i);return await u7(a,o,u)}async function d7(o){let i=["window","screen"];o!=="application"&&o!=="window"||(i=["window"]),o==="screen"&&(i=["screen"]);const s=y8();if(!s)throw console.error("failed to fetch electron, please mount it to window"),new Ee(z.ELECTRON_IS_NULL);let a=null;try{var u;a=((u=s.desktopCapturer)===null||u===void 0?void 0:u.getSources({types:i}))||s.ipcRenderer.invoke("DESKTOP_CAPTURER_GET_SOURCES",{types:i})}catch{a=null}a&&a.then||(a=new le((h,p)=>{s.desktopCapturer.getSources({types:i},(_,v)=>{_?p(_):h(v)})}));try{return await a}catch(h){throw new Ee(z.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,h.toString())}}function h7(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}const F2=new fr("safari");let f7=!1,p7=!1;async function la(o,i){let s=0,a=null;for(;s<2;)try{a=await Dle(o,i,s>0);break}catch(u){if(u instanceof Ee)throw D.error("[".concat(i,"] ").concat(u.toString())),u;const h=AI(u.name||u.code||u,u.message);if(h.code===z.MEDIA_OPTION_INVALID){D.debug("[".concat(i,"] detect media option invalid, retry")),s+=1,await xr(500);continue}throw D.error("[".concat(i,"] ").concat(h.toString())),h}if(!a)throw new Ee(z.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return a}async function Dle(o,i,s){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Ee(z.NOT_SUPPORTED,"can not find getUserMedia");s&&(o.video&&(delete o.video.width,delete o.video.height),o.screen&&(delete o.screen.width,delete o.screen.height));const a=In(),u=new MediaStream;if(o.audioSource&&u.addTrack(o.audioSource),o.videoSource&&u.addTrack(o.videoSource),!o.audio&&!o.video&&!o.screen)return D.debug("Using Video Source/ Audio Source"),u;if(o.screen)if(y8())o.screen.sourceId?tE(u,await u7(o.screen.sourceId,o.screen,o.screenAudio)):tE(u,await xle(o.screen,o.screenAudio));else if(BM()&&o.screen.extensionId&&o.screen.mandatory){if(!a.getStreamFromExtension)throw new Ee(z.NOT_SUPPORTED,"This browser does not support screen sharing");D.debug("[".concat(i,'] Screen access on chrome stable, looking for extension"'));const N=await(p=o.screen.extensionId,_=i,new le((x,B)=>{try{chrome.runtime.sendMessage(p,{getStream:!0},F=>{if(!F||!F.streamId)return D.error("[".concat(_,"] No response from Chrome Plugin. Plugin not installed properly"),F),void B(new Ee(z.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));x(F.streamId)})}catch(F){D.error("[".concat(_,"] AgoraRTC screensharing plugin is not accessible(").concat(p,")"),F.toString()),B(new Ee(z.CHROME_PLUGIN_NOT_INSTALL))}}));o.screen.mandatory.chromeMediaSourceId=N,tE(u,await navigator.mediaDevices.getUserMedia({video:{mandatory:o.screen.mandatory}}))}else if(a.getDisplayMedia){var h;o.screen.mediaSource&&t7(o.screen.mediaSource);const N={width:o.screen.width,height:o.screen.height,frameRate:o.screen.frameRate,displaySurface:(h=o.screen.displaySurface)!==null&&h!==void 0?h:o.screen.mediaSource==="screen"?"monitor":o.screen.mediaSource},{selfBrowserSurface:x,surfaceSwitching:B,systemAudio:F}=o.screen,H={selfBrowserSurface:x,surfaceSwitching:B,systemAudio:F};!x&&delete H.selfBrowserSurface,!B&&delete H.surfaceSwitching,!F&&delete H.systemAudio,D.debug("[".concat(i,"] getDisplayMedia:"),JSON.stringify({video:N,audio:!!o.screenAudio,controls:H}));const J=await navigator.mediaDevices.getDisplayMedia(function(ee){for(var se=1;se<arguments.length;se++){var ye=arguments[se]!=null?arguments[se]:{};se%2?h7(Object(ye),!0).forEach(function(me){O(ee,me,ye[me])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(ye)):h7(Object(ye)).forEach(function(me){Object.defineProperty(ee,me,Object.getOwnPropertyDescriptor(ye,me))})}return ee}({video:N,audio:!!o.screenAudio},H));tE(u,J)}else{if(!jn())throw D.error("[".concat(i,"] This browser does not support screenSharing")),new Ee(z.NOT_SUPPORTED,"This browser does not support screen sharing");{o.screen.mediaSource&&t7(o.screen.mediaSource);const N={video:{mediaSource:o.screen.mediaSource,width:o.screen.width,height:o.screen.height,frameRate:o.screen.frameRate}};D.debug("[".concat(i,"] getUserMedia: ").concat(JSON.stringify(N))),tE(u,await navigator.mediaDevices.getUserMedia(N))}}var p,_;if(!o.video&&!o.audio)return u;let v={video:o.video,audio:o.audio},T=te("MEDIA_DEVICE_CONSTRAINTS");if(T)try{typeof T=="string"&&(T=JSON.parse(T)),v=YM(v,T)}catch{}D.debug("[".concat(i,"] GetUserMedia"),JSON.stringify(v)),Zt();let b,C=null;(fs()||ps()||eI())&&(C=await F2.lock());try{b=await navigator.mediaDevices.getUserMedia(v)}catch(N){throw C&&C(),N}return v.audio&&(f7=!0),v.video&&(p7=!0),tE(u,b),C&&C(),u}function AI(o,i){switch(o){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new Ee(z.MEDIA_OPTION_INVALID,"".concat(o,": ").concat(i));case"NotFoundError":case"DevicesNotFoundError":return new Ee(z.DEVICE_NOT_FOUND,"".concat(o,": ").concat(i));case"NotSupportedError":return new Ee(z.NOT_SUPPORTED,"".concat(o,": ").concat(i));case"NotReadableError":return new Ee(z.NOT_READABLE,"".concat(o,": ").concat(i));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new Ee(z.PERMISSION_DENIED,"".concat(o,": ").concat(i));case"ConstraintNotSatisfiedError":return new Ee(z.CONSTRAINT_NOT_SATISFIED,"".concat(o,": ").concat(i));default:return D.error("getUserMedia unexpected error",o),new Ee(z.UNEXPECTED_ERROR,"".concat(o,": ").concat(i))}}function tE(o,i){const s=o.getVideoTracks()[0],a=o.getAudioTracks()[0],u=i.getVideoTracks()[0],h=i.getAudioTracks()[0];h&&(a&&o.removeTrack(a),o.addTrack(h)),u&&(s&&o.removeTrack(s),o.addTrack(u))}const ua=new class extends Hn{get state(){return this._state}set state(o){o!==this._state&&(this.emit(cd.STATE_CHANGE,o),this._state=o)}constructor(){super(),O(this,"_state",Qp.IDLE),O(this,"isAccessMicrophonePermission",!1),O(this,"isAccessCameraPermission",!1),O(this,"lastAccessMicrophonePermission",!1),O(this,"lastAccessCameraPermission",!1),O(this,"checkdeviceMatched",!1),O(this,"deviceInfoMap",new Map),this.init().then(()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval(()=>{(te("ENUMERATE_DEVICES_INTERVAL")||(tI()||ZR()===tr.HARMONY_OS)&&Ih())&&this.updateDevicesInfo()},te("ENUMERATE_DEVICES_INTERVAL_TIME"))}).catch(o=>D.error(o.toString()))}async enumerateDevices(o,i){let s=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return new Ee(z.NOT_SUPPORTED,"enumerateDevices() not supported.").throw();const a=await navigator.mediaDevices.enumerateDevices(),u=this.checkMediaDeviceInfoIsOk(a);let h=!this.isAccessMicrophonePermission&&o,p=!this.isAccessCameraPermission&&i;u.audio&&(h=!1),u.video&&(p=!1);let _=null,v=null,T=null;if(!s&&(h||p)){if(F2.isLocked&&(D.debug("[device manager] wait GUM lock"),(await F2.lock())(),D.debug("[device manager] GUM unlock")),f7&&(h=!1,this.isAccessMicrophonePermission=!0),p7&&(p=!1,this.isAccessCameraPermission=!0),D.debug("[device manager] check media device permissions",o,i,h,p),h&&p){try{T=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(b){const C=AI(b.name||b.code||b,b.message);if(C.code===z.PERMISSION_DENIED)throw C;D.warning("getUserMedia failed in getDevices",C)}this.isAccessCameraPermission=!0,this.isAccessMicrophonePermission=!0}else if(h){try{_=await navigator.mediaDevices.getUserMedia({audio:o})}catch(b){const C=AI(b.name||b.code||b,b.message);if(C.code===z.PERMISSION_DENIED)throw C;D.warning("getUserMedia failed in getDevices",C)}this.isAccessMicrophonePermission=!0}else if(p){try{v=await navigator.mediaDevices.getUserMedia({video:i})}catch(b){const C=AI(b.name||b.code||b,b.message);if(C.code===z.PERMISSION_DENIED)throw C;D.warning("getUserMedia failed in getDevices",C)}this.isAccessCameraPermission=!0}D.debug("[device manager] mic permission",o,"cam permission",i)}try{const b=await navigator.mediaDevices.enumerateDevices();return _&&_.getTracks().forEach(C=>C.stop()),v&&v.getTracks().forEach(C=>C.stop()),T&&T.getTracks().forEach(C=>C.stop()),_=null,v=null,T=null,b}catch(b){return _&&_.getTracks().forEach(C=>C.stop()),v&&v.getTracks().forEach(C=>C.stop()),T&&T.getTracks().forEach(C=>C.stop()),_=null,v=null,T=null,new Ee(z.ENUMERATE_DEVICES_FAILED,b.toString()).throw()}}async getRecordingDevices(){let o=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,o)).filter(i=>i.kind==="audioinput")}async getCamerasDevices(){let o=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!1,!0,o)).filter(i=>i.kind==="videoinput")}async getSpeakers(){let o=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,o)).filter(i=>i.kind==="audiooutput")}searchDeviceIdByName(o){let i=null;return this.deviceInfoMap.forEach(s=>{s.device.label===o&&(i=s.device.deviceId)}),i}async getDeviceById(o){const i=(await this.enumerateDevices(!0,!0,!0)).find(s=>s.deviceId===o);if(!i)throw new Ee(z.DEVICE_NOT_FOUND,"deviceId: ".concat(o));return i}async init(){this.state=Qp.INITING;try{await this.updateDevicesInfo(),this.state=Qp.INITEND}catch(o){throw D.warning("Device Detection functionality cannot start properly.",o.toString()),this.state=Qp.IDLE,!(typeof isSecureContext=="boolean"?isSecureContext:location.protocol==="https:"||location.protocol==="file:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"||location.hostname==="::1")&&new Ee(z.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),o}}async updateDevicesInfo(){const o=await this.enumerateDevices(!0,!0,!0),i=Date.now(),s=[];if(o[0]&&o[0].label&&this.checkdeviceMatched===!1){this.checkdeviceMatched=!0;const u=o.find(p=>p.kind==="audioinput"&&p.deviceId==="default"),h=o.find(p=>p.kind==="audiooutput"&&p.deviceId==="default");u&&h?h.groupId===u.groupId?D.debug("[device-check] default input ".concat(u.label," and output ").concat(h.label," is the same group")):D.warning("[device-check] default input ".concat(u.label," and output ").concat(h.label," is not the same group")):D.debug("[device-check] default input or output not found")}const a=this.checkMediaDeviceInfoIsOk(o);if(o.forEach(u=>{if(!u.deviceId)return;const h=this.deviceInfoMap.get("".concat(u.kind,"_").concat(u.deviceId));if((h?h.state:"INACTIVE")!=="ACTIVE"){const p={initAt:i,updateAt:i,device:u,state:"ACTIVE"};this.deviceInfoMap.set("".concat(u.kind,"_").concat(u.deviceId),p),s.push(p)}h&&(h.updateAt=i)}),this.deviceInfoMap.forEach((u,h)=>{u.state==="ACTIVE"&&u.updateAt!==i&&(u.state="INACTIVE",s.push(u))}),this.state!==Qp.INITEND)return a.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),void(a.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0));s.forEach(u=>{switch(u.device.kind){case"audioinput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(cd.RECORDING_DEVICE_CHANGED,u);break;case"videoinput":this.lastAccessCameraPermission&&this.isAccessCameraPermission&&this.emit(cd.CAMERA_DEVICE_CHANGED,u);break;case"audiooutput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(cd.PLAYOUT_DEVICE_CHANGED,u)}}),a.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),a.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0)}checkMediaDeviceInfoIsOk(o){const i=o.filter(u=>u.kind==="audioinput"),s=o.filter(u=>u.kind==="videoinput"),a={audio:!1,video:!1};for(const u of i)if(u.label&&u.deviceId){a.audio=!0;break}for(const u of s)if(u.label&&u.deviceId){a.video=!0;break}return a}};let V2=!1;const da=new class extends Hn{constructor(){super(...arguments),O(this,"onAutoplayFailed",void 0),O(this,"onAudioAutoplayFailed",void 0)}};function m7(){if(Zt(),!V2){const o=i=>{i.preventDefault(),V2=!1,H0()?document.body.removeEventListener("click",o,!0):(document.body.removeEventListener("touchstart",o,!0),document.body.removeEventListener("mousedown",o,!0))};V2=!0,H0()?document.body.addEventListener("click",o,!0):(document.body.addEventListener("touchstart",o,!0),document.body.addEventListener("mousedown",o,!0)),D.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),da.onAutoplayFailed?da.onAutoplayFailed():da.onAudioAutoplayFailed?D.warning(`AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.

  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`):D.warning(`We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.

  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.

  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`),da.emit("autoplay-failed")}}function g7(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function _7(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?g7(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):g7(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}function E7(o,i,s,a){if(!o)return;const u=it.getBaseInfoBySessionId(o);if(!u)return;const h=u.info,p=Date.now(),_=_7(_7({},h),{},{vid:h.vid===void 0?0:Number(h.vid),lts:p,elapse:p-u.startTime,cbRegistered:da.onAutoplayFailed||da.onAudioAutoplayFailed?1:-1,errorMsg:s,mediaType:i,trackId:a,extend:void 0});it.send({type:$n.AUTOPLAY_FAILED,data:_},!0)}const kle=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","error"],Mo=new class{constructor(){O(this,"onAutoplayFailed",void 0),O(this,"elementMap",new Map),O(this,"elementStateMap",new Map),O(this,"elementsNeedToResume",[]),O(this,"sinkIdMap",new Map),O(this,"autoResumeAfterInterruption",()=>{Array.from(this.elementMap.entries()).forEach(o=>{let[i,s]=o;const a=this.elementStateMap.get(i),u=s.srcObject.getAudioTracks()[0];j_()?u&&u.readyState==="live"&&_n.curState==="running"&&(D.debug("auto resume after interruption for iOS 15"),s.pause(),s.play()):a&&a==="paused"&&u&&u.readyState==="live"&&_n.curState==="running"&&(D.debug("auto resume after interruption for iOS"),s.play())})}),O(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{Array.from(this.elementMap.entries()).forEach(o=>{let[i,s]=o;const a=s.srcObject.getAudioTracks()[0];a&&a.readyState==="live"&&(D.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),s.pause(),s.play())})}),this.autoResumeAudioElement(),_n.on(mr.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),_n.on(mr.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),_n.on(mr.STATE_CHANGE,()=>{ps()&&_n.prevState==="suspended"&&_n.curState==="running"&&this.autoResumeAfterInterruption()})}async setSinkID(o,i){const s=this.elementMap.get(o);if(this.sinkIdMap.set(o,i),s)try{await s.setSinkId(i)}catch(a){throw new Ee(z.PERMISSION_DENIED,"can not set sink id: "+a.toString())}}play(o,i,s,a){if(this.elementMap.has(i))return;const u=document.createElement("audio");u.autoplay=!0,u.srcObject=new MediaStream([o]),this.bindAudioElementEvents(i,u),this.elementMap.set(i,u),this.elementStateMap.set(i,ns.INIT),this.setVolume(i,s);const h=this.sinkIdMap.get(i);if(h)try{u.setSinkId(h).catch(_=>{D.warning("[".concat(i,"] set sink id failed"),_.toString())})}catch(_){D.warning("[".concat(i,"] set sink id failed"),_.toString())}const p=u.play();p&&p.then&&p.catch(_=>{a&&E7(a,"audio",_.message,i),D.warning("audio element play warning",_.toString()),this.elementMap.has(i)&&_.name==="NotAllowedError"&&(D.warning("detected audio element autoplay failed"),this.elementsNeedToResume.push(u),pc(()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),m7()}))})}updateTrack(o,i){const s=this.elementMap.get(o);s&&(s.srcObject=new MediaStream([i]))}isPlaying(o){return this.elementMap.has(o)&&this.elementStateMap.get(o)==="playing"}setVolume(o,i){const s=this.elementMap.get(o);s&&(i=Math.max(0,Math.min(100,i)),s.volume=i/100)}stop(o){const i=this.elementMap.get(o);if(this.sinkIdMap.delete(o),!i)return;const s=this.elementsNeedToResume.indexOf(i);this.elementsNeedToResume.splice(s,1),i.srcObject=null,i.remove(),this.elementMap.delete(o),this.elementStateMap.delete(o)}bindAudioElementEvents(o,i){kle.forEach(s=>{i.addEventListener(s,a=>{const u=this.elementStateMap.get(o),h=a.type==="pause"?"paused":a.type;if(D.debug("[".concat(o,"] audio-element-status change ").concat(u," => ").concat(h)),a.type==="error"){const p=i==null?void 0:i.error;p&&D.error("[".concat(o,"] media error, code: ").concat(p.code,", message: ").concat(p.message))}this.elementStateMap.set(o,h)})})}getPlayerState(o){return this.elementStateMap.get(o)||"uninit"}autoResumeAudioElement(){const o=()=>{this.elementsNeedToResume.forEach(i=>{i.play().then(s=>{D.debug("Auto resume audio element success")}).catch(s=>{D.warning("Auto resume audio element failed!",s)})}),this.elementsNeedToResume=[]};new le(i=>{document.body?i():window.addEventListener("load",()=>i())}).then(()=>{H0()?document.body.addEventListener("click",o,!0):(document.body.addEventListener("touchstart",o,!0),document.body.addEventListener("mousedown",o,!0))})}};function fi(){return function(o,i,s){const a=s.value;return typeof a=="function"&&(s.value=function(){this._isClosed&&new Ee(z.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning",D);for(var u=arguments.length,h=new Array(u),p=0;p<u;p++)h[p]=arguments[p];const _=a.apply(this,h);return _ instanceof le?new le((v,T)=>{_.then(v).catch(T)}):_}),s}}function v7(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function OI(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?v7(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):v7(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}class y7 extends Hn{constructor(i){super(),O(this,"name","VideoProcessorDestination"),O(this,"ID","0"),O(this,"_source",void 0),O(this,"videoContext",void 0),O(this,"inputTrack",void 0),this.videoContext=i}get kind(){return"video"}get enabled(){return!0}pipe(){throw new Ee(z.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new Ee(z.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(i){if(i.context!==this.videoContext)throw new Error(`ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.
Probably you are making pipeline like this:
videoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).`);i.track&&i.track!==this.inputTrack&&(this.videoContext.chained=!0,this.inputTrack=i.track,this.emit(ts.ON_TRACK,i.track))}reset(){this.inputTrack=void 0,this.videoContext.chained=!1,this.emit(ts.ON_TRACK,void 0)}}class S7 extends Hn{set chained(i){this._chained=i}get chained(){return this._chained}constructor(i,s){super(),O(this,"constraintsMap",new Map),O(this,"statsRegistry",[]),O(this,"usageRegistry",[]),O(this,"trackId",void 0),O(this,"direction",void 0),O(this,"_chained",!1),this.trackId=i,this.direction=s}async getConstraints(){return await Qn(this,ho.REQUEST_CONSTRAINTS)}async requestApplyConstraints(i,s){var a;return D.info("processor ".concat(s.name," requestApplyConstraints for ").concat(this.trackId)),i&&this.constraintsMap.set(s,i),bn(this,ho.REQUEST_UPDATE_CONSTRAINTS,Array.from(Jl(a=this.constraintsMap).call(a)))}async requestRevertConstraints(i){var s;if(this.constraintsMap.has(i))return D.info("processor ".concat(i.name," requestRevertConstraints for ").concat(this.trackId)),this.constraintsMap.delete(i),bn(this,ho.REQUEST_UPDATE_CONSTRAINTS,Array.from(Jl(s=this.constraintsMap).call(s)))}registerStats(i,s,a){this.statsRegistry.find(u=>u.processorID===i.ID&&u.processorName===i.name&&u.type===s)||this.statsRegistry.push({processorName:i.name,processorID:i.ID,type:s,cb:a})}unregisterStats(i,s){const a=this.statsRegistry.findIndex(u=>u.processorID===i.ID&&u.processorName===i.name&&u.type===s);a!==-1&&this.statsRegistry.splice(a,1)}gatherStats(){const i=[];for(const{processorID:s,processorName:a,type:u,cb:h}of this.statsRegistry)try{const p=h();i.push({processorID:s,processorName:a,type:u,stats:p})}catch(p){D.error(new Ee(z.UNEXPECTED_ERROR,p.message))}return i}registerUsage(i,s){this.usageRegistry.find(a=>a.processorID===i.ID&&a.processorName===i.name)||this.usageRegistry.push({processorID:i.ID,processorName:i.name,cb:s})}unregisterUsage(i){const s=this.usageRegistry.findIndex(a=>a.processorID===i.ID&&a.processorName===i.name);s!==-1&&this.usageRegistry.splice(s,1)}async gatherUsage(){const i=[];if(!this.chained)return[];for(const{cb:s}of this.usageRegistry)try{let a=s();a instanceof le&&(a=await a),i.push(OI(OI({},a),{},{direction:this.direction}))}catch(a){D.error("gather extension usage error",a)}return i}getDirection(){return this.direction}}class NI extends Hn{constructor(i){super(),O(this,"name","AudioProcessorDestination"),O(this,"ID","0"),O(this,"inputTrack",void 0),O(this,"inputNode",void 0),O(this,"audioProcessorContext",void 0),O(this,"_source",void 0),this.audioProcessorContext=i}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new Ee(z.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new Ee(z.NOT_SUPPORTED,"AudioProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.audioProcessorContext.chained=!1,this.emit(ts.ON_TRACK,void 0),this.emit(ts.ON_NODE,void 0)}updateInput(i){if(i.context!==this.audioProcessorContext)throw new Error(`ProcessorContext passed to AudioTrack.processorDestination doesn't match it's belonging AudioTrack's context.
        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).`);i.track&&this.inputTrack!==i.track&&(this.audioProcessorContext.chained=!0,this.inputTrack=i.track,this.emit(ts.ON_TRACK,this.inputTrack)),i.node&&this.inputNode!==i.node&&(this.audioProcessorContext.chained=!0,this.inputNode=i.node,this.emit(ts.ON_NODE,this.inputNode))}}class PI extends Hn{set chained(i){this._chained=i}get chained(){return this._chained}constructor(i,s,a){super(),O(this,"constraintsMap",new Map),O(this,"statsRegistry",[]),O(this,"audioContext",void 0),O(this,"trackId",void 0),O(this,"direction",void 0),O(this,"usageRegistry",[]),O(this,"_chained",!1),this.audioContext=i,this.trackId=s,this.direction=a}async getConstraints(){return Qn(this,ho.REQUEST_CONSTRAINTS)}getAudioContext(){return this.audioContext}async requestApplyConstraints(i,s){var a;return D.info("processor ".concat(s.name," requestApplyConstraints for ").concat(this.trackId)),i&&this.constraintsMap.set(s,i),bn(this,ho.REQUEST_UPDATE_CONSTRAINTS,Array.from(Jl(a=this.constraintsMap).call(a)))}async requestRevertConstraints(i){var s;if(this.constraintsMap.has(i))return this.constraintsMap.delete(i),bn(this,ho.REQUEST_UPDATE_CONSTRAINTS,Array.from(Jl(s=this.constraintsMap).call(s)))}registerStats(i,s,a){this.statsRegistry.find(u=>u.processorID===i.ID&&u.processorName===i.name&&u.type===s)||this.statsRegistry.push({processorName:i.name,processorID:i.ID,type:s,cb:a})}unregisterStats(i,s){const a=this.statsRegistry.findIndex(u=>u.processorID===i.ID&&u.processorName===i.name&&u.type===s);a!==-1&&this.statsRegistry.splice(a,1)}gatherStats(){const i=[];for(const{processorID:s,processorName:a,type:u,cb:h}of this.statsRegistry)try{const p=h();i.push({processorID:s,processorName:a,type:u,stats:p})}catch(p){D.error(new Ee(z.UNEXPECTED_ERROR,p.message))}return i}registerUsage(i,s){this.usageRegistry.find(a=>a.processorID===i.ID&&a.processorName===i.name)||this.usageRegistry.push({processorID:i.ID,processorName:i.name,cb:s})}unregisterUsage(i){const s=this.usageRegistry.findIndex(a=>a.processorID===i.ID&&a.processorName===i.name);s!==-1&&this.usageRegistry.splice(s,1)}async gatherUsage(){const i=[];if(!this.chained)return[];for(const{cb:s}of this.usageRegistry)try{let a=s();a instanceof le&&(a=await a),i.push(OI(OI({},a),{},{direction:this.direction}))}catch(a){D.error("gather extension usage error",a)}return i}getDirection(){return this.direction}}class B2 extends Hn{get isPlayed(){return!0}get isFreeze(){return!1}constructor(){super(),O(this,"context",void 0),O(this,"processSourceNode",void 0),O(this,"outputTrack",void 0),O(this,"processedNode",void 0),O(this,"clonedTrack",void 0),O(this,"outputNode",void 0),this.outputNode=new Lle}setVolume(){}createOutputTrack(){throw new Ee(z.NOT_SUPPORTED,"can not create output MediaStreamTrack when WebAudio disabled")}getOriginVolumeLevel(){return 0}getAccurateVolumeLevel(){return 0}stopGetAudioBuffer(){}startGetAudioBuffer(){}play(){}stop(){}destroy(){}updateTrack(){}updateOriginTrack(){}createMediaStreamSourceNode(){}}class Lle{disconnect(){}connect(){}}let nE=null;class Mle{constructor(){O(this,"state","open"),O(this,"trigger",void 0),O(this,"tasks",[]),D.debug("[macro-task-queue] is created."),this.trigger=window.setTimeout(()=>{this.state="closed",D.debug("[macro-task-queue] will be closed, all remaining tasks will execute. [".concat(this.tasks.map(i=>i.key),"]")),this.trigger=void 0,this.tasks.forEach(i=>{let{func:s}=i;return s()}),this.tasks.length=0,D.debug("[macro-task-queue] is closed.")})}enqueue(i,s){this.state!=="closed"&&(this.tasks.push({key:i,func:s}),D.debug("[macro-task-queue] is queued, current queue ".concat(this.tasks.length,". ").concat(typeof i=="string"?i:"")))}runTask(i){if(this.state==="closed")return;const s=this.tasks.findIndex(a=>a.key===i);if(s!==-1){const a=this.tasks.splice(s,1);D.debug("[macro-task-queue] is unqueued, current queue ".concat(this.tasks.length,". ").concat(typeof i=="string"?i:"")),a[0].func()}}release(){this.trigger&&(this.state="closed",clearTimeout(this.trigger),this.trigger=void 0,this.tasks.length=0,D.debug("[macro-task-queue] is closed."))}}function W2(o){return function(i,s,a){var u;const h=(u=a.value)!==null&&u!==void 0?u:a.get,p=function(){nE&&nE.state==="open"&&nE.runTask(o);for(var _=arguments.length,v=new Array(_),T=0;T<_;T++)v[T]=arguments[T];return h==null?void 0:h.apply(this,...v)};return a.value?a.value=p:a.get=p,a}}function T7(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function H2(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?T7(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):T7(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}class cn extends Vr{get _source(){return this._trackSource}set _source(i){this._trackSource=i}get processorContext(){return this._processorContext}set processorContext(i){this._processorContext=i}get processorDestination(){return this._processorDestination}set processorDestination(i){this._processorDestination=i}get isPlaying(){return this._useAudioElement?Mo.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"LocalAudioTrack"}constructor(i,s,a,u,h){super(i,a),O(this,"trackMediaType","audio"),O(this,"_encoderConfig",void 0),O(this,"_trackSource",void 0),O(this,"_enabled",!0),O(this,"_volume",100),O(this,"_useAudioElement",!1),O(this,"_bypassWebAudio",!1),O(this,"processor",void 0),O(this,"_processorContext",void 0),O(this,"_processorDestination",void 0),O(this,"_getOriginVolumeLevel",void 0),this._encoderConfig=s,this._getOriginVolumeLevel=!!u;const p=()=>{this.processorContext=new PI(this._source.context,this.getTrackId(),"local"),this.processorDestination=new NI(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(uo.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})},_=h&&fs()&&!a7();te("DISABLE_WEBAUDIO")?(this._source=new B2,this._useAudioElement=!0,this._bypassWebAudio=!0):_?this._source=new B2:(this._source=new j2(i,!1,this._getOriginVolumeLevel?i:void 0),te("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")||(this._useAudioElement=!0)),p(),!te("DISABLE_WEBAUDIO")&&_&&(nE||(nE=new Mle),nE).enqueue("INIT_WEBAUDIO",()=>{this._source=new j2(i,!1,this._getOriginVolumeLevel?i:void 0),te("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")||(this._useAudioElement=!0),p(),this.emit(II.UPDATE_TRACK_SOURCE)})}setVolume(i){Tn(i,"volume",0,1e3),this._volume=i,this._source.setVolume(i/100),this._useAudioElement&&Mo.setVolume(this.getTrackId(),i);try{if(this._bypassWebAudio)return void D.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio."));const s=this._source.createOutputTrack();this._mediaStreamTrack!==s&&(this._mediaStreamTrack=s,bn(this,qe.NEED_REPLACE_TRACK,this).then(()=>{D.debug("[".concat(this.getTrackId(),"] replace web audio track success"))}).catch(a=>{D.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),a)}))}catch{}}getVolumeLevel(){return this._muted&&this.enabled&&this._getOriginVolumeLevel?this._source.getOriginVolumeLevel():this._source.getAccurateVolumeLevel()}async setPlaybackDevice(i){if(!this._useAudioElement)throw new Ee(z.NOT_SUPPORTED,"your browser does not support setting the audio output device");await Mo.setSinkID(this.getTrackId(),i)}async setEnabled(i,s,a){return this._setEnabled(i,s,a)}async _setEnabled(i,s,a){if(!a){if(i===this._enabled)return;this.stateCheck("enabled",i)}if(D.info("[".concat(this.getTrackId(),"] start setEnabled"),i),i){this._originMediaStreamTrack.enabled=!0;try{a||(this._enabled=!0),await bn(this,qe.NEED_ENABLE_TRACK,this),D.info("[".concat(this.getTrackId(),"] setEnabled to ").concat(i," success"))}catch(u){throw a||(this._enabled=!1),D.error("[".concat(this.getTrackId(),"] setEnabled to true error"),u.toString()),u}}else{this._originMediaStreamTrack.enabled=!1,a||(this._enabled=!1);try{await bn(this,qe.NEED_DISABLE_TRACK,this)}catch(u){throw a||(this._enabled=!0),D.error("[".concat(this.getTrackId(),"] setEnabled to false error"),u.toString()),u}}}async setMuted(i){i!==this._muted&&(this.stateCheck("muted",i),this._muted=i,this._originMediaStreamTrack.enabled=!i,D.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(i)),i?await bn(this,qe.NEED_MUTE_TRACK,this):await bn(this,qe.NEED_UNMUTE_TRACK,this))}getStats(){return z0(()=>{D.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")},"localAudioTrackGetStatsWarning"),oo(this,qe.GET_STATS)||H2({},D2)}setAudioFrameCallback(i){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!i)return this._source.removeAllListeners(uo.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(s),this._source.removeAllListeners(uo.ON_AUDIO_BUFFER),this._source.on(uo.ON_AUDIO_BUFFER,a=>i(a))}play(){D.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(D.debug("[".concat(this.getTrackId(),"] start audio playback in element")),Mo.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play()}stop(){D.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?Mo.stop(this.getTrackId()):this._source.stop()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){let i=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];D.debug("[".concat(this.getTrackId(),"] update player source track")),i&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&Mo.updateTrack(this.getTrackId(),this._mediaStreamTrack)}async _updateOriginMediaStreamTrack(i,s){this._originMediaStreamTrack!==i&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),s&&this._originMediaStreamTrack.stop()),i.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=i,this._muted&&(this._originMediaStreamTrack.enabled=!1),this.processor&&this.processor.updateInput({track:i,context:this.processorContext}),this._mediaStreamTrack!==this._source.outputTrack?(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await bn(this,qe.NEED_REPLACE_TRACK,this)):this._source.updateTrack(this._originMediaStreamTrack),this._getOriginVolumeLevel&&this._source.updateOriginTrack(i))}renewMediaStreamTrack(i){return le.resolve(void 0)}pipe(i){if(this._bypassWebAudio)throw new Ee(z.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===i)return i;if(i._source)throw new Ee(z.INVALID_OPERATION,"Processor ".concat(i.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=i,this.processor._source=this,i.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),i}unpipe(){var i;if(!this.processor)return;const s=this.processor;(i=this._source.processSourceNode)===null||i===void 0||i.disconnect(),this.processor._source=!1,this.processor=void 0,s.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(ts.ON_TRACK,async i=>{i?i!==this._mediaStreamTrack&&(this._mediaStreamTrack=i,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(i),await bn(this,qe.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await bn(this,qe.NEED_REPLACE_TRACK,this))}),this.processorDestination.on(ts.ON_NODE,i=>{this._source.processedNode=i})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(ts.ON_TRACK),this.processorDestination.removeAllListeners(ts.ON_NODE)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(ho.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(ho.REQUEST_CONSTRAINTS)}}ve([W2("INIT_WEBAUDIO"),j("design:type",Object),j("design:paramtypes",[Object])],cn.prototype,"_source",null),ve([W2("INIT_WEBAUDIO"),j("design:type",PI),j("design:paramtypes",[PI])],cn.prototype,"processorContext",null),ve([W2("INIT_WEBAUDIO"),j("design:type",NI),j("design:paramtypes",[NI])],cn.prototype,"processorDestination",null),ve([ht({argsMap:(o,i)=>[o.getTrackId(),i],throttleTime:300}),j("design:type",Function),j("design:paramtypes",[Number]),j("design:returntype",void 0)],cn.prototype,"setVolume",null),ve([ht({argsMap:(o,i)=>[o.getTrackId(),i]}),fi(),j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",le)],cn.prototype,"setPlaybackDevice",null),ve([W_("LocalAudioTrack","_enabledMutex"),ht({argsMap:(o,i)=>[o.getTrackId(),i]}),fi(),j("design:type",Function),j("design:paramtypes",[Boolean,Object,Boolean]),j("design:returntype",le)],cn.prototype,"setEnabled",null),ve([W_("LocalAudioTrack","_enabledMutex"),ht({argsMap:(o,i)=>[o.getTrackId(),i]}),fi(),j("design:type",Function),j("design:paramtypes",[Boolean]),j("design:returntype",le)],cn.prototype,"setMuted",null),ve([fi(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",Object)],cn.prototype,"getStats",null),ve([fi(),j("design:type",Function),j("design:paramtypes",[Object,Number]),j("design:returntype",void 0)],cn.prototype,"setAudioFrameCallback",null),ve([ht({argsMap:o=>[o.getTrackId()]}),fi(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],cn.prototype,"play",null),ve([ht({argsMap:o=>[o.getTrackId()]}),fi(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],cn.prototype,"stop",null),ve([ht({argsMap:o=>[o.getTrackId()]}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],cn.prototype,"close",null),ve([ht({argsMap:(o,i)=>[o.getTrackId(),i.name]}),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",Object)],cn.prototype,"pipe",null),ve([ht({argsMap:o=>[o.getTrackId()]}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],cn.prototype,"unpipe",null);class Mh extends cn{get __className__(){return"MicrophoneAudioTrack"}constructor(i,s,a,u){super(i,s.encoderConfig?CI(s.encoderConfig):{},u,te("GET_VOLUME_OF_MUTED_AUDIO_TRACK"),!0),O(this,"_config",void 0),O(this,"_deviceName","default"),O(this,"_constraints",void 0),O(this,"_originalConstraints",void 0),O(this,"_enabled",!0),this._config=s,this._constraints=a,this._originalConstraints=a,this._deviceName=i.label,typeof s.bypassWebAudio=="boolean"&&(this._bypassWebAudio=s.bypassWebAudio),(j_()||HM())&&_n.bindInterruptDetectorTrack(this),this.on(II.UPDATE_TRACK_SOURCE,()=>{this.bindProcessorContextEvents()}),a7()&&this.bindProcessorContextEvents()}async setDevice(i){if(D.info("[".concat(this.getTrackId(),"] start set device to ").concat(i)),this._enabled)try{const s=await ua.getDeviceById(i),a={};a.audio=H2({},this._constraints),a.audio.deviceId={exact:i},this._originMediaStreamTrack.stop();let u=null;try{u=await la(a,this.getTrackId())}catch(h){throw D.error("[".concat(this.getTrackId(),"] setDevice failed"),h.toString()),u=await la({audio:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(u.getAudioTracks()[0],!1),h}await this._updateOriginMediaStreamTrack(u.getAudioTracks()[0],!1),this._deviceName=s.label,this._config.microphoneId=i,this._constraints.deviceId={exact:i}}catch(s){throw D.error("[".concat(this.getTrackId(),"] setDevice error"),s.toString()),s}else try{const s=await ua.getDeviceById(i);this._deviceName=s.label,this._config.microphoneId=i,this._constraints.deviceId={exact:i}}catch(s){throw D.error("[".concat(this.getTrackId(),"] setDevice error"),s.toString()),s}D.info("[".concat(this.getTrackId(),"] set device to ").concat(i," success"))}async setEnabled(i,s,a){if(s)return D.debug("[".concat(this.getTrackId(),"] setEnabled false (do not close microphone)")),await super._setEnabled(i);if(!a){if(i===this._enabled)return;this.stateCheck("enabled",i)}if(D.info("[".concat(this.getTrackId(),"] start setEnabled"),i),!i){var u;this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),(u=this._source.clonedTrack)===null||u===void 0||u.stop(),a||(this._enabled=!1);try{await bn(this,qe.NEED_DISABLE_TRACK,this)}catch(_){throw D.error("[".concat(this.getTrackId(),"] setEnabled false failed"),_.toString()),_}return}const h=H2({},this._constraints),p=ua.searchDeviceIdByName(this._deviceName);p&&!h.deviceId&&(h.deviceId=p);try{a||(this._enabled=!0);const _=await la({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(_.getAudioTracks()[0],!1),await bn(this,qe.NEED_ENABLE_TRACK,this)}catch(_){throw a||(this._enabled=!1),D.error("[".concat(this.getTrackId(),"] setEnabled true failed"),_.toString()),_}D.info("[".concat(this.getTrackId(),"] setEnabled success"))}close(){super.close(),(j_()||HM())&&_n.unbindInterruptDetectorTrack(this)}onTrackEnded(){if((ps()||Yl())&&this._enabled&&!this._isClosed&&_n.duringInterruption){const i=async()=>{_n.off(mr.IOS_INTERRUPTION_END,i),this._enabled&&!this._isClosed&&(D.debug("[".concat(this.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};_n.on(mr.IOS_INTERRUPTION_END,i)}else D.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Lh.TRACK_ENDED)}async renewMediaStreamTrack(i){const s=i||this._constraints,a=ua.searchDeviceIdByName(this._deviceName);if(a&&!s.deviceId&&(s.deviceId=a),this._constraints=s,this._enabled){this._originMediaStreamTrack.stop();const u=await la({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(u.getAudioTracks()[0],!0)}}bindProcessorContextEvents(){this.processorContext.on(ho.REQUEST_UPDATE_CONSTRAINTS,async(i,s,a)=>{try{const u=Object.assign({},this._originalConstraints,...i);await this.renewMediaStreamTrack(u),s()}catch(u){a(u)}}),this.processorContext.on(ho.REQUEST_CONSTRAINTS,async i=>{i(this._originMediaStreamTrack.getSettings())})}}ve([ht({argsMap:(o,i)=>[o.getTrackId(),i]}),fi(),j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",le)],Mh.prototype,"setDevice",null),ve([W_("MicrophoneAudioTrack","_enabledMutex"),ht({argsMap:(o,i,s)=>[o.getTrackId(),i,s]}),fi(),j("design:type",Function),j("design:paramtypes",[Boolean,Boolean,Boolean]),j("design:returntype",le)],Mh.prototype,"setEnabled",null),ve([ht({argsMap:o=>[o.getTrackId()]}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Mh.prototype,"close",null);class Uh extends cn{get __className__(){return"BufferSourceAudioTrack"}constructor(i,s,a,u){super(s.createOutputTrack(),a,u),O(this,"source",void 0),O(this,"_bufferSource",void 0),this.source=i,this._bufferSource=s,this._bufferSource.on(uo.AUDIO_SOURCE_STATE_CHANGE,h=>{this.safeEmit(Lh.SOURCE_STATE_CHANGE,h)});try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}get playbackSpeed(){return this._bufferSource.playbackSpeed}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(i){i&&this._bufferSource.updateOptions(i),this._bufferSource.startProcessAudioBuffer()}pauseProcessAudioBuffer(){this._bufferSource.pauseProcessAudioBuffer()}seekAudioBuffer(i){this._bufferSource.seekAudioBuffer(i)}resumeProcessAudioBuffer(){this._bufferSource.resumeProcessAudioBuffer()}stopProcessAudioBuffer(){this._bufferSource.stopProcessAudioBuffer()}close(){this.source=null,this._bufferSource.destroy(),super.close()}setAudioBufferPlaybackSpeed(i){Tn(i,"speed",0),this._bufferSource.setAudioBufferPlaybackSpeed(i)}}ve([ht({argsMap:(o,i)=>[o.getTrackId(),i,o.duration]}),fi(),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",void 0)],Uh.prototype,"startProcessAudioBuffer",null),ve([ht({argsMap:o=>[o.getTrackId()]}),fi(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Uh.prototype,"pauseProcessAudioBuffer",null),ve([ht({argsMap:o=>[o.getTrackId()]}),fi(),j("design:type",Function),j("design:paramtypes",[Number]),j("design:returntype",void 0)],Uh.prototype,"seekAudioBuffer",null),ve([ht({argsMap:o=>[o.getTrackId()]}),fi(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Uh.prototype,"resumeProcessAudioBuffer",null),ve([ht({argsMap:o=>[o.getTrackId()]}),fi(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Uh.prototype,"stopProcessAudioBuffer",null),ve([ht({argsMap:o=>[o.getTrackId()]}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Uh.prototype,"close",null),ve([ht({argsMap:o=>[o.getTrackId()]}),fi(),j("design:type",Function),j("design:paramtypes",[Number]),j("design:returntype",void 0)],Uh.prototype,"setAudioBufferPlaybackSpeed",null);class Ni extends cn{get __className__(){return"MixingAudioTrack"}get isActive(){for(const i of this.trackList)if(i._enabled&&!i._isClosed&&!i.muted)return!0;return!1}constructor(){const i=eE().createMediaStreamDestination();super(i.stream.getAudioTracks()[0],void 0,wn(8,"track-mix-")),O(this,"trackList",void 0),O(this,"destNode",void 0);try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}this.destNode=i,this.trackList=[]}hasAudioTrack(i){return this.trackList.indexOf(i)!==-1}addAudioTrack(i){this.trackList.indexOf(i)===-1?(D.debug("add ".concat(i.getTrackId()," to mixing track")),i._source.outputNode.connect(this.destNode),this.trackList.push(i),this.updateEncoderConfig()):D.debug("track ".concat(i.getTrackId()," is already added"))}removeAudioTrack(i){if(this.trackList.indexOf(i)!==-1){D.debug("remove ".concat(i.getTrackId()," from mixing track"));try{i._source.outputNode.disconnect(this.destNode)}catch{}KM(this.trackList,i),this.updateEncoderConfig()}}updateEncoderConfig(){const i={};this.trackList.forEach(s=>{s._encoderConfig&&((s._encoderConfig.bitrate||0)>(i.bitrate||0)&&(i.bitrate=s._encoderConfig.bitrate),(s._encoderConfig.sampleRate||0)>(i.sampleRate||0)&&(i.sampleRate=s._encoderConfig.sampleRate),(s._encoderConfig.sampleSize||0)>(i.sampleSize||0)&&(i.sampleSize=s._encoderConfig.sampleSize),s._encoderConfig.stereo&&(i.stereo=!0))}),this._encoderConfig=i}_updateRtpTransceiver(i){this._rtpTransceiver!==i&&(this._rtpTransceiver=i,this.trackList.forEach(s=>{s instanceof Ni?s.emit(Q_.TRANSCEIVER_UPDATED,i):s._updateRtpTransceiver(i)}))}}function xI(o){const i={};o.facingMode&&(i.facingMode=o.facingMode),o.cameraId&&(i.deviceId={exact:o.cameraId});const s=eu(o.encoderConfig);return s.width!=null&&(i.width=s.width),s.height!=null&&(i.height=s.height),!p8()&&s.frameRate&&(i.frameRate=s.frameRate),Zt().name===an.EDGE&&typeof i.frameRate=="object"&&(i.frameRate.max=60),jn()&&(i.frameRate={ideal:30,max:30}),i}function b7(o){const i={};if(p8()||(o.AGC!==void 0&&(i.autoGainControl=o.AGC),o.AEC!==void 0&&(i.echoCancellation=o.AEC),o.ANS!==void 0&&(i.noiseSuppression=o.ANS,BM()&&o.ANS&&(i.googHighpassFilter=o.ANS))),o.encoderConfig){const s=CI(o.encoderConfig);i.channelCount=s.stereo?2:1,i.sampleRate=s.sampleRate,i.sampleSize=s.sampleSize}return o.microphoneId&&(i.deviceId={exact:o.microphoneId}),tI()&&(i.sampleRate=void 0),i}class Ule extends l7{set currentState(i){i!==this._currentState&&(this._currentState=i,this.safeEmit(uo.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(i){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),O(this,"audioBuffer",void 0),O(this,"sourceNode",void 0),O(this,"startPlayTime",0),O(this,"startPlayOffset",0),O(this,"pausePlayTime",0),O(this,"options",void 0),O(this,"currentLoopCount",0),O(this,"currentPlaybackSpeed",100),O(this,"_currentState","stopped"),this.audioBuffer=i,this.options=s,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer?this.audioBuffer.duration:0}get playbackSpeed(){return this.currentPlaybackSpeed}get currentTime(){return this.audioBuffer?this.currentState==="stopped"?0:this.currentState==="paused"?this.pausePlayTime:((this.context.currentTime-this.startPlayTime)*(this.playbackSpeed/100)+this.startPlayOffset)%this.audioBuffer.duration:0}updateOptions(i){this.currentState==="stopped"?(this.options=i,this.startPlayOffset=this.options.startPlayTime||0):D.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&this.currentState==="playing"&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(i){this.sourceNode&&(this.sourceNode.onended=null,this.currentState==="playing"&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),this.currentState==="playing"?(this.startPlayOffset=i,this.startSourceNode()):this.currentState==="paused"&&(this.pausePlayTime=i))}resumeProcessAudioBuffer(){this.currentState==="paused"&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch{}this.reset()}}destroy(){this.audioBuffer=null,super.destroy()}setAudioBufferPlaybackSpeed(i){this.sourceNode&&(this.currentState==="playing"&&(this.startPlayOffset=this.currentTime,this.startPlayTime=this.context.currentTime),this.sourceNode.playbackRate.value=i/100),this.currentPlaybackSpeed=i}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){const i=this.context.createBufferSource();return i.buffer=this.audioBuffer,i.loop=!!this.options.loop,i.connect(this.outputNode),i.playbackRate.value=this.currentPlaybackSpeed/100,i}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}const w7=new Map;async function jle(o,i){let s=null;if(typeof o=="string"){const u=w7.get(o);if(u)return D.debug("use cached audio resource: ",o),u;try{s=(await nl(()=>ao.get(o,{responseType:"arraybuffer"}),void 0,void 0,{maxRetryCount:3})).data}catch(h){throw new Ee(z.FETCH_AUDIO_FILE_FAILED,h.toString())}}else s=await new le((h,p)=>{const _=new FileReader;_.onload=v=>{v.target?h(v.target.result):p(new Ee(z.READ_LOCAL_AUDIO_FILE_ERROR))},_.onerror=()=>{p(new Ee(z.READ_LOCAL_AUDIO_FILE_ERROR))},_.readAsArrayBuffer(o)});const a=await function(u){const h=eE();return new le((p,_)=>{h.decodeAudioData(u,v=>{p(v)},v=>{_(new Ee(z.DECODE_AUDIO_FILE_FAILED,v.toString()))})})}(s);return typeof o=="string"&&i&&w7.set(o,a),a}const $2=o=>{const i=document.createElement("canvas");return i.width=2,i.height=2,new le((s,a)=>{i.toBlob(async u=>{if(i.remove(),u){const h=await C7(u);s({buffer:h,width:i.width,height:i.height})}else a(new Ee(z.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},o,1)})},C7=async o=>{const i=await o.arrayBuffer();return new Uint8Array(i)},ld=new class extends Hn{get visibility(){return document.visibilityState}get lastHiddenTime(){return this._lastHiddenTime}get lastVisibleTime(){return this._lastVisibleTime}constructor(){super(),O(this,"_lastHiddenTime",0),O(this,"_lastVisibleTime",0),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?this._lastHiddenTime=performance.now():this._lastVisibleTime=performance.now(),D.debug("document visibility went ".concat(document.visibilityState)),this.emit("VISIBILITY_CHANGE",document.visibilityState)})}};function R7(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function I7(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?R7(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):R7(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}class z2{get videoElementStatus(){return this._videoElementStatus}set videoElementStatus(i){i!==this._videoElementStatus&&(D.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(i)),this._videoElementStatus=i)}constructor(i){O(this,"trackId",void 0),O(this,"config",void 0),O(this,"onFirstVideoFrameDecoded",void 0),O(this,"freezeTimeCounterList",[]),O(this,"renderFreezeAccTime",0),O(this,"isKeepLastFrame",!1),O(this,"timeUpdatedCount",0),O(this,"freezeTime",0),O(this,"playbackTime",0),O(this,"lastTimeUpdatedTime",0),O(this,"autoplayFailed",!1),O(this,"videoTrack",void 0),O(this,"videoElement",void 0),O(this,"cacheVideoElement",void 0),O(this,"videoElementCheckInterval",void 0),O(this,"_videoElementStatus",ns.NONE),O(this,"isGettingVideoDimensions",!1),O(this,"startGetVideoDimensions",()=>{const s=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement.videoWidth*this.videoElement.videoHeight>4)return D.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),void(this.isGettingVideoDimensions=!1);setTimeout(s,500)};!this.isGettingVideoDimensions&&s()}),O(this,"autoResumeAfterInterruption",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&_n.curState==="running"&&(D.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(a8())),h8()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),O(this,"handleVideoEvents",s=>{switch(s.type){case"play":case"playing":this.startGetVideoDimensions(),this.videoElementStatus=ns.PLAYING;break;case"loadeddata":if(this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded(),this.cacheVideoElement){try{this.cacheVideoElement.srcObject=null,this.cacheVideoElement.remove()}catch{}this.cacheVideoElement=void 0}break;case"canplay":this.videoElementStatus=ns.CANPLAY;break;case"stalled":this.videoElementStatus=ns.STALLED;break;case"suspend":this.videoElementStatus=ns.SUSPEND;break;case"pause":this.videoElementStatus=ns.PAUSED,ps()||Yl()||fs()&&this.autoplayFailed||!this.videoTrack||this.videoTrack.readyState!=="live"||(D.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),this.videoElement.play());break;case"waiting":this.videoElementStatus=ns.WAITING;break;case"abort":this.videoElementStatus=ns.ABORT;break;case"ended":this.videoElementStatus=ns.ENDED;break;case"emptied":this.videoElementStatus=ns.EMPTIED;break;case"error":{this.videoElementStatus=ns.ERROR;const a=this.videoElement.error;a&&D.error("[".concat(this.trackId,"] media error, code: ").concat(a.code,", message: ").concat(a.message));break}case"timeupdate":{const a=performance.now();if(this.timeUpdatedCount+=1,this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=a);const u=a-this.lastTimeUpdatedTime,h=this.lastTimeUpdatedTime;if(this.lastTimeUpdatedTime=a,ld.lastVisibleTime<ld.lastHiddenTime||h<ld.lastHiddenTime||h<ld.lastVisibleTime)return;for(u>te("VIDEO_FREEZE_DURATION")&&(this.freezeTime+=u),this.playbackTime+=u;this.playbackTime>=6e3;){this.playbackTime-=6e3;const p=Math.min(6e3,this.freezeTime);this.freezeTimeCounterList.push(p),this.freezeTime=Math.max(0,this.freezeTime-6e3)}break}}}),O(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&(D.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(a8())),h8()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),this.trackId=i.trackId,this.config=i,i.element instanceof HTMLVideoElement?this.videoElement=i.element:this.videoElement=document.createElement("video"),_n.on(mr.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),_n.on(mr.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16)}getVideoElement(){return this.videoElement}getContainerElement(){var i;return(i=this.videoElement.parentElement)!==null&&i!==void 0?i:void 0}updateConfig(i){this.config=i,this.trackId=i.trackId,i.element!==this.videoElement&&(this.destroy(),this.videoElement=i.element),this.videoTrack&&this.initVideoElement()}updateVideoTrack(i){this.videoTrack!==i&&(this.videoTrack=i,this.initVideoElement())}play(i){const s=this.videoElement.play();s&&s.catch&&s.catch(u=>{i&&E7(i,"video",u.message,this.trackId),u.name==="NotAllowedError"?(D.warning("detected video element autoplay failed",u),this.autoplayFailed=!0,this.handleAutoPlayFailed()):D.warning("[".concat(this.trackId,"] play warning: "),u)});const a=Zt();if((a.name==="Safari"&&Number(a.version)===15||j_())&&s&&s.then){const u=()=>{this.config.mirror&&(this.videoElement.style.transform="rotateY(180deg)")};s.then(u).catch(u)}}getCurrentFrame(){const i=document.createElement("canvas");i.width=this.videoElement.videoWidth,i.height=this.videoElement.videoHeight;const s=i.getContext("2d");if(!s)return D.error("create canvas context failed!"),new ImageData(2,2);s.drawImage(this.videoElement,0,0,i.width,i.height);const a=s.getImageData(0,0,i.width,i.height);return i.remove(),a}async getCurrentFrameToUint8Array(i){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const a=document.createElement("canvas");a.width=this.videoElement.videoWidth,a.height=this.videoElement.videoHeight;const u=a.getContext("2d");return u?(u.drawImage(this.videoElement,0,0,a.width,a.height),new le((h,p)=>{a.toBlob(async _=>{if(a.remove(),_){const v=await C7(_);h({buffer:v,width:a.width,height:a.height})}else p(new Ee(z.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},i,s<0?.1:s>1?1:s)})):await $2(i)}destroy(){_n.off(mr.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),_n.off(mr.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),this.videoElement.srcObject=null,this.resetVideoElement(),this.freezeTimeCounterList=[]}initVideoElement(){if(this.videoElementStatus=ns.INIT,!this.videoElementCheckInterval&&(A7.forEach(h=>{this.videoElement.addEventListener(h,this.handleVideoEvents)}),this.videoElementCheckInterval=window.setInterval(()=>{(function(h){return h!==document.body&&document.body.contains(h)})(this.videoElement)||(this.videoElementStatus=ns.DESTROYED)},1e3),te("ENABLE_VIDEO_FRAME_CALLBACK"))){var i,s;let h;const p=(_,v)=>{if(this.videoElementStatus===ns.PLAYING){if(h){const C=v.presentationTime-h.presentationTime;C>te("VIDEO_FREEZE_DURATION")&&ld.lastVisibleTime>=ld.lastHiddenTime&&h.timestamp>ld.lastVisibleTime&&h.timestamp>ld.lastHiddenTime&&(this.renderFreezeAccTime+=C)}h=I7(I7({},v),{},{timestamp:_})}var T,b;te("ENABLE_VIDEO_FRAME_CALLBACK")&&((T=(b=this.videoElement).requestVideoFrameCallback)===null||T===void 0||T.call(b,p))};(i=(s=this.videoElement).requestVideoFrameCallback)===null||i===void 0||i.call(s,p)}this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),tI()&&(this.videoElement.poster="noposter");const a=Zt();a.name==="Safari"&&Number(a.version)===15||j_()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,jn()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,jn()&&this.videoElement.load());const u=this.videoElement.play();u!==void 0&&u.catch(h=>{D.debug("[".concat(this.trackId,"] playback interrupted"),h.toString())})}resetVideoElement(){A7.forEach(i=>{this.videoElement&&this.videoElement.removeEventListener(i,this.handleVideoEvents)}),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0),this.videoElementStatus=ns.NONE}handleAutoPlayFailed(){const i=s=>{s.preventDefault(),this.videoElement.play().then(()=>{D.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed."))}).catch(a=>{D.error(a)}),this.autoplayFailed=!1,H0()?document.body.removeEventListener("click",i,!0):(document.body.removeEventListener("touchstart",i,!0),document.body.removeEventListener("mousedown",i,!0))};H0()?document.body.addEventListener("click",i,!0):(document.body.addEventListener("touchstart",i,!0),document.body.addEventListener("mousedown",i,!0)),m7()}}const A7=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate","error"];class O7 extends z2{constructor(i){super(i),O(this,"container",void 0),O(this,"slot",void 0),this.slot=i.element,this.updateConfig(i)}updateConfig(i){this.config=i,this.trackId=i.trackId;const s=i.element;s!==this.slot&&(this.destroy(),this.slot=s),this.createElements()}updateVideoTrack(i){this.videoTrack!==i&&(this.videoTrack=i,this.createElements())}play(i){var s;(s=this.container)!==null&&s!==void 0&&s.contains(this.videoElement)&&super.play(i)}getCurrentFrame(){var i;return(i=this.container)!==null&&i!==void 0&&i.contains(this.videoElement)?super.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameToUint8Array(i){var s;let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return(s=this.container)!==null&&s!==void 0&&s.contains(this.videoElement)?await super.getCurrentFrameToUint8Array(i,a):await $2(i)}destroy(){if(super.destroy(),this.videoElement.remove(),this.videoElement=document.createElement("video"),this.container){try{this.container.remove(),this.slot.removeChild(this.container)}catch{}this.container=void 0}}createElements(){this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",te("KEEP_LAST_FRAME")&&this.isKeepLastFrame&&this.videoElement.paused&&this.resetVideoElement(),this.mountedVideoElement()):this.unmountedVideoElement(),this.slot.appendChild(this.container)}mountedVideoElement(){var i;!this.container||(i=this.container)!==null&&i!==void 0&&i.contains(this.videoElement)||this.container.appendChild(this.videoElement),super.initVideoElement(),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.style.left="0",this.videoElement.style.top="0"}unmountedVideoElement(){var i;if((i=this.container)!==null&&i!==void 0&&i.contains(this.videoElement)){super.resetVideoElement();try{this.container&&this.container.removeChild(this.videoElement)}catch{}this.videoElement=document.createElement("video")}}resetVideoElement(){var i;(i=this.container)!==null&&i!==void 0&&i.contains(this.videoElement)&&(super.resetVideoElement(),this.cacheVideoElement=this.videoElement,this.videoElement=document.createElement("video"))}getContainerElement(){return this.container}}function N7(o){return new le((i,s)=>{let a=!1;const u=document.createElement("video");u.setAttribute("autoplay",""),u.setAttribute("muted",""),u.muted=!0,u.autoplay=!0,u.setAttribute("playsinline",""),u.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(u);const h=ps()?"canplay":"playing";u.addEventListener(h,()=>{const p=u.videoWidth,_=u.videoHeight;!p&&jn()||(a=!0,u.srcObject=null,u.remove(),i([p,_]))}),u.srcObject=new MediaStream([o]),u.play().catch(sI),setTimeout(()=>{a||(u.srcObject=null,u.remove(),i([u.videoWidth,u.videoHeight]))},4e3)})}const Fle=async(o,i,s)=>{const a=function(p){const _=[];for(let v=0;v<p.length;v+=2)_.push(parseInt(p.slice(v,v+2),16));return Uint8Array.from(_)}(function(p){const _="0123456789abcdef";function v(Ve){let Me,wt="";for(Me=0;Me<=3;Me++)wt+=_.charAt(Ve>>8*Me+4&15)+_.charAt(Ve>>8*Me&15);return wt}function T(Ve,Me){const wt=(65535&Ve)+(65535&Me);return(Ve>>16)+(Me>>16)+(wt>>16)<<16|65535&wt}function b(Ve,Me,wt,zt,si,ji){return T(function(Fn,jo){return Fn<<jo|Fn>>>32-jo}(T(T(Me,Ve),T(zt,ji)),si),wt)}function C(Ve,Me,wt,zt,si,ji,Fn){return b(Me&wt|~Me&zt,Ve,Me,si,ji,Fn)}function N(Ve,Me,wt,zt,si,ji,Fn){return b(Me&zt|wt&~zt,Ve,Me,si,ji,Fn)}function x(Ve,Me,wt,zt,si,ji,Fn){return b(Me^wt^zt,Ve,Me,si,ji,Fn)}function B(Ve,Me,wt,zt,si,ji,Fn){return b(wt^(Me|~zt),Ve,Me,si,ji,Fn)}const F=function(Ve){let Me;const wt=1+(Ve.length+8>>6),zt=new Array(16*wt);for(Me=0;Me<16*wt;Me++)zt[Me]=0;for(Me=0;Me<Ve.length;Me++)zt[Me>>2]|=Ve.charCodeAt(Me)<<Me%4*8;return zt[Me>>2]|=128<<Me%4*8,zt[16*wt-2]=8*Ve.length,zt}(p);let H,J,ee,se,ye,me=1732584193,ue=-271733879,he=-1732584194,pe=271733878;for(H=0;H<F.length;H+=16)J=me,ee=ue,se=he,ye=pe,me=C(me,ue,he,pe,F[H+0],7,-680876936),pe=C(pe,me,ue,he,F[H+1],12,-389564586),he=C(he,pe,me,ue,F[H+2],17,606105819),ue=C(ue,he,pe,me,F[H+3],22,-1044525330),me=C(me,ue,he,pe,F[H+4],7,-176418897),pe=C(pe,me,ue,he,F[H+5],12,1200080426),he=C(he,pe,me,ue,F[H+6],17,-1473231341),ue=C(ue,he,pe,me,F[H+7],22,-45705983),me=C(me,ue,he,pe,F[H+8],7,1770035416),pe=C(pe,me,ue,he,F[H+9],12,-1958414417),he=C(he,pe,me,ue,F[H+10],17,-42063),ue=C(ue,he,pe,me,F[H+11],22,-1990404162),me=C(me,ue,he,pe,F[H+12],7,1804603682),pe=C(pe,me,ue,he,F[H+13],12,-40341101),he=C(he,pe,me,ue,F[H+14],17,-1502002290),ue=C(ue,he,pe,me,F[H+15],22,1236535329),me=N(me,ue,he,pe,F[H+1],5,-165796510),pe=N(pe,me,ue,he,F[H+6],9,-1069501632),he=N(he,pe,me,ue,F[H+11],14,643717713),ue=N(ue,he,pe,me,F[H+0],20,-373897302),me=N(me,ue,he,pe,F[H+5],5,-701558691),pe=N(pe,me,ue,he,F[H+10],9,38016083),he=N(he,pe,me,ue,F[H+15],14,-660478335),ue=N(ue,he,pe,me,F[H+4],20,-405537848),me=N(me,ue,he,pe,F[H+9],5,568446438),pe=N(pe,me,ue,he,F[H+14],9,-1019803690),he=N(he,pe,me,ue,F[H+3],14,-187363961),ue=N(ue,he,pe,me,F[H+8],20,1163531501),me=N(me,ue,he,pe,F[H+13],5,-1444681467),pe=N(pe,me,ue,he,F[H+2],9,-51403784),he=N(he,pe,me,ue,F[H+7],14,1735328473),ue=N(ue,he,pe,me,F[H+12],20,-1926607734),me=x(me,ue,he,pe,F[H+5],4,-378558),pe=x(pe,me,ue,he,F[H+8],11,-2022574463),he=x(he,pe,me,ue,F[H+11],16,1839030562),ue=x(ue,he,pe,me,F[H+14],23,-35309556),me=x(me,ue,he,pe,F[H+1],4,-1530992060),pe=x(pe,me,ue,he,F[H+4],11,1272893353),he=x(he,pe,me,ue,F[H+7],16,-155497632),ue=x(ue,he,pe,me,F[H+10],23,-1094730640),me=x(me,ue,he,pe,F[H+13],4,681279174),pe=x(pe,me,ue,he,F[H+0],11,-358537222),he=x(he,pe,me,ue,F[H+3],16,-722521979),ue=x(ue,he,pe,me,F[H+6],23,76029189),me=x(me,ue,he,pe,F[H+9],4,-640364487),pe=x(pe,me,ue,he,F[H+12],11,-421815835),he=x(he,pe,me,ue,F[H+15],16,530742520),ue=x(ue,he,pe,me,F[H+2],23,-995338651),me=B(me,ue,he,pe,F[H+0],6,-198630844),pe=B(pe,me,ue,he,F[H+7],10,1126891415),he=B(he,pe,me,ue,F[H+14],15,-1416354905),ue=B(ue,he,pe,me,F[H+5],21,-57434055),me=B(me,ue,he,pe,F[H+12],6,1700485571),pe=B(pe,me,ue,he,F[H+3],10,-1894986606),he=B(he,pe,me,ue,F[H+10],15,-1051523),ue=B(ue,he,pe,me,F[H+1],21,-2054922799),me=B(me,ue,he,pe,F[H+8],6,1873313359),pe=B(pe,me,ue,he,F[H+15],10,-30611744),he=B(he,pe,me,ue,F[H+6],15,-1560198380),ue=B(ue,he,pe,me,F[H+13],21,1309151649),me=B(me,ue,he,pe,F[H+4],6,-145523070),pe=B(pe,me,ue,he,F[H+11],10,-1120210379),he=B(he,pe,me,ue,F[H+2],15,718787259),ue=B(ue,he,pe,me,F[H+9],21,-343485551),me=T(me,J),ue=T(ue,ee),he=T(he,se),pe=T(pe,ye);return v(me)+v(ue)+v(he)+v(pe)}(""+i+s)).slice(0,16),u=a.slice(0,12),h=await window.crypto.subtle.importKey("raw",a,"AES-GCM",!0,["encrypt"]);return new Uint8Array(await window.crypto.subtle.encrypt({name:"AES-GCM",iv:u},h,o))},P7=async(o,i,s)=>await Fle(o.buffer,i,s);function x7(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function ha(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?x7(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):x7(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}class Ct extends Vr{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==ns.PLAYING)}get processorContext(){return this._processorContext}set processorContext(i){this._processorContext=i}get __className__(){return"LocalVideoTrack"}constructor(i,s,a,u,h,p){if(super(i,h),O(this,"trackMediaType","video"),O(this,"_player",void 0),O(this,"isUseScaleResolutionDownBy",!1),O(this,"_videoVisibleTimer",null),O(this,"_statsTimer",null),O(this,"_previousVideoVisibleStatus",void 0),O(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),O(this,"_encoderConfig",void 0),O(this,"_scalabilityMode",{numSpatialLayers:1,numTemporalLayers:1}),O(this,"_optimizationMode",void 0),O(this,"_videoHeight",void 0),O(this,"_videoWidth",void 0),O(this,"_forceBitrateLimit",void 0),O(this,"_enabled",!0),O(this,"processorDestination",void 0),O(this,"_processorContext",void 0),fs()){const{width:_,height:v}=i.getSettings();this._videoWidth=_,this._videoHeight=v}else this.updateMediaStreamTrackResolution();if(this._encoderConfig=s,this._scalabilityMode=a,this._optimizationMode=u,this._hints=p||[],this._hints.indexOf(Ln.SCREEN_TRACK)===-1)this.updateBitrateFromProfile();else if(function(_,v,T){const b=Zt();return!(b.name!==_||!b.osVersion)&&(T?Number(b.version)>=v&&Number(b.version)<=T:Number(b.version)===v)}(an.CHROME,115)&&ZR().indexOf("Windows")!==-1){const _=function(v,T){if("VideoFrame"in window&&"TransformStream"in window&&In().supportWebRTCInsertableStream){const b=new MediaStreamTrackProcessor(v),C=new MediaStreamTrackGenerator({kind:"video"});let N,x,B=Date.now();const F=()=>{H&&(clearInterval(H),H=void 0),N&&(N.close(),N=void 0),v.stop(),x=void 0,C.removeEventListener("ended",F)};let H=window.setInterval(()=>{if(x&&N&&Date.now()-B>(T??1e3))try{C.readyState==="live"?x.enqueue(N.clone()):F()}catch{F()}},T??1e3);const J=new TransformStream({transform:(ee,se)=>{C.readyState==="live"?(x=se,B=Date.now(),N===void 0?(N=ee,se.enqueue(ee.clone())):(se.enqueue(N),N=ee)):ee.close()}});return C.addEventListener("ended",F),b.readable.pipeThrough(J).pipeTo(C.writable),C}}(i);_&&(D.info("local screen video track begin to inject frame"),this._mediaStreamTrack=_)}s&&this._hints.indexOf(Ln.CUSTOM_TRACK)!==-1&&this.setEncoderConfiguration(s),this.processorContext=new S7(this.getTrackId(),"local"),this.processorDestination=new y7(this.processorContext),this.bindProcessorDestinationEvents()}play(i){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof i=="string"){const u=document.getElementById(i);u?i=u:(D.warning("[".concat(this.getTrackId(),'] can not find "#').concat(i,'" element, use document.body')),i=document.body)}D.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(i instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(s));const a=ha(ha(ha({},this._getDefaultPlayerConfig()),s),{},{trackId:this.getTrackId(),element:i});this._player?this._player.updateConfig(a):(i instanceof HTMLVideoElement?this._player=new z2(a):this._player=new O7(a),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const u=this.getVideoElementVisibleStatus();this.safeEmit(Lh.VIDEO_ELEMENT_VISIBLE_STATUS,u)}catch{}},te("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._statsTimer&&(this.isUseScaleResolutionDownBy=!1,window.clearInterval(this._statsTimer),this._statsTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,D.debug("[".concat(this.getTrackId(),"] stop video playback")))}async setEnabled(i,s){if(!s){if(i===this._enabled)return;this.stateCheck("enabled",i)}if(D.info("[".concat(this.getTrackId(),"] start setEnabled"),i),!i){this._originMediaStreamTrack.enabled=!1;try{await bn(this,qe.NEED_DISABLE_TRACK,this)}catch(a){throw D.error("[".concat(this.getTrackId(),"] setEnabled to false error"),a.toString()),a}return s||(this._enabled=!1),void D.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}this._originMediaStreamTrack.enabled=!0;try{await bn(this,qe.NEED_ENABLE_TRACK,this)}catch(a){throw D.error("[".concat(this.getTrackId(),"] setEnabled to true error"),a.toString()),a}D.info("[".concat(this.getTrackId(),"] setEnabled to true success")),s||(this._enabled=!0)}async setMuted(i){i!==this._muted&&(this.stateCheck("muted",i),this._muted=i,this._originMediaStreamTrack.enabled=!i,D.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(i)),i?await bn(this,qe.NEED_MUTE_TRACK,this):await bn(this,qe.NEED_UNMUTE_TRACK,this))}async setEncoderConfiguration(i,s){if(!this._enabled)throw new Ee(z.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");if(i==="720p_auto"?this.startMonitorStats():this._statsTimer&&(window.clearInterval(this._statsTimer),this._statsTimer=null),i=eu(i),this._forceBitrateLimit&&(i.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:i.bitrateMax,i.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:i.bitrateMin),i.width||i.height||i.frameRate){const a=xI({encoderConfig:i});(fs()||ps()||Yl())&&(a.deviceId=void 0),D.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(i),JSON.stringify(a));try{await this._originMediaStreamTrack.applyConstraints(a),this.updateMediaStreamTrackResolution()}catch(u){const h=new Ee(z.UNEXPECTED_ERROR,u.toString());throw D.error("[".concat(this.getTrackId(),"] applyConstraints error"),h.toString()),h}}this._encoderConfig=i,this._hints.indexOf(Ln.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await bn(this,qe.NEED_UPDATE_VIDEO_ENCODER,this)}catch(a){return a.throw(D)}}getStats(){return z0(()=>{D.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")},"localVideoTrackGetStatsWarning"),oo(this,qe.GET_STATS)||ha({},k2)}async setBeautyEffect(i){D.error("LocalVideoTrack.setBeautyEffect was deprecated, please migrate to agora-extension-beauty-effect")}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameImage(i){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this._player?this._player.getCurrentFrameToUint8Array(i,s):await $2(i)}async setBitrateLimit(i){if(D.debug("[".concat(this.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(i))),i){this._forceBitrateLimit=i,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<i.max_bitrate?this._encoderConfig.bitrateMax:i.max_bitrate:this._encoderConfig.bitrateMax=i.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=i.min_bitrate);try{await bn(this,qe.NEED_UPDATE_VIDEO_ENCODER,this)}catch(s){return s.throw(D)}}}async setOptimizationMode(i){if(i!=="motion"&&i!=="detail"&&i!=="balanced")return void D.error(z.INVALID_PARAMS,"optimization mode must be motion, detail or balanced");const s=this._optimizationMode;try{this._optimizationMode=i,await bn(this,qe.SET_OPTIMIZATION_MODE,this)}catch(a){throw this._optimizationMode=s,D.error("[".concat(this.getTrackId(),"] set optimization mode failed"),a.toString()),a}D.info("[".concat(this.getTrackId(),"] set optimization mode success (").concat(i,")"))}setScalabiltyMode(i){if(i.numSpatialLayers===1&&i.numTemporalLayers!==1)return D.error(z.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),void(this._scalabilityMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabilityMode=i,D.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(i,")"))}updateMediaStreamTrackResolution(){N7(this._originMediaStreamTrack).then(i=>{let[s,a]=i;this._videoHeight=a,this._videoWidth=s}).catch(sI)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}async setSenderConfiguration(i){if(!this._enabled)throw new Ee(z.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");D.debug("[".concat(this.getTrackId(),"] setSenderConfiguration applyConstraints"),JSON.stringify(i)),i=eu(i),this._forceBitrateLimit&&(i.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:i.bitrateMax,i.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:i.bitrateMin),this._encoderConfig=i,this._hints.indexOf(Ln.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await bn(this,qe.NEED_UPDATE_VIDEO_ENCODER,this)}catch(s){return s.throw(D)}}updateBitrateFromProfile(){if(!this._encoderConfig)return;const{width:i,height:s,frameRate:a}=this.getMediaStreamTrackSettings();if(!i||!s||!a)return;const[u,h]=function(p,_,v,T){let b;const C=200*Math.pow(v/15,.6)*Math.pow(p*_/640/360,.75),N=C;if(T==="STANDARD_BITRATE")b=4*C;else{if(T!=="COMPATIABLE_BITRATE")return;b=2*C}return[Math.floor(b),Math.floor(N)]}(i,s,a,te("BITRATE_ADAPTER_TYPE"))||[void 0,void 0];this._encoderConfig.bitrateMin||this._encoderConfig.bitrateMax||(this._encoderConfig.bitrateMin=h,this._encoderConfig.bitrateMax=u,D.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(i,", h: ").concat(s,", fps: ").concat(a,"] => [brMax: ").concat(u,", brMin: ").concat(h,"]")))}getVideoElementVisibleStatus(){try{var i,s;const a=this==null||(i=this._player)===null||i===void 0?void 0:i.getContainerElement(),u={track:this,element:this==null||(s=this._player)===null||s===void 0?void 0:s.getVideoElement(),slot:a==null?void 0:a.parentElement},{element:h,slot:p}=u;if(this.isPlaying&&h instanceof HTMLVideoElement&&p instanceof HTMLElement){const _=E8.checkOneElementVisible(h),v=Object.assign({},_);if(v.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=v.visible;const T=it.reportApiInvoke(null,{tag:Yn.TRACER,name:Mi.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});v.visible?T.onSuccess("Video is visible"):T.onSuccess("Invisible because of ".concat(v.reason))}return v}return}catch(a){throw new Ee(z.GET_VIDEO_ELEMENT_VISIBLE_ERROR,a.message)}}async renewMediaStreamTrack(i){}pipe(i){if(this.processor===i)return i;if(i._source)throw new Ee(z.INVALID_OPERATION,"Processor ".concat(i.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=i,this.processor._source=this,i.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),i}unpipe(){if(!this.processor)return;const i=this.processor;this.processor._source=void 0,this.processor=void 0,i.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}clone(i){let s=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],a=this._encoderConfig;i&&(a=ha(ha({},a),eu(i))),a=$p(a);const u=wn(8,"track-video-cloned-"),h=new Ct(s?this._mediaStreamTrack.clone():this._mediaStreamTrack,a,$p(this._scalabilityMode),this._optimizationMode,u,$p(this._hints));return i&&a&&h.setEncoderConfiguration(a),D.debug("clone video track from ".concat(this.getTrackId()," to ").concat(u,", clone ").concat(s)),h}async replaceTrack(i,s){if(!(i instanceof MediaStreamTrack))throw new Ee(z.INVALID_PARAMS,"track should be an instance of MediaStreamTrack");if(i.kind!=="video")throw new Ee(z.INVALID_PARAMS,"track should be a video MediaStreamTrack");await this._updateOriginMediaStreamTrack(i,s,!0),this.updateMediaStreamTrackResolution()}startMonitorStats(){if(!fs()&&!ps())return;this._statsTimer&&window.clearInterval(this._statsTimer);let i=2,s=bI[i],a=-1,u=Date.now();const h=p=>{p>2||p<0||(u=Date.now(),s=bI[p],this.setSenderConfiguration(s))};this.isUseScaleResolutionDownBy=!0,this._statsTimer=window.setInterval(()=>{const p=this.getStats(),_=oo(this,qe.GET_RTC_STATS);if(p.sendPackets>0&&_){a===-1&&(a=Date.now());const v=Date.now();if(v-a<1e3||v-u<te("PROFILE_SWITCH_INTERVAL"))return;const T=p.sendFrameRate,b=.6*s.frameRate,C=.9*s.frameRate;typeof T=="number"&&T>0&&T<b?i>0&&(i--,h(i),D.debug("[".concat(this.getTrackId(),"] step down for fps ").concat(T,", switchProfile to ").concat(i))):_.OutgoingAvailableBandwidth<s.bitrateMin?i>0&&(i--,h(i),D.debug("[".concat(this.getTrackId(),"] step down for OutgoingAvailableBandwidth ").concat(_.OutgoingAvailableBandwidth,", bitrateMin ").concat(s.bitrateMin,", switchProfile to ").concat(i))):typeof T=="number"&&T>C&&i<bI.length-1&&_.OutgoingAvailableBandwidth>1.2*bI[i+1].bitrateMin&&(i++,h(i),D.debug("[".concat(this.getTrackId(),"] step up for fps ").concat(T,", OutgoingAvailableBandwidth ").concat(_.OutgoingAvailableBandwidth,", switchProfile to ").concat(i)))}},te("CHECK_LOCAL_STATS_INTERVAL"))}bindProcessorDestinationEvents(){this.processorDestination.on(ts.ON_TRACK,async i=>{i?i!==this._mediaStreamTrack&&(this._mediaStreamTrack=i,this._updatePlayerSource(),await bn(this,qe.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await bn(this,qe.NEED_REPLACE_TRACK,this))})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(ts.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(ho.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(ho.REQUEST_CONSTRAINTS)}}ve([ht({argsMap:(o,i,s)=>[o.getTrackId(),typeof i=="string"?i:i instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",s]}),fi(),j("design:type",Function),j("design:paramtypes",[Object,Object]),j("design:returntype",void 0)],Ct.prototype,"play",null),ve([ht({argsMap:o=>[o.getTrackId()]}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Ct.prototype,"stop",null),ve([W_("LocalVideoTrack","_enabledMutex"),ht({argsMap:(o,i)=>[o.getTrackId(),i]}),fi(),j("design:type",Function),j("design:paramtypes",[Boolean,Boolean]),j("design:returntype",le)],Ct.prototype,"setEnabled",null),ve([W_("LocalVideoTrack","_enabledMutex"),ht({argsMap:(o,i)=>[o.getTrackId(),i]}),fi(),j("design:type",Function),j("design:paramtypes",[Boolean]),j("design:returntype",le)],Ct.prototype,"setMuted",null),ve([ht({argsMap:(o,i)=>[o.getTrackId(),i]}),fi(),j("design:type",Function),j("design:paramtypes",[Object,Boolean]),j("design:returntype",le)],Ct.prototype,"setEncoderConfiguration",null),ve([fi(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",Object)],Ct.prototype,"getStats",null),ve([ht({argsMap:(o,i,s)=>[o.getTrackId(),i,s]}),fi(),j("design:type",Function),j("design:paramtypes",[Boolean,Object]),j("design:returntype",le)],Ct.prototype,"setBeautyEffect",null),ve([fi(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",ImageData)],Ct.prototype,"getCurrentFrameData",null),ve([fi(),j("design:type",Function),j("design:paramtypes",[String,Number]),j("design:returntype",le)],Ct.prototype,"getCurrentFrameImage",null),ve([fi(),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",le)],Ct.prototype,"setBitrateLimit",null),ve([fi(),j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",le)],Ct.prototype,"setOptimizationMode",null),ve([fi(),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",void 0)],Ct.prototype,"setScalabiltyMode",null),ve([fi(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Ct.prototype,"updateMediaStreamTrackResolution",null),ve([ht({argsMap:(o,i)=>[o.getTrackId(),i.name]}),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",Object)],Ct.prototype,"pipe",null),ve([ht({argsMap:o=>[o.getTrackId()]}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Ct.prototype,"unpipe",null),ve([ht({argsMap:o=>[o.getTrackId()]}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Ct.prototype,"close",null),ve([ht({argsMap:(o,i,s)=>[o.getTrackId(),i.label,s]}),j("design:type",Function),j("design:paramtypes",[MediaStreamTrack,Boolean]),j("design:returntype",le)],Ct.prototype,"replaceTrack",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Ct.prototype,"startMonitorStats",null);class jh extends Ct{get __className__(){return"CameraVideoTrack"}constructor(i,s,a,u,h,p){super(i,eu(s.encoderConfig),u,h,p),O(this,"_config",void 0),O(this,"_originalConstraints",void 0),O(this,"_constraints",void 0),O(this,"_enabled",!0),O(this,"_deviceName","default"),O(this,"tryResumeVideoForIOS15_16WeChat",async()=>{(j_()||HM())&&!function(){const _=Zt();if(_.os!==tr.IOS||!_.osVersion)return!1;const v=_.osVersion.split(".");return Number(v[0])===15&&Number(v[1])>=2}()&&f8()&&this._enabled&&!this._isClosed&&(D.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),await this.renewMediaStreamTrack())}),this._config=s,this._originalConstraints=a,this._constraints=a,this._deviceName=i.label,this._encoderConfig=eu(this._config.encoderConfig),_n.on(mr.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),_n.on(mr.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),this.bindProcessorContextEvents()}async setDevice(i){return typeof i=="string"?this._setDeviceById(i):i.deviceId?this._setDeviceById(i.deviceId):i.facingMode?this._setDeviceByFacingModel(i.facingMode):void 0}async _setDeviceById(i){if(D.info("[".concat(this.getTrackId(),"] set device to ").concat(i)),this._enabled)try{const s=await ua.getDeviceById(i),a={};a.video=ha({},this._constraints),a.video.deviceId={exact:i},a.video.facingMode=void 0,this._originMediaStreamTrack.stop();let u=null;try{u=await la(a,this.getTrackId())}catch(h){throw D.error("[".concat(this.getTrackId(),"] setDevice failed"),h.toString()),u=await la({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(u.getVideoTracks()[0],!1),h}await this._updateOriginMediaStreamTrack(u.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution(),this._deviceName=s.label,this._config.cameraId=i,this._constraints.deviceId={exact:i}}catch(s){throw D.error("[".concat(this.getTrackId(),"] setDevice error"),s.toString()),s}else try{const s=await ua.getDeviceById(i);this._deviceName=s.label,this._config.cameraId=i,this._constraints.deviceId={exact:i}}catch(s){throw D.error("[".concat(this.getTrackId(),"] setDevice error"),s.toString()),s}D.info("[".concat(this.getTrackId(),"] setDevice success"))}async _setDeviceByFacingModel(i){D.info("[".concat(this.getTrackId(),"] set facingMode ").concat(i));const s={video:ha(ha({},this._constraints),{},{deviceId:void 0,facingMode:{exact:i}})};if(this._enabled){this._originMediaStreamTrack.stop();let a=null;try{a=await la(s,this.getTrackId())}catch(u){throw D.error("[".concat(this.getTrackId(),"] setDeviceByFacingModel failed"),u.toString()),a=await la({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(a.getVideoTracks()[0],!1),u}await this._updateOriginMediaStreamTrack(a.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution()}this._deviceName="",this._config.facingMode=i,this._config.cameraId=void 0,this._constraints=ha({},s.video),D.info("[".concat(this.getTrackId(),"] setDeviceByFacingModel success"))}async setEnabled(i,s){if(!s){if(i===this._enabled)return;this.stateCheck("enabled",i)}if(D.info("[".concat(this.getTrackId(),"] start setEnabled"),i),i){try{if(this.isExternalTrack)this._originMediaStreamTrack.enabled=!0;else{const a=await la({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(a.getVideoTracks()[0],!1)}await bn(this,qe.NEED_ENABLE_TRACK,this)}catch(a){throw D.error("[".concat(this.getTrackId(),"] setEnabled true error"),a.toString()),a}this.updateMediaStreamTrackResolution(),D.info("[".concat(this.getTrackId(),"] setEnabled to true success")),s||(this._enabled=!0)}else{this.isExternalTrack?this._originMediaStreamTrack.enabled=!1:(this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop()),s||(this._enabled=!1);try{await bn(this,qe.NEED_DISABLE_TRACK,this)}catch(a){throw D.error("[".concat(this.getTrackId(),"] setEnabled to false error"),a.toString()),a}D.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}}async setEncoderConfiguration(i,s){if(!this._enabled)throw new Ee(z.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");i==="720p_auto"?this.startMonitorStats():this._statsTimer&&(window.clearInterval(this._statsTimer),this._statsTimer=null),i=eu(i),this._forceBitrateLimit&&(i.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:i.bitrateMax,i.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:i.bitrateMin);const a=Ai(this._config);a.encoderConfig=i;const u=xI(a);(fs()||ps()||Yl())&&(u.deviceId=void 0),D.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(i),JSON.stringify(u));try{await this._originMediaStreamTrack.applyConstraints(u),this.updateMediaStreamTrackResolution()}catch(h){const p=new Ee(z.UNEXPECTED_ERROR,h.toString());throw D.error("[".concat(this.getTrackId(),"] applyConstraints error"),p.toString()),p}this._config=a,this._constraints=u,this._originalConstraints=u,this._encoderConfig=i,this._hints.indexOf(Ln.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await bn(this,qe.NEED_UPDATE_VIDEO_ENCODER,this)}catch(h){return h.throw(D)}}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){if((ps()||Yl())&&this._enabled&&!this._isClosed&&_n.duringInterruption){const i=async()=>{_n.off(mr.IOS_INTERRUPTION_END,i),this._enabled&&!this._isClosed&&(D.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};_n.on(mr.IOS_INTERRUPTION_END,i)}else D.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Lh.TRACK_ENDED)}async renewMediaStreamTrack(i){const s=i||this._constraints,a=ua.searchDeviceIdByName(this._deviceName);if(a&&!s.deviceId&&(s.deviceId={exact:a}),this._enabled){const u=await la({video:s},this.getTrackId());this._constraints=s,await this._updateOriginMediaStreamTrack(u.getVideoTracks()[0],!0),this.updateMediaStreamTrackResolution()}}close(){super.close(),_n.off(mr.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),_n.off(mr.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat)}clone(i){let s=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],a=this._encoderConfig;i&&(a=ha(ha({},a),eu(i))),a=$p(a);const u=wn(8,"track-cam-cloned-"),h=new jh(s?this._mediaStreamTrack.clone():this._mediaStreamTrack,$p(ha(ha({},this._config),{},{encoderConfig:a})),$p(this._constraints),$p(this._scalabilityMode),this._optimizationMode,u);return i&&a&&h.setEncoderConfiguration(a),D.debug("clone track from ".concat(this.getTrackId()," to ").concat(u,", clone ").concat(s)),h}bindProcessorContextEvents(){this.processorContext.on(ho.REQUEST_UPDATE_CONSTRAINTS,async(i,s,a)=>{try{const u=Object.assign({},this._originalConstraints,...i);await this.renewMediaStreamTrack(u),s()}catch(u){a(u)}}),this.processorContext.on(ho.REQUEST_CONSTRAINTS,async i=>{i(this._originMediaStreamTrack.getSettings())})}}function D7(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function DI(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?D7(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):D7(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}function G2(o,i,s,a){s.optimizationMode&&(a&&a.width&&a.height?(s.encoderConfig=DI(DI({},a),{},{bitrateMin:a.bitrateMin,bitrateMax:a.bitrateMax}),s.optimizationMode!=="motion"&&s.optimizationMode!=="detail"||(i.contentHint=s.optimizationMode,i.contentHint===s.optimizationMode?D.debug("[".concat(o,"] set content hint to"),s.optimizationMode):D.debug("[".concat(o,"] set content hint failed")))):D.warning("[".concat(o,"] can not apply optimization mode bitrate config, no encoderConfig")))}function k7(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function kI(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?k7(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):k7(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}ve([ht({argsMap:(o,i)=>[o.getTrackId(),i]}),fi(),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",le)],jh.prototype,"setDevice",null),ve([W_("CameraVideoTrack","_enabledMutex"),ht({argsMap:(o,i)=>[o.getTrackId(),i]}),fi(),j("design:type",Function),j("design:paramtypes",[Boolean,Boolean]),j("design:returntype",le)],jh.prototype,"setEnabled",null),ve([ht({argsMap:(o,i)=>[o.getTrackId(),i]}),fi(),j("design:type",Function),j("design:paramtypes",[Object,Boolean]),j("design:returntype",le)],jh.prototype,"setEncoderConfiguration",null),ve([ht({argsMap:o=>[o.getTrackId()]}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],jh.prototype,"close",null);class L7 extends r7{getUserId(){return this._userId}constructor(i,s,a,u){super(i,"track-".concat(i.kind,"-").concat(s,"-").concat(u.clientId,"_").concat(wn(5,""))),O(this,"_userId",void 0),O(this,"_uintId",void 0),O(this,"_isDestroyed",!1),O(this,"store",void 0),O(this,"processor",void 0),this._userId=s,this._uintId=a,this.store=u}_updateOriginMediaStreamTrack(i){this._originMediaStreamTrack=i,this._mediaStreamTrack=i,this._updatePlayerSource(),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}_destroy(){this._isDestroyed=!0,D.info("[".concat(this.getTrackId(),"] is destroyed")),this.stop(),super.close()}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}class tu extends L7{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==ns.PLAYING)}get __className__(){return"RemoteVideoTrack"}constructor(i,s,a,u){super(i,s,a,u),O(this,"_videoVisibleTimer",null),O(this,"_previousVideoVisibleStatus",void 0),O(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),O(this,"trackMediaType","video"),O(this,"_videoWidth",void 0),O(this,"_videoHeight",void 0),O(this,"_player",void 0),O(this,"processorDestination",void 0),O(this,"processorContext",void 0),this.updateMediaStreamTrackResolution(),this.processorContext=new S7(this.getTrackId(),"remote"),this.processorDestination=new y7(this.processorContext),this.bindProcessorDestinationEvents()}getStats(){return z0(()=>{D.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")},"remoteVideoTrackGetStatsWarning"),oo(this,qe.GET_STATS)||kI({},i7)}play(i){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof i=="string"){const u=document.getElementById(i);u?i=u:(D.warning("[".concat(this.getTrackId(),'] can not find "#').concat(i,'" element, use document.body')),i=document.body)}D.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(i instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(s));const a=kI(kI({fit:"cover"},s),{},{trackId:this.getTrackId(),element:i});this._player?this._player.updateConfig(a):(i instanceof HTMLVideoElement?this._player=new z2(a):this._player=new O7(a),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,Date.now()),this.safeEmit(Jp.FIRST_FRAME_DECODED)}),this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const u=this.getVideoElementVisibleStatus();this.safeEmit(Jp.VIDEO_ELEMENT_VISIBLE_STATUS,u)}catch{}},te("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,D.debug("[".concat(this.getTrackId(),"] stop video playback")))}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){N7(this._originMediaStreamTrack).then(i=>{let[s,a]=i;this._videoHeight=a,this._videoWidth=s}).catch(sI)}_updatePlayerSource(){D.debug("[".concat(this.getTrackId(),"] update player source track")),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var i,s;const a=this==null||(i=this._player)===null||i===void 0?void 0:i.getContainerElement(),u={track:this,element:this==null||(s=this._player)===null||s===void 0?void 0:s.getVideoElement(),slot:a==null?void 0:a.parentElement},{element:h,slot:p}=u;if(this.isPlaying&&h instanceof HTMLVideoElement&&p instanceof HTMLElement){const _=E8.checkOneElementVisible(h),v=Object.assign({},_);if(v.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=v.visible;const T=it.reportApiInvoke(null,{tag:Yn.TRACER,name:Mi.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});v.visible?T.onSuccess("Video is visible"):T.onSuccess("Invisible because of ".concat(v.reason))}return v}return}catch(a){throw new Ee(z.GET_VIDEO_ELEMENT_VISIBLE_ERROR,a.message)}}pipe(i){if(this.processor===i)return i;if(i._source)throw new Ee(z.INVALID_OPERATION,"Processor ".concat(i.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=i,this.processor._source=this,i.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),i}unpipe(){if(!this.processor)return;const i=this.processor;this.processor._source=void 0,this.processor=void 0,i.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(ts.ON_TRACK,async i=>{i?i!==this._mediaStreamTrack&&(this._mediaStreamTrack=i,this._updatePlayerSource()):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(ts.ON_TRACK)}_destroy(){super._destroy(),this.unbindProcessorDestinationEvents()}}ve([ht({argsMap:(o,i,s)=>[o.getTrackId(),typeof i=="string"?i:i instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",s]}),j("design:type",Function),j("design:paramtypes",[Object,Object]),j("design:returntype",void 0)],tu.prototype,"play",null),ve([ht({argsMap:o=>[o.getTrackId()]}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],tu.prototype,"stop",null),ve([ht({argsMap:(o,i)=>[o.getTrackId(),i.name]}),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",Object)],tu.prototype,"pipe",null),ve([ht({argsMap:o=>[o.getTrackId()]}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],tu.prototype,"unpipe",null);class _c extends L7{get isPlaying(){return this._useAudioElement?Mo.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"RemoteAudioTrack"}constructor(i,s,a,u){super(i,s,a,u),O(this,"trackMediaType","audio"),O(this,"_source",void 0),O(this,"_useAudioElement",!0),O(this,"_volume",100),O(this,"processorContext",void 0),O(this,"processorDestination",void 0),O(this,"_played",!1),O(this,"_bypassWebAudio",!1),te("DISABLE_WEBAUDIO")?(this._source=new B2,this._bypassWebAudio=!0,this._useAudioElement=!0):(this._source=new j2(i,!0),te("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1)),this._source.once(uo.RECEIVE_TRACK_BUFFER,()=>{this.safeEmit(Jp.FIRST_FRAME_DECODED)}),this.processorContext=new PI(this._source.context,this.getTrackId(),"remote"),this.processorDestination=new NI(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(uo.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})}setAudioFrameCallback(i){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!i)return this._source.removeAllListeners(uo.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(s),this._source.removeAllListeners(uo.ON_AUDIO_BUFFER),this._source.on(uo.ON_AUDIO_BUFFER,a=>i(a))}setVolume(i){this._volume=i,this._useAudioElement?Mo.setVolume(this.getTrackId(),i):this._source.setVolume(i/100)}async setPlaybackDevice(i){if(!this._useAudioElement)throw new Ee(z.NOT_SUPPORTED,"your browser does not support setting the audio output device");await Mo.setSinkID(this.getTrackId(),i)}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return z0(()=>{D.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")},"remoteAudioTrackGetStatsWarning"),oo(this,qe.GET_STATS)||kI({},n7)}play(){D.debug("[".concat(this.getTrackId(),"] start audio playback")),this._played=!0,this._useAudioElement?(D.debug("[".concat(this.getTrackId(),"] use audio element to play")),Mo.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):this._source.play()}stop(){D.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._played=!1,this._useAudioElement?Mo.stop(this.getTrackId()):this._source.stop()}_destroy(){super._destroy(),this._played=!1,this.unbindProcessorDestinationEvents(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){let i=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];D.debug("[".concat(this.getTrackId(),"] update player source track")),i&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&Mo.updateTrack(this.getTrackId(),this._mediaStreamTrack)}pipe(i){if(this._bypassWebAudio)throw new Ee(z.NOT_SUPPORTED,"can not pipe extension when WebAudio disabled");if(this.processor===i)return i;if(i._source)throw new Ee(z.INVALID_OPERATION,"Processor ".concat(i.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=i,this.processor._source=this,i.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),i}unpipe(){var i;if(this._bypassWebAudio)throw new Ee(z.NOT_SUPPORTED,"can not unpipe extension when WebAudio disabled");if(!this.processor)return;const s=this.processor;(i=this._source.processSourceNode)===null||i===void 0||i.disconnect(),this.processor._source=!1,this.processor=void 0,s.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(ts.ON_TRACK,async i=>{i?i!==this._mediaStreamTrack&&(this._mediaStreamTrack=i,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(i)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())}),this.processorDestination.on(ts.ON_NODE,i=>{this._source.processedNode=i;const s=!i;this._useAudioElement!==s&&(this._played?(this.stop(),this._useAudioElement=s,this.play()):this._useAudioElement=s)})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(ts.ON_TRACK),this.processorDestination.removeAllListeners(ts.ON_NODE)}}ve([ht({argsMap:(o,i)=>[o.getTrackId(),i],throttleTime:300}),j("design:type",Function),j("design:paramtypes",[Number]),j("design:returntype",void 0)],_c.prototype,"setVolume",null),ve([ht({argsMap:(o,i)=>[o.getTrackId(),i]}),j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",le)],_c.prototype,"setPlaybackDevice",null),ve([ht({argsMap:o=>[o.getTrackId()]}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],_c.prototype,"play",null),ve([ht({argsMap:o=>[o.getTrackId()]}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],_c.prototype,"stop",null),ve([ht({argsMap:(o,i)=>[o.getTrackId(),i.name]}),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",Object)],_c.prototype,"pipe",null),ve([ht({argsMap:o=>[o.getTrackId()]}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],_c.prototype,"unpipe",null);function iE(o){let i=o.length;for(;--i>=0;)o[i]=0}const K2=256,M7=286,Q0=30,Z0=15,q2=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),LI=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Vle=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),U7=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ud=new Array(576);iE(ud);const eS=new Array(60);iE(eS);const tS=new Array(512);iE(tS);const nS=new Array(256);iE(nS);const Y2=new Array(29);iE(Y2);const MI=new Array(Q0);function X2(o,i,s,a,u){this.static_tree=o,this.extra_bits=i,this.extra_base=s,this.elems=a,this.max_length=u,this.has_stree=o&&o.length}let j7,F7,V7;function J2(o,i){this.dyn_tree=o,this.max_code=0,this.stat_desc=i}iE(MI);const B7=o=>o<256?tS[o]:tS[256+(o>>>7)],iS=(o,i)=>{o.pending_buf[o.pending++]=255&i,o.pending_buf[o.pending++]=i>>>8&255},fa=(o,i,s)=>{o.bi_valid>16-s?(o.bi_buf|=i<<o.bi_valid&65535,iS(o,o.bi_buf),o.bi_buf=i>>16-o.bi_valid,o.bi_valid+=s-16):(o.bi_buf|=i<<o.bi_valid&65535,o.bi_valid+=s)},nu=(o,i,s)=>{fa(o,s[2*i],s[2*i+1])},W7=(o,i)=>{let s=0;do s|=1&o,o>>>=1,s<<=1;while(--i>0);return s>>>1},H7=(o,i,s)=>{const a=new Array(16);let u,h,p=0;for(u=1;u<=Z0;u++)p=p+s[u-1]<<1,a[u]=p;for(h=0;h<=i;h++){let _=o[2*h+1];_!==0&&(o[2*h]=W7(a[_]++,_))}},$7=o=>{let i;for(i=0;i<M7;i++)o.dyn_ltree[2*i]=0;for(i=0;i<Q0;i++)o.dyn_dtree[2*i]=0;for(i=0;i<19;i++)o.bl_tree[2*i]=0;o.dyn_ltree[512]=1,o.opt_len=o.static_len=0,o.sym_next=o.matches=0},z7=o=>{o.bi_valid>8?iS(o,o.bi_buf):o.bi_valid>0&&(o.pending_buf[o.pending++]=o.bi_buf),o.bi_buf=0,o.bi_valid=0},G7=(o,i,s,a)=>{const u=2*i,h=2*s;return o[u]<o[h]||o[u]===o[h]&&a[i]<=a[s]},Q2=(o,i,s)=>{const a=o.heap[s];let u=s<<1;for(;u<=o.heap_len&&(u<o.heap_len&&G7(i,o.heap[u+1],o.heap[u],o.depth)&&u++,!G7(i,a,o.heap[u],o.depth));)o.heap[s]=o.heap[u],s=u,u<<=1;o.heap[s]=a},K7=(o,i,s)=>{let a,u,h,p,_=0;if(o.sym_next!==0)do a=255&o.pending_buf[o.sym_buf+_++],a+=(255&o.pending_buf[o.sym_buf+_++])<<8,u=o.pending_buf[o.sym_buf+_++],a===0?nu(o,u,i):(h=nS[u],nu(o,h+K2+1,i),p=q2[h],p!==0&&(u-=Y2[h],fa(o,u,p)),a--,h=B7(a),nu(o,h,s),p=LI[h],p!==0&&(a-=MI[h],fa(o,a,p)));while(_<o.sym_next);nu(o,256,i)},Z2=(o,i)=>{const s=i.dyn_tree,a=i.stat_desc.static_tree,u=i.stat_desc.has_stree,h=i.stat_desc.elems;let p,_,v,T=-1;for(o.heap_len=0,o.heap_max=573,p=0;p<h;p++)s[2*p]!==0?(o.heap[++o.heap_len]=T=p,o.depth[p]=0):s[2*p+1]=0;for(;o.heap_len<2;)v=o.heap[++o.heap_len]=T<2?++T:0,s[2*v]=1,o.depth[v]=0,o.opt_len--,u&&(o.static_len-=a[2*v+1]);for(i.max_code=T,p=o.heap_len>>1;p>=1;p--)Q2(o,s,p);v=h;do p=o.heap[1],o.heap[1]=o.heap[o.heap_len--],Q2(o,s,1),_=o.heap[1],o.heap[--o.heap_max]=p,o.heap[--o.heap_max]=_,s[2*v]=s[2*p]+s[2*_],o.depth[v]=(o.depth[p]>=o.depth[_]?o.depth[p]:o.depth[_])+1,s[2*p+1]=s[2*_+1]=v,o.heap[1]=v++,Q2(o,s,1);while(o.heap_len>=2);o.heap[--o.heap_max]=o.heap[1],((b,C)=>{const N=C.dyn_tree,x=C.max_code,B=C.stat_desc.static_tree,F=C.stat_desc.has_stree,H=C.stat_desc.extra_bits,J=C.stat_desc.extra_base,ee=C.stat_desc.max_length;let se,ye,me,ue,he,pe,Ve=0;for(ue=0;ue<=Z0;ue++)b.bl_count[ue]=0;for(N[2*b.heap[b.heap_max]+1]=0,se=b.heap_max+1;se<573;se++)ye=b.heap[se],ue=N[2*N[2*ye+1]+1]+1,ue>ee&&(ue=ee,Ve++),N[2*ye+1]=ue,ye>x||(b.bl_count[ue]++,he=0,ye>=J&&(he=H[ye-J]),pe=N[2*ye],b.opt_len+=pe*(ue+he),F&&(b.static_len+=pe*(B[2*ye+1]+he)));if(Ve!==0){do{for(ue=ee-1;b.bl_count[ue]===0;)ue--;b.bl_count[ue]--,b.bl_count[ue+1]+=2,b.bl_count[ee]--,Ve-=2}while(Ve>0);for(ue=ee;ue!==0;ue--)for(ye=b.bl_count[ue];ye!==0;)me=b.heap[--se],me>x||(N[2*me+1]!==ue&&(b.opt_len+=(ue-N[2*me+1])*N[2*me],N[2*me+1]=ue),ye--)}})(o,i),H7(s,T,o.bl_count)},q7=(o,i,s)=>{let a,u,h=-1,p=i[1],_=0,v=7,T=4;for(p===0&&(v=138,T=3),i[2*(s+1)+1]=65535,a=0;a<=s;a++)u=p,p=i[2*(a+1)+1],++_<v&&u===p||(_<T?o.bl_tree[2*u]+=_:u!==0?(u!==h&&o.bl_tree[2*u]++,o.bl_tree[32]++):_<=10?o.bl_tree[34]++:o.bl_tree[36]++,_=0,h=u,p===0?(v=138,T=3):u===p?(v=6,T=3):(v=7,T=4))},Y7=(o,i,s)=>{let a,u,h=-1,p=i[1],_=0,v=7,T=4;for(p===0&&(v=138,T=3),a=0;a<=s;a++)if(u=p,p=i[2*(a+1)+1],!(++_<v&&u===p)){if(_<T)do nu(o,u,o.bl_tree);while(--_!=0);else u!==0?(u!==h&&(nu(o,u,o.bl_tree),_--),nu(o,16,o.bl_tree),fa(o,_-3,2)):_<=10?(nu(o,17,o.bl_tree),fa(o,_-3,3)):(nu(o,18,o.bl_tree),fa(o,_-11,7));_=0,h=u,p===0?(v=138,T=3):u===p?(v=6,T=3):(v=7,T=4)}};let X7=!1;const J7=(o,i,s,a)=>{fa(o,0+(a?1:0),3),z7(o),iS(o,s),iS(o,~s),s&&o.pending_buf.set(o.window.subarray(i,i+s),o.pending),o.pending+=s};var Ble=o=>{X7||((()=>{let i,s,a,u,h;const p=new Array(16);for(a=0,u=0;u<28;u++)for(Y2[u]=a,i=0;i<1<<q2[u];i++)nS[a++]=u;for(nS[a-1]=u,h=0,u=0;u<16;u++)for(MI[u]=h,i=0;i<1<<LI[u];i++)tS[h++]=u;for(h>>=7;u<Q0;u++)for(MI[u]=h<<7,i=0;i<1<<LI[u]-7;i++)tS[256+h++]=u;for(s=0;s<=Z0;s++)p[s]=0;for(i=0;i<=143;)ud[2*i+1]=8,i++,p[8]++;for(;i<=255;)ud[2*i+1]=9,i++,p[9]++;for(;i<=279;)ud[2*i+1]=7,i++,p[7]++;for(;i<=287;)ud[2*i+1]=8,i++,p[8]++;for(H7(ud,287,p),i=0;i<Q0;i++)eS[2*i+1]=5,eS[2*i]=W7(i,5);j7=new X2(ud,q2,257,M7,Z0),F7=new X2(eS,LI,0,Q0,Z0),V7=new X2(new Array(0),Vle,0,19,7)})(),X7=!0),o.l_desc=new J2(o.dyn_ltree,j7),o.d_desc=new J2(o.dyn_dtree,F7),o.bl_desc=new J2(o.bl_tree,V7),o.bi_buf=0,o.bi_valid=0,$7(o)},Wle=(o,i,s,a)=>{let u,h,p=0;o.level>0?(o.strm.data_type===2&&(o.strm.data_type=(_=>{let v,T=4093624447;for(v=0;v<=31;v++,T>>>=1)if(1&T&&_.dyn_ltree[2*v]!==0)return 0;if(_.dyn_ltree[18]!==0||_.dyn_ltree[20]!==0||_.dyn_ltree[26]!==0)return 1;for(v=32;v<K2;v++)if(_.dyn_ltree[2*v]!==0)return 1;return 0})(o)),Z2(o,o.l_desc),Z2(o,o.d_desc),p=(_=>{let v;for(q7(_,_.dyn_ltree,_.l_desc.max_code),q7(_,_.dyn_dtree,_.d_desc.max_code),Z2(_,_.bl_desc),v=18;v>=3&&_.bl_tree[2*U7[v]+1]===0;v--);return _.opt_len+=3*(v+1)+5+5+4,v})(o),u=o.opt_len+3+7>>>3,h=o.static_len+3+7>>>3,h<=u&&(u=h)):u=h=s+5,s+4<=u&&i!==-1?J7(o,i,s,a):o.strategy===4||h===u?(fa(o,2+(a?1:0),3),K7(o,ud,eS)):(fa(o,4+(a?1:0),3),((_,v,T,b)=>{let C;for(fa(_,v-257,5),fa(_,T-1,5),fa(_,b-4,4),C=0;C<b;C++)fa(_,_.bl_tree[2*U7[C]+1],3);Y7(_,_.dyn_ltree,v-1),Y7(_,_.dyn_dtree,T-1)})(o,o.l_desc.max_code+1,o.d_desc.max_code+1,p+1),K7(o,o.dyn_ltree,o.dyn_dtree)),$7(o),a&&z7(o)},Hle=(o,i,s)=>(o.pending_buf[o.sym_buf+o.sym_next++]=i,o.pending_buf[o.sym_buf+o.sym_next++]=i>>8,o.pending_buf[o.sym_buf+o.sym_next++]=s,i===0?o.dyn_ltree[2*s]++:(o.matches++,i--,o.dyn_ltree[2*(nS[s]+K2+1)]++,o.dyn_dtree[2*B7(i)]++),o.sym_next===o.sym_end),$le={_tr_init:Ble,_tr_stored_block:J7,_tr_flush_block:Wle,_tr_tally:Hle,_tr_align:o=>{fa(o,2,3),nu(o,256,ud),(i=>{i.bi_valid===16?(iS(i,i.bi_buf),i.bi_buf=0,i.bi_valid=0):i.bi_valid>=8&&(i.pending_buf[i.pending++]=255&i.bi_buf,i.bi_buf>>=8,i.bi_valid-=8)})(o)}},rS=(o,i,s,a)=>{let u=65535&o|0,h=o>>>16&65535|0,p=0;for(;s!==0;){p=s>2e3?2e3:s,s-=p;do u=u+i[a++]|0,h=h+u|0;while(--p);u%=65521,h%=65521}return u|h<<16|0};const zle=new Uint32Array((()=>{let o,i=[];for(var s=0;s<256;s++){o=s;for(var a=0;a<8;a++)o=1&o?3988292384^o>>>1:o>>>1;i[s]=o}return i})());var Is=(o,i,s,a)=>{const u=zle,h=a+s;o^=-1;for(let p=a;p<h;p++)o=o>>>8^u[255&(o^i[p])];return-1^o},em={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},rE={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Gle,_tr_stored_block:eU,_tr_flush_block:Kle,_tr_tally:Fh,_tr_align:qle}=$le,{Z_NO_FLUSH:Vh,Z_PARTIAL_FLUSH:Yle,Z_FULL_FLUSH:Xle,Z_FINISH:Ec,Z_BLOCK:Q7,Z_OK:Hs,Z_STREAM_END:Z7,Z_STREAM_ERROR:iu,Z_DATA_ERROR:Jle,Z_BUF_ERROR:tU,Z_DEFAULT_COMPRESSION:Qle,Z_FILTERED:Zle,Z_HUFFMAN_ONLY:UI,Z_RLE:eue,Z_FIXED:tue,Z_DEFAULT_STRATEGY:nue,Z_UNKNOWN:iue,Z_DEFLATED:jI}=rE,nU=286,rue=30,sue=19,oue=2*nU+1,aue=15,tm=258,ru=262,sE=42,nm=113,sS=666,im=(o,i)=>(o.msg=em[i],i),eH=o=>2*o-(o>4?9:0),Bh=o=>{let i=o.length;for(;--i>=0;)o[i]=0},cue=o=>{let i,s,a,u=o.w_size;i=o.hash_size,a=i;do s=o.head[--a],o.head[a]=s>=u?s-u:0;while(--i);i=u,a=i;do s=o.prev[--a],o.prev[a]=s>=u?s-u:0;while(--i)};let Wh=(o,i,s)=>(i<<o.hash_shift^s)&o.hash_mask;const Va=o=>{const i=o.state;let s=i.pending;s>o.avail_out&&(s=o.avail_out),s!==0&&(o.output.set(i.pending_buf.subarray(i.pending_out,i.pending_out+s),o.next_out),o.next_out+=s,i.pending_out+=s,o.total_out+=s,o.avail_out-=s,i.pending-=s,i.pending===0&&(i.pending_out=0))},Ba=(o,i)=>{Kle(o,o.block_start>=0?o.block_start:-1,o.strstart-o.block_start,i),o.block_start=o.strstart,Va(o.strm)},ci=(o,i)=>{o.pending_buf[o.pending++]=i},oS=(o,i)=>{o.pending_buf[o.pending++]=i>>>8&255,o.pending_buf[o.pending++]=255&i},iU=(o,i,s,a)=>{let u=o.avail_in;return u>a&&(u=a),u===0?0:(o.avail_in-=u,i.set(o.input.subarray(o.next_in,o.next_in+u),s),o.state.wrap===1?o.adler=rS(o.adler,i,u,s):o.state.wrap===2&&(o.adler=Is(o.adler,i,u,s)),o.next_in+=u,o.total_in+=u,u)},tH=(o,i)=>{let s,a,u=o.max_chain_length,h=o.strstart,p=o.prev_length,_=o.nice_match;const v=o.strstart>o.w_size-ru?o.strstart-(o.w_size-ru):0,T=o.window,b=o.w_mask,C=o.prev,N=o.strstart+tm;let x=T[h+p-1],B=T[h+p];o.prev_length>=o.good_match&&(u>>=2),_>o.lookahead&&(_=o.lookahead);do if(s=i,T[s+p]===B&&T[s+p-1]===x&&T[s]===T[h]&&T[++s]===T[h+1]){h+=2,s++;do;while(T[++h]===T[++s]&&T[++h]===T[++s]&&T[++h]===T[++s]&&T[++h]===T[++s]&&T[++h]===T[++s]&&T[++h]===T[++s]&&T[++h]===T[++s]&&T[++h]===T[++s]&&h<N);if(a=tm-(N-h),h=N-tm,a>p){if(o.match_start=i,p=a,a>=_)break;x=T[h+p-1],B=T[h+p]}}while((i=C[i&b])>v&&--u!=0);return p<=o.lookahead?p:o.lookahead},oE=o=>{const i=o.w_size;let s,a,u;do{if(a=o.window_size-o.lookahead-o.strstart,o.strstart>=i+(i-ru)&&(o.window.set(o.window.subarray(i,i+i-a),0),o.match_start-=i,o.strstart-=i,o.block_start-=i,o.insert>o.strstart&&(o.insert=o.strstart),cue(o),a+=i),o.strm.avail_in===0)break;if(s=iU(o.strm,o.window,o.strstart+o.lookahead,a),o.lookahead+=s,o.lookahead+o.insert>=3)for(u=o.strstart-o.insert,o.ins_h=o.window[u],o.ins_h=Wh(o,o.ins_h,o.window[u+1]);o.insert&&(o.ins_h=Wh(o,o.ins_h,o.window[u+3-1]),o.prev[u&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=u,u++,o.insert--,!(o.lookahead+o.insert<3)););}while(o.lookahead<ru&&o.strm.avail_in!==0)},nH=(o,i)=>{let s,a,u,h=o.pending_buf_size-5>o.w_size?o.w_size:o.pending_buf_size-5,p=0,_=o.strm.avail_in;do{if(s=65535,u=o.bi_valid+42>>3,o.strm.avail_out<u||(u=o.strm.avail_out-u,a=o.strstart-o.block_start,s>a+o.strm.avail_in&&(s=a+o.strm.avail_in),s>u&&(s=u),s<h&&(s===0&&i!==Ec||i===Vh||s!==a+o.strm.avail_in)))break;p=i===Ec&&s===a+o.strm.avail_in?1:0,eU(o,0,0,p),o.pending_buf[o.pending-4]=s,o.pending_buf[o.pending-3]=s>>8,o.pending_buf[o.pending-2]=~s,o.pending_buf[o.pending-1]=~s>>8,Va(o.strm),a&&(a>s&&(a=s),o.strm.output.set(o.window.subarray(o.block_start,o.block_start+a),o.strm.next_out),o.strm.next_out+=a,o.strm.avail_out-=a,o.strm.total_out+=a,o.block_start+=a,s-=a),s&&(iU(o.strm,o.strm.output,o.strm.next_out,s),o.strm.next_out+=s,o.strm.avail_out-=s,o.strm.total_out+=s)}while(p===0);return _-=o.strm.avail_in,_&&(_>=o.w_size?(o.matches=2,o.window.set(o.strm.input.subarray(o.strm.next_in-o.w_size,o.strm.next_in),0),o.strstart=o.w_size,o.insert=o.strstart):(o.window_size-o.strstart<=_&&(o.strstart-=o.w_size,o.window.set(o.window.subarray(o.w_size,o.w_size+o.strstart),0),o.matches<2&&o.matches++,o.insert>o.strstart&&(o.insert=o.strstart)),o.window.set(o.strm.input.subarray(o.strm.next_in-_,o.strm.next_in),o.strstart),o.strstart+=_,o.insert+=_>o.w_size-o.insert?o.w_size-o.insert:_),o.block_start=o.strstart),o.high_water<o.strstart&&(o.high_water=o.strstart),p?4:i!==Vh&&i!==Ec&&o.strm.avail_in===0&&o.strstart===o.block_start?2:(u=o.window_size-o.strstart,o.strm.avail_in>u&&o.block_start>=o.w_size&&(o.block_start-=o.w_size,o.strstart-=o.w_size,o.window.set(o.window.subarray(o.w_size,o.w_size+o.strstart),0),o.matches<2&&o.matches++,u+=o.w_size,o.insert>o.strstart&&(o.insert=o.strstart)),u>o.strm.avail_in&&(u=o.strm.avail_in),u&&(iU(o.strm,o.window,o.strstart,u),o.strstart+=u,o.insert+=u>o.w_size-o.insert?o.w_size-o.insert:u),o.high_water<o.strstart&&(o.high_water=o.strstart),u=o.bi_valid+42>>3,u=o.pending_buf_size-u>65535?65535:o.pending_buf_size-u,h=u>o.w_size?o.w_size:u,a=o.strstart-o.block_start,(a>=h||(a||i===Ec)&&i!==Vh&&o.strm.avail_in===0&&a<=u)&&(s=a>u?u:a,p=i===Ec&&o.strm.avail_in===0&&s===a?1:0,eU(o,o.block_start,s,p),o.block_start+=s,Va(o.strm)),p?3:1)},rU=(o,i)=>{let s,a;for(;;){if(o.lookahead<ru){if(oE(o),o.lookahead<ru&&i===Vh)return 1;if(o.lookahead===0)break}if(s=0,o.lookahead>=3&&(o.ins_h=Wh(o,o.ins_h,o.window[o.strstart+3-1]),s=o.prev[o.strstart&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=o.strstart),s!==0&&o.strstart-s<=o.w_size-ru&&(o.match_length=tH(o,s)),o.match_length>=3)if(a=Fh(o,o.strstart-o.match_start,o.match_length-3),o.lookahead-=o.match_length,o.match_length<=o.max_lazy_match&&o.lookahead>=3){o.match_length--;do o.strstart++,o.ins_h=Wh(o,o.ins_h,o.window[o.strstart+3-1]),s=o.prev[o.strstart&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=o.strstart;while(--o.match_length!=0);o.strstart++}else o.strstart+=o.match_length,o.match_length=0,o.ins_h=o.window[o.strstart],o.ins_h=Wh(o,o.ins_h,o.window[o.strstart+1]);else a=Fh(o,0,o.window[o.strstart]),o.lookahead--,o.strstart++;if(a&&(Ba(o,!1),o.strm.avail_out===0))return 1}return o.insert=o.strstart<2?o.strstart:2,i===Ec?(Ba(o,!0),o.strm.avail_out===0?3:4):o.sym_next&&(Ba(o,!1),o.strm.avail_out===0)?1:2},aE=(o,i)=>{let s,a,u;for(;;){if(o.lookahead<ru){if(oE(o),o.lookahead<ru&&i===Vh)return 1;if(o.lookahead===0)break}if(s=0,o.lookahead>=3&&(o.ins_h=Wh(o,o.ins_h,o.window[o.strstart+3-1]),s=o.prev[o.strstart&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=o.strstart),o.prev_length=o.match_length,o.prev_match=o.match_start,o.match_length=2,s!==0&&o.prev_length<o.max_lazy_match&&o.strstart-s<=o.w_size-ru&&(o.match_length=tH(o,s),o.match_length<=5&&(o.strategy===Zle||o.match_length===3&&o.strstart-o.match_start>4096)&&(o.match_length=2)),o.prev_length>=3&&o.match_length<=o.prev_length){u=o.strstart+o.lookahead-3,a=Fh(o,o.strstart-1-o.prev_match,o.prev_length-3),o.lookahead-=o.prev_length-1,o.prev_length-=2;do++o.strstart<=u&&(o.ins_h=Wh(o,o.ins_h,o.window[o.strstart+3-1]),s=o.prev[o.strstart&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=o.strstart);while(--o.prev_length!=0);if(o.match_available=0,o.match_length=2,o.strstart++,a&&(Ba(o,!1),o.strm.avail_out===0))return 1}else if(o.match_available){if(a=Fh(o,0,o.window[o.strstart-1]),a&&Ba(o,!1),o.strstart++,o.lookahead--,o.strm.avail_out===0)return 1}else o.match_available=1,o.strstart++,o.lookahead--}return o.match_available&&(a=Fh(o,0,o.window[o.strstart-1]),o.match_available=0),o.insert=o.strstart<2?o.strstart:2,i===Ec?(Ba(o,!0),o.strm.avail_out===0?3:4):o.sym_next&&(Ba(o,!1),o.strm.avail_out===0)?1:2};function su(o,i,s,a,u){this.good_length=o,this.max_lazy=i,this.nice_length=s,this.max_chain=a,this.func=u}const aS=[new su(0,0,0,0,nH),new su(4,4,8,4,rU),new su(4,5,16,8,rU),new su(4,6,32,32,rU),new su(4,4,16,16,aE),new su(8,16,32,32,aE),new su(8,16,128,128,aE),new su(8,32,128,256,aE),new su(32,128,258,1024,aE),new su(32,258,258,4096,aE)];function lue(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=jI,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*oue),this.dyn_dtree=new Uint16Array(2*(2*rue+1)),this.bl_tree=new Uint16Array(2*(2*sue+1)),Bh(this.dyn_ltree),Bh(this.dyn_dtree),Bh(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(aue+1),this.heap=new Uint16Array(2*nU+1),Bh(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*nU+1),Bh(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const cS=o=>{if(!o)return 1;const i=o.state;return!i||i.strm!==o||i.status!==sE&&i.status!==57&&i.status!==69&&i.status!==73&&i.status!==91&&i.status!==103&&i.status!==nm&&i.status!==sS?1:0},iH=o=>{if(cS(o))return im(o,iu);o.total_in=o.total_out=0,o.data_type=iue;const i=o.state;return i.pending=0,i.pending_out=0,i.wrap<0&&(i.wrap=-i.wrap),i.status=i.wrap===2?57:i.wrap?sE:nm,o.adler=i.wrap===2?0:1,i.last_flush=-2,Gle(i),Hs},rH=o=>{const i=iH(o);var s;return i===Hs&&((s=o.state).window_size=2*s.w_size,Bh(s.head),s.max_lazy_match=aS[s.level].max_lazy,s.good_match=aS[s.level].good_length,s.nice_match=aS[s.level].nice_length,s.max_chain_length=aS[s.level].max_chain,s.strstart=0,s.block_start=0,s.lookahead=0,s.insert=0,s.match_length=s.prev_length=2,s.match_available=0,s.ins_h=0),i},sH=(o,i,s,a,u,h)=>{if(!o)return iu;let p=1;if(i===Qle&&(i=6),a<0?(p=0,a=-a):a>15&&(p=2,a-=16),u<1||u>9||s!==jI||a<8||a>15||i<0||i>9||h<0||h>tue||a===8&&p!==1)return im(o,iu);a===8&&(a=9);const _=new lue;return o.state=_,_.strm=o,_.status=sE,_.wrap=p,_.gzhead=null,_.w_bits=a,_.w_size=1<<_.w_bits,_.w_mask=_.w_size-1,_.hash_bits=u+7,_.hash_size=1<<_.hash_bits,_.hash_mask=_.hash_size-1,_.hash_shift=~~((_.hash_bits+3-1)/3),_.window=new Uint8Array(2*_.w_size),_.head=new Uint16Array(_.hash_size),_.prev=new Uint16Array(_.w_size),_.lit_bufsize=1<<u+6,_.pending_buf_size=4*_.lit_bufsize,_.pending_buf=new Uint8Array(_.pending_buf_size),_.sym_buf=_.lit_bufsize,_.sym_end=3*(_.lit_bufsize-1),_.level=i,_.strategy=h,_.method=s,rH(o)};var uue=(o,i)=>{if(cS(o)||i>Q7||i<0)return o?im(o,iu):iu;const s=o.state;if(!o.output||o.avail_in!==0&&!o.input||s.status===sS&&i!==Ec)return im(o,o.avail_out===0?tU:iu);const a=s.last_flush;if(s.last_flush=i,s.pending!==0){if(Va(o),o.avail_out===0)return s.last_flush=-1,Hs}else if(o.avail_in===0&&eH(i)<=eH(a)&&i!==Ec)return im(o,tU);if(s.status===sS&&o.avail_in!==0)return im(o,tU);if(s.status===sE&&s.wrap===0&&(s.status=nm),s.status===sE){let u=jI+(s.w_bits-8<<4)<<8,h=-1;if(h=s.strategy>=UI||s.level<2?0:s.level<6?1:s.level===6?2:3,u|=h<<6,s.strstart!==0&&(u|=32),u+=31-u%31,oS(s,u),s.strstart!==0&&(oS(s,o.adler>>>16),oS(s,65535&o.adler)),o.adler=1,s.status=nm,Va(o),s.pending!==0)return s.last_flush=-1,Hs}if(s.status===57){if(o.adler=0,ci(s,31),ci(s,139),ci(s,8),s.gzhead)ci(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),ci(s,255&s.gzhead.time),ci(s,s.gzhead.time>>8&255),ci(s,s.gzhead.time>>16&255),ci(s,s.gzhead.time>>24&255),ci(s,s.level===9?2:s.strategy>=UI||s.level<2?4:0),ci(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(ci(s,255&s.gzhead.extra.length),ci(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(o.adler=Is(o.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=69;else if(ci(s,0),ci(s,0),ci(s,0),ci(s,0),ci(s,0),ci(s,s.level===9?2:s.strategy>=UI||s.level<2?4:0),ci(s,3),s.status=nm,Va(o),s.pending!==0)return s.last_flush=-1,Hs}if(s.status===69){if(s.gzhead.extra){let u=s.pending,h=(65535&s.gzhead.extra.length)-s.gzindex;for(;s.pending+h>s.pending_buf_size;){let _=s.pending_buf_size-s.pending;if(s.pending_buf.set(s.gzhead.extra.subarray(s.gzindex,s.gzindex+_),s.pending),s.pending=s.pending_buf_size,s.gzhead.hcrc&&s.pending>u&&(o.adler=Is(o.adler,s.pending_buf,s.pending-u,u)),s.gzindex+=_,Va(o),s.pending!==0)return s.last_flush=-1,Hs;u=0,h-=_}let p=new Uint8Array(s.gzhead.extra);s.pending_buf.set(p.subarray(s.gzindex,s.gzindex+h),s.pending),s.pending+=h,s.gzhead.hcrc&&s.pending>u&&(o.adler=Is(o.adler,s.pending_buf,s.pending-u,u)),s.gzindex=0}s.status=73}if(s.status===73){if(s.gzhead.name){let u,h=s.pending;do{if(s.pending===s.pending_buf_size){if(s.gzhead.hcrc&&s.pending>h&&(o.adler=Is(o.adler,s.pending_buf,s.pending-h,h)),Va(o),s.pending!==0)return s.last_flush=-1,Hs;h=0}u=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,ci(s,u)}while(u!==0);s.gzhead.hcrc&&s.pending>h&&(o.adler=Is(o.adler,s.pending_buf,s.pending-h,h)),s.gzindex=0}s.status=91}if(s.status===91){if(s.gzhead.comment){let u,h=s.pending;do{if(s.pending===s.pending_buf_size){if(s.gzhead.hcrc&&s.pending>h&&(o.adler=Is(o.adler,s.pending_buf,s.pending-h,h)),Va(o),s.pending!==0)return s.last_flush=-1,Hs;h=0}u=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,ci(s,u)}while(u!==0);s.gzhead.hcrc&&s.pending>h&&(o.adler=Is(o.adler,s.pending_buf,s.pending-h,h))}s.status=103}if(s.status===103){if(s.gzhead.hcrc){if(s.pending+2>s.pending_buf_size&&(Va(o),s.pending!==0))return s.last_flush=-1,Hs;ci(s,255&o.adler),ci(s,o.adler>>8&255),o.adler=0}if(s.status=nm,Va(o),s.pending!==0)return s.last_flush=-1,Hs}if(o.avail_in!==0||s.lookahead!==0||i!==Vh&&s.status!==sS){let u=s.level===0?nH(s,i):s.strategy===UI?((h,p)=>{let _;for(;;){if(h.lookahead===0&&(oE(h),h.lookahead===0)){if(p===Vh)return 1;break}if(h.match_length=0,_=Fh(h,0,h.window[h.strstart]),h.lookahead--,h.strstart++,_&&(Ba(h,!1),h.strm.avail_out===0))return 1}return h.insert=0,p===Ec?(Ba(h,!0),h.strm.avail_out===0?3:4):h.sym_next&&(Ba(h,!1),h.strm.avail_out===0)?1:2})(s,i):s.strategy===eue?((h,p)=>{let _,v,T,b;const C=h.window;for(;;){if(h.lookahead<=tm){if(oE(h),h.lookahead<=tm&&p===Vh)return 1;if(h.lookahead===0)break}if(h.match_length=0,h.lookahead>=3&&h.strstart>0&&(T=h.strstart-1,v=C[T],v===C[++T]&&v===C[++T]&&v===C[++T])){b=h.strstart+tm;do;while(v===C[++T]&&v===C[++T]&&v===C[++T]&&v===C[++T]&&v===C[++T]&&v===C[++T]&&v===C[++T]&&v===C[++T]&&T<b);h.match_length=tm-(b-T),h.match_length>h.lookahead&&(h.match_length=h.lookahead)}if(h.match_length>=3?(_=Fh(h,1,h.match_length-3),h.lookahead-=h.match_length,h.strstart+=h.match_length,h.match_length=0):(_=Fh(h,0,h.window[h.strstart]),h.lookahead--,h.strstart++),_&&(Ba(h,!1),h.strm.avail_out===0))return 1}return h.insert=0,p===Ec?(Ba(h,!0),h.strm.avail_out===0?3:4):h.sym_next&&(Ba(h,!1),h.strm.avail_out===0)?1:2})(s,i):aS[s.level].func(s,i);if(u!==3&&u!==4||(s.status=sS),u===1||u===3)return o.avail_out===0&&(s.last_flush=-1),Hs;if(u===2&&(i===Yle?qle(s):i!==Q7&&(eU(s,0,0,!1),i===Xle&&(Bh(s.head),s.lookahead===0&&(s.strstart=0,s.block_start=0,s.insert=0))),Va(o),o.avail_out===0))return s.last_flush=-1,Hs}return i!==Ec?Hs:s.wrap<=0?Z7:(s.wrap===2?(ci(s,255&o.adler),ci(s,o.adler>>8&255),ci(s,o.adler>>16&255),ci(s,o.adler>>24&255),ci(s,255&o.total_in),ci(s,o.total_in>>8&255),ci(s,o.total_in>>16&255),ci(s,o.total_in>>24&255)):(oS(s,o.adler>>>16),oS(s,65535&o.adler)),Va(o),s.wrap>0&&(s.wrap=-s.wrap),s.pending!==0?Hs:Z7)},due=(o,i)=>{let s=i.length;if(cS(o))return iu;const a=o.state,u=a.wrap;if(u===2||u===1&&a.status!==sE||a.lookahead)return iu;if(u===1&&(o.adler=rS(o.adler,i,s,0)),a.wrap=0,s>=a.w_size){u===0&&(Bh(a.head),a.strstart=0,a.block_start=0,a.insert=0);let v=new Uint8Array(a.w_size);v.set(i.subarray(s-a.w_size,s),0),i=v,s=a.w_size}const h=o.avail_in,p=o.next_in,_=o.input;for(o.avail_in=s,o.next_in=0,o.input=i,oE(a);a.lookahead>=3;){let v=a.strstart,T=a.lookahead-2;do a.ins_h=Wh(a,a.ins_h,a.window[v+3-1]),a.prev[v&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=v,v++;while(--T);a.strstart=v,a.lookahead=2,oE(a)}return a.strstart+=a.lookahead,a.block_start=a.strstart,a.insert=a.lookahead,a.lookahead=0,a.match_length=a.prev_length=2,a.match_available=0,o.next_in=p,o.input=_,o.avail_in=h,a.wrap=u,Hs},lS={deflateInit:(o,i)=>sH(o,i,jI,15,8,nue),deflateInit2:sH,deflateReset:rH,deflateResetKeep:iH,deflateSetHeader:(o,i)=>cS(o)||o.state.wrap!==2?iu:(o.state.gzhead=i,Hs),deflate:uue,deflateEnd:o=>{if(cS(o))return iu;const i=o.state.status;return o.state=null,i===nm?im(o,Jle):Hs},deflateSetDictionary:due,deflateInfo:"pako deflate (from Nodeca project)"};const hue=(o,i)=>Object.prototype.hasOwnProperty.call(o,i);var FI={assign:function(o){const i=Array.prototype.slice.call(arguments,1);for(;i.length;){const s=i.shift();if(s){if(typeof s!="object")throw new TypeError(s+"must be non-object");for(const a in s)hue(s,a)&&(o[a]=s[a])}}return o},flattenChunks:o=>{let i=0;for(let a=0,u=o.length;a<u;a++)i+=o[a].length;const s=new Uint8Array(i);for(let a=0,u=0,h=o.length;a<h;a++){let p=o[a];s.set(p,u),u+=p.length}return s}};let oH=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{oH=!1}const uS=new Uint8Array(256);for(let o=0;o<256;o++)uS[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;uS[254]=uS[254]=1;var dS={string2buf:o=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(o);let i,s,a,u,h,p=o.length,_=0;for(u=0;u<p;u++)s=o.charCodeAt(u),(64512&s)==55296&&u+1<p&&(a=o.charCodeAt(u+1),(64512&a)==56320&&(s=65536+(s-55296<<10)+(a-56320),u++)),_+=s<128?1:s<2048?2:s<65536?3:4;for(i=new Uint8Array(_),h=0,u=0;h<_;u++)s=o.charCodeAt(u),(64512&s)==55296&&u+1<p&&(a=o.charCodeAt(u+1),(64512&a)==56320&&(s=65536+(s-55296<<10)+(a-56320),u++)),s<128?i[h++]=s:s<2048?(i[h++]=192|s>>>6,i[h++]=128|63&s):s<65536?(i[h++]=224|s>>>12,i[h++]=128|s>>>6&63,i[h++]=128|63&s):(i[h++]=240|s>>>18,i[h++]=128|s>>>12&63,i[h++]=128|s>>>6&63,i[h++]=128|63&s);return i},buf2string:(o,i)=>{const s=i||o.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(o.subarray(0,i));let a,u;const h=new Array(2*s);for(u=0,a=0;a<s;){let p=o[a++];if(p<128){h[u++]=p;continue}let _=uS[p];if(_>4)h[u++]=65533,a+=_-1;else{for(p&=_===2?31:_===3?15:7;_>1&&a<s;)p=p<<6|63&o[a++],_--;_>1?h[u++]=65533:p<65536?h[u++]=p:(p-=65536,h[u++]=55296|p>>10&1023,h[u++]=56320|1023&p)}}return((p,_)=>{if(_<65534&&p.subarray&&oH)return String.fromCharCode.apply(null,p.length===_?p:p.subarray(0,_));let v="";for(let T=0;T<_;T++)v+=String.fromCharCode(p[T]);return v})(h,u)},utf8border:(o,i)=>{(i=i||o.length)>o.length&&(i=o.length);let s=i-1;for(;s>=0&&(192&o[s])==128;)s--;return s<0||s===0?i:s+uS[o[s]]>i?s:i}},aH=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const cH=Object.prototype.toString,{Z_NO_FLUSH:fue,Z_SYNC_FLUSH:pue,Z_FULL_FLUSH:mue,Z_FINISH:gue,Z_OK:VI,Z_STREAM_END:_ue,Z_DEFAULT_COMPRESSION:Eue,Z_DEFAULT_STRATEGY:vue,Z_DEFLATED:yue}=rE;function hS(o){this.options=FI.assign({level:Eue,method:yue,chunkSize:16384,windowBits:15,memLevel:8,strategy:vue},o||{});let i=this.options;i.raw&&i.windowBits>0?i.windowBits=-i.windowBits:i.gzip&&i.windowBits>0&&i.windowBits<16&&(i.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new aH,this.strm.avail_out=0;let s=lS.deflateInit2(this.strm,i.level,i.method,i.windowBits,i.memLevel,i.strategy);if(s!==VI)throw new Error(em[s]);if(i.header&&lS.deflateSetHeader(this.strm,i.header),i.dictionary){let a;if(a=typeof i.dictionary=="string"?dS.string2buf(i.dictionary):cH.call(i.dictionary)==="[object ArrayBuffer]"?new Uint8Array(i.dictionary):i.dictionary,s=lS.deflateSetDictionary(this.strm,a),s!==VI)throw new Error(em[s]);this._dict_set=!0}}function sU(o,i){const s=new hS(i);if(s.push(o,!0),s.err)throw s.msg||em[s.err];return s.result}hS.prototype.push=function(o,i){const s=this.strm,a=this.options.chunkSize;let u,h;if(this.ended)return!1;for(h=i===~~i?i:i===!0?gue:fue,typeof o=="string"?s.input=dS.string2buf(o):cH.call(o)==="[object ArrayBuffer]"?s.input=new Uint8Array(o):s.input=o,s.next_in=0,s.avail_in=s.input.length;;)if(s.avail_out===0&&(s.output=new Uint8Array(a),s.next_out=0,s.avail_out=a),(h===pue||h===mue)&&s.avail_out<=6)this.onData(s.output.subarray(0,s.next_out)),s.avail_out=0;else{if(u=lS.deflate(s,h),u===_ue)return s.next_out>0&&this.onData(s.output.subarray(0,s.next_out)),u=lS.deflateEnd(this.strm),this.onEnd(u),this.ended=!0,u===VI;if(s.avail_out!==0){if(h>0&&s.next_out>0)this.onData(s.output.subarray(0,s.next_out)),s.avail_out=0;else if(s.avail_in===0)break}else this.onData(s.output)}return!0},hS.prototype.onData=function(o){this.chunks.push(o)},hS.prototype.onEnd=function(o){o===VI&&(this.result=FI.flattenChunks(this.chunks)),this.chunks=[],this.err=o,this.msg=this.strm.msg};var Sue={Deflate:hS,deflate:sU,deflateRaw:function(o,i){return(i=i||{}).raw=!0,sU(o,i)},gzip:function(o,i){return(i=i||{}).gzip=!0,sU(o,i)},constants:rE};const BI=16209;var Tue=function(o,i){let s,a,u,h,p,_,v,T,b,C,N,x,B,F,H,J,ee,se,ye,me,ue,he,pe,Ve;const Me=o.state;s=o.next_in,pe=o.input,a=s+(o.avail_in-5),u=o.next_out,Ve=o.output,h=u-(i-o.avail_out),p=u+(o.avail_out-257),_=Me.dmax,v=Me.wsize,T=Me.whave,b=Me.wnext,C=Me.window,N=Me.hold,x=Me.bits,B=Me.lencode,F=Me.distcode,H=(1<<Me.lenbits)-1,J=(1<<Me.distbits)-1;e:do{x<15&&(N+=pe[s++]<<x,x+=8,N+=pe[s++]<<x,x+=8),ee=B[N&H];t:for(;;){if(se=ee>>>24,N>>>=se,x-=se,se=ee>>>16&255,se===0)Ve[u++]=65535&ee;else{if(!(16&se)){if(!(64&se)){ee=B[(65535&ee)+(N&(1<<se)-1)];continue t}if(32&se){Me.mode=16191;break e}o.msg="invalid literal/length code",Me.mode=BI;break e}ye=65535&ee,se&=15,se&&(x<se&&(N+=pe[s++]<<x,x+=8),ye+=N&(1<<se)-1,N>>>=se,x-=se),x<15&&(N+=pe[s++]<<x,x+=8,N+=pe[s++]<<x,x+=8),ee=F[N&J];n:for(;;){if(se=ee>>>24,N>>>=se,x-=se,se=ee>>>16&255,!(16&se)){if(!(64&se)){ee=F[(65535&ee)+(N&(1<<se)-1)];continue n}o.msg="invalid distance code",Me.mode=BI;break e}if(me=65535&ee,se&=15,x<se&&(N+=pe[s++]<<x,x+=8,x<se&&(N+=pe[s++]<<x,x+=8)),me+=N&(1<<se)-1,me>_){o.msg="invalid distance too far back",Me.mode=BI;break e}if(N>>>=se,x-=se,se=u-h,me>se){if(se=me-se,se>T&&Me.sane){o.msg="invalid distance too far back",Me.mode=BI;break e}if(ue=0,he=C,b===0){if(ue+=v-se,se<ye){ye-=se;do Ve[u++]=C[ue++];while(--se);ue=u-me,he=Ve}}else if(b<se){if(ue+=v+b-se,se-=b,se<ye){ye-=se;do Ve[u++]=C[ue++];while(--se);if(ue=0,b<ye){se=b,ye-=se;do Ve[u++]=C[ue++];while(--se);ue=u-me,he=Ve}}}else if(ue+=b-se,se<ye){ye-=se;do Ve[u++]=C[ue++];while(--se);ue=u-me,he=Ve}for(;ye>2;)Ve[u++]=he[ue++],Ve[u++]=he[ue++],Ve[u++]=he[ue++],ye-=3;ye&&(Ve[u++]=he[ue++],ye>1&&(Ve[u++]=he[ue++]))}else{ue=u-me;do Ve[u++]=Ve[ue++],Ve[u++]=Ve[ue++],Ve[u++]=Ve[ue++],ye-=3;while(ye>2);ye&&(Ve[u++]=Ve[ue++],ye>1&&(Ve[u++]=Ve[ue++]))}break}}break}}while(s<a&&u<p);ye=x>>3,s-=ye,x-=ye<<3,N&=(1<<x)-1,o.next_in=s,o.next_out=u,o.avail_in=s<a?a-s+5:5-(s-a),o.avail_out=u<p?p-u+257:257-(u-p),Me.hold=N,Me.bits=x};const WI=15,bue=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),wue=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Cue=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Rue=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var fS=(o,i,s,a,u,h,p,_)=>{const v=_.bits;let T,b,C,N,x,B,F=0,H=0,J=0,ee=0,se=0,ye=0,me=0,ue=0,he=0,pe=0,Ve=null;const Me=new Uint16Array(16),wt=new Uint16Array(16);let zt,si,ji,Fn=null;for(F=0;F<=WI;F++)Me[F]=0;for(H=0;H<a;H++)Me[i[s+H]]++;for(se=v,ee=WI;ee>=1&&Me[ee]===0;ee--);if(se>ee&&(se=ee),ee===0)return u[h++]=20971520,u[h++]=20971520,_.bits=1,0;for(J=1;J<ee&&Me[J]===0;J++);for(se<J&&(se=J),ue=1,F=1;F<=WI;F++)if(ue<<=1,ue-=Me[F],ue<0)return-1;if(ue>0&&(o===0||ee!==1))return-1;for(wt[1]=0,F=1;F<WI;F++)wt[F+1]=wt[F]+Me[F];for(H=0;H<a;H++)i[s+H]!==0&&(p[wt[i[s+H]]++]=H);if(o===0?(Ve=Fn=p,B=20):o===1?(Ve=bue,Fn=wue,B=257):(Ve=Cue,Fn=Rue,B=0),pe=0,H=0,F=J,x=h,ye=se,me=0,C=-1,he=1<<se,N=he-1,o===1&&he>852||o===2&&he>592)return 1;for(;;){zt=F-me,p[H]+1<B?(si=0,ji=p[H]):p[H]>=B?(si=Fn[p[H]-B],ji=Ve[p[H]-B]):(si=96,ji=0),T=1<<F-me,b=1<<ye,J=b;do b-=T,u[x+(pe>>me)+b]=zt<<24|si<<16|ji|0;while(b!==0);for(T=1<<F-1;pe&T;)T>>=1;if(T!==0?(pe&=T-1,pe+=T):pe=0,H++,--Me[F]==0){if(F===ee)break;F=i[s+p[H]]}if(F>se&&(pe&N)!==C){for(me===0&&(me=se),x+=J,ye=F-me,ue=1<<ye;ye+me<ee&&(ue-=Me[ye+me],!(ue<=0));)ye++,ue<<=1;if(he+=1<<ye,o===1&&he>852||o===2&&he>592)return 1;C=pe&N,u[C]=se<<24|ye<<16|x-h|0}}return pe!==0&&(u[x+pe]=F-me<<24|64<<16|0),_.bits=se,0};const{Z_FINISH:lH,Z_BLOCK:Iue,Z_TREES:HI,Z_OK:rm,Z_STREAM_END:Aue,Z_NEED_DICT:Oue,Z_STREAM_ERROR:vc,Z_DATA_ERROR:uH,Z_MEM_ERROR:dH,Z_BUF_ERROR:Nue,Z_DEFLATED:hH}=rE,$I=16180,zI=16190,dd=16191,oU=16192,aU=16194,GI=16199,KI=16200,cU=16206,gr=16209,fH=o=>(o>>>24&255)+(o>>>8&65280)+((65280&o)<<8)+((255&o)<<24);function Pue(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const sm=o=>{if(!o)return 1;const i=o.state;return!i||i.strm!==o||i.mode<$I||i.mode>16211?1:0},pH=o=>{if(sm(o))return vc;const i=o.state;return o.total_in=o.total_out=i.total=0,o.msg="",i.wrap&&(o.adler=1&i.wrap),i.mode=$I,i.last=0,i.havedict=0,i.flags=-1,i.dmax=32768,i.head=null,i.hold=0,i.bits=0,i.lencode=i.lendyn=new Int32Array(852),i.distcode=i.distdyn=new Int32Array(592),i.sane=1,i.back=-1,rm},mH=o=>{if(sm(o))return vc;const i=o.state;return i.wsize=0,i.whave=0,i.wnext=0,pH(o)},gH=(o,i)=>{let s;if(sm(o))return vc;const a=o.state;return i<0?(s=0,i=-i):(s=5+(i>>4),i<48&&(i&=15)),i&&(i<8||i>15)?vc:(a.window!==null&&a.wbits!==i&&(a.window=null),a.wrap=s,a.wbits=i,mH(o))},_H=(o,i)=>{if(!o)return vc;const s=new Pue;o.state=s,s.strm=o,s.window=null,s.mode=$I;const a=gH(o,i);return a!==rm&&(o.state=null),a};let lU,uU,EH=!0;const xue=o=>{if(EH){lU=new Int32Array(512),uU=new Int32Array(32);let i=0;for(;i<144;)o.lens[i++]=8;for(;i<256;)o.lens[i++]=9;for(;i<280;)o.lens[i++]=7;for(;i<288;)o.lens[i++]=8;for(fS(1,o.lens,0,288,lU,0,o.work,{bits:9}),i=0;i<32;)o.lens[i++]=5;fS(2,o.lens,0,32,uU,0,o.work,{bits:5}),EH=!1}o.lencode=lU,o.lenbits=9,o.distcode=uU,o.distbits=5},vH=(o,i,s,a)=>{let u;const h=o.state;return h.window===null&&(h.wsize=1<<h.wbits,h.wnext=0,h.whave=0,h.window=new Uint8Array(h.wsize)),a>=h.wsize?(h.window.set(i.subarray(s-h.wsize,s),0),h.wnext=0,h.whave=h.wsize):(u=h.wsize-h.wnext,u>a&&(u=a),h.window.set(i.subarray(s-a,s-a+u),h.wnext),(a-=u)?(h.window.set(i.subarray(s-a,s),0),h.wnext=a,h.whave=h.wsize):(h.wnext+=u,h.wnext===h.wsize&&(h.wnext=0),h.whave<h.wsize&&(h.whave+=u))),0};var Due=(o,i)=>{let s,a,u,h,p,_,v,T,b,C,N,x,B,F,H,J,ee,se,ye,me,ue,he,pe=0;const Ve=new Uint8Array(4);let Me,wt;const zt=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(sm(o)||!o.output||!o.input&&o.avail_in!==0)return vc;s=o.state,s.mode===dd&&(s.mode=oU),p=o.next_out,u=o.output,v=o.avail_out,h=o.next_in,a=o.input,_=o.avail_in,T=s.hold,b=s.bits,C=_,N=v,he=rm;e:for(;;)switch(s.mode){case $I:if(s.wrap===0){s.mode=oU;break}for(;b<16;){if(_===0)break e;_--,T+=a[h++]<<b,b+=8}if(2&s.wrap&&T===35615){s.wbits===0&&(s.wbits=15),s.check=0,Ve[0]=255&T,Ve[1]=T>>>8&255,s.check=Is(s.check,Ve,2,0),T=0,b=0,s.mode=16181;break}if(s.head&&(s.head.done=!1),!(1&s.wrap)||(((255&T)<<8)+(T>>8))%31){o.msg="incorrect header check",s.mode=gr;break}if((15&T)!==hH){o.msg="unknown compression method",s.mode=gr;break}if(T>>>=4,b-=4,ue=8+(15&T),s.wbits===0&&(s.wbits=ue),ue>15||ue>s.wbits){o.msg="invalid window size",s.mode=gr;break}s.dmax=1<<s.wbits,s.flags=0,o.adler=s.check=1,s.mode=512&T?16189:dd,T=0,b=0;break;case 16181:for(;b<16;){if(_===0)break e;_--,T+=a[h++]<<b,b+=8}if(s.flags=T,(255&s.flags)!==hH){o.msg="unknown compression method",s.mode=gr;break}if(57344&s.flags){o.msg="unknown header flags set",s.mode=gr;break}s.head&&(s.head.text=T>>8&1),512&s.flags&&4&s.wrap&&(Ve[0]=255&T,Ve[1]=T>>>8&255,s.check=Is(s.check,Ve,2,0)),T=0,b=0,s.mode=16182;case 16182:for(;b<32;){if(_===0)break e;_--,T+=a[h++]<<b,b+=8}s.head&&(s.head.time=T),512&s.flags&&4&s.wrap&&(Ve[0]=255&T,Ve[1]=T>>>8&255,Ve[2]=T>>>16&255,Ve[3]=T>>>24&255,s.check=Is(s.check,Ve,4,0)),T=0,b=0,s.mode=16183;case 16183:for(;b<16;){if(_===0)break e;_--,T+=a[h++]<<b,b+=8}s.head&&(s.head.xflags=255&T,s.head.os=T>>8),512&s.flags&&4&s.wrap&&(Ve[0]=255&T,Ve[1]=T>>>8&255,s.check=Is(s.check,Ve,2,0)),T=0,b=0,s.mode=16184;case 16184:if(1024&s.flags){for(;b<16;){if(_===0)break e;_--,T+=a[h++]<<b,b+=8}s.length=T,s.head&&(s.head.extra_len=T),512&s.flags&&4&s.wrap&&(Ve[0]=255&T,Ve[1]=T>>>8&255,s.check=Is(s.check,Ve,2,0)),T=0,b=0}else s.head&&(s.head.extra=null);s.mode=16185;case 16185:if(1024&s.flags&&(x=s.length,x>_&&(x=_),x&&(s.head&&(ue=s.head.extra_len-s.length,s.head.extra||(s.head.extra=new Uint8Array(s.head.extra_len)),s.head.extra.set(a.subarray(h,h+x),ue)),512&s.flags&&4&s.wrap&&(s.check=Is(s.check,a,x,h)),_-=x,h+=x,s.length-=x),s.length))break e;s.length=0,s.mode=16186;case 16186:if(2048&s.flags){if(_===0)break e;x=0;do ue=a[h+x++],s.head&&ue&&s.length<65536&&(s.head.name+=String.fromCharCode(ue));while(ue&&x<_);if(512&s.flags&&4&s.wrap&&(s.check=Is(s.check,a,x,h)),_-=x,h+=x,ue)break e}else s.head&&(s.head.name=null);s.length=0,s.mode=16187;case 16187:if(4096&s.flags){if(_===0)break e;x=0;do ue=a[h+x++],s.head&&ue&&s.length<65536&&(s.head.comment+=String.fromCharCode(ue));while(ue&&x<_);if(512&s.flags&&4&s.wrap&&(s.check=Is(s.check,a,x,h)),_-=x,h+=x,ue)break e}else s.head&&(s.head.comment=null);s.mode=16188;case 16188:if(512&s.flags){for(;b<16;){if(_===0)break e;_--,T+=a[h++]<<b,b+=8}if(4&s.wrap&&T!==(65535&s.check)){o.msg="header crc mismatch",s.mode=gr;break}T=0,b=0}s.head&&(s.head.hcrc=s.flags>>9&1,s.head.done=!0),o.adler=s.check=0,s.mode=dd;break;case 16189:for(;b<32;){if(_===0)break e;_--,T+=a[h++]<<b,b+=8}o.adler=s.check=fH(T),T=0,b=0,s.mode=zI;case zI:if(s.havedict===0)return o.next_out=p,o.avail_out=v,o.next_in=h,o.avail_in=_,s.hold=T,s.bits=b,Oue;o.adler=s.check=1,s.mode=dd;case dd:if(i===Iue||i===HI)break e;case oU:if(s.last){T>>>=7&b,b-=7&b,s.mode=cU;break}for(;b<3;){if(_===0)break e;_--,T+=a[h++]<<b,b+=8}switch(s.last=1&T,T>>>=1,b-=1,3&T){case 0:s.mode=16193;break;case 1:if(xue(s),s.mode=GI,i===HI){T>>>=2,b-=2;break e}break;case 2:s.mode=16196;break;case 3:o.msg="invalid block type",s.mode=gr}T>>>=2,b-=2;break;case 16193:for(T>>>=7&b,b-=7&b;b<32;){if(_===0)break e;_--,T+=a[h++]<<b,b+=8}if((65535&T)!=(T>>>16^65535)){o.msg="invalid stored block lengths",s.mode=gr;break}if(s.length=65535&T,T=0,b=0,s.mode=aU,i===HI)break e;case aU:s.mode=16195;case 16195:if(x=s.length,x){if(x>_&&(x=_),x>v&&(x=v),x===0)break e;u.set(a.subarray(h,h+x),p),_-=x,h+=x,v-=x,p+=x,s.length-=x;break}s.mode=dd;break;case 16196:for(;b<14;){if(_===0)break e;_--,T+=a[h++]<<b,b+=8}if(s.nlen=257+(31&T),T>>>=5,b-=5,s.ndist=1+(31&T),T>>>=5,b-=5,s.ncode=4+(15&T),T>>>=4,b-=4,s.nlen>286||s.ndist>30){o.msg="too many length or distance symbols",s.mode=gr;break}s.have=0,s.mode=16197;case 16197:for(;s.have<s.ncode;){for(;b<3;){if(_===0)break e;_--,T+=a[h++]<<b,b+=8}s.lens[zt[s.have++]]=7&T,T>>>=3,b-=3}for(;s.have<19;)s.lens[zt[s.have++]]=0;if(s.lencode=s.lendyn,s.lenbits=7,Me={bits:s.lenbits},he=fS(0,s.lens,0,19,s.lencode,0,s.work,Me),s.lenbits=Me.bits,he){o.msg="invalid code lengths set",s.mode=gr;break}s.have=0,s.mode=16198;case 16198:for(;s.have<s.nlen+s.ndist;){for(;pe=s.lencode[T&(1<<s.lenbits)-1],H=pe>>>24,J=pe>>>16&255,ee=65535&pe,!(H<=b);){if(_===0)break e;_--,T+=a[h++]<<b,b+=8}if(ee<16)T>>>=H,b-=H,s.lens[s.have++]=ee;else{if(ee===16){for(wt=H+2;b<wt;){if(_===0)break e;_--,T+=a[h++]<<b,b+=8}if(T>>>=H,b-=H,s.have===0){o.msg="invalid bit length repeat",s.mode=gr;break}ue=s.lens[s.have-1],x=3+(3&T),T>>>=2,b-=2}else if(ee===17){for(wt=H+3;b<wt;){if(_===0)break e;_--,T+=a[h++]<<b,b+=8}T>>>=H,b-=H,ue=0,x=3+(7&T),T>>>=3,b-=3}else{for(wt=H+7;b<wt;){if(_===0)break e;_--,T+=a[h++]<<b,b+=8}T>>>=H,b-=H,ue=0,x=11+(127&T),T>>>=7,b-=7}if(s.have+x>s.nlen+s.ndist){o.msg="invalid bit length repeat",s.mode=gr;break}for(;x--;)s.lens[s.have++]=ue}}if(s.mode===gr)break;if(s.lens[256]===0){o.msg="invalid code -- missing end-of-block",s.mode=gr;break}if(s.lenbits=9,Me={bits:s.lenbits},he=fS(1,s.lens,0,s.nlen,s.lencode,0,s.work,Me),s.lenbits=Me.bits,he){o.msg="invalid literal/lengths set",s.mode=gr;break}if(s.distbits=6,s.distcode=s.distdyn,Me={bits:s.distbits},he=fS(2,s.lens,s.nlen,s.ndist,s.distcode,0,s.work,Me),s.distbits=Me.bits,he){o.msg="invalid distances set",s.mode=gr;break}if(s.mode=GI,i===HI)break e;case GI:s.mode=KI;case KI:if(_>=6&&v>=258){o.next_out=p,o.avail_out=v,o.next_in=h,o.avail_in=_,s.hold=T,s.bits=b,Tue(o,N),p=o.next_out,u=o.output,v=o.avail_out,h=o.next_in,a=o.input,_=o.avail_in,T=s.hold,b=s.bits,s.mode===dd&&(s.back=-1);break}for(s.back=0;pe=s.lencode[T&(1<<s.lenbits)-1],H=pe>>>24,J=pe>>>16&255,ee=65535&pe,!(H<=b);){if(_===0)break e;_--,T+=a[h++]<<b,b+=8}if(J&&!(240&J)){for(se=H,ye=J,me=ee;pe=s.lencode[me+((T&(1<<se+ye)-1)>>se)],H=pe>>>24,J=pe>>>16&255,ee=65535&pe,!(se+H<=b);){if(_===0)break e;_--,T+=a[h++]<<b,b+=8}T>>>=se,b-=se,s.back+=se}if(T>>>=H,b-=H,s.back+=H,s.length=ee,J===0){s.mode=16205;break}if(32&J){s.back=-1,s.mode=dd;break}if(64&J){o.msg="invalid literal/length code",s.mode=gr;break}s.extra=15&J,s.mode=16201;case 16201:if(s.extra){for(wt=s.extra;b<wt;){if(_===0)break e;_--,T+=a[h++]<<b,b+=8}s.length+=T&(1<<s.extra)-1,T>>>=s.extra,b-=s.extra,s.back+=s.extra}s.was=s.length,s.mode=16202;case 16202:for(;pe=s.distcode[T&(1<<s.distbits)-1],H=pe>>>24,J=pe>>>16&255,ee=65535&pe,!(H<=b);){if(_===0)break e;_--,T+=a[h++]<<b,b+=8}if(!(240&J)){for(se=H,ye=J,me=ee;pe=s.distcode[me+((T&(1<<se+ye)-1)>>se)],H=pe>>>24,J=pe>>>16&255,ee=65535&pe,!(se+H<=b);){if(_===0)break e;_--,T+=a[h++]<<b,b+=8}T>>>=se,b-=se,s.back+=se}if(T>>>=H,b-=H,s.back+=H,64&J){o.msg="invalid distance code",s.mode=gr;break}s.offset=ee,s.extra=15&J,s.mode=16203;case 16203:if(s.extra){for(wt=s.extra;b<wt;){if(_===0)break e;_--,T+=a[h++]<<b,b+=8}s.offset+=T&(1<<s.extra)-1,T>>>=s.extra,b-=s.extra,s.back+=s.extra}if(s.offset>s.dmax){o.msg="invalid distance too far back",s.mode=gr;break}s.mode=16204;case 16204:if(v===0)break e;if(x=N-v,s.offset>x){if(x=s.offset-x,x>s.whave&&s.sane){o.msg="invalid distance too far back",s.mode=gr;break}x>s.wnext?(x-=s.wnext,B=s.wsize-x):B=s.wnext-x,x>s.length&&(x=s.length),F=s.window}else F=u,B=p-s.offset,x=s.length;x>v&&(x=v),v-=x,s.length-=x;do u[p++]=F[B++];while(--x);s.length===0&&(s.mode=KI);break;case 16205:if(v===0)break e;u[p++]=s.length,v--,s.mode=KI;break;case cU:if(s.wrap){for(;b<32;){if(_===0)break e;_--,T|=a[h++]<<b,b+=8}if(N-=v,o.total_out+=N,s.total+=N,4&s.wrap&&N&&(o.adler=s.check=s.flags?Is(s.check,u,N,p-N):rS(s.check,u,N,p-N)),N=v,4&s.wrap&&(s.flags?T:fH(T))!==s.check){o.msg="incorrect data check",s.mode=gr;break}T=0,b=0}s.mode=16207;case 16207:if(s.wrap&&s.flags){for(;b<32;){if(_===0)break e;_--,T+=a[h++]<<b,b+=8}if(4&s.wrap&&T!==(4294967295&s.total)){o.msg="incorrect length check",s.mode=gr;break}T=0,b=0}s.mode=16208;case 16208:he=Aue;break e;case gr:he=uH;break e;case 16210:return dH;default:return vc}return o.next_out=p,o.avail_out=v,o.next_in=h,o.avail_in=_,s.hold=T,s.bits=b,(s.wsize||N!==o.avail_out&&s.mode<gr&&(s.mode<cU||i!==lH))&&vH(o,o.output,o.next_out,N-o.avail_out),C-=o.avail_in,N-=o.avail_out,o.total_in+=C,o.total_out+=N,s.total+=N,4&s.wrap&&N&&(o.adler=s.check=s.flags?Is(s.check,u,N,o.next_out-N):rS(s.check,u,N,o.next_out-N)),o.data_type=s.bits+(s.last?64:0)+(s.mode===dd?128:0)+(s.mode===GI||s.mode===aU?256:0),(C===0&&N===0||i===lH)&&he===rm&&(he=Nue),he},hd={inflateReset:mH,inflateReset2:gH,inflateResetKeep:pH,inflateInit:o=>_H(o,15),inflateInit2:_H,inflate:Due,inflateEnd:o=>{if(sm(o))return vc;let i=o.state;return i.window&&(i.window=null),o.state=null,rm},inflateGetHeader:(o,i)=>{if(sm(o))return vc;const s=o.state;return 2&s.wrap?(s.head=i,i.done=!1,rm):vc},inflateSetDictionary:(o,i)=>{const s=i.length;let a,u,h;return sm(o)?vc:(a=o.state,a.wrap!==0&&a.mode!==zI?vc:a.mode===zI&&(u=1,u=rS(u,i,s,0),u!==a.check)?uH:(h=vH(o,i,s,s),h?(a.mode=16210,dH):(a.havedict=1,rm)))},inflateInfo:"pako inflate (from Nodeca project)"},kue=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const yH=Object.prototype.toString,{Z_NO_FLUSH:Lue,Z_FINISH:Mue,Z_OK:pS,Z_STREAM_END:dU,Z_NEED_DICT:hU,Z_STREAM_ERROR:Uue,Z_DATA_ERROR:SH,Z_MEM_ERROR:jue}=rE;function mS(o){this.options=FI.assign({chunkSize:65536,windowBits:15,to:""},o||{});const i=this.options;i.raw&&i.windowBits>=0&&i.windowBits<16&&(i.windowBits=-i.windowBits,i.windowBits===0&&(i.windowBits=-15)),!(i.windowBits>=0&&i.windowBits<16)||o&&o.windowBits||(i.windowBits+=32),i.windowBits>15&&i.windowBits<48&&!(15&i.windowBits)&&(i.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new aH,this.strm.avail_out=0;let s=hd.inflateInit2(this.strm,i.windowBits);if(s!==pS)throw new Error(em[s]);if(this.header=new kue,hd.inflateGetHeader(this.strm,this.header),i.dictionary&&(typeof i.dictionary=="string"?i.dictionary=dS.string2buf(i.dictionary):yH.call(i.dictionary)==="[object ArrayBuffer]"&&(i.dictionary=new Uint8Array(i.dictionary)),i.raw&&(s=hd.inflateSetDictionary(this.strm,i.dictionary),s!==pS)))throw new Error(em[s])}function fU(o,i){const s=new mS(i);if(s.push(o),s.err)throw s.msg||em[s.err];return s.result}mS.prototype.push=function(o,i){const s=this.strm,a=this.options.chunkSize,u=this.options.dictionary;let h,p,_;if(this.ended)return!1;for(p=i===~~i?i:i===!0?Mue:Lue,yH.call(o)==="[object ArrayBuffer]"?s.input=new Uint8Array(o):s.input=o,s.next_in=0,s.avail_in=s.input.length;;){for(s.avail_out===0&&(s.output=new Uint8Array(a),s.next_out=0,s.avail_out=a),h=hd.inflate(s,p),h===hU&&u&&(h=hd.inflateSetDictionary(s,u),h===pS?h=hd.inflate(s,p):h===SH&&(h=hU));s.avail_in>0&&h===dU&&s.state.wrap>0&&o[s.next_in]!==0;)hd.inflateReset(s),h=hd.inflate(s,p);switch(h){case Uue:case SH:case hU:case jue:return this.onEnd(h),this.ended=!0,!1}if(_=s.avail_out,s.next_out&&(s.avail_out===0||h===dU))if(this.options.to==="string"){let v=dS.utf8border(s.output,s.next_out),T=s.next_out-v,b=dS.buf2string(s.output,v);s.next_out=T,s.avail_out=a-T,T&&s.output.set(s.output.subarray(v,v+T),0),this.onData(b)}else this.onData(s.output.length===s.next_out?s.output:s.output.subarray(0,s.next_out));if(h!==pS||_!==0){if(h===dU)return h=hd.inflateEnd(this.strm),this.onEnd(h),this.ended=!0,!0;if(s.avail_in===0)break}}return!0},mS.prototype.onData=function(o){this.chunks.push(o)},mS.prototype.onEnd=function(o){o===pS&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=FI.flattenChunks(this.chunks)),this.chunks=[],this.err=o,this.msg=this.strm.msg};var Fue={Inflate:mS,inflate:fU,inflateRaw:function(o,i){return(i=i||{}).raw=!0,fU(o,i)},ungzip:fU,constants:rE};const{Deflate:_Be,deflate:Vue,deflateRaw:EBe,gzip:vBe}=Sue,{Inflate:yBe,inflate:Bue,inflateRaw:SBe,ungzip:TBe}=Fue;var pU,Wue=Vue,Hue=Bue;(function(o){o[o.ONE_BYTE=0]="ONE_BYTE",o[o.TWO_BYTE=1]="TWO_BYTE"})(pU||(pU={}));class $ue{constructor(){O(this,"_sequence",0),O(this,"_startTime",Date.now()),O(this,"isUseOneByte",!0)}get startTime(){const i=Date.now()-this._startTime;return i<Math.pow(2,16)?i:(this._startTime+=Math.pow(2,16),this.startTime)}get sequence(){return this._sequence<Math.pow(2,32)?this._sequence++:(this._sequence-=Math.pow(2,32),this.sequence)}serialize(i){const s={commonPacketHeader:{length:0,reserved:0,extension:0,sequence:this.sequence},commonStreamHeader:this.startTime,extension:void 0,payload:i};if(i.byteLength>128){const _=new Uint8Array(4);_.set([1,0,0,0]);const v={id:0,length:4,data:_.buffer},T={profile:this.isUseOneByte?0:1,length:this.isUseOneByte?5:6,datas:[v]};s.commonPacketHeader.extension=1,s.extension=T,s.payload=this.compress(i),s.commonPacketHeader.length=8+(s.extension.length+2)+s.payload.byteLength}else s.commonPacketHeader.length=8+s.payload.byteLength;const a=new ArrayBuffer(s.commonPacketHeader.length),u=new Uint8Array(a),h=new DataView(a);let p=0;if(h.setUint16(p,s.commonPacketHeader.extension<<15|s.commonPacketHeader.reserved<<14|s.commonPacketHeader.length,!0),p+=2,h.setUint32(p,s.commonPacketHeader.sequence,!0),p+=4,h.setUint16(p,s.commonStreamHeader,!0),p+=2,s.extension){const _=this.serializeExtension(s.extension);u.set(new Uint8Array(_),p),p+=_.byteLength}if(u.set(new Uint8Array(s.payload),p),p+=s.payload.byteLength,p!==s.commonPacketHeader.length)throw Error("serialize error!");return a}deserialize(i){if(i.byteLength<4)return new ArrayBuffer(0);const s=new DataView(i);let a=0;const u=s.getUint16(a,!0);a+=2;const h=(32768&u)>>15;s.getUint16(a+2,!0),s.getUint16(a,!0);let p,_;if(a+=4,s.getUint16(a,!0),a+=2,h){_=this.deserializeExtension(i.slice(a)),a+=2+_.length,p=i.slice(a);let v=!1;if(_.datas.length>0){const T=_.datas.find(b=>b.id===0);T&&(v=(1&new DataView(T.data).getUint32(0,!0))==1)}p=v?this.decompress(p):p}else p=i.slice(8);return p}serializeExtension(i){const{profile:s,length:a,datas:u}=i,h=new ArrayBuffer(a+2),p=new Uint8Array(h),_=new DataView(h);let v=0;if(_.setUint8(v++,s),_.setUint8(v++,a),u.forEach(T=>{s?(_.setUint8(v++,T.id),_.setUint8(v++,T.length),p.set(new Uint8Array(T.data),v),v+=T.data.byteLength):(_.setUint8(v++,T.id|T.length<<4),p.set(new Uint8Array(T.data),v),v+=T.data.byteLength)}),v!==a+2)throw Error("serialize extension error, is ".concat(v,"!==").concat(a+2));return h}deserializeExtension(i){const s=new DataView(i);let a=0;const u=s.getUint8(a);a++;const h=s.getUint8(a);a++;const p=u===pU.TWO_BYTE,_=[],v=new DataView(i,2);let T=0;for(;T<h;){let b=0,C=0,N=new ArrayBuffer(0);p?(b=v.getUint8(T),T++,C=v.getUint8(T),T++):(b=15&v.getUint8(T),C=v.getUint8(T)>>4,T++),C>0&&(N=v.buffer.slice(T+2,T+2+C),T+=N.byteLength),_.push({id:b,length:C,data:N})}if(T!==h)throw Error("parse error");return{profile:u,length:h,datas:_}}decompress(i){return Hue(new Uint8Array(i))}compress(i){return Wue(new Uint8Array(i))}}class TH extends Hn{constructor(i,s){super(),O(this,"_version",1),O(this,"_type",3),O(this,"_config",void 0),O(this,"_originDataChannel",void 0),O(this,"_dataStreamPacketHeader",new ArrayBuffer(4)),O(this,"_dataStreamPacketHandler",void 0),O(this,"_datachannelEventMap",new Map),this._config=i,s&&(this._originDataChannel=s,this._bandDataChannelEvents(s)),this._initPacketHeader(),this._dataStreamPacketHandler=new $ue}get id(){return this._config.id}get ordered(){return this._config.ordered}get maxRetransmits(){return te("DATASTREAM_MAX_RETRANSMITS")}get metadata(){return this._config.metadata}get readyState(){var i,s;return(i=(s=this._originDataChannel)===null||s===void 0?void 0:s.readyState)!==null&&i!==void 0?i:"connecting"}get _originDataChannelId(){var i,s;return(i=(s=this._originDataChannel)===null||s===void 0?void 0:s.id)!==null&&i!==void 0?i:null}getChannelId(){return this.id}getConfig(){return this._config}_close(){this._originDataChannel&&(this._unbindDataChannelEvents(this._originDataChannel),this._originDataChannel=void 0)}async _waitTillOpen(){return new le((i,s)=>{if(this._originDataChannel){this._originDataChannel.readyState==="open"&&i();const a=setTimeout(()=>{var u;s(new Ee(z.DATACHANNEL_CONNECTION_TIMEOUT,"Cannot create datachannel, id: ".concat((u=this._originDataChannel)===null||u===void 0?void 0:u.id)))},1e4);this._originDataChannel.onopen=()=>{clearTimeout(a),this._originDataChannel&&this._bandDataChannelEvents(this._originDataChannel),i()},this._originDataChannel.onerror=()=>{throw clearTimeout(a),new Ee(z.DATACHANNEL_CONNECTION_TIMEOUT)}}else s(new Ee(z.DATACHANNEL_CONNECTION_TIMEOUT,"cannot find dataChannel"))})}_updateOriginDataChannel(i){this._originDataChannel=i,this._bandDataChannelEvents(i)}_initPacketHeader(){const i=new DataView(this._dataStreamPacketHeader);i.setUint16(0,this._version),i.setUint8(2,this._type),i.setUint8(3,this._config.id)}_bandDataChannelEvents(i){this._unbindDataChannelEvents(i),[Z_.OPEN,Z_.CLOSE,Z_.ERROR].forEach(s=>{const a=()=>{this.emit(s)};this._datachannelEventMap.set(s,a),i.addEventListener(s,a)})}_unbindDataChannelEvents(i){Array.from(this._datachannelEventMap.entries()).forEach(s=>{let[a,u]=s;i.removeEventListener(a,u)}),this._datachannelEventMap.clear()}}class zue extends TH{constructor(i){super(i),O(this,"_messageListener",void 0),this._messageListener=s=>{if(s.data.byteLength<this._dataStreamPacketHeader.byteLength)throw Error("invalid byteLength: the byte length must exceed "+this._dataStreamPacketHeader.byteLength);const a=s.data.slice(0,this._dataStreamPacketHeader.byteLength);if(new DataView(a).getUint8(3)!==this.id)return;let u=s.data.slice(this._dataStreamPacketHeader.byteLength);u=this._dataStreamPacketHandler.deserialize(u),this.emit(Z_.MESSAGE,u)}}_updateOriginDataChannel(i){super._updateOriginDataChannel(i),this._bandRemoteDataChannelEvents()}_close(){this._originDataChannel&&(this._originDataChannel.removeEventListener("message",this._messageListener),super._close())}_bandRemoteDataChannelEvents(){this._originDataChannel&&this._originDataChannel.addEventListener("message",this._messageListener)}}class bH extends TH{send(i){if(this._originDataChannel){let s=i;s=this._dataStreamPacketHandler.serialize(i);const a=new Uint8Array(this._dataStreamPacketHeader.byteLength+s.byteLength);a.set(new Uint8Array(this._dataStreamPacketHeader),0),a.set(new Uint8Array(s),this._dataStreamPacketHeader.byteLength),this._originDataChannel.send(a.buffer)}}}class Gue extends Hn{constructor(){super(...arguments),O(this,"resultStorage",new Map)}setLocalAudioStats(i,s,a){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",i,this.checkAudioInputLevel(a,s)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",i,this.checkSendAudioBitrate(a,s))}setLocalVideoStats(i,s,a){this.record("SEND_VIDEO_BITRATE_TOO_LOW",i,this.checkSendVideoBitrate(a,s)),this.record("FRAMERATE_INPUT_TOO_LOW",i,this.checkFramerateInput(a,s)),this.record("FRAMERATE_SENT_TOO_LOW",i,this.checkFramerateSent(a))}setRemoteAudioStats(i,s){const a=i.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",a,this.checkAudioOutputLevel(s))}setRemoteVideoStats(i,s){const a=i.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",a,this.checkVideoDecode(s))}record(i,s,a){if(te("STATS_UPDATE_INTERVAL")>500)return;this.resultStorage.has(i)||this.resultStorage.set(i,{result:[],isPrevNormal:!0});const u=this.resultStorage.get(i);if(u&&(u.result.push(a),u.result.length>=5)){var h;const p=ot(h=u.result).call(h,!0);u.isPrevNormal&&!p&&this.emit("exception",wH[i],i,s),!u.isPrevNormal&&p&&this.emit("exception",wH[i]+2e3,i+"_RECOVER",s),u.isPrevNormal=p,u.result=[]}}checkAudioOutputLevel(i){return!(i.receiveBitrate>0&&i.receiveLevel===0)}checkAudioInputLevel(i,s){return s instanceof Ni&&!s.isActive||!!s.muted||i.sendVolumeLevel!==0}checkFramerateInput(i,s){let a=null;s._encoderConfig&&s._encoderConfig.frameRate&&(a=pa(s._encoderConfig.frameRate));const u=i.captureFrameRate;return!a||!u||!(a>10&&u<5||a<10&&a>=5&&u<=1)}checkFramerateSent(i){return!(i.captureFrameRate&&i.sendFrameRate&&i.captureFrameRate>5&&i.sendFrameRate<=1)}checkSendVideoBitrate(i,s){return!!s.muted||i.sendBitrate!==0}checkSendAudioBitrate(i,s){return s instanceof Ni&&!s.isActive||!!s.muted||i.sendBitrate!==0}checkVideoDecode(i){return i.receiveBitrate===0||i.decodeFrameRate!==0}}const wH={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003},Br=new class{markSubscribeStart(o,i){performance.mark("agora-web-sdk/".concat(o,"/subscribe-").concat(i))}markPublishStart(o,i){performance.mark("agora-web-sdk/".concat(o,"/publish-").concat(i))}measureFromSubscribeStart(o,i){const s=performance.getEntriesByName("agora-web-sdk/".concat(o,"/subscribe-").concat(i));if(s.length>0){const a=s[s.length-1];return Math.round(performance.now()-a.startTime)}return 0}measureFromPublishStart(o,i){const s=performance.getEntriesByName("agora-web-sdk/".concat(o,"/publish-").concat(i));if(s.length>0){const a=s[s.length-1];return Math.round(performance.now()-a.startTime)}return 0}};function CH(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function om(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?CH(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):CH(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}class cE{constructor(i){O(this,"store",void 0),O(this,"onStatsException",void 0),O(this,"onUploadPublishDuration",void 0),O(this,"onStatsChanged",void 0),O(this,"localStats",new Map),O(this,"remoteStats",new Map),O(this,"updateStatsInterval",void 0),O(this,"trafficStats",void 0),O(this,"trafficStatsPeerList",[]),O(this,"uplinkStats",void 0),O(this,"exceptionMonitor",void 0),O(this,"p2pChannel",void 0),O(this,"scalabilityMode",v2.L1T1),O(this,"updateStats",()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))}),this.store=i,this.updateStatsInterval=window.setInterval(this.updateStats,1e3),this.exceptionMonitor=new Gue,this.exceptionMonitor.on("exception",(s,a,u)=>{this.onStatsException&&this.onStatsException(s,a,u)})}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(Te.LocalAudioTrack)||om({},D2)}getLocalVideoTrackStats(){return this.localStats.get(Te.LocalVideoTrack)||om({},k2)}getRemoteAudioTrackStats(i){const s=(h,p)=>{if(!this.trafficStats)return p;const _=this.trafficStats.peer_delay.find(v=>v.peer_uid===h);return _&&(p.publishDuration=_.B_ppad+(Date.now()-this.trafficStats.timestamp)),p},a={};if(i){var u;const h=(u=this.remoteStats.get(i))===null||u===void 0?void 0:u.audioStats;h&&(a[i]=s(i,h))}else Array.from(this.remoteStats.entries()).forEach(h=>{let[p,{audioStats:_}]=h;_&&(a[p]=s(p,_))});return a}getRemoteNetworkQualityStats(i){const s={};if(i){var a;const u=(a=this.remoteStats.get(i))===null||a===void 0?void 0:a.networkStats;u&&(s[i]=u)}else Array.from(this.remoteStats.entries()).forEach(u=>{let[h,{networkStats:p}]=u;p&&(s[h]=p)});return s}getRemoteVideoTrackStats(i){const s=(h,p)=>{if(!this.trafficStats)return p;const _=this.trafficStats.peer_delay.find(v=>v.peer_uid===h);return _&&(p.publishDuration=_.B_ppvd+(Date.now()-this.trafficStats.timestamp)),p},a={};if(i){var u;const h=(u=this.remoteStats.get(i))===null||u===void 0?void 0:u.videoStats;h&&(a[i]=s(i,h))}else Array.from(this.remoteStats.entries()).forEach(h=>{let[p,{videoStats:_}]=h;_&&(a[p]=s(p,_))});return a}getRTCStats(){let i=0,s=0,a=0,u=0;const h=this.localStats.get(Te.LocalAudioTrack);h&&(i+=h.sendBytes,s+=h.sendBitrate);const p=this.localStats.get(Te.LocalVideoTrack);p&&(i+=p.sendBytes,s+=p.sendBitrate);const _=this.localStats.get(Te.LocalVideoLowTrack);_&&(i+=_.sendBytes,s+=_.sendBitrate),this.remoteStats.forEach(T=>{let{audioStats:b,videoStats:C}=T;b&&(a+=b.receiveBytes,u+=b.receiveBitrate),C&&(a+=C.receiveBytes,u+=C.receiveBitrate)});let v=1;return this.trafficStats&&(v+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:v,SendBitrate:s,SendBytes:i,RecvBytes:a,RecvBitrate:u,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(i){this.localStats.set(i,void 0)}removeLocalStats(i){i?this.localStats.delete(i):this.localStats.clear()}addRemoteStats(i){this.remoteStats.set(i,{})}removeRemoteStats(i){i?this.remoteStats.delete(i):this.remoteStats.clear()}addP2PChannel(i){this.p2pChannel=i}updateTrafficStats(i){i.peer_delay=i.peer_delay.filter(s=>s.B_ppad!==void 0||s.B_ppvd!==void 0),i.peer_delay.filter(s=>this.trafficStatsPeerList.indexOf(s.peer_uid)===-1).forEach(s=>{var a;const u=(a=this.p2pChannel)===null||a===void 0?void 0:a.getRemoteMedia(s.peer_uid),h=u!=null&&u.videoSSRC?Br.measureFromSubscribeStart(this.store.clientId,u.videoSSRC):0,p=u!=null&&u.audioSSRC?Br.measureFromSubscribeStart(this.store.clientId,u.audioSSRC):0;s.B_ppad!==void 0&&s.B_ppvd!==void 0&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(s.peer_uid,s.B_ppad,s.B_ppvd,h>p?h:p),this.trafficStatsPeerList.push(s.peer_uid))}),this.trafficStats=i}updateUplinkStats(i){this.uplinkStats&&this.uplinkStats.B_fir!==i.B_fir&&D.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(i.B_fir)),this.uplinkStats=i}static isRemoteVideoFreeze(i,s,a){if(!i)return!1;const u=!!a&&s.framesDecodeFreezeTime>a.framesDecodeFreezeTime,h=!a||s.framesDecodeCount>a.framesDecodeCount;return u||!h}static isRemoteAudioFreeze(i){return!!i&&i._isFreeze()}isLocalVideoFreeze(i){return!(!i.inputFrame||!i.sentFrame)&&i.inputFrame.frameRate>5&&i.sentFrame.frameRate<3}updateLocalStats(i){Array.from(this.localStats.entries()).forEach(s=>{let[a,u]=s;switch(a){case Te.LocalVideoTrack:case Te.LocalVideoLowTrack:{const p=u,_=om({},k2),v=i.getStats(),T=i.getLocalMedia(a);if(v){const b=v.videoSend.find(C=>C.ssrc===(T==null?void 0:T.ssrcs[0].ssrcId));if(b){const C=i.getLocalVideoSize(),N=i.getEncoderConfig(Te.LocalVideoTrack);b.codec!=="H264"&&b.codec!=="H265"&&b.codec!=="VP8"&&b.codec!=="VP9"&&b.codec!=="AV1X"&&b.codec!=="AV1"||(_.codecType=b.codec),_.sendBytes=b.bytes,_.sendBitrate=p?8*Math.max(0,_.sendBytes-p.sendBytes):0,b.inputFrame?(_.captureFrameRate=b.inputFrame.frameRate,_.captureResolutionHeight=b.inputFrame.height,_.captureResolutionWidth=b.inputFrame.width):C&&(_.captureResolutionWidth=C.width,_.captureResolutionHeight=C.height),b.sentFrame?(_.sendFrameRate=b.sentFrame.frameRate,_.sendResolutionHeight=b.sentFrame.height,_.sendResolutionWidth=b.sentFrame.width):C&&(_.sendResolutionWidth=C.width,_.sendResolutionHeight=C.height),b.avgEncodeMs&&(_.encodeDelay=b.avgEncodeMs),N&&N.bitrateMax&&(_.targetSendBitrate=1e3*N.bitrateMax),_.sendPackets=b.packets,_.sendPacketsLost=b.packetsLost,_.sendJitterMs=b.jitterMs,_.sendRttMs=b.rttMs,_.totalDuration=p?p.totalDuration+1:1,_.totalFreezeTime=p?p.totalFreezeTime:0,this.isLocalVideoFreeze(b)&&(_.totalFreezeTime+=1),b.scalabilityMode&&this.scalabilityMode!==b.scalabilityMode&&(D.debug("[".concat(this.store.clientId,"]: The scalabilityMode of the video sending stream is ").concat(b.scalabilityMode)),this.scalabilityMode=b.scalabilityMode)}this.trafficStats&&(_.currentPacketLossRate=(this.trafficStats.B_pvlr4||0)/100)}var h;this.localStats.set(a,_),((p==null?void 0:p.sendResolutionWidth)!==_.sendResolutionWidth||(p==null?void 0:p.sendResolutionHeight)!==_.sendResolutionHeight)&&((h=this.onStatsChanged)===null||h===void 0||h.call(this,"resolution",{width:_.sendResolutionWidth,height:_.sendResolutionHeight})),_&&T&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,T.track,_);break}case Te.LocalAudioTrack:{const p=u,_=om({},D2),v=i.getStats(),T=i.getLocalMedia(a);if(v){const b=v.audioSend.find(C=>C.ssrc===(T==null?void 0:T.ssrcs[0].ssrcId));if(b){if(b.codec!=="opus"&&b.codec!=="aac"&&b.codec!=="PCMU"&&b.codec!=="PCMA"&&b.codec!=="G722"||(_.codecType=b.codec),b.inputLevel)_.sendVolumeLevel=Math.round(32767*b.inputLevel);else{const C=i.getLocalAudioVolume();C&&(_.sendVolumeLevel=Math.round(32767*C))}_.sendBytes=b.bytes,_.sendPackets=b.packets,_.sendPacketsLost=b.packetsLost,_.sendJitterMs=b.jitterMs,_.sendRttMs=b.rttMs,_.sendBitrate=p?8*Math.max(0,_.sendBytes-p.sendBytes):0}}this.trafficStats&&(_.currentPacketLossRate=(this.trafficStats.B_palr4||0)/100),this.localStats.set(Te.LocalAudioTrack,_),_&&T&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,T.track,_);break}}})}updateRemoteStats(i){Array.from(this.remoteStats.entries()).forEach(s=>{let[a,{videoStats:u,audioStats:h,videoPcStats:p}]=s;const _=h,v=u,T=p,b=om({},n7),C=om({},i7),N=om({},Nle),{audioTrack:x,videoTrack:B,audioSSRC:F,videoSSRC:H}=i.getRemoteMedia(a),J=i.getStats(),ee=J==null?void 0:J.audioRecv.find(me=>me.ssrc===F),se=J==null?void 0:J.videoRecv.find(me=>me.ssrc===H),ye=this.trafficStats&&this.trafficStats.peer_delay.find(me=>me.peer_uid===a);if(ee&&(ee.codec!=="opus"&&ee.codec!=="aac"&&ee.codec!=="PCMU"&&ee.codec!=="PCMA"&&ee.codec!=="G722"||(b.codecType=ee.codec),ee.outputLevel?b.receiveLevel=Math.round(32767*ee.outputLevel):x&&(b.receiveLevel=Math.round(32767*x.getVolumeLevel())),b.receiveBytes=ee.bytes,b.receivePackets=ee.packets,b.receivePacketsLost=ee.packetsLost,b.packetLossRate=b.receivePacketsLost/(b.receivePackets+b.receivePacketsLost),b.receiveBitrate=_?8*Math.max(0,b.receiveBytes-_.receiveBytes):0,b.totalDuration=_?_.totalDuration+1:1,b.totalFreezeTime=_?_.totalFreezeTime:0,b.freezeRate=b.totalFreezeTime/b.totalDuration,b.receiveDelay=ee.jitterBufferMs,b.totalDuration>10&&cE.isRemoteAudioFreeze(x)&&(b.totalFreezeTime+=1)),se){se.codec!=="H264"&&se.codec!=="H265"&&se.codec!=="VP8"&&se.codec!=="VP9"&&se.codec!=="AV1X"&&se.codec!=="AV1"||(C.codecType=se.codec),C.receiveBytes=se.bytes,C.receiveBitrate=v?8*Math.max(0,C.receiveBytes-v.receiveBytes):0,C.decodeFrameRate=se.decodeFrameRate<0?0:se.decodeFrameRate,C.renderFrameRate=se.decodeFrameRate<0?0:se.decodeFrameRate,se.outputFrame&&(C.renderFrameRate=se.outputFrame.frameRate),se.receivedFrame?(C.receiveFrameRate=se.receivedFrame.frameRate,C.receiveResolutionHeight=se.receivedFrame.height,C.receiveResolutionWidth=se.receivedFrame.width):B&&(C.receiveResolutionHeight=B._videoHeight||0,C.receiveResolutionWidth=B._videoWidth||0),se.framesRateFirefox!==void 0&&(C.receiveFrameRate=Math.round(se.framesRateFirefox)),C.receivePackets=se.packets,C.receivePacketsLost=se.packetsLost,C.packetLossRate=C.receivePacketsLost/(C.receivePackets+C.receivePacketsLost),C.totalDuration=v?v.totalDuration+1:1,C.totalFreezeTime=v?v.totalFreezeTime:0,C.receiveDelay=se.jitterBufferMs||0;const me=!!H&&i.getRemoteVideoIsReady(H);B&&me&&cE.isRemoteVideoFreeze(B,se,T)&&(C.totalFreezeTime+=1),C.freezeRate=C.totalFreezeTime/C.totalDuration}ye&&(b.end2EndDelay=ye.B_ad,C.end2EndDelay=ye.B_vd,b.transportDelay=ye.B_ed,C.transportDelay=ye.B_ed,b.currentPacketLossRate=ye.B_ealr4/100,C.currentPacketLossRate=ye.B_evlr4/100,N.uplinkNetworkQuality=ye.B_punq?ye.B_punq:0,N.downlinkNetworkQuality=ye.B_pdnq?ye.B_pdnq:0),this.remoteStats.set(a,{audioStats:b,videoStats:C,videoPcStats:se,networkStats:N}),x&&this.exceptionMonitor.setRemoteAudioStats(x,b),B&&this.exceptionMonitor.setRemoteVideoStats(B,C)})}}function RH(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function qI(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?RH(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):RH(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}function gS(o){return o.match(/^[\.\:\d]+$/)?"".concat(o.replace(/[^\d]/g,"-"),".").concat(te("TURN_DOMAIN")):(D.info("Cannot recognized as IP address ".concat(o,". Used As Host instead")),o)}function IH(o,i){var s,a;const u=te("GATEWAY_DOMAINS");let h=u[1]&&i.indexOf(u[1])!==-1?1:0;o.addresses=o.addresses||[];const p=o.addresses.map(v=>v.domain_prefix?{address:"".concat(v.domain_prefix,".").concat(u[h++%u.length],":").concat(v.port)}:v.ip.match(/^[\.\:\d]+$/)?{ip:v.ip,port:v.port,address:"".concat(v.ip.replace(/[^\d]/g,"-"),".").concat(u[h++%u.length],":").concat(v.port)}:(D.info("Cannot recognized as IP address ".concat(v.ip,". Used As Host instead")),{ip:v.ip,port:v.port,address:"".concat(v.ip,":").concat(v.port)}));if((s=o.detail)!==null&&s!==void 0&&s[18]&&typeof((a=o.detail)===null||a===void 0?void 0:a[18])=="string"){const v=o.detail[18],T=v==null?void 0:v.split(";");for(let b=0;b<T.length;b++){var _;const C=O2(_=T[b]).call(_);p[b]&&C&&(p[b].ip6=C)}}return{gatewayAddrs:p,uid:o.uid,cid:o.cid,cert:o.cert,vid:o.detail&&o.detail[8],uni_lbs_ip:o.detail&&o.detail[1],res:o,csIp:o.detail&&o.detail[502]}}function pa(o){return typeof o=="number"?o:o.exact||o.ideal||o.max||o.min||0}function YI(o){const i=o._encoderConfig;if(!i)return{};const s={resolution:i.width&&i.height?"".concat(pa(i.width),"x").concat(pa(i.height)):void 0,maxVideoBW:i.bitrateMax,minVideoBW:i.bitrateMin};return typeof i.frameRate=="number"?(s.maxFrameRate=i.frameRate,s.minFrameRate=i.frameRate):i.frameRate&&(s.maxFrameRate=i.frameRate.max||i.frameRate.ideal||i.frameRate.exact||i.frameRate.min,s.minFrameRate=i.frameRate.min||i.frameRate.ideal||i.frameRate.exact||i.frameRate.max),s}function AH(o){const i={connectionType:0,googRtt:o.rtt};switch(o.selectedCandidatePair.localCandidate.candidateType){case"relay":{const s=o.selectedCandidatePair.localCandidate.relayProtocol;s==="udp"&&(i.connectionType=1),s==="tcp"&&(i.connectionType=3),s==="tls"&&(i.connectionType=4);break}case"srflx":i.connectionType=2}return i}function OH(o){return o>=0&&o<.17?1:o>=.17&&o<.36?2:o>=.36&&o<.59?3:o>=.59&&o<=1?4:o>1?5:0}function mU(o,i){let s,a,u;switch(i){case pr.CHOOSE_SERVER:a=4096,u="choose server";break;case pr.CLOUD_PROXY:a=1048576,u="proxy";break;case pr.CLOUD_PROXY_5:a=4194304,u="proxy5";break;case pr.CLOUD_PROXY_FALLBACK:a=4194310,u="proxy fallback";break;default:throw new ae(z.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:o.detail&&o.detail[502],retry:!1})}if(o.response_body.forEach(h=>{h.buffer&&h.buffer.flag===a&&(s={code:h.buffer.code,addresses:(h.buffer.edges_services||[]).map(p=>qI(qI({},p),{},{ticket:h.buffer.cert})),server_ts:o.enter_ts,uid:h.buffer.uid,cid:h.buffer.cid,cname:h.buffer.cname,detail:qI(qI({},h.buffer.detail),o.detail),flag:h.buffer.flag,opid:o.opid,cert:h.buffer.cert})}),!s)throw new ae(z.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(u," from multi unilbs response"),{csIp:o.detail&&o.detail[502]});return s}async function Kue(o,i){return await le.all(o.addresses.map(async s=>({address:gS(s.ip),tcpport:s.port,udpport:s.port,username:i&&te("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?i.toString():ra.username,password:i&&te("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?await tce(i.toString()):ra.password})))}function gU(o,i){const s=i._videoHeight||i.getMediaStreamTrack(!0).getSettings().height;return s?Math.max(s/pa(o.height),1):(D.warning("can't get ori-track's height, default scale down 4 times for low stream"),4)}function Hh(o){let{candidateType:i,relayProtocol:s,type:a,address:u,port:h,protocol:p}=o;return a==="local-candidate"?{candidateType:i,relayProtocol:s,protocol:p}:{candidateType:i,relayProtocol:s,address:u,port:h,protocol:p}}function NH(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}class que extends Hn{get url(){return this._url?this._url:null}get reconnectMode(){return this._reconnectMode}set reconnectMode(i){var s;ot(s=["tryNext","recover"]).call(s,i)&&this.resetReconnectCount(i),this._reconnectMode=i}get state(){return this._state}set state(i){i!==this._state&&(this._state=i,this._state==="reconnecting"?this.emit(hi.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(hi.CONNECTED):this._state==="closed"?this.emit(hi.CLOSED):this._state==="failed"&&this.emit(hi.FAILED))}constructor(i,s,a,u){super(),O(this,"connectionID",0),O(this,"currentURLIndex",0),O(this,"reconnectReason",void 0),O(this,"_reconnectMode","tryNext"),O(this,"_name",void 0),O(this,"_state","closed"),O(this,"_retryConfig",void 0),O(this,"_reconnectCount",0),O(this,"_forceCloseTimeout",5e3),O(this,"_onlineReconnectListener",void 0),O(this,"_closeEstablishingTransmitter",()=>{}),O(this,"_store",void 0),O(this,"_joinChannelServiceRecordIndex",void 0),O(this,"_useCompress",void 0),O(this,"_inflateLength",0),O(this,"_deflateLength",0),this._store=u,this._name=i,this._retryConfig=function(h){for(var p=1;p<arguments.length;p++){var _=arguments[p]!=null?arguments[p]:{};p%2?NH(Object(_),!0).forEach(function(v){O(h,v,_[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(_)):NH(Object(_)).forEach(function(v){Object.defineProperty(h,v,Object.getOwnPropertyDescriptor(_,v))})}return h}({},s),this._useCompress=a}resetReconnectCount(i){D.debug("".concat(this._name," reset reconnect count, reason: ").concat(i)),this._reconnectCount=0}close(i,s){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this._reconnectInterrupter&&this._reconnectInterrupter(),this._transmitter){this._transmitter.onclose=null,this._transmitter.onopen=null,this._transmitter.onmessage=null;const a=this._transmitter;s?setTimeout(()=>a.close(),500):a.close(),this._transmitter=void 0}this.state=i?"failed":"closed",this._closeEstablishingTransmitter&&this._closeEstablishingTransmitter()}reconnect(i,s){if(!this._transmitter)return void D.warning("[".concat(this._name,"] can not reconnect, no websocket"));var a;i!==void 0&&(this.reconnectMode=i),D.debug("[".concat(this._name,"] reconnect is triggered initiative")),typeof this._joinChannelServiceRecordIndex=="number"&&((a=this._store)===null||a===void 0||a.recordJoinChannelService({status:"error",errors:[new Error(s)]},this._joinChannelServiceRecordIndex));const u=this._transmitter.onclose;this._transmitter.onclose=null,this._transmitter.close(),u&&u.bind(this._transmitter)({code:9999,reason:s})}getInflateData(){const i=this._inflateLength,s=this._deflateLength;return this.clearInflateData(),{inflateLength:i,deflateLength:s}}setInflateData(i){this._deflateLength=this._deflateLength+i.originLength,this._inflateLength=this._inflateLength+i.compressedLength}clearInflateData(){this._inflateLength=0,this._deflateLength=0}}var Wa;(function(o){o[o.Default=0]="Default",o[o.Ack=1]="Ack"})(Wa||(Wa={}));class Yue{constructor(i,s,a){O(this,"version",1),O(this,"initialRTO",void 0),O(this,"maxBatchAckCount",void 0),O(this,"maxRTO",void 0),O(this,"initialRTT",void 0),O(this,"ID",void 0),O(this,"rtt",void 0),O(this,"packetNumber",1),O(this,"rtoRatioMap",new Map),O(this,"timeoutMap",new Map),O(this,"unorderedPacketQueue",[]),O(this,"batchAckPacketQueue",[]),O(this,"lastOrderedPacketNumber",0),O(this,"batchAckTimer",void 0),O(this,"sendImpl",void 0),O(this,"receiveImpl",void 0),this.sendImpl=i,this.receiveImpl=s,this.ID=wn(7,"transmitter-"),this.initialRTO=(a==null?void 0:a.initialRTO)!==void 0?a.initialRTO:te("TRANSMITTER_INITIAL_RTO"),this.initialRTT=(a==null?void 0:a.initialRTT)!==void 0?a.initialRTT:te("TRANSMITTER_INITIAL_RTT"),this.rtt=(a==null?void 0:a.initialRTT)!==void 0?a.initialRTT:te("TRANSMITTER_INITIAL_RTT"),this.maxBatchAckCount=(a==null?void 0:a.maxBatchAckCount)!==void 0?a.maxBatchAckCount:te("TRANSMITTER_MAX_BATCH_ACK_COUNT"),this.maxRTO=(a==null?void 0:a.maxRTO)!==void 0?a.maxRTO:te("TRANSMITTER_MAX_RTO")}packetize(i,s){return{type:Wa.Default,version:this.version,packetNumber:s,payload:i}}serialize(i){switch(i.type){case Wa.Default:{let s;typeof i.payload=="string"?s=new TextEncoder().encode(i.payload):s=i.payload;const a=new ArrayBuffer(s.length+15),u=new DataView(a);return u.setUint16(0,i.version),u.setUint8(2,i.type),u.setUint32(3,i.packetNumber),_8(u,7,BigInt(i.sendTs)),new Uint8Array(u.buffer).set(s,15),a}case Wa.Ack:{const s=new ArrayBuffer(16),a=new DataView(s);return a.setUint16(0,i.version),a.setUint8(2,i.type),a.setUint32(3,i.maxAckPacketNumber),a.setUint8(7,i.shift),_8(a,8,BigInt(i.ackSendTs)),s}}}deserialize(i){const s=new DataView(i),a=s.getUint16(0),u=s.getUint8(2);switch(u){case Wa.Default:{const h=s.getUint32(3),p=g8(s,7),_=i.slice(15),v=new TextDecoder().decode(_);return{version:a,type:u,packetNumber:h,sendTs:Number(p),payload:v}}case Wa.Ack:{const h=s.getUint32(3),p=s.getUint8(7),_=g8(s,8);return{version:a,type:u,maxAckPacketNumber:h,shift:p,ackSendTs:Number(_)}}default:throw D.error("[".concat(this.ID,"] Unrecognized packet type ").concat(u)),new Error("Unrecognized packet type ".concat(u))}}sendMessage(i){const s=this.packetize(i,this.packetNumber);this.packetNumber=this.packetNumber===4294967295?1:this.packetNumber+1;const a=this.calculateRTO(s),u=window.setTimeout(()=>{this.resendMessage(s)},a);this.timeoutMap.set(s.packetNumber,u),this.sendPacket(s)}onData(i){const s=this.deserialize(i);s.type===Wa.Default?this.ack(s):s.type===Wa.Ack&&(this.updateRTT(s,Math.round(performance.now())),this.clearRTO(s))}close(){this.rtt=this.initialRTT,this.packetNumber=1,Array.from(this.timeoutMap.entries()).forEach(i=>{let[s,a]=i;window.clearTimeout(a)}),this.timeoutMap=new Map,this.rtoRatioMap=new Map,this.unorderedPacketQueue=[],this.batchAckPacketQueue=[],this.lastOrderedPacketNumber=0,this.batchAckTimer!==void 0&&window.clearTimeout(this.batchAckTimer)}resendMessage(i){const s=this.calculateRTO(i),a=window.setTimeout(()=>{this.resendMessage(i)},s);this.timeoutMap.set(i.packetNumber,a),this.sendPacket(i)}calculateRTO(i){const s=this.rtoRatioMap.get(i.packetNumber);if(s===void 0)return this.rtoRatioMap.set(i.packetNumber,1),this.initialRTO;{const a=9*this.rtt/8*s;return this.rtoRatioMap.set(i.packetNumber,s+1),a>this.maxRTO?this.maxRTO:a}}updateRTT(i,s){const a=i.ackSendTs;this.rtt=this.rtt*(7/8)+(s-a-this.rtt)/8}ack(i){if(i.packetNumber===this.lastOrderedPacketNumber+1)for(this.batchAckPacketQueue.length>=this.maxBatchAckCount&&this.batchAck(),this.batchAckTimer?this.batchAckPacketQueue.push(i):(this.batchAckPacketQueue.push(i),this.batchAckTimer=window.setTimeout(()=>{this.batchAck()},this.rtt/8)),this.lastOrderedPacketNumber+=1,this.receiveImpl(i.payload);;){const s=this.unorderedPacketQueue[0];if(!s){this.unorderedPacketQueue.shift();break}this.batchAckTimer&&this.batchAck(),this.receiveImpl(s.payload),this.unorderedPacketQueue.shift(),this.lastOrderedPacketNumber+=1}else if(i.packetNumber<=this.lastOrderedPacketNumber){const s={ackSendTs:i.sendTs,maxAckPacketNumber:i.packetNumber,shift:0,type:Wa.Ack,version:this.version};this.sendPacket(s)}else if(i.packetNumber>this.lastOrderedPacketNumber){this.unorderedPacketQueue[i.packetNumber-this.lastOrderedPacketNumber-2]=i;const s={ackSendTs:i.sendTs,maxAckPacketNumber:i.packetNumber,shift:0,type:Wa.Ack,version:this.version};this.sendPacket(s)}}batchAck(){window.clearTimeout(this.batchAckTimer),this.batchAckTimer=void 0;const i={ackSendTs:this.batchAckPacketQueue[this.batchAckPacketQueue.length-1].sendTs,maxAckPacketNumber:this.batchAckPacketQueue[this.batchAckPacketQueue.length-1].packetNumber,shift:this.batchAckPacketQueue.length-1,type:Wa.Ack,version:this.version};this.sendPacket(i),this.batchAckPacketQueue=[]}sendPacket(i){i.type===Wa.Default&&(i.sendTs=Math.round(performance.now()));const s=this.serialize(i);this.sendImpl(s)}clearRTO(i){for(let s=i.maxAckPacketNumber-i.shift;s<=i.maxAckPacketNumber;s++){const a=this.timeoutMap.get(s);a!==void 0&&window.clearTimeout(a),this.timeoutMap.delete(s),this.rtoRatioMap.delete(s)}}}class PH extends que{constructor(i,s){super(i,s,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3?arguments[3]:void 0),O(this,"_initMutex",void 0),O(this,"_reconnectInterrupter",void 0),O(this,"_url",void 0),O(this,"_transmitter",void 0),O(this,"_addresses",void 0),O(this,"_reliableTransmission",void 0),this._initMutex=new fr("datachannel");const{timeout:a,timeoutFactor:u}=s,h=Math.max(300,Math.floor(3*a/5)),p=Math.max(1.2,Math.floor(8*u)/10);ms.ONLINE&&(this._retryConfig.timeout=h,this._retryConfig.timeoutFactor=p),Ii.on(od.NETWORK_STATE_CHANGE,(_,v)=>{_!==v&&(this.resetReconnectCount("network state change: ".concat(v," -> ").concat(_)),_===ms.ONLINE?(this._retryConfig.timeout=h,this._retryConfig.timeoutFactor=p):(this._retryConfig.timeout=a,this._retryConfig.timeoutFactor=u))})}getConnection(){if(this._reliableTransmission)return this._reliableTransmission}async init(i){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;this._forceCloseTimeout=s;const a=(u,h)=>{this._addresses=i,this.currentURLIndex=this._addresses.findIndex(_=>_.fingerprint||te("FINGERPRINT"));const p=this._addresses[this.currentURLIndex];this.state="connecting",this.createTransmitterConnection(p).then(u).catch(h),this.once(hi.CLOSED,()=>h(new ae(z.WS_DISCONNECT))),this.once(hi.CONNECTED,()=>u())};return this._initMutex.lock().then(u=>new le((h,p)=>{a(h,p)}).then(()=>{u()}).catch(()=>{u()}))}sendMessage(i){let s=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this._transmitter||!this._reliableTransmission)throw new ae(z.WS_ABORT,"datachannel is not ready");try{s||(i=JSON.stringify(i)),this._reliableTransmission.sendMessage(i)}catch(a){throw new ae(z.WS_ERR,"send datachannel signal message error"+a.toString())}}unbindDcCloseEventListener(){this._transmitter&&(this._transmitter.onclose=null)}sendMessageWithJSON(i){const s=JSON.stringify(i);return{compressed:s,compressedLength:s.length,origin:i}}sendMessageWithUint8Array(i){return{compressed:i,compressedLength:i.byteLength,origin:i}}createTransmitterConnection(i){return this.connectionID+=1,this._joinChannelServiceRecordIndex=void 0,this._url="dc://".concat(i.ip,":").concat(i.port),new le((s,a)=>{var u;const h=()=>{D.debug("[".concat(this._name,"] datachannel opened:"),this._url),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),s()},p=async b=>{var C;if((C=this._closeEstablishingTransmitter)===null||C===void 0||C.call(this),D.debug("[".concat(this._name,"] datachannel close ").concat(this._url,", code: ").concat(b.code,", reason: ").concat(b.reason,", current mode: ").concat(this.reconnectMode)),this._reconnectCount<this._retryConfig.maxRetryCount){this.state==="connected"&&(this.reconnectReason=b.reason,this.state="reconnecting");const N=oo(this,hi.WILL_RECONNECT,this.reconnectMode)||this.reconnectMode,x=await this.reconnectWithAction(N);if(this.state==="closed")return void D.debug("[".concat(this.connectionID,"] dc is closed, no need to reconnect"));if(!x)return a(new ae(z.WS_DISCONNECT,"datachannel reconnect failed: ".concat(b.code))),void this.close(!0);s()}else a(new ae(z.WS_DISCONNECT,"datachannel close: ".concat(b.code))),this.close()},_=b=>{var C;(C=this._reliableTransmission)===null||C===void 0||C.onData(b.data)};this._transmitter&&(this._transmitter.onclose=null,this._transmitter.close()),this._reliableTransmission&&(this._reliableTransmission.close(),this._reliableTransmission=void 0),D.debug("[".concat(this._name,"] start connect, address: ").concat(JSON.stringify(i)));const v=(u=this._store)===null||u===void 0?void 0:u.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"}),T=Date.now();Qn(this,hi.TO_CONNECT_DATACHANNEL,i).then(b=>{var C,N;if(!b)throw new Error("transmissonInfo not exist yet");const{transmitter:x,close:B}=b;this._transmitter=x,(C=this._store)===null||C===void 0||C.signalChannelOpen();const F=Date.now()-T;D.debug("[choose dc] dc open cost ".concat(F,"ms")),this._reliableTransmission=new Yue(H=>{var J;this._transmitter&&this._transmitter.readyState==="open"&&((J=this._transmitter)===null||J===void 0||J.send(H))},H=>{typeof H=="string"&&this.emit(hi.ON_MESSAGE,H)}),this._closeEstablishingTransmitter=()=>{var H;(H=this._reliableTransmission)===null||H===void 0||H.close(),this._reliableTransmission=void 0,B()},h&&h(),x.onclose=p,x.onmessage=_,(N=this._store)===null||N===void 0||N.recordJoinChannelService({endTs:Date.now(),status:"success"},v),this._joinChannelServiceRecordIndex=v}).catch(b=>{var C;if((C=this._store)===null||C===void 0||C.recordJoinChannelService({endTs:Date.now(),status:b instanceof ae&&b.code===z.WS_ABORT?"aborted":"error",errors:[b]},v),this.state!=="closed"){if(b instanceof ae&&b.code===z.WS_ERR){const N=new ae(z.WS_ERR,"init datachannel failed! Error: ".concat(b.toString()));return D.error("[".concat(this._name,"]").concat(N)),void a(N)}p&&p(b)}else a(new ae(z.WS_DISCONNECT,"datachannel is closed: ".concat(b.toString())))})})}async reconnectWithAction(i){let s=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this._reconnectCount>=this._retryConfig.maxRetryCount||!this._addresses||this.state==="closed")return!1;this._onlineReconnectListener||Ii.networkState!==ms.OFFLINE||(this._onlineReconnectListener=Ii.onlineWaiter&&Ii.onlineWaiter.then(()=>{this._onlineReconnectListener=void 0}));let a=!0;if(this._reconnectInterrupter=()=>{a=!1},s){const _=aI(this._reconnectCount,this._retryConfig);D.debug("[".concat(this._name,"] wait ").concat(_,"ms to reconnect datachannel, mode: ").concat(i)),await le.race([xr(_),this._onlineReconnectListener||new le(()=>{})])}if(this.state==="closed"||!a)return!1;this._reconnectCount+=1;const u=async(_,v)=>{this.emit(hi.RECONNECT_CREATE_CONNECTION,v),await this.createTransmitterConnection(_)};try{if(i==="retry"){const _=this._addresses[this.currentURLIndex];this.emit(hi.RECONNECT_WAITTING_FINISH,i),await u(_,i)}else if(i==="tryNext"){this.currentURLIndex+=1;for(let v=this.currentURLIndex;v<this._addresses.length;v++){if(this._addresses[v].fingerprint||te("FINGERPRINT")){this.currentURLIndex=v;break}this.currentURLIndex+=1}if(this.currentURLIndex>=this._addresses.length)return D.debug("[".concat(this._name,"] the available addresses are exhausted, change to recover")),await this.reconnectWithAction("recover",!1);D.debug("[".concat(this._name,"] datachannel url length: ").concat(this._addresses.length," current index: ").concat(this.currentURLIndex));const _=this._addresses[this.currentURLIndex];this.emit(hi.RECONNECT_WAITTING_FINISH,i),await u(_,i)}else i==="recover"&&(D.debug("[".concat(this._name,"] start to failback to websocket")),this.resetReconnectCount("recover mode"),this.emit(hi.RECONNECT_WAITTING_FINISH,i),this.emit(hi.FAILBACK));return!0}catch(_){var h,p;return D.error("[".concat(this._name,"] reconnect failed"),_.toString()),_!=null&&(h=_.data)!==null&&h!==void 0&&h.desc&&Array.isArray(_.data.desc)&&_.data.desc.length&&ot(p=_.data.desc).call(p,"dynamic key expired")?(this.emit(hi.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):await this.reconnectWithAction(i,s)}}}class fd extends Hn{get connectionState(){return this._connectionState}set connectionState(i){i!==this._connectionState&&(this._connectionState=i,i===It.CONNECTED?this.emit(Be.WS_CONNECTED):i===It.RECONNECTING?this.emit(Be.WS_RECONNECTING,this._websocketReconnectReason):i===It.CLOSED&&this.emit(Be.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket?this.websocket.url:null}get rtt(){return this.rttRolling.mean()}constructor(i,s){super(),O(this,"_disconnectedReason",void 0),O(this,"_websocketReconnectReason",void 0),O(this,"_connectionState",It.CLOSED),O(this,"reconnectToken",void 0),O(this,"websocket",void 0),O(this,"openConnectionTime",void 0),O(this,"clientId",void 0),O(this,"lastMsgTime",Date.now()),O(this,"uploadCache",[]),O(this,"uploadCacheInterval",void 0),O(this,"rttRolling",new JM(5)),O(this,"pingpongTimer",void 0),O(this,"inflateDataTimer",void 0),O(this,"pingpongTimeoutCount",0),O(this,"joinResponse",void 0),O(this,"multiIpOption",void 0),O(this,"initError",void 0),O(this,"spec",void 0),O(this,"store",void 0),O(this,"onWebsocketMessage",a=>{if(a instanceof ArrayBuffer)return void this.emit(Be.ON_BINARY_DATA,a);const u=JSON.parse(a);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(u,"_id")){const h="res-@".concat(u._id);this.emit(h,u._result,u._message)}else if(Object.prototype.hasOwnProperty.call(u,"_type")&&(this.emit(u._type,u._message),u._type===St.ON_NOTIFICATION&&this.handleNotification(u._message),u._type===St.ON_USER_BANNED))switch(u._message.error_code){case 14:this.close(Pt.UID_BANNED);break;case 15:this.close(Pt.IP_BANNED);break;case 16:this.close(Pt.CHANNEL_BANNED)}}),this.clientId=i.clientId,this.spec=i,this.store=s,this.websocket=new PH("gateway-".concat(this.clientId),this.spec.retryConfig,!0,s),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===It.CONNECTED&&this.reconnect("retry",Ql.OFFLINE)})}async request(i,s,a,u){const h=wn(6,""),p={_id:h,_type:i,_message:s},_=this.websocket.connectionID,v=()=>new le((B,F)=>{if(this.connectionState===It.CONNECTED)return B();const H=()=>{this.off(Be.WS_CLOSED,J),B()},J=()=>{this.off(Be.WS_CONNECTED,H),F(new ae(z.WS_ABORT))};this.once(Be.WS_CONNECTED,H),this.once(Be.WS_CLOSED,J),i!==nt.PUBLISH&&i!==nt.SUBSCRIBE&&i!==nt.UNSUBSCRIBE&&i!==nt.UNPUBLISH&&i!==nt.CONTROL&&i!==nt.RESTART_ICE||this.once(Be.DISCONNECT_P2P,()=>{F(new ae(z.DISCONNECT_P2P))}),i!==nt.PUBLISH&&i!==nt.RESTART_ICE||this.once(Be.ABORT_P2P_EXECUTION,()=>{F(new ae(z.DISCONNECT_P2P))})});if(this.connectionState!==It.CONNECTING&&this.connectionState!==It.RECONNECTING||i===nt.JOIN||i===nt.REJOIN||await v(),i===nt.LEAVE&&(this.websocket.unbindDcCloseEventListener(),u=!0),this.websocket.sendMessage(p,!0,!1),u)return;const T=new le((B,F)=>{let H=!1;const J=(se,ye)=>{H=!0,B({isSuccess:se==="success",message:ye||{}}),this.off(Be.WS_CLOSED,ee),this.off(Be.WS_RECONNECTING,ee),this.emit(Be.REQUEST_SUCCESS,i,s)};this.once("res-@".concat(h),J);const ee=()=>{F(new ae(z.WS_ABORT,"type: ".concat(i))),this.off(Be.WS_CLOSED,ee),this.off(Be.WS_RECONNECTING,ee),this.off("res-@".concat(h),J)};this.once(Be.WS_CLOSED,ee),this.once(Be.WS_RECONNECTING,ee),xr(te("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==_||H||(D.warning("dc request timeout, type: ".concat(i)),this.emit(Be.REQUEST_TIMEOUT,i,s))})});let b=null;try{b=await T}catch(B){if(this.connectionState===It.CLOSED||i===nt.LEAVE)throw new ae(z.WS_ABORT);return!this.spec.forceWaitGatewayResponse||a?B.throw():i===nt.JOIN||i===nt.REJOIN?null:(await v(),await this.request(i,s))}if(b.isSuccess)return b.message;const C=Number(b.message.error_code||b.message.code),N=Xp(C),x=new ae(z.UNEXPECTED_RESPONSE,"".concat(N.desc,": ").concat(b.message.error_str),{code:C,data:b.message});return N.action==="success"?b.message:(D.warning("[".concat(this.websocket.connectionID,"] unexpected response from type ").concat(i,", error_code: ").concat(C,", message: ").concat(N.desc,", action: ").concat(N.action)),C===lt.ERR_TOO_MANY_BROADCASTERS?((i===nt.JOIN||i===nt.REJOIN)&&(this.initError=x,this.close()),x.throw()):N.action==="failed"?x.throw():N.action==="quit"?(this.initError=x,this.close(),x.throw()):(C===lt.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=b.message.option,D.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",Ql.MULTI_IP)):this.reconnect(N.action,Ql.SERVER_ERROR),i===nt.JOIN||i===nt.REJOIN?null:await this.request(i,s)))}waitMessage(i,s){return new le(a=>{const u=h=>{(!s||s(h))&&(this.off(i,u),a(h))};this.on(i,u)})}upload(i,s){const a={_type:i,_message:s};try{this.websocket.sendMessage(a)}catch{const h=te("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(a),this.uploadCache.length>h&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==It.CONNECTED)return;const p=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(p._type,p._message)},te("UPLOAD_CACHE_INTERVAL")||2e3))}}send(i,s){const a={_type:i,_message:s};this.websocket.sendMessage(a)}init(i,s){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new le((a,u)=>{this.once(Be.WS_CONNECTED,()=>a(this.joinResponse)),this.once(Be.WS_CLOSED,()=>u(this.initError||new ae(z.WS_ABORT))),this.connectionState=It.CONNECTING,this.websocket.init(i).catch(u),this.websocket.once(hi.FAILBACK,()=>{this.openConnectionTime===void 0&&u(new ae(z.INIT_DATACHANNEL_TIMEOUT))}),this.inflateDataTimer&&window.clearInterval(this.inflateDataTimer),this.inflateDataTimer=window.setInterval(()=>{this.handleInflateData()},2e4),setTimeout(()=>{s&&this.openConnectionTime===void 0&&(D.debug("[".concat(this.clientId,"] init datachannel timeout while join with failback to websocket")),u(new ae(z.INIT_DATACHANNEL_TIMEOUT)))},te("DC_JOIN_WITH_FAILBACK"))})}close(i){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.inflateDataTimer&&(this.handleInflateData(),window.clearInterval(this.inflateDataTimer),this.inflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=i||Pt.LEAVE,this.connectionState=It.CLOSED,D.debug("[".concat(this.clientId,"] ")+"will close datachannel in signal"),this.websocket.close(),i===Pt.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new PH("gateway-".concat(this.clientId),this.spec.retryConfig,!0,this.store),this.handleWebsocketEvents())}async join(){if(!this.joinResponse){this.emit(Be.ABORT_P2P_EXECUTION);const i=await Qn(this,Be.DATACHANNEL_CONNECTING),s=await this.request(nt.JOIN,i);if(!s)return this.emit(Be.REPORT_JOIN_GATEWAY,z.TIMEOUT,this.url||""),!1;this.joinResponse=s,this.emit(Be.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=It.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new ae(z.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const i=ad(this,Be.REQUEST_REJOIN_INFO);i.token=this.reconnectToken;const s=await this.request(nt.REJOIN,i);return!!s&&(this.connectionState=It.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),s.peers&&s.peers.forEach(a=>{this.emit(St.ON_USER_ONLINE,{uid:a.uid}),a.audio&&this.emit(St.ON_ADD_AUDIO_STREAM,{uid:a.uid,uint_id:a.uint_id,audio:!0,ssrcId:a.audio_ssrc}),a.video&&this.emit(St.ON_ADD_VIDEO_STREAM,{uid:a.uid,uint_id:a.uint_id,video:!0,ssrcId:a.video_ssrc}),a.audio_mute?this.emit(St.MUTE_AUDIO,{uid:a.uid}):this.emit(St.UNMUTE_AUDIO,{uid:a.uid}),a.video_mute?this.emit(St.MUTE_VIDEO,{uid:a.uid}):this.emit(St.UNMUTE_VIDEO,{uid:a.uid}),a.audio_enable_local?this.emit(St.ENABLE_LOCAL_AUDIO,{uid:a.uid}):this.emit(St.DISABLE_LOCAL_AUDIO,{uid:a.uid}),a.video_enable_local?this.emit(St.ENABLE_LOCAL_VIDEO,{uid:a.uid}):this.emit(St.DISABLE_LOCAL_VIDEO,{uid:a.uid}),a.audio||a.video||this.emit(St.ON_REMOVE_STREAM,{uid:a.uid,uint_id:a.uint_id})}),!0)}reconnect(i,s){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(i,s)}handleNotification(i){D.debug("[".concat(this.clientId,"] receive notification: "),i);const s=Xp(i.code);if(s.action!=="success"){if(s.action!=="failed")return s.action==="quit"?(s.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(Pt.UID_BANNED),void this.close()):void this.reconnect(s.action,Ql.SERVER_ERROR);D.error("[".concat(this.clientId,"] ignore error: "),s.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const i=te("PING_PONG_TIME_OUT"),s=Date.now();this.pingpongTimeoutCount>=i&&(D.warning("PINGPONG Timeout. Last Socket Message: ".concat(s-this.lastMsgTime,"ms")),s-this.lastMsgTime>te("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",Ql.TIMEOUT):this.request(nt.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const a=Date.now()-s;this.rttRolling.add(a),te("REPORT_STATS")&&this.send(nt.PING_BACK,{pingpongElapse:a})}).catch(a=>{})}handleInflateData(){const{inflateLength:i,deflateLength:s}=this.websocket.getInflateData();i!==0&&s!==0&&this.upload(lo.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:s,ws_inflate_length:i})}handleWebsocketEvents(){this.websocket.on(hi.RECONNECT_WAITTING_FINISH,i=>{this.emit(Be.WS_RECONNECT_WAITTING_FINISH,i)}),this.websocket.on(hi.RECONNECT_CREATE_CONNECTION,i=>{this.emit(Be.WS_RECONNECT_CREATE_CONNECTION,i)}),this.websocket.on(hi.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(hi.CLOSED,()=>{this.connectionState=It.CLOSED}),this.websocket.on(hi.FAILED,()=>{this._disconnectedReason=Pt.NETWORK_ERROR,this.connectionState=It.CLOSED}),this.websocket.on(hi.RECONNECTING,i=>{this._websocketReconnectReason=i,this.joinResponse=void 0,this.connectionState===It.CONNECTED?this.connectionState=It.RECONNECTING:this.connectionState=It.CONNECTING}),this.websocket.on(hi.WILL_RECONNECT,(i,s)=>{if(ad(this,Be.IS_P2P_DISCONNECTED)&&i==="retry")return D.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),this.reconnectToken=void 0,this.emit(Be.NEED_RENEW_SESSION),this.emit(Be.DISCONNECT_P2P),s("tryNext");i!=="retry"&&(D.debug("".concat(this.clientId," websockt will_connect event, renewSession reconnectMode is ").concat(i)),this.reconnectToken=void 0,this.emit(Be.NEED_RENEW_SESSION),this.emit(Be.DISCONNECT_P2P)),s(i)}),this.websocket.on(hi.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(i=>{D.warning("[".concat(this.clientId,"] rejoin failed ").concat(i)),this.reconnect("tryNext",Ql.SERVER_ERROR)}):this.join().catch(i=>{if(this.emit(Be.REPORT_JOIN_GATEWAY,i.message||i.code,this.url||""),i instanceof ae&&i.code===z.UNEXPECTED_RESPONSE&&i.data.code===lt.ERR_NO_AUTHORIZED)return D.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",Ql.SERVER_ERROR);D.error("[".concat(this.clientId,"] join gateway request failed"),i.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",Ql.SERVER_ERROR):(this.initError=i,this.close())})}),this.websocket.on(hi.REQUEST_NEW_URLS,(i,s)=>{Qn(this,Be.REQUEST_RECOVER,this.multiIpOption).then(i).catch(s)}),this.websocket.on(hi.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(St.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}),this.websocket.on(hi.TO_CONNECT_DATACHANNEL,async(i,s,a)=>Qn(this,Be.DATACHANNEL_PRECONNECT,i).then(s).catch(a)),this.websocket.on(hi.FAILBACK,()=>{this.openConnectionTime!==void 0&&this.emit(Be.DATACHANNEL_FAILBACK)})}}class XI extends Hn{constructor(i){super(),O(this,"_signal",void 0),O(this,"_sequence",0),O(this,"_userMap",new Map),O(this,"_encoder",new TextEncoder),this._signal=i}async send(i,s,a,u,h){var p,_,v;typeof s!="string"&&(s=JSON.stringify(s)),u=(p=u)!==null&&p!==void 0?p:wn(6,""),h=(_=h)!==null&&_!==void 0?_:this._sequence++;const T={_id:u,_type:i,_seq:(v=h)!==null&&v!==void 0?v:this._sequence++,_message:s};if(te("SHOW_P2P_LOG")&&D.debug("send message",T),this.sendStreamMessage(JSON.stringify(T)),a)return;const b=new le((N,x)=>{const B=window.setTimeout(()=>{this.off("res-@".concat(u),F),D.warning("[external-signal] request timeout, type: ".concat(i)),this._userMap.size===0?x(new Ee(z.INVALID_REMOTE_USER)):x(new Ee(z.TIMEOUT))},te("EXTERNAL_SIGNAL_REQUEST_TIMEOUT")),F=(H,J)=>{B&&window.clearTimeout(B),H==="success"?N({isSuccess:!0,message:J}):x(new Ee(z.UNEXPECTED_ERROR,J))};this.once("res-@".concat(u),F)});let C;try{C=await b}catch(N){if(N.code===z.TIMEOUT)return await this.send(i,s,!1,u,h);throw N}return C.isSuccess?C.message:void 0}sendStreamMessage(i){this._splitMessage(i).forEach(s=>{this._signal.request(nt.DATA_STREAM,{payload:rI(this._encoder.encode(s))})})}onMessage(i){const{_uid:s}=i;let a;const u=this._userMap.get(s);if(u?a=u.splitMessageMap:(a=new Map,this._userMap.set(s,{isStart:!1,splitMessageMap:a,nextExpectedSequenceNumber:0,receivedMessagesMap:new Map})),"id"in i&&"total"in i){var h;const{id:p,total:_}=i,v=(h=a.get(p))!==null&&h!==void 0?h:[];if(v.push(i),a.has(p)||a.set(p,v),v.length!==_)return;{const T=Up(v).call(v,(b,C)=>b.index-C.index).map(b=>b.payload).join("");a.delete(p),(i=JSON.parse(T))._uid=s}}this.handleReceivedMessage(i)}setStart(i){this._userMap.has(i)?this._userMap.get(i).isStart=!0:this._userMap.set(i,{isStart:!0,splitMessageMap:new Map,nextExpectedSequenceNumber:0,receivedMessagesMap:new Map}),this.handleReceivedMessage()}setEnd(i){return this._userMap.delete(i),this._userMap.size===0}ack(i,s,a){this.send(Pn.ACK,JSON.stringify({success:!a,message:s}),!0,i)}handleReceivedMessage(i){const s=()=>{this._userMap.forEach(T=>{const{receivedMessagesMap:b,nextExpectedSequenceNumber:C}=T;for(;b.has(C);){const N=b.get(C);b.delete(C),this.receiveMessage(N),T.nextExpectedSequenceNumber++}})};if(!i)return void s();const{_uid:a,_seq:u}=i,h=this._userMap.get(a),{receivedMessagesMap:p,isStart:_,nextExpectedSequenceNumber:v}=h;u<v?D.debug("[external-signal] receive old message, seq: ".concat(u)):(p.set(u,i),_&&u===v&&(this.receiveMessage(i),p.delete(v),h.nextExpectedSequenceNumber++,s()))}receiveMessage(i){const{_id:s,_type:a,_message:u,_uid:h}=i;if(te("SHOW_P2P_LOG")&&D.debug("收到消息",i),s)switch(i._type){case Pn.PUBLISH:const p=JSON.parse(u);this._signal.emit(a,p,h),this.ack(i._id);break;case Pn.CONTROL:case Pn.UNPUBLISH:case Pn.DO_SUBSCRIBE:case Pn.DO_UNSUBSCRIBE:{const _=JSON.parse(u);_.uid=h,Qn(this._signal,a,_).then(v=>{this.ack(i._id,v)}).catch(v=>{this.ack(i._id,void 0,!0)});break}case Pn.ACK:{const{success:_,message:v}=JSON.parse(u);this.emit("res-@".concat(s),_?"success":"failed",v);break}case Pn.CALL:Qn(this,a,u).then(_=>{this.ack(s,_)});break;case Pn.RESTART_ICE:case Pn.EXCHANGE_SDP:case Pn.SUBSCRIBE:case Pn.UNSUBSCRIBE:Qn(this._signal,a,u).then(_=>{this.ack(s,_)}).catch(_=>{this.ack(i._id,void 0,!0)});break;case Pn.CANDIDATE:this._signal.emit(a,u),this.ack(s);break;case Pn.JOIN:this.emit(a,JSON.parse(u));break;default:this.emit(a,u),this.ack(s)}}_splitMessage(i){if(i.length<XI.MAX_MESSAGE_SIZE)return[i];const s=[],a=wn(6,"");let u=0;const h=Math.ceil(i.length/800);for(;i.length>0;){u++;const p=i.slice(0,800);s.push({id:a,index:u,total:h,payload:p}),i=i.slice(800)}return s.map(p=>JSON.stringify(p))}clear(){this._sequence=0,this._userMap.clear()}}O(XI,"MAX_MESSAGE_SIZE",1024);class xH extends Hn{get connectionState(){return this._connectionState}set connectionState(i){i!==this._connectionState&&(this._connectionState=i,i===It.CONNECTED?this.emit(Be.WS_CONNECTED):i===It.RECONNECTING?this.emit(Be.WS_RECONNECTING,this._websocketReconnectReason):i===It.CLOSED&&this.emit(Be.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(i,s){super(),O(this,"_disconnectedReason",void 0),O(this,"_websocketReconnectReason",void 0),O(this,"_connectionState",It.CLOSED),O(this,"reconnectToken",void 0),O(this,"_userInRoom",!1),O(this,"_userOnlineTime",void 0),O(this,"websocket",void 0),O(this,"openConnectionTime",void 0),O(this,"clientId",void 0),O(this,"lastMsgTime",Date.now()),O(this,"uploadCache",[]),O(this,"uploadCacheInterval",void 0),O(this,"rttRolling",new JM(5)),O(this,"pingpongTimer",void 0),O(this,"wsInflateDataTimer",void 0),O(this,"pingpongTimeoutCount",0),O(this,"joinResponse",void 0),O(this,"multiIpOption",void 0),O(this,"initError",void 0),O(this,"spec",void 0),O(this,"store",void 0),O(this,"_external_signal",void 0),O(this,"onWebsocketMessage",a=>{if(a.data instanceof ArrayBuffer)return void this.emit(Be.ON_BINARY_DATA,a.data);const u=JSON.parse(a.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(u,"_id")){const h="res-@".concat(u._id);this.emit(h,u._result,u._message)}else if(Object.prototype.hasOwnProperty.call(u,"_type")){switch(u._type){case St.ON_DATA_STREAM:return void this.handleDataStream(u._message);case St.MUTE_AUDIO:case St.MUTE_VIDEO:case St.ON_P2P_LOST:return;case St.ON_USER_ONLINE:this.emit(u._type,u._message);const{uid:h}=u._message;return this._external_signal.setStart(h),void this._external_signal.send(Pn.JOIN,{onlineTime:this._userOnlineTime},!0)}if(this.emit(u._type,u._message),u._type===St.ON_NOTIFICATION&&this.handleNotification(u._message),u._type===St.ON_USER_BANNED)switch(u._message.error_code){case 14:this.close(Pt.UID_BANNED);break;case 15:this.close(Pt.IP_BANNED);break;case 16:this.close(Pt.CHANNEL_BANNED)}if(u._type===St.ON_USER_LICENSE_BANNED)switch(u._message.error_code){case lt.ERR_LICENSE_MISSING:this.close(Pt.LICENSE_MISSING);break;case lt.ERR_LICENSE_EXPIRED:this.close(Pt.LICENSE_EXPIRED);break;case lt.ERR_LICENSE_MINUTES_EXCEEDED:this.close(Pt.LICENSE_MINUTES_EXCEEDED);break;case lt.ERR_LICENSE_PERIOD_INVALID:this.close(Pt.LICENSE_PERIOD_INVALID);break;case lt.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(Pt.LICENSE_MULTIPLE_SDK_SERVICE);break;case lt.ERR_LICENSE_ILLEGAL:this.close(Pt.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=i.clientId,this.spec=i,this.store=s,this.websocket=new X0("gateway-".concat(this.clientId),this.spec.retryConfig,!0,te("JOIN_GATEWAY_USE_DUAL_DOMAIN"),te("JOIN_GATEWAY_USE_443PORT_ONLY"),s),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===It.CONNECTED&&this.reconnect("retry",ir.OFFLINE)}),this._external_signal=new XI(this),this._handleSignalP2PEvents()}async request(i,s,a,u){const h=wn(6,""),p={_id:h,_type:i,_message:s},_=this.websocket.connectionID,v=()=>new le((B,F)=>{if(this.connectionState===It.CONNECTED)return B();const H=()=>{this.off(Be.WS_CLOSED,J),B()},J=()=>{this.off(Be.WS_CONNECTED,H),F(new Ee(z.WS_ABORT))};this.once(Be.WS_CONNECTED,H),this.once(Be.WS_CLOSED,J),i!==nt.PUBLISH&&i!==nt.SUBSCRIBE&&i!==nt.UNSUBSCRIBE&&i!==nt.UNPUBLISH&&i!==nt.CONTROL&&i!==nt.RESTART_ICE||this.once(Be.DISCONNECT_P2P,()=>{F(new Ee(z.DISCONNECT_P2P))}),i!==nt.PUBLISH&&i!==nt.RESTART_ICE||this.once(Be.ABORT_P2P_EXECUTION,()=>{F(new Ee(z.DISCONNECT_P2P))})});if(this.connectionState!==It.CONNECTING&&this.connectionState!==It.RECONNECTING||i===nt.JOIN||i===nt.REJOIN||await v(),this.websocket.sendMessage(p,!0),u)return;const T=new le((B,F)=>{let H=!1;const J=(se,ye)=>{H=!0,B({isSuccess:se==="success",message:ye||{}}),this.off(Be.WS_CLOSED,ee),this.off(Be.WS_RECONNECTING,ee),this.emit(Be.REQUEST_SUCCESS,i,s)};this.once("res-@".concat(h),J);const ee=()=>{F(new Ee(z.WS_ABORT,"type: ".concat(i))),this.off(Be.WS_CLOSED,ee),this.off(Be.WS_RECONNECTING,ee),this.off("res-@".concat(h),J)};this.once(Be.WS_CLOSED,ee),this.once(Be.WS_RECONNECTING,ee),xr(te("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==_||H||(D.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(i)),this.emit(Be.REQUEST_TIMEOUT,i,s))})});let b=null;try{b=await T}catch(B){if(this.connectionState===It.CLOSED||i===nt.LEAVE)throw new Ee(z.WS_ABORT);return!this.spec.forceWaitGatewayResponse||a?B.throw():i===nt.JOIN||i===nt.REJOIN?null:(await v(),await this.request(i,s))}if(b.isSuccess)return b.message;const C=Number(b.message.error_code||b.message.code),N=Xp(C),x=new Ee(z.UNEXPECTED_RESPONSE,"".concat(N.desc,": ").concat(b.message.error_str),{code:C,data:b.message});return N.action==="success"?b.message:(D.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(i,", error_code: ").concat(C,", message: ").concat(N.desc,", action: ").concat(N.action)),C===lt.ERR_TOO_MANY_BROADCASTERS?((i===nt.JOIN||i===nt.REJOIN)&&(this.initError=x,this.close()),x.throw()):N.action==="failed"?x.throw():N.action==="quit"?(this.initError=x,this.close(),x.throw()):(C===lt.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=b.message.option,D.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",ir.MULTI_IP)):this.reconnect(N.action,ir.SERVER_ERROR),i===nt.JOIN||i===nt.REJOIN?null:await this.request(i,s)))}waitMessage(i,s){return new le(a=>{const u=h=>{(!s||s(h))&&(this.off(i,u),a(h))};this.on(i,u)})}upload(i,s){const a={_type:i,_message:s};try{this.websocket.sendMessage(a)}catch{const h=te("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(a),this.uploadCache.length>h&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==It.CONNECTED)return;const p=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(p._type,p._message)},te("UPLOAD_CACHE_INTERVAL")||2e3))}}send(i,s){const a={_type:i,_message:s};this.websocket.sendMessage(a)}async sendExtensionMessage(i,s,a){return await this.waitTillUserOnline(),await this._external_signal.send(i,s,a)}init(i,s){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new le((a,u)=>{this.once(Be.WS_CONNECTED,()=>a(this.joinResponse)),this.once(Be.WS_CLOSED,()=>u(this.initError||new Ee(z.WS_ABORT))),this.connectionState=It.CONNECTING,this.websocket.init(i).catch(u),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4)})}close(i){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=i||Pt.LEAVE,this.connectionState=It.CLOSED,D.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),i===Pt.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new X0("gateway-".concat(this.clientId),this.spec.retryConfig,!0,te("JOIN_GATEWAY_USE_DUAL_DOMAIN"),te("JOIN_GATEWAY_USE_443PORT_ONLY"),this.store),this.handleWebsocketEvents())}async join(){if(!this.joinResponse){this.emit(Be.ABORT_P2P_EXECUTION);const i=await Qn(this,Be.REQUEST_JOIN_INFO),s=await this.request(nt.JOIN,i);if(!s)return this.emit(Be.REPORT_JOIN_GATEWAY,z.TIMEOUT,this.url||""),!1;this.joinResponse=s,this.emit(Be.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=It.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),this._userOnlineTime=new Date().getTime(),this._external_signal.clear(),!0}async rejoin(){if(!this.reconnectToken)throw new Ee(z.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const i=ad(this,Be.REQUEST_REJOIN_INFO);return i.token=this.reconnectToken,!!await this.request(nt.REJOIN,i)&&(this.connectionState=It.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0)}reconnect(i,s){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(i,s)}handleDataStream(i){try{var s;const a=iI(i.payload),u=new TextDecoder().decode(a),h=JSON.parse(u);"total"in h&&"id"in h||ot(s=Object.values(Pn)).call(s,h._type)?(i.seq&&delete i.seq,h._uid=i.uid,this._external_signal.onMessage(h)):this.emit(St.ON_DATA_STREAM,i)}catch{}}handleNotification(i){D.debug("[".concat(this.clientId,"] receive notification: "),i);const s=Xp(i.code);if(s.action!=="success"){if(s.action!=="failed")return s.action==="quit"?(s.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(Pt.UID_BANNED),void this.close()):void this.reconnect(s.action,ir.SERVER_ERROR);D.error("[".concat(this.clientId,"] ignore error: "),s.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const i=te("PING_PONG_TIME_OUT"),s=Date.now();this.pingpongTimeoutCount>=i&&(D.warning("[".concat(this.clientId,"] PINGPONG Timeout. Last Socket Message: ").concat(s-this.lastMsgTime,"ms")),s-this.lastMsgTime>te("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",ir.TIMEOUT):this.request(nt.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const a=Date.now()-s;this.rttRolling.add(a),te("REPORT_STATS")&&this.send(nt.PING_BACK,{pingpongElapse:a})}).catch(a=>{})}handleWsInflateData(){const{wsInflateLength:i,wsDeflateLength:s}=this.websocket.getWsInflateData();i!==0&&s!==0&&this.upload(lo.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:s,ws_inflate_length:i})}handleWebsocketEvents(){this.websocket.on(mt.RECONNECT_WAITTING_FINISH,i=>{this.emit(Be.WS_RECONNECT_WAITTING_FINISH,i)}),this.websocket.on(mt.RECONNECT_CREATE_CONNECTION,i=>{this.emit(Be.WS_RECONNECT_CREATE_CONNECTION,i)}),this.websocket.on(mt.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(mt.CLOSED,()=>{this.connectionState=It.CLOSED}),this.websocket.on(mt.FAILED,()=>{this._disconnectedReason=Pt.NETWORK_ERROR,this.connectionState=It.CLOSED}),this.websocket.on(mt.RECONNECTING,i=>{this._websocketReconnectReason=i,this.joinResponse=void 0,this.connectionState===It.CONNECTED?this.connectionState=It.RECONNECTING:this.connectionState=It.CONNECTING}),this.websocket.on(mt.WILL_RECONNECT,(i,s,a)=>{if(ad(this,Be.IS_P2P_DISCONNECTED)&&i==="retry")return D.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),this.reconnectToken=void 0,this.emit(Be.NEED_RENEW_SESSION),this.emit(Be.DISCONNECT_P2P),a("tryNext");i!=="retry"&&(D.debug("".concat(this.clientId," websocket will_connect event, renewSession reconnectMode is ").concat(i)),this.reconnectToken=void 0,this.emit(Be.NEED_RENEW_SESSION),this.emit(Be.DISCONNECT_P2P)),a(i)}),this.websocket.on(mt.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(i=>{D.warning("[".concat(this.clientId,"] rejoin failed ").concat(i)),this.reconnect("tryNext",ir.SERVER_ERROR)}):this.join().catch(i=>{if(this.emit(Be.REPORT_JOIN_GATEWAY,i.message||i.code,this.url||""),i instanceof Ee&&i.code===z.UNEXPECTED_RESPONSE&&i.data.code===lt.ERR_NO_AUTHORIZED)return D.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",ir.SERVER_ERROR);D.error("[".concat(this.clientId,"] join gateway request failed"),i.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",ir.SERVER_ERROR):(this.initError=i,this.close())})}),this.websocket.on(mt.REQUEST_NEW_URLS,(i,s)=>{Qn(this,Be.REQUEST_RECOVER,this.multiIpOption).then(i).catch(s)}),this.websocket.on(mt.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(St.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})}_handleSignalP2PEvents(){this._external_signal.on(Pn.JOIN,async i=>{if(this._userOnlineTime&&this._userOnlineTime<i.onlineTime){const s=await Qn(this,Be.P2P_START,void 0),a=await this._external_signal.send(Pn.CALL,s);this.emit(Be.P2P_CONNECTION,a,!0)}this._userInRoom=!0,this.emit("user-online")}),this.on(St.ON_USER_OFFLINE,async i=>{this._external_signal.clear(),this._userInRoom=!1}),this._external_signal.on(Pn.CALL,async(i,s,a)=>{this._userInRoom=!0,this.emit("user-online");try{s(await Qn(this,Be.P2P_START,i))}catch(u){a(u)}})}async waitTillUserOnline(){return new le(i=>{if(this._userInRoom)i();else{const s=()=>{this.off("user-online",s),i()};this.on("user-online",s)}})}}function DH(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function yc(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?DH(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):DH(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}const _U=new Map;class Xue extends Hn{get state(){return this._state}set state(i){if(i===this._state)return;const s=this._state;this._state=i,i==="DISCONNECTED"&&this._disconnectedReason?this.emit(ii.CONNECTION_STATE_CHANGE,i,s,this._disconnectedReason):this.emit(ii.CONNECTION_STATE_CHANGE,i,s)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(i){D.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(i)),this._joinGatewayStartTime=i}constructor(i,s){super(),O(this,"store",void 0),O(this,"joinInfo",void 0),O(this,"key",void 0),O(this,"ntpOffset",0),O(this,"signal",void 0),O(this,"role",void 0),O(this,"inChannelInfo",{joinAt:null,duration:0}),O(this,"spec",void 0),O(this,"_state","DISCONNECTED"),O(this,"_statsCollector",void 0),O(this,"_disconnectedReason",void 0),O(this,"isSignalRecover",!1),O(this,"hasChangeBGPAddress",!1),O(this,"trafficStatsInterval",void 0),O(this,"networkQualityInterval",void 0),O(this,"_joinGatewayStartTime",0),O(this,"_signalTimeout",!1),O(this,"_clientRoleOptions",void 0),O(this,"_isProactiveJoin",!1),this.store=i,this.spec=s,this.signal=this.store.useP2P?new xH(yc(yc({},s),{},{retryConfig:s.websocketRetryConfig}),i):this.store.useDataChannel?new fd(yc(yc({},s),{},{retryConfig:s.websocketRetryConfig}),i):new JW(yc(yc({},s),{},{retryConfig:s.websocketRetryConfig}),i),this._statsCollector=s.statsCollector,this.role=s.role||"audience",this._clientRoleOptions=s.clientRoleOptions,this.handleSignalEvents()}async join(i,s,a){if(this.signal instanceof fd){let v=!1;i.cloudProxyServer!=="disabled"?(D.debug("[".concat(this.store.clientId,"] Dc is not supported, because cloudProxyServer are not supported (").concat(i.cloudProxyServer,")")),v=!0):"".concat(i.apResponse.cid,"_").concat(i.apResponse.cert).length>255||"".concat(i.apResponse.cid,"_").concat(i.apResponse.cert).length<22?(D.debug("[".concat(this.store.clientId,"] Dc is not supported, because ticket length is incorrect, it has to be between 22 and 255")),v=!0):i.apResponse.addresses.some(T=>T.fingerprint)||te("FINGERPRINT")||(D.debug("[".concat(this.store.clientId,"] Dc is not supported, because fingerprint does not exist")),v=!0),v&&this.resetSignal()}this.store.joinGatewayStart(),i.cloudProxyServer!=="disabled"&&(this.hasChangeBGPAddress=!0);const u=Date.now();let h=_U.get(i.cname);if(h||(h=new Map,_U.set(i.cname,h)),this._isProactiveJoin=!0,h.has(i.uid)){const v=new ae(z.UID_CONFLICT);throw it.joinGateway(i.sid,{lts:u,succ:!1,ec:v.message,addr:null,uid:i.uid,cid:i.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!i.proxyServer,signalChannel:this.signal instanceof fd?"1":"0"}),this._isProactiveJoin=!1,v}h.set(i.uid,!0),this.joinInfo=i,this.key=s;let p=0;this.joinGatewayStartTime=u;const _=i.proxyServer;try{let v;if(D.debug("[".concat(this.store.clientId,"] use ").concat(this.signal instanceof fd?"datachannel":"websocket"," join uid ").concat(p)),this.signal instanceof fd)v=await this.signal.init(i.apResponse.addresses,a);else{const T=i.gatewayAddrs.map(b=>{let{address:C}=b;const[N,x]=C.split(":"),B={host:N,port:x};return i.proxyServer&&(B.proxy=i.proxyServer),B});v=await this.signal.init(T,a)}p=v.uid,D.debug("[".concat(this.store.clientId,"] ").concat(this.signal instanceof fd?"datachannel":"websocket"," join uid ").concat(p," cost ").concat(Date.now()-this.joinGatewayStartTime))}catch(v){throw v&&v.code===z.INIT_WEBSOCKET_TIMEOUT?(D.warning("[".concat(this.store.clientId,"] User join failed"),v.toString()),v):v&&v.code===z.INIT_DATACHANNEL_TIMEOUT?(D.warning("[".concat(this.store.clientId,"] User join datachannel failed"),v.toString()),this.resetSignal(),v):(D.error("[".concat(this.store.clientId,"] User join failed"),v.toString()),it.joinGateway(i.sid,{lts:u,succ:!1,ec:v.message,addr:this.signal.url,uid:i.uid,cid:i.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!_,signalChannel:this.signal instanceof fd?"1":"0"}),this._isProactiveJoin=!1,h.delete(i.uid),this.signal.close(),v)}return this.state="CONNECTED",this.inChannelInfo.joinAt=Date.now(),D.debug("[".concat(this.store.clientId,"] Connected to gateway server")),this.trafficStatsInterval=window.setInterval(()=>{this.updateTrafficStats().catch(v=>{D.warning("[".concat(this.store.clientId,"] get traffic stats error"),v.toString())})},3e3),this.networkQualityInterval=window.setInterval(()=>{navigator&&navigator.onLine!==void 0&&!navigator.onLine?this.emit(ii.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):this._signalTimeout?this.emit(ii.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):this.state==="CONNECTED"&&this._statsCollector.trafficStats?this.emit(ii.NETWORK_QUALITY,{uplinkNetworkQuality:OH(this._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:OH(this._statsCollector.trafficStats.B_dnq)}):this.emit(ii.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})},2e3),this.store.joinGatewayEnd(),p}async leave(){let i=arguments.length>0&&arguments[0]!==void 0&&arguments[0],s=arguments.length>1?arguments[1]:void 0;if(this.state!=="DISCONNECTED"){s!==Pt.FALLBACK&&(this.state="DISCONNECTING");try{i||this.signal.connectionState!==It.CONNECTED||await function(a,u){return u===1/0?a:le.race([a,nce(u)])}(this.signal.request(nt.LEAVE,void 0,!0),3e3)}catch(a){D.warning("[".concat(this.store.clientId,"] leave request failed, ignore"),a)}this.signal.close(s),s!==Pt.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}}async publish(i,s,a){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new ae(z.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const u={state:"offer",p2p_id:this.store.p2pId,ortc:s,mode:this.spec.mode,extend:te("PUB_EXTEND"),twcc:!!te("PUBLISH_TWCC"),rtx:!!te("USE_PUB_RTX")};try{return(await this.signal.request(nt.PUBLISH,u,!0))._message}catch(h){if(a&&h.data&&h.data.code===lt.ERR_PUBLISH_REQUEST_INVALID)return D.warning("[".concat(this.store.clientId,"] receive publish error code, retry"),h.toString()),await this.tryUnpubBeforeRepub(i,s),this.publish(i,s,!1);throw h}}async publishDataChannel(i,s,a){var u;if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new ae(z.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const h={stream_id:s.streamId,ordered:s.ordered?1:0,max_retrans_times:(u=s.maxRetransmits)!==null&&u!==void 0?u:10,channel_id:s.channelId,metadata:s.metadata};try{await this.signal.request(nt.PUBLISH_DATASTREAM,h,!0)}catch(p){if(a&&p.data&&p.data.code===lt.ERR_PUBLISH_REQUEST_INVALID)return D.warning("[".concat(this.store.clientId,"] receive publish datachannels error code, retry"),p.toString()),await this.tryUnpubDataChannelBeforeRepub(i,s),this.publishDataChannel(i,s,!1);throw p}}async unpublish(i,s){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new ae(z.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await this.signal.request(nt.UNPUBLISH,{stream_id:s,ortc:i},!0)}catch(a){D.warning("[".concat(this.store.clientId,"] unpublish warning: "),a)}}async unpublishDataChannel(i){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new ae(z.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await le.all(i.map(s=>this.signal.request(nt.UNPUBLISH_DATASTREAM,{channel_id:s},!0)))}catch(s){D.warning("unpublish datachannels warning: ",s)}}async subscribe(i,s,a){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new ae(z.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state));const u={stream_id:i,stream_type:s.stream_type,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!te("SUBSCRIBE_TWCC"),rtx:!!te("USE_SUB_RTX"),extend:te("SUB_EXTEND"),ssrcId:s.ssrcId,svc:Array.isArray(te("SVC"))&&te("SVC").length!==0?te("SVC"):void 0};try{return(await this.signal.request(nt.SUBSCRIBE,u,!0))._message}catch(h){if(a&&h.data&&h.data.code===lt.ERR_SUBSCRIBE_REQUEST_INVALID)return D.warning("[".concat(this.store.clientId,"] receiver subscribe error code, retry"),h.toString()),await this.tryUnsubBeforeResub(i,s),await this.subscribe(i,s,!1);throw h}}async subscribeDataChannel(i,s,a){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new ae(z.INVALID_OPERATION,"can not subscribe datachannel when connection state is ".concat(this.state));const u={uid:i,stream_id:s.id,channel_id:s.datachannelId};try{return void await this.signal.request(nt.SUBSCRIBE_DATASTREAM,u,!0)}catch(h){if(a&&h.data&&h.data.code===lt.ERR_SUBSCRIBE_REQUEST_INVALID)return D.warning("[".concat(this.store.clientId,"] receiver subscribe datachannel error code, retry"),h.toString()),await this.tryUnsubDataChannelBeforeResub(i,s),await this.subscribeDataChannel(i,s,!1);throw h}}async subscribeAll(i,s){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new ae(z.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(this.state));const a={p2p_id:this.store.p2pId,users:i,dtx:!1,rtx:!!te("USE_SUB_RTX")};try{return await this.signal.request(nt.SUBSCRIBE_STREAMS,a,!0)}catch(u){if(s&&u.data&&u.data.code===lt.ERR_SUBSCRIBE_REQUEST_INVALID)return D.warning("[".concat(this.store.clientId,"] receiver massSubscribe error code, retry"),u.toString()),await this.tryMassUnsubBeforeResub(i),await this.subscribeAll(i,!1);throw u}}async setVideoProfile(i){const s=function(a){if(!(a.bitrateMax&&a.bitrateMin&&a.frameRate&&a.height&&a.width))return;let u=a.frameRate,h=a.width,p=a.height,_=!0;return typeof u!="number"&&(u=u.exact||u.ideal||u.max||u.min||0,u||(_=!1)),typeof h!="number"&&(h=h.exact||h.ideal||h.max||h.min||0,h||(_=!1)),typeof p!="number"&&(p=p.exact||p.ideal||p.max||p.min||0,u||(_=!1)),_?{stream_type:0,width:h,height:p,fps:u,start_bps:1e3*a.bitrateMax,min_bps:1e3*a.bitrateMin,target_bps:1e3*a.bitrateMax}:void 0}(i);if(s)return this.signal.request(nt.SET_VIDEO_PROFILE,s);D.debug("[".concat(this.store.clientId,"] encoder config is not complete, do not report to gateway"))}async unsubscribe(i,s){try{await this.signal.request(nt.UNSUBSCRIBE,{p2p_id:this.store.p2pId,ortc:i,stream_id:s},!0)}catch(a){D.warning("[".concat(this.store.clientId,"] unsubscribe warning: "),a)}}async unsubscribeDataChannel(i,s){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new ae(z.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await le.all(i.map(a=>this.signal.request(nt.UNSUBSCRIBE_DATASTREAM,{stream_id:a,uid:s},!0)))}catch(a){D.warning("unsubscribeDataChannel warning: ",a)}}async massUnsubscribe(i){try{await this.signal.request(nt.UNSUBSCRIBE_STREAMS,i,!0)}catch(s){D.warning("[".concat(this.store.clientId,"] massUnsubscribeAll warning: "),s)}}async reconnectPC(i){const{iceParameters:s,dtlsParameters:a,rtpCapabilities:u}=i;return{gatewayEstablishParams:await this.signal.request(nt.CONNECT_PC,{p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:{iceParameters:s,dtlsParameters:a,rtpCapabilities:u}},!0),gatewayAddress:this.getCurrentGatewayAddress()}}getGatewayInfo(){return this.signal.request(nt.GATEWAY_INFO)}async renewToken(i){await this.signal.request(nt.RENEW_TOKEN,i),this.key=i.token}async setClientRole(i,s){if(s&&(this._clientRoleOptions=Object.assign({},s)),this.state!=="CONNECTED")return void(this.role=i);let a,u=0;i==="audience"?this._clientRoleOptions&&this._clientRoleOptions.delay?(a=this._clientRoleOptions.delay,u=1):u=this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:u=0,await this.signal.request(nt.SET_CLIENT_ROLE,{role:i,level:u,delay:a,client_ts:Date.now()}),this.role=i}async setRemoteVideoStreamType(i,s){await this.signal.request(nt.SWITCH_VIDEO_STREAM,{stream_id:i,stream_type:s})}async setDefaultRemoteVideoStreamType(i){await this.signal.request(nt.DEFAULT_VIDEO_STREAM,{stream_type:i})}async setStreamFallbackOption(i,s){await this.signal.request(nt.SET_FALLBACK_OPTION,{stream_id:i,fallback_type:s})}async pickSVCLayer(i,s){await this.signal.request(nt.PICK_SVC_LAYER,{stream_id:i,spatial_layer:s.spatialLayer,temporal_layer:s.temporalLayer})}async setRTM2Flag(i){await this.signal.request(nt.SET_RTM2_FLAG,{rtm2_flag:i})}async sendExtensionMessage(i,s,a){if(this.signal instanceof xH)return this.signal.sendExtensionMessage(i,s,a)}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),yc({},this.inChannelInfo)}async getGatewayVersion(){return(await this.signal.request(nt.GATEWAY_INFO)).version}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const i=_U.get(this.joinInfo.cname);i&&i.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const i=function(s){let a;return a=s.startsWith("dc")?s.match(/(dc\:\/\/)?([^:]+):(\d+)/):s.match(/(wss\:\/\/)?([^:]+):(\d+)/),a?{username:ra.username,password:ra.password,turnServerURL:a[2],tcpport:parseInt(a[3])+30,udpport:parseInt(a[3])+30,forceturn:!1}:null}((this.joinInfo.cloudProxyServer==="disabled"?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],i&&this.joinInfo.turnServer.mode!=="off"&&this.joinInfo.cloudProxyServer==="disabled"&&this.joinInfo.turnServer.serversFromGateway.push(yc(yc({},ra),{},{turnServerURL:i.turnServerURL,tcpport:i.tcpport,udpport:i.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}async updateTrafficStats(){if(this.state!=="CONNECTED")return;const i=await this.signal.request(nt.TRAFFIC_STATS,void 0,!0);i.timestamp=Date.now(),i.ntp_offset!=null&&(this.ntpOffset=i.ntp_offset),i.peer_delay.forEach(s=>{const a=this._statsCollector.trafficStats&&this._statsCollector.trafficStats.peer_delay.find(u=>u.peer_uid===s.peer_uid);a&&a.B_st!==s.B_st&&pc(()=>{this.emit(ii.STREAM_TYPE_CHANGE,s.peer_uid,s.B_st)})}),this._statsCollector.updateTrafficStats(i)}getJoinMessage(i){if(!this.joinInfo||!this.key)throw new ae(z.UNEXPECTED_ERROR,"can not generate join message, no join info");const s=Object.assign({},this.joinInfo.apResponse);let a=te("REPORT_APP_SCENARIO");if(typeof a!="string")try{a=JSON.stringify(a)}catch{a=void 0}a&&a.length>128&&(a=void 0);const u=yc({license:this.joinInfo.license,p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:Ua,browser:navigator.userAgent,process_id:te("PROCESS_ID"),mode:this.store.useP2P?"p2p":this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:s,extend:te("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:this.joinInfo.cloudProxyServer==="proxy3"?"1":this.joinInfo.cloudProxyServer==="proxy5"?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:a,attributes:{userAttributes:{enablePublishedUserList:te("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:te("MAX_SUBSCRIPTION"),subscribeAudioFilterTopN:typeof te("SUBSCRIBE_AUDIO_FILTER_TOPN")=="number"?te("SUBSCRIBE_AUDIO_FILTER_TOPN"):void 0,enablePublishAudioFilter:typeof te("ENABLE_PUBLISH_AUDIO_FILTER")=="boolean"?te("ENABLE_PUBLISH_AUDIO_FILTER"):void 0,enableUserLicenseCheck:typeof te("ENABLE_USER_LICENSE_CHECK")=="boolean"?te("ENABLE_USER_LICENSE_CHECK"):void 0,enableRTX:te("USE_PUB_RTX")===!0||te("USE_SUB_RTX")===!0||void 0,disableFEC:te("DISABLE_FEC"),enableNTPReport:!!te("ENABLE_NTP_REPORT")||void 0,enableInstantVideo:!!te("ENABLE_INSTANT_VIDEO")||void 0,enableDataStream2:typeof te("ENABLE_DATASTREAM_2")=="boolean"?te("ENABLE_DATASTREAM_2"):void 0,rtm2Flag:typeof te("RTM2_FLAG")=="number"?te("RTM2_FLAG"):void 0,enableUserAutoRebalanceCheck:!!te("ENABLE_USER_AUTO_REBALANCE_CHECK"),enableXR:typeof te("USE_XR")=="boolean"?te("USE_XR"):void 0}},join_ts:this.joinGatewayStartTime},i);return this.joinInfo.stringUid&&(u.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(u.aes_mode=this.joinInfo.aesmode,te("ENCRYPT_AES")?(u.aes_secret=this.joinInfo.aespassword,u.aes_encrypt=!0):u.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(u.aes_salt=this.joinInfo.aessalt)),s.addresses[this.signal.websocket.currentURLIndex]&&(u.ap_response.ticket=s.addresses[this.signal.websocket.currentURLIndex].ticket,delete s.addresses),this.joinInfo.defaultVideoStream!==void 0&&(u.default_video_stream=this.joinInfo.defaultVideoStream),u}getRejoinMessage(){if(!this.joinInfo)throw new ae(z.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){this.signal.on(Be.WS_RECONNECT_WAITTING_FINISH,i=>{var s;ot(s=["tryNext","recover"]).call(s,i)&&this.joinInfo&&it.adjustSessionStartTime(this.joinInfo.sid)}),this.signal.on(Be.WS_RECONNECT_CREATE_CONNECTION,i=>{this.joinGatewayStartTime=Date.now()}),this.signal.on(Be.WS_RECONNECTING,i=>{this.joinInfo&&it.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:i||ir.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",it.sessionInit(this.joinInfo.sid,{lts:new Date().getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())}),this.signal.on(Be.WS_CLOSED,i=>{let s;switch(i){case Pt.LEAVE:s=ir.LEAVE;break;case Pt.UID_BANNED:case Pt.IP_BANNED:case Pt.CHANNEL_BANNED:case Pt.SERVER_ERROR:s=ir.SERVER_ERROR;break;case Pt.FALLBACK:s=ir.FALLBACK;break;case Pt.LICENSE_MISSING:case Pt.LICENSE_EXPIRED:case Pt.LICENSE_MINUTES_EXCEEDED:case Pt.LICENSE_PERIOD_INVALID:case Pt.LICENSE_MULTIPLE_SDK_SERVICE:case Pt.LICENSE_ILLEGAL:case Pt.TOKEN_EXPIRE:s=i;break;default:s=ir.NETWORK_ERROR}D.debug("[".concat(this.store.clientId,"] [signal] websocket closed, reason: ").concat(s||"undefined -> "+ir.NETWORK_ERROR)),this.joinInfo&&it.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:i===Pt.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:s}),this._disconnectedReason=i,i!==Pt.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}),this.signal.on(Be.WS_CONNECTED,()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo&&(this.role==="audience"&&this._clientRoleOptions&&(this._clientRoleOptions.level||this._clientRoleOptions.delay)&&(D.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(this._clientRoleOptions.level,", delay: ").concat(this._clientRoleOptions.delay)),this.setClientRole(this.role,this._clientRoleOptions)),it.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:this.signal instanceof fd?"1":"0"}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint&&this.joinInfo.setLocalAPVersion===1)){const i=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!i)return void D.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(i));Sn("EVENT_REPORT_DOMAIN",i[1]),Sn("EVENT_REPORT_BACKUP_DOMAIN",i[1]),Sn("LOG_UPLOAD_SERVER","".concat(i[1],":6444"))}}),this.signal.on(St.ON_UPLINK_STATS,i=>{this._statsCollector.updateUplinkStats(i)}),this.signal.on(Be.REQUEST_RECOVER,(i,s,a)=>{if(!this.joinInfo)return a(new ae(z.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));i&&(this.joinInfo.multiIP=i,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,Qn(this,ii.REQUEST_NEW_GATEWAY_LIST).then(s).catch(a)}),this.signal.on(Be.REQUEST_JOIN_INFO,async i=>{var s;if(this.updateTurnConfigFromSignal(),this.store.useP2P)return void i(this.getJoinMessage({ortc:{}}));const{iceParameters:a,dtlsParameters:u,rtpCapabilities:h}=await Qn(this,ii.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:(s=this.joinInfo)===null||s===void 0?void 0:s.turnServer});i(this.getJoinMessage({ortc:{iceParameters:a,dtlsParameters:u,rtpCapabilities:h,version:"2"}}))}),this.signal.on(Be.REQUEST_REJOIN_INFO,i=>{i(this.getRejoinMessage())}),this.signal.on(Be.REPORT_JOIN_GATEWAY,(i,s)=>{this.joinInfo&&(it.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:i,addr:s,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:this.signal instanceof fd?"1":"0"}),this._isProactiveJoin=!1)}),this.signal.on(Be.IS_P2P_DISCONNECTED,i=>{i(ad(this,ii.IS_P2P_DISCONNECTED))}),this.signal.on(Be.DISCONNECT_P2P,()=>{this.emit(ii.DISCONNECT_P2P)}),this.signal.on(Be.NEED_RENEW_SESSION,()=>{this.emit(ii.NEED_RENEW_SESSION)}),this.signal.on(Be.REQUEST_SUCCESS,()=>{this._signalTimeout=!1}),this.signal.on(Be.REQUEST_TIMEOUT,()=>{this._signalTimeout=!0}),this.signal.on(Be.JOIN_RESPONSE,i=>{const s=this.getCurrentGatewayAddress();this.emit(ii.JOIN_RESPONSE,i,s)}),this.signal.on(Be.DATACHANNEL_PRECONNECT,async(i,s,a)=>{this.updateTurnConfigFromSignal();const u=this.getCurrentGatewayAddress();return Qn(this,ii.DATACHANNEL_PRECONNECT,i,u).then(s).catch(a)}),this.signal.on(Be.DATACHANNEL_CONNECTING,async i=>{const{iceParameters:s,dtlsParameters:a,rtpCapabilities:u}=await Qn(this,ii.REQUEST_DC_CONNECTION_PARAMS);i(this.getJoinMessage({ortc:{iceParameters:s,dtlsParameters:a,rtpCapabilities:u,version:"2"}}))}),this.signal.on(Be.DATACHANNEL_FAILBACK,()=>{D.warning("[".concat(this.store.clientId,"] User join datachannel failed")),this.reset(),this.resetSignal(),this.emit(ii.DATACHANNEL_FAILBACK)})}async tryUnsubBeforeResub(i,s){try{await this.signal.request(nt.UNSUBSCRIBE,{p2p_id:this.store.p2pId,stream_id:i,ortc:[s]},!0)}catch(a){throw D.warning("[".concat(this.store.clientId,"] tryUnsubBeforeResub warning"),a),a}}async tryUnsubDataChannelBeforeResub(i,s){try{await this.signal.request(nt.UNSUBSCRIBE,{stream_id:s.id},!0)}catch(a){throw D.warning("unsubscribe datachannel warning",a),a}}async tryUnpubBeforeRepub(i,s){try{await this.signal.request(nt.UNPUBLISH,{stream_id:i,ortc:s},!0)}catch(a){throw D.warning("[".concat(this.store.clientId,"] tryUnpubBeforeRepub warning: "),a),a}}async tryUnpubDataChannelBeforeRepub(i,s){try{await this.signal.request(nt.UNPUBLISH_DATASTREAM,{channnel_id:s.channelId},!0)}catch(a){throw D.warning("unpublish datastream warning: ",a),a}}async tryMassUnsubBeforeResub(i){const s={users:i.map(a=>({stream_id:a.stream_id,stream_type:a.stream_type}))};try{await this.signal.request(nt.UNSUBSCRIBE_STREAMS,s,!0)}catch(a){throw D.warning("[".concat(this.store.clientId,"] tryMassUnsubBeforeResub warning"),a),a}}async muteLocal(i,s){const a={action:i.find(u=>u.stream_type===gn.Audio)?"mute_local_audio":"mute_local_video",p2p_id:this.store.p2pId,ortc:i,stream_id:s};try{await this.signal.request(nt.CONTROL,a,!0,!0)}catch(u){throw D.warning("[".concat(this.store.clientId,"] gateway muteLocal warning: "),u),u}}async unmuteLocal(i,s){const a={action:i.find(u=>u.stream_type===gn.Audio)?"unmute_local_audio":"unmute_local_video",p2p_id:this.store.p2pId,ortc:i,stream_id:s};try{await this.signal.request(nt.CONTROL,a,!0,!0)}catch(u){throw D.warning("[".concat(this.store.clientId,"] gateway unmuteLocal warning: "),u),u}}async muteRemote(i,s){const a={action:i===Qe.AUDIO?"mute_remote_audio":"mute_remote_video",p2p_id:this.store.p2pId,stream_id:s};try{await this.signal.request(nt.CONTROL,a,!0,!0)}catch(u){throw D.warning("[".concat(this.store.clientId,"] gateway muteRemote warning: "),u),u}}async unmuteRemote(i,s){const a={action:i===Qe.AUDIO?"unmute_remote_audio":"unmute_remote_video",p2p_id:this.store.p2pId,stream_id:s};try{await this.signal.request(nt.CONTROL,a,!0,!0)}catch(u){throw D.warning("[".concat(this.store.clientId,"] gateway unmuteRemote warning: "),u),u}}uploadStats(i,s){this.signal.upload(i,s)}getSignalRTT(){return this.signal.rtt}async restartICE(i){const s={p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:i};try{return await this.signal.request(nt.RESTART_ICE,s,!0)}catch(a){throw D.warning("[".concat(this.store.clientId,"] P2PChannel.restartICE warning: "),a),a}}reconnect(){this.state==="CONNECTED"&&this.signal.reconnect(void 0,ir.P2P_FAILED)}getCurrentGatewayAddress(){var i;if(!te("GATEWAY_WSS_ADDRESS"))return(i=this.joinInfo)!==null&&i!==void 0&&i.gatewayAddrs?this.joinInfo.gatewayAddrs[this.signal.currentURLIndex]:void 0}async setPublishAudioFilterEnabled(i){await this.signal.request(nt.SET_PARAMETER,{enablePublishAudioFilter:i})}resetSignal(){this.signal&&(this.signal.removeAllListeners(),this.signal.close(Pt.FALLBACK)),this.store.useDataChannel=!1,this.signal=new JW(yc(yc({},this.spec),{},{retryConfig:this.spec.websocketRetryConfig}),this.store),this.handleSignalEvents(),this.emit(ii.RESET_SIGNAL,vI.websocket)}}let JI=0,EU=0;function pd(o,i,s,a){return new le((u,h)=>{i.timeout=i.timeout||te("HTTP_CONNECT_TIMEOUT"),i.responseType=i.responseType||"json",i.data&&!s?(i.data=JSON.stringify(i.data),JI+=Xl(i.data)):s&&(i.data.size?JI+=i.data.size:i.data instanceof FormData?JI+=R8(i.data):JI+=Xl(JSON.stringify(i.data))),i.headers=i.headers||{},i.headers["Content-Type"]=i.headers["Content-Type"]||"application/json",i.method="POST",i.url=o,ao.request(i).then(p=>{typeof p.data=="string"?EU+=Xl(p.data):p.data instanceof ArrayBuffer||p.data instanceof Uint8Array?EU+=p.data.byteLength:EU+=Xl(JSON.stringify(p.data)),a&&u({data:p.data,headers:p.headers}),u(p.data)}).catch(p=>{ao.isCancel(p)?h(new ae(z.OPERATION_ABORTED,"cancel token canceled")):p.code==="ECONNABORTED"?h(new ae(z.NETWORK_TIMEOUT,p.message)):p.response?h(new ae(z.NETWORK_RESPONSE_ERROR,p.response.status)):h(new ae(z.NETWORK_ERROR,p.message))})})}/*! formdata-polyfill. MIT License. Jimmy W?rting <https://jimmy.warting.se/opensource> */(function(){var o;function i(Ce){var ke=0;return function(){return ke<Ce.length?{done:!1,value:Ce[ke++]}:{done:!0}}}var s=typeof Object.defineProperties=="function"?Object.defineProperty:function(Ce,ke,Ze){return Ce==Array.prototype||Ce==Object.prototype||(Ce[ke]=Ze.value),Ce},a,u=function(Ce){Ce=[typeof globalThis=="object"&&globalThis,Ce,typeof window=="object"&&window,typeof self=="object"&&self,typeof ui=="object"&&ui];for(var ke=0;ke<Ce.length;++ke){var Ze=Ce[ke];if(Ze&&Ze.Math==Math)return Ze}throw Error("Cannot find global object")}(this);function h(Ce,ke){if(ke)e:{var Ze=u;Ce=Ce.split(".");for(var yt=0;yt<Ce.length-1;yt++){var tn=Ce[yt];if(!(tn in Ze))break e;Ze=Ze[tn]}(ke=ke(yt=Ze[Ce=Ce[Ce.length-1]]))!=yt&&ke!=null&&s(Ze,Ce,{configurable:!0,writable:!0,value:ke})}}function p(Ce){return(Ce={next:Ce})[Symbol.iterator]=function(){return this},Ce}function _(Ce){var ke=typeof Symbol<"u"&&Symbol.iterator&&Ce[Symbol.iterator];return ke?ke.call(Ce):{next:i(Ce)}}if(h("Symbol",function(Ce){function ke(tn,Fe){this.A=tn,s(this,"description",{configurable:!0,writable:!0,value:Fe})}if(Ce)return Ce;ke.prototype.toString=function(){return this.A};var Ze="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",yt=0;return function tn(Fe){if(this instanceof tn)throw new TypeError("Symbol is not a constructor");return new ke(Ze+(Fe||"")+"_"+yt++,Fe)}}),h("Symbol.iterator",function(Ce){if(Ce)return Ce;Ce=Symbol("Symbol.iterator");for(var ke="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),Ze=0;Ze<ke.length;Ze++){var yt=u[ke[Ze]];typeof yt=="function"&&typeof yt.prototype[Ce]!="function"&&s(yt.prototype,Ce,{configurable:!0,writable:!0,value:function(){return p(i(this))}})}return Ce}),typeof Object.setPrototypeOf=="function")a=Object.setPrototypeOf;else{var v;e:{var T={};try{T.__proto__={a:!0},v=T.a;break e}catch{}v=!1}a=v?function(Ce,ke){if(Ce.__proto__=ke,Ce.__proto__!==ke)throw new TypeError(Ce+" is not extensible");return Ce}:null}var b=a;function C(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function N(Ce){if(Ce.m)throw new TypeError("Generator is already running");Ce.m=!0}function x(Ce,ke){return Ce.h=3,{value:ke}}function B(Ce){this.g=new C,this.G=Ce}function F(Ce,ke,Ze,yt){try{var tn=ke.call(Ce.g.j,Ze);if(!(tn instanceof Object))throw new TypeError("Iterator result "+tn+" is not an object");if(!tn.done)return Ce.g.m=!1,tn;var Fe=tn.value}catch(L){return Ce.g.j=null,Ce.g.s(L),H(Ce)}return Ce.g.j=null,yt.call(Ce.g,Fe),H(Ce)}function H(Ce){for(;Ce.g.h;)try{var ke=Ce.G(Ce.g);if(ke)return Ce.g.m=!1,{value:ke.value,done:!1}}catch(Ze){Ce.g.v=void 0,Ce.g.s(Ze)}if(Ce.g.m=!1,Ce.g.l){if(ke=Ce.g.l,Ce.g.l=null,ke.F)throw ke.D;return{value:ke.return,done:!0}}return{value:void 0,done:!0}}function J(Ce){this.next=function(ke){return Ce.o(ke)},this.throw=function(ke){return Ce.s(ke)},this.return=function(ke){return function(Ze,yt){N(Ze.g);var tn=Ze.g.j;return tn?F(Ze,"return"in tn?tn.return:function(Fe){return{value:Fe,done:!0}},yt,Ze.g.return):(Ze.g.return(yt),H(Ze))}(Ce,ke)},this[Symbol.iterator]=function(){return this}}function ee(Ce,ke){return ke=new J(new B(ke)),b&&Ce.prototype&&b(ke,Ce.prototype),ke}if(C.prototype.o=function(Ce){this.v=Ce},C.prototype.s=function(Ce){this.l={D:Ce,F:!0},this.h=this.C||this.u},C.prototype.return=function(Ce){this.l={return:Ce},this.h=this.u},B.prototype.o=function(Ce){return N(this.g),this.g.j?F(this,this.g.j.next,Ce,this.g.o):(this.g.o(Ce),H(this))},B.prototype.s=function(Ce){return N(this.g),this.g.j?F(this,this.g.j.throw,Ce,this.g.o):(this.g.s(Ce),H(this))},h("Array.prototype.entries",function(Ce){return Ce||function(){return function(ke,Ze){ke instanceof String&&(ke+="");var yt=0,tn=!1,Fe={next:function(){if(!tn&&yt<ke.length){var L=yt++;return{value:Ze(L,ke[L]),done:!1}}return tn=!0,{done:!0,value:void 0}}};return Fe[Symbol.iterator]=function(){return Fe},Fe}(this,function(ke,Ze){return[ke,Ze]})}}),typeof Blob<"u"&&(typeof FormData>"u"||!FormData.prototype.keys)){var se=function(Ce,ke){for(var Ze=0;Ze<Ce.length;Ze++)ke(Ce[Ze])},ye=function(Ce){return Ce.replace(/\r?\n|\r/g,`\r
`)},me=function(Ce,ke,Ze){return ke instanceof Blob?(Ze=Ze!==void 0?Ze+"":typeof ke.name=="string"?ke.name:"blob",ke.name===Ze&&Object.prototype.toString.call(ke)!=="[object Blob]"||(ke=new File([ke],Ze)),[String(Ce),ke]):[String(Ce),String(ke)]},ue=function(Ce,ke){if(Ce.length<ke)throw new TypeError(ke+" argument required, but only "+Ce.length+" present.")},he=typeof globalThis=="object"?globalThis:typeof window=="object"?window:typeof self=="object"?self:this,pe=he.FormData,Ve=he.XMLHttpRequest&&he.XMLHttpRequest.prototype.send,Me=he.Request&&he.fetch,wt=he.navigator&&he.navigator.sendBeacon,zt=he.Element&&he.Element.prototype,si=he.Symbol&&Symbol.toStringTag;si&&(Blob.prototype[si]||(Blob.prototype[si]="Blob"),"File"in he&&!File.prototype[si]&&(File.prototype[si]="File"));try{new File([],"")}catch{he.File=function(ke,Ze,yt){return ke=new Blob(ke,yt||{}),Object.defineProperties(ke,{name:{value:Ze},lastModified:{value:+(yt&&yt.lastModified!==void 0?new Date(yt.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),si&&Object.defineProperty(ke,si,{value:"File"}),ke}}var ji=function(Ce){return Ce.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},Fn=function(Ce){this.i=[];var ke=this;Ce&&se(Ce.elements,function(Ze){if(Ze.name&&!Ze.disabled&&Ze.type!=="submit"&&Ze.type!=="button"&&!Ze.matches("form fieldset[disabled] *"))if(Ze.type==="file"){var yt=Ze.files&&Ze.files.length?Ze.files:[new File([],"",{type:"application/octet-stream"})];se(yt,function(tn){ke.append(Ze.name,tn)})}else Ze.type==="select-multiple"||Ze.type==="select-one"?se(Ze.options,function(tn){!tn.disabled&&tn.selected&&ke.append(Ze.name,tn.value)}):Ze.type==="checkbox"||Ze.type==="radio"?Ze.checked&&ke.append(Ze.name,Ze.value):(yt=Ze.type==="textarea"?ye(Ze.value):Ze.value,ke.append(Ze.name,yt))})};if((o=Fn.prototype).append=function(Ce,ke,Ze){ue(arguments,2),this.i.push(me(Ce,ke,Ze))},o.delete=function(Ce){ue(arguments,1);var ke=[];Ce=String(Ce),se(this.i,function(Ze){Ze[0]!==Ce&&ke.push(Ze)}),this.i=ke},o.entries=function Ce(){var ke,Ze=this;return ee(Ce,function(yt){if(yt.h==1&&(ke=0),yt.h!=3)return ke<Ze.i.length?yt=x(yt,Ze.i[ke]):(yt.h=0,yt=void 0),yt;ke++,yt.h=2})},o.forEach=function(Ce,ke){ue(arguments,1);for(var Ze=_(this),yt=Ze.next();!yt.done;yt=Ze.next()){var tn=_(yt.value);yt=tn.next().value,tn=tn.next().value,Ce.call(ke,tn,yt,this)}},o.get=function(Ce){ue(arguments,1);var ke=this.i;Ce=String(Ce);for(var Ze=0;Ze<ke.length;Ze++)if(ke[Ze][0]===Ce)return ke[Ze][1];return null},o.getAll=function(Ce){ue(arguments,1);var ke=[];return Ce=String(Ce),se(this.i,function(Ze){Ze[0]===Ce&&ke.push(Ze[1])}),ke},o.has=function(Ce){ue(arguments,1),Ce=String(Ce);for(var ke=0;ke<this.i.length;ke++)if(this.i[ke][0]===Ce)return!0;return!1},o.keys=function Ce(){var ke,Ze,yt,tn,Fe=this;return ee(Ce,function(L){if(L.h==1&&(ke=_(Fe),Ze=ke.next()),L.h!=3)return Ze.done?void(L.h=0):(yt=Ze.value,tn=_(yt),x(L,tn.next().value));Ze=ke.next(),L.h=2})},o.set=function(Ce,ke,Ze){ue(arguments,2),Ce=String(Ce);var yt=[],tn=me(Ce,ke,Ze),Fe=!0;se(this.i,function(L){L[0]===Ce?Fe&&(Fe=!yt.push(tn)):yt.push(L)}),Fe&&yt.push(tn),this.i=yt},o.values=function Ce(){var ke,Ze,yt,tn,Fe=this;return ee(Ce,function(L){if(L.h==1&&(ke=_(Fe),Ze=ke.next()),L.h!=3)return Ze.done?void(L.h=0):(yt=Ze.value,(tn=_(yt)).next(),x(L,tn.next().value));Ze=ke.next(),L.h=2})},Fn.prototype._asNative=function(){for(var Ce=new pe,ke=_(this),Ze=ke.next();!Ze.done;Ze=ke.next()){var yt=_(Ze.value);Ze=yt.next().value,yt=yt.next().value,Ce.append(Ze,yt)}return Ce},Fn.prototype._blob=function(){var Ce="----formdata-polyfill-"+Math.random(),ke=[],Ze="--"+Ce+`\r
Content-Disposition: form-data; name="`;return this.forEach(function(yt,tn){return typeof yt=="string"?ke.push(Ze+ji(ye(tn))+`"\r
\r
`+ye(yt)+`\r
`):ke.push(Ze+ji(ye(tn))+'"; filename="'+ji(yt.name)+`"\r
Content-Type: `+(yt.type||"application/octet-stream")+`\r
\r
`,yt,`\r
`)}),ke.push("--"+Ce+"--"),new Blob(ke,{type:"multipart/form-data; boundary="+Ce})},Fn.prototype[Symbol.iterator]=function(){return this.entries()},Fn.prototype.toString=function(){return"[object FormData]"},zt&&!zt.matches&&(zt.matches=zt.matchesSelector||zt.mozMatchesSelector||zt.msMatchesSelector||zt.oMatchesSelector||zt.webkitMatchesSelector||function(Ce){for(var ke=(Ce=(this.document||this.ownerDocument).querySelectorAll(Ce)).length;0<=--ke&&Ce.item(ke)!==this;);return-1<ke}),si&&(Fn.prototype[si]="FormData"),Ve){var jo=he.XMLHttpRequest.prototype.setRequestHeader;he.XMLHttpRequest.prototype.setRequestHeader=function(Ce,ke){jo.call(this,Ce,ke),Ce.toLowerCase()==="content-type"&&(this.B=!0)},he.XMLHttpRequest.prototype.send=function(Ce){Ce instanceof Fn?(Ce=Ce._blob(),this.B||this.setRequestHeader("Content-Type",Ce.type),Ve.call(this,Ce)):Ve.call(this,Ce)}}Me&&(he.fetch=function(Ce,ke){return ke&&ke.body&&ke.body instanceof Fn&&(ke.body=ke.body._blob()),Me.call(this,Ce,ke)}),wt&&(he.navigator.sendBeacon=function(Ce,ke){return ke instanceof Fn&&(ke=ke._asNative()),wt.call(this,Ce,ke)}),he.FormData=Fn}})();const QI=()=>{const o=te("AREAS");return o.length===0&&o.push(Yt.GLOBAL),zp(o).call(o,(i,s,a)=>{const u=kH(s);return u?a===0?u:"".concat(i,",").concat(u):i},"")},kH=o=>o===Yt.OVERSEA?"".concat(Ir.ASIA,",").concat(Ir.EUROPE,",").concat(Ir.AFRICA,",").concat(Ir.NORTH_AMERICA,",").concat(Ir.SOUTH_AMERICA,",").concat(Ir.OCEANIA):Ir[o],Jue=o=>{const i={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return o.map(s=>{const a=yI[s],u=Object.keys(a);u&&u.map(h=>{h!=="CODE"&&(i[h]=i[h].concat(a[h]))})}),i},ZI={GLOBAL:{ASIA:[Yt.CHINA,Yt.JAPAN,Yt.INDIA,Yt.KOREA,Yt.HKMC],EUROPE:[],NORTH_AMERICA:[Yt.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},eA=Object.keys(ZI[Yt.GLOBAL]),vU=[Yt.CHINA,Yt.NORTH_AMERICA,Yt.EUROPE,Yt.ASIA,Yt.JAPAN,Yt.INDIA,Yt.OCEANIA,Yt.SOUTH_AMERICA,Yt.AFRICA,Yt.KOREA,Yt.HKMC,Yt.US],Que=function(o,i){let s=[];if(ot(o).call(o,Yt.GLOBAL)){const h=[Yt.GLOBAL,Yt.OVERSEA],p=Object.keys(yI);if(i===Yt.GLOBAL)throw new ae(z.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(i===Yt.CHINA)s=[Yt.OVERSEA];else if(u=i,ot(eA).call(eA,u)){const _=(a=i,ZI[Yt.GLOBAL][a]||[]),v=[...h,i,..._];s=p.filter(T=>!ot(v).call(v,T))}else if(function(_){let v=!1;return eA.forEach(T=>{var b;ot(b=ZI[Yt.GLOBAL][T]).call(b,_)&&(v=!0)}),v}(i)){const _=function(T){let b;return eA.forEach(C=>{var N;ot(N=ZI[Yt.GLOBAL][C]).call(N,T)&&(b=C)}),b}(i),v=[...h,_,i];s=p.filter(T=>!ot(v).call(v,T))}else s=o;s=function(_){const v=[];return vU.forEach(T=>{ot(_).call(_,T)&&v.push(T)}),v.concat(_.filter(T=>!ot(vU).call(vU,T)))}(s)}else s=o;var a,u;return s};function LH(o){var i,s;if(!o&&ot(i=te("AREAS")).call(i,Yt.EXTENSIONS))return D.debug("update area from ap : reset"),void yU(Jce,!0);if(!ot(s=te("AREAS")).call(s,Yt.GLOBAL)||!o)return;let a=yI.EXTENSIONS;a&&(a={CODE:kH(Yt.EXTENSIONS),WEBCS_DOMAIN:["ap-web-1-".concat(o,".agora.io")],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-".concat(o,".ap.sd-rtn.com")],PROXY_CS:["proxy-ap-web-".concat(o,".agora.io")],CDS_AP:["cds-ap-web-1-".concat(o,".agora.io"),"cds-ap-web-2-".concat(o,".ap.sd-rtn.com")],ACCOUNT_REGISTER:["sua-ap-web-1-".concat(o,".agora.io"),"sua-ap-web-2-".concat(o,".ap.sd-rtn.com")],UAP_AP:["uap-ap-web-1-".concat(o,".agora.io"),"uap-ap-web-2-".concat(o,".ap.sd-rtn.com")],EVENT_REPORT_DOMAIN:["statscollector-1-".concat(o,".agora.io")],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-".concat(o,".agora.io")],LOG_UPLOAD_SERVER:["logservice-".concat(o,".agora.io")],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy-".concat(o,".agora.io")]},D.debug("update area from ap success: ".concat(o,",config is "),a),Sn("AREAS",[Yt.EXTENSIONS],!0),Object.keys(a).map(u=>{u==="LOG_UPLOAD_SERVER"||u==="EVENT_REPORT_DOMAIN"||u==="EVENT_REPORT_BACKUP_DOMAIN"||u==="PROXY_SERVER_TYPE3"?Sn(u,a[u][0]):Sn(u,a[u])}))}function yU(o){let i=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const s=it.reportApiInvoke(null,{name:Mi.SET_AREA,options:o,tag:Yn.TRACER});try{let a=[];if(typeof o=="string"&&(a=[o]),Array.isArray(o)&&(o.forEach(h=>{if(!ot(VW).call(VW,h))throw new ae(z.INVALID_PARAMS,"invalid area code")}),a=o),Object.prototype.toString.call(o)==="[object Object]"){const{areaCode:h,excludedArea:p}=o;if(!h)throw new ae(z.INVALID_PARAMS,"area code is needed");let _=h;typeof h=="string"&&(_=[h]),a=p?Que(_,p):_}if(!i){if(Oh.AREAS){const h=new ae(z.PROHIBITED_OPERATION,"setArea is prohibited because of config-distribute");return s.onError(h),void D.warning("setArea is prohibited because of config-distribute")}if(ot(a).call(a,Yt.GLOBAL)&&te("AREAS")===Yt.EXTENSIONS){const h=new ae(z.PROHIBITED_OPERATION,"setArea is prohibited because of ap extensions");return s.onError(h),void D.warning("setArea is prohibited because of ap extensions")}}Sn("AREAS",a,i);const u=Jue(a);Object.keys(u).map(h=>{h==="LOG_UPLOAD_SERVER"||h==="EVENT_REPORT_DOMAIN"||h==="EVENT_REPORT_BACKUP_DOMAIN"||h==="PROXY_SERVER_TYPE3"?Sn(h,u[h][0]):Sn(h,u[h])}),D.debug("set area success:",a.join(","))}catch(a){throw s.onError(a),a}s.onSuccess()}function MH(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function SU(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?MH(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):MH(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}let TU=1;function Zue(o,i,s,a,u){TU+=1;const h={sid:s.sid,command:"convergeAllocateEdge",uid:"666",appId:s.appId,ts:Math.floor(Date.now()/1e3),seq:TU,requestId:TU,version:Ua,cname:s.cname},p={service_name:i,json_body:JSON.stringify(h)};let _,v,T=o[0];return nl(async()=>{_=Date.now();const b=await pd(T,{data:p,cancelToken:a,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(v=Date.now()-_,b.code!==0){const x=new ae(z.UNEXPECTED_RESPONSE,"live streaming ap error, code"+b.code,{retry:!0,responseTime:v});throw D.error(x.toString()),x}const C=JSON.parse(b.json_body);if(C.code!==200){const x=new ae(z.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(C.code,", reason: ").concat(C.reason),{code:C.code,responseTime:v});throw D.error(x.toString()),x}if(!C.servers||C.servers.length===0){const x=new ae(z.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:C.code,responseTime:v});throw D.error(x.toString()),x}const N=function(x,B){return{addressList:x.servers.map(F=>"wss://".concat(F.address.replace(/\./g,"-"),".").concat(te("WORKER_DOMAIN"),":").concat(F.wss,"?serviceName=").concat(encodeURIComponent(B))),workerToken:x.workerToken,vid:x.vid}}(C,i);return te("LIVE_STREAMING_ADDRESS")&&(N.addressList=te("LIVE_STREAMING_ADDRESS")instanceof Array?te("LIVE_STREAMING_ADDRESS"):[te("LIVE_STREAMING_ADDRESS")]),SU(SU({},N),{},{responseTime:v})},(b,C)=>(it.apworkerEvent(s.sid,{success:!0,sc:200,serviceName:i,responseDetail:JSON.stringify(b.addressList),firstSuccess:C===0,responseTime:v,serverIp:o[C%o.length]}),!1),(b,C)=>(it.apworkerEvent(s.sid,{success:!1,sc:b.data&&b.data.code||200,serviceName:i,responseTime:v,serverIp:o[C%o.length]}),!!(b.code!==z.OPERATION_ABORTED&&b.code!==z.UNEXPECTED_RESPONSE||b.data&&b.data.retry)&&(T=o[(C+1)%o.length],!0)),u)}let bU=1;function UH(o,i,s,a){let{url:u,areaCode:h}=o;const p=Date.now();let _;const[v,T]=BH(i,h,[pr.CHOOSE_SERVER]);let b=Ii.networkState;return nl(async()=>{b&&Ii.networkState===ms.OFFLINE&&Ii.onlineWaiter&&await le.race([Ii.onlineWaiter,xr(a&&a.maxRetryTimeout||Oi.maxRetryTimeout)]),b=Ii.networkState;const{data:C,headers:N}=await pd(u,{data:v,cancelToken:s,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);_=N.http3==="1"?1:-1,it.reportResourceTiming(u,i.sid),FH(C,u,i,p,[pr.CHOOSE_SERVER],_);const x=mU(C,pr.CHOOSE_SERVER);return VH(x),IH(x,u)},C=>(C&&it.joinChooseServer(i.sid,{lts:p,succ:!0,csAddr:u,opid:T,serverList:C.gatewayAddrs.map(N=>N.address),ec:null,cid:C.cid.toString(),uid:C.uid.toString(),csIp:C.csIp,unilbsServerIds:[pr.CHOOSE_SERVER].toString(),isHttp3:_}),!1),C=>C.code!==z.OPERATION_ABORTED&&(C.code===z.CAN_NOT_GET_GATEWAY_SERVER?C.data.retry:(it.joinChooseServer(i.sid,{lts:p,succ:!1,csAddr:u,serverList:null,opid:T,ec:C.code,csIp:C.data&&C.data.csIp,unilbsServerIds:[pr.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:b}),isHttp3:_}),D.warning("[".concat(i.clientId,"] Choose server network error, retry"),C),!0)),a)}function jH(o,i,s,a){let u,{url:h,areaCode:p,serviceIds:_}=o;const v=Date.now(),[T,b]=BH(i,p,_);let C;return nl(async()=>{C&&Ii.networkState===ms.OFFLINE&&Ii.onlineWaiter&&await le.race([Ii.onlineWaiter,xr(a&&a.maxRetryTimeout||Oi.maxRetryTimeout)]),C=Ii.networkState;const{data:N,headers:x}=await pd(h,{data:T,cancelToken:s,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);u=x.http3==="1"?1:-1,it.reportResourceTiming(h,i.sid),FH(N,h,i,v,_,u);const B=mU(N,pr.CHOOSE_SERVER),F=mU(N,i.cloudProxyServer==="proxy5"?pr.CLOUD_PROXY_5:i.cloudProxyServer==="proxy3"||i.cloudProxyServer==="proxy4"?pr.CLOUD_PROXY:pr.CLOUD_PROXY_FALLBACK);return VH(B),{gatewayInfo:IH(B,h),proxyInfo:F,url:h}},N=>(N.gatewayInfo&&it.joinChooseServer(i.sid,{lts:v,succ:!0,csAddr:h,serverList:N.gatewayInfo.gatewayAddrs.map(x=>x.address),ec:null,opid:b,cid:N.gatewayInfo.cid.toString(),uid:N.gatewayInfo.uid.toString(),csIp:N.gatewayInfo.csIp,unilbsServerIds:_.toString(),isHttp3:u}),N.proxyInfo&&it.joinWebProxyAP(i.sid,{lts:v,sucess:1,apServerAddr:h,turnServerAddrList:N.proxyInfo.addresses.map(x=>x.ip).join(","),errorCode:null,eventType:i.cloudProxyServer,unilbsServerIds:_.toString()}),!1),N=>N.code!==z.OPERATION_ABORTED&&(N.code===z.CAN_NOT_GET_GATEWAY_SERVER?N.data.retry:(it.joinWebProxyAP(i.sid,{lts:v,sucess:0,apServerAddr:h,turnServerAddrList:null,errorCode:N.code,eventType:i.cloudProxyServer,unilbsServerIds:_.toString(),extend:JSON.stringify({networkState:C})}),D.warning("[".concat(i.clientId,"] multi unilbs network error, retry"),N),!0)),a)}const FH=(o,i,s,a,u,h)=>{const p=[],_=v=>{v.flag===4096?it.joinChooseServer(s.sid,{lts:a,succ:!1,csAddr:i,opid:o.opid,serverList:null,ec:v.error.message,csIp:v.error.data&&v.error.data.csIp,unilbsServerIds:u.toString(),isHttp3:h}):v.flag!==1048576&&v.flag!==4194304&&v.flag!==4194310||it.joinWebProxyAP(s.sid,{lts:a,sucess:0,apServerAddr:i,turnServerAddrList:null,errorCode:v.error.code,eventType:s.cloudProxyServer,unilbsServerIds:u.toString()})};if(o.response_body.forEach(v=>{const T=v.buffer.code;if(v.uri===23&&T===0&&!v.buffer.edges_services)if(v.buffer.flag===4194310)D.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),v.buffer.edges_services=[];else{const b={error:new ae(z.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:o.detail[502]}),flag:v.buffer.flag};p.push(b),_(b)}if(T!==0){const b=TI(T),C={error:new ae(z.CAN_NOT_GET_GATEWAY_SERVER,b.desc,{desc:b.desc,retry:b.retry,csIp:o.detail[502]}),flag:v.buffer.flag};v.buffer.flag===4194310?D.warning(C.error.toString()):p.push(C),_(C)}}),p.length)throw D.warning("[".concat(s.clientId,"] multi unilbs ").concat(i," failed, ").concat(p.map(v=>"flag: ".concat(v.flag,", message: ").concat(v.error.message,", retry: ").concat(v.error.data.retry)).join(" | "))),new ae(z.CAN_NOT_GET_GATEWAY_SERVER,p.map(v=>"flag: ".concat(v.flag,", message: ").concat(v.error.message)).join(" | "),{retry:!!p.find(v=>v.error.data.retry),csIp:o.detail[502],desc:[...new Set(p.map(v=>{var T;return v==null||(T=v.error)===null||T===void 0||(T=T.data)===null||T===void 0?void 0:T.desc}).filter(v=>!!v))]})},VH=o=>{var i,s,a,u;if(o.addresses&&o.addresses.length===0&&o.code===0)throw new ae(z.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:o.detail&&o.detail[502]});if(te("AP_AREA")&&((a=o.detail)!==null&&a!==void 0&&a[23]&&typeof((u=o.detail)===null||u===void 0?void 0:u[23])=="string"?LH(o.detail[23].toLowerCase()):LH()),(i=o.detail)!==null&&i!==void 0&&i[19]&&typeof((s=o.detail)===null||s===void 0?void 0:s[19])=="string"){const p=o.detail[19],_=p==null?void 0:p.split(";");for(let v=0;v<_.length;v++){var h;const T=O2(h=_[v]).call(h);o.addresses[v]&&_&&(o.addresses[v].fingerprint=T)}}if(te("GATEWAY_ADDRESS")&&te("GATEWAY_ADDRESS").length>0){D.debug("assign gateway address to",te("GATEWAY_ADDRESS"));const p=te("GATEWAY_ADDRESS").map(_=>{var v,T;const b=(v=(T=o.addresses.find(C=>C.ip===_.ip&&C.port===_.port))===null||T===void 0?void 0:T.fingerprint)!==null&&v!==void 0?v:"";return{ip:_.ip,port:_.port,ticket:o.addresses[0]&&o.addresses[0].ticket,fingerprint:b}});o.addresses=p}},ede=(o,i)=>{if(o.response_body&&o.response_body.length){const s=o.response_body[0];if(s.buffer.code!==0){const a=TI(s.buffer.code);throw new ae(z.UPDATE_TICKET_FAILED,"[".concat(s.buffer.code,"]: ").concat(a.desc),{retry:a.retry})}return s.buffer.ticket}throw D.debug("update ticket request received ap response without response body:",i),new ae(z.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})},BH=(o,i,s)=>{const a=Math.floor(Math.random()*1e12),u={appid:o.appId,client_ts:Date.now(),opid:a,sid:o.sid,request_bodies:[{uri:22,buffer:{cname:o.cname,detail:SU({6:o.stringUid,11:i,12:te("USE_NEW_TOKEN")?"1":void 0,22:i},te("AP_RTM")?{26:"RTM2"}:{}),key:o.token,service_ids:s,uid:o.uid||0}}]};u.request_bodies.forEach(p=>{o.multiIP&&o.multiIP.gateway_ip&&(p.buffer.detail[5]=JSON.stringify({vocs_ip:[o.multiIP.uni_lbs_ip],vos_ip:[o.multiIP.gateway_ip]}))});const h=new FormData;return h.append("request",JSON.stringify(u)),[h,a]},tde=(o,i)=>{const s=Math.floor(Math.random()*1e12),a={appid:o.appId,client_ts:Date.now(),opid:s,sid:o.sid,request_bodies:[{uri:28,buffer:{cname:o.cname,detail:{1:"",6:o.stringUid,12:"1"},token:o.token,service_ids:i,uid:o.uid||0,edges_services:o.apResponse.addresses.map(h=>({ip:h.ip,port:h.port}))}}]},u=new FormData;return u.append("request",JSON.stringify(a)),[u,s]};let lE=0;function uE(o){return le.all(o.map(i=>i.then(s=>{throw s},s=>s))).then(i=>{throw i},i=>i)}const _S=async o=>{let{fragementLength:i,referenceList:s,asyncMapHandler:a,allFailedhandler:u,promisesCollector:h}=o,p=0;const _=i;let v,T=0;const b=async()=>{const C=(()=>{const N=p*_,x=N+_;return s.slice(N,x).map(a)})();h&&h.push(...C);try{v=await uE(C)}catch(N){if(T+=_,p++,!(T>=s.length))return void await b();u(N)}C.forEach(N=>N.cancel())};return await b(),v};async function wU(o,i,s,a){return{gatewayInfo:await async function(h,p,_,v){let T=null;const b=[],C=async()=>{const x=te("WEBCS_DOMAIN").slice(0,te("AJAX_REQUEST_CONCURRENT")).map(H=>({url:h.proxyServer?"https://".concat(h.proxyServer,"/ap/?url=").concat(H+"/api/v2/transpond/webrtc?v=2"):"https://".concat(H,"/api/v2/transpond/webrtc?v=2"),areaCode:QI()})),B=v.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:x.map(H=>H.url)}),F=await _S({fragementLength:te("FRAGEMENT_LENGTH"),referenceList:x,asyncMapHandler:H=>(D.debug("[".concat(h.clientId,"] Connect to choose_server:"),H.url),UH(H,h,p,_)),allFailedhandler:H=>{throw v.recordJoinChannelService({endTs:Date.now(),status:"error",errors:H},B),H[0]},promisesCollector:b});return v.recordJoinChannelService({endTs:Date.now(),status:"success"},B),F},N=async()=>{if(await xr(1e3),T!==null)return T;const x=te("WEBCS_DOMAIN_BACKUP_LIST").map(H=>({url:h.proxyServer?"https://".concat(h.proxyServer,"/ap/?url=").concat(H+"/api/v2/transpond/webrtc?v=2"):"https://".concat(H,"/api/v2/transpond/webrtc?v=2"),areaCode:QI()})),B=v.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:x.map(H=>H.url)}),F=await _S({fragementLength:te("FRAGEMENT_LENGTH"),referenceList:x,asyncMapHandler:H=>(D.debug("[".concat(h.clientId,"] Connect to backup choose_server:"),H.url),UH(H,h,p,_)),allFailedhandler:H=>{throw v.recordJoinChannelService({endTs:Date.now(),status:"error",errors:H},B),H[0]},promisesCollector:b});return v.recordJoinChannelService({endTs:Date.now(),status:"success"},B),F};try{return T=await uE([C(),N()]),b.length&&b.forEach(x=>x.cancel&&typeof x.cancel=="function"&&x.cancel()),T}catch(x){throw x[0]}}(o,i,s,a)}}async function WH(o,i,s,a,u){const h=o.cloudProxyServer;if(h==="disabled"){if(!a)return;if(o.useLocalAccessPoint)return await wU(o,i,s,u);if(te("JOIN_WITH_FALLBACK_MEDIA_PROXY")){const{gatewayInfo:T,proxyInfo:b}=await $H(o,i,s,u);return o.turnServer&&o.turnServer.mode!=="auto"||(o.turnServer={mode:"manual",servers:b.map(C=>({turnServerURL:C.address,tcpport:C.tcpport||ra.tcpport,udpport:C.udpport||ra.udpport,username:C.username||ra.username,password:C.password||ra.password,forceturn:!1,security:!0}))}),{gatewayInfo:T}}return await wU(o,i,s,u)}const{proxyInfo:p,gatewayInfo:_}=await $H(o,i,s,u),v={gatewayInfo:_};return o.turnServer={mode:"manual",servers:p.map(T=>({turnServerURL:T.address,tcpport:h==="proxy3"?void 0:T.tcpport?T.tcpport:ra.tcpport,udpport:h==="proxy4"?void 0:T.udpport?T.udpport:ra.udpport,username:T.username||ra.username,password:T.password||ra.password,forceturn:h!=="proxy4",security:h==="proxy5"}))},D.debug("[".concat(o.clientId,"] set proxy server: ").concat(o.proxyServer,", mode: ").concat(h)),v}async function HH(o,i,s,a,u){const h=te("ACCOUNT_REGISTER").slice(0,te("AJAX_REQUEST_CONCURRENT"));let p=[];p=i.proxyServer?h.map(v=>"https://".concat(i.proxyServer,"/ap/?url=").concat(v+"/api/v1")):h.map(v=>"https://".concat(v,"/api/v1"));const _=u==null?void 0:u.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:p});try{const v=await async function(T,b,C,N,x){const B=Date.now(),F={sid:C.sid,opid:10,appid:C.appId,string_uid:b};let H=T[0];const J=await nl(()=>pd(H+"".concat(H.indexOf("?")===-1?"?":"&","action=stringuid"),{data:F,cancelToken:N,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}}),(ee,se)=>{if(ee.code===0){if(ee.uid<=0||ee.uid>=Math.pow(2,32))throw D.error("Invalid Uint Uid ".concat(b," => ").concat(ee.uid),ee),it.reqUserAccount(F.sid,{lts:B,success:!1,serverAddr:H,stringUid:F.string_uid,uid:ee.uid,errorCode:z.INVALID_UINT_UID_FROM_STRING_UID,extend:F}),new ae(z.INVALID_UINT_UID_FROM_STRING_UID);return it.reqUserAccount(F.sid,{lts:B,success:!0,serverAddr:H,stringUid:F.string_uid,uid:ee.uid,errorCode:null,extend:F}),!1}const ye=TI(ee.code);return ye.retry&&(H=T[(se+1)%T.length]),it.reqUserAccount(F.sid,{lts:B,success:!1,serverAddr:H,stringUid:F.string_uid,uid:ee.uid,errorCode:ye.desc,extend:F}),ye.retry},(ee,se)=>ee.code!==z.OPERATION_ABORTED&&(it.reqUserAccount(F.sid,{lts:B,success:!1,serverAddr:H,stringUid:F.string_uid,uid:null,errorCode:ee.code,extend:F}),H=T[(se+1)%T.length],!0),x);if(J.code!==0){const ee=TI(J.code);throw new ae(z.UNEXPECTED_RESPONSE,ee.desc)}return J}(p,o,i,s,a);return u==null||u.recordJoinChannelService({status:"success",endTs:Date.now()},_),v.uid}catch(v){throw u==null||u.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[v]},_),v}}async function nde(o,i,s){const a=te("CDS_AP").slice(0,te("AJAX_REQUEST_CONCURRENT")).map(_=>o.proxyServer?"https://".concat(o.proxyServer,"/ap/?url=").concat(_+"/api/v1"):"https://".concat(_,"/api/v1?action=config")).map(_=>function(v,T,b,C){const N=Zt(),x={flag:64,cipher_method:0,features:{device:N.name,system:N.os,system_general:navigator.userAgent,vendor:T.appId,version:Ua,cname:T.cname,sid:T.sid,session_id:T.sid,detail:"",proxyServer:T.proxyServer}};return nl(()=>pd(v,{data:x,timeout:1e3,cancelToken:b,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}}),void 0,B=>B.code!==z.OPERATION_ABORTED,C)}(_,o,i,s));let u=null,h=null,p={};try{u=await uE(a)}catch(_){if(_.code===z.OPERATION_ABORTED)throw _;h=_}if(a.forEach(_=>_.cancel()),it.reportApiInvoke(o.sid,{name:Mi.REQUEST_CONFIG_DISTRIBUTE,options:{error:h,res:u}}).onSuccess(),u&&u.test_tags)try{p=function(_){if(!_.test_tags)return{};const v=_.test_tags,T=Object.keys(v),b={};return T.forEach(C=>{var N;const x=O2(N=C.slice(4)).call(N),B=JSON.parse(v[C])[1];b[x]=B}),b}(u)}catch{}return p}async function $H(o,i,s,a){const u=te("PROXY_SERVER_TYPE3"),h=(x,B,F)=>{let H=F||u;return Array.isArray(H)&&(H=B%2==0?u[1]:u[0]),"https://".concat(H,"/ap/?url=").concat(x)};let p=null;const _=[],v=async()=>{const x=te("WEBCS_DOMAIN").slice(0,te("AJAX_REQUEST_CONCURRENT")).map((H,J)=>{let ee;return ee=o.cloudProxyServer==="disabled"&&o.proxyServer?h("".concat(H,"/api/v2/transpond/webrtc?v=2"),J,o.proxyServer):o.cloudProxyServer==="disabled"||o.cloudProxyServer==="fallback"?"https://".concat(H,"/api/v2/transpond/webrtc?v=2"):h("".concat(H,"/api/v2/transpond/webrtc?v=2"),J),{url:ee,areaCode:QI(),serviceIds:[pr.CHOOSE_SERVER,o.cloudProxyServer==="proxy5"?pr.CLOUD_PROXY_5:o.cloudProxyServer==="proxy3"||o.cloudProxyServer==="proxy4"?pr.CLOUD_PROXY:pr.CLOUD_PROXY_FALLBACK]}}),B=a.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:x.map(H=>H.url)}),F=await _S({fragementLength:te("FRAGEMENT_LENGTH"),referenceList:x,asyncMapHandler:H=>(D.debug("[".concat(o.clientId,"] Connect to choose_server:"),H.url),jH(H,o,i,s)),allFailedhandler:H=>{throw a.recordJoinChannelService({endTs:Date.now(),status:"error",errors:H},B),H[0]},promisesCollector:_});return a.recordJoinChannelService({endTs:Date.now(),status:"success"},B),F},T=async()=>{if(await xr(1e3),p!==null)return p;const x=te("WEBCS_DOMAIN_BACKUP_LIST").map((H,J)=>{let ee;return ee=o.cloudProxyServer==="disabled"&&o.proxyServer?h("".concat(H,"/api/v2/transpond/webrtc?v=2"),J,o.proxyServer):o.cloudProxyServer==="disabled"||o.cloudProxyServer==="fallback"?"https://".concat(H,"/api/v2/transpond/webrtc?v=2"):h("".concat(H,"/api/v2/transpond/webrtc?v=2"),J),{url:ee,areaCode:QI(),serviceIds:[pr.CHOOSE_SERVER,o.cloudProxyServer==="proxy5"?pr.CLOUD_PROXY_5:o.cloudProxyServer==="proxy3"||o.cloudProxyServer==="proxy4"?pr.CLOUD_PROXY:pr.CLOUD_PROXY_FALLBACK]}}),B=a.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:x.map(H=>H.url)}),F=await _S({fragementLength:te("FRAGEMENT_LENGTH"),referenceList:x,asyncMapHandler:H=>(D.debug("[".concat(o.clientId,"] Connect to backup choose_server:"),H.url),jH(H,o,i,s)),allFailedhandler:H=>{throw a.recordJoinChannelService({endTs:Date.now(),status:"error",errors:H},B),H[0]},promisesCollector:_});return a.recordJoinChannelService({endTs:Date.now(),status:"success"},B),F};let b,C,N;try{({gatewayInfo:b,proxyInfo:C,url:N}=await uE([v(),T()]))}catch(x){throw x[0]}if(_.length&&_.forEach(x=>x.cancel&&typeof x.cancel=="function"&&x.cancel()),!b||!C)throw new ae(z.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(o.apUrl=N,o.cloudProxyServer!=="disabled"&&Array.isArray(u)&&N){const x=/^https?:\/\/(.+?)(\/.*)?$/.exec(N)[1];ot(u).call(u,x)&&(o.proxyServer=x,D.setProxyServer(x),it.setProxyServer(x))}return p={gatewayInfo:b,proxyInfo:await Kue(C,b.uid)},p}async function zH(o,i,s,a){const u=te("UAP_AP").slice(0,te("AJAX_REQUEST_CONCURRENT")).map(h=>i.proxyServer?"https://".concat(i.proxyServer,"/ap/?url=").concat(h+"/api/v1?action=uap"):"https://".concat(h,"/api/v1?action=uap"));return await Zue(u,o,i,s,a)}async function ide(o,i,s){const a=te("UAP_AP").slice(0,te("AJAX_REQUEST_CONCURRENT")).map(u=>o.proxyServer?"https://".concat(o.proxyServer,"/ap/?url=").concat(u+"/api/v1?action=uap"):"https://".concat(u,"/api/v1?action=uap")).map(u=>function(h,p,_,v){const T={command:"convergeAllocateEdge",sid:p.sid,appId:p.appId,token:p.token,ts:Date.now(),version:Ua,cname:p.cname,uid:p.uid.toString(),requestId:bU,seq:bU};bU+=1;const b={service_name:"tele_channel",json_body:JSON.stringify(T)};return nl(async()=>{const C=await pd(h,{data:b,cancelToken:_,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(C.code!==0){const x=new ae(z.UNEXPECTED_RESPONSE,"cross channel ap error, code"+C.code,{retry:!0});throw D.error(x.toString()),x}const N=JSON.parse(C.json_body);if(N.code!==200){const x=new ae(z.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat(N.code,", reason: ").concat(N.reason));throw D.error(x.toString()),x}if(!N.servers||N.servers.length===0){const x=new ae(z.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw D.error(x.toString()),x}return{vid:N.vid,workerToken:N.workerToken,addressList:(te("CHANNEL_MEDIA_RELAY_SERVERS")||N.servers).map(x=>"wss://".concat(x.address.replace(/\./g,"-"),".").concat(te("WORKER_DOMAIN"),":").concat(x.wss))}},void 0,C=>!!(C.code!==z.OPERATION_ABORTED&&C.code!==z.UNEXPECTED_RESPONSE||C.data&&C.data.retry),v)}(u,o,i,s));try{const u=await uE(a);return a.forEach(h=>h.cancel()),u}catch(u){throw u[0]}}async function rde(o,i,s){let a=null;const u=[],h=async p=>{const _=te(p?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map(v=>o.proxyServer?"https://".concat(o.proxyServer,"/ap/?url=").concat(v+"/api/v2/transpond/webrtc?v=2"):"https://".concat(v,"/api/v2/transpond/webrtc?v=2"));return p&&(await xr(1e3),a!==null)?a:await _S({fragementLength:te("FRAGEMENT_LENGTH"),referenceList:_,asyncMapHandler:v=>(D.debug("[".concat(o.clientId,"] update ticket, Connect to ").concat(p?"backup":""," choose_server:"),v),function(T,b,C,N){const[x]=tde(b,[pr.CHOOSE_SERVER]);let B=Ii.networkState;return nl(async()=>{B&&Ii.networkState===ms.OFFLINE&&Ii.onlineWaiter&&await le.race([Ii.onlineWaiter,xr(N&&N.maxRetryTimeout||Oi.maxRetryTimeout)]),B=Ii.networkState;const F=await pd(T,{data:x,cancelToken:C,headers:{"Content-Type":"multipart/form-data;"}},!0);return ede(F,T)},()=>!1,F=>F.code!==z.OPERATION_ABORTED&&(F.code===z.UPDATE_TICKET_FAILED?F.data.retry:(D.warning("[".concat(b.clientId,"] update ticket network error, retry"),F),!0)),N)}(v,o,i,s)),allFailedhandler:v=>{throw v[0]},promisesCollector:u})};try{return a=await uE([h(!1),h(!0)]),u.length&&u.forEach(p=>p.cancel&&typeof p.cancel=="function"&&p.cancel()),a}catch(p){throw p[0]}}function GH(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function KH(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?GH(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):GH(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}class sde extends Hn{constructor(){super(),O(this,"configs",void 0),O(this,"joinInfo",void 0),O(this,"cancelToken",void 0),O(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),O(this,"interval",void 0),O(this,"mutex",new fr("config-distribute")),O(this,"mutableParamsRead",!1)}startGetConfigDistribute(i,s){this.joinInfo=i,this.cancelToken=s,this.interval&&this.stopGetConfigDistribute(),te("ENABLE_CONFIG_DISTRIBUTE")&&(this.updateConfigDistribute(),this.interval=window.setInterval(()=>{this.updateConfigDistribute()},te("CONFIG_DISTRIBUTE_INTERVAL")))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0}async awaitConfigDistributeComplete(){this.mutex.isLocked&&(await this.mutex.lock())()}async updateConfigDistribute(){if(this.mutableParamsRead||(this.mutableParamsRead=!0,it.reportApiInvoke(null,{options:void 0,name:Mi.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:Yn.TRACER}).onSuccess(JSON.stringify(Oh))),!this.joinInfo||!this.cancelToken||!this.retryConfig)return void D.debug("[config-distribute] get config distribute interrupted have no joininfo");let i;const s=await this.mutex.lock();try{i=await nde(this.joinInfo,this.cancelToken,this.retryConfig),D.debug("[config-distribute] get config distribute",JSON.stringify(i)),i.limit_bitrate&&this.handleBitrateLimit(i.limit_bitrate),this.cacheGlobalParameterConfig(i),this.configs=i}catch(a){const u=new ae(z.NETWORK_RESPONSE_ERROR,a);D.warning("[config-distribute] ".concat(u.toString()))}finally{s()}}getBitrateLimit(){return this.configs?this.configs.limit_bitrate:void 0}handleBitrateLimit(i){var s;(s=i)&&s.uplink&&s.id&&s.uplink.max_bitrate!==void 0&&s.uplink.min_bitrate!==void 0&&(this.configs&&this.configs.limit_bitrate?this.configs&&this.configs.limit_bitrate&&this.configs.limit_bitrate.id!==i.id&&this.emit(Y0.UPDATE_BITRATE_LIMIT,i):this.emit(Y0.UPDATE_BITRATE_LIMIT,i))}getLowStreamConfigDistribute(){return this.configs&&this.configs.limit_bitrate&&KH({},this.configs.limit_bitrate.low_stream_uplink)}cacheGlobalParameterConfig(i){var s;const a=Up(s=Object.keys(i).filter(h=>/^webrtc_ng_global_parameter/.test(h))).call(s);for(let h=0;h<a.length;h++)for(let p=a.length-1;p>h;p--){const _=a[p];if(typeof i[_].__priority=="number"){const v=i[_].__priority,T=a[p-1];if(typeof i[T].__priority=="number"){if(!(v>i[T].__priority))continue;{const b=_;a[p]=a[p-1],a[p-1]=b}}else{const b=_;a[p]=a[p-1],a[p-1]=b}}}const u={};a.forEach(h=>{const p=i[h],_=p.__expires;Object.keys(p).forEach(v=>{v==="__priority"||v==="__expires"||Object.prototype.hasOwnProperty.call(u,v)||(u[v]=KH({value:p[v]},_&&{expires:_}))})});try{(function(_){try{const v=Date.now();Object.keys(_).forEach(T=>{switch(T){case"ENABLE_EVENT_REPORT":case"UPLOAD_LOG":if(Object.prototype.hasOwnProperty.call(Cs,T)){const{value:b,expires:C}=_[T];if(C&&C<=v)return;Oh[T]=b,Cs[T]=b,D.debug("Update global parameters from config distribute",T,b)}}})}catch(v){D.error("Error update config immediately: ".concat(_),v.message)}})(u);const h=JSON.stringify(u),p=window.btoa(h);window.localStorage.setItem("websdk_ng_global_parameter",p),D.debug("Caching global parameters ".concat(h))}catch(h){D.error("Error caching global parameters:",h.message)}}}function qH(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function ES(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?qH(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):qH(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}class ode extends Hn{constructor(i,s,a,u){super(),O(this,"spec",void 0),O(this,"token",void 0),O(this,"websocket",void 0),O(this,"pingpongTimer",void 0),O(this,"reconnectMode","retry"),O(this,"serviceMode",void 0),O(this,"reqId",0),O(this,"commandReqId",0),O(this,"handleWebSocketOpen",()=>{this.reconnectMode="retry",this.startPingPong()}),O(this,"handleWebSocketMessage",h=>{if(!h.data)return;const p=JSON.parse(h.data);p.requestId?this.emit("@".concat(p.requestId,"-").concat(p.sid),p):this.serviceMode===zi.INJECT?this.emit(mc.INJECT_STREAM_STATUS,p):(it.workerEvent(this.spec.sid,{actionType:"status",serverCode:p.code,workerType:this.serviceMode===zi.TRANSCODE?1:2}),this.emit(mc.PUBLISH_STREAM_STATUS,p))}),this.spec=s,this.token=i,this.serviceMode=u,this.websocket=new J0("live-streaming",a),this.websocket.on(mt.CONNECTED,this.handleWebSocketOpen),this.websocket.on(mt.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(mt.REQUEST_NEW_URLS,(h,p)=>{Qn(this,mc.REQUEST_NEW_ADDRESS).then(h).catch(p)}),this.websocket.on(mt.RECONNECTING,()=>{this.websocket.reconnectMode=this.reconnectMode})}init(i){return this.websocket.init(i)}async request(i,s,a,u){this.reqId+=1,i==="request"&&(this.commandReqId+=1);const h=this.commandReqId,p=this.reqId;if(!p||!this.websocket)throw new ae(z.UNEXPECTED_ERROR);const _=ES({command:i,sdkVersion:Ua==="4.19.3"?"0.0.1":Ua,seq:p,requestId:p,allocate:a,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},s);if(this.websocket.state==="closed")throw new ae(z.WS_DISCONNECT);const v=()=>new le((N,x)=>{this.websocket.once(mt.CLOSED,()=>x(new ae(z.WS_ABORT))),this.websocket.once(mt.CONNECTED,N)});this.websocket.state!=="connected"&&await v(),_.clientRequest&&(_.clientRequest.workerToken=this.token);const T=new le((N,x)=>{const B=()=>{x(new ae(z.WS_ABORT))};this.websocket.once(mt.RECONNECTING,B),this.websocket.once(mt.CLOSED,B),this.once("@".concat(p,"-").concat(this.spec.sid),F=>{N(F)})});u&&it.workerEvent(this.spec.sid,ES(ES({},u),{},{requestId:h,actionType:"request",payload:JSON.stringify(s.clientRequest),serverCode:0,code:0}));const b=Date.now();this.websocket.sendMessage(_);let C=null;try{C=await T}catch(N){if(this.websocket.state==="closed")throw N;return await v(),await this.request(i,s,a)}return u&&it.workerEvent(this.spec.sid,ES(ES({},u),{},{requestId:h,actionType:"response",payload:JSON.stringify(C.serverResponse),serverCode:C.code,success:C.code===200,responseTime:Date.now()-b})),C.code!==200&&this.handleResponseError(C),C}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){const i=Ua==="4.19.3"?"0.0.1":Ua;this.reqId+=1,this.websocket.state==="connected"?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:i,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(i){switch(i.code){case _i.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void D.warning("live stream response already exists stream");case _i.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case _i.LIVE_STREAM_RESPONSE_BAD_STREAM:case _i.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new ae(z.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:i.code}).throw();case _i.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if(i.serverResponse.command==="UnpublishStream"||i.serverResponse.command==="UninjectStream")return;throw new ae(z.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case _i.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new ae(z.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:i.code}).throw();case _i.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const s=new ae(z.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(mc.WARNING,s,i.serverResponse.url)}case _i.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{const s=new ae(z.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(mc.WARNING,s,i.serverResponse.url)}case _i.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new ae(z.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case _i.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new ae(z.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:i.code}).throw();case _i.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{const s=new ae(z.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(mc.WARNING,s,i.serverResponse.url)}case _i.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new ae(z.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:i.code}).throw();case _i.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new ae(z.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case _i.LIVE_STREAM_RESPONSE_WORKER_LOST:case _i.LIVE_STREAM_RESPONSE_WORKER_QUIT:if(i.serverResponse.command==="UnpublishStream"||i.serverResponse.command==="UninjectStream")return;throw new ae(z.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case _i.ERROR_FAIL_SEND_MESSAGE:if(i.serverResponse.command==="UnpublishStream"||i.serverResponse.command==="UninjectStream")return;if(i.serverResponse.command==="UpdateTranscoding"||i.serverResponse.command==="ControlStream")return new ae(z.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:i.code}).throw();throw new ae(z.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case _i.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case _i.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case _i.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case _i.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new ae(z.LIVE_STREAMING_CDN_ERROR,"",{code:i.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(()=>{this.websocket.state==="connected"&&this.request("ping",{}).catch(sI)},6e3)}}function YH(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function $s(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?YH(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):YH(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}class ade extends Hn{constructor(i){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Oi,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Oi;super(),O(this,"onLiveStreamWarning",void 0),O(this,"onLiveStreamError",void 0),O(this,"onInjectStatusChange",void 0),O(this,"spec",void 0),O(this,"retryTimeout",1e4),O(this,"connection",void 0),O(this,"httpRetryConfig",void 0),O(this,"wsRetryConfig",void 0),O(this,"streamingTasks",new Map),O(this,"isStartingStreamingTask",!1),O(this,"taskMutex",new fr("live-streaming")),O(this,"cancelToken",ao.CancelToken.source()),O(this,"transcodingConfig",void 0),O(this,"injectConfig",$s({},ole)),O(this,"injectLoopTimes",0),O(this,"uapResponse",void 0),O(this,"lastTaskId",1),O(this,"statusError",new Map),this.spec=i,this.httpRetryConfig=a,this.wsRetryConfig=s}async setTranscodingConfig(i){const s=$s($s({},sle),i);s.videoCodecProfile!==66&&s.videoCodecProfile!==77&&s.videoCodecProfile!==100&&(D.debug("[".concat(this.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(s.videoCodecProfile," -> 100")),s.videoCodecProfile=100),s.transcodingUsers||(s.transcodingUsers=s.userConfigs),s.transcodingUsers&&(s.transcodingUsers=s.transcodingUsers.map(p=>$s($s($s({},rle),p),{},{zOrder:p.zOrder?p.zOrder+1:1}))),function(p){Jn(p.width)||Tn(p.width,"config.width",0,1e4),Jn(p.height)||Tn(p.height,"config.height",0,1e4),Jn(p.videoBitrate)||Tn(p.videoBitrate,"config.videoBitrate",1,1e6),Jn(p.videoFrameRate)||Tn(p.videoFrameRate,"config.videoFrameRate"),Jn(p.lowLatency)||Wp(p.lowLatency,"config.lowLatency"),Jn(p.audioSampleRate)||nr(p.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),Jn(p.audioBitrate)||Tn(p.audioBitrate,"config.audioBitrate",1,128),Jn(p.audioChannels)||nr(p.audioChannels,"config.audioChannels",[1,2,3,4,5]),Jn(p.videoGop)||Tn(p.videoGop,"config.videoGop"),Jn(p.videoCodecProfile)||nr(p.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),Jn(p.userCount)||Tn(p.userCount,"config.userCount",0,17),Jn(p.backgroundColor)||Tn(p.backgroundColor,"config.backgroundColor",0,16777215),Jn(p.userConfigExtraInfo)||jr(p.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),p.transcodingUsers&&!Jn(p.transcodingUsers)&&(sd(p.transcodingUsers,"config.transcodingUsers"),p.transcodingUsers.forEach((_,v)=>{T2(_.uid),Jn(_.x)||Tn(_.x,"transcodingUser[".concat(v,"].x"),0,1e4),Jn(_.y)||Tn(_.y,"transcodingUser[".concat(v,"].y"),0,1e4),Jn(_.width)||Tn(_.width,"transcodingUser[".concat(v,"].width"),0,1e4),Jn(_.height)||Tn(_.height,"transcodingUser[".concat(v,"].height"),0,1e4),Jn(_.zOrder)||Tn(_.zOrder-1,"transcodingUser[".concat(v,"].zOrder"),0,100),Jn(_.alpha)||Tn(_.alpha,"transcodingUser[".concat(v,"].alpha"),0,1,!1)})),Jn(p.watermark)||w2(p.watermark,"watermark"),Jn(p.backgroundImage)||w2(p.backgroundImage,"backgroundImage"),p.images&&!Jn(p.images)&&(sd(p.images,"config.images"),p.images.forEach((_,v)=>{w2(_,"images[".concat(v,"]"))}))}(s);const a=[];s.images&&a.push(...s.images.map(p=>$s($s($s({},b2),p),{},{zOrder:255}))),s.backgroundImage&&(a.push($s($s($s({},b2),s.backgroundImage),{},{zOrder:0})),delete s.backgroundImage),s.watermark&&(a.push($s($s($s({},b2),s.watermark),{},{zOrder:255})),delete s.watermark),s.images=a,s.transcodingUsers&&(s.userConfigs=s.transcodingUsers.map(p=>$s({},p)),s.userCount=s.transcodingUsers.length,delete s.transcodingUsers);const u=(s.userConfigs||[]).map(p=>typeof p.uid=="number"?le.resolve(p.uid):HH(p.uid,this.spec,this.cancelToken.token,this.httpRetryConfig));if((await le.all(u)).forEach((p,_)=>{s.userConfigs&&s.userConfigs[_]&&(s.userConfigs[_].uid=p)}),this.transcodingConfig=s,this.connection)try{var h;const p=await this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(Jl(h=this.streamingTasks).call(h)).map(_=>_.taskId).join("#")});D.debug("[".concat(this.spec.clientId,"] update live transcoding config success, code: ").concat(p.code,", config:"),JSON.stringify(this.transcodingConfig))}catch(p){if(!p.data||!p.data.retry)throw p;p.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach(_=>{D.warning("[".concat(this.spec.clientId,"] live streaming receive error"),p.toString(),"try to republish",_.url),this.startLiveStreamingTask(_.url,_.mode,p).then(()=>{D.debug("[".concat(this.spec.clientId,"] live streaming republish ").concat(_.url," success"))}).catch(v=>{D.error("[".concat(this.spec.clientId,"] live streaming republish failed"),_.url,v.toString()),this.onLiveStreamError&&this.onLiveStreamError(_.url,v)})})}}setInjectStreamConfig(i,s){this.injectConfig=Object.assign({},this.injectConfig,i),this.injectLoopTimes=s}async startLiveStreamingTask(i,s,a){var u;if(Array.from(Jl(u=this.streamingTasks).call(u)).find(v=>v.mode===zi.INJECT)&&s===zi.INJECT)return new ae(z.LIVE_STREAMING_TASK_CONFLICT,"inject stream over limit").throw();if(!this.transcodingConfig&&s===zi.TRANSCODE)throw new ae(z.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");let h={command:"PublishStream",ts:Date.now(),url:i,uid:this.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};D.debug("[".concat(this.spec.clientId,"] start live streaming ").concat(i,", mode: ").concat(s));const p=await this.taskMutex.lock();if(!this.connection&&a)return void p();if(this.streamingTasks.get(i)&&!a)return p(),new ae(z.LIVE_STREAMING_TASK_CONFLICT).throw();try{this.connection||(this.connection=await this.connect(s))}catch(v){throw p(),v}switch(s){case zi.TRANSCODE:h.transcodingConfig=$s({},this.transcodingConfig);break;case zi.RAW:break;case zi.INJECT:h={cname:this.spec.cname,command:"InjectStream",sid:this.spec.sid,transcodingConfig:this.injectConfig,ts:Date.now(),url:i,loopTimes:this.injectLoopTimes}}this.uapResponse&&this.uapResponse.vid&&(h.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0;const _=this.lastTaskId++;try{const v=new le((b,C)=>{xr(this.retryTimeout).then(()=>{if(a)return C(a);const N=this.statusError.get(i);return N?(this.statusError.delete(i),C(N)):void 0})}),T=await le.race([this.connection.request("request",{clientRequest:h},!0,{url:i,command:"PublishStream",workerType:s===zi.TRANSCODE?1:2,requestByUser:!a,tid:_.toString()}),v]);this.isStartingStreamingTask=!1,D.debug("[".concat(this.spec.clientId,"] live streaming started, code: ").concat(T.code)),this.streamingTasks.set(i,{clientRequest:h,mode:s,url:i,taskId:_}),p()}catch(v){if(p(),this.isStartingStreamingTask=!1,!v.data||!v.data.retry||a)throw v;return v.data.changeAddress?(this.connection.tryNextAddress(),await this.startLiveStreamingTask(i,s,v)):await this.startLiveStreamingTask(i,s,v)}}stopLiveStreamingTask(i){return new le((s,a)=>{const u=this.streamingTasks.get(i);if(!u||!this.connection)return new ae(z.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();const h=u.mode;u.abortTask=()=>{D.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(i),s()},this.connection.request("request",{clientRequest:{command:h===zi.INJECT?"UninjectStream":"UnpublishStream",url:u.url}},!1,{url:i,command:"UnPublishStream",workerType:h===zi.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then(p=>{D.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(p.code)),this.streamingTasks.delete(i),this.streamingTasks.size===0&&h!==zi.INJECT&&(this.connection&&this.connection.close(),this.connection=void 0),s(),h===zi.INJECT&&this.onInjectStatusChange&&this.onInjectStatusChange(Ph.INJECT_STREAM_STATUS_STOP_SUCCESS,this.spec.uid,i)}).catch(a)})}async controlInjectStream(i,s,a,u){const h=this.streamingTasks.get(i);if(!h||!this.connection||h.mode!==zi.INJECT)throw new ae(z.INVALID_OPERATION,"can not find inject stream task to control");return(await this.connection.request("request",{clientRequest:{command:"ControlStream",url:i,control:s,audioVolume:a,position:u}})).serverResponse}resetAllTask(){var i;const s=Array.from(Jl(i=this.streamingTasks).call(i));this.terminate();for(const a of s)this.startLiveStreamingTask(a.url,a.mode).catch(u=>{this.onLiveStreamError&&this.onLiveStreamError(a.url,u)})}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=ao.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}async connect(i){if(this.connection)throw new ae(z.UNEXPECTED_ERROR,"live streaming connection has already connected");const s=await Qn(this,Y_.REQUEST_WORKER_MANAGER_LIST,i);return this.uapResponse=s,this.connection=new ode(s.workerToken,this.spec,this.wsRetryConfig,i),this.connection.on(mc.WARNING,(a,u)=>this.onLiveStreamWarning&&this.onLiveStreamWarning(u,a)),this.connection.on(mc.PUBLISH_STREAM_STATUS,a=>this.handlePublishStreamServer(a)),this.connection.on(mc.INJECT_STREAM_STATUS,a=>this.handleInjectStreamServerStatus(a)),this.connection.on(mc.REQUEST_NEW_ADDRESS,(a,u)=>{if(!this.connection)return u(new ae(z.UNEXPECTED_ERROR,"can not get new live streaming address list"));Qn(this,Y_.REQUEST_WORKER_MANAGER_LIST,i).then(h=>{this.uapResponse=h,a(h.addressList)}).catch(u)}),await this.connection.init(s.addressList),this.connection}handlePublishStreamServer(i){const s=i.serverStatus&&i.serverStatus.url||"empty_url",a=this.streamingTasks.get(s),u=i.reason;switch(i.code){case _i.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case _i.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case _i.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case _i.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{const p=new ae(z.LIVE_STREAMING_CDN_ERROR,"",{code:i.code});if(a)return D.error(p.toString()),this.onLiveStreamError&&this.onLiveStreamError(s,p);if(!this.isStartingStreamingTask)return;this.statusError.set(s,p)}case _i.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const p=new ae(z.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,u);return this.onLiveStreamWarning&&this.onLiveStreamWarning(s,p)}case _i.LIVE_STREAM_RESPONSE_WORKER_LOST:case _i.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var h;if(!this.connection)return;this.connection.tryNextAddress();const p=Array.from(Jl(h=this.streamingTasks).call(h));for(const _ of p)_.abortTask?_.abortTask():(D.warning("[".concat(this.spec.clientId,"] publish stream status code"),i.code,"try to republish",_.url),this.startLiveStreamingTask(_.url,_.mode,new ae(z.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:i.code})).then(()=>{D.debug("[".concat(this.spec.clientId,"] republish live stream success"),_.url)}).catch(v=>{D.error(v.toString()),this.onLiveStreamError&&this.onLiveStreamError(_.url,v)}));return}}}handleInjectStreamServerStatus(i){const s=Number(i.uid),a=i.serverStatus&&i.serverStatus.url;switch(i.code){case 200:return void(this.onInjectStatusChange&&this.onInjectStatusChange(Ph.INJECT_STREAM_STATUS_START_SUCCESS,s,a));case 451:return this.onInjectStatusChange&&this.onInjectStatusChange(Ph.INJECT_STREAM_STATUS_START_ALREADY_EXISTS,s,a),void this.streamingTasks.delete(a);case 453:return this.onInjectStatusChange&&this.onInjectStatusChange(Ph.INJECT_STREAM_STATUS_START_UNAUTHORIZED,s,a),void this.streamingTasks.delete(a);case 470:return this.onInjectStatusChange&&this.onInjectStatusChange(Ph.INJECT_STREAM_STATUS_BROKEN,s,a),void this.streamingTasks.delete(a);case 499:return this.onInjectStatusChange&&this.onInjectStatusChange(Ph.INJECT_STREAM_STATUS_START_TIMEOUT,s,a),void this.streamingTasks.delete(a);default:return void D.debug("inject stream server status",i)}}hasUrl(i){return this.streamingTasks.has(i)}}class tA{constructor(){O(this,"destChannelMediaInfos",new Map),O(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(i){FW(i),this.srcChannelMediaInfo=i}addDestChannelInfo(i){FW(i),this.destChannelMediaInfos.set(i.channelName,i)}removeDestChannelInfo(i){S2(i),this.destChannelMediaInfos.delete(i)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function XH(o){if(!(o instanceof tA))return new ae(z.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();const i=o.getSrcChannelMediaInfo(),s=o.getDestChannelMediaInfo();if(!i)return new ae(z.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw();if(s.size===0)return new ae(z.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw()}class cde extends Hn{constructor(i,s,a){super(),O(this,"ws",void 0),O(this,"requestId",1),O(this,"heartBeatTimer",void 0),O(this,"joinInfo",void 0),O(this,"clientId",void 0),O(this,"onOpen",()=>{this.emit("open"),this.startHeartBeatCheck()}),O(this,"onClose",u=>{this.emit("close"),this.dispose()}),O(this,"onMessage",u=>{const h=JSON.parse(u.data);if(!h||h.command!=="serverResponse"||!h.requestId)return h&&h.command==="serverStatus"&&h.serverStatus&&h.serverStatus.command?(this.emit("status",h.serverStatus),void this.emit(h.serverStatus.command,h.serverStatus)):void 0;this.emit("req_".concat(h.requestId),h)}),this.joinInfo=i,this.clientId=s,this.ws=new J0("cross-channel-".concat(this.clientId),a),this.ws.on(mt.RECONNECTING,()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")}),this.ws.on(mt.CONNECTED,this.onOpen),this.ws.on(mt.ON_MESSAGE,this.onMessage),this.ws.on(mt.CLOSED,this.onClose)}isConnect(){return this.ws.state==="connected"}sendMessage(i){const s=this.requestId++;return i.requestId=s,i.seq=s,this.ws.sendMessage(i),s}waitStatus(i){return new le((s,a)=>{const u=window.setTimeout(()=>{a(new ae(z.TIMEOUT,"wait status timeout, status: ".concat(i)))},5e3);this.once(i,h=>{window.clearTimeout(u),h.state&&h.state!==0?a(new ae(z.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(i))):s(void 0)}),this.once("dispose",()=>{window.clearTimeout(u),a(new ae(z.WS_ABORT))})})}async request(i){if(this.ws.state==="closed")throw new ae(z.WS_DISCONNECT);const s=()=>new le((p,_)=>{this.ws.once(mt.CLOSED,()=>_(new ae(z.WS_ABORT))),this.ws.once(mt.CONNECTED,p)});this.ws.state!=="connected"&&await s();const a=this.sendMessage(i),u=new le((p,_)=>{const v=()=>{_(new ae(z.WS_ABORT))};this.ws.once(mt.RECONNECTING,v),this.ws.once(mt.CLOSED,v),this.once("req_".concat(a),p),xr(3e3).then(()=>{this.removeAllListeners("req_".concat(a)),this.ws.off(mt.RECONNECTING,v),this.ws.off(mt.CLOSED,v),_(new ae(z.TIMEOUT,"cross channel ws request timeout"))})}),h=await u;if(!h||h.code!==200)throw new ae(z.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(h)));return h}async connect(i){this.ws.removeAllListeners(mt.REQUEST_NEW_URLS),this.ws.on(mt.REQUEST_NEW_URLS,s=>{s(i)}),await this.ws.init(i)}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(i){const s=this.requestId++;return i.requestId=s,this.ws.sendMessage(i),s}startHeartBeatCheck(){this.heartBeatTimer&&window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=window.setInterval(()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})},3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class lde extends Hn{set state(i){i!==this._state&&(i!==Rs.RELAY_STATE_FAILURE&&(this.errorCode=xh.RELAY_OK),this.emit("state",i,this.errorCode),this._state=i)}get state(){return this._state}constructor(i,s,a,u,h){super(),O(this,"joinInfo",void 0),O(this,"sid",void 0),O(this,"clientId",void 0),O(this,"cancelToken",ao.CancelToken.source()),O(this,"workerToken",void 0),O(this,"requestId",0),O(this,"signal",void 0),O(this,"prevChannelMediaConfig",void 0),O(this,"httpRetryConfig",void 0),O(this,"_resolution",void 0),O(this,"_state",Rs.RELAY_STATE_IDLE),O(this,"errorCode",xh.RELAY_OK),O(this,"onStatus",p=>{D.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(p))),p&&p.command&&(p.command==="onAudioPacketReceived"&&this.emit("event",il.PACKET_RECEIVED_AUDIO_FROM_SRC),p.command==="onVideoPacketReceived"&&this.emit("event",il.PACKET_RECEIVED_VIDEO_FROM_SRC),p.command==="onSrcTokenPrivilegeDidExpire"&&(this.errorCode=xh.SRC_TOKEN_EXPIRED,this.state=Rs.RELAY_STATE_FAILURE),p.command==="onDestTokenPrivilegeDidExpire"&&(this.errorCode=xh.DEST_TOKEN_EXPIRED,this.state=Rs.RELAY_STATE_FAILURE))}),O(this,"onReconnect",async()=>{D.debug("[".concat(this.clientId,"] ChannelMediaSocket disconnect, reconnecting")),this.emit("event",il.NETWORK_DISCONNECTED),this.state=Rs.RELAY_STATE_IDLE,this.prevChannelMediaConfig&&this.sendStartRelayMessage(this.prevChannelMediaConfig).catch(p=>{this.state!==Rs.RELAY_STATE_IDLE&&(D.error("auto restart channel media relay failed",p.toString()),this.errorCode=xh.SERVER_CONNECTION_LOST,this.state=Rs.RELAY_STATE_FAILURE)})}),this.joinInfo=i,this.clientId=s,this.sid=qM(),this.signal=new cde(this.joinInfo,this.clientId,a),this.httpRetryConfig=u,this._resolution=h}async startChannelMediaRelay(i){if(this.state!==Rs.RELAY_STATE_IDLE)throw new ae(z.INVALID_OPERATION);this.state=Rs.RELAY_STATE_CONNECTING,await this.connect(),D.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success"));try{await this.sendStartRelayMessage(i)}catch(s){throw s.data&&s.data.serverResponse&&s.data.serverResponse.command==="SetSourceChannel"?new ae(z.CROSS_CHANNEL_FAILED_JOIN_SRC):s.data&&s.data.serverResponse&&s.serverResponse.command==="SetDestChannelStatus"?new ae(z.CROSS_CHANNEL_FAILED_JOIN_DEST):s.data&&s.data.serverResponse&&s.serverResponse.command==="StartPacketTransfer"?new ae(z.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST):s}this.prevChannelMediaConfig=i}async updateChannelMediaRelay(i){if(this.state!==Rs.RELAY_STATE_RUNNING)throw new ae(z.INVALID_OPERATION);await this.sendUpdateMessage(i),this.prevChannelMediaConfig=i}async setVideoProfile(i){if(this._resolution=i,this.state!==Rs.RELAY_STATE_RUNNING)throw new ae(z.INVALID_OPERATION);const s=this.genMessage(es.SetVideoProfile);await this.signal.request(s),D.debug("[".concat(this.clientId,"] startChannelMediaRelay: setVideoProfile success"))}async stopChannelMediaRelay(){await this.sendStopRelayMessage(),D.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state=Rs.RELAY_STATE_IDLE,this.dispose()}dispose(){D.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=ao.CancelToken.source(),this.state=Rs.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}async connect(){const i=await ide(this.joinInfo,this.cancelToken.token,this.httpRetryConfig);this.workerToken=i.workerToken,await this.signal.connect(i.addressList),this.emit("event",il.NETWORK_CONNECTED),this.signal.on("status",this.onStatus),this.signal.on("reconnecting",this.onReconnect)}async sendStartRelayMessage(i){const s=this.genMessage(es.StopPacketTransfer);await this.signal.request(s),await this.signal.waitStatus("Normal Quit"),D.debug("[".concat(this.clientId,"] startChannelMediaRelay: StopPacketTransfer success"));const a=this.genMessage(es.SetSdkProfile,i);await this.signal.request(a),D.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success"));const u=this.genMessage(es.SetSourceChannel,i);await this.signal.request(u),await this.signal.waitStatus("SetSourceChannelStatus"),this.emit("event",il.PACKET_JOINED_SRC_CHANNEL),D.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success"));const h=this.genMessage(es.SetSourceUserId,i);await this.signal.request(h),D.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success"));const p=this.genMessage(es.SetDestChannel,i);await this.signal.request(p),await this.signal.waitStatus("SetDestChannelStatus"),this.emit("event",il.PACKET_JOINED_DEST_CHANNEL),D.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success"));const _=this.genMessage(es.StartPacketTransfer,i);await this.signal.request(_),this.emit("event",il.PACKET_SENT_TO_DEST_CHANNEL),this.state=Rs.RELAY_STATE_RUNNING,D.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success")),this.setVideoProfile(this._resolution)}async sendUpdateMessage(i){const s=this.genMessage(es.UpdateDestChannel,i);await this.signal.request(s),this.emit("event",il.PACKET_UPDATE_DEST_CHANNEL),D.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"))}async sendStopRelayMessage(){const i=this.genMessage(es.StopPacketTransfer);await this.signal.request(i),D.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))}genMessage(i,s){const a=[],u=[],h=[];this.requestId+=1;const p={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:Ua,sid:this.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};p.sdkVersion==="4.19.3"&&(p.sdkVersion="0.0.1");let _=null,v=null;switch(i){case es.SetSdkProfile:return p.clientRequest={command:"SetSdkProfile",type:"multi_channel"},p;case es.SetSourceChannel:if(v=s&&s.getSrcChannelMediaInfo(),!v)throw new ae(z.UNEXPECTED_ERROR,"can not find source config");return p.clientRequest={command:"SetSourceChannel",uid:"0",channelName:v.channelName,token:v.token||this.joinInfo.appId},p;case es.SetSourceUserId:if(v=s&&s.getSrcChannelMediaInfo(),!v)throw new ae(z.UNEXPECTED_ERROR,"can not find source config");return p.clientRequest={command:"SetSourceUserId",uid:v.uid+""},p;case es.SetDestChannel:if(_=s&&s.getDestChannelMediaInfo(),!_)throw new ae(z.UNEXPECTED_ERROR,"can not find dest config");return _.forEach(T=>{a.push(T.channelName),u.push(T.uid+""),h.push(T.token||this.joinInfo.appId)}),p.clientRequest={command:"SetDestChannel",channelName:a,uid:u,token:h},p;case es.StartPacketTransfer:return p.clientRequest={command:"StartPacketTransfer"},p;case es.Reconnect:return p.clientRequest={command:"Reconnect"},p;case es.StopPacketTransfer:return p.clientRequest={command:"StopPacketTransfer"},p;case es.UpdateDestChannel:if(_=s&&s.getDestChannelMediaInfo(),!_)throw new ae(z.UNEXPECTED_ERROR,"can not find dest config");return _.forEach(T=>{a.push(T.channelName),u.push(T.uid+""),h.push(T.token||this.joinInfo.appId)}),p.clientRequest={command:"UpdateDestChannel",channelName:a,uid:u,token:h},p;case es.SetVideoProfile:p.clientRequest={command:"SetVideoProfile",width:this._resolution.width,height:this._resolution.height}}return p}}class Wr{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio)return this._audioTrack}get videoTrack(){if(this.hasVideo)return this._videoTrack}get dataChannels(){return this._dataChannels}constructor(i,s){O(this,"uid",void 0),O(this,"_uintid",void 0),O(this,"_trust_in_room_",!0),O(this,"_trust_audio_enabled_state_",!0),O(this,"_trust_video_enabled_state_",!0),O(this,"_trust_audio_mute_state_",!0),O(this,"_trust_video_mute_state_",!0),O(this,"_audio_muted_",!1),O(this,"_video_muted_",!1),O(this,"_audio_enabled_",!0),O(this,"_video_enabled_",!0),O(this,"_audio_added_",!1),O(this,"_video_added_",!1),O(this,"_trust_video_stream_added_state_",!0),O(this,"_trust_audio_stream_added_state_",!0),O(this,"_audioTrack",void 0),O(this,"_videoTrack",void 0),O(this,"_dataChannels",[]),O(this,"_audioSSRC",void 0),O(this,"_videoSSRC",void 0),O(this,"_audioOrtc",void 0),O(this,"_videoOrtc",void 0),O(this,"_cname",void 0),O(this,"_rtxSsrcId",void 0),this.uid=i,this._uintid=s}}var ude=o8,dde=Kl;Kn({target:"Promise",stat:!0,forced:!0},{withResolvers:function(){var o=dde.f(this);return{promise:o.promise,resolve:o.resolve,reject:o.reject}}});var hde=Kl,fde=L_;Kn({target:"Promise",stat:!0,forced:!0},{try:function(o){var i=hde.f(this),s=fde(o);return(s.error?i.reject:i.resolve)(s.value),i.promise}});var CU=rn(ude),JH=fh.f("asyncIterator"),pde=rn(JH);function RU(o,i){this.v=o,this.k=i}function vS(o){var i,s;function a(h,p){try{var _=o[h](p),v=_.value,T=v instanceof RU;CU.resolve(T?v.v:v).then(function(b){if(T){var C=h==="return"?"return":"next";if(!v.k||b.done)return a(C,b);b=o[C](b).value}u(_.done?"return":"normal",b)},function(b){a("throw",b)})}catch(b){u("throw",b)}}function u(h,p){switch(h){case"return":i.resolve({value:p,done:!0});break;case"throw":i.reject(p);break;default:i.resolve({value:p,done:!1})}(i=i.next)?a(i.key,i.arg):s=null}this._invoke=function(h,p){return new CU(function(_,v){var T={key:h,arg:p,resolve:_,reject:v,next:null};s?s=s.next=T:(i=s=T,a(h,p))})},typeof o.return!="function"&&(this.return=void 0)}function Ha(o){return function(){return new vS(o.apply(this,arguments))}}function en(o){return new RU(o,0)}function nA(o){var i={},s=!1;function a(u,h){return s=!0,{done:!1,value:new RU(h=new CU(function(p){p(o[u](h))}),1)}}return i[nd!==void 0&&gR||"@@iterator"]=function(){return this},i.next=function(u){return s?(s=!1,u):a("next",u)},typeof o.throw=="function"&&(i.throw=function(u){if(s)throw s=!1,u;return a("throw",u)}),typeof o.return=="function"&&(i.return=function(u){return s?(s=!1,u):a("return",u)}),i}vS.prototype[typeof nd=="function"&&pde||"@@asyncIterator"]=function(){return this},vS.prototype.next=function(o){return this._invoke("next",o)},vS.prototype.throw=function(o){return this._invoke("throw",o)},vS.prototype.return=function(o){return this._invoke("return",o)};var QH=rn(JH),ZH={exports:{}};(function(o,i){o.exports=(()=>{var s={8:(h,p,_)=>{_.r(p),_.d(p,{Parser:()=>wt,Printer:()=>jo,parse:()=>yt,print:()=>tn});const v=`
`,T="".concat("\r").concat(v),b=" ";let C;function N(Fe){return Fe>="0"&&Fe<="9"}function x(Fe){return Fe>="!"&&Fe<="~"}function B(Fe){return x(Fe)||Fe>=""&&Fe<="ÿ"}function F(Fe){return Fe==="!"||Fe>="#"&&Fe<="'"||Fe>="*"&&Fe<="+"||Fe>="-"&&Fe<="."||Fe>="0"&&Fe<="9"||Fe>="A"&&Fe<="Z"||Fe>="^"&&Fe<="~"}function H(Fe){return Fe>="1"&&Fe<="9"}function J(Fe){return Fe>="A"&&Fe<="Z"||Fe>="a"&&Fe<="z"}function ee(Fe){return Fe==="d"||Fe==="h"||Fe==="m"||Fe==="s"}function se(Fe){return Fe>""&&Fe<"	"||Fe>"\v"&&Fe<"\f"||Fe>""&&Fe<"ÿ"}function ye(Fe){return J(Fe)||N(Fe)||Fe==="+"||Fe==="/"}function me(Fe){return N(Fe)||J(Fe)||Fe==="+"||Fe==="/"||Fe==="-"||Fe==="_"}function ue(Fe){return J(Fe)||N(Fe)||Fe==="+"||Fe==="/"}function he(Fe,L){var X=Object.keys(Fe);if(Object.getOwnPropertySymbols){var ie=Object.getOwnPropertySymbols(Fe);L&&(ie=ie.filter(function(Ae){return Object.getOwnPropertyDescriptor(Fe,Ae).enumerable})),X.push.apply(X,ie)}return X}function pe(Fe){for(var L=1;L<arguments.length;L++){var X=arguments[L]!=null?arguments[L]:{};L%2?he(Object(X),!0).forEach(function(ie){Ve(Fe,ie,X[ie])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Fe,Object.getOwnPropertyDescriptors(X)):he(Object(X)).forEach(function(ie){Object.defineProperty(Fe,ie,Object.getOwnPropertyDescriptor(X,ie))})}return Fe}function Ve(Fe,L,X){return L in Fe?Object.defineProperty(Fe,L,{value:X,enumerable:!0,configurable:!0,writable:!0}):Fe[L]=X,Fe}(function(Fe){Fe.VERSION="v",Fe.ORIGIN="o",Fe.SESSION_NAME="s",Fe.INFORMATION="i",Fe.URI="u",Fe.EMAIL="e",Fe.PHONE="p",Fe.CONNECTION="c",Fe.BANDWIDTH="b",Fe.TIME="t",Fe.REPEAT="r",Fe.ZONE_ADJUSTMENTS="z",Fe.KEY="k",Fe.ATTRIBUTE="a",Fe.MEDIA="m"})(C||(C={}));class Me{consumeText(L,X){let ie=X;for(;ie<L.length;){const Ae=L[ie];if(Ae==="\0"||Ae==="\r"||Ae===v)break;ie+=1}if(ie-X==0)throw new Error("Invalid text, at ".concat(L));return ie}consumeUnicastAddress(L,X,ie){return this.consumeTill(L,X,b)}consumeOneOrMore(L,X,ie){let Ae=X;for(;ie(L[Ae]);)Ae++;if(Ae-X==0)throw new Error("Invalid rule at ".concat(X,"."));return Ae}consumeSpace(L,X){if(L[X]===b)return X+1;throw new Error("Invalid space at ".concat(X,"."))}consumeIP4Address(L,X){let ie=X;for(let Ae=0;Ae<4;Ae++)if(ie=this.consumeDecimalUChar(L,ie),Ae!==3){if(L[ie]!==".")throw new Error("Invalid IP4 address.");ie++}return ie}consumeDecimalUChar(L,X){let ie=X;for(let Tt=0;Tt<3&&N(L[ie]);Tt++,ie++);if(ie-X==0)throw new Error("Invalid decimal uchar.");const Ae=parseInt(L.slice(X,ie));if(Ae>=0&&Ae<=255)return ie;throw new Error("Invalid decimal uchar")}consumeIP6Address(L,X){let ie=this.consumeHexpart(L,X);return L[ie]===":"&&(ie+=1,ie=this.consumeIP4Address(L,ie)),ie}consumeHexpart(L,X){let ie=X;if(L[ie]===":"&&L[ie+1]===":"){ie+=2;try{ie=this.consumeHexseq(L,ie)}catch{}return ie}if(ie=this.consumeHexseq(L,ie),L[ie]===":"&&L[ie+1]===":"){ie+=2;try{ie=this.consumeHexseq(L,ie)}catch{}return ie}return ie}consumeHexseq(L,X){let ie=X;for(;ie=this.consumeHex4(L,ie),L[ie]===":"&&L[ie+1]!==":";)ie+=1;return ie}consumeHex4(L,X){let ie=0;for(;ie<4;ie++)if(!((Ae=L[X+ie])>="0"&&Ae<="9"||Ae>="a"&&Ae<="f"||Ae>="A"&&Ae<="F")){if(ie===0)throw new Error("Invalid hex 4");break}var Ae;return X+ie}consumeFQDN(L,X){let ie=X;for(;N(L[ie])||J(L[ie])||L[ie]==="-"||L[ie]===".";)ie+=1;if(ie-X<4)throw new Error("Invalid FQDN");return ie}consumeExtnAddr(L,X){return this.consumeOneOrMore(L,X,B)}consumeMulticastAddress(L,X,ie){switch(ie){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(L,X);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(L,X);default:try{return this.consumeFQDN(L,X)}catch{return this.consumeExtnAddr(L,X)}}}consumeIP6MulticastAddress(L,X){const ie=this.consumeHexpart(L,X);return L[ie]==="/"?this.consumeInteger(L,ie+1):ie}consumeIP4MulticastAddress(L,X){let ie=X+3;const Ae=L.slice(X,ie),Tt=parseInt(Ae);if(Tt<224||Tt>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let Mn=0;Mn<3;Mn++){if(L[ie]!==".")throw new Error("Invalid IP4 multicast address.");ie+=1,ie=this.consumeDecimalUChar(L,ie)}return L[ie]==="/"&&(ie+=1),ie=this.consumeTTL(L,ie),L[ie]==="/"&&(ie=this.consumeInteger(L,ie)),ie}consumeInteger(L,X){if(!H(L[X]))throw new Error("Invalid integer.");for(X+=1;N(L[X]);)X+=1;return X}consumeTTL(L,X){if(L[X]==="0")return X+1;if(!H(L[X]))throw new Error("Invalid TTL.");X+=1;for(let ie=0;ie<2&&N(L[X]);ie++)X+=1;return X}consumeToken(L,X){return this.consumeOneOrMore(L,X,F)}consumeTime(L,X){let ie=X;if(L[ie]==="0")return ie+1;for(H(L[ie])&&(ie+=1);N(L[ie]);)ie++;if(ie-X<10)throw new Error("Invalid time");return ie}consumeAddress(L,X){return this.consumeTill(L,X,b)}consumeTypedTime(L,X){let ie=X;return ie=this.consumeOneOrMore(L,ie,N),ee(L[ie])?ie+1:ie}consumeRepeatInterval(L,X){if(!H(L[X]))throw new Error("Invalid repeat interval");for(X+=1;N(L[X]);)X+=1;return ee(L[X])&&(X+=1),X}consumePort(L,X){return this.consumeOneOrMore(L,X,N)}consume(L,X,ie){for(let Ae=0;Ae<ie.length;Ae++){if(X+Ae>=L.length)throw new Error("consume exceeding value length");if(L[X+Ae]!==ie[Ae])throw new Error("consume ".concat(ie," failed at ").concat(Ae))}return X+ie.length}consumeTill(L,X,ie){let Ae=X;for(;Ae<L.length&&(typeof ie!="string"||L[Ae]!==ie)&&(typeof ie!="function"||!ie(L[Ae]));)Ae++;return Ae}}class wt extends Me{constructor(){super(),Ve(this,"records",[]),Ve(this,"currentLine",0)}parse(L){const X=this.probeEOL(L);this.records=L.split(X).filter(Fi=>!!Fi.trim()).map(this.parseLine),this.currentLine=0;const ie=this.parseVersion(),Ae=this.parseOrigin(),Tt=this.parseSessionName(),Mn=this.parseInformation(),$r=this.parseUri(),Fo=this.parseEmail(),md=this.parsePhone(),EA=this.parseConnection(),vA=this.parseBandWidth(),qa=this.parseTimeFields(),Xh=this.parseKey(),gE=this.parseSessionAttribute(),pi=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:ie,origin:Ae,sessionName:Tt,information:Mn,uri:$r,emails:Fo,phones:md,connection:EA,bandwidths:vA,timeFields:qa,key:Xh,attributes:gE,mediaDescriptions:pi}}getCurrentRecord(){const L=this.records[this.currentLine];if(!L)throw new Error("Record doesn't exit.");return L}probeEOL(L){for(let X=0;X<L.length;X++)if(L[X]===v)return L[X-1]==="\r"?T:v;throw new Error("Invalid newline character.")}parseLine(L,X){if(L.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");const ie=L[0];if(L[1]!=="=")throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:ie,value:L.slice(2),line:X,cur:0}}parseSessionAttribute(){const L=new si;for(;this.currentLine<this.records.length;){const X=this.getCurrentRecord();if(X.type!==C.ATTRIBUTE)break;const ie={attField:this.extractOneOrMore(X,Ae=>F(Ae)&&Ae!==":"),_cur:0};X.value[X.cur]===":"&&(X.cur+=1,ie.attValue=this.extractOneOrMore(X,se)),L.parse(ie),this.currentLine++}return L.digest()}parseMediaAttributes(L){const X=new ji(L);for(;this.currentLine<this.records.length;){const ie=this.getCurrentRecord();if(ie.type!==C.ATTRIBUTE)break;const Ae={attField:this.extractOneOrMore(ie,Tt=>F(Tt)&&Tt!==":"),_cur:0};ie.value[ie.cur]===":"&&(ie.cur+=1,Ae.attValue=this.extractOneOrMore(ie,se)),X.parse(Ae),this.currentLine++}return X.digest()}parseKey(){const L=this.getCurrentRecord();if(L.type===C.KEY){if(L.value==="prompt"||L.value==="clear:"||L.value==="base64:"||L.value==="uri:")return L.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){const L=this.getCurrentRecord();if(L.type===C.ZONE_ADJUSTMENTS){const X=[];for(;;)try{const ie=this.extract(L,this.consumeTime);this.consumeSpaceForRecord(L);let Ae=!1;L.value[L.cur]==="-"&&(Ae=!0,L.cur+=1);const Tt=this.extract(L,this.consumeTypedTime);X.push({time:ie,typedTime:Tt,back:Ae})}catch{break}if(X.length===0)throw new Error("Invalid zone adjustments");return this.currentLine++,X}return[]}parseRepeat(){const L=[];for(;;){const X=this.getCurrentRecord();if(X.type!==C.REPEAT)break;{const ie=this.extract(X,this.consumeRepeatInterval),Ae=this.parseTypedTime(X);L.push({repeatInterval:ie,typedTimes:Ae}),this.currentLine++}}return L}parseTypedTime(L){const X=[];for(;;)try{this.consumeSpaceForRecord(L),X.push(this.extract(L,this.consumeTypedTime))}catch{break}if(X.length===0)throw new Error("Invalid typed time.");return X}parseTime(){const L=this.getCurrentRecord(),X=this.extract(L,this.consumeTime);this.consumeSpaceForRecord(L);const ie=this.extract(L,this.consumeTime);return this.currentLine++,{startTime:X,stopTime:ie}}parseBandWidth(){const L=[];for(;this.currentLine<this.records.length;){const X=this.getCurrentRecord();if(X.type!==C.BANDWIDTH)break;{const ie=this.extractOneOrMore(X,F);if(X.value[X.cur]!==":")throw new Error("Invalid bandwidth field.");X.cur++;const Ae=this.extractOneOrMore(X,N);L.push({bwtype:ie,bandwidth:Ae}),this.currentLine++}}return L}parseVersion(){const L=this.getCurrentRecord();if(L.type!==C.VERSION)throw new Error("first sdp record must be version");const X=L.value.slice(0,this.consumeOneOrMore(L.value,0,N));if(X.length!==L.value.length)throw new Error('invalid proto version, "v='.concat(L.value,'"'));return this.currentLine++,X}parseOrigin(){const L=this.getCurrentRecord();if(L.type!==C.ORIGIN)throw new Error("second line of sdp must be origin");const X=this.extractOneOrMore(L,B);this.consumeSpaceForRecord(L);const ie=this.extractOneOrMore(L,N);this.consumeSpaceForRecord(L);const Ae=this.extractOneOrMore(L,N);this.consumeSpaceForRecord(L);const Tt=this.extractOneOrMore(L,F);this.consumeSpaceForRecord(L);const Mn=this.extractOneOrMore(L,F);this.consumeSpaceForRecord(L);const $r=this.extract(L,this.consumeUnicastAddress);return this.currentLine++,{username:X,sessId:ie,sessVersion:Ae,nettype:Tt,addrtype:Mn,unicastAddress:$r}}parseSessionName(){const L=this.getCurrentRecord();if(L.type===C.SESSION_NAME){const X=this.extract(L,this.consumeText);return this.currentLine++,X}}parseInformation(){const L=this.getCurrentRecord();if(L.type!==C.INFORMATION)return;const X=this.extract(L,this.consumeText);return this.currentLine++,X}parseUri(){const L=this.getCurrentRecord();if(L.type===C.URI)return this.currentLine++,L.value}parseEmail(){const L=[];for(;;){const X=this.getCurrentRecord();if(X.type!==C.EMAIL)break;L.push(X.value),this.currentLine++}return L}parsePhone(){const L=[];for(;;){const X=this.getCurrentRecord();if(X.type!==C.PHONE)break;L.push(X.value),this.currentLine++}return L}parseConnection(){const L=this.getCurrentRecord();if(L.type===C.CONNECTION){const X=this.extractOneOrMore(L,F);this.consumeSpaceForRecord(L);const ie=this.extractOneOrMore(L,F);this.consumeSpaceForRecord(L);const Ae=this.extract(L,this.consumeAddress);return this.currentLine++,{nettype:X,addrtype:ie,address:Ae}}}parseMedia(){const L=this.getCurrentRecord(),X=this.extract(L,this.consumeToken);this.consumeSpaceForRecord(L);let ie=this.extract(L,this.consumePort);L.value[L.cur]==="/"&&(L.cur+=1,ie+=this.extract(L,this.consumeInteger)),this.consumeSpaceForRecord(L);const Ae=[];for(Ae.push(this.extract(L,this.consumeToken));L.value[L.cur]==="/";)L.cur+=1,Ae.push(this.extract(L,this.consumeToken));if(Ae.length===0)throw new Error("Invalid proto");const Tt=this.parseFmt(L);return this.currentLine++,{mediaType:X,port:ie,protos:Ae,fmts:Tt}}parseTimeFields(){const L=[];for(;this.getCurrentRecord().type===C.TIME;){const X=this.parseTime(),ie=this.parseRepeat(),Ae=this.parseZone();L.push({time:X,repeats:ie,zones:Ae})}return L}parseMediaDescription(){const L=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===C.MEDIA;){const X=this.parseMedia(),ie=this.parseInformation(),Ae=this.parseConnections(),Tt=this.parseBandWidth(),Mn=this.parseKey(),$r=this.parseMediaAttributes(X);L.push({media:X,information:ie,connections:Ae,bandwidths:Tt,key:Mn,attributes:$r})}return L}parseConnections(){const L=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===C.CONNECTION;)L.push(this.parseConnection());return L}parseFmt(L){const X=[];for(;;)try{this.consumeSpaceForRecord(L),X.push(this.extract(L,this.consumeToken))}catch{break}if(X.length===0)throw new Error("Invalid fmts");return X}extract(L,X,...ie){const Ae=X.call(this,L.value,L.cur,...ie),Tt=L.value.slice(L.cur,Ae);return L.cur=Ae,Tt}extractOneOrMore(L,X){const ie=this.consumeOneOrMore(L.value,L.cur,X),Ae=L.value.slice(L.cur,ie);return L.cur=ie,Ae}consumeSpaceForRecord(L){if(L.value[L.cur]!==b)throw new Error("Invalid space at ".concat(L.cur,"."));L.cur+=1}}class zt extends Me{constructor(...L){super(...L),Ve(this,"attributes",void 0),Ve(this,"digested",!1)}extractOneOrMore(L,X,ie){const Ae=this.consumeOneOrMore(L.attValue,L._cur,X),Tt=L.attValue.slice(L._cur,Ae),[Mn,$r]=ie||[];if(typeof Mn=="number"&&Tt.length<Mn)throw new Error("error in length, should be more or equal than ".concat(Mn," characters."));if(typeof $r=="number"&&Tt.length>$r)throw new Error("error in length, should be less or equal than ".concat($r," characters."));return L._cur=Ae,Tt}consumeAttributeSpace(L){if(L.attValue[L._cur]!==b)throw new Error("Invalid space at ".concat(L._cur,"."));L._cur+=1}extract(L,X,...ie){if(!L.attValue)throw new Error("Nothing to extract from attValue.");const Ae=X.call(this,L.attValue,L._cur,...ie),Tt=L.attValue.slice(L._cur,Ae);return L._cur=Ae,Tt}atEnd(L){if(!L.attValue)throw new Error;return L._cur>=L.attValue.length}peekChar(L){if(!L.attValue)throw new Error;return L.attValue[L._cur]}peek(L,X){if(!L.attValue)throw new Error;for(let ie=0;ie<X.length;ie++)if(X[ie]!==L.attValue[L._cur+ie])return!1;return!0}parseIceUfrag(L){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(L,ye,[4,256])}parseIcePwd(L){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(L,ye,[22,256])}parseIceOptions(L){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");const X=[];for(;!this.atEnd(L);){X.push(this.extractOneOrMore(L,ye));try{this.consumeAttributeSpace(L)}catch(ie){if(this.atEnd(L))break;throw ie}}this.attributes.iceOptions=X}parseFingerprint(L){const X=this.extract(L,this.consumeToken);this.consumeAttributeSpace(L);const ie=this.extract(L,this.consumeTill);this.attributes.fingerprints.push({hashFunction:X,fingerprint:ie})}parseExtmap(L){const X=this.extractOneOrMore(L,N);let ie;this.peekChar(L)==="/"&&(this.extract(L,this.consume,"/"),ie=this.extract(L,this.consumeToken)),this.consumeAttributeSpace(L);const Ae=this.extract(L,this.consumeTill,b),Tt=pe(pe({entry:parseInt(X,10)},ie&&{direction:ie}),{},{extensionName:Ae});this.peekChar(L)===b&&(this.consumeAttributeSpace(L),Tt.extensionAttributes=this.extract(L,this.consumeTill)),this.attributes.extmaps.push(Tt)}parseSetup(L){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");const X=this.extract(L,this.consumeTill);if(X!=="active"&&X!=="passive"&&X!=="actpass"&&X!=="holdconn")throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=X}}class si extends zt{constructor(...L){super(...L),Ve(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(L){if(this.digested)throw new Error("already digested");try{switch(L.attField){case"group":this.parseGroup(L);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(L);break;case"ice-pwd":this.parseIcePwd(L);break;case"ice-options":this.parseIceOptions(L);break;case"fingerprint":this.parseFingerprint(L);break;case"setup":this.parseSetup(L);break;case"tls-id":this.parseTlsId(L);break;case"identity":this.parseIdentity(L);break;case"extmap":this.parseExtmap(L);break;case"msid-semantic":this.parseMsidSemantic(L);break;default:L.ignored=!0,this.attributes.unrecognized.push(L)}}catch(X){throw console.error("parsing session attribute ".concat(L.attField,' error, "a=').concat(L.attField,":").concat(L.attValue,'"')),X}if(!L.ignored&&L.attValue&&!this.atEnd(L))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(L){const X=this.extract(L,this.consumeToken),ie=[];for(;!this.atEnd(L)&&this.peekChar(L)===b;)this.consumeAttributeSpace(L),ie.push(this.extract(L,this.consumeToken));this.attributes.groups.push({semantic:X,identificationTag:ie})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(L){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(L,me)}parseIdentity(L){const X=this.extractOneOrMore(L,ue),ie=[];for(;!this.atEnd(L)&&this.peekChar(L)===b;){this.consumeAttributeSpace(L);const Ae=this.extract(L,this.consumeToken);this.extract(L,this.consume,"=");const Tt=this.extractOneOrMore(L,Mn=>Mn!==b&&se(Mn));ie.push({name:Ae,value:Tt})}this.attributes.identities.push({assertionValue:X,extensions:ie})}parseMsidSemantic(L){this.peekChar(L)===b&&this.consumeAttributeSpace(L);const X={semantic:this.extract(L,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(L)}catch{break}if(this.peekChar(L)==="*"){this.extract(L,this.consume,"*"),X.applyForAll=!0;break}{const ie=this.extract(L,this.consumeTill,b);X.identifierList.push(ie)}}this.attributes.msidSemantic=X}}class ji extends zt{constructor(L){super(),Ve(this,"attributes",void 0),L.protos.indexOf("RTP")!==-1||L.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(L){if(this.digested)throw new Error("already digested");try{switch(L.attField){case"extmap":this.parseExtmap(L);break;case"setup":this.parseSetup(L);break;case"ice-ufrag":this.parseIceUfrag(L);break;case"ice-pwd":this.parseIcePwd(L);break;case"ice-options":this.parseIceOptions(L);break;case"candidate":this.parseCandidate(L);break;case"remote-candidate":this.parseRemoteCandidate(L);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(L);break;case"rtpmap":this.parseRtpmap(L);break;case"ptime":this.parsePtime(L);break;case"maxptime":this.parseMaxPtime(L);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(L);break;case"ssrc":this.parseSSRC(L);break;case"fmtp":this.parseFmtp(L);break;case"rtcp-fb":this.parseRtcpFb(L);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(L);break;case"mid":this.parseMid(L);break;case"msid":this.parseMsid(L);break;case"imageattr":this.parseImageAttr(L);break;case"rid":this.parseRid(L);break;case"simulcast":this.parseSimulcast(L);break;case"sctp-port":this.parseSctpPort(L);break;case"max-message-size":this.parseMaxMessageSize(L);break;case"ssrc-group":this.parseSSRCGroup(L);break;default:L.ignored=!0,this.attributes.unrecognized.push(L)}}catch(X){throw console.error("parsing media attribute ".concat(L.attField,' error, "a=').concat(L.attField,":").concat(L.attValue,'"')),X}if(!L.ignored&&L.attValue&&!this.atEnd(L))throw new Error("attribute parsing error")}parseCandidate(L){const X=this.extractOneOrMore(L,ye,[1,32]);this.consumeAttributeSpace(L);const ie=this.extractOneOrMore(L,N,[1,5]);this.consumeAttributeSpace(L);const Ae=this.extract(L,this.consumeToken);this.consumeAttributeSpace(L);const Tt=this.extractOneOrMore(L,N,[1,10]);this.consumeAttributeSpace(L);const Mn=this.extract(L,this.consumeAddress);this.consumeAttributeSpace(L);const $r=this.extract(L,this.consumePort);this.consumeAttributeSpace(L),this.extract(L,this.consume,"typ"),this.consumeAttributeSpace(L);const Fo={foundation:X,componentId:ie,transport:Ae,priority:Tt,connectionAddress:Mn,port:$r,type:this.extract(L,this.consumeToken),extension:{}};for(this.peek(L," raddr")&&(this.extract(L,this.consume," raddr"),this.consumeAttributeSpace(L),Fo.relAddr=this.extract(L,this.consumeAddress)),this.peek(L," rport")&&(this.extract(L,this.consume," rport"),this.consumeAttributeSpace(L),Fo.relPort=this.extract(L,this.consumePort));this.peekChar(L)===b;){this.consumeAttributeSpace(L);const md=this.extract(L,this.consumeToken);this.consumeAttributeSpace(L),Fo.extension[md]=this.extractOneOrMore(L,x)}this.attributes.candidates.push(Fo)}parseRemoteCandidate(L){const X=[];for(;;){const ie=this.extractOneOrMore(L,N,[1,5]);this.consumeAttributeSpace(L);const Ae=this.extract(L,this.consumeAddress);this.consumeAttributeSpace(L);const Tt=this.extract(L,this.consumePort);X.push({componentId:ie,connectionAddress:Ae,port:Tt});try{this.consumeAttributeSpace(L)}catch{break}}this.attributes.remoteCandidatesList.push(X)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(L){const X=this.extract(L,this.consumeToken);this.consumeAttributeSpace(L);const ie=this.extract(L,this.consumeTill,"/");this.extract(L,this.consume,"/");const Ae={encodingName:ie,clockRate:this.extractOneOrMore(L,N)};this.atEnd(L)||this.peekChar(L)!=="/"||(this.extract(L,this.consume,"/"),Ae.encodingParameters=parseInt(this.extract(L,this.consumeTill),10));const Tt=this.attributes.payloads.find(Mn=>Mn.payloadType===parseInt(X,10));Tt?Tt.rtpMap=Ae:this.attributes.payloads.push({payloadType:parseInt(X,10),rtpMap:Ae,rtcpFeedbacks:[]})}parsePtime(L){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(L,this.consumeTill)}parseMaxPtime(L){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(L,this.consumeTill)}parseDirection(L){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=L.attField}parseSSRC(L){const X=this.extractOneOrMore(L,N);this.consumeAttributeSpace(L);const ie=this.extract(L,this.consumeTill,":");let Ae;this.peekChar(L)===":"&&(this.extract(L,this.consume,":"),Ae=this.extract(L,this.consumeTill));const Tt=this.attributes.ssrcs.find(Mn=>Mn.ssrcId===parseInt(X,10));Tt?Tt.attributes[ie]=Ae:this.attributes.ssrcs.push({ssrcId:parseInt(X,10),attributes:{[ie]:Ae}})}parseFmtp(L){const X=this.extract(L,this.consumeTill,b);this.consumeAttributeSpace(L);const ie=this.extract(L,this.consumeTill),Ae={};ie.split(";").forEach(Mn=>{let[$r,Fo]=Mn.split("=");$r=$r.trim();const md=typeof Fo=="string"?Fo.trim():null;typeof $r=="string"&&$r.length>0&&(Ae[$r]=md)});const Tt=this.attributes.payloads.find(Mn=>Mn.payloadType===parseInt(X,10));Tt?Tt.fmtp={parameters:Ae}:this.attributes.payloads.push({payloadType:parseInt(X,10),rtcpFeedbacks:[],fmtp:{parameters:Ae}})}parseFmtParameters(L){const X={},ie=this.extract(L,this.consumeTill,"=");L._cur++;const Ae=this.extract(L,this.consumeTill,";");for(X[ie]=Ae;L.attValue[L._cur]===";";){const Tt=this.extract(L,this.consumeTill,"=");L._cur++;const Mn=this.extract(L,this.consumeTill,";");X[Tt]=Mn}return X}parseRtcpFb(L){let X="";X=this.peekChar(L)==="*"?this.extract(L,this.consume,"*"):this.extract(L,this.consumeTill,b),this.consumeAttributeSpace(L);const ie=this.extract(L,this.consumeTill,b);let Ae;if(ie==="trr-int")Ae={type:ie,interval:this.extract(L,this.consumeTill)};else{const Tt={type:ie};this.peekChar(L)===b&&(this.consumeAttributeSpace(L),Tt.parameter=this.extract(L,this.consumeToken),this.peekChar(L)===b&&(Tt.additional=this.extract(L,this.consumeTill))),Ae=Tt}if(X==="*")this.attributes.rtcpFeedbackWildcards.push(Ae);else{const Tt=this.attributes.payloads.find(Mn=>Mn.payloadType===parseInt(X,10));Tt?Tt.rtcpFeedbacks.push(Ae):this.attributes.payloads.push({payloadType:parseInt(X,10),rtcpFeedbacks:[Ae]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(L){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");const X={port:this.extract(L,this.consumePort)};this.peekChar(L)===b&&(this.consumeAttributeSpace(L),X.netType=this.extractOneOrMore(L,F),this.consumeAttributeSpace(L),X.addressType=this.extractOneOrMore(L,F),this.consumeAttributeSpace(L),X.address=this.extract(L,this.consumeAddress)),this.attributes.rtcp=X}parseMsid(L){const X={id:this.extractOneOrMore(L,F,[1,64])};this.peekChar(L)===b&&(this.consumeAttributeSpace(L),X.appdata=this.extractOneOrMore(L,F,[1,64])),this.attributes.msids.push(X)}parseImageAttr(L){this.attributes.imageattr.push(L.attValue)}parseRid(L){const X=this.extractOneOrMore(L,Ae=>J(Ae)||N(Ae)||Ae==="_"||Ae==="-");this.consumeAttributeSpace(L);const ie={id:X,direction:this.extract(L,this.consumeToken),params:[]};if(this.peekChar(L)===b){if(this.consumeAttributeSpace(L),this.peek(L,"pt=")){this.extract(L,this.consume,"pt=");const Ae=[];for(;;){const Tt=this.extract(L,this.consumeToken);Ae.push(Tt);try{this.extract(L,this.consume,",")}catch{break}}ie.payloads=Ae,this.peekChar(L)===b&&this.extract(L,this.consume,b)}for(;;){const Ae=this.extract(L,this.consumeToken);switch(Ae){case"depend":{const Tt={type:Ae,rids:this.extract(L,this.consume,"=").split(",")};ie.params.push(Tt);break}default:{const Tt={type:Ae};this.peekChar(L)==="="&&(this.extract(L,this.consume,"="),Tt.val=this.extract(L,this.consumeTill,";")),ie.params.push(Tt)}}try{this.extract(L,this.consume,";")}catch{break}}}this.attributes.rids.push(ie)}parseSimulcast(L){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=L.attValue,this.extract(L,this.consumeTill)}parseSctpPort(L){this.attributes.sctpPort=this.extractOneOrMore(L,N,[1,5])}parseMaxMessageSize(L){this.attributes.maxMessageSize=this.extractOneOrMore(L,N,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(L){this.attributes.mid=this.extract(L,this.consumeToken)}parseSSRCGroup(L){const X=this.extract(L,this.consumeToken),ie=[];for(;;)try{this.consumeAttributeSpace(L);const Ae=this.extract(L,this.consumeInteger);ie.push(parseInt(Ae,10))}catch{break}this.attributes.ssrcGroups.push({semantic:X,ssrcIds:ie})}}function Fn(Fe,L,X){return L in Fe?Object.defineProperty(Fe,L,{value:X,enumerable:!0,configurable:!0,writable:!0}):Fe[L]=X,Fe}class jo{constructor(){Fn(this,"eol",T)}print(L,X){let ie="";return X&&(this.eol=X),ie+=this.printVersion(L.version),ie+=this.printOrigin(L.origin),ie+=this.printSessionName(L.sessionName),ie+=this.printInformation(L.information),ie+=this.printUri(L.uri),ie+=this.printEmail(L.emails),ie+=this.printPhone(L.phones),ie+=this.printConnection(L.connection),ie+=this.printBandwidth(L.bandwidths),ie+=this.printTimeFields(L.timeFields),ie+=this.printKey(L.key),ie+=this.printSessionAttributes(L.attributes),ie+=this.printMediaDescription(L.mediaDescriptions),ie}printVersion(L){return"v=".concat(L).concat(this.eol)}printOrigin(L){return"o=".concat(L.username," ").concat(L.sessId," ").concat(L.sessVersion," ").concat(L.nettype," ").concat(L.addrtype," ").concat(L.unicastAddress).concat(this.eol)}printSessionName(L){return L?"s=".concat(L).concat(this.eol):""}printInformation(L){return L?"i=".concat(L).concat(this.eol):""}printUri(L){return L?"u=".concat(L).concat(this.eol):""}printEmail(L){let X="";for(const ie of L)X+="e=".concat(ie).concat(this.eol);return X}printPhone(L){let X="";for(const ie of L)X+="e=".concat(ie).concat(this.eol);return X}printConnection(L){return L?"c=".concat(L.nettype," ").concat(L.addrtype," ").concat(L.address).concat(this.eol):""}printBandwidth(L){let X="";for(const ie of L)X+="b=".concat(ie.bwtype,":").concat(ie.bandwidth).concat(this.eol);return X}printTimeFields(L){let X="";for(const ie of L){X+="t=".concat(ie.time.startTime," ").concat(ie.time.startTime).concat(this.eol);for(const Ae of ie.repeats)X+="r=".concat(Ae.repeatInterval," ").concat(Ae.typedTimes.join(" ")).concat(this.eol);ie.zoneAdjustments&&(X+="z=",X+="z=".concat(ie.zoneAdjustments.map(Ae=>"".concat(Ae.time," ").concat(Ae.back?"-":""," ").concat(Ae.typedTime)).join(" ")).concat(this.eol),X+=this.eol)}return X}printKey(L){return L?"k=".concat(L).concat(this.eol):""}printAttributes(L){let X="";for(const ie of L)X+="a=".concat(ie.attField).concat(ie.attValue?":".concat(ie.attValue):"").concat(this.eol);return X}printMediaDescription(L){let X="";for(const ie of L)X+=this.printMedia(ie.media),X+=this.printInformation(ie.information),X+=this.printConnections(ie.connections),X+=this.printBandwidth(ie.bandwidths),X+=this.printKey(ie.key),X+=this.printMediaAttributes(ie);return X}printConnections(L){let X="";for(const ie of L)X+=this.printConnection(ie);return X}printMedia(L){return"m=".concat(L.mediaType," ").concat(L.port," ").concat(L.protos.join("/")," ").concat(L.fmts.join(" ")).concat(this.eol)}printSessionAttributes(L){return new ke(this.eol).print(L)}printMediaAttributes(L){return new Ze(this.eol).print(L)}}class Ce{constructor(L){Fn(this,"eol",void 0),this.eol=L}printIceUfrag(L){return L===void 0?"":"a=ice-ufrag:".concat(L).concat(this.eol)}printIcePwd(L){return L===void 0?"":"a=ice-pwd:".concat(L).concat(this.eol)}printIceOptions(L){return L===void 0?"":"a=ice-options:".concat(L.join(b)).concat(this.eol)}printFingerprints(L){return L.length>0?L.map(X=>"a=fingerprint:".concat(X.hashFunction).concat(b).concat(X.fingerprint)).join(this.eol)+this.eol:""}printExtmap(L){return L.map(X=>"a=extmap:".concat(X.entry).concat(X.direction?"/".concat(X.direction):"").concat(b).concat(X.extensionName).concat(X.extensionAttributes?"".concat(b).concat(X.extensionAttributes):"").concat(this.eol)).join("")}printSetup(L){return L===void 0?"":"a=setup:".concat(L).concat(this.eol)}printUnrecognized(L){return L.map(X=>"a=".concat(X.attField).concat(X.attValue?":".concat(X.attValue):"").concat(this.eol)).join("")}}class ke extends Ce{print(L){let X="";return X+=this.printGroups(L.groups),X+=this.printMsidSemantic(L.msidSemantic),X+=this.printIceLite(L.iceLite),X+=this.printIceUfrag(L.iceUfrag),X+=this.printIcePwd(L.icePwd),X+=this.printIceOptions(L.iceOptions),X+=this.printFingerprints(L.fingerprints),X+=this.printSetup(L.setup),X+=this.printTlsId(L.tlsId),X+=this.printIdentity(L.identities),X+=this.printExtmap(L.extmaps),X+=this.printUnrecognized(L.unrecognized),X}printGroups(L){let X="";return L.length>0&&(X+=L.map(ie=>"a=group:".concat(ie.semantic).concat(ie.identificationTag.map(Ae=>"".concat(b).concat(Ae)).join("")).concat(this.eol)).join("")),X}printIceLite(L){return L===void 0?"":"a=ice-lite"+this.eol}printTlsId(L){return L?"a=tls-id:".concat(L).concat(this.eol):""}printIdentity(L){return L.length===0?"":L.map(X=>"a=identity:".concat(X.assertionValue).concat(X.extensions.map(ie=>"".concat(b).concat(ie.name).concat(ie.value?"=".concat(ie.value):"")))).join(this.eol)+this.eol}printMsidSemantic(L){if(!L)return"";let X="a=msid-semantic:".concat(L.semantic);return L.applyForAll?X+="".concat(b,"*"):L.identifierList.length>0&&(X+=L.identifierList.map(ie=>"".concat(b).concat(ie))),X+this.eol}}class Ze extends Ce{print(L){const X=L.attributes;let ie="";return ie+=this.printRTCP(X.rtcp),ie+=this.printIceUfrag(X.iceUfrag),ie+=this.printIcePwd(X.icePwd),ie+=this.printIceOptions(X.iceOptions),ie+=this.printCandidates(X.candidates),ie+=this.printRemoteCandidatesList(X.remoteCandidatesList),ie+=this.printEndOfCandidates(X.endOfCandidates),ie+=this.printFingerprints(X.fingerprints),ie+=this.printSetup(X.setup),ie+=this.printMid(X.mid),ie+=this.printExtmap(X.extmaps),ie+=this.printRTPRelated(X),ie+=this.printPtime(X.ptime),ie+=this.printMaxPtime(X.maxPtime),ie+=this.printDirection(X.direction),ie+=this.printSSRCGroups(X.ssrcGroups),ie+=this.printSSRC(X.ssrcs),ie+=this.printRTCPMux(X.rtcpMux),ie+=this.printRTCPMuxOnly(X.rtcpMuxOnly),ie+=this.printRTCPRsize(X.rtcpRsize),ie+=this.printMSId(X.msids),ie+=this.printImageattr(X.imageattr),ie+=this.printRid(X.rids),ie+=this.printSimulcast(X.simulcast),ie+=this.printSCTPPort(X.sctpPort),ie+=this.printMaxMessageSize(X.maxMessageSize),ie+=this.printUnrecognized(X.unrecognized),ie}printCandidates(L){return L.map(X=>"a=candidate:".concat(X.foundation).concat(b).concat(X.componentId).concat(b).concat(X.transport).concat(b).concat(X.priority).concat(b).concat(X.connectionAddress).concat(b).concat(X.port).concat(b,"typ").concat(b).concat(X.type).concat(X.relAddr?"".concat(b,"raddr").concat(b).concat(X.relAddr):"").concat(X.relPort?"".concat(b,"rport").concat(b).concat(X.relPort):"").concat(Object.keys(X.extension).map(ie=>"".concat(b).concat(ie).concat(b).concat(X.extension[ie])).join("")).concat(this.eol)).join("")}printRemoteCandidatesList(L){return L.map(X=>"a=remote-candidates:".concat(X.join(b)).concat(this.eol)).join("")}printEndOfCandidates(L){return L===void 0?"":"a=end-of-candidates"+this.eol}printRTPRelated(L){if(!L.payloads)return"";const X=L.payloads;let ie="";ie+=L.rtcpFeedbackWildcards.map(Ae=>this.printRTCPFeedback("*",Ae)).join("");for(const Ae of X)ie+=this.printRtpMap(Ae.payloadType,Ae.rtpMap),ie+=this.printFmtp(Ae.payloadType,Ae.fmtp),ie+=Ae.rtcpFeedbacks.map(Tt=>this.printRTCPFeedback(Ae.payloadType,Tt)).join("");return ie}printFmtp(L,X){if(!X)return"";const ie=Object.keys(X.parameters);return ie.length===1&&X.parameters[ie[0]]===null?"a=fmtp:".concat(L).concat(b).concat(ie[0]).concat(this.eol):"a=fmtp:".concat(L).concat(b).concat(Object.keys(X.parameters).map(Ae=>"".concat(Ae,"=").concat(X.parameters[Ae])).join(";")).concat(this.eol)}printRtpMap(L,X){return X?"a=rtpmap:".concat(L).concat(b).concat(X.encodingName,"/").concat(X.clockRate).concat(X.encodingParameters?"/".concat(X.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(L,X){let ie="a=rtcp-fb:".concat(L).concat(b),Ae=X;return Ae.type==="trr-int"?ie+="ttr-int".concat(b).concat(Ae.interval):(ie+="".concat(Ae.type),Ae.parameter&&(ie+="".concat(b).concat(Ae.parameter),Ae.additional&&(ie+="".concat(b).concat(Ae.additional)))),ie+this.eol}printPtime(L){return L===void 0?"":"a=ptime:".concat(L).concat(this.eol)}printMaxPtime(L){return L===void 0?"":"a=maxptime:".concat(L).concat(this.eol)}printDirection(L){return L===void 0?"":"a=".concat(L).concat(this.eol)}printSSRC(L){return L.map(X=>Object.keys(X.attributes).map(ie=>"a=ssrc:".concat(X.ssrcId.toString(10)).concat(b).concat(ie).concat(X.attributes[ie]?":".concat(X.attributes[ie]):"").concat(this.eol)).join("")).join("")}printRTCPMux(L){return L===void 0?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(L){return L===void 0?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(L){return L===void 0?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(L){if(L===void 0)return"";let X="a=rtcp:".concat(L.port);return L.netType&&(X+="".concat(b).concat(L.netType)),L.addressType&&(X+="".concat(b).concat(L.addressType)),L.address&&(X+="".concat(b).concat(L.address)),X+this.eol}printMSId(L){return L.map(X=>"a=msid:".concat(X.id).concat(X.appdata?"".concat(b).concat(X.appdata):"").concat(this.eol)).join("")}printImageattr(L){return L.map(X=>"a=imageattr:".concat(X).concat(this.eol)).join("")}printRid(L){return L.map(X=>{let ie="a=rid:".concat(X.id).concat(b).concat(X.direction);return X.payloads&&(ie+="".concat(b,"pt=").concat(X.payloads.join(","))),X.params.length>0&&(ie+="".concat(b).concat(X.params.map(Ae=>Ae.type==="depend"?"depend=".concat(Ae.rids.join(",")):"".concat(Ae.type,"=").concat(Ae.val)).join(";"))),ie+this.eol}).join("")}printSimulcast(L){return L===void 0?"":"a=simulcast:".concat(L).concat(this.eol)}printSCTPPort(L){return L===void 0?"":"a=sctp-port:".concat(L).concat(this.eol)}printMaxMessageSize(L){return L===void 0?"":"a=max-message-size:".concat(L).concat(this.eol)}printMid(L){return L===void 0?"":"a=mid:".concat(L).concat(this.eol)}printSSRCGroups(L){return L.map(X=>"a=ssrc-group:".concat(X.semantic).concat(X.ssrcIds.map(ie=>"".concat(b).concat(ie.toString(10))).join("")).concat(this.eol)).join("")}}function yt(Fe){return new wt().parse(Fe)}function tn(Fe,L){return new jo().print(Fe,L)}}},a={};function u(h){if(a[h])return a[h].exports;var p=a[h]={exports:{}};return s[h](p,p.exports,u),p.exports}return u.d=(h,p)=>{for(var _ in p)u.o(p,_)&&!u.o(h,_)&&Object.defineProperty(h,_,{enumerable:!0,get:p[_]})},u.o=(h,p)=>Object.prototype.hasOwnProperty.call(h,p),u.r=h=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(h,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(h,"__esModule",{value:!0})},u(8)})()})(ZH);var li=ZH.exports;function e$(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function t$(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?e$(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):e$(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}function IU(o){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0;const{filterRTX:u,filterVideoFec:h,filterAudioFec:p,filterAudioCodec:_,filterVideoCodec:v}=i,{useXR:T}=s;let b=[],C=[],N=[],x=[],B=!1,F=!1;if(li.parse(o).mediaDescriptions.forEach(J=>{a&&a!==J.attributes.direction||(J.media.mediaType!=="video"||B||(C=J.attributes.payloads,x=J.attributes.extmaps,B=!0),J.media.mediaType!=="audio"||F||(b=J.attributes.payloads,N=J.attributes.extmaps,F=!0))}),!x||C.length===0)throw new Error("Cannot get video capabilities from SDP.");if(!N||b.length===0)throw new Error("Cannot get audio capabilities from SDP.");C.forEach(J=>{var ee;(ee=J.rtpMap)!==null&&ee!==void 0&&ee.clockRate&&(J.rtpMap.clockRate=parseInt(J.rtpMap.clockRate)),T&&J.rtcpFeedbacks.push({type:"rrtr"})}),b.forEach(J=>{var ee;(ee=J.rtpMap)!==null&&ee!==void 0&&ee.clockRate&&(J.rtpMap.clockRate=parseInt(J.rtpMap.clockRate)),T&&J.rtcpFeedbacks.push({type:"rrtr"})}),u&&(b=b.filter(J=>{var ee;return((ee=J.rtpMap)===null||ee===void 0?void 0:ee.encodingName.toLowerCase())!=="rtx"}),C=C.filter(J=>{var ee;return((ee=J.rtpMap)===null||ee===void 0?void 0:ee.encodingName.toLowerCase())!=="rtx"})),h&&(C=C.filter(J=>{var ee;return!/(red)|(ulpfec)|(flexfec)/i.test(((ee=J.rtpMap)===null||ee===void 0?void 0:ee.encodingName)||"")})),p&&(b=b.filter(J=>{var ee;return!/(red)|(ulpfec)|(flexfec)/i.test(((ee=J.rtpMap)===null||ee===void 0?void 0:ee.encodingName)||"")})),_&&(_==null?void 0:_.length)>0&&(b=b.filter(J=>{var ee;return ot(_).call(_,((ee=J.rtpMap)===null||ee===void 0?void 0:ee.encodingName.toLowerCase())||"")})),v&&(v==null?void 0:v.length)>0&&(C=C.filter(J=>{var ee;return ot(v).call(v,((ee=J.rtpMap)===null||ee===void 0?void 0:ee.encodingName.toLowerCase())||"")}));const H=te("UNSUPPORTED_VIDEO_CODEC");return H&&H.length>0&&(C=C.filter(J=>!(J.rtpMap&&ot(H).call(H,J.rtpMap.encodingName.toLowerCase())))),{audioCodecs:b,videoCodecs:C,audioExtensions:N,videoExtensions:x}}function am(o){const i=li.parse(o);let s,a;for(const u of i.mediaDescriptions){if(!s){const h=u.attributes.iceUfrag,p=u.attributes.icePwd;if(!h||!p)throw new Error("Cannot get iceUfrag or icePwd from SDP.");s={iceUfrag:h,icePwd:p}}if(!a){const h=u.attributes.fingerprints;h.length>0&&(a={fingerprints:h})}}if(!a&&i.attributes.fingerprints.length>0&&(a={fingerprints:i.attributes.fingerprints}),!a||!s)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:s,dtlsParameters:a}}function n$(o,i){const s=[],a=o.attributes.ssrcGroups.filter(p=>p.semantic==="FID"),u=o.attributes.ssrcGroups.find(p=>p.semantic==="SIM"),h=o.attributes.ssrcs;if(u)u.ssrcIds.forEach(p=>{var _;const v=(_=a.find(T=>T.ssrcIds[0]===p))===null||_===void 0?void 0:_.ssrcIds[1];s.push({ssrcId:p,rtx:i?v:void 0})});else if(a.length>0){const p=a[0].ssrcIds[0],_=a[0].ssrcIds[1];s.push({ssrcId:p,rtx:i?_:void 0})}else{if(h.length===0)throw new Error("No ssrcs found on local media description.");s.push({ssrcId:h[0].ssrcId})}return s}function i$(o,i){const{cname:s}=o;let a;i&&i.ip&&typeof i.port=="number"?(a=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:i.ip,port:i.port.toString(),type:"host",extension:{}}],D.debug("Using remote candidate from AP ".concat(i.ip,":").concat(i.port)),i.ip6&&(a.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:i.ip6,port:i.port.toString(),type:"host",extension:{}}),D.debug("Using IPV6 remote candidate from AP ".concat(i.ip6,":").concat(i.port)))):a=o.iceParameters.candidates.map(_=>({foundation:_.foundation,componentId:"1",transport:_.protocol,priority:_.priority.toString(),connectionAddress:_.ip,port:_.port.toString(),type:_.type,extension:{}}));const u={fingerprints:o.dtlsParameters.fingerprints.map(_=>({hashFunction:_.algorithm,fingerprint:_.fingerprint}))},h={iceUfrag:o.iceParameters.iceUfrag,icePwd:o.iceParameters.icePwd};let p;switch(o.dtlsParameters.role){case"server":p="passive";break;case"client":p="active";break;case"auto":p="actpass"}return{dtlsParameters:u,iceParameters:h,candidates:a,rtpCapabilities:sA(o.rtpCapabilities),setup:p,cname:s}}function $a(o,i,s){const a=[],u=[];return o.forEach(h=>{let{ssrcId:p,rtx:_}=h;const v=wn(8,"track-"),T={ssrcId:p,attributes:t$({label:v,mslabel:s=s||wn(10,""),msid:"".concat(s," ").concat(v)},i&&{cname:i})};if(a.push(T),_!==void 0){const b={ssrcId:_,attributes:t$({label:v,mslabel:s,msid:"".concat(s," ").concat(v)},i&&{cname:i})};a.push(b),u.push({semantic:"FID",ssrcIds:[p,_]})}}),o.length>1&&u.push({semantic:"SIM",ssrcIds:o.map(h=>{let{ssrcId:p}=h;return p})}),{ssrcs:a,ssrcGroups:u}}function cm(o,i){i instanceof cn&&o.attributes.payloads.forEach(s=>{var a;const u=(a=s.rtpMap)===null||a===void 0?void 0:a.encodingName.toLowerCase();if(!u||["opus","pcmu","pcma","g722"].indexOf(u)===-1)return;s.fmtp||(s.fmtp={parameters:{}}),s.fmtp.parameters.minptime="10",s.fmtp.parameters.useinbandfec="1";const h=i._encoderConfig;h&&u!=="pcmu"&&u!=="pcma"&&u!=="g722"&&(h.bitrate&&!jn()&&(s.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*h.bitrate))),h.sampleRate&&(s.fmtp.parameters.maxplaybackrate="".concat(h.sampleRate),s.fmtp.parameters["sprop-maxcapturerate"]="".concat(h.sampleRate)),h.stereo&&(s.fmtp.parameters.stereo="1",s.fmtp.parameters["sprop-stereo"]="1"))})}function AU(o){const i=o.attributes.unrecognized.findIndex(s=>s.attField==="x-google-flag"&&s.attValue==="conference");i!==-1&&o.attributes.unrecognized.splice(i,1)}function OU(o,i){var s;if(!(i instanceof Ct&&i._encoderConfig&&i._hints.indexOf(Ln.SCREEN_TRACK)===-1))return;const a=i._encoderConfig;In().supportMinBitrate&&a.bitrateMin&&o.attributes.payloads.forEach(u=>{var h,p;ot(h=["h264","h265","vp8","vp9","av1"]).call(h,((p=u.rtpMap)===null||p===void 0?void 0:p.encodingName.toLowerCase())||"")&&(u.fmtp||(u.fmtp={parameters:{}}),u.fmtp.parameters["x-google-min-bitrate"]="".concat(a.bitrateMin))}),In().supportMinBitrate&&!ot(s=i._hints).call(s,Ln.LOW_STREAM)&&a.bitrateMax&&o.attributes.payloads.forEach(u=>{var h,p;ot(h=["h264","h265","vp8","vp9","av1"]).call(h,((p=u.rtpMap)===null||p===void 0?void 0:p.encodingName.toLowerCase())||"")&&(u.fmtp||(u.fmtp={parameters:{}}),u.fmtp.parameters["x-google-start-bitrate"]="".concat(te("X_GOOGLE_START_BITRATE")||Math.floor(a.bitrateMax)))})}function r$(o){if(o.media.mediaType!=="video")return;const i=Zt();if(i.name!==an.SAFARI&&i.os!==tr.IOS)return;const s=o.attributes.extmaps.findIndex(a=>/video-orientation/g.test(a.extensionName));s!==-1&&o.attributes.extmaps.splice(s,1)}function iA(o,i,s){if(!i)return;let a,u;if(o.media.mediaType==="video"?(a=s.videoExtensions,u=s.videoCodecs):(a=s.audioExtensions,u=s.audioCodecs),i.twcc===!0){const h=a.find(p=>p.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");h&&(o.attributes.extmaps.find(_=>_.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01")||o.attributes.extmaps.push({entry:h.entry,extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"}),function(_,v){return v.filter(T=>!!_.find(b=>b.payloadType===T.payloadType&&!!b.rtcpFeedbacks.find(C=>C.type==="transport-cc")))}(u,o.attributes.payloads).forEach(_=>{_.rtcpFeedbacks.find(v=>v.type==="transport-cc")||_.rtcpFeedbacks.push({type:"transport-cc"})}))}else if(i.twcc===!1){const h=o.attributes.extmaps.findIndex(p=>p.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");h!==-1&&o.attributes.extmaps.splice(h,1),o.attributes.payloads.forEach(p=>{const _=p.rtcpFeedbacks.findIndex(v=>v.type==="transport-cc");_!==-1&&p.rtcpFeedbacks.splice(_,1)})}if(i.remb===!0){const h=a.find(p=>p.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time");h&&(o.attributes.extmaps.find(_=>_.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time")||o.attributes.extmaps.push({entry:h.entry,extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"}),function(_,v){return v.filter(T=>!!_.find(b=>b.payloadType===T.payloadType&&!!b.rtcpFeedbacks.find(C=>C.type==="goog-remb")))}(u,o.attributes.payloads).forEach(_=>{_.rtcpFeedbacks.find(v=>v.type==="goog-remb")||_.rtcpFeedbacks.push({type:"goog-remb"})}))}else if(i.remb===!1){const h=o.attributes.extmaps.findIndex(p=>p.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time");h!==-1&&o.attributes.extmaps.splice(h,1),o.attributes.payloads.forEach(p=>{const _=p.rtcpFeedbacks.findIndex(v=>v.type==="goog-remb");_!==-1&&p.rtcpFeedbacks.splice(_,1)})}}function NU(o,i,s){if(jn()||o.media.mediaType!=="video"||!(i instanceof Ct)||s!=="vp9"&&s!=="vp8"||s==="vp8"&&!te("SIMULCAST")||i._scalabilityMode===void 0||i._scalabilityMode.numSpatialLayers<=1)return;const a=s==="vp8"?2:i._scalabilityMode.numSpatialLayers,u=o.attributes.ssrcs[0],h=o.attributes.ssrcGroups.find(_=>_.semantic==="FID"&&_.ssrcIds[0]===u.ssrcId),p={semantic:"SIM",ssrcIds:[u.ssrcId]};for(let _=1;_<a;_++)o.attributes.ssrcs.push({ssrcId:u.ssrcId+_,attributes:Ai(u.attributes)}),p.ssrcIds.push(u.ssrcId+_),h&&(o.attributes.ssrcs.push({ssrcId:h.ssrcIds[1]+_,attributes:Ai(u.attributes)}),o.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[u.ssrcId+_,h.ssrcIds[1]+_]}));o.attributes.ssrcGroups.unshift(p)}async function s$(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{filterRTX:s,filterVideoFec:a,filterAudioFec:u,filterAudioCodec:h,filterVideoCodec:p}=o,{useXR:_}=i,v=new RTCPeerConnection;v.addTransceiver("video",{direction:"sendonly"}),v.addTransceiver("audio",{direction:"sendonly"}),v.addTransceiver("video",{direction:"recvonly"}),v.addTransceiver("audio",{direction:"recvonly"});const T=(await v.createOffer()).sdp,b=IU(T,{filterRTX:s,filterVideoFec:a,filterAudioFec:u,filterAudioCodec:h,filterVideoCodec:p},{useXR:_},"sendonly"),C=IU(T,{filterRTX:s,filterVideoFec:a,filterAudioFec:u,filterAudioCodec:h,filterVideoCodec:p},{useXR:_},"recvonly"),N={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},x={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},B={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(rA(b,C,"videoExtensions",N,x,B),rA(b,C,"videoCodecs",N,x,B),rA(b,C,"audioExtensions",N,x,B),rA(b,C,"audioCodecs",N,x,B),te("RAISE_H264_BASELINE_PRIORITY")){const F=B.videoCodecs.findIndex(H=>{var J,ee;return((J=H.rtpMap)===null||J===void 0?void 0:J.encodingName.toLocaleLowerCase())==="h264"&&((ee=H.fmtp)===null||ee===void 0?void 0:ee.parameters["profile-level-id"])==="42001f"});if(F!==-1){const H=B.videoCodecs.findIndex(J=>{var ee;return((ee=J.rtpMap)===null||ee===void 0?void 0:ee.encodingName.toLocaleLowerCase())==="h264"});if(H<F){D.debug("raising H264 baseline profile priority");const J=B.videoCodecs[F];B.videoCodecs.splice(F,1),B.videoCodecs.splice(H,0,J)}H!==-1&&(x.videoCodecs=x.videoCodecs.filter(J=>{var ee,se;return!(((ee=J.rtpMap)===null||ee===void 0?void 0:ee.encodingName.toLocaleLowerCase())==="h264"&&((se=J.fmtp)===null||se===void 0?void 0:se.parameters["profile-level-id"])!=="42001f")})),H!==-1&&te("FILTER_SEND_H264_BASELINE")&&(N.videoCodecs=N.videoCodecs.filter(J=>{var ee,se;return!(((ee=J.rtpMap)===null||ee===void 0?void 0:ee.encodingName.toLocaleLowerCase())==="h264"&&((se=J.fmtp)===null||se===void 0?void 0:se.parameters["profile-level-id"])!=="42001f")}))}}try{v.close()}catch{}return{send:N,recv:x,sendrecv:B}}function rA(o,i,s,a,u,h){if(s==="videoExtensions"||s==="audioExtensions"){const p=[];return o[s].forEach(_=>{i[s].some((v,T)=>{if(_.entry===v.entry&&_.extensionName===v.extensionName)return p.push(T),!0})?h[s].push(_):a[s].push(_)}),void i[s].forEach((_,v)=>{p.indexOf(v)===-1&&u[s].push(_)})}if(s==="videoCodecs"||s==="audioCodecs"){const p=[];return o[s].forEach(_=>{i[s].some((v,T)=>{if(_.payloadType===v.payloadType&&JSON.stringify(_)===JSON.stringify(v))return p.push(T),!0})?h[s].push(_):a[s].push(_)}),void i[s].forEach((_,v)=>{p.indexOf(v)===-1&&u[s].push(_)})}}function sA(o){const{send:i,recv:s,sendrecv:a}=o;if(!a){if(!i||!s)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:i,recv:s}}let u,h;return i?(u={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},u.audioCodecs=[...i.audioCodecs,...a.audioCodecs],u.videoCodecs=[...i.videoCodecs,...a.videoCodecs],u.audioExtensions=[...i.audioExtensions,...a.audioExtensions],u.videoExtensions=[...i.videoExtensions,...a.videoExtensions]):u=a,s?(h={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},h.audioCodecs=[...s.audioCodecs,...a.audioCodecs],h.videoCodecs=[...s.videoCodecs,...a.videoCodecs],h.audioExtensions=[...s.audioExtensions,...a.audioExtensions],h.videoExtensions=[...s.videoExtensions,...a.videoExtensions]):h=a,{send:u,recv:h}}function $h(o){o.media.mediaType==="audio"&&o.attributes.payloads.filter(i=>{var s;return((s=i.rtpMap)===null||s===void 0?void 0:s.encodingName.toLowerCase())==="opus"}).forEach(i=>{i.fmtp||(i.fmtp={parameters:{}}),i.fmtp.parameters.stereo="1",i.fmtp.parameters["sprop-stereo"]="1"})}function oA(o){o.mediaDescriptions.forEach(i=>{i.media.mediaType!=="video"&&i.media.mediaType!=="audio"||i.attributes.payloads.forEach(s=>{s.rtcpFeedbacks.findIndex(a=>a.type==="rrtr")===-1&&s.rtcpFeedbacks.push({type:"rrtr"})})})}function aA(o,i,s,a){let u=[];if(o===Qe.VIDEO){if(te("H264_PROFILE_LEVEL_ID")&&a==="h264"&&(u=i.videoCodecs.filter(h=>{var p;return ot(p=h.rtpMap&&h.rtpMap.encodingName.toLowerCase()||"").call(p,a)&&h&&h.fmtp&&h.fmtp.parameters["profile-level-id"]===te("H264_PROFILE_LEVEL_ID")})),!Array.isArray(u)||u.length===0){const h=s.videoCodecs.filter(p=>{var _;return ot(_=p.rtpMap&&p.rtpMap.encodingName.toLowerCase()||"").call(_,a)});h.length!==0&&(u=i.videoCodecs.filter(p=>h.some(_=>_.payloadType===p.payloadType)))}if(te("USE_PUB_RTX")){const h=u.map(_=>_.payloadType.toString()),p=i.videoCodecs.filter(_=>_.rtpMap&&_.rtpMap.encodingName==="rtx"&&ot(h).call(h,_.fmtp&&_.fmtp.parameters.apt||""));u=[...u,...p]}u.length===0&&(D.warning("codec ".concat(a," not included in rtpCapabilities, fallback to default payloads: ").concat(i.videoCodecs[0].rtpMap&&i.videoCodecs[0].rtpMap.encodingName)),u=i.videoCodecs)}else u=i.audioCodecs.filter(h=>{var p;return ot(p=h.rtpMap&&h.rtpMap.encodingName.toLowerCase()||"").call(p,a)}),u.length===0&&(D.warning("codec ".concat(a," not included in rtpCapabilities, fallback to opus")),u=i.audioCodecs.filter(h=>{var p;return ot(p=h.rtpMap&&h.rtpMap.encodingName.toLowerCase()||"").call(p,"opus")}));return u}function o$(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function a$(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?o$(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):o$(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}function Sc(o){if(Array.isArray(o))return o.map(s=>s);if(!c$(o))return o;const i={};for(const s in o){const a=o[s];c$(a)||Array.isArray(a)?i[s]=Sc(a):i[s]=a}return i}function c$(o){return!(typeof o!="object"||Array.isArray(o)||!o)}class PU{constructor(i){O(this,"input",[]),O(this,"size",void 0),this.size=i}add(i){this.input.push(i),this.input.length>this.size&&this.input.splice(0,1)}diffMean(){return this.input.length===0?0:(this.input[this.input.length-1]-this.input[0])/this.input.length}}const ou={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},yS={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],selectedCandidatePair:{id:"unknown",localCandidate:ou,remoteCandidate:ou}},l$={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0},u$={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0,qpSumPerFrame:0},d$={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0},h$={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0,concealedSamples:0};function f$(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function p$(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?f$(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):f$(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}class xU{constructor(i,s){O(this,"onFirstVideoReceived",void 0),O(this,"onFirstVideoDecoded",void 0),O(this,"onFirstAudioReceived",void 0),O(this,"onFirstVideoDecodedTimeout",void 0),O(this,"onFirstAudioDecoded",void 0),O(this,"onSelectedLocalCandidateChanged",void 0),O(this,"onSelectedRemoteCandidateChanged",void 0),O(this,"videoIsReady",!1),O(this,"videoIsReady2",{}),O(this,"pc",void 0),O(this,"options",void 0),O(this,"intervalTimer",void 0),O(this,"stats",Sc(yS)),O(this,"isFirstVideoReceived",{}),O(this,"isFirstVideoDecoded",{}),O(this,"isFirstAudioReceived",{}),O(this,"isFirstAudioDecoded",{}),O(this,"isFirstVideoDecodedTimeout",{}),O(this,"lossRateWindowStats",[]),this.pc=i,this.options=s,this.intervalTimer=window.setInterval(async()=>{this.updateStats()},this.options.updateInterval)}getStats(){return this.stats}getSelectedCandidatePair(){return new le(i=>{i({local:p$({},ou),remote:p$({},ou)})})}setVideoIsReady(i){this.videoIsReady=i}setVideoIsReady2(i,s){this.videoIsReady2[i]=s}getVideoIsReady(i){return this.videoIsReady2[i]||!1}setIsFirstAudioDecoded(i){}destroy(){window.clearInterval(this.intervalTimer),this.pc=void 0}calcLossRate(i){this.lossRateWindowStats.push(i),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);const s=this.lossRateWindowStats.length,a=["videoSend","audioSend","videoRecv","audioRecv"];let u=0,h=0,p=0,_=0;for(const v of a)i[v].forEach((T,b)=>{if(!this.lossRateWindowStats[s-1][v][b]||!this.lossRateWindowStats[0][v][b])return;const C=this.lossRateWindowStats[s-1][v][b].packets-this.lossRateWindowStats[0][v][b].packets,N=this.lossRateWindowStats[s-1][v][b].packetsLost-this.lossRateWindowStats[0][v][b].packetsLost;v==="videoSend"||v==="audioSend"?(u+=C,p+=N):(h+=C,_+=N),Number.isNaN(C)||Number.isNaN(C)?T.packetLostRate=0:T.packetLostRate=C<=0||N<=0?0:N/(C+N)});i.sendPacketLossRate=u<=0||p<=0?0:p/(u+p),i.recvPacketLossRate=h<=0||_<=0?0:_/(h+_)}}function m$(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function mde(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?m$(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):m$(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}class gde extends xU{constructor(){super(...arguments),O(this,"_stats",yS),O(this,"lastDecodeVideoReceiverStats",new Map)}async updateStats(){const i=await this._getStats(),s=this.statsResponsesToObjects(i);this._stats=Sc(yS);const a=s.filter(h=>h.type==="ssrc");this.processSSRCStats(a);const u=s.find(h=>h.type==="VideoBwe");u&&this.processBandwidthStats(u),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}processBandwidthStats(i){this._stats.bitrate={actualEncoded:Number(i.googActualEncBitrate),targetEncoded:Number(i.googTargetEncBitrate),retransmit:Number(i.googRetransmitBitrate),transmit:Number(i.googTransmitBitrate)},this._stats.sendBandwidth=Number(i.googAvailableSendBandwidth)}processSSRCStats(i){i.forEach(s=>{var a;const u=ot(a=s.id).call(a,"send");switch("".concat(s.mediaType,"_").concat(u?"send":"recv")){case"video_send":{const h=Sc(u$);h.codec=s.googCodecName,h.adaptionChangeReason="none",s.googCpuLimitedResolution&&(h.adaptionChangeReason="cpu"),s.googBandwidthLimitedResolution&&(h.adaptionChangeReason="bandwidth"),h.avgEncodeMs=Number(s.googAvgEncodeMs),h.inputFrame={width:Number(s.googFrameWidthInput)||Number(s.googFrameWidthSent),height:Number(s.googFrameHeightInput)||Number(s.googFrameHeightSent),frameRate:Number(s.googFrameRateInput)},h.sentFrame={width:Number(s.googFrameWidthSent),height:Number(s.googFrameHeightSent),frameRate:Number(s.googFrameRateInput)},h.firsCount=Number(s.googFirReceived),h.nacksCount=Number(s.googNacksReceived),h.plisCount=Number(s.googPlisReceived),h.frameCount=Number(s.framesEncoded),h.bytes=Number(s.bytesSent),h.packets=Number(s.packetsSent),h.packetsLost=Number(s.packetsLost),h.ssrc=Number(s.ssrc),h.rttMs=Number(s.googRtt||0),this._stats.videoSend.push(h),this._stats.rtt=h.rttMs;break}case"video_recv":{const h=Sc(l$),p=this.lastDecodeVideoReceiverStats.get(Number(s.ssrc));if(h.codec=s.googCodecName,h.targetDelayMs=Number(s.googTargetDelayMs),h.renderDelayMs=Number(s.googRenderDelayMs),h.currentDelayMs=Number(s.googCurrentDelayMs),h.minPlayoutDelayMs=Number(s.googMinPlayoutDelayMs),h.decodeMs=Number(s.googDecodeMs),h.maxDecodeMs=Number(s.googMaxDecodeMs),h.receivedFrame={width:Number(s.googFrameWidthReceived),height:Number(s.googFrameHeightReceived),frameRate:Number(s.googFrameRateReceived)},h.decodedFrame={width:Number(s.googFrameWidthReceived),height:Number(s.googFrameHeightReceived),frameRate:Number(s.googFrameRateDecoded)},h.decodeFrameRate=Number(s.googFrameRateDecoded),h.outputFrame={width:Number(s.googFrameWidthReceived),height:Number(s.googFrameHeightReceived),frameRate:Number(s.googFrameRateOutput)},h.jitterBufferMs=Number(s.googJitterBufferMs),h.firsCount=Number(s.googFirsSent),h.nacksCount=Number(s.googNacksSent),h.plisCount=Number(s.googPlisSent),h.framesDecodeCount=Number(s.framesDecoded),h.bytes=Number(s.bytesReceived),h.packets=Number(s.packetsReceived),h.packetsLost=Number(s.packetsLost),h.ssrc=Number(s.ssrc),h.packets>0&&!this.isFirstVideoReceived[h.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(h.ssrc),this.isFirstVideoReceived[h.ssrc]=!0),h.framesDecodeCount>0&&!this.isFirstVideoDecoded[h.ssrc]&&(this.onFirstVideoDecoded&&this.onFirstVideoDecoded(h.ssrc,h.decodedFrame.width,h.decodedFrame.height),this.isFirstVideoDecoded[h.ssrc]=!0),p){const _=p.stats,v=Date.now()-p.lts;h.framesDecodeFreezeTime=_.framesDecodeFreezeTime,h.framesDecodeInterval=_.framesDecodeInterval,h.framesDecodeCount>_.framesDecodeCount&&this.isFirstVideoDecoded[h.ssrc]?(p.lts=Date.now(),h.framesDecodeInterval=v,h.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(s.ssrc,10))?h.framesDecodeFreezeTime+=h.framesDecodeInterval:this.setVideoIsReady2(parseInt(s.ssrc,10),!0))):h.framesDecodeCount<p.stats.framesDecodeCount&&(h.framesDecodeInterval=0)}this.lastDecodeVideoReceiverStats.set(h.ssrc,{stats:mde({},h),lts:Date.now()}),this._stats.videoRecv.push(h);break}case"audio_recv":{const h=Sc(h$);h.codec=s.googCodecName,h.outputLevel=Math.abs(Number(s.audioOutputLevel))/32767,h.decodingCNG=Number(s.googDecodingCNG),h.decodingCTN=Number(s.googDecodingCTN),h.decodingCTSG=Number(s.googDecodingCTSG),h.decodingNormal=Number(s.googDecodingNormal),h.decodingPLC=Number(s.googDecodingPLC),h.decodingPLCCNG=Number(s.googDecodingPLCCNG),h.expandRate=Number(s.googExpandRate),h.accelerateRate=Number(s.googAccelerateRate),h.preemptiveExpandRate=Number(s.googPreemptiveExpandRate),h.secondaryDecodedRate=Number(s.googSecondaryDecodedRate),h.speechExpandRate=Number(s.googSpeechExpandRate),h.preferredJitterBufferMs=Number(s.googPreferredJitterBufferMs),h.jitterBufferMs=Number(s.googJitterBufferMs),h.jitterMs=Number(s.googJitterReceived),h.bytes=Number(s.bytesReceived),h.packets=Number(s.packetsReceived),h.packetsLost=Number(s.packetsLost),h.ssrc=Number(s.ssrc),h.receivedFrames=Number(s.googDecodingCTN)||Number(s.packetsReceived),h.droppedFrames=Number(s.googDecodingPLC)+Number(s.googDecodingPLCCNG)||Number(s.packetsLost),h.receivedFrames>0&&!this.isFirstAudioReceived[h.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(h.ssrc),this.isFirstAudioReceived[h.ssrc]=!0),h.decodingNormal>0&&!this.isFirstAudioDecoded[h.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(h.ssrc),this.isFirstAudioDecoded[h.ssrc]=!0),this._stats.audioRecv.push(h);break}case"audio_send":{const h=Sc(d$);h.codec=s.googCodecName,h.inputLevel=Math.abs(Number(s.audioInputLevel))/32767,h.aecReturnLoss=Number(s.googEchoCancellationReturnLoss||0),h.aecReturnLossEnhancement=Number(s.googEchoCancellationReturnLossEnhancement||0),h.residualEchoLikelihood=Number(s.googResidualEchoLikelihood||0),h.residualEchoLikelihoodRecentMax=Number(s.googResidualEchoLikelihoodRecentMax||0),h.bytes=Number(s.bytesSent),h.packets=Number(s.packetsSent),h.packetsLost=Number(s.packetsLost),h.ssrc=Number(s.ssrc),h.rttMs=Number(s.googRtt||0),this._stats.rtt=h.rttMs,this._stats.audioSend.push(h);break}}})}_getStats(){return new le((i,s)=>{this.pc.getStats(i,s)})}statsResponsesToObjects(i){const s=[];return i.result().forEach(a=>{const u={id:a.id,timestamp:a.timestamp.valueOf().toString(),type:a.type};a.names().forEach(h=>{u[h]=a.stat(h)}),s.push(u)}),s}}function g$(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function lm(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?g$(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):g$(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}class _$ extends xU{constructor(){super(...arguments),O(this,"_stats",yS),O(this,"report",void 0),O(this,"lastDecodeVideoReceiverStats",new Map),O(this,"lastVideoFramesRecv",new Map),O(this,"lastVideoFramesSent",new Map),O(this,"lastVideoFramesDecode",new Map),O(this,"lastVideoJBDelay",new Map),O(this,"lastAudioJBDelay",new Map),O(this,"mediaBytesSent",new Map),O(this,"mediaBytesRetransmit",new Map),O(this,"mediaBytesTargetEncode",new Map),O(this,"lastEncoderMs",new Map)}async updateStats(){this.report=await this.pc.getStats(),this._stats=Sc(yS),this.report.forEach(i=>{switch(i.type){case co.OUTBOUND:case co.INBOUND:{const s=i.mediaType||i.kind,a=!s&&"frameWidth"in i,u=!s&&!("frameWidth"in i);i.type===co.OUTBOUND?s==="audio"||u?this.processAudioOutboundStats(i):(s==="video"||a)&&this.processVideoOutboundStats(i):i.type===co.INBOUND&&(s==="audio"||u?this.processAudioInboundStats(i):(s==="video"||a)&&this.processVideoInboundStats(i));break}case co.TRANSPORT:{const s=this.report.get(i.selectedCandidatePairId);s&&this.processCandidatePairStats(s);break}case co.CANDIDATE_PAIR:i.selected&&this.processCandidatePairStats(i)}}),this.updateSendBitrate(),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}async getSelectedCandidatePair(){const i=await this.pc.getStats(),s={local:lm({},ou),remote:lm({},ou)};return i.forEach(a=>{let u;if(a.type===co.TRANSPORT&&(u=i.get(a.selectedCandidatePairId)),a.type===co.CANDIDATE_PAIR&&a.selected&&(u=a),u){const h=(p,_)=>{p.type=_.type,p.id=_.id,_.address&&(p.address=_.address),_.candidateType&&(p.candidateType=_.candidateType),_.port&&(p.port=_.port),_.priority&&(p.priority=_.priority),_.protocol&&(p.protocol=_.protocol),_.relayProtocol&&(p.relayProtocol=_.relayProtocol)};if(u.localCandidateId){const p=i.get(u.localCandidateId);p&&h(s.local,p)}if(u.remoteCandidateId){const p=i.get(u.remoteCandidateId);p&&h(s.remote,p)}}}),s}processCandidatePairStats(i){if(this._stats.sendBandwidth=i.availableOutgoingBitrate||0,i.currentRoundTripTime&&(this._stats.rtt=1e3*i.currentRoundTripTime),this._stats.videoSend.forEach(s=>{i.currentRoundTripTime&&(s.rttMs=1e3*i.currentRoundTripTime)}),this._stats.audioSend.forEach(s=>{i.currentRoundTripTime&&(s.rttMs=1e3*i.currentRoundTripTime)}),this._stats.selectedCandidatePair.id=i.id,i.localCandidateId){const s=this.report.get(i.localCandidateId);s&&this.processCandidateStats(s)}if(i.remoteCandidateId){const s=this.report.get(i.remoteCandidateId);s&&this.processCandidateStats(s)}}processCandidateStats(i){let s;i.type===co.LOCAL_CANDIDATE&&(s=this._stats.selectedCandidatePair.localCandidate),i.type===co.REMOTE_CANDIDATE&&(s=this._stats.selectedCandidatePair.remoteCandidate),s&&(s.type=i.type,s.id=i.id,i.address&&(s.address=i.address),i.candidateType&&(s.candidateType=i.candidateType),i.port&&(s.port=i.port),i.priority&&(s.priority=i.priority),i.protocol&&(s.protocol=i.protocol),i.relayProtocol&&(s.relayProtocol=i.relayProtocol),i.type===co.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==s.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(lm({},s),lm({},this.stats.selectedCandidatePair.localCandidate)),i.type===co.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==s.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(lm({},s),lm({},this.stats.selectedCandidatePair.remoteCandidate)))}processAudioInboundStats(i){let s=this._stats.audioRecv.find(a=>a.ssrc===i.ssrc);s||(s=Sc(h$),this._stats.audioRecv.push(s)),s.ssrc=i.ssrc,s.packets=i.packetsReceived,s.packetsLost=i.packetsLost,s.bytes=i.bytesReceived,s.jitterMs=1e3*i.jitter,this.processAudioTrackReceiverStats(i,i.trackId,s),i.codecId&&(s.codec=this.getCodecFromCodecStats(i.codecId)),s.receivedFrames||(s.receivedFrames=i.packetsReceived),s.droppedFrames||(s.droppedFrames=i.packetsLost),s.receivedFrames>0&&!this.isFirstAudioReceived[s.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(s.ssrc),this.isFirstAudioReceived[s.ssrc]=!0),s.outputLevel&&s.outputLevel>0&&!this.isFirstAudioDecoded[s.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(s.ssrc),this.isFirstAudioDecoded[s.ssrc]=!0),typeof i.concealedSamples=="number"&&(s.concealedSamples=i.concealedSamples)}processVideoInboundStats(i){let s=this._stats.videoRecv.find(p=>p.ssrc===i.ssrc);s||(s=Sc(l$),this._stats.videoRecv.push(s)),s.ssrc=i.ssrc,s.packets=i.packetsReceived,s.packetsLost=i.packetsLost,s.bytes=i.bytesReceived,s.firsCount=i.firCount,s.nacksCount=i.nackCount,s.plisCount=i.pliCount,s.framesDecodeCount=i.framesDecoded,s.totalInterFrameDelay=i.totalInterFrameDelay,s.totalSquaredInterFrameDelay=i.totalSquaredInterFrameDelay;const a=this.lastDecodeVideoReceiverStats.get(s.ssrc),u=this.lastVideoFramesDecode.get(s.ssrc),h=Date.now();if(s.framesDecodeCount>0&&!this.isFirstVideoDecoded[s.ssrc]){const p=s.decodedFrame?s.decodedFrame.width:0,_=s.decodedFrame?s.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(s.ssrc,p,_),this.isFirstVideoDecoded[s.ssrc]=!0}if(a){const p=a.stats,_=h-a.lts;s.framesDecodeFreezeTime=p.framesDecodeFreezeTime,s.framesDecodeInterval=p.framesDecodeInterval,!this.isFirstVideoDecoded[s.ssrc]&&_>this.options.firstVideoDecodedTimeout&&!this.isFirstVideoDecodedTimeout[s.ssrc]&&(this.onFirstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout(s.ssrc),this.isFirstVideoDecodedTimeout[s.ssrc]=!0),s.framesDecodeCount>p.framesDecodeCount&&this.isFirstVideoDecoded[s.ssrc]?(a.lts=Date.now(),s.framesDecodeInterval=_,s.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(i.ssrc))?s.framesDecodeFreezeTime+=s.framesDecodeInterval:this.setVideoIsReady2(parseInt(i.ssrc,10),!0))):s.framesDecodeCount<p.framesDecodeCount&&(s.framesDecodeInterval=0),i.framesDecoded&&i.qpSum&&(a.stats.framesDecodeCount>i.framesDecoded?s.qpSumPerFrame=i.qpSum/i.framesDecoded:s.qpSumPerFrame=(i.qpSum-a.qpSum)/(i.framesDecoded-a.stats.framesDecodeCount))}u&&h-u.lts>=800?(s.decodeFrameRate=Math.round((s.framesDecodeCount-u.count)/((h-u.lts)/1e3)),this.lastVideoFramesDecode.set(s.ssrc,{count:s.framesDecodeCount,lts:h,rate:s.decodeFrameRate})):u?s.decodeFrameRate=u.rate:this.lastVideoFramesDecode.set(s.ssrc,{count:s.framesDecodeCount,lts:h,rate:0}),i.totalDecodeTime&&(s.decodeMs=1e3*i.totalDecodeTime),this.processVideoTrackReceiverStats(i,i.trackId,s),i.codecId&&(s.codec=this.getCodecFromCodecStats(i.codecId)),i.framerateMean&&(s.framesRateFirefox=i.framerateMean),s.packets>0&&!this.isFirstVideoReceived[s.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(s.ssrc),this.isFirstVideoReceived[s.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(s.ssrc,{stats:lm({},s),lts:a?a.lts:Date.now(),qpSum:i.qpSum})}processVideoOutboundStats(i){let s=this._stats.videoSend.find(u=>u.ssrc===i.ssrc);s||(s=Sc(u$),this._stats.videoSend.push(s));const a=this.mediaBytesSent.get(i.ssrc);if(a)a.add(i.bytesSent);else{const u=new PU(10);u.add(i.bytesSent),this.mediaBytesSent.set(i.ssrc,u)}if(i.retransmittedBytesSent!==void 0){const u=this.mediaBytesRetransmit.get(i.ssrc);if(u)u.add(i.retransmittedBytesSent);else{const h=new PU(10);h.add(i.retransmittedBytesSent),this.mediaBytesRetransmit.set(i.ssrc,h)}}if(i.totalEncodedBytesTarget){const u=this.mediaBytesTargetEncode.get(i.ssrc);if(u)u.add(i.totalEncodedBytesTarget);else{const h=new PU(10);h.add(i.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(i.ssrc,h)}}if(s.ssrc=i.ssrc,s.bytes=i.bytesSent,s.packets=i.packetsSent,s.firsCount=i.firCount,s.nacksCount=i.nackCount,s.plisCount=i.pliCount,s.frameCount=i.framesEncoded,s.adaptionChangeReason=i.qualityLimitationReason,s.scalabilityMode=i.scalabilityMode,i.totalEncodeTime&&i.framesEncoded){const u=this.lastEncoderMs.get(i.ssrc);if(!u||u.lastFrameCount>i.framesEncoded)s.avgEncodeMs=1e3*i.totalEncodeTime/i.framesEncoded;else{const h=i.framesEncoded-u.lastFrameCount,p=i.totalEncodeTime-u.lastEncoderTime;s.avgEncodeMs=1e3*p/h}}if(i.framesEncoded&&i.qpSum){const u=this.lastEncoderMs.get(i.ssrc);!u||u.lastFrameCount>i.framesEncoded?s.qpSumPerFrame=i.qpSum/i.framesEncoded:s.qpSumPerFrame=(i.qpSum-u.lastQpSum)/(i.framesEncoded-u.lastFrameCount)}if(this.lastEncoderMs.set(i.ssrc,{lastFrameCount:i.framesEncoded,lastEncoderTime:i.totalEncodeTime,lastQpSum:i.qpSum,lts:Date.now()}),i.codecId&&(s.codec=this.getCodecFromCodecStats(i.codecId)),i.mediaSourceId&&this.processVideoMediaSource(i.mediaSourceId,s),this.processVideoTrackSenderStats(i,i.trackId,s),i.remoteId)this.processRemoteInboundStats(i.remoteId,s);else{const u=this.findRemoteStatsId(i.ssrc,co.REMOTE_INBOUND);u&&this.processRemoteInboundStats(u,s)}}processAudioOutboundStats(i){let s=this._stats.audioSend.find(a=>a.ssrc===i.ssrc);if(s||(s=Sc(d$),this._stats.audioSend.push(s)),s.ssrc=i.ssrc,s.packets=i.packetsSent,s.bytes=i.bytesSent,i.mediaSourceId&&this.processAudioMediaSource(i.mediaSourceId,s),i.codecId&&(s.codec=this.getCodecFromCodecStats(i.codecId)),this.processAudioTrackSenderStats(i,i.trackId,s),i.remoteId)this.processRemoteInboundStats(i.remoteId,s);else{const a=this.findRemoteStatsId(i.ssrc,co.REMOTE_INBOUND);a&&this.processRemoteInboundStats(a,s)}}findRemoteStatsId(i,s){var a;const u=Array.from(Jl(a=this.report).call(a)).find(h=>h.type===s&&h.ssrc===i);return u?u.id:null}processVideoMediaSource(i,s){const a=this.report.get(i);a&&a.width&&a.height&&a.framesPerSecond&&(s.inputFrame={width:a.width,height:a.height,frameRate:a.framesPerSecond})}processAudioMediaSource(i,s){const a=this.report.get(i);a&&(s.inputLevel=a.audioLevel)}processVideoTrackSenderStats(i,s,a){var u,h,p,_;const v=s?this.report.get(s):void 0,T=(u=v==null?void 0:v.framesSent)!==null&&u!==void 0?u:i.framesSent;if(typeof T!="number")return;let b=(h=v==null?void 0:v.frameWidth)!==null&&h!==void 0?h:i.frameWidth,C=(p=v==null?void 0:v.frameHeight)!==null&&p!==void 0?p:i.frameHeight,N=(_=v==null?void 0:v.framesPerSecond)!==null&&_!==void 0?_:i.framesPerSecond;if(typeof b=="number"&&typeof C=="number"||(b=0,C=0),N==null){const x=Date.now(),B=this.lastVideoFramesSent.get(a.ssrc);B&&x-B.lts>=800?(N=Math.round((T-B.count)/((x-B.lts)/1e3)),this.lastVideoFramesSent.set(a.ssrc,{count:T,lts:x,rate:N})):B?N=B.rate:this.lastVideoFramesSent.set(a.ssrc,{count:T,lts:x,rate:0})}a.sentFrame={width:b,height:C,frameRate:Math.max(0,N)}}processVideoTrackReceiverStats(i,s,a){var u,h,p,_,v;const T=s?this.report.get(s):void 0,b=(u=T==null?void 0:T.framesReceived)!==null&&u!==void 0?u:i.framesReceived,C=(h=T==null?void 0:T.frameWidth)!==null&&h!==void 0?h:i.frameWidth,N=(p=T==null?void 0:T.frameHeight)!==null&&p!==void 0?p:i.frameHeight,x=(_=T==null?void 0:T.jitterBufferDelay)!==null&&_!==void 0?_:i.jitterBufferDelay,B=(v=T==null?void 0:T.jitterBufferEmittedCount)!==null&&v!==void 0?v:i.jitterBufferEmittedCount;if(typeof b=="number"){const F=this.lastVideoFramesRecv.get(a.ssrc),H=Date.now();a.framesReceivedCount=b;let J=0;F&&H-F.lts>=800?(J=Math.round((b-F.count)/((H-F.lts)/1e3)),this.lastVideoFramesRecv.set(a.ssrc,{count:b,lts:H,rate:J})):F?J=F.rate:this.lastVideoFramesRecv.set(a.ssrc,{count:b,lts:H,rate:0}),a.receivedFrame={width:C||0,height:N||0,frameRate:J||0},a.decodedFrame={width:C||0,height:N||0,frameRate:a.decodeFrameRate||0},a.outputFrame={width:C||0,height:N||0,frameRate:a.decodeFrameRate||0}}if(x&&B){const F=this.lastVideoJBDelay.get(a.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let H=F.jitterBufferMs;const J=B-F.jitterBufferEmittedCount;J>0&&(H=1e3*(x-F.jitterBufferDelay)/J),a.jitterBufferMs=H,a.currentDelayMs=Math.round(H),this.lastVideoJBDelay.set(a.ssrc,{jitterBufferDelay:x,jitterBufferEmittedCount:B,jitterBufferMs:a.currentDelayMs})}}processAudioTrackSenderStats(i,s,a){var u,h,p,_;const v=s?this.report.get(s):void 0,T=(u=(h=v==null?void 0:v.echoReturnLoss)!==null&&h!==void 0?h:i.echoReturnLoss)!==null&&u!==void 0?u:0,b=(p=(_=v==null?void 0:v.echoReturnLossEnhancement)!==null&&_!==void 0?_:i.echoReturnLossEnhancement)!==null&&p!==void 0?p:0;a.aecReturnLoss=T,a.aecReturnLossEnhancement=b}processAudioTrackReceiverStats(i,s,a){var u,h,p,_,v,T,b;const C=s?this.report.get(s):void 0,N=(u=C==null?void 0:C.removedSamplesForAcceleration)!==null&&u!==void 0?u:i.removedSamplesForAcceleration,x=(h=C==null?void 0:C.totalSamplesReceived)!==null&&h!==void 0?h:i.totalSamplesReceived,B=(p=C==null?void 0:C.jitterBufferDelay)!==null&&p!==void 0?p:i.jitterBufferDelay,F=(_=C==null?void 0:C.jitterBufferEmittedCount)!==null&&_!==void 0?_:i.jitterBufferEmittedCount,H=(v=C==null?void 0:C.audioLevel)!==null&&v!==void 0?v:i==null?void 0:i.audioLevel,J=(T=C==null?void 0:C.totalSamplesDuration)!==null&&T!==void 0?T:i==null?void 0:i.totalSamplesDuration,ee=(b=C==null?void 0:C.concealedSamples)!==null&&b!==void 0?b:i.concealedSamples;if(N&&x&&(a.accelerateRate=N/x),B&&F){const ye=this.lastAudioJBDelay.get(a.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let me=ye.jitterBufferMs;const ue=F-ye.jitterBufferEmittedCount;ue>0&&(me=1e3*(B-ye.jitterBufferDelay)/ue),a.jitterBufferMs=Math.round(me),this.lastAudioJBDelay.set(a.ssrc,{jitterBufferDelay:B,jitterBufferEmittedCount:F,jitterBufferMs:a.jitterBufferMs})}a.outputLevel=H;let se=1920;J&&x&&(se=x/J/50,a.receivedFrames=Math.round(x/se)),ee&&(a.droppedFrames=Math.round(ee/se))}processRemoteInboundStats(i,s){const a=this.report.get(i);a&&(s.packetsLost=a.packetsLost,a.roundTripTime&&(s.rttMs=1e3*a.roundTripTime),a.jitter&&(s.jitterMs=1e3*a.jitter),a.timestamp&&(s.timestamp=a.timestamp))}getCodecFromCodecStats(i){const s=this.report.get(i);if(!s)return"";const a=s.mimeType.match(/\/(.*)$/);return a&&a[1]?a[1]:""}updateSendBitrate(){let i=0,s=null,a=null;this.mediaBytesSent.forEach(h=>{i+=h.diffMean()}),this.mediaBytesRetransmit.forEach(h=>{s=s===null?h.diffMean():s+h.diffMean()}),this.mediaBytesTargetEncode.forEach(h=>{a=a===null?h.diffMean():a+h.diffMean()});const u=s!==null?i-s:i;this._stats.bitrate={actualEncoded:8*u/(this.options.updateInterval/1e3),transmit:8*i/(this.options.updateInterval/1e3)},s!==null&&(this._stats.bitrate.retransmit=8*s/(this.options.updateInterval/1e3)),a!==null&&(this._stats.bitrate.targetEncoded=8*a/(this.options.updateInterval/1e3))}}class _de extends xU{updateStats(){return le.resolve()}}function cA(o){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:250,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:8,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:500,u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1e4;const h=function(){const p=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i);return p&&p[0]?Number(p[0].split("/")[1]):null}();return h?h<76?new gde(o,{updateInterval:i,lossRateInterval:s,freezeRateLimit:a,firstVideoDecodedTimeout:u}):new _$(o,{updateInterval:i,lossRateInterval:s,freezeRateLimit:a,firstVideoDecodedTimeout:u}):function(p){return!!window.RTCStatsReport&&p.getStats()instanceof le}(o)?new _$(o,{updateInterval:i,lossRateInterval:s,freezeRateLimit:a,firstVideoDecodedTimeout:u}):new _de(o,{updateInterval:i,lossRateInterval:s,freezeRateLimit:a,firstVideoDecodedTimeout:u})}function E$(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function v$(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?E$(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):E$(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}class _r extends SI{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}constructor(i,s){super(i,s),O(this,"store",void 0),O(this,"peerConnection",void 0),O(this,"remoteSDP",void 0),O(this,"initialOffer",void 0),O(this,"statsFilter",void 0),O(this,"useRTX",!1),O(this,"localCapabilities",void 0),O(this,"localCandidateCount",0),O(this,"allCandidatesReceived",!1),O(this,"establishPromise",void 0),O(this,"mutex",new fr("P2PConnection-mutex")),this.store=s,this.peerConnection=new RTCPeerConnection(_r.resolvePCConfiguration(i),{optional:[{googDscp:!0}]}),this.statsFilter=cA(this.peerConnection,te("STATS_UPDATE_INTERVAL"),void 0,jn()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(){try{const i=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!i.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const s=am(i.sdp),a=IU(i.sdp,{filterRTX:!this.useRTX,filterVideoFec:te("FILTER_VIDEO_FEC"),filterAudioFec:te("FILTER_AUDIO_FEC"),filterAudioCodec:["opus"]});return this.localCapabilities=a,this.initialOffer=i,v$(v$({},s),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:a},offerSDP:i.sdp})}catch(i){throw new Ee(z.GET_LOCAL_CONNECTION_PARAMS_FAILED,i.toString())}}async connect(i,s,a,u,h,p){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new class{constructor(v){O(this,"sessionDesc",void 0),O(this,"localCapabilities",void 0),O(this,"rtpCapabilities",void 0),O(this,"candidates",void 0),O(this,"iceParameters",void 0),O(this,"dtlsParameters",void 0),O(this,"setup",void 0),O(this,"currentMidIndex",void 0),O(this,"cname",void 0),v=Ai(v);const{remoteIceParameters:T,remoteDtlsParameters:b,candidates:C,remoteRTPCapabilities:N,remoteSetup:x,localCapabilities:B,sdkCodec:F,cname:H}=v,J=li.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE audio video
a=msid-semantic: WMS
a=ice-lite
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:audio
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:video
`);this.rtpCapabilities=N,this.candidates=C,this.iceParameters=T,this.dtlsParameters=b,this.setup=x,this.localCapabilities=B,this.cname=H;for(let ee=0;ee<J.mediaDescriptions.length;ee++){const se=J.mediaDescriptions[ee];if(se.attributes.iceUfrag=T.iceUfrag,se.attributes.icePwd=T.icePwd,se.attributes.fingerprints=b.fingerprints,se.attributes.candidates=C,se.attributes.setup=x,se.media.mediaType==="video"){se.media.fmts=N.videoCodecs.map(me=>me.payloadType.toString(10));let ye=N.videoCodecs.filter(me=>{var ue,he;return(ue=me.rtpMap)===null||ue===void 0?void 0:ot(he=ue.encodingName.toLowerCase()).call(he,F)});ye.length===0&&(ye=N.videoCodecs),se.attributes.payloads=ye,se.attributes.extmaps=N.videoExtensions}se.media.mediaType==="audio"&&(se.media.fmts=N.audioCodecs.map(ye=>ye.payloadType.toString(10)),se.attributes.payloads=N.audioCodecs,se.attributes.extmaps=N.audioExtensions),J.mediaDescriptions[ee]=this.mungMediaDesc(se)}this.sessionDesc=J,this.currentMidIndex=J.mediaDescriptions.length-1}toString(){return li.print(this.sessionDesc)}send(v,T,b){const{ssrcs:C,ssrcGroups:N}=$a(T,this.cname),x=this.sessionDesc.mediaDescriptions.find(H=>v===Qe.VIDEO?H.media.mediaType==="video":H.media.mediaType==="audio"),B=C[0].attributes.label,F=C[0].attributes.mslabel;return x.attributes.ssrcs=x.attributes.ssrcs.concat(C),x.attributes.ssrcGroups=x.attributes.ssrcGroups.concat(N),{id:B,mslabel:F}}batchSend(v){return v.map(T=>{let{kind:b,ssrcMsg:C}=T;return this.send(b,C,void 0)})}stopSending(v){this.sessionDesc.mediaDescriptions.forEach(T=>{const b=[],C=[],N=[];T.attributes.ssrcs.forEach(x=>{ot(v).call(v,x.attributes.label||"")?N.push(x):b.push(x)}),T.attributes.ssrcGroups.forEach(x=>{var B;ot(B=N.map(F=>F.ssrcId)).call(B,x.ssrcIds[0])||C.push(x)}),T.attributes.ssrcs=b,T.attributes.ssrcGroups=C})}mute(v){const T=this.sessionDesc.mediaDescriptions.find(b=>b.attributes.mid===v);if(!T)throw new Error("mediaDescription not found with ".concat(v," in remote SDP when calling RemoteSDP.mute."));T.attributes.direction="inactive"}unmute(v){const T=this.sessionDesc.mediaDescriptions.find(b=>b.attributes.mid===v);if(!T)throw new Error("mediaDescription not found with ".concat(v," in remote SDP when calling RemoteSDP.unmute."));T.attributes.direction="sendonly"}receive(v,T,b){v.forEach((C,N)=>{const x=C._mediaStreamTrack,B=this.sessionDesc.mediaDescriptions.findIndex(H=>H.attributes.mid===x.kind),F=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[B],C);this.sessionDesc.mediaDescriptions[B]=F})}stopReceiving(v){}updateCandidates(v){v===Fr.TCP?this.candidates.forEach(T=>{this.candidates.findIndex(b=>b.transport==="tcp"&&b.connectionAddress===T.connectionAddress&&b.port===T.port)===-1&&this.candidates.push(a$(a$({},T),{},{foundation:"tcpcandidate",priority:Number(T.priority)-1+"",transport:"tcp",port:Number(T.port)+90+""}))}):this.candidates=this.candidates.filter(T=>T.transport!=="tcp");for(const T of this.sessionDesc.mediaDescriptions)T.attributes.candidates=this.candidates}restartICE(v){v=Ai(v),this.iceParameters=v,this.sessionDesc.mediaDescriptions.forEach(T=>{T.attributes.iceUfrag=v.iceUfrag,T.attributes.icePwd=v.icePwd})}predictReceivingMids(v){const T=[];for(let b=0;b<v;b++)T.push((this.currentMidIndex+b+1).toString(10));return T}mungRecvMediaDsec(v,T){const b=Ai(v);return cm(b,T),OU(b,T),b}updateRecvMedia(v,T){const b=this.sessionDesc.mediaDescriptions.findIndex(C=>C.attributes.mid===v);if(b!==-1){const C=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[b],T);this.sessionDesc.mediaDescriptions[b]=C}}bumpMid(v){this.currentMidIndex+=v}updateTrackLabel(v,T,b){const C=this.sessionDesc.mediaDescriptions.find(x=>v===Qe.VIDEO?x.attributes.mid==="video":x.attributes.mid==="audio");if(C){const x=C.attributes.ssrcs.find(B=>B.attributes.label===T);var N;x&&(x.attributes.label=b,(N=x.attributes.msid)===null||N===void 0||N.replace(T,b))}}mungMediaDesc(v){const T=Ai(v);return AU(T),function(b){const C=b.attributes.extmaps.find(N=>N.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");C&&b.attributes.extmaps.splice(b.attributes.extmaps.indexOf(C),1),b.attributes.payloads.forEach(N=>{const x=N.rtcpFeedbacks.findIndex(B=>B.type==="transport-cc");x!==-1&&N.rtcpFeedbacks.splice(x,1)})}(T),T}getSSRC(v){for(const T of this.sessionDesc.mediaDescriptions)for(const b of T.attributes.ssrcs)if(b.attributes.label===v)return[b]}}({remoteIceParameters:i,remoteDtlsParameters:s,candidates:a,remoteRTPCapabilities:u.send,remoteSetup:h,localCapabilities:this.localCapabilities,sdkCodec:this.store.codec,cname:p});const _=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(this.initialOffer),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_})}catch(_){throw new Ee(z.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(_.toString()))}}async updateRemoteRTPCapabilities(i,s){throw new Ee(z.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}send(i,s){var a=this;return Ha(function*(){const u=yield en(a.mutex.lock());try{if(!a.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const h=i.map(N=>a.peerConnection.addTrack(N._mediaStreamTrack)),p=yield en(a.peerConnection.createOffer()),_=li.parse(p.sdp),v=i.map(N=>{const x=N._mediaStreamTrack,B=_.mediaDescriptions.find(F=>F.attributes.mid===x.kind);if(!B)throw new Error("Cannot extract ssrc from mediaDescription.");return function(F,H,J){const ee=F.attributes.ssrcs.filter(ye=>ye.attributes.label===H),se=F.attributes.ssrcGroups;if(ee.length===0)throw new Error("Cannot extract ssrc from plan-b SDP.");if(se&&ee.length>1){const ye=se.find(me=>me.ssrcIds.indexOf(ee[0].ssrcId)!==-1);return ye?[{ssrcId:ye.ssrcIds[0],rtx:J?ye.ssrcIds[1]:void 0}]:[{ssrcId:ee[0].ssrcId}]}return[{ssrcId:ee[0].ssrcId}]}(B,x.id,a.useRTX)});let T;try{T=yield v}catch(N){throw h.forEach(x=>{fs()&&x.replaceTrack(null),a.peerConnection.removeTrack(x)}),N}const b=a.mungSendOfferSDP(p.sdp,i);a.remoteSDP.receive(i,s,T);const C=a.remoteSDP.toString();return yield en(a.peerConnection.setLocalDescription({type:"offer",sdp:b})),yield en(a.applySendEncodings(h,i)),yield en(a.peerConnection.setRemoteDescription({type:"answer",sdp:C})),i.map((N,x)=>{const B=N._mediaStreamTrack.id;return{localSSRC:v[x],id:B}})}catch(h){throw new Ee(z.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(h.toString()))}finally{u()}})()}async stopSending(i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const s=this.peerConnection.getSenders().filter(h=>{var p;return i.indexOf(((p=h.track)===null||p===void 0?void 0:p.id)||"")!==-1});if(s.length!==i.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");s.map(h=>{fs()&&h.replaceTrack(null),this.peerConnection.removeTrack(h)});const a=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(a),this.remoteSDP.stopReceiving(i);const u=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(s){throw new Ee(z.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(s.toString()))}}async receive(i,s,a,u){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(i," before remoteSDP created."));const{id:h,mslabel:p}=this.remoteSDP.send(i,s,u),_=new le((b,C)=>{const N=setTimeout(()=>{C(new Error("Cannot receive track, id: ".concat(h)))},1e4),x=B=>{const F=Zt();if((F.name==="Safari"&&Number(F.version)===11||ps())&&B.track.id!==h&&B.streams[0].id===p){var H;const J=B.streams[0].getTracks()[0];return(H=this.remoteSDP)===null||H===void 0||H.updateTrackLabel(i,h,B.track.id),this.peerConnection.removeEventListener("track",x),clearTimeout(N),void b(J)}if(B.track.id===h)return this.peerConnection.removeEventListener("track",x),clearTimeout(N),void b(B.track)};this.peerConnection.addEventListener("track",x)}),v=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:v});const T=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(T),{track:await _,id:h}}catch(h){throw new Ee(z.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(h.toString()))}}async stopReceiving(i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(i);const s=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const a=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(a)}catch(s){throw new Ee(z.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(s.toString()))}}async muteRemote(i){}async unmuteRemote(i){}async muteLocal(i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const s=this.peerConnection.getSenders().filter(a=>{var u;return i.indexOf(((u=a.track)===null||u===void 0?void 0:u.id)||"")!==-1});if(s.length!==i.length)throw new Error("sender' length doesn't match mids' length.");s.map(a=>{if(fs()&&a.track)a.track.enabled=!1;else{const u=a.getParameters();u.encodings.forEach(h=>h.active=!1),a.setParameters(u)}})}catch(s){throw new Ee(z.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(s.toString()))}}async unmuteLocal(i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const s=this.peerConnection.getSenders().filter(h=>{var p;return i.indexOf(((p=h.track)===null||p===void 0?void 0:p.id)||"")!==-1});if(s.length!==i.length)throw new Error("Senders' length doesn't match mids' length.");s.map(async h=>{if(fs()&&h.track)h.track.enabled=!0;else{const p=h.getParameters();p.encodings.forEach(_=>_.active=!0),await h.setParameters(p)}});const a=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(a);const u=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(s){throw new Ee(z.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(s.toString()))}}restartICE(i){var s=this;return Ha(function*(){const a=yield en(s.mutex.lock("From P2PConnection.restartICE"));try{if(!s.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(In().supportPCSetConfiguration){const v=s.peerConnection.getConfiguration(),T=i===Fr.RELAY?"relay":"all";v.iceTransportPolicy!==T&&(D.debug("[".concat(s.store.clientId,"] restartICE change iceTransportPolicy from [").concat(v.iceTransportPolicy,"] to [").concat(T,"]")),v.iceTransportPolicy=T,s.peerConnection.setConfiguration(v))}else if(i===Fr.RELAY)return;i!==Fr.RELAY&&s.remoteSDP.updateCandidates(i);const u=yield en(s.peerConnection.createOffer({iceRestart:!0}));if(!u.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const h=am(u.sdp),{remoteIceParameters:p}=yield h.iceParameters;s.remoteSDP.restartICE(p);const _=s.remoteSDP.toString();yield en(s.peerConnection.setLocalDescription(u)),yield en(s.peerConnection.setRemoteDescription({type:"answer",sdp:_}))}catch(u){D.warning("[".concat(s.store.clientId,"] restart ICE failed, abort operation"),u)}finally{a()}})()}close(){var i;this.peerConnection.close(),(i=this.onConnectionStateChange)===null||i===void 0||i.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(i){return this.statsFilter.getVideoIsReady(i)}async updateEncoderConfig(i,s){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const a=await this.peerConnection.createOffer(),u=this.mungSendOfferSDP(a.sdp,[s]);this.remoteSDP.updateRecvMedia(s._mediaStreamTrack.kind,s);const h=this.remoteSDP.toString();await this.peerConnection.setLocalDescription({type:"offer",sdp:u}),await this.peerConnection.setRemoteDescription({type:"answer",sdp:h})}catch(a){throw new Ee(z.EXCHANGE_SDP_FAILED,a.toString())}}async updateSendParameters(i,s){const a=this.peerConnection.getSenders().filter(u=>{var h;return((h=u.track)===null||h===void 0?void 0:h.id)===i});a.length===1&&await this.applySendEncodings(a,[s])}setStatsRemoteVideoIsReady(i,s){this.statsFilter.setVideoIsReady2(i,s)}async replaceTrack(i,s){const a=this.peerConnection.getSenders().find(u=>{var h;return((h=u.track)===null||h===void 0?void 0:h.id)===s});a&&await a.replaceTrack(i._mediaStreamTrack)}createDataChannels(i,s){throw new Ee(z.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}stopDataChannels(i){throw new Ee(z.NOT_SUPPORTED,"Planb mode does not support stopDataChannels.")}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var i;(i=this.onICEConnectionStateChange)===null||i===void 0||i.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var i;(i=this.onConnectionStateChange)===null||i===void 0||i.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=i=>{i.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,D.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,D.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},te("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(i){const s={iceServers:[],sdpSemantics:"plan-b"};return i.iceServers?s.iceServers=i.iceServers:i.turnServer&&i.turnServer.mode!=="off"&&(V_(i.turnServer.servers)?s.iceServers=i.turnServer.servers:(s.iceServers&&s.iceServers.push(..._r.turnServerConfigToIceServers(i.turnServer.servers)),te("USE_TURN_SERVER_OF_GATEWAY")&&s.iceServers&&i.turnServer.serversFromGateway&&s.iceServers.push(..._r.turnServerConfigToIceServers(i.turnServer.serversFromGateway)),i.turnServer.servers.concat(i.turnServer.serversFromGateway||[]).forEach(a=>{a.forceturn&&(s.iceTransportPolicy="relay")}))),s}static turnServerConfigToIceServers(i){const s=[];return i.forEach(a=>{a.security?a.tcpport&&s.push({username:a.username,credential:a.password,credentialType:"password",urls:"turns:".concat(a.turnServerURL,":").concat(a.tcpport,"?transport=tcp")}):(a.udpport&&s.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.udpport,"?transport=udp")}),a.tcpport&&s.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.tcpport,"?transport=tcp")}))}),s}async updateRtpSenderEncodings(i,s){var a;if(s||(s=this.peerConnection.getSenders().find(T=>{var b;return((b=T.track)===null||b===void 0?void 0:b.id)===i._mediaStreamTrack.id})),!s)return D.warn("[".concat(i.getTrackId(),"] no rtpSender found}"));if(!In().supportSetRtpSenderParameters)return D.warn("Browser not support set rtp-sender parameters");const u={},h={};if(i instanceof Ct)switch(i._optimizationMode){case"motion":u.degradationPreference="maintain-framerate";break;case"detail":u.degradationPreference="maintain-resolution";break;default:u.degradationPreference="balanced"}if(te("DSCP_TYPE")&&Ih()){var p;const T=te("DSCP_TYPE");ot(p=["very-low","low","medium","high"]).call(p,T)&&(h.networkPriority=T)}const _=s.getParameters(),v=(a=_.encodings)===null||a===void 0?void 0:a[0];v&&Object.assign(v,h),Object.assign(_,u),D.debug("[".concat(i.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(_.encodings))),await s.setParameters(_)}async applySendEncodings(i,s){try{if(!In().supportSetRtpSenderParameters||i.length!==s.length)return;for(let a=0;a<i.length;a++){const u=i[a],h=s[a];u&&h&&await this.updateRtpSenderEncodings(h,u)}}catch{D.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(i,s){const a=li.parse(i);return s.forEach((u,h)=>{const p=u._mediaStreamTrack,_=a.mediaDescriptions.find(v=>v.attributes.mid===p.kind);_&&cm(_,u)}),li.print(a)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=i=>{var s;(s=this.onFirstAudioReceived)===null||s===void 0||s.call(this,i)},this.statsFilter.onFirstVideoReceived=i=>{var s;(s=this.onFirstVideoReceived)===null||s===void 0||s.call(this,i)},this.statsFilter.onFirstAudioDecoded=i=>{var s;(s=this.onFirstAudioDecoded)===null||s===void 0||s.call(this,i)},this.statsFilter.onFirstVideoDecoded=(i,s,a)=>{var u;(u=this.onFirstVideoDecoded)===null||u===void 0||u.call(this,i,s,a)},this.statsFilter.onSelectedLocalCandidateChanged=(i,s)=>{var a;(a=this.onSelectedLocalCandidateChanged)===null||a===void 0||a.call(this,i,s)},this.statsFilter.onSelectedRemoteCandidateChanged=(i,s)=>{var a;(a=this.onSelectedRemoteCandidateChanged)===null||a===void 0||a.call(this,i,s)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}async batchReceive(i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const s=this.remoteSDP.batchSend(i).map((h,p)=>{let{id:_,mslabel:v}=h;const{kind:T}=i[p];return new le((b,C)=>{const N=setTimeout(()=>{C(new Error("Cannot receive track, id: ".concat(_)))},1e4),x=B=>{const F=Zt();if(F.name==="Safari"&&Number(F.version)===11&&B.track.id!==_&&B.streams[0].id===v){var H;const J=B.streams[0].getTracks()[0];return(H=this.remoteSDP)===null||H===void 0||H.updateTrackLabel(T,_,B.track.id),this.peerConnection.removeEventListener("track",x),clearTimeout(N),void b({track:J,id:_})}if(B.track.id===_)return this.peerConnection.removeEventListener("track",x),clearTimeout(N),void b({track:B.track,id:_})};this.peerConnection.addEventListener("track",x)})}),a=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:a});const u=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(u),await le.all(s)}catch(s){throw new Ee(z.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(s.toString()))}}async getRemoteSSRC(i){if(!this.remoteSDP)return;const s=this.remoteSDP.getSSRC(i);return s==null?void 0:s[0].ssrcId}setConfiguration(i){if(In().supportPCSetConfiguration){const s=_r.resolvePCConfiguration(i);this.peerConnection.setConfiguration(s)}}}function za(o,i,s){const a=o[i];if(typeof a!="function")throw new Error("Cannot use mutex on object property.");return s.value=async function(){const u=this.mutex,h=await u.lock("Locking from P2PConnection.".concat(i));try{for(var p=arguments.length,_=new Array(p),v=0;v<p;v++)_[v]=arguments[v];return await a.apply(this,_)}finally{h()}},s}function y$(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function zh(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?y$(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):y$(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}ve([za,j("design:type",Function),j("design:paramtypes",[Object,Object,Array,Object,String,String]),j("design:returntype",le)],_r.prototype,"connect",null),ve([za,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",le)],_r.prototype,"stopSending",null),ve([za,j("design:type",Function),j("design:paramtypes",[String,Array,String,Object]),j("design:returntype",le)],_r.prototype,"receive",null),ve([za,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",le)],_r.prototype,"stopReceiving",null),ve([za,j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",le)],_r.prototype,"muteRemote",null),ve([za,j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",le)],_r.prototype,"unmuteRemote",null),ve([za,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",le)],_r.prototype,"muteLocal",null),ve([za,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",le)],_r.prototype,"unmuteLocal",null),ve([za,j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],_r.prototype,"close",null),ve([za,j("design:type",Function),j("design:paramtypes",[String,Vr]),j("design:returntype",le)],_r.prototype,"updateEncoderConfig",null),ve([za,j("design:type",Function),j("design:paramtypes",[String,Vr]),j("design:returntype",le)],_r.prototype,"updateSendParameters",null),ve([za,j("design:type",Function),j("design:paramtypes",[Vr,String]),j("design:returntype",le)],_r.prototype,"replaceTrack",null),ve([za,j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",le)],_r.prototype,"getRemoteSSRC",null);const SS="9",S$=4e4;function T$(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function dE(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?T$(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):T$(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}let Ki=class iT extends SI{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var i,s;return(i=(s=this.peerConnection.getReceivers()[0])===null||s===void 0||(s=s.transport)===null||s===void 0?void 0:s.state)!==null&&i!==void 0?i:null}constructor(i,s){super(i,s),O(this,"store",void 0),O(this,"peerConnection",void 0),O(this,"remoteSDP",void 0),O(this,"initialOffer",void 0),O(this,"transportEventReceiver",void 0),O(this,"statsFilter",void 0),O(this,"useXR",te("USE_XR")),O(this,"localCapabilities",void 0),O(this,"remoteCodecs",void 0),O(this,"localCandidateCount",0),O(this,"allCandidatesReceived",!1),O(this,"dataStreamChannelMap",new Map),O(this,"establishPromise",void 0),O(this,"mutex",new fr("P2PConnection-mutex")),this.store=s,this.peerConnection=new RTCPeerConnection(iT.resolvePCConfiguration(i),{optional:[{googDscp:!0}]}),this.statsFilter=cA(this.peerConnection,te("STATS_UPDATE_INTERVAL"),void 0,jn()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async updateRemoteRTPCapabilities(i,s){this.remoteCodecs=s;const a=[...new Set(this.localCapabilities&&this.localCapabilities.send.videoCodecs.map(u=>u.rtpMap&&u.rtpMap.encodingName.toLowerCase()||"").filter(u=>{var h;return ot(h=Object.keys(Kp)).call(h,u)}))];if(it.updateRemoteRTPCapabilities(this.store.sessionId,{mids:i,localCodecs:a,remoteCodecs:this.remoteCodecs}),!this.remoteSDP)return void D.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(a,", codecs: ").concat(s));if(this.remoteSDP.updateRemoteCodec(i,s,this.store.codec)){const u=await this.peerConnection.createOffer(),h=this.logSDPExchange(u.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(u);const p=this.remoteSDP.toString();h==null||h(p),await this.peerConnection.setRemoteDescription({type:"answer",sdp:p})}else D.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.")}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});const i=await this.peerConnection.createOffer();if(!i.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const s=am(i.sdp),a=await s$({filterRTX:!te("USE_PUB_RTX")&&!te("USE_SUB_RTX"),filterVideoFec:te("FILTER_VIDEO_FEC"),filterAudioFec:te("FILTER_AUDIO_FEC"),filterVideoCodec:te("FILTER_VIDEO_CODEC")},{useXR:this.useXR});return this.localCapabilities=sA(a),this.initialOffer=i,dE(dE({},s),{},{rtpCapabilities:a,offerSDP:i.sdp})}catch(i){throw new Ee(z.GET_LOCAL_CONNECTION_PARAMS_FAILED,i.toString())}}async connect(i,s,a,u,h,p){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new class{get localCapabilities(){return Ai(this._localCapabilities)}get rtpCapabilities(){return Ai(this._rtpCapabilities)}get candidates(){return Ai(this._candidates)}get iceParameters(){return Ai(this._iceParameters)}get dtlsParameters(){return Ai(this._dtlsParameters)}constructor(x){O(this,"sessionDesc",void 0),O(this,"_localCapabilities",void 0),O(this,"_rtpCapabilities",void 0),O(this,"_candidates",void 0),O(this,"_iceParameters",void 0),O(this,"_dtlsParameters",void 0),O(this,"setup",void 0),O(this,"currentMidIndex",void 0),O(this,"cname",void 0),O(this,"firefoxSsrcMidMap",new Map),x=Ai(x);const{remoteIceParameters:B,remoteDtlsParameters:F,candidates:H,remoteRTPCapabilities:J,remoteSetup:ee,localCapabilities:se,cname:ye}=x,me=li.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=ice-lite
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`);this._rtpCapabilities=J,this._candidates=H,this._iceParameters=B,this._dtlsParameters=F,this._localCapabilities=se,this.setup=ee,this.cname=ye;const ue=this.rtpCapabilities.send;for(const he of me.mediaDescriptions){if(he.attributes.iceUfrag=B.iceUfrag,he.attributes.icePwd=B.icePwd,he.attributes.fingerprints=F.fingerprints,he.attributes.candidates=H,he.attributes.setup=ee,he.media.mediaType==="video"&&(he.media.fmts=ue.videoCodecs.map(pe=>pe.payloadType.toString(10)),he.attributes.payloads=ue.videoCodecs,he.attributes.extmaps=ue.videoExtensions,te("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:pe,ssrcGroups:Ve}=$a([{ssrcId:S$,rtx:te("USE_SUB_RTX")?40001:void 0}],this.cname);he.attributes.ssrcs=pe,he.attributes.ssrcGroups=Ve}if(he.media.mediaType==="audio"&&(he.media.fmts=ue.audioCodecs.map(pe=>pe.payloadType.toString(10)),he.attributes.payloads=ue.audioCodecs,he.attributes.extmaps=ue.audioExtensions,$h(he),te("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:pe,ssrcGroups:Ve}=$a([{ssrcId:2e4}],this.cname);he.attributes.ssrcs=pe,he.attributes.ssrcGroups=Ve}}this.sessionDesc=me,this.currentMidIndex=me.mediaDescriptions.length-1}preloadRemoteMedia(){const x=te("PRELOAD_MEDIA_COUNT");this.rtpCapabilities;const B=this.candidates,F=this.dtlsParameters,H=this.iceParameters,J=this.rtpCapabilities.send;for(let ee=1;ee<x;ee++){const se=2*ee+2e4,ye=2*ee+S$,{ssrcs:me,ssrcGroups:ue}=$a([{ssrcId:se}],this.cname),{ssrcs:he,ssrcGroups:pe}=$a([{ssrcId:ye,rtx:te("USE_SUB_RTX")?ye+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:SS,protos:["UDP","TLS","RTP","SAVPF"],fmts:J.videoCodecs.map(Ve=>Ve.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:H.iceUfrag,icePwd:H.icePwd,unrecognized:[],candidates:B,extmaps:J.videoExtensions,fingerprints:F.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:he,ssrcGroups:pe,rtcpFeedbackWildcards:[],payloads:J.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*ee)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:SS,protos:["UDP","TLS","RTP","SAVPF"],fmts:J.audioCodecs.map(Ve=>Ve.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:H.iceUfrag,icePwd:H.icePwd,unrecognized:[],candidates:B,extmaps:J.audioExtensions,fingerprints:F.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:me,ssrcGroups:ue,rtcpFeedbackWildcards:[],payloads:J.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*ee+1)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return li.print(this.sessionDesc)}send(x,B,F,H){const{ssrcs:J,ssrcGroups:ee}=$a(B,this.cname,te("SYNC_GROUP")?F:void 0),se=this.findPreloadMediaDesc(J);if(se){if(jn()&&this.firefoxSsrcMidMap.set(J[0].ssrcId,se.attributes.mid),H&&(H.twcc||H.remb)){const ye=this.sessionDesc.mediaDescriptions.indexOf(se);return this.sessionDesc.mediaDescriptions[ye]=this.mungSendMediaDesc(se,H),{mid:se.attributes.mid,needExchangeSDP:!0}}return{mid:se.attributes.mid,needExchangeSDP:!1}}{const ye=this.findAvailableMediaIndex(x,J);let me;return ye===-1||ye===1&&(fs()||u8())||ye===0&&te("USE_SUB_RTX")||d8()?(me=this.createOrRecycleSendMedia(x,J,ee,"sendonly",H),this.updateBundleMids()):(me=Ai(this.sessionDesc.mediaDescriptions[ye]),me.attributes.direction="sendonly",me.attributes.ssrcs=J,me.attributes.ssrcGroups=ee,this.sessionDesc.mediaDescriptions[ye]=this.mungSendMediaDesc(me,H)),jn()&&this.firefoxSsrcMidMap.set(J[0].ssrcId,me.attributes.mid),{mid:me.attributes.mid,needExchangeSDP:!0}}}sendDataChannel(){const{mediaDesc:x,needExchangeSDP:B}=this.createOrRecycleDataChannel();return this.updateBundleMids(),{mid:x.attributes.mid,needExchangeSDP:B}}batchSend(x){const B=x.map(J=>{let{kind:ee,ssrcMsg:se,mslabel:ye}=J;return this.send(ee,se,ye)}),F=[];let H=!1;return B.forEach(J=>{let{mid:ee,needExchangeSDP:se}=J;se&&(H=!0),F.push(ee)}),{mids:F,needExchangeSDP:H}}stopSending(x){const B=this.sessionDesc.mediaDescriptions.filter(F=>F.attributes.mid&&x.indexOf(F.attributes.mid)!==-1);if(B.length!==x.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");B.forEach(F=>{F.attributes.mid==="0"||jn()||d8()?F.attributes.ssrcs=[]:(F.attributes.ssrcs=[],F.attributes.direction="inactive",F.media.port="0")}),this.updateBundleMids()}mute(x){const B=this.sessionDesc.mediaDescriptions.find(F=>F.attributes.mid===x);if(!B)throw new Error("mediaDescription not found with ".concat(x," in remote SDP when calling RemoteSDP.mute."));B.attributes.direction="inactive"}unmute(x){const B=this.sessionDesc.mediaDescriptions.find(F=>F.attributes.mid===x);if(!B)throw new Error("mediaDescription not found with ".concat(x," in remote SDP when calling RemoteSDP.unmute."));B.attributes.direction="sendonly"}muteRemote(x){const B=this.sessionDesc.mediaDescriptions.filter(F=>ot(x).call(x,F.attributes.mid||""));if(B.length!==x.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");B.forEach(F=>{F.attributes.direction="inactive"})}unmuteRemote(x){const B=this.sessionDesc.mediaDescriptions.filter(F=>ot(x).call(x,F.attributes.mid||""));if(B.length!==x.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");B.forEach(F=>{F.attributes.direction="recvonly"})}receive(x,B,F,H){x.forEach((J,ee)=>{this.createOrRecycleRecvMedia(J,[],"recvonly",B,F,H[ee])}),this.updateBundleMids()}stopReceiving(x){const B=this.sessionDesc.mediaDescriptions.filter(F=>x.indexOf(F.attributes.mid)!==-1);if(B.length!==x.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");B.forEach(F=>{F.media.port="0",F.attributes.direction="inactive"}),this.updateBundleMids()}updateCandidates(x){const B=this._candidates.filter(F=>F.transport==="udp");if(x===Fr.TCP){if(B.length===0)return;if(te("TCP_CANDIDATE_ONLY")){const F=this._candidates.filter(H=>H.transport==="tcp");B.forEach(H=>{F.findIndex(J=>J.connectionAddress===H.connectionAddress)===-1&&F.push(zh(zh({},H),{},{foundation:"tcpcandidate",priority:Number(H.priority)-1+"",transport:"tcp",port:Number(H.port)+90+""}))}),this._candidates=F}else{const F=[];B.forEach(H=>{F.push(zh(zh({},H),{},{foundation:"tcpcandidate",priority:Number(H.priority)-1+"",transport:"tcp",port:Number(H.port)+90+""}))}),this._candidates=[...B,...F]}}else if(x===Fr.RELAY){if(B.length!==0)return;{const F=this._candidates.filter(H=>H.transport==="tcp");F.forEach(H=>{B.push(zh(zh({},H),{},{foundation:"udpcandidate",priority:Number(H.priority)+1+"",transport:"udp",port:Number(H.port)-90+""}))}),this._candidates=[...B,...F]}}else B.length===0?(this._candidates.filter(F=>F.transport==="tcp").forEach(F=>{B.push(zh(zh({},F),{},{foundation:"udpcandidate",priority:Number(F.priority)+1+"",transport:"udp",port:Number(F.port)-90+""}))}),this._candidates=B):this._candidates=this._candidates.filter(F=>F.transport!=="tcp");for(const F of this.sessionDesc.mediaDescriptions)F.attributes.candidates=this.candidates}restartICE(x){x=Ai(x),this._iceParameters=x,this.sessionDesc.mediaDescriptions.forEach(B=>{B.attributes.iceUfrag=x.iceUfrag,B.attributes.icePwd=x.icePwd})}predictReceivingMids(x){const B=[];for(let F=0;F<x;F++)B.push((this.currentMidIndex+F+1).toString(10));return B}findAvailableMediaIndex(x,B){return this.sessionDesc.mediaDescriptions.findIndex(F=>{const H=F.media.mediaType===x&&F.media.port!=="0"&&(F.attributes.direction==="sendonly"||F.attributes.direction==="sendrecv")&&F.attributes.ssrcs.length===0;if(jn()){if(H){const J=this.firefoxSsrcMidMap.get(B[0].ssrcId);return!(J||F.attributes.mid!=="0"&&F.attributes.mid!=="1")||!(!J||J!==F.attributes.mid)}return!1}return H})}createOrRecycleDataChannel(){for(const F of this.sessionDesc.mediaDescriptions)if(F.media.mediaType==="application")return{mediaDesc:F,needExchangeSDP:!1};this.currentMidIndex+=1;const x="".concat(this.currentMidIndex),B={media:{mediaType:"application",port:SS,protos:["UDP","DTLS","SCTP"],fmts:["webrtc-datachannel"]},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:[],fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[],rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,mid:"".concat(x),sctpPort:"5000"}};return this.sessionDesc.mediaDescriptions.push(B),{mediaDesc:B,needExchangeSDP:!0}}createOrRecycleRecvMedia(x,B,F,H,J,ee){const se=x._mediaStreamTrack.kind,ye=this.rtpCapabilities.recv,me=aA(se,ye,this.localCapabilities.send,se===Qe.VIDEO?H:J),ue=se===Qe.VIDEO?ye.videoExtensions:ye.audioExtensions;this.currentMidIndex+=1;const he="".concat(this.currentMidIndex);let pe={media:{mediaType:se,port:SS,protos:["UDP","TLS","RTP","SAVPF"],fmts:me.map(Me=>Me.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:ue,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:B,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:me,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:F,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(he)}};pe=this.mungRecvMediaDsec(pe,x,ee);const Ve=this.findFirstClosedMedia(se);if(Ve){const Me=this.sessionDesc.mediaDescriptions.indexOf(Ve);this.sessionDesc.mediaDescriptions[Me]=pe}else this.sessionDesc.mediaDescriptions.push(pe);return pe}updateRemoteCodec(x,B,F){const H=[...new Set(this._rtpCapabilities.recv.videoCodecs.map(pe=>pe.rtpMap&&pe.rtpMap.encodingName.toLowerCase()||"").filter(pe=>{var Ve;return ot(Ve=Object.keys(Kp)).call(Ve,pe)}))],J=new Set(B);if(H.every(pe=>J.has(pe)))return D.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(B)),!1;const ee=this._rtpCapabilities.recv.videoCodecs.filter(pe=>B.some(Ve=>{var Me;return ot(Me=pe.rtpMap&&pe.rtpMap.encodingName.toLowerCase()||"").call(Me,Ve)}));if(ee.length===0)return D.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(H," codecs: ").concat(B)),!1;const se=[...new Set(ee.map(pe=>pe.rtpMap&&pe.rtpMap.encodingName.toLowerCase()||""))];let ye;if(D.debug("updateRemoteCodec, from ".concat(H," to ").concat(se)),x.length===0)ye=this.sessionDesc.mediaDescriptions.filter(pe=>pe.media.mediaType==="video"&&pe.attributes.direction==="recvonly");else if(ye=this.sessionDesc.mediaDescriptions.filter(pe=>pe.attributes.mid&&ot(x).call(x,pe.attributes.mid)&&pe.attributes.direction==="recvonly"),ye.length!==x.length)return D.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(x,", codecs: ").concat(B)),!1;this._rtpCapabilities.recv.videoCodecs=ee;const me=this.localCapabilities.send,ue=this.rtpCapabilities.recv,he=aA(Qe.VIDEO,ue,me,F);return ye.forEach(pe=>{const Ve=he.map(Me=>Me.payloadType.toString(10));D.debug("updateRemoteCodec mid: ".concat(pe.attributes.mid,", from ").concat(pe.attributes.payloads," to ").concat(he)),pe.attributes.payloads=he,pe.media.fmts=Ve}),!0}createOrRecycleSendMedia(x,B,F,H,J){const ee=this.rtpCapabilities.send,se=x===Qe.VIDEO?ee.videoCodecs:ee.audioCodecs,ye=x===Qe.VIDEO?ee.videoExtensions:ee.audioExtensions;this.currentMidIndex+=1;const me="".concat(this.currentMidIndex);let ue={media:{mediaType:x,port:SS,protos:["UDP","TLS","RTP","SAVPF"],fmts:se.map(pe=>pe.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:ye,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:B,ssrcGroups:F,rtcpFeedbackWildcards:[],payloads:se,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:H,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(me)}};ue=this.mungSendMediaDesc(ue,J);const he=this.findFirstClosedMedia(x);if(he){const pe=this.sessionDesc.mediaDescriptions.indexOf(he);this.sessionDesc.mediaDescriptions[pe]=ue}else this.sessionDesc.mediaDescriptions.push(ue);return ue}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(x=>x.media.port!=="0").map(x=>x.attributes.mid)}mungRecvMediaDsec(x,B,F){const H=Ai(x);return AU(H),cm(H,B),OU(H,B),r$(H),iA(H,F,this.localCapabilities.send),H}mungSendMediaDesc(x,B){const F=Ai(x);return iA(F,B,this.localCapabilities.recv),$h(F),F}updateRecvMedia(x,B){const F=this.sessionDesc.mediaDescriptions.findIndex(H=>H.attributes.mid===x);if(F!==-1){const H=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[F],B);this.sessionDesc.mediaDescriptions[F]=H}}bumpMid(x){this.currentMidIndex+=x}findFirstClosedMedia(x){return this.sessionDesc.mediaDescriptions.find(B=>jn()?B.media.port==="0"&&B.media.mediaType===x:B.media.port==="0")}findPreloadMediaDesc(x){return this.sessionDesc.mediaDescriptions.find(B=>{var F;return((F=B.attributes)===null||F===void 0||(F=F.ssrcs[0])===null||F===void 0?void 0:F.ssrcId)===x[0].ssrcId})}getSSRC(x){var B;return(B=this.sessionDesc.mediaDescriptions.find(F=>F.attributes.mid===x))===null||B===void 0?void 0:B.attributes.ssrcs}}({remoteIceParameters:i,remoteDtlsParameters:s,candidates:a,remoteRTPCapabilities:u,remoteSetup:h,localCapabilities:this.localCapabilities,cname:p}),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);const _=this.remoteSDP.toString(),v=li.parse(this.initialOffer.sdp),T=v.mediaDescriptions.find(x=>x.media.mediaType==="audio");T&&$h(T),this.useXR&&oA(v);const b=li.print(v),C=this.logSDPExchange(b||"","offer","local","connect");this.store.descriptionStart(),await this.peerConnection.setLocalDescription({type:"offer",sdp:b}),C==null||C(_),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_});const N=this.peerConnection.getTransceivers()[0];if(N!=null&&N.receiver&&this.tryBindTransportEvents(N.receiver),te("PRELOAD_MEDIA_COUNT")>0){this.remoteSDP.preloadRemoteMedia();const x=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:x});const B=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(B)}}catch(_){throw new Ee(z.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(_.toString()))}}send(i,s,a){var u=this;return Ha(function*(){const h=yield en(u.mutex.lock("From P2PConnection.send"));try{if(!u.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const p=[];i.forEach(F=>{const H=u.peerConnection.addTransceiver(F._mediaStreamTrack,{direction:"sendonly"});p.push(H),F._updateRtpTransceiver(H)}),jn()&&te("SIMULCAST")===!0&&(yield en(u.applySimulcastForFirefox(p,i)));const _=yield en(u.peerConnection.createOffer()),v=u.remoteSDP.predictReceivingMids(i.length),T=u.mungSendOfferSDP(_.sdp,i,v),b=li.parse(T),C=v.map(F=>{const H=b.mediaDescriptions.find(J=>J.attributes.mid===F);if(!H)throw new Error("Cannot extract ssrc from mediaDescription.");return n$(H,te("USE_PUB_RTX"))});let N;try{N=yield C}catch(F){N=[],u.remoteSDP.receive(i,s,a,N);const H=u.remoteSDP.toString();throw yield en(u.peerConnection.setLocalDescription({type:"offer",sdp:T})),yield en(u.peerConnection.setRemoteDescription({type:"answer",sdp:H})),yield en(u.stopSending(v,!0)),F}u.remoteSDP.receive(i,s,a,N);const x=u.remoteSDP.toString(),B=u.logSDPExchange(T,"offer","local","send");return yield en(u.peerConnection.setLocalDescription({type:"offer",sdp:T})),yield en(u.applySimulcastEncodings(p,i)),yield en(u.applySendEncodings(p,i)),B==null||B(x),yield en(u.peerConnection.setRemoteDescription({type:"answer",sdp:x})),p.map((F,H)=>{const J=v[H];return{localSSRC:C[H],id:J,transceiver:F}})}catch(p){throw p instanceof Ee?p:new Ee(z.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(p.toString()))}finally{h()}})()}async createDataChannels(i,s){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.createDataChannels before remote SDP created");let a=this.dataStreamChannelMap.get(i);a&&a.readyState==="open"?D.debug("[P2PConnection] Channels are already available and can be reused directly."):(a=this.peerConnection.createDataChannel("datastream-channel",{ordered:!1,maxRetransmits:te("DATASTREAM_MAX_RETRANSMITS")}),a.binaryType="arraybuffer",this.dataStreamChannelMap.set(i,a)),s.forEach(h=>{h._updateOriginDataChannel(a)});const{needExchangeSDP:u}=this.remoteSDP.sendDataChannel();if(u){const h=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:h});const p=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(p),D.debug("[P2PConnection] createDataChannels by exchanging SDP.")}else D.debug("[P2PConnection] createDataChannels no need to exchange SDP.");return}catch(a){throw a instanceof Ee?a:new Ee(z.EXCHANGE_SDP_FAILED,"P2PConnection.createDataChannels failed; ".concat(a.toString()))}}async stopDataChannels(i){try{const s=this.dataStreamChannelMap.get(i);return s==null||s.close(),void this.dataStreamChannelMap.delete(i)}catch(s){throw s instanceof Ee?s:new Ee(z.DATACHANNEL_FAILED,"P2PConnection.stopDataChannels failed; ".concat(s.toString()))}}async stopSending(i,s){const a=s?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const u=this.peerConnection.getTransceivers().filter(v=>i.indexOf(v.mid)!==-1);if(u.length!==i.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");u.map(v=>{var T;v.direction="inactive",(T=v.stop)===null||T===void 0||T.call(v)});const h=await this.peerConnection.createOffer(),p=this.logSDPExchange(h.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(h),this.remoteSDP.stopReceiving(i);const _=this.remoteSDP.toString();p==null||p(_),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_})}catch(u){throw new Ee(z.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(u.toString()))}finally{a&&a()}}async receive(i,s,a,u){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(i," before remoteSDP created."));const{mid:h,needExchangeSDP:p}=this.remoteSDP.send(i,s,a,u);if(p){const v=this.remoteSDP.toString(),T=this.logSDPExchange(v,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:v});const b=await this.peerConnection.createAnswer(),C=this.mungReceiveAnswerSDP(b.sdp,h,i);T==null||T(C||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:C}),D.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(i," by exchanging SDP."))}else D.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(i," no need to exchange SDP."));const _=this.peerConnection.getTransceivers().find(v=>v.mid===h);if(!_)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:_.receiver.track,id:h,transceiver:_}}catch(h){throw new Ee(z.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(h.toString()))}}async batchReceive(i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const{mids:s,needExchangeSDP:a}=this.remoteSDP.batchSend(i);if(a){const u=this.remoteSDP.toString(),h=this.logSDPExchange(u,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:u});const p=await this.peerConnection.createAnswer();h==null||h(p.sdp||""),await this.peerConnection.setLocalDescription(p),D.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive by exchanging SDP."))}else D.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive no need to exchange SDP."));return s.map(u=>{const h=this.peerConnection.getTransceivers().find(p=>p.mid===u);if(!h)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:h.receiver.track,id:u,transceiver:h}})}catch(s){throw new Ee(z.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(s.toString()))}}async stopReceiving(i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(i);const s=this.remoteSDP.toString(),a=this.logSDPExchange(s,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const u=await this.peerConnection.createAnswer();a==null||a(u.sdp||""),await this.peerConnection.setLocalDescription(u)}catch(s){throw new Ee(z.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(s.toString()))}}async muteRemote(i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(i," before remote SDP created."));this.remoteSDP.mute(i);const s=this.remoteSDP.toString(),a=this.logSDPExchange(s,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const u=await this.peerConnection.createAnswer();a==null||a(u.sdp||""),await this.peerConnection.setLocalDescription(u)}catch(s){throw new Ee(z.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(s.toString()))}}async unmuteRemote(i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(i," before remote SDP created."));this.remoteSDP.unmute(i);const s=this.remoteSDP.toString(),a=this.logSDPExchange(s,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const u=await this.peerConnection.createAnswer();a==null||a(u.sdp||""),await this.peerConnection.setLocalDescription(u)}catch(s){throw new Ee(z.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(s.toString()))}}async muteLocal(i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const s=this.peerConnection.getTransceivers().filter(p=>p.mid&&i.indexOf(p.mid)!==-1);if(s.length!==i.length)throw new Error("Transceivers' length doesn't match mids' length.");s.map(p=>{p.direction="inactive"});const a=await this.peerConnection.createOffer(),u=this.logSDPExchange(a.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(a),this.remoteSDP.muteRemote(i);const h=this.remoteSDP.toString();u==null||u(h),await this.peerConnection.setRemoteDescription({type:"answer",sdp:h})}catch(s){throw new Ee(z.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(s.toString()))}}async unmuteLocal(i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const s=this.peerConnection.getTransceivers().filter(p=>p.mid&&i.indexOf(p.mid)!==-1);if(s.length!==i.length)throw new Error("Transceivers' length doesn't match mids' length.");s.map(async(p,_)=>{p.direction="sendonly"});const a=await this.peerConnection.createOffer(),u=this.logSDPExchange(a.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(a),this.remoteSDP.unmuteRemote(i);const h=this.remoteSDP.toString();u==null||u(h),await this.peerConnection.setRemoteDescription({type:"answer",sdp:h})}catch(s){throw new Ee(z.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(s.toString()))}}restartICE(i){var s=this;return Ha(function*(){const a=yield en(s.mutex.lock("From P2PConnection.restartICE"));try{if(!s.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(In().supportPCSetConfiguration){const T=s.peerConnection.getConfiguration(),b=i===Fr.RELAY?"relay":"all";T.iceTransportPolicy!==b&&(D.debug("[".concat(s.store.clientId,"] restartICE change iceTransportPolicy from [").concat(T.iceTransportPolicy,"] to [").concat(b,"]")),T.iceTransportPolicy=b,s.peerConnection.setConfiguration(T))}else if(i===Fr.RELAY)return;s.remoteSDP.updateCandidates(i);const u=yield en(s.peerConnection.createOffer({iceRestart:!0}));if(!u.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const h=am(u.sdp),{remoteIceParameters:p}=yield h.iceParameters;s.remoteSDP.restartICE(p);const _=s.remoteSDP.toString(),v=s.logSDPExchange(u.sdp||"","offer","local","restartICE");s.store.descriptionStart(),yield en(s.peerConnection.setLocalDescription(u)),v==null||v(_),yield en(s.peerConnection.setRemoteDescription({type:"answer",sdp:_}))}catch(u){D.warning("[".concat(s.store.clientId,"] restart ICE failed, abort operation"),u)}finally{a()}})()}close(){var i;this.peerConnection.close(),(i=this.onConnectionStateChange)===null||i===void 0||i.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(i){return this.statsFilter.getVideoIsReady(i)}async updateEncoderConfig(i,s){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const a=await this.peerConnection.createOffer(),u=this.mungSendOfferSDP(a.sdp,[s],[i]);this.remoteSDP.updateRecvMedia(i,s);const h=this.remoteSDP.toString(),p=this.logSDPExchange(u,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:u}),p==null||p(h),await this.peerConnection.setRemoteDescription({type:"answer",sdp:h})}catch(a){throw new Ee(z.EXCHANGE_SDP_FAILED,a.toString())}}async updateSendParameters(i,s){const a=this.peerConnection.getTransceivers().filter(u=>u.mid===i);a.length===1&&(this.isVP8Simulcast(s)?jn()||await this.applySimulcastEncodings(a,[s]):await this.applySendEncodings(a,[s]))}setStatsRemoteVideoIsReady(i,s){this.statsFilter.setVideoIsReady2(i,s)}async replaceTrack(i,s){const a=this.peerConnection.getTransceivers().find(u=>u.mid===s);a&&await a.sender.replaceTrack(i._mediaStreamTrack)}async getSelectedCandidatePair(){const i=this.peerConnection.getReceivers();if(i.length>0&&i[0].transport&&i[0].transport.iceTransport&&i[0].transport.iceTransport.getSelectedCandidatePair&&i[0].transport.iceTransport.getSelectedCandidatePair()){const s=i[0].transport.iceTransport,{local:a,remote:u}=s.getSelectedCandidatePair();return{local:dE(dE({},ou),{},{candidateType:a.type,protocol:a.protocol,address:a.address,port:a.port}),remote:dE(dE({},ou),{},{candidateType:u.type,protocol:u.protocol,address:u.address,port:u.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var i;(i=this.onICEConnectionStateChange)===null||i===void 0||i.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var i;(i=this.onConnectionStateChange)===null||i===void 0||i.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=i=>{i.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,D.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,D.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},te("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(i){const s={iceServers:[]};return i.iceServers?s.iceServers=i.iceServers:i.turnServer&&i.turnServer.mode!=="off"&&(V_(i.turnServer.servers)?s.iceServers=i.turnServer.servers:(s.iceServers&&s.iceServers.push(...iT.turnServerConfigToIceServers(i.turnServer.servers)),te("USE_TURN_SERVER_OF_GATEWAY")&&s.iceServers&&i.turnServer.serversFromGateway&&s.iceServers.push(...iT.turnServerConfigToIceServers(i.turnServer.serversFromGateway)),te("FORCE_TURN_TCP")?s.iceTransportPolicy="relay":i.turnServer.servers.concat(i.turnServer.serversFromGateway||[]).forEach(a=>{a.forceturn&&(s.iceTransportPolicy="relay")}))),te("ENABLE_ENCODED_TRANSFORM")&&In().supportWebRTCEncodedTransform&&(s.encodedInsertableStreams=!0),s}static turnServerConfigToIceServers(i){const s=[];return i.forEach(a=>{a.security?a.tcpport&&s.push({username:a.username,credential:a.password,credentialType:"password",urls:"turns:".concat(gS(a.turnServerURL),":").concat(a.tcpport,"?transport=tcp")}):(a.udpport&&!te("FORCE_TURN_TCP")&&s.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.udpport,"?transport=udp")}),a.tcpport&&s.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.tcpport,"?transport=tcp")}))}),s}tryBindTransportEvents(i){const s=i.transport;if(s){this.transportEventReceiver=i,s.onstatechange=()=>{var u;s!=null&&s.state&&((u=this.onDTLSTransportStateChange)===null||u===void 0||u.call(this,s.state))},s.onerror=u=>{var h;(h=this.onDTLSTransportError)===null||h===void 0||h.call(this,"error"in u?u.error:u)};const a=s.iceTransport;a&&(a.onstatechange=()=>{const u=s==null?void 0:s.iceTransport.state;var h;u&&((h=this.onICETransportStateChange)===null||h===void 0||h.call(this,u))},a.getSelectedCandidatePair&&(a.onselectedcandidatepairchange=()=>{if(a.getSelectedCandidatePair()){const{local:u,remote:h}=a.getSelectedCandidatePair();D.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:u.type,protocol:u.protocol}),", remote ").concat(JSON.stringify({candidateType:h.type,protocol:h.protocol,address:h.address,port:h.port})," )"))}}))}}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(i,s){var a;if(s||(s=this.peerConnection.getSenders().find(b=>b.track===i._mediaStreamTrack)),!s)return D.warn("[".concat(i.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(i))return D.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!In().supportSetRtpSenderParameters)return D.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const u={},h={};switch(i._optimizationMode){case"motion":u.degradationPreference="maintain-framerate";break;case"detail":u.degradationPreference="maintain-resolution";break;default:u.degradationPreference="balanced"}if(i._encoderConfig){var p;const{bitrateMax:b,frameRate:C,scaleResolutionDownBy:N}=i._encoderConfig;b&&(h.maxBitrate=1e3*b),(ot(p=i._hints).call(p,Ln.LOW_STREAM)||i.isUseScaleResolutionDownBy)&&(C&&(h.maxFramerate=pa(C)),N&&N>=1&&(h.scaleResolutionDownBy=N))}if(te("DSCP_TYPE")&&Ih()){var _;const b=te("DSCP_TYPE");ot(_=["very-low","low","medium","high"]).call(_,b)&&(h.networkPriority=b)}const v=s.getParameters(),T=(a=v.encodings)===null||a===void 0?void 0:a[0];jn()&&!T&&(u.encodings=[h]),T&&Object.assign(T,h),Object.assign(v,u),D.debug("[".concat(i.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(v.encodings))),await s.setParameters(v)}async applySendEncodings(i,s){try{if(!In().supportSetRtpSenderParameters||i.length!==s.length)return;for(let a=0;a<i.length;a++){const u=i[a],h=s[a];h instanceof Ct&&!this.isVP8Simulcast(h)&&await this.updateRtpSenderEncodings(h,u.sender)}}catch{D.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(i,s,a){const u=li.parse(i);return s.forEach((h,p)=>{const _=a[p],v=u.mediaDescriptions.find(T=>T.attributes.mid===_);v&&(cm(v,h),NU(v,h,this.store.codec))}),li.print(u)}mungReceiveAnswerSDP(i,s,a){const u=li.parse(i),h=u.mediaDescriptions.find(p=>p.attributes.mid===s);return h&&(a===Qe.AUDIO&&h.media.mediaType==="audio"&&$h(h),this.useXR&&oA(u)),li.print(u)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=i=>{var s;(s=this.onFirstAudioReceived)===null||s===void 0||s.call(this,i)},this.statsFilter.onFirstVideoReceived=i=>{var s;(s=this.onFirstVideoReceived)===null||s===void 0||s.call(this,i)},this.statsFilter.onFirstAudioDecoded=i=>{var s;(s=this.onFirstAudioDecoded)===null||s===void 0||s.call(this,i)},this.statsFilter.onFirstVideoDecoded=(i,s,a)=>{var u;(u=this.onFirstVideoDecoded)===null||u===void 0||u.call(this,i,s,a)},this.statsFilter.onSelectedLocalCandidateChanged=(i,s)=>{var a;(a=this.onSelectedLocalCandidateChanged)===null||a===void 0||a.call(this,i,s)},this.statsFilter.onSelectedRemoteCandidateChanged=(i,s)=>{var a;(a=this.onSelectedRemoteCandidateChanged)===null||a===void 0||a.call(this,i,s)},this.statsFilter.onFirstVideoDecodedTimeout=i=>{var s;(s=this.onFirstVideoDecodedTimeout)===null||s===void 0||s.call(this,i)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(i,s){if(i.length===s.length)for(let v=0;v<i.length;v++){var a,u,h,p,_;const T=i[v],b=s[v];if(b instanceof Ct&&!ot(a=b._hints).call(a,Ln.LOW_STREAM)&&(u=b._encoderConfig)!==null&&u!==void 0&&u.bitrateMax&&((h=b._encoderConfig)===null||h===void 0?void 0:h.bitrateMax)>200&&(p=b._scalabilityMode)!==null&&p!==void 0&&p.numSpatialLayers&&((_=b._scalabilityMode)===null||_===void 0?void 0:_.numSpatialLayers)>1&&this.store.codec==="vp8"){const C={},N={high:1e3*(b._encoderConfig.bitrateMax-50),medium:5e4};C.encodings=[{rid:"m",active:!0,maxBitrate:N.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:N.high}];const x=T.sender.getParameters();await T.sender.setParameters(Object.assign(x,C))}}}async applySimulcastEncodings(i,s){if(!jn()&&i.length===s.length)for(let a=0;a<i.length;a++){const u=s[a];if(u instanceof Ct&&this.isVP8Simulcast(u)){const h=i[a],p={},_={high:1e3*(u._encoderConfig.bitrateMax-50),medium:5e4};p.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:_.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:_.medium,scaleResolutionDownBy:4}];const v=h.sender.getParameters();await h.sender.setParameters(Object.assign(v,p))}}}isVP8Simulcast(i){var s,a,u,h,p;return!!(i instanceof Ct&&te("SIMULCAST")&&this.store.codec==="vp8"&&!ot(s=i._hints).call(s,Ln.LOW_STREAM)&&(a=i._encoderConfig)!==null&&a!==void 0&&a.bitrateMax&&((u=i._encoderConfig)===null||u===void 0?void 0:u.bitrateMax)>200&&(h=i._scalabilityMode)!==null&&h!==void 0&&h.numSpatialLayers&&((p=i._scalabilityMode)===null||p===void 0?void 0:p.numSpatialLayers)>1)}logSDPExchange(i,s,a,u){if(te("SDP_LOGGING"))return D.upload("[".concat(this.store.clientId,"] exchanging ").concat(a," ").concat(s," SDP during P2PConnection.").concat(u,`
`),i),s==="offer"?h=>{this.logSDPExchange(h,"answer",a==="local"?"remote":"local",u)}:void 0}async getRemoteSSRC(i){if(!this.remoteSDP)return;const s=this.remoteSDP.getSSRC(i);return s==null?void 0:s[0].ssrcId}setConfiguration(i){if(In().supportPCSetConfiguration){const s=iT.resolvePCConfiguration(i);this.peerConnection.setConfiguration(s)}}};function Uo(o,i,s){const a=o[i];if(typeof a!="function")throw new Error("Cannot use mutex on object property.");return s.value=async function(){const u=this.mutex,h=await u.lock("From P2PConnection.".concat(i));try{for(var p=arguments.length,_=new Array(p),v=0;v<p;v++)_[v]=arguments[v];return await a.apply(this,_)}finally{h()}},s}function DU(o,i){let s=document.createElement("video"),a=document.createElement("canvas");s.setAttribute("style","display:none"),a.setAttribute("style","display:none"),s.setAttribute("muted",""),s.muted=!0,s.setAttribute("autoplay",""),s.autoplay=!0,s.setAttribute("playsinline",""),a.width=pa(i.width),a.height=pa(i.height);const u=pa(i.framerate||15);document.body.append(s),document.body.append(a);let h=o._mediaStreamTrack;s.srcObject=new MediaStream([h]),s.play();const p=a.getContext("2d");if(!p)throw new ae(z.UNEXPECTED_ERROR,"can not get canvas context");const _=In(),v=a.captureStream(_.supportRequestFrame?0:u).getVideoTracks()[0];v.canvas||(v.canvas=a),a.startCapture=()=>{if(!s)return a.stopCapture&&a.stopCapture();if(s.paused&&s.play(),s.videoHeight>2&&s.videoWidth>2){const b=s.videoWidth,C=s.videoHeight/b,N=a.width*C;Math.abs(N-a.height)>=2&&(D.debug("adjust low stream resolution","".concat(a.width,"x").concat(a.height," -> ").concat(a.width,"x").concat(N)),a.height=N)}p.drawImage(s,0,0,a.width,a.height),v.requestFrame&&v.requestFrame(),h!==o._mediaStreamTrack&&(h=o._mediaStreamTrack,s.srcObject=new MediaStream([h]))},a.stopCapture=U2(()=>a.startCapture&&a.startCapture(),u);const T=v.stop;return v.stop=()=>{T.call(v),s&&(s.remove(),s.srcObject=null,s=null),a&&(a.width=0,a.remove(),a.stopCapture&&a.stopCapture(),a.startCapture=void 0,a.stopCapture=void 0,a=null),D.debug("clean low stream renderer")},v}function b$(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function w$(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?b$(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):b$(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}ve([Uo,j("design:type",Function),j("design:paramtypes",[Array,Array]),j("design:returntype",le)],Ki.prototype,"updateRemoteRTPCapabilities",null),ve([Uo,j("design:type",Function),j("design:paramtypes",[Object,Object,Array,Object,String,String]),j("design:returntype",le)],Ki.prototype,"connect",null),ve([Uo,j("design:type",Function),j("design:paramtypes",[Object,Array]),j("design:returntype",le)],Ki.prototype,"createDataChannels",null),ve([Uo,j("design:type",Function),j("design:paramtypes",[String,Array,String,Object]),j("design:returntype",le)],Ki.prototype,"receive",null),ve([Uo,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",le)],Ki.prototype,"batchReceive",null),ve([Uo,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",le)],Ki.prototype,"stopReceiving",null),ve([Uo,j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",le)],Ki.prototype,"muteRemote",null),ve([Uo,j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",le)],Ki.prototype,"unmuteRemote",null),ve([Uo,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",le)],Ki.prototype,"muteLocal",null),ve([Uo,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",le)],Ki.prototype,"unmuteLocal",null),ve([Uo,j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Ki.prototype,"close",null),ve([Uo,j("design:type",Function),j("design:paramtypes",[String,Vr]),j("design:returntype",le)],Ki.prototype,"updateEncoderConfig",null),ve([Uo,j("design:type",Function),j("design:paramtypes",[String,Vr]),j("design:returntype",le)],Ki.prototype,"updateSendParameters",null),ve([Uo,j("design:type",Function),j("design:paramtypes",[Vr,String]),j("design:returntype",le)],Ki.prototype,"replaceTrack",null),ve([Uo,j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",le)],Ki.prototype,"getRemoteSSRC",null);const C$=`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0
a=msid-semantic: WMS
a=ice-lite
m=application 9 UDP/DTLS/SCTP webrtc-datachannel
c=IN IP4 127.0.0.1
a=mid:0
`,lA="9",kU=2e4,LU=4e4;class Ede{get localCapabilities(){return Ai(this._localCapabilities)}get rtpCapabilities(){return Ai(this._rtpCapabilities)}get candidates(){return Ai(this._candidates)}get iceParameters(){return Ai(this._iceParameters)}get dtlsParameters(){return Ai(this._dtlsParameters)}constructor(i){O(this,"sessionDesc",void 0),O(this,"_localCapabilities",void 0),O(this,"_rtpCapabilities",void 0),O(this,"_candidates",void 0),O(this,"_iceParameters",void 0),O(this,"_dtlsParameters",void 0),O(this,"setup",void 0),O(this,"currentMidIndex",void 0),O(this,"cname",void 0),O(this,"firefoxSsrcMidMap",new Map),i=Ai(i);const{remoteIceParameters:s,remoteDtlsParameters:a,candidates:u,remoteRTPCapabilities:h,remoteSetup:p,localCapabilities:_,cname:v}=i,T=li.parse(C$);this._rtpCapabilities=h,this._candidates=u,this._iceParameters=s,this._dtlsParameters=a,this._localCapabilities=_,this.setup=p,this.cname=v;const b=this.rtpCapabilities.send;for(const C of T.mediaDescriptions){if(C.attributes.iceUfrag=s.iceUfrag,C.attributes.icePwd=s.icePwd,C.attributes.fingerprints=a.fingerprints,C.attributes.candidates=u,C.attributes.setup=p,C.media.mediaType==="application"&&(C.attributes.sctpPort="5000"),C.media.mediaType==="video"&&(C.media.fmts=b.videoCodecs.map(N=>N.payloadType.toString(10)),C.attributes.payloads=b.videoCodecs,C.attributes.extmaps=b.videoExtensions,te("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:N,ssrcGroups:x}=$a([{ssrcId:LU,rtx:te("USE_SUB_RTX")?40001:void 0}],this.cname);C.attributes.ssrcs=N,C.attributes.ssrcGroups=x}if(C.media.mediaType==="audio"&&(C.media.fmts=b.audioCodecs.map(N=>N.payloadType.toString(10)),C.attributes.payloads=b.audioCodecs,C.attributes.extmaps=b.audioExtensions,$h(C),te("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:N,ssrcGroups:x}=$a([{ssrcId:kU}],this.cname);C.attributes.ssrcs=N,C.attributes.ssrcGroups=x}}this.sessionDesc=T,this.currentMidIndex=T.mediaDescriptions.length-1}updateRemoteRTPCapabilities(i){const s=li.parse(C$);this._rtpCapabilities=i;const a=this.rtpCapabilities.send;for(const u of s.mediaDescriptions){if(u.attributes.iceUfrag=this._iceParameters.iceUfrag,u.attributes.icePwd=this._iceParameters.icePwd,u.attributes.fingerprints=this._dtlsParameters.fingerprints,u.attributes.candidates=this._candidates,u.attributes.setup=this.setup,u.media.mediaType==="application"&&(u.attributes.sctpPort="5000"),u.media.mediaType==="video"&&(u.media.fmts=a.videoCodecs.map(h=>h.payloadType.toString(10)),u.attributes.payloads=a.videoCodecs,u.attributes.extmaps=a.videoExtensions,te("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:h,ssrcGroups:p}=$a([{ssrcId:LU,rtx:te("USE_SUB_RTX")?40001:void 0}],this.cname);u.attributes.ssrcs=h,u.attributes.ssrcGroups=p}if(u.media.mediaType==="audio"&&(u.media.fmts=a.audioCodecs.map(h=>h.payloadType.toString(10)),u.attributes.payloads=a.audioCodecs,u.attributes.extmaps=a.audioExtensions,te("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:h,ssrcGroups:p}=$a([{ssrcId:kU}],this.cname);u.attributes.ssrcs=h,u.attributes.ssrcGroups=p}}this.sessionDesc=s,this.currentMidIndex=s.mediaDescriptions.length-1}preloadRemoteMedia(i){this.rtpCapabilities;const s=this.candidates,a=this.dtlsParameters,u=this.iceParameters,h=this.rtpCapabilities.send;for(let p=1;p<i;p++){const _=2*p+kU,v=2*p+LU,{ssrcs:T,ssrcGroups:b}=$a([{ssrcId:_}],this.cname),{ssrcs:C,ssrcGroups:N}=$a([{ssrcId:v,rtx:te("USE_SUB_RTX")?v+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:lA,protos:["UDP","TLS","RTP","SAVPF"],fmts:h.videoCodecs.map(x=>x.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:u.iceUfrag,icePwd:u.icePwd,unrecognized:[],candidates:s,extmaps:h.videoExtensions,fingerprints:a.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:C,ssrcGroups:N,rtcpFeedbackWildcards:[],payloads:h.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*p-1)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:lA,protos:["UDP","TLS","RTP","SAVPF"],fmts:h.audioCodecs.map(x=>x.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:u.iceUfrag,icePwd:u.icePwd,unrecognized:[],candidates:s,extmaps:h.audioExtensions,fingerprints:a.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:T,ssrcGroups:b,rtcpFeedbackWildcards:[],payloads:h.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*p)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return li.print(this.sessionDesc)}send(i,s,a,u){const{ssrcs:h,ssrcGroups:p}=$a(s,this.cname,te("SYNC_GROUP")?a:void 0),_=this.findPreloadMediaDesc(h);if(_){if(jn()&&this.firefoxSsrcMidMap.set(h[0].ssrcId,_.attributes.mid),u&&(u.twcc||u.remb)){const v=this.sessionDesc.mediaDescriptions.indexOf(_);return this.sessionDesc.mediaDescriptions[v]=this.mungSendMediaDesc(_,u),{mid:_.attributes.mid,needExchangeSDP:!0}}return{mid:_.attributes.mid,needExchangeSDP:!1}}{const v=this.findAvailableMediaIndex(i,h);let T;return v===-1||fs()||ps()||u8()||v===0&&te("USE_SUB_RTX")?(T=this.createOrRecycleSendMedia(i,h,p,"sendonly",u),this.updateBundleMids()):(T=Ai(this.sessionDesc.mediaDescriptions[v]),T.attributes.direction="sendonly",T.attributes.ssrcs=h,T.attributes.ssrcGroups=p,this.sessionDesc.mediaDescriptions[v]=this.mungSendMediaDesc(T,u)),jn()&&this.firefoxSsrcMidMap.set(h[0].ssrcId,T.attributes.mid),{mid:T.attributes.mid,needExchangeSDP:!0}}}batchSend(i){const s=i.map(h=>{let{kind:p,ssrcMsg:_,mslabel:v}=h;return this.send(p,_,v)}),a=[];let u=!1;return s.forEach(h=>{let{mid:p,needExchangeSDP:_}=h;_&&(u=!0),a.push(p)}),{mids:a,needExchangeSDP:u}}stopSending(i){const s=this.sessionDesc.mediaDescriptions.filter(a=>a.attributes.mid&&i.indexOf(a.attributes.mid)!==-1);if(s.length!==i.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");s.forEach(a=>{a.attributes.mid==="0"||jn()||fs()||ps()?a.attributes.ssrcs=[]:(a.attributes.ssrcs=[],a.attributes.direction="inactive",a.media.port="0")}),this.updateBundleMids()}mute(i){const s=this.sessionDesc.mediaDescriptions.find(a=>a.attributes.mid===i);if(!s)throw new Error("mediaDescription not found with ".concat(i," in remote SDP when calling RemoteSDP.mute."));s.attributes.direction="inactive"}unmute(i){const s=this.sessionDesc.mediaDescriptions.find(a=>a.attributes.mid===i);if(!s)throw new Error("mediaDescription not found with ".concat(i," in remote SDP when calling RemoteSDP.unmute."));s.attributes.direction="sendonly"}muteRemote(i){const s=this.sessionDesc.mediaDescriptions.filter(a=>ot(i).call(i,a.attributes.mid||""));if(s.length!==i.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");s.forEach(a=>{a.attributes.direction="inactive"})}unmuteRemote(i){const s=this.sessionDesc.mediaDescriptions.filter(a=>ot(i).call(i,a.attributes.mid||""));if(s.length!==i.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");s.forEach(a=>{a.attributes.direction="recvonly"})}receive(i,s,a,u){i.forEach((h,p)=>{this.createOrRecycleRecvMedia(h,[],"recvonly",s,a,u[p])}),this.updateBundleMids()}stopReceiving(i){const s=this.sessionDesc.mediaDescriptions.filter(a=>i.indexOf(a.attributes.mid)!==-1);if(s.length!==i.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");s.forEach(a=>{a.media.port="0",a.attributes.direction="inactive"}),this.updateBundleMids()}updateCandidates(i){i===Fr.TCP?this._candidates.forEach(s=>{this._candidates.findIndex(a=>a.transport==="tcp"&&a.connectionAddress===s.connectionAddress&&a.port===s.port)===-1&&this._candidates.push(w$(w$({},s),{},{foundation:"tcpcandidate",priority:Number(s.priority)-1+"",transport:"tcp",port:Number(s.port)+90+""}))}):this._candidates=this._candidates.filter(s=>s.transport!=="tcp");for(const s of this.sessionDesc.mediaDescriptions)s.attributes.candidates=this.candidates}restartICE(i){i=Ai(i),this._iceParameters=i,this.sessionDesc.mediaDescriptions.forEach(s=>{s.attributes.iceUfrag=i.iceUfrag,s.attributes.icePwd=i.icePwd})}predictReceivingMids(i){const s=[];for(let a=0;a<i;a++)s.push((this.currentMidIndex+a+1).toString(10));return s}findAvailableMediaIndex(i,s){return this.sessionDesc.mediaDescriptions.findIndex(a=>{const u=a.media.mediaType===i&&a.media.port!=="0"&&(a.attributes.direction==="sendonly"||a.attributes.direction==="sendrecv")&&a.attributes.ssrcs.length===0;if(jn()){if(u){const h=this.firefoxSsrcMidMap.get(s[0].ssrcId);return!(h||a.attributes.mid!=="0"&&a.attributes.mid!=="1")||!(!h||h!==a.attributes.mid)}return!1}return u})}createOrRecycleRecvMedia(i,s,a,u,h,p){const _=i._mediaStreamTrack.kind,v=this.rtpCapabilities.recv,T=aA(_,v,this.localCapabilities.send,_===Qe.VIDEO?u:h),b=_===Qe.VIDEO?v.videoExtensions:v.audioExtensions;this.currentMidIndex+=1;const C="".concat(this.currentMidIndex);let N={media:{mediaType:_,port:lA,protos:["UDP","TLS","RTP","SAVPF"],fmts:T.map(B=>B.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:b,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:s,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:T,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:a,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(C)}};N=this.mungRecvMediaDsec(N,i,p);const x=this.findFirstClosedMedia(_);if(x){const B=this.sessionDesc.mediaDescriptions.indexOf(x);this.sessionDesc.mediaDescriptions[B]=N}else this.sessionDesc.mediaDescriptions.push(N);return N}updateRemoteCodec(i,s,a){const u=[...new Set(this._rtpCapabilities.recv.videoCodecs.map(N=>N.rtpMap&&N.rtpMap.encodingName.toLowerCase()||"").filter(N=>{var x;return ot(x=Object.keys(Kp)).call(x,N)}))],h=new Set(s);if(u.every(N=>h.has(N)))return D.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(s)),!1;const p=this._rtpCapabilities.recv.videoCodecs.filter(N=>s.some(x=>{var B;return ot(B=N.rtpMap&&N.rtpMap.encodingName.toLowerCase()||"").call(B,x)}));if(p.length===0)return D.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(u," codecs: ").concat(s)),!1;const _=[...new Set(p.map(N=>N.rtpMap&&N.rtpMap.encodingName.toLowerCase()||""))];let v;if(D.debug("updateRemoteCodec, from ".concat(u," to ").concat(_)),i.length===0)v=this.sessionDesc.mediaDescriptions.filter(N=>N.media.mediaType==="video"&&N.attributes.direction==="recvonly");else if(v=this.sessionDesc.mediaDescriptions.filter(N=>N.attributes.mid&&ot(i).call(i,N.attributes.mid)&&N.attributes.direction==="recvonly"),v.length!==i.length)return D.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(i,", codecs: ").concat(s)),!1;this._rtpCapabilities.recv.videoCodecs=p;const T=this.localCapabilities.send,b=this.rtpCapabilities.recv,C=aA(Qe.VIDEO,b,T,a);return v.forEach(N=>{const x=C.map(B=>B.payloadType.toString(10));D.debug("updateRemoteCodec mid: ".concat(N.attributes.mid,", from ").concat(N.attributes.payloads," to ").concat(C)),N.attributes.payloads=C,N.media.fmts=x}),!0}createOrRecycleSendMedia(i,s,a,u,h){const p=this.rtpCapabilities.send,_=i===Qe.VIDEO?p.videoCodecs:p.audioCodecs,v=i===Qe.VIDEO?p.videoExtensions:p.audioExtensions;this.currentMidIndex+=1;const T="".concat(this.currentMidIndex);let b={media:{mediaType:i,port:lA,protos:["UDP","TLS","RTP","SAVPF"],fmts:_.map(N=>N.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:v,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:s,ssrcGroups:a,rtcpFeedbackWildcards:[],payloads:_,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:u,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(T)}};b=this.mungSendMediaDesc(b,h);const C=this.findFirstClosedMedia(i);if(C){const N=this.sessionDesc.mediaDescriptions.indexOf(C);this.sessionDesc.mediaDescriptions[N]=b}else this.sessionDesc.mediaDescriptions.push(b);return b}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(i=>i.media.port!=="0").map(i=>i.attributes.mid)}mungRecvMediaDsec(i,s,a){const u=Ai(i);return AU(u),cm(u,s),OU(u,s),r$(u),iA(u,a,this.localCapabilities.send),u}mungSendMediaDesc(i,s){const a=Ai(i);return iA(a,s,this.localCapabilities.recv),$h(a),a}updateRecvMedia(i,s){const a=this.sessionDesc.mediaDescriptions.findIndex(u=>u.attributes.mid===i);if(a!==-1){const u=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[a],s);this.sessionDesc.mediaDescriptions[a]=u}}bumpMid(i){this.currentMidIndex+=i}findFirstClosedMedia(i){return this.sessionDesc.mediaDescriptions.find(s=>jn()?s.media.port==="0"&&s.media.mediaType===i:s.media.port==="0")}findPreloadMediaDesc(i){return this.sessionDesc.mediaDescriptions.find(s=>{var a;return((a=s.attributes)===null||a===void 0||(a=a.ssrcs[0])===null||a===void 0?void 0:a.ssrcId)===i[0].ssrcId})}getSSRC(i){var s;return(s=this.sessionDesc.mediaDescriptions.find(a=>a.attributes.mid===i))===null||s===void 0?void 0:s.attributes.ssrcs}}function R$(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function uA(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?R$(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):R$(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}class Hr extends SI{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}constructor(i,s,a){super(i,s),O(this,"store",void 0),O(this,"peerConnection",void 0),O(this,"remoteSDP",void 0),O(this,"initialOffer",void 0),O(this,"transportEventReceiver",void 0),O(this,"statsFilter",void 0),O(this,"useXR",te("USE_XR")),O(this,"localCapabilities",void 0),O(this,"localCandidateCount",0),O(this,"allCandidatesReceived",!1),O(this,"remoteCodecs",void 0),O(this,"dataStreamChannelMap",new Map),O(this,"establishPromise",void 0),O(this,"mutex",new fr("NVExtentionsConnection-mutex")),O(this,"rtcMedia",void 0),this.store=s,this.peerConnection=a,this.statsFilter=cA(this.peerConnection,te("STATS_UPDATE_INTERVAL"),void 0,jn()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(i){try{const s=await this.peerConnection.createOffer();if(!s.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const a=am(s.sdp),u=await s$({filterRTX:!te("USE_PUB_RTX")&&!te("USE_SUB_RTX"),filterVideoFec:te("FILTER_VIDEO_FEC"),filterAudioFec:te("FILTER_AUDIO_FEC"),filterVideoCodec:te("FILTER_VIDEO_CODEC")},{useXR:this.useXR});return this.localCapabilities=u,this.initialOffer=s,uA(uA({},a),{},{rtpCapabilities:u,offerSDP:s.sdp})}catch(s){throw new ae(z.GET_LOCAL_CONNECTION_PARAMS_FAILED,s.toString())}}async connect(i,s,a,u,h,p){try{if(!this.initialOffer)throw new Error("Cannot establish NVConnection without initial offer.");this.remoteSDP=new Ede({remoteIceParameters:i,remoteDtlsParameters:s,candidates:a,remoteRTPCapabilities:u,remoteSetup:h,localCapabilities:sA(this.localCapabilities),cname:p});const _=this.remoteSDP.toString(),v=li.parse(this.initialOffer.sdp),T=v.mediaDescriptions.find(N=>N.media.mediaType==="audio");T&&$h(T),this.useXR&&oA(v);const b=li.print(v),C=this.logSDPExchange(b||"","offer","local","connect");await this.peerConnection.setLocalDescription({type:"offer",sdp:b}),C==null||C(_),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_})}catch(_){throw new ae(z.EXCHANGE_SDP_FAILED,"NV.connect failed; ".concat(_.toString()))}}async updateRemoteRTPCapabilities(i,s){let a;this.remoteCodecs=s,this.localCapabilities&&(a=sA(this.localCapabilities));const u=[...new Set(a&&a.send.videoCodecs.map(h=>h.rtpMap&&h.rtpMap.encodingName.toLowerCase()||"").filter(h=>{var p;return ot(p=Object.keys(Kp)).call(p,h)}))];if(it.updateRemoteRTPCapabilities(this.store.sessionId,{mids:i,localCodecs:u,remoteCodecs:this.remoteCodecs}),!this.remoteSDP)return void D.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(u,", codecs: ").concat(s));if(this.remoteSDP.updateRemoteCodec(i,s,this.store.codec)){const h=await this.peerConnection.createOffer(),p=this.logSDPExchange(h.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(h);const _=this.remoteSDP.toString();p==null||p(_),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_})}else D.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.")}async updateRemoteConnect(i){var s,a,u,h;(s=this.remoteSDP)===null||s===void 0||s.updateRemoteRTPCapabilities(i),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&((h=this.remoteSDP)===null||h===void 0||h.updateRemoteCodec([],this.remoteCodecs,this.store.codec)),(a=this.remoteSDP)===null||a===void 0||a.preloadRemoteMedia(2);const p=(u=this.remoteSDP)===null||u===void 0?void 0:u.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:p});const _=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(_),D.debug("[NVExtentionsConnection] updateRemoteRTPCapabilities by exchanging SDP.")}send(i,s,a){var u=this;return Ha(function*(){const h=yield en(u.mutex.lock("From NVExtentionsConnection.send"));try{if(!u.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.send before remote SDP created");const p=[];i.forEach(F=>{const H=u.peerConnection.addTransceiver(F._mediaStreamTrack,{direction:"sendonly"});p.push(H)}),jn()&&te("SIMULCAST")===!0&&(yield en(u.applySimulcastForFirefox(p,i)));const _=yield en(u.peerConnection.createOffer()),v=u.remoteSDP.predictReceivingMids(i.length),T=u.mungSendOfferSDP(_.sdp,i,v),b=li.parse(T),C=v.map(F=>{const H=b.mediaDescriptions.find(J=>J.attributes.mid===F);if(!H)throw new Error("Cannot extract ssrc from mediaDescription.");return n$(H,te("USE_PUB_RTX"))});let N;try{N=yield C}catch(F){N=[],u.remoteSDP.receive(i,s,a,N);const H=u.remoteSDP.toString();throw yield en(u.peerConnection.setLocalDescription({type:"offer",sdp:T})),yield en(u.peerConnection.setRemoteDescription({type:"answer",sdp:H})),yield en(u.stopSending(v,!0)),F}u.remoteSDP.receive(i,s,a,N);const x=u.remoteSDP.toString(),B=u.logSDPExchange(T,"offer","local","send");return yield en(u.peerConnection.setLocalDescription({type:"offer",sdp:T})),yield en(u.applySimulcastEncodings(p,i)),yield en(u.applySendEncodings(p,i)),B==null||B(x),yield en(u.peerConnection.setRemoteDescription({type:"answer",sdp:x})),p.map((F,H)=>{const J=v[H];return{localSSRC:C[H],id:J,transceiver:F}})}catch(p){throw p instanceof ae?p:new ae(z.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.send failed; ".concat(p.toString()))}finally{h()}})()}async stopSending(i,s){const a=s?void 0:await this.mutex.lock("From NVExtentionsConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.stopSending before remote SDP created");const u=this.peerConnection.getTransceivers().filter(v=>i.indexOf(v.mid)!==-1);if(u.length!==i.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call NVExtentionsConnection.stopSending.");u.map(v=>{var T;v.direction="inactive",(T=v.stop)===null||T===void 0||T.call(v)});const h=await this.peerConnection.createOffer(),p=this.logSDPExchange(h.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(h),this.remoteSDP.stopReceiving(i);const _=this.remoteSDP.toString();p==null||p(_),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_})}catch(u){throw new ae(z.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.stopSending failed; ".concat(u.toString()))}finally{a&&a()}}async createDataChannels(i,s){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.createDataChannels before remote SDP created");let a=this.dataStreamChannelMap.get(i);return a&&a.readyState==="open"?D.debug("[P2PConnection] Channels are already available and can be reused directly."):(a=this.peerConnection.createDataChannel("datastream-channel",{ordered:!1,maxRetransmits:te("DATASTREAM_MAX_RETRANSMITS")}),a.binaryType="arraybuffer",this.dataStreamChannelMap.set(i,a)),void s.forEach(u=>{u._updateOriginDataChannel(a)})}catch(a){throw a instanceof ae?a:new ae(z.DATACHANNEL_FAILED,"NVExtentionsConnection.createDataChannels failed; ".concat(a.toString()))}}async stopDataChannels(i){try{const s=this.dataStreamChannelMap.get(i);return s==null||s.close(),void this.dataStreamChannelMap.delete(i)}catch(s){throw s instanceof ae?s:new ae(z.DATACHANNEL_FAILED,"NVExtentionsConnection.stopDataChannels failed; ".concat(s.toString()))}}async receive(i,s,a,u){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.receive ".concat(i," before remoteSDP created."));const{mid:h,needExchangeSDP:p}=this.remoteSDP.send(i,s,a,u);if(p){const v=this.remoteSDP.toString(),T=this.logSDPExchange(v,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:v});const b=await this.peerConnection.createAnswer(),C=this.mungReceiveAnswerSDP(b.sdp,h,i);T==null||T(C||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:C}),D.debug("[NVExtentionsConnection] receive ".concat(i," by exchanging SDP."))}else D.debug("[NVExtentionsConnection] receive ".concat(i," no need to exchange SDP."));const _=this.peerConnection.getTransceivers().find(v=>v.mid===h);if(!_)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:_.receiver.track,id:h}}catch(h){throw new ae(z.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.receive failed; ".concat(h.toString()))}}async batchReceive(i){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.batchReceive before remoteSDP created.");const{mids:s,needExchangeSDP:a}=this.remoteSDP.batchSend(i);if(a){const u=this.remoteSDP.toString(),h=this.logSDPExchange(u,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:u});const p=await this.peerConnection.createAnswer();h==null||h(p.sdp||""),await this.peerConnection.setLocalDescription(p),D.debug("[NVExtentionsConnection] batchReceive by exchanging SDP.")}else D.debug("[NVExtentionsConnection] batchReceive no need to exchange SDP.");return s.map(u=>{const h=this.peerConnection.getTransceivers().find(p=>p.mid===u);if(!h)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:h.receiver.track,id:u}})}catch(s){throw new ae(z.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.receive failed; ".concat(s.toString()))}}async stopReceiving(i){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(i);const s=this.remoteSDP.toString(),a=this.logSDPExchange(s,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const u=await this.peerConnection.createAnswer();a==null||a(u.sdp||""),await this.peerConnection.setLocalDescription(u)}catch(s){throw new ae(z.EXCHANGE_SDP_FAILED,"NVExtentionsConnection stopReceiving failed; ".concat(s.toString()))}}async muteRemote(i){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.muteRemote mid=".concat(i," before remote SDP created."));this.remoteSDP.mute(i);const s=this.remoteSDP.toString(),a=this.logSDPExchange(s,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const u=await this.peerConnection.createAnswer();a==null||a(u.sdp||""),await this.peerConnection.setLocalDescription(u)}catch(s){throw new ae(z.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.muteRemote failed; ".concat(s.toString()))}}async unmuteRemote(i){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.unmuteRemote mid=".concat(i," before remote SDP created."));this.remoteSDP.unmute(i);const s=this.remoteSDP.toString(),a=this.logSDPExchange(s,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const u=await this.peerConnection.createAnswer();a==null||a(u.sdp||""),await this.peerConnection.setLocalDescription(u)}catch(s){throw new ae(z.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.unmuteRemote failed; ".concat(s.toString()))}}async muteLocal(i){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.muteLocal before remote SDP created.");const s=this.peerConnection.getTransceivers().filter(p=>p.mid&&i.indexOf(p.mid)!==-1);if(s.length!==i.length)throw new Error("Transceivers' length doesn't match mids' length.");s.map(p=>{p.direction="inactive"});const a=await this.peerConnection.createOffer(),u=this.logSDPExchange(a.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(a),this.remoteSDP.muteRemote(i);const h=this.remoteSDP.toString();u==null||u(h),await this.peerConnection.setRemoteDescription({type:"answer",sdp:h})}catch(s){throw new ae(z.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.muteLocal failed; ".concat(s.toString()))}}async unmuteLocal(i){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.unmuteLocal before remote SDP created.");const s=this.peerConnection.getTransceivers().filter(p=>p.mid&&i.indexOf(p.mid)!==-1);if(s.length!==i.length)throw new Error("Transceivers' length doesn't match mids' length.");s.map(async(p,_)=>{p.direction="sendonly"});const a=await this.peerConnection.createOffer(),u=this.logSDPExchange(a.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(a),this.remoteSDP.unmuteRemote(i);const h=this.remoteSDP.toString();u==null||u(h),await this.peerConnection.setRemoteDescription({type:"answer",sdp:h})}catch(s){throw new ae(z.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.unmuteLocal failed; ".concat(s.toString()))}}restartICE(i){var s=this;return Ha(function*(){const a=yield en(s.mutex.lock("From NVExtentionsConnection.restartICE"));try{if(!s.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(In().supportPCSetConfiguration){const T=s.peerConnection.getConfiguration(),b=i===Fr.RELAY?"relay":"all";T.iceTransportPolicy!==b&&(D.debug("restartICE change iceTransportPolicy from [".concat(T.iceTransportPolicy,"] to [").concat(b,"]")),T.iceTransportPolicy=b,s.peerConnection.setConfiguration(T))}else if(i===Fr.RELAY)return;i!==Fr.RELAY&&s.remoteSDP.updateCandidates(i);const u=yield en(s.peerConnection.createOffer({iceRestart:!0}));if(!u.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const h=am(u.sdp),{remoteIceParameters:p}=yield h.iceParameters;s.remoteSDP.restartICE(p);const _=s.remoteSDP.toString(),v=s.logSDPExchange(u.sdp||"","offer","local","restartICE");yield en(s.peerConnection.setLocalDescription(u)),v==null||v(_),yield en(s.peerConnection.setRemoteDescription({type:"answer",sdp:_}))}catch(u){D.warning("restart ICE failed, abort operation",u)}finally{a()}})()}close(){var i;(i=this.onConnectionStateChange)===null||i===void 0||i.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(i){return this.statsFilter.getVideoIsReady(i)}async updateEncoderConfig(i,s){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.updateEncoderConfig before remote SDP created.");const a=await this.peerConnection.createOffer(),u=this.mungSendOfferSDP(a.sdp,[s],[i]);this.remoteSDP.updateRecvMedia(i,s);const h=this.remoteSDP.toString(),p=this.logSDPExchange(u,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:u}),p==null||p(h),await this.peerConnection.setRemoteDescription({type:"answer",sdp:h})}catch(a){throw new ae(z.EXCHANGE_SDP_FAILED,a.toString())}}async updateSendParameters(i,s){const a=this.peerConnection.getTransceivers().filter(u=>u.mid===i);a.length===1&&(this.isVP8Simulcast(s)?jn()||await this.applySimulcastEncodings(a,[s]):await this.applySendEncodings(a,[s]))}setStatsRemoteVideoIsReady(i,s){this.statsFilter.setVideoIsReady2(i,s)}async replaceTrack(i,s){const a=this.peerConnection.getTransceivers().find(u=>u.mid===s);a&&await a.sender.replaceTrack(i._mediaStreamTrack)}getP2PConnectionParams(){var i;if((i=this.peerConnection.currentLocalDescription)===null||i===void 0||!i.sdp||!this.localCapabilities)throw new Error;return uA(uA({},am(this.peerConnection.currentLocalDescription.sdp)),{},{rtpCapabilities:this.localCapabilities})}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var i;(i=this.onICEConnectionStateChange)===null||i===void 0||i.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var i;(i=this.onConnectionStateChange)===null||i===void 0||i.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=i=>{i.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,D.debug("[pc-".concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,D.debug("[pc-".concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},te("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(i){const s={iceServers:[]};return i.iceServers?s.iceServers=i.iceServers:i.turnServer&&i.turnServer.mode!=="off"&&(V_(i.turnServer.servers)?s.iceServers=i.turnServer.servers:(s.iceServers&&s.iceServers.push(...Hr.turnServerConfigToIceServers(i.turnServer.servers)),te("USE_TURN_SERVER_OF_GATEWAY")&&s.iceServers&&i.turnServer.serversFromGateway&&s.iceServers.push(...Hr.turnServerConfigToIceServers(i.turnServer.serversFromGateway)),te("FORCE_TURN_TCP")?s.iceTransportPolicy="relay":i.turnServer.servers.concat(i.turnServer.serversFromGateway||[]).forEach(a=>{a.forceturn&&(s.iceTransportPolicy="relay")}))),s}static turnServerConfigToIceServers(i){const s=[];return i.forEach(a=>{a.security?a.tcpport&&s.push({username:a.username,credential:a.password,credentialType:"password",urls:"turns:".concat(gS(a.turnServerURL),":").concat(a.tcpport,"?transport=tcp")}):(a.udpport&&!te("FORCE_TURN_TCP")&&s.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.udpport,"?transport=udp")}),a.tcpport&&s.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.tcpport,"?transport=tcp")}))}),s}async applySendEncodings(i,s){try{if(!In().supportSetRtpSenderParameters||i.length!==s.length)return;for(let C=0;C<i.length;C++){const N=i[C],x=s[C];if(x&&x instanceof Ct){var a,u,h;if(this.isVP8Simulcast(x))continue;const B={},F={};switch(x._optimizationMode){case"motion":B.degradationPreference="maintain-framerate";break;case"detail":B.degradationPreference="maintain-resolution";break;default:B.degradationPreference="balanced"}var p,_,v,T;if((a=x._encoderConfig)!==null&&a!==void 0&&a.bitrateMax&&(F.maxBitrate=1e3*((p=x._encoderConfig)===null||p===void 0?void 0:p.bitrateMax)),ot(u=x._hints).call(u,Ln.LOW_STREAM)&&((_=x._encoderConfig)!==null&&_!==void 0&&_.frameRate&&(F.maxFramerate=pa(x._encoderConfig.frameRate)),(v=x._encoderConfig)!==null&&v!==void 0&&v.scaleResolutionDownBy&&((T=x._encoderConfig)===null||T===void 0?void 0:T.scaleResolutionDownBy)>1&&(F.scaleResolutionDownBy=x._encoderConfig.scaleResolutionDownBy)),te("DSCP_TYPE")&&Ih()){var b;const ee=te("DSCP_TYPE");ot(b=["very-low","low","medium","high"]).call(b,ee)&&(F.networkPriority=ee)}const H=N.sender.getParameters(),J=(h=H.encodings)===null||h===void 0?void 0:h[0];jn()&&!J&&(B.encodings=[F]),J&&Object.assign(J,F),Object.assign(H,B),await N.sender.setParameters(H)}}}catch{D.debug("Apply RTPSendEncodings failed.")}}mungSendOfferSDP(i,s,a){const u=li.parse(i);return s.forEach((h,p)=>{const _=a[p],v=u.mediaDescriptions.find(T=>T.attributes.mid===_);v&&(cm(v,h),NU(v,h,this.store.codec))}),li.print(u)}mungReceiveAnswerSDP(i,s,a){const u=li.parse(i),h=u.mediaDescriptions.find(p=>p.attributes.mid===s);return h&&a===Qe.AUDIO&&h.media.mediaType==="audio"&&$h(h),this.useXR&&oA(u),li.print(u)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=i=>{var s;(s=this.onFirstAudioReceived)===null||s===void 0||s.call(this,i)},this.statsFilter.onFirstVideoReceived=i=>{var s;(s=this.onFirstVideoReceived)===null||s===void 0||s.call(this,i)},this.statsFilter.onFirstAudioDecoded=i=>{var s;(s=this.onFirstAudioDecoded)===null||s===void 0||s.call(this,i)},this.statsFilter.onFirstVideoDecoded=(i,s,a)=>{var u;(u=this.onFirstVideoDecoded)===null||u===void 0||u.call(this,i,s,a)},this.statsFilter.onSelectedLocalCandidateChanged=(i,s)=>{var a;(a=this.onSelectedLocalCandidateChanged)===null||a===void 0||a.call(this,i,s)},this.statsFilter.onSelectedRemoteCandidateChanged=(i,s)=>{var a;(a=this.onSelectedRemoteCandidateChanged)===null||a===void 0||a.call(this,i,s)},this.statsFilter.onFirstVideoDecodedTimeout=i=>{var s;(s=this.onFirstVideoDecodedTimeout)===null||s===void 0||s.call(this,i)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(i,s){if(i.length===s.length)for(let v=0;v<i.length;v++){var a,u,h,p,_;const T=i[v],b=s[v];if(b instanceof Ct&&!ot(a=b._hints).call(a,Ln.LOW_STREAM)&&(u=b._encoderConfig)!==null&&u!==void 0&&u.bitrateMax&&((h=b._encoderConfig)===null||h===void 0?void 0:h.bitrateMax)>200&&(p=b._scalabilityMode)!==null&&p!==void 0&&p.numSpatialLayers&&((_=b._scalabilityMode)===null||_===void 0?void 0:_.numSpatialLayers)>1&&this.store.codec==="vp8"){const C={},N={high:1e3*(b._encoderConfig.bitrateMax-50),medium:5e4};C.encodings=[{rid:"m",active:!0,maxBitrate:N.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:N.high}];const x=T.sender.getParameters();await T.sender.setParameters(Object.assign(x,C))}}}async applySimulcastEncodings(i,s){if(!jn()&&i.length===s.length)for(let a=0;a<i.length;a++){const u=s[a];if(u instanceof Ct&&this.isVP8Simulcast(u)){const h=i[a],p={},_={high:1e3*(u._encoderConfig.bitrateMax-50),medium:5e4};p.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:_.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:_.medium,scaleResolutionDownBy:4}];const v=h.sender.getParameters();await h.sender.setParameters(Object.assign(v,p))}}}isVP8Simulcast(i){var s,a,u,h,p;return!!(i instanceof Ct&&te("SIMULCAST")&&this.store.codec==="vp8"&&!ot(s=i._hints).call(s,Ln.LOW_STREAM)&&(a=i._encoderConfig)!==null&&a!==void 0&&a.bitrateMax&&((u=i._encoderConfig)===null||u===void 0?void 0:u.bitrateMax)>200&&(h=i._scalabilityMode)!==null&&h!==void 0&&h.numSpatialLayers&&((p=i._scalabilityMode)===null||p===void 0?void 0:p.numSpatialLayers)>1)}logSDPExchange(i,s,a,u){if(te("SDP_LOGGING"))return D.upload("exchanging ".concat(a," ").concat(s," SDP during NVExtentionsConnection.").concat(u,`
`),i),s==="offer"?h=>{this.logSDPExchange(h,"answer",a==="local"?"remote":"local",u)}:void 0}async getRemoteSSRC(i){if(!this.remoteSDP)return;const s=this.remoteSDP.getSSRC(i);return s==null?void 0:s[0].ssrcId}setConfiguration(i){if(In().supportPCSetConfiguration){const s=Hr.resolvePCConfiguration(i);this.peerConnection.setConfiguration(s)}}}function fo(o,i,s){const a=o[i];if(typeof a!="function")throw new Error("Cannot use mutex on object property.");return s.value=async function(){const u=this.mutex,h=await u.lock("From NVExtentionsConnection.".concat(i));try{for(var p=arguments.length,_=new Array(p),v=0;v<p;v++)_[v]=arguments[v];return await a.apply(this,_)}finally{h()}},s}function I$(o){var i,s,a,u=2;for(typeof Symbol<"u"&&(s=QH,a=Symbol.iterator);u--;){if(s&&(i=o[s])!=null)return i.call(o);if(a&&(i=o[a])!=null)return new dA(i.call(o));s="@@asyncIterator",a="@@iterator"}throw new TypeError("Object is not async iterable")}function dA(o){function i(s){if(Object(s)!==s)return le.reject(new TypeError(s+" is not an object."));var a=s.done;return le.resolve(s.value).then(function(u){return{value:u,done:a}})}return dA=function(s){this.s=s,this.n=s.next},dA.prototype={s:null,n:null,next:function(){return i(this.n.apply(this.s,arguments))},return:function(s){var a=this.s.return;return a===void 0?le.resolve({value:s,done:!0}):i(a.apply(this.s,arguments))},throw:function(s){var a=this.s.return;return a===void 0?le.reject(s):i(a.apply(this.s,arguments))}},new dA(o)}ve([fo,j("design:type",Function),j("design:paramtypes",[Object,Object,Array,Object,String,String]),j("design:returntype",le)],Hr.prototype,"connect",null),ve([fo,j("design:type",Function),j("design:paramtypes",[Array,Array]),j("design:returntype",le)],Hr.prototype,"updateRemoteRTPCapabilities",null),ve([fo,j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",le)],Hr.prototype,"updateRemoteConnect",null),ve([fo,j("design:type",Function),j("design:paramtypes",[Object,Array]),j("design:returntype",le)],Hr.prototype,"createDataChannels",null),ve([fo,j("design:type",Function),j("design:paramtypes",[String,Array,String,Object]),j("design:returntype",le)],Hr.prototype,"receive",null),ve([fo,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",le)],Hr.prototype,"batchReceive",null),ve([fo,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",le)],Hr.prototype,"stopReceiving",null),ve([fo,j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",le)],Hr.prototype,"muteRemote",null),ve([fo,j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",le)],Hr.prototype,"unmuteRemote",null),ve([fo,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",le)],Hr.prototype,"muteLocal",null),ve([fo,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",le)],Hr.prototype,"unmuteLocal",null),ve([fo,j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Hr.prototype,"close",null),ve([fo,j("design:type",Function),j("design:paramtypes",[String,Vr]),j("design:returntype",le)],Hr.prototype,"updateEncoderConfig",null),ve([fo,j("design:type",Function),j("design:paramtypes",[String,Vr]),j("design:returntype",le)],Hr.prototype,"updateSendParameters",null),ve([fo,j("design:type",Function),j("design:paramtypes",[Vr,String]),j("design:returntype",le)],Hr.prototype,"replaceTrack",null),ve([fo,j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",le)],Hr.prototype,"getRemoteSSRC",null);class qi extends SI{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}constructor(i,s){super(i,s),O(this,"store",void 0),O(this,"peerConnection",void 0),O(this,"cname",void 0),O(this,"mutex",new fr("DataChannelConnection-mutex")),O(this,"dataChannel",void 0),O(this,"_p2pConnection",void 0),O(this,"establishPromise",void 0),O(this,"_nvMedia",void 0),this.store=s,this.store.dcId=this.store.dcId+1,this.peerConnection=new RTCPeerConnection(qi.resolvePCConfiguration(i),{optional:[{googDscp:!0}]}),this.dataChannel=this.peerConnection.createDataChannel("agora-signal",{ordered:!1,maxPacketLifeTime:50}),this.dataChannel.binaryType="arraybuffer",this._p2pConnection=new Hr(i,s,this.peerConnection),this.bindPCEvents(),this.establishPromise=this._p2pConnection.establishPromise}async establish(){var i;const s=(i=this._nvMedia)===null||i===void 0?void 0:i.getLocalRtpCapabilities();return await this._p2pConnection.establish(s)}getP2PConnectionParams(){return this._p2pConnection.getP2PConnectionParams()}async connect(i,s,a,u,h,p){return this.cname=p,await this._p2pConnection.connect(i,s,a,u,h,p),await new le((_,v)=>{const T=setTimeout(()=>{this.closeSignal(),v(new ae(z.DATACHANNEL_CONNECTION_TIMEOUT,"Datachannel connection timed out, candidates: ".concat(JSON.stringify(a))))},2e3);this.dataChannel.onopen=()=>{if(this.dataChannel.readyState==="open")return clearTimeout(T),void _()},this.dataChannel.onerror=b=>{this.closeSignal(),v(b)}}),{transmitter:this.dataChannel,close:this.closeSignal.bind(this)}}async updateRemoteRTPCapabilities(i,s){return this._p2pConnection.updateRemoteRTPCapabilities(i,s)}send(i,s,a){var u=this;return Ha(function*(){const h=yield en(u.mutex.lock("From DataChannelConnection.send"));try{return yield*nA(I$(u._p2pConnection.send(i,s,a)))}finally{h()}})()}async stopSending(i,s){return this._p2pConnection.stopSending(i,s)}async createDataChannels(i,s){return this._p2pConnection.createDataChannels(i,s)}async stopDataChannels(i){return this._p2pConnection.stopDataChannels(i)}async receive(i,s,a,u){return this._nvMedia?(D.debug("[DataChannelConnection] receive ".concat(i," by DataChannel.")),await this._nvMedia.reveiveByRTCMedia(i,s,this.cname)):(D.debug("[DataChannelConnection] receive ".concat(i," by WebRTC.")),await this._p2pConnection.receive(i,s,a,u))}async batchReceive(i){return[...await this._p2pConnection.batchReceive(i)]}async stopReceiving(i){return await this._p2pConnection.stopReceiving(i)}async muteRemote(i){return await this._p2pConnection.muteRemote(i)}async unmuteRemote(i){return await this._p2pConnection.unmuteRemote(i)}async muteLocal(i){return await this._p2pConnection.muteLocal(i)}async unmuteLocal(i){return await this._p2pConnection.unmuteLocal(i)}restartICE(i){var s=this;return Ha(function*(){return yield*nA(I$(s._p2pConnection.restartICE(i)))})()}close(){var i;(i=this._nvMedia)===null||i===void 0||i.close(),this._p2pConnection.close(),this.unbindConnectionEvents(this._p2pConnection)}getStats(){return this._p2pConnection.getStats()}getRemoteVideoIsReady(i){return this._p2pConnection.getRemoteVideoIsReady(i)}updateRemoteConnect(i){var s;(s=this._nvMedia)===null||s===void 0||s.setRemoteRtpCapabilities(i),this._p2pConnection.updateRemoteConnect(i)}async updateEncoderConfig(i,s){return await this._p2pConnection.updateEncoderConfig(i,s)}async updateSendParameters(i,s){return await this._p2pConnection.updateSendParameters(i,s)}setStatsRemoteVideoIsReady(i,s){this._p2pConnection.setStatsRemoteVideoIsReady(i,s)}async replaceTrack(i,s){return await this._p2pConnection.replaceTrack(i,s)}async getRemoteSSRC(i){return this._p2pConnection.getRemoteSSRC(i)}logSDPExchange(i,s,a,u){if(te("SDP_LOGGING"))return D.upload("exchanging ".concat(a," ").concat(s," SDP during DataChannelConnection.").concat(u,`
`),i),s==="offer"?h=>{this.logSDPExchange(h,"answer",a==="local"?"remote":"local",u)}:void 0}static resolvePCConfiguration(i){const s={iceServers:[]};return i.iceServers?s.iceServers=i.iceServers:i.turnServer&&i.turnServer.mode!=="off"&&(V_(i.turnServer.servers)?s.iceServers=i.turnServer.servers:(s.iceServers&&s.iceServers.push(...qi.turnServerConfigToIceServers(i.turnServer.servers)),te("USE_TURN_SERVER_OF_GATEWAY")&&s.iceServers&&i.turnServer.serversFromGateway&&s.iceServers.push(...qi.turnServerConfigToIceServers(i.turnServer.serversFromGateway)),te("FORCE_TURN_TCP")?s.iceTransportPolicy="relay":i.turnServer.servers.concat(i.turnServer.serversFromGateway||[]).forEach(a=>{a.forceturn&&(s.iceTransportPolicy="relay")}))),s}static turnServerConfigToIceServers(i){const s=[];return i.forEach(a=>{a.security?a.tcpport&&s.push({username:a.username,credential:a.password,credentialType:"password",urls:"turns:".concat(gS(a.turnServerURL),":").concat(a.tcpport,"?transport=tcp")}):(a.udpport&&!te("FORCE_TURN_TCP")&&s.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.udpport,"?transport=udp")}),a.tcpport&&s.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.tcpport,"?transport=tcp")}))}),s}bindPCEvents(){this._p2pConnection.onICEConnectionStateChange=i=>{var s;return(s=this.onICEConnectionStateChange)===null||s===void 0?void 0:s.call(this,i)},this._p2pConnection.onConnectionStateChange=i=>{var s;return(s=this.onConnectionStateChange)===null||s===void 0?void 0:s.call(this,i)},this._p2pConnection.onDTLSTransportStateChange=i=>{var s;return(s=this.onDTLSTransportStateChange)===null||s===void 0?void 0:s.call(this,i)},this._p2pConnection.onDTLSTransportError=i=>{var s;return(s=this.onDTLSTransportError)===null||s===void 0?void 0:s.call(this,i)},this._p2pConnection.onICETransportStateChange=i=>{var s;return(s=this.onICETransportStateChange)===null||s===void 0?void 0:s.call(this,i)},this._p2pConnection.onFirstAudioReceived=i=>{var s;return(s=this.onFirstAudioReceived)===null||s===void 0?void 0:s.call(this,i)},this._p2pConnection.onFirstVideoReceived=i=>{var s;return(s=this.onFirstVideoReceived)===null||s===void 0?void 0:s.call(this,i)},this._p2pConnection.onFirstAudioDecoded=i=>{var s;return(s=this.onFirstAudioDecoded)===null||s===void 0?void 0:s.call(this,i)},this._p2pConnection.onFirstVideoDecoded=(i,s,a)=>{var u;return(u=this.onFirstVideoDecoded)===null||u===void 0?void 0:u.call(this,i,s,a)},this._p2pConnection.onFirstVideoDecodedTimeout=i=>{var s;return(s=this.onFirstVideoDecodedTimeout)===null||s===void 0?void 0:s.call(this,i)},this._p2pConnection.onSelectedLocalCandidateChanged=(i,s)=>{var a;return(a=this.onSelectedLocalCandidateChanged)===null||a===void 0?void 0:a.call(this,i,s)},this._p2pConnection.onSelectedRemoteCandidateChanged=(i,s)=>{var a;return(a=this.onSelectedRemoteCandidateChanged)===null||a===void 0?void 0:a.call(this,i,s)}}closeSignal(){this.dataChannel.close(),this.peerConnection.close()}unbindConnectionEvents(i){i.onConnectionStateChange=void 0,i.onICEConnectionStateChange=void 0,i.onICETransportStateChange=void 0,i.onDTLSTransportStateChange=void 0,i.onDTLSTransportError=void 0,i.onFirstAudioDecoded=void 0,i.onFirstAudioReceived=void 0,i.onFirstVideoDecoded=void 0,i.onFirstVideoReceived=void 0,i.onSelectedLocalCandidateChanged=void 0,i.onSelectedRemoteCandidateChanged=void 0,i.onFirstVideoDecodedTimeout=void 0}setConfiguration(i){this._p2pConnection.setConfiguration(i)}}function ma(o,i,s){const a=o[i];if(typeof a!="function")throw new Error("Cannot use mutex on object property.");return s.value=async function(){const u=this.mutex,h=await u.lock("From DataChannelConnection.".concat(i));try{for(var p=arguments.length,_=new Array(p),v=0;v<p;v++)_[v]=arguments[v];return await a.apply(this,_)}finally{h()}},s}function A$(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function O$(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?A$(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):A$(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}ve([ma,j("design:type",Function),j("design:paramtypes",[Object,Object,Array,Object,String,String]),j("design:returntype",le)],qi.prototype,"connect",null),ve([ma,j("design:type",Function),j("design:paramtypes",[Array,Array]),j("design:returntype",le)],qi.prototype,"updateRemoteRTPCapabilities",null),ve([ma,j("design:type",Function),j("design:paramtypes",[Object,Array]),j("design:returntype",le)],qi.prototype,"createDataChannels",null),ve([ma,j("design:type",Function),j("design:paramtypes",[String,Array,String,Object]),j("design:returntype",le)],qi.prototype,"receive",null),ve([ma,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",le)],qi.prototype,"stopReceiving",null),ve([ma,j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",le)],qi.prototype,"muteRemote",null),ve([ma,j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",le)],qi.prototype,"unmuteRemote",null),ve([ma,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",le)],qi.prototype,"muteLocal",null),ve([ma,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",le)],qi.prototype,"unmuteLocal",null),ve([ma,j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],qi.prototype,"close",null),ve([ma,j("design:type",Function),j("design:paramtypes",[String,Vr]),j("design:returntype",le)],qi.prototype,"updateEncoderConfig",null),ve([ma,j("design:type",Function),j("design:paramtypes",[String,Vr]),j("design:returntype",le)],qi.prototype,"updateSendParameters",null),ve([ma,j("design:type",Function),j("design:paramtypes",[Vr,String]),j("design:returntype",le)],qi.prototype,"replaceTrack",null),ve([ma,j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",le)],qi.prototype,"getRemoteSSRC",null);class N$ extends Hn{constructor(){super(),O(this,"uplinkStatsUploadInterval",void 0),O(this,"uplinkRelatedStatsUploadInterval",void 0),O(this,"uplinkDenoiserStatsUploadInterval",void 0),O(this,"transportStatsUploadInterval",void 0),O(this,"uplinkExtensionStatsUploadInterval",void 0),O(this,"downlinkExtensionStatsUploadInterval",void 0),O(this,"extensionUsageStatsUploadInterval",void 0),O(this,"downlinkStatsUploadInterval",void 0),O(this,"downlinkRelatedStatsUploadInterval",void 0),O(this,"lastStats",void 0),O(this,"uploadUnplinkStarted",!1),O(this,"uploadDownlinkStarted",!1),O(this,"uploadTransportStarted",!1),O(this,"uploadExtensionUsageStarted",!1),O(this,"requestStats",void 0),O(this,"requestTransportStats",void 0),O(this,"requestLocalMedia",void 0),O(this,"requestRemoteMedia",void 0),O(this,"requestAllTracks",void 0),O(this,"requestVideoIsReady",void 0),O(this,"requestUpload",void 0)}startUploadTransportStats(i){this.uploadTransportStarted||(this.uploadTransportStarted=!0,this.transportStatsUploadInterval&&window.clearInterval(this.transportStatsUploadInterval),this.transportStatsUploadInterval=window.setInterval(()=>{var s;const a=(s=this.requestStats)===null||s===void 0?void 0:s.call(this);if(a){const h=AH(a);if(i){var u;const p=(u=this.requestStats)===null||u===void 0?void 0:u.call(this,!0);if(p){const _=AH(p);h.connectionType+=_.connectionType<<3}h.connectionType+=110}else h.connectionType+=100;pc(()=>{var p;(p=this.requestUpload)===null||p===void 0||p.call(this,lo.TRANSPORT_STATS,h)})}},1e3))}startUploadExtensionUsageStats(){if(this.uploadExtensionUsageStarted)return;this.uploadExtensionUsageStarted=!0,this.extensionUsageStatsUploadInterval&&window.clearInterval(this.extensionUsageStatsUploadInterval);const i=new Map;this.extensionUsageStatsUploadInterval=window.setInterval(async()=>{var s,a,u;const h=Date.now(),p={connectionInterval:te("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3,details:[],lts:h};let _=[];const v=((s=this.requestAllTracks)===null||s===void 0?void 0:s.call(this))||[];for(const N of v)!N.muted&&N.enabled&&(_=_.concat(await N.getProcessorUsage()));const T=((a=this.requestRemoteMedia)===null||a===void 0?void 0:a.call(this))||[];for(const[N,x]of T)x.has(Qe.VIDEO)&&N.videoTrack&&(_=_.concat(await N.videoTrack.getProcessorUsage())),x.has(Qe.AUDIO)&&N.audioTrack&&(_=_.concat(await N.audioTrack.getProcessorUsage()));if(_.length===0)return;p.details=function(N,x){const B={};for(const{id:ee,value:se,level:ye,direction:me}of N){var F;const ue=(F=x.get(ee))!==null&&F!==void 0?F:0,he=se===2?ue+te("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3:ue;var H,J;x.set(ee,he),B[ee]?(se===2&&(B[ee].value=se),ye>B[ee].level&&(B[ee].level=ye),me==="remote"&&(B[ee].remoteUidCount+=1),B[ee].totalTs=(H=x.get(ee))!==null&&H!==void 0?H:0):B[ee]={value:se,level:ye,remoteUidCount:me==="local"?0:1,totalTs:(J=x.get(ee))!==null&&J!==void 0?J:0}}return Object.keys(B).map(ee=>{const{level:se,value:ye,totalTs:me}=B[ee];return{id:ee,level:se,value:ye,totalTs:me}})}(_,i);const b=Date.now(),C=b>h?b:h+1;(u=this.requestUpload)===null||u===void 0||u.call(this,lo.EXTENSION_USAGE_STATS,{usageStats:p,sendTs:C})},te("EXTENSION_USAGE_UPLOAD_INTERVAL"))}startUploadUplinkStats(){this.uploadUnplinkStarted||(this.uploadUnplinkStarted=!0,this.uplinkStatsUploadInterval&&window.clearInterval(this.uplinkStatsUploadInterval),this.uplinkStatsUploadInterval=window.setInterval(()=>{var i;const s=(i=this.requestStats)===null||i===void 0?void 0:i.call(this);s&&(this.uploadUplinkStats(s),this.lastStats=s)},3e3),this.uplinkRelatedStatsUploadInterval&&window.clearInterval(this.uplinkRelatedStatsUploadInterval),this.uplinkRelatedStatsUploadInterval=window.setInterval(()=>{var i;const s=(i=this.requestStats)===null||i===void 0?void 0:i.call(this);s&&this.uploadRelatedUplinkStats(s,this.lastStats),this.lastStats=s},1e3),this.uplinkDenoiserStatsUploadInterval&&window.clearInterval(this.uplinkDenoiserStatsUploadInterval),this.uplinkDenoiserStatsUploadInterval=window.setInterval(()=>{var i;const s=(i=this.requestAllTracks)===null||i===void 0?void 0:i.call(this);s&&this.uploadDenoiserStats(s)},2e3),this.uplinkExtensionStatsUploadInterval&&window.clearInterval(this.uplinkExtensionStatsUploadInterval),this.uplinkExtensionStatsUploadInterval=window.setInterval(()=>{var i;const s=(i=this.requestAllTracks)===null||i===void 0?void 0:i.call(this);s&&this.uploadExtensionStats(s)},2e3))}uploadUplinkStats(i){var s;(((s=this.requestLocalMedia)===null||s===void 0?void 0:s.call(this))||[]).forEach(a=>{let[u,{track:h,ssrcs:p}]=a;switch(u){case Te.LocalVideoLowTrack:case Te.LocalVideoTrack:{const _=function(b,C,N){var x;const B=C.videoSend.find(H=>H.ssrc===b);if(!B)return null;const F={id:wn(10,""),timestamp:new Date(C.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:B.ssrc.toString()};switch(F.A_vstd=N._originMediaStreamTrack&&!N._originMediaStreamTrack.enabled||N._mediaStreamTrack&&!N._mediaStreamTrack.enabled?"1":"0",B.sentFrame&&(F.A_fhs=B.sentFrame.height.toString(),F.A_frs=B.sentFrame.frameRate.toString(),F.A_fws=B.sentFrame.width.toString()),B.adaptionChangeReason){case"none":F.A_ac="0";break;case"cpu":F.A_ac="1";break;case"bandwidth":F.A_ac="2";break;case"other":F.A_ac="3"}return F.A_lvps=L2[N._player?N._player.videoElementStatus:"uninit"].toString(),F.A_nr=(x=B.nacksCount)===null||x===void 0?void 0:x.toString(),B.avgEncodeMs&&(F.A_aem=B.avgEncodeMs.toFixed(0).toString()),te("P2P")&&(B.bytes&&(F.bytesSent=B.bytes.toString()),typeof B.packetsLost=="number"&&(F.packetsLost=B.packetsLost.toString()),B.packets&&(F.packetsSent=B.packets.toString())),F}(p[0].ssrcId,i,h),v=u===Te.LocalVideoTrack?function(b,C,N){var x,B,F,H,J,ee,se,ye;const me=C.videoSend.find(Me=>Me.ssrc===b);if(!me)return null;const ue={id:wn(10,""),timestamp:new Date(C.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:me.ssrc.toString()},he=(x=(B=(F=me.inputFrame)===null||F===void 0?void 0:F.height)!==null&&B!==void 0?B:N==null?void 0:N._videoHeight)!==null&&x!==void 0?x:0,pe=(H=(J=(ee=me.inputFrame)===null||ee===void 0?void 0:ee.width)!==null&&J!==void 0?J:N==null?void 0:N._videoWidth)!==null&&H!==void 0?H:0,Ve=(se=(ye=me.inputFrame)===null||ye===void 0?void 0:ye.frameRate)!==null&&se!==void 0?se:0;return he&&(ue.A_fhi=he+""),pe&&(ue.A_fwi=pe+""),Ve&&(ue.A_fri=Ve+""),ue}(p[0].ssrcId,i,h):null;_&&pc(()=>{var b;return(b=this.requestUpload)===null||b===void 0?void 0:b.call(this,lo.PUBLISH_STATS,{stream_type:u===Te.LocalVideoLowTrack?"low":"high",stats:O$(O$({},_),v)})});const T=function(b){const C={id:"bweforvideo",timestamp:new Date(b.timestamp).toISOString(),type:"VideoBwe"};return b.bitrate.retransmit&&(C.A_rb=b.bitrate.retransmit.toString()),b.bitrate.targetEncoded&&(C.A_teb=b.bitrate.targetEncoded.toString()),C.A_aeb=b.bitrate.actualEncoded.toString(),C.A_tb=b.bitrate.transmit.toString(),b.sendBandwidth!==void 0&&(C.A_asb=b.sendBandwidth.toString()),C}(i);T&&setTimeout(()=>{var b;return(b=this.requestUpload)===null||b===void 0?void 0:b.call(this,lo.PUBLISH_STATS,{stream_type:u===Te.LocalVideoLowTrack?"low":"high",stats:T})},1e3);break}case Te.LocalAudioTrack:{const _=function(v,T,b){const C=T.audioSend.find(x=>x.ssrc===v);if(!C)return null;const N={id:wn(10,""),timestamp:new Date(T.timestamp).toISOString(),mediaType:"audio",type:"ssrc",ssrc:C.ssrc.toString()};return N.A_astd=b._originMediaStreamTrack&&!b._originMediaStreamTrack.enabled||b._mediaStreamTrack&&!b._mediaStreamTrack.enabled?"1":"0",C.inputLevel?N.A_ail=Math.round(100*C.inputLevel).toString():N.A_ail=Math.round(100*b._source.getAccurateVolumeLevel()).toString(),N.A_apil=Math.round(100*b._source.getAccurateVolumeLevel()).toString(),C.aecReturnLoss&&(N.A_ecrl=Math.round(C.aecReturnLoss).toString()),C.aecReturnLossEnhancement&&(N.A_ecrle=Math.round(C.aecReturnLossEnhancement).toString()),te("P2P")&&(C.bytes&&(N.bytesSent=C.bytes.toString()),typeof C.packetsLost=="number"&&(N.packetsLost=C.packetsLost.toString()),C.packets&&(N.packetsSent=C.packets.toString())),N}(p[0].ssrcId,i,h);_&&pc(()=>{var v;return(v=this.requestUpload)===null||v===void 0?void 0:v.call(this,lo.PUBLISH_STATS,{stream_type:"high",stats:_})});break}}})}uploadRelatedUplinkStats(i,s){var a;(((a=this.requestLocalMedia)===null||a===void 0?void 0:a.call(this))||[]).filter(u=>{let[h]=u;return h===Te.LocalVideoLowTrack||h===Te.LocalVideoTrack}).forEach(u=>{let[h,{ssrcs:p}]=u;const _=function(v,T){const b=T.videoSend.find(C=>C.ssrc===v);return b?{mediaType:"video",isVideoMute:!1,frameRateInput:b.inputFrame&&b.inputFrame.frameRate.toString(),frameRateSent:b.sentFrame&&b.sentFrame.frameRate.toString(),googRtt:b.rttMs.toString(),qpSumPerFrame:Math.floor(b.qpSumPerFrame).toString()}:null}(p[0].ssrcId,i);_&&pc(()=>{var v;(v=this.requestUpload)===null||v===void 0||v.call(this,lo.PUBLISH_RELATED_STATS,{stream_type:h===Te.LocalVideoLowTrack?"low":"high",stats:_})})})}uploadDenoiserStats(i){for(let h=0;h<i.length;h++){const p=i[h];if(p instanceof Mh){var s,a,u;const _=(s=(a=p._external).getDenoiserStats)===null||s===void 0?void 0:s.call(a);return void(_&&((u=this.requestUpload)===null||u===void 0||u.call(this,lo.DENOISER_STATS,_)))}}}uploadExtensionStats(i){for(let s=0;s<i.length;s++)i[s].getProcessorStats().forEach(a=>{var u;(u=this.requestUpload)===null||u===void 0||u.call(this,a.type,a.stats)})}stopUploadUplinkStats(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStatsUploadInterval&&window.clearInterval(this.uplinkStatsUploadInterval),this.uplinkRelatedStatsUploadInterval&&window.clearInterval(this.uplinkRelatedStatsUploadInterval),this.uplinkDenoiserStatsUploadInterval&&window.clearInterval(this.uplinkDenoiserStatsUploadInterval),this.uplinkStatsUploadInterval=void 0,this.uplinkRelatedStatsUploadInterval=void 0,this.uplinkDenoiserStatsUploadInterval=void 0)}startUploadDownlinkStats(){if(this.uploadDownlinkStarted)return;let i;this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval);let s=!1;this.downlinkStatsUploadInterval=window.setInterval(()=>{var a;const u=(a=this.requestStats)===null||a===void 0?void 0:a.call(this,!0);u&&(this.uploadDownlinkStats(u,s,i),i=u),s=!s},3e3),this.downlinkRelatedStatsUploadInterval&&window.clearInterval(this.downlinkRelatedStatsUploadInterval),this.downlinkRelatedStatsUploadInterval=window.setInterval(()=>{var a;const u=(a=this.requestStats)===null||a===void 0?void 0:a.call(this,!0);u&&(this.uploadRelatedDownlinkStats(u,this.lastStats),this.lastStats=u)},1e3),this.downlinkExtensionStatsUploadInterval&&window.clearInterval(this.downlinkExtensionStatsUploadInterval),this.downlinkExtensionStatsUploadInterval=window.setInterval(()=>{var a;const u=(a=this.requestRemoteMedia)===null||a===void 0?void 0:a.call(this);u&&this.uploadDownlinkExtensionStats(u)},2e3)}uploadDownlinkStats(i,s,a){var u;(((u=this.requestRemoteMedia)===null||u===void 0?void 0:u.call(this))||[]).forEach(h=>{let[p,_]=h;if(_.has(Qe.VIDEO)&&p.videoTrack){const v=p.videoTrack?function(T,b,C,N,x){const B=b.videoRecv.find(ee=>ee.ssrc===T);if(!B)return null;const F={id:wn(10,""),timestamp:new Date(b.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:B.ssrc.toString()};var H,J;if(F.bytesReceived=B.bytes.toString(),F.packetsLost=B.packetsLost.toString(),F.packetsReceived=B.packets.toString(),B.framesRateFirefox&&(F.A_frr=B.framesRateFirefox.toString()),B.receivedFrame?(F.A_frr=B.receivedFrame.frameRate.toString(),F.A_fhr=B.receivedFrame.height.toString(),F.A_fwr=B.receivedFrame.width.toString()):(F.A_fhr=(H=N._videoHeight)===null||H===void 0?void 0:H.toString(),F.A_fwr=(J=N._videoWidth)===null||J===void 0?void 0:J.toString()),F.A_frd=B.decodeFrameRate.toString(),B.outputFrame&&(F.A_fro=B.outputFrame.frameRate.toString()),B.jitterBufferMs!==void 0&&(F.A_jbm=Math.floor(B.jitterBufferMs).toString()),B.currentDelayMs!==void 0&&(F.A_cdm=Math.floor(B.currentDelayMs).toString()),F.A_fs=B.firsCount.toString(),F.A_ns=B.nacksCount.toString(),F.A_ps=B.plisCount.toString(),N&&(F.A_vrtd=N._originMediaStreamTrack.enabled&&N._mediaStreamTrack.enabled?"0":"1"),N._player&&N._player.freezeTimeCounterList.length>0&&(F.A_vrft=Math.round(N._player.freezeTimeCounterList.splice(0,1)[0]).toString()),x&&N._player&&ld.visibility==="visible"){const ee=Math.min(6e3,N._player.renderFreezeAccTime);F.A_vrrft=Math.round(ee).toString(),N._player.renderFreezeAccTime=Math.max(0,N._player.renderFreezeAccTime-ee)}if(F.A_rvps=L2[N._player?N._player.videoElementStatus:"uninit"].toString(),C){const ee=C.videoRecv.find(se=>se.ssrc===T);if(ee&&B.totalInterFrameDelay!==void 0&&B.totalSquaredInterFrameDelay!==void 0&&ee.totalInterFrameDelay!==void 0&&ee.totalSquaredInterFrameDelay!==void 0){const se=B.totalInterFrameDelay-ee.totalInterFrameDelay,ye=B.totalSquaredInterFrameDelay-ee.totalSquaredInterFrameDelay,me=B.framesDecodeCount-ee.framesDecodeCount,ue=se/me*1e3,he=Math.round(1e3*Math.sqrt((ye-Math.pow(se,2)/me)/me));!isNaN(he)&&ue+he>Math.max(3*ue,ue+150)&&(F.A_ifdsd=he.toString())}}return F}(p._videoSSRC,i,a,p.videoTrack,s):void 0;v&&pc(()=>{var T;return(T=this.requestUpload)===null||T===void 0?void 0:T.call(this,lo.SUBSCRIBE_STATS,{stream_id:p.uid,stats:v})})}if(_.has(Qe.AUDIO)&&p.audioTrack){const v=p.audioTrack?function(T,b,C,N){const x=b.audioRecv.find(F=>F.ssrc===T);if(!x)return null;const B={id:wn(10,""),timestamp:new Date(b.timestamp).toISOString(),mediaType:"audio",type:"ssrc",ssrc:x.ssrc.toString()};if(B.bytesReceived=x.bytes.toString(),B.packetsLost=x.packetsLost.toString(),B.packetsReceived=x.packets.toString(),x.outputLevel?B.A_aol=Math.round(100*x.outputLevel).toString():B.A_aol=Math.round(100*N._source.getAccurateVolumeLevel()).toString(),B.A_apol=Math.round(100*N._source.getAccurateVolumeLevel()).toString(),N&&(B.A_artd=N._originMediaStreamTrack.enabled&&N._mediaStreamTrack.enabled?"0":"1"),B.A_jr=x.jitterMs.toString(),B.A_jbm=Math.floor(x.jitterBufferMs).toString(),B.A_cdm=Math.floor(x.jitterBufferMs).toString(),B.A_raps=L2[Mo.getPlayerState(N.getTrackId())].toString(),C){const F=C.audioRecv.find(H=>H.ssrc===T);if(F){const H=x.concealedSamples-F.concealedSamples;H>0&&(B.A_cs=Math.round(H).toString())}}return B}(p._audioSSRC,i,a,p.audioTrack):void 0;v&&pc(()=>{var T;return(T=this.requestUpload)===null||T===void 0?void 0:T.call(this,lo.SUBSCRIBE_STATS,{stream_id:p.uid,stats:v})})}})}uploadRelatedDownlinkStats(i,s){var a;(((a=this.requestRemoteMedia)===null||a===void 0?void 0:a.call(this))||[]).forEach(u=>{let[h,p]=u;if(p.has(Qe.VIDEO)&&h.videoTrack){var _;const v=(h._videoSSRC&&((_=this.requestVideoIsReady)===null||_===void 0?void 0:_.call(this,h._videoSSRC))||!1)===!0,T=function(b,C,N,x,B,F){const H=N.videoRecv.find(ye=>ye.ssrc===b),J=B?B.videoRecv.find(ye=>ye.ssrc===b):void 0;if(!H)return null;const ee=cE.isRemoteVideoFreeze(F,H,J)&&C,se={mediaType:"video",isVideoMute:!1,peerId:x,frameRateReceived:H.receivedFrame&&H.receivedFrame.frameRate.toString(),frameRateDecoded:H.decodedFrame&&H.decodedFrame.frameRate.toString(),isFreeze:ee,bytesReceived:H.bytes.toString(),packetsReceived:H.packets.toString(),packetsLost:H.packetsLost.toString(),qpSumPerFrame:Math.floor(H.qpSumPerFrame).toString()};return H.framesRateFirefox&&(se.frameRateDecoded=H.framesRateFirefox.toString(),se.frameRateReceived=H.framesRateFirefox.toString()),se}(h._videoSSRC,v,i,h.uid,s,h.videoTrack);T&&pc(()=>{var b;(b=this.requestUpload)===null||b===void 0||b.call(this,lo.SUBSCRIBE_RELATED_STATS,{stream_id:h.uid,stats:T})})}if(p.has(Qe.AUDIO)&&h.audioTrack){const v=function(T,b,C,N){const x=b.audioRecv.find(F=>F.ssrc===T);if(!x)return null;const B=cE.isRemoteAudioFreeze(N);return{mediaType:"audio",isAudioMute:!1,peerId:C,googJitterReceived:x.jitterMs.toString(),isFreeze:B,bytesReceived:x.bytes.toString(),packetsReceived:x.packets.toString(),packetsLost:x.packetsLost.toString(),frameReceived:x.receivedFrames.toString(),frameDropped:x.droppedFrames.toString()}}(h._audioSSRC,i,h.uid,h.audioTrack);v&&pc(()=>{var T;(T=this.requestUpload)===null||T===void 0||T.call(this,lo.SUBSCRIBE_RELATED_STATS,{stream_id:h.uid,stats:v})})}})}stopUploadDownlinkStats(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval),this.downlinkRelatedStatsUploadInterval&&window.clearInterval(this.downlinkRelatedStatsUploadInterval),this.downlinkStatsUploadInterval=void 0,this.downlinkRelatedStatsUploadInterval=void 0)}stopUploadTransportStats(){this.uploadTransportStarted&&(this.uploadTransportStarted=!1,this.transportStatsUploadInterval&&window.clearInterval(this.transportStatsUploadInterval),this.transportStatsUploadInterval=void 0)}stopUploadExtensionUsageStats(){this.uploadExtensionUsageStarted&&(this.uploadExtensionUsageStarted=!1,this.extensionUsageStatsUploadInterval&&window.clearInterval(this.extensionUsageStatsUploadInterval),this.extensionUsageStatsUploadInterval=void 0)}uploadDownlinkExtensionStats(i){i.forEach(s=>{let[a,u]=s;u.has(Qe.VIDEO)&&a.videoTrack&&a.videoTrack.getProcessorStats().forEach(h=>{var p;(p=this.requestUpload)===null||p===void 0||p.call(this,h.type,h.stats)}),u.has(Qe.AUDIO)&&a.audioTrack&&a.audioTrack.getProcessorStats().forEach(h=>{var p;(p=this.requestUpload)===null||p===void 0||p.call(this,h.type,h.stats)})})}}function P$(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function Gh(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?P$(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):P$(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}function x$(o){var i,s,a,u=2;for(typeof Symbol<"u"&&(s=QH,a=Symbol.iterator);u--;){if(s&&(i=o[s])!=null)return i.call(o);if(a&&(i=o[a])!=null)return new hA(i.call(o));s="@@asyncIterator",a="@@iterator"}throw new TypeError("Object is not async iterable")}function hA(o){function i(s){if(Object(s)!==s)return le.reject(new TypeError(s+" is not an object."));var a=s.done;return le.resolve(s.value).then(function(u){return{value:u,done:a}})}return hA=function(s){this.s=s,this.n=s.next},hA.prototype={s:null,n:null,next:function(){return i(this.n.apply(this.s,arguments))},return:function(s){var a=this.s.return;return a===void 0?le.resolve({value:s,done:!0}):i(a.apply(this.s,arguments))},throw:function(s){var a=this.s.return;return a===void 0?le.reject(s):i(a.apply(this.s,arguments))}},new hA(o)}class Er extends Hn{get state(){return this._state}set state(i){const s=this._state;this._state=i,this.emit(ut.StateChange,s,this._state)}constructor(i,s){super(),O(this,"store",void 0),O(this,"statsUploader",void 0),O(this,"connection",void 0),O(this,"localTrackMap",new Map),O(this,"remoteUserMap",new Map),O(this,"localDataChannels",[]),O(this,"remoteDataChannelMap",new Map),O(this,"pendingLocalTracks",[]),O(this,"pendingRemoteTracks",[]),O(this,"pendingLocalDataChannels",[]),O(this,"pendingRemoteDataChannels",[]),O(this,"statsCollector",void 0),O(this,"isPlanB",!1),O(this,"shouldForwardP2PCreation",void 0),O(this,"iceFailedCount",0),O(this,"dtlsFailedCount",0),O(this,"mutex",new fr("P2PChannel-mutex")),O(this,"_state",Xt.Disconnected),O(this,"_pcStatsUploadType",te("NEW_ICE_RESTART")?rl.FIRST_CONNECTION:rl.OLD_FIRST_CONNECTION),O(this,"_isInRestartIce",!1),O(this,"_isStartRestartIce",!1),O(this,"_restartStates",["disconnected","failed"]),O(this,"_restartTimer",void 0),O(this,"_isFirstConnected",!0),O(this,"handleMuteLocalTrack",async(a,u,h)=>{const p=await this.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!this.connection||this.state!==Xt.Connected)return void h(new Ee(z.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));const _=this.filterTobeMutedTracks(a);if(_.length===0)return void u();const v=_.find(b=>b[0]==="videoLowTrack");v&&v[1].track._originMediaStreamTrack.stop(),await this.connection.muteLocal(_.map(b=>{let[,{id:C}]=b;return C}));const T=this.createMuteMessage(_);await bn(this,ut.RequestMuteLocal,T),u()}catch(_){h(_)}finally{p()}}),O(this,"handleUnmuteLocalTrack",async(a,u,h)=>{const p=await this.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!this.connection||this.state!==Xt.Connected)return void h(new Ee(z.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));const _=this.filterTobeUnmutedTracks(a);if(_.length===0)return void u();const v=_.find(b=>b[0]==="videoLowTrack");if(v){const b=v[1];if(b.track._originMediaStreamTrack.stop(),!te("DISABLE_DUAL_STREAM_USE_ENCODING")&&In().supportDualStreamEncoding){const C=a._mediaStreamTrack.clone();b.track._mediaStreamTrack=C,b.track._originMediaStreamTrack=C}else{const C=DU(a,ad(this,ut.RequestLowStreamParameter));b.track._mediaStreamTrack=C,b.track._originMediaStreamTrack=C}await new le((C,N)=>{this.handleReplaceTrack(b.track,C,N,!0)})}await this.connection.unmuteLocal(_.map(b=>{let[,{id:C}]=b;return C}));const T=this.createUnmuteMessage(_);await bn(this,ut.RequestUnmuteLocal,T),u()}catch(_){h(_)}finally{p()}}),O(this,"handleUpdateVideoEncoder",async(a,u,h)=>{const p=await this.mutex.lock("Locking from P2PChannel.handleSetVideoEncoder");try{const _=this.localTrackMap.get(Te.LocalVideoTrack);if(!this.connection||!_||_.track!==a||this.state!==Xt.Connected)return void u();const{id:v,track:T}=_;await this.connection.updateSendParameters(v,T),await this.connection.updateEncoderConfig(v,T),this.emit(ut.UpdateVideoEncoder,T),u()}catch(_){h(_)}finally{p()}}),O(this,"handleSetOptimizationMode",async(a,u,h)=>{const p=await this.mutex.lock("Locking from P2PChannel.handleSetOptimizationMode");try{const _=this.localTrackMap.get(Te.LocalVideoTrack);if(!this.connection||!_||_.track!==a||this.state!==Xt.Connected)return;const{id:v,track:T}=_;await this.connection.updateSendParameters(v,T),u()}catch(_){h(_)}finally{p()}}),O(this,"handleReplaceTrack",async(a,u,h,p)=>{let _;D.debug("[".concat(this.store.clientId,"] P2PChannel handleReplaceTrack for [track-id-").concat(a.getTrackId(),"]")),typeof p=="boolean"&&p||(_=await this.mutex.lock("From P2PChannel.handleReplaceTrack"));try{var v;const b=Array.from(this.localTrackMap.entries()).find(C=>{let[,{track:N}]=C;return a===N});if(!this.connection||!b||this.state!==Xt.Connected)return void u();if(await((v=this.connection)===null||v===void 0?void 0:v.replaceTrack(a,b[1].id)),this.isPlanB){const C=b[1];C.id=a._mediaStreamTrack.id,this.localTrackMap.set(b[0],C)}if(b[0]===Te.LocalVideoTrack&&!te("DISABLE_DUAL_STREAM_USE_ENCODING")&&In().supportDualStreamEncoding){const C=this.localTrackMap.get(Te.LocalVideoLowTrack);if(C){const N=a._mediaStreamTrack.clone();C.track._originMediaStreamTrack.stop(),C.track._mediaStreamTrack=N,C.track._originMediaStreamTrack=N,await new le((x,B)=>{this.handleReplaceTrack(C.track,x,B,!0)})}}u()}catch(b){h(b)}finally{var T;(T=_)===null||T===void 0||T()}}),O(this,"handleGetRTCStats",a=>{a(this.statsCollector.getRTCStats())}),O(this,"handleGetLocalVideoStats",a=>{a(this.statsCollector.getLocalVideoTrackStats())}),O(this,"handleGetLocalAudioStats",a=>{a(this.statsCollector.getLocalAudioTrackStats())}),O(this,"handleGetRemoteVideoStats",a=>this.statsCollector.getRemoteVideoTrackStats(a.uid)[a.uid]),O(this,"handleGetRemoteAudioStats",a=>this.statsCollector.getRemoteAudioTrackStats(a.uid)[a.uid]),this.store=i,this.statsCollector=s,this.statsCollector.addP2PChannel(this),this.statsUploader=new N$,this.bindStatsUploaderEvents(),this.isPlanB=!In().supportUnifiedPlan||te("CHROME_FORCE_PLAN_B")&&Ih(),this.shouldForwardP2PCreation=te("FORWARD_P2P_CREATION")&&In().supportPCSetConfiguration&&function(){const a=ZR();return a===tr.ANDROID||a===tr.IOS||a===tr.HARMONY_OS}(),this.shouldForwardP2PCreation&&(this.connection=this.store.useDataChannel?new qi({},this.store):this.isPlanB?new _r({},this.store):new Ki({},this.store),this.bindConnectionEvents(this.connection))}async startP2PConnection(i,s){var a;this.state=Xt.New;const u=this.shouldForwardP2PCreation&&((a=this.connection)===null||a===void 0?void 0:a.peerConnectionState)==="closed";if(this.shouldForwardP2PCreation&&!u||(u&&this.connection&&(D.warning("[".concat(this.store.clientId,"] P2PChannel.startP2PConnection ForwardP2P closed.")),this.connection.close(),this.unbindConnectionEvents(this.connection)),this.connection=this.store.useDataChannel?new qi(i,this.store):this.isPlanB?new _r(i,this.store):new Ki(i,this.store),this.bindConnectionEvents(this.connection)),!this.connection)throw new Ee(z.UNEXPECTED_ERROR,"Cannot P2PChannel.startConnection before P2PConnection initialization .");return this._pcStatsUploadType=te("NEW_ICE_RESTART")?rl.FIRST_CONNECTION:rl.OLD_FIRST_CONNECTION,this._isFirstConnected=!0,this._isInRestartIce=!1,this._isStartRestartIce=!1,this.connection.setConfiguration(i),this.connection.establishPromise}async connect(i,s,a,u,h,p){if(!this.connection)throw new Ee(z.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");this.connection instanceof qi?this.connection.updateRemoteConnect(u):(this.store.peerConnectionStart(),await this.connection.connect(i,s,a,u,h,p),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=Xt.Connected)}updateRemoteRTPCapabilities(i){const s=Array.from(this.localTrackMap.entries()).filter(a=>{var u;let[h]=a;return ot(u=[Te.LocalVideoLowTrack,Te.LocalVideoTrack]).call(u,h)}).map(a=>{let[,{id:u}]=a;return u});if(this.connection instanceof Ki){if(!ot(i).call(i,this.store.codec)){const a=["vp8","h264"].find(u=>ot(i).call(i,u));a&&(this.store.codec=a,D.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId," updateRemoteRTPCapabilities] default codec is not available, hence the fallback to ").concat(a,".")))}this.connection.updateRemoteRTPCapabilities(s,i)}}async preConnect(i,s,a,u,h,p){if(!this.connection)throw new Ee(z.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");this.store.peerConnectionStart();const _=await this.connection.connect(i,s,a,u,h,p);return this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=Xt.Connected,_}getEstablishParams(){if(this.connection instanceof qi)return this.connection.getP2PConnectionParams();throw new Error("Only DataChannelConnection needs to obtain establishParams")}async publishDataChannel(i){if(!this.connection){if(this.state===Xt.Disconnected)throw new Ee(z.UNEXPECTED_ERROR,"PeerConnection already disconnected.");const a=i.filter(u=>this.pendingLocalDataChannels.findIndex(h=>h.id===u.id)!==-1);return void(this.pendingLocalDataChannels=this.pendingLocalDataChannels.concat(a))}const s=this.filterTobePublishedDataChannels(i);s.length!==0&&(s.forEach(a=>{const u=Date.now();this.store.publish(a.id.toString(),"datachannel",u)}),await this.connection.createDataChannels(this.store.uid,s),s.forEach(a=>{this.localDataChannels.push(a);const u=Date.now();this.store.publish(a.id+"","datachannel",void 0,u)}))}publish(i,s,a){var u=this;return Ha(function*(){const h=yield en(u.mutex.lock("From P2PChannel.publish"));try{if(!u.connection||u.state!==Xt.Connected){if(u.state===Xt.Disconnected)throw new Ee(z.UNEXPECTED_ERROR,"PeerConnection already disconnected.");u.throwIfTrackTypeNotMatch(i);const _=i.filter(v=>u.pendingLocalTracks.indexOf(v)===-1);return void(u.pendingLocalTracks=u.pendingLocalTracks.concat(_))}u.store.pubId=u.store.pubId+1,Br.markPublishStart(u.store.clientId,u.store.pubId);const p=u.filterTobePublishedTracks(i,s,a);if(p.length===0)return void(yield en(u.tryToUnmuteAudio(i)));yield*nA(x$(u.doPublish(u.connection,p)))}finally{h()}})()}doPublish(i,s){var a=this;return Ha(function*(){s.forEach(b=>{let{track:C,type:N}=b;const x=Date.now();a.store.publish(C.getTrackId(),N===Te.LocalAudioTrack?"audio":"video",x)}),a.bindLocalTrackEvents(s);const u=yield en(i.send(s.map(b=>{let{track:C}=b;return C}),a.store.codec,a.store.audioCodec)),h=(yield en(u.next())).value,p=a.createGatewayPublishMessage(s,h);let _;try{_=yield p}catch(b){throw u.throw(b),(b==null?void 0:b.code)===z.WS_ABORT&&s.forEach(C=>{let{track:N}=C;a.pendingLocalTracks.indexOf(N)===-1&&a.pendingLocalTracks.push(N)}),a.unbindLocalTrackEvents(s),b}const v=a.mapPubResToRemoteConfig(p,_),T=(yield en(u.next(v))).value;s.forEach(b=>{let{type:C}=b;a.statsCollector.addLocalStats(C)}),a.assignLocalTracks(s,T),a.statsUploader.startUploadUplinkStats(),s.forEach(b=>{let{track:C,type:N}=b;const x=Date.now();a.store.publish(C.getTrackId(),N===Te.LocalAudioTrack?"audio":"video",void 0,x)})})()}async updateVideoStreamParameter(i,s){const a=this.localTrackMap.get(s);if(!a)return;if(!(a.track instanceof Ct))return D.warn("[updateVideoStreamParameter]: track is not an instance of LocalVideoTrack");if(!(this.connection instanceof Ki||this.connection instanceof _r))return D.warn("[updateVideoStreamParameter]: connection is not P2PConnection or P2PConnectionPlanB");const{track:u}=a,h=function(p,_){const v={};return p.height&&p.width&&(v.scaleResolutionDownBy=gU(p,_)),v.maxFramerate=p.framerate?pa(p.framerate):void 0,v.maxBitrate=p.bitrate?1e3*p.bitrate:void 0,v}(i,u);if(u._encoderConfig||(u._encoderConfig={}),s!==Te.LocalVideoLowTrack||!te("DISABLE_DUAL_STREAM_USE_ENCODING")&&In().supportDualStreamEncoding)h.scaleResolutionDownBy!=null&&(u._encoderConfig.scaleResolutionDownBy=h.scaleResolutionDownBy);else{const p=u._originMediaStreamTrack;if(!p.canvas)return D.warn("[".concat(u.getTrackId(),"] no canvas on track"));(function(_,v){const T=_.canvas;v.width&&(T.width=pa(v.width)),v.height&&(T.height=pa(v.height)),v.framerate&&(T.stopCapture&&T.stopCapture(),T.stopCapture=U2(()=>{!T.startCapture&&T.stopCapture&&T.stopCapture(),T.startCapture&&T.startCapture()},pa(v.framerate)))})(p,i)}h.maxBitrate!=null&&(u._encoderConfig.bitrateMax=h.maxBitrate/1e3),h.maxFramerate!=null&&(u._encoderConfig.frameRate&&typeof u._encoderConfig.frameRate=="object"?u._encoderConfig.frameRate.max=h.maxFramerate:u._encoderConfig.frameRate={max:h.maxFramerate}),D.debug("[".concat(u.getTrackId(),"] LowStreamEncoderConfig: , ").concat(JSON.stringify(u._encoderConfig))),await this.connection.updateRtpSenderEncodings(u)}publishLowStream(i){var s=this;return Ha(function*(){if(!s.connection||s.state!==Xt.Connected)return;const a=yield en(s.mutex.lock("Locking from P2PChannel.publishLowStream"));try{const h=s.localTrackMap.get(Te.LocalVideoTrack);if(!h)throw new Ee(z.UNEXPECTED_ERROR,"Could not find high stream");if(s.localTrackMap.has(Te.LocalVideoLowTrack))throw new Ee(z.UNEXPECTED_ERROR,"[".concat(s.store.clientId,"] Can't publish low stream when stream already publish"));const p=[{track:s.getLowVideoTrack(h.track,i),type:Te.LocalVideoLowTrack}];if(yield*nA(x$(s.doPublish(s.connection,p))),h.track.muted||!h.track.enabled){var u;const _=(u=s.localTrackMap.get(Te.LocalVideoLowTrack))===null||u===void 0?void 0:u.id;_!==void 0&&(yield en(s.connection.muteLocal([_])))}}finally{a()}})()}async republish(){this.pendingLocalTracks.length>0&&(D.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await Qn(this,ut.RequestRePublish,this.pendingLocalTracks),this.emit(ut.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[]),this.pendingLocalDataChannels.length>0&&(D.debug("Emit P2PChannelEvents.RequestRePublishDataChannel to republish datachannels."),await Qn(this,ut.RequestRePublishDataChannel,this.pendingLocalDataChannels),this.pendingLocalDataChannels=[])}async reSubscribe(i){for(let s=this.pendingRemoteTracks.length-1;s>=0;s--){const{user:a,kind:u}=this.pendingRemoteTracks[s];(u!==Qe.AUDIO||a._audio_added_&&a._audioSSRC)&&(u!==Qe.VIDEO||a._video_added_&&a._videoSSRC)||this.pendingRemoteTracks.splice(s,1)}if(i)await Qn(this,ut.RequestReSubscribe,this.pendingRemoteTracks);else for(const{user:s,kind:a}of this.pendingRemoteTracks)await this.subscribe(s,a,a===Qe.VIDEO?s._videoSSRC:s._audioSSRC);this.pendingRemoteTracks.forEach(s=>{let{user:a}=s;this.emit(ut.MediaReconnectEnd,a.uid)}),this.pendingRemoteTracks=[]}async unpublish(i){if(!this.connection||this.state!==Xt.Connected)return void i.forEach(u=>{const h=this.pendingLocalTracks.indexOf(u);h!==-1&&this.pendingLocalTracks.splice(h,1)});const s=this.filterTobeUnpublishedTracks(i);if(s.length===0)return;const a=s.find(u=>u[0]==="videoLowTrack");return a&&a[1].track.close(),this.doUnpublish(this.connection,s)}async unpublishDataChannel(i){if(!this.connection||this.state!==Xt.Connected)return void i.forEach(a=>{const u=this.pendingLocalDataChannels.indexOf(a);u!==-1&&this.pendingLocalDataChannels.splice(u,1)});const s=this.filterTobeUnpublishedDataChannels(i);return s.length!==0?(s.forEach(a=>{const u=this.localDataChannels.indexOf(a);u!==-1&&this.localDataChannels.splice(u,1)}),this.localDataChannels.length===0&&await this.connection.stopDataChannels(this.store.uid),s.map(a=>a.id)):void 0}async unpublishLowStream(){if(!this.connection||this.state!==Xt.Connected)return;const i=this.localTrackMap.get(Te.LocalVideoLowTrack);if(!i)return;i.track.close();const s=[[Te.LocalVideoLowTrack,i]];return this.doUnpublish(this.connection,s)}async doUnpublish(i,s){const a=this.createGatewayUnpublishMessage(s);return await i.stopSending(s.map(u=>{let[,{id:h}]=u;return h})),this.withdrawLocalTracks(s),this.unbindLocalTrackEvents(s.map(u=>{let[h,{track:p}]=u;return{type:h,track:p}})),s.forEach(u=>{let[h]=u;this.statsCollector.removeLocalStats(h)}),this.localTrackMap.size===0&&this.statsUploader.stopUploadUplinkStats(),a}async subscribeDataChannel(i,s){if(!this.connection||this.state!==Xt.Connected)throw new Ee(z.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");const a=s.filter(u=>{var h;return!((h=this.remoteDataChannelMap.get(i))!==null&&h!==void 0&&h.get(u.id))});if(a.length!==0)return await this.connection.createDataChannels(i.uid,a),a.forEach(u=>{var h;this.remoteDataChannelMap.has(i)?(h=this.remoteDataChannelMap.get(i))===null||h===void 0||h.set(u.id,u):this.remoteDataChannelMap.set(i,new Map([[u.id,u]]));const p=this.pendingRemoteDataChannels.findIndex(_=>{let{user:v,id:T}=_;return v.uid===i.uid&&T===u.id});p!==-1&&this.pendingRemoteDataChannels.splice(p,1)}),a.map(u=>u.id)}async subscribe(i,s,a,u,h){var p;if(!this.connection||this.state!==Xt.Connected)throw new Ee(z.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if((p=this.remoteUserMap.get(i))!==null&&p!==void 0&&p.has(s))return;let _,v,T;if(h){const N=h.find(B=>{let{stream_type:F}=B;return F===s});if(!N)throw new Ee(z.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(s," for user: ").concat(i.uid," because subscribe answer from gateway does not contain stream_type: ").concat(s,"."));const x=await this.connection.receive(s,N.ssrcs,String(i._uintid),N.attributes);this.connection instanceof Ki&&(T=x.transceiver),_=x.track,v=x.id}else{const N=await this.connection.receive(s,[{ssrcId:a,rtx:u}],String(i._uintid),void 0);this.connection instanceof Ki&&(T=N.transceiver),_=N.track,v=N.id}s===Qe.AUDIO?(i._audioTrack?i._audioTrack._updateOriginMediaStreamTrack(_):(i._audioTrack=new _c(_,i.uid,i._uintid,this.store),D.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(i._audioTrack.getTrackId()))),T&&i._audioTrack._updateRtpTransceiver(T),this.bindRemoteTrackEvents(i,i._audioTrack)):(i._videoTrack?i._videoTrack._updateOriginMediaStreamTrack(_):(i._videoTrack=new tu(_,i.uid,i._uintid,this.store),D.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(i._videoTrack.getTrackId()))),T&&i._videoTrack._updateRtpTransceiver(T),this.bindRemoteTrackEvents(i,i._videoTrack));const b=this.remoteUserMap.get(i);b?b.set(s,v):this.remoteUserMap.set(i,new Map([[s,v]])),this.statsCollector.addRemoteStats(i.uid),this.statsUploader.startUploadDownlinkStats();const C=this.pendingRemoteTracks.findIndex(N=>{let{user:x,kind:B}=N;return x.uid===i.uid&&s===B});C!==-1&&(this.pendingRemoteTracks.splice(C,1),this.emit(ut.MediaReconnectEnd,i.uid))}async massSubscribe(i){return this.massSubscribeNoLock(i)}async massSubscribeNoLock(i){if(!this.connection||this.state!==Xt.Connected)throw new Ee(z.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");i=i.filter(a=>{var u;let{user:h,mediaType:p}=a;return!((u=this.remoteUserMap.get(h))!==null&&u!==void 0&&u.has(p))});const s=await this.connection.batchReceive(i.map(a=>{let{user:u,mediaType:h,ssrcId:p,rtxSsrcId:_}=a;return{kind:h,ssrcMsg:[{ssrcId:p,rtx:_}],mslabel:String(u._uintid)}}));i.forEach((a,u)=>{let{user:h,mediaType:p}=a;const{track:_,id:v,transceiver:T}=s[u];p===Qe.AUDIO?(h._audioTrack?h._audioTrack._updateOriginMediaStreamTrack(_):(h._audioTrack=new _c(_,h.uid,h._uintid,this.store),D.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(h._audioTrack.getTrackId()))),T&&h._audioTrack._updateRtpTransceiver(T),this.bindRemoteTrackEvents(h,h._audioTrack)):(h._videoTrack?h._videoTrack._updateOriginMediaStreamTrack(_):(h._videoTrack=new tu(_,h.uid,h._uintid,this.store),D.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(h._videoTrack.getTrackId()))),T&&h._videoTrack._updateRtpTransceiver(T),this.bindRemoteTrackEvents(h,h._videoTrack));const b=this.remoteUserMap.get(h);b?b.set(p,v):this.remoteUserMap.set(h,new Map([[p,v]])),this.statsCollector.addRemoteStats(h.uid),this.statsUploader.startUploadDownlinkStats();const C=this.pendingRemoteTracks.findIndex(N=>{let{user:x,kind:B}=N;return x.uid===h.uid&&p===B});C!==-1&&(this.pendingRemoteTracks.splice(C,1),this.emit(ut.MediaReconnectEnd,h.uid))})}async unsubscribe(i,s,a){const u=this.pendingRemoteTracks.filter(_=>{let{user:v,kind:T}=_;return s!==void 0?v.uid===i.uid&&s===T:v.uid===i.uid});if(u.forEach(_=>{const v=this.pendingRemoteTracks.indexOf(_);this.pendingRemoteTracks.splice(v,1)}),this.connection&&this.state===Xt.Connected||a||u.forEach(_=>{let{kind:v}=_;var T;if(v===Qe.AUDIO)(T=i._audioTrack)===null||T===void 0||T._destroy(),i._audioTrack=void 0;else if(v===Qe.VIDEO){var b;(b=i._videoTrack)===null||b===void 0||b._destroy(),i._videoTrack=void 0}}),!this.connection||this.state!==Xt.Connected)return;const h=this.filterTobeUnSubscribedTracks(i,s);if(h.length===0)return;await this.connection.stopReceiving(h.map(_=>{let[,{id:v}]=_;return v}));const p=this.createUnsubscribeMessage(h);return this.withdrawRemoteTracks(h),this.remoteUserMap.size===0&&this.statsUploader.stopUploadDownlinkStats(),h.forEach(_=>{let[v,{kind:T}]=_;var b,C;if(T===Qe.VIDEO&&v._videoSSRC&&((b=this.connection)===null||b===void 0||b.setStatsRemoteVideoIsReady(v._videoSSRC,!1)),T===Qe.VIDEO)this.unbindRemoteTrackEvents(v._videoTrack),a||((C=v._videoTrack)===null||C===void 0||C._destroy(),v._videoTrack=void 0);else if(T===Qe.AUDIO){var N;this.unbindRemoteTrackEvents(v._audioTrack),!a&&((N=v._audioTrack)===null||N===void 0||N._destroy(),v._audioTrack=void 0)}}),p}async unsubscribeDataChannel(i,s){if(s.forEach(h=>{const p=this.pendingRemoteDataChannels.findIndex(_=>_.id===h.id);p!==-1&&this.pendingRemoteDataChannels.splice(p,1)}),!this.connection)return;const a=this.filterTobeUnSubscribedDataChannels(i,s);if(a.length===0)return;s.forEach(h=>{h._close()});const u=this.remoteDataChannelMap.get(i);return a.forEach(h=>{u&&u.delete(h.id)}),u&&u.size===0&&(this.remoteDataChannelMap.delete(i),await this.connection.stopDataChannels(i.uid)),a.map(h=>h.id)}async massUnsubscribe(i){return this.massUnsubscribeNoLock(i)}async massUnsubscribeNoLock(i){let s=[];for(const{user:h,mediaType:p}of i){const _=this.pendingRemoteTracks.filter(v=>{let{user:T,kind:b}=v;return p!==void 0?T.uid===h.uid&&p===b:T.uid===h.uid});_.forEach(v=>{const T=this.pendingRemoteTracks.indexOf(v);this.pendingRemoteTracks.splice(T,1)}),s=s.concat(_)}if(!this.connection||this.state!==Xt.Connected)return void s.forEach(h=>{let{user:p,kind:_}=h;var v;if(_===Qe.AUDIO)(v=p._audioTrack)===null||v===void 0||v._destroy(),p._audioTrack=void 0;else if(_===Qe.VIDEO){var T;(T=p._videoTrack)===null||T===void 0||T._destroy(),p._videoTrack=void 0}});const a=zp(i).call(i,(h,p)=>{let{user:_,mediaType:v}=p;const T=this.filterTobeUnSubscribedTracks(_,v);return h.concat(T)},[]);if(a.length===0)return;await this.connection.stopReceiving(a.map(h=>{let[,{id:p}]=h;return p}));const u=this.createUnsubscribeAllMessage(a);return this.withdrawRemoteTracks(a),this.remoteUserMap.size===0&&this.statsUploader.stopUploadDownlinkStats(),a.forEach(h=>{let[p,{kind:_}]=h;var v,T;if(_===Qe.VIDEO&&p._videoSSRC&&((v=this.connection)===null||v===void 0||v.setStatsRemoteVideoIsReady(p._videoSSRC,!1)),_===Qe.VIDEO)this.unbindRemoteTrackEvents(p._videoTrack),(T=p._videoTrack)===null||T===void 0||T._destroy(),p._videoTrack=void 0;else if(_===Qe.AUDIO){var b;this.unbindRemoteTrackEvents(p._audioTrack),(b=p._audioTrack)===null||b===void 0||b._destroy(),p._audioTrack=void 0}}),u}async muteRemote(i,s){if(!this.connection)return;const a=this.remoteUserMap.get(i);if(!a)return void D.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(i.uid,"."));if(!a.get(s))return void D.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(i.uid," media type ").concat(s,"."));const u=s===Qe.VIDEO?i._videoSSRC:i._audioSSRC;u!==void 0&&this.connection.setStatsRemoteVideoIsReady(u,!1)}async unmuteRemote(i,s){return this.unmuteRemoteNoLock(i,s)}async unmuteRemoteNoLock(i,s){if(!this.connection)return;const a=this.remoteUserMap.get(i);if(!a)return void D.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(i.uid,"."));a.get(s)||D.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(i.uid," media type ").concat(s,"."))}getAllTracks(i){const s=this.localTrackMap.get(Te.LocalAudioTrack);if((s==null?void 0:s.track)instanceof Ni){const a=s.track;return Array.from(this.localTrackMap.entries()).filter(u=>{let[h]=u;return h!==Te.LocalAudioTrack}).filter(u=>{let[h]=u;return!(i&&h===Te.LocalVideoLowTrack)}).map(u=>{let[,{track:h}]=u;return h}).concat(a.trackList)}return Array.from(this.localTrackMap.entries()).filter(a=>{let[u]=a;return!(i&&u===Te.LocalVideoLowTrack)}).map(a=>{let[,{track:u}]=a;return u})}getAllDataChannels(){return this.localDataChannels}reportPublishEvent(i,s,a,u,h){if(i){const _=this.localTrackMap.get(Te.LocalAudioTrack),v=u?this.localTrackMap.get(Te.LocalVideoLowTrack):this.localTrackMap.get(Te.LocalVideoTrack);it.publish(this.store.sessionId,{eventElapse:Br.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:i,ec:s,audioName:_==null?void 0:_.track.getTrackLabel(),videoName:v==null?void 0:v.track.getTrackLabel(),screenshare:(v==null?void 0:v.track._hints.indexOf(Ln.SCREEN_TRACK))!==-1,audio:!!_,video:!!v,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:h})}else{var p;a||(a=[]);const _=a.find(T=>T instanceof cn),v=u?(p=this.localTrackMap.get(Te.LocalVideoTrack))===null||p===void 0?void 0:p.track:a.find(T=>T instanceof Ct);it.publish(this.store.sessionId,{eventElapse:Br.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:i,ec:s,audioName:_==null?void 0:_.getTrackLabel(),videoName:v==null?void 0:v.getTrackLabel(),screenshare:(v==null?void 0:v._hints.indexOf(Ln.SCREEN_TRACK))!==-1,audio:!!_,video:!!v,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:h})}}reportSubscribeEvent(i,s,a,u){const h=u===Qe.VIDEO?a._videoSSRC:a._audioSSRC;h&&it.subscribe(this.store.sessionId,{succ:i,ec:s,video:u===Qe.VIDEO,audio:u===Qe.AUDIO,peerid:a.uid,subscribeRequestid:u===Qe.VIDEO?a._videoSSRC:a._audioSSRC,p2pid:this.store.p2pId,eventElapse:Br.measureFromSubscribeStart(this.store.clientId,h)})}reset(){D.debug("[".concat(this.store.clientId,"] P2PChannel.reset")),this.mutex=new fr("P2PChannel-mutex"),this.connection&&(this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=this.store.useDataChannel?new qi({},this.store):this.isPlanB?new _r({},this.store):new Ki({},this.store),this.bindConnectionEvents(this.connection)),this.statsUploader.stopUploadUplinkStats(),this.statsUploader.stopUploadDownlinkStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const i=this.localTrackMap.get(Te.LocalAudioTrack);if((i==null?void 0:i.track)instanceof Ni){if(i.track.trackList.length>0){const s=i.track;i.track.trackList.forEach(a=>{s.removeAudioTrack(a)})}i.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.localDataChannels=[],this.remoteDataChannelMap.clear(),this.pendingLocalDataChannels=[],this.pendingRemoteDataChannels=[],this.state=Xt.Disconnected}getStats(){var i;return(i=this.connection)===null||i===void 0?void 0:i.getStats()}getRemoteVideoIsReady(i){var s;return((s=this.connection)===null||s===void 0?void 0:s.getRemoteVideoIsReady(i))||!1}getLocalAudioVolume(){const i=this.localTrackMap.get(Te.LocalAudioTrack);if(i)return i.track.getVolumeLevel()}getLocalVideoSize(){const i=this.localTrackMap.get(Te.LocalVideoTrack);if(i)return{width:i.track._videoWidth||0,height:i.track._videoHeight||0}}getEncoderConfig(i){const s=this.localTrackMap.get(i);return s&&s.track instanceof Ct||s&&s.track instanceof cn?s.track._encoderConfig:void 0}getLocalMedia(i){return this.localTrackMap.get(i)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(i,s){if(!i)return this.remoteUserMap.size>0;const a=this.remoteUserMap.get(i);return!!a&&(!s||a.has(s))}async hasRemoteMediaWithLock(i,s){if(!i)return this.remoteUserMap.size>0;const a=this.remoteUserMap.get(i);return!!a&&(!s||a.has(s))}getRemoteMedia(i){var s;const a=Array.from(Fs(s=this.remoteUserMap).call(s)).find(u=>u.uid===i);return a?{audioTrack:a.audioTrack,audioSSRC:a._audioSSRC,videoTrack:a.videoTrack,videoSSRC:a._videoSSRC}:{}}getAudioLevels(){let i=Array.from(this.remoteUserMap.entries()).map(a=>{let[u]=a;return{uid:u.uid,level:u.audioTrack?100*u.audioTrack._source.getAccurateVolumeLevel():0}});const s=this.localTrackMap.get(Te.LocalAudioTrack);return s&&i.push({level:100*s.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),i=Up(i).call(i,(a,u)=>a.level-u.level),i}async disconnectForReconnect(){this.connection&&(D.debug("[".concat(this.store.clientId,"] P2PChannel.disconnectForReconnect closing P2PConnection")),this.state=Xt.Reconnecting,te("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(i=>{let[s]=i;var a;s._videoTrack&&s._videoTrack._player&&((a=s._videoTrack._player.getVideoElement())===null||a===void 0||a.pause(),s._videoTrack._player.isKeepLastFrame=!0,s._videoTrack._originMediaStreamTrack.stop())}),this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0,this.shouldForwardP2PCreation&&(this.connection=this.store.useDataChannel?new qi({},this.store):this.isPlanB?new _r({},this.store):new Ki({},this.store),this.bindConnectionEvents(this.connection)),this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(i=>{var s;let[a,{track:u}]=i;switch(a){case Te.LocalVideoTrack:ot(s=u._hints).call(s,Ln.LOW_STREAM)?u.close():this.pendingLocalTracks.push(u);break;case Te.LocalAudioTrack:u instanceof Ni?this.pendingLocalTracks=this.pendingLocalTracks.concat(u.trackList):this.pendingLocalTracks.push(u);case Te.LocalVideoLowTrack:}}),this.emit(ut.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(i=>{let[s,a]=i;Array.from(Fs(a).call(a)).forEach(u=>{this.setPendingRemoteMedia(s,u)}),this.emit(ut.MediaReconnectStart,s.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.localDataChannels.length!==0&&(this.localDataChannels.forEach(i=>{this.pendingLocalDataChannels.push(i)}),this.localDataChannels.length=0),this.remoteDataChannelMap.size!==0&&(Array.from(this.remoteDataChannelMap.entries()).forEach(i=>{let[s,a]=i;Array.from(Fs(a).call(a)).forEach(u=>{this.setPendingRemoteDataChannel(s,u)})}),this.remoteDataChannelMap.clear()),this.statsUploader.stopUploadUplinkStats(),this.statsUploader.stopUploadDownlinkStats(),this.statsUploader.stopUploadTransportStats(),D.debug("[".concat(this.store.clientId,"] P2PChannel disconnected, waiting to reconnect.")))}hasPendingRemoteDataChannel(i,s){for(const a of this.pendingRemoteDataChannels){const{user:u,id:h}=a;if((i instanceof Wr?i.uid:i)===u.uid&&h===s)return!0}return!1}setPendingRemoteDataChannel(i,s){this.hasPendingRemoteDataChannel(i,s)||this.pendingRemoteDataChannels.push({user:i,id:s})}hasPendingRemoteMedia(i,s){for(const a of this.pendingRemoteTracks){const{user:u,kind:h}=a;if((i instanceof Wr?i.uid:i)===u.uid&&s===h)return!0}return!1}setPendingRemoteMedia(i,s){this.hasPendingRemoteMedia(i,s)||this.pendingRemoteTracks.push({user:i,kind:s})}restartICE(i){var s=this;return Ha(function*(){if(!s.connection||s.state!==Xt.Connected||s.connection instanceof qi)return;const a=yield en(s.mutex.lock("From P2PChannel.restartICE"));let u;try{u=yield en(s.connection.restartICE(i));const p=yield en(u.next());if(p.done)return;const _=p.value,v=yield _;switch(s.reportPCDisconnectedOrFailed(i),i){case Fr.TCP:s._pcStatsUploadType=rl.TCP_RESTART;break;case Fr.RELAY:s._pcStatsUploadType=rl.RELAY_RESTART;break;default:s._pcStatsUploadType=rl.OLD_RESTART}s._isInRestartIce=!0,u.next(v)}catch(p){var h;(h=u)===null||h===void 0||h.throw(p)}finally{a()}})()}getUplinkNetworkQuality(){if(!this.connection)return 0;const i=this.connection.getStats(),s=this.localTrackMap.get(Te.LocalVideoTrack),a=this.localTrackMap.get(Te.LocalAudioTrack),u=i.videoSend.find(B=>B.ssrc===(s==null?void 0:s.ssrcs[0].ssrcId)),h=i.audioSend.find(B=>B.ssrc===(a==null?void 0:a.ssrcs[0].ssrcId));if(!u||!h)return 1;const p=oo(this,ut.NeedSignalRTT),_=u?u.rttMs:void 0,v=h?h.rttMs:void 0,T=_&&v?(_+v)/2:_||v,b=(T&&p?(T+p)/2:T||p)||0,C=100*i.sendPacketLossRate*.7/50+.3*b/1500,N=C<.17?1:C<.36?2:C<.59?3:C<.1?4:5,x=s==null?void 0:s.track;if(x&&x._encoderConfig&&x._hints.indexOf(Ln.SCREEN_TRACK)===-1){const B=x._encoderConfig.bitrateMax,F=i.bitrate.actualEncoded;if(B&&F){const H=(1e3*B-F)/(1e3*B);return MW[H<.15?0:H<.3?1:H<.45?2:H<.6?3:4][N]}}return N}getDownlinkNetworkQuality(){if(!this.connection)return 0;const i=this.connection.getStats();let s=0;return Array.from(this.remoteUserMap.entries()).forEach(a=>{let[u]=a;const h=u._audioSSRC,p=u._videoSSRC,_=i.audioRecv.find(F=>F.ssrc===h),v=i.videoRecv.find(F=>F.ssrc===p);if(!_&&!v)return void(s+=1);const T=oo(this,ut.NeedSignalRTT),b=i.rtt,C=(b&&T?(b+T)/2:b||T)||0,N=_?_.jitterMs:void 0,x=i.recvPacketLossRate;let B=.7*x*100/50+.3*C/1500;N&&(B=.6*x*100/50+.2*C/1500+.2*N/400),s+=B<.1?1:B<.17?2:B<.36?3:B<.59?4:5}),this.remoteUserMap.size>0?Math.round(s/this.remoteUserMap.size):s}async muteLocalTrack(i){return new le((s,a)=>{this.handleMuteLocalTrack(i,s,a)})}filterTobePublishedTracks(i,s,a){const u=[],h=In(),p=this.getAllTracks();i=B_(i=i.filter(T=>p.indexOf(T)===-1));let _=!1,v=!1;for(const T of i){if(T instanceof Ct&&(this.localTrackMap.has(Te.LocalVideoTrack)||_?new Ee(z.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(u.push({track:T,type:Te.LocalVideoTrack}),_=!0),s)){const b=this.getLowVideoTrack(T,a);u.push({track:b,type:Te.LocalVideoLowTrack})}if(T instanceof cn){const b=this.localTrackMap.get(Te.LocalAudioTrack);if(b){if(!(b.track instanceof Ni))throw new Ee(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(T._bypassWebAudio)throw new Ee(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");b.track.addAudioTrack(T),this.bindLocalAudioTrackEvents(T,!0)}else if(v){const C=u.find(N=>{let{type:x}=N;return x===Te.LocalAudioTrack});if(!(C.track instanceof Ni))throw new Ee(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(T._bypassWebAudio)throw new Ee(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");C.track.addAudioTrack(T)}else{if(!h.webAudioMediaStreamDest||T instanceof Ni||T._bypassWebAudio)u.push({track:T,type:Te.LocalAudioTrack});else{const C=new Ni;C.addAudioTrack(T),u.push({track:C,type:Te.LocalAudioTrack})}v=!0}}}return u}filterTobeUnpublishedTracks(i){const s=[],a=this.getAllTracks();i=B_(i=i.filter(u=>a.indexOf(u)!==-1));for(const u of i){if(u instanceof cn){const h=this.localTrackMap.get(Te.LocalAudioTrack);if(!h)continue;h.track instanceof Ni?(h.track.removeAudioTrack(u),this.unbindLocalAudioTrackEvents(u),h.track.trackList.length===0&&(s.push([Te.LocalAudioTrack,h]),h.track.close())):s.push([Te.LocalAudioTrack,h])}if(u instanceof Ct){const h=this.localTrackMap.get(Te.LocalVideoTrack);if(!h)continue;s.push([Te.LocalVideoTrack,h]);const p=this.localTrackMap.get(Te.LocalVideoLowTrack);p&&s.push([Te.LocalVideoLowTrack,p])}}return s}filterTobePublishedDataChannels(i){return i=(i=B_(i)).filter(s=>this.localDataChannels.findIndex(a=>a.id===s.id)===-1)}filterTobeUnpublishedDataChannels(i){return i=(i=(i=B_(i)).filter(s=>this.localDataChannels.indexOf(s)!==-1)).filter(s=>s._originDataChannel)}bindLocalTrackEvents(i){i.forEach(s=>{let{track:a,type:u}=s;switch(u){case Te.LocalVideoTrack:a.addListener(qe.GET_STATS,this.handleGetLocalVideoStats),a.addListener(qe.GET_RTC_STATS,this.handleGetRTCStats),a.addListener(qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.addListener(qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.addListener(qe.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),a.addListener(qe.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),a.addListener(qe.NEED_REPLACE_TRACK,this.handleReplaceTrack),a.addListener(qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.addListener(qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Te.LocalAudioTrack:this.bindLocalAudioTrackEvents(a);case Te.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(i,s){i instanceof Ni?i.trackList.forEach(a=>{a.addListener(qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.addListener(qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.addListener(qe.GET_STATS,this.handleGetLocalAudioStats),a.addListener(qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.addListener(qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(i.addListener(qe.GET_STATS,this.handleGetLocalAudioStats),i.addListener(qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),i.addListener(qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),i.addListener(qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),i.addListener(qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),s||i.addListener(qe.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(i){i||(i=Array.from(this.localTrackMap.entries()).map(s=>{let[a,{track:u}]=s;return{track:u,type:a}})),i.forEach(s=>{let{track:a,type:u}=s;switch(u){case Te.LocalVideoTrack:a.off(qe.GET_STATS,this.handleGetLocalVideoStats),a.off(qe.GET_RTC_STATS,this.handleGetRTCStats),a.off(qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.off(qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.off(qe.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),a.off(qe.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),a.off(qe.NEED_REPLACE_TRACK,this.handleReplaceTrack),a.off(qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.off(qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Te.LocalAudioTrack:this.unbindLocalAudioTrackEvents(a);case Te.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(i){i instanceof Ni?i.trackList.forEach(s=>{s.off(qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.off(qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.off(qe.GET_STATS,this.handleGetLocalAudioStats),s.off(qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.off(qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(i.off(qe.GET_STATS,this.handleGetLocalAudioStats),i.off(qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),i.off(qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),i.off(qe.NEED_REPLACE_TRACK,this.handleReplaceTrack),i.off(qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),i.off(qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(i,s){s instanceof tu&&s.addListener(qe.GET_STATS,a=>{a(this.handleGetRemoteVideoStats(i))}),s instanceof _c&&s.addListener(qe.GET_STATS,a=>{a(this.handleGetRemoteAudioStats(i))})}unbindRemoteTrackEvents(i){i&&i.removeAllListeners(qe.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(i=>{let[s,a]=i;a.has(Qe.AUDIO)&&this.unbindRemoteTrackEvents(s._audioTrack),a.has(Qe.VIDEO)&&this.unbindRemoteTrackEvents(s._videoTrack)})}createGatewayPublishMessage(i,s){return i.map((a,u)=>{var h;let p,_,{track:v,type:T}=a;switch(T){case Te.LocalAudioTrack:p=gn.Audio,_={dtx:v instanceof Mh&&v._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case Te.LocalVideoTrack:p=ot(h=v._hints).call(h,Ln.SCREEN_TRACK)?gn.Screen:gn.High,_=Gh(Gh({},YI(v)),{},{codec:this.store.codec});break;case Te.LocalVideoLowTrack:p=gn.Low,_=Gh(Gh({},YI(v)),{},{codec:this.store.codec})}return{stream_type:p,attributes:_,ssrcs:s[u]}})}createGatewayUnpublishMessage(i){return i.map(s=>{var a;let u,[h,{track:p,ssrcs:_,id:v}]=s;switch(h){case Te.LocalVideoTrack:u=ot(a=p._hints).call(a,Ln.SCREEN_TRACK)?gn.Screen:gn.High;break;case Te.LocalAudioTrack:u=gn.Audio;break;case Te.LocalVideoLowTrack:u=gn.Low}return{stream_type:u,ssrcs:_,mid:v}})}assignLocalTracks(i,s){i.forEach((a,u)=>{let{track:h,type:p}=a;this.localTrackMap.set(p,{track:h,id:s[u].id,ssrcs:s[u].localSSRC})})}withdrawLocalTracks(i){i.forEach(s=>{let[a]=s;this.localTrackMap.delete(a)})}bindConnectionEvents(i){i.onConnectionStateChange=async s=>{if(D.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(s,")")),this.emit(ut.PeerConnectionStateChange,s),s!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),s==="connected"&&(this._restartTimer&&(clearTimeout(this._restartTimer),this._restartTimer=void 0),(this._isFirstConnected||this._isInRestartIce)&&this.reportPCStats(Date.now(),!0,this._pcStatsUploadType),this._isInRestartIce=!1,this._isFirstConnected=!1,this._isStartRestartIce=!1),te("NEW_ICE_RESTART")){var a;if(ot(a=this._restartStates).call(a,s)){if(this._isStartRestartIce)return;this._isStartRestartIce=!0;const u=_=>{(i.iceConnectionState==="disconnected"||i.iceConnectionState==="checking"||i.iceConnectionState==="failed")&&(D.debug("[".concat(this.store.clientId,"] [P2PChannel] start use restartICE, type is ").concat(_)),oo(this,ut.QueryClientConnectionState)==="CONNECTED"&&this.emit(ut.RequestRestartICE,_))},h=()=>{i.iceConnectionState!=="disconnected"&&i.iceConnectionState!=="checking"&&i.iceConnectionState!=="failed"||(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),D.debug("[".concat(this.store.clientId,"] P2PConnection disconnected timeout, force reconnect")),setTimeout(()=>this.emit(ut.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())},p=te("ICE_RESTART_INTERVAL");return void(this._restartTimer=window.setTimeout(()=>{if(te("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&In().supportPCSetConfiguration)u(Fr.RELAY),this._restartTimer=window.setTimeout(h,p);else if(jn())u(Fr.UDP),this._restartTimer=window.setTimeout(h,4e3);else{if(u(Fr.TCP),In().supportPCSetConfiguration)return void(this._restartTimer=window.setTimeout(()=>{u(Fr.RELAY),this._restartTimer=window.setTimeout(h,p)},p));this._restartTimer=window.setTimeout(h,p)}},800))}}else{if(s==="disconnected"&&i.iceConnectionState==="disconnected")return setTimeout(()=>{i.iceConnectionState==="disconnected"&&te("ICE_RESTART")&&oo(this,ut.QueryClientConnectionState)==="CONNECTED"&&this.emit(ut.RequestRestartICE)},800),void setTimeout(()=>{i.peerConnectionState==="disconnected"&&(D.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection disconnected timeout 4000ms, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isInRestartIce=!1,setTimeout(()=>this.emit(ut.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())},4e3);s==="failed"&&(D.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection state failed, force reconnect")),this.reportPCDisconnectedOrFailed(),setTimeout(()=>this.emit(ut.P2PLost),0),this.iceFailedCount+=1,await this.requestReconnect())}},i.onICEConnectionStateChange=s=>{s!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),D.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(s,")")),it.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:s,tag:Yn.TRACER}).onSuccess(),this.emit(ut.IceConnectionStateChange,s)},i.onICETransportStateChange=s=>{D.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(s,")"))},i.onDTLSTransportStateChange=s=>{D.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(s,")"))},i.onDTLSTransportError=s=>{D.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(s,")"))},i.onFirstAudioDecoded=s=>{var a;const u=Array.from(Fs(a=this.remoteUserMap).call(a)).find(p=>p._audioSSRC===s);var h;u&&(this.store.subscribe(u.uid,"audio",void 0,void 0,void 0,Date.now()),(h=u.audioTrack)===null||h===void 0||h.emit(Jp.FIRST_FRAME_DECODED),it.firstRemoteFrame(this.store.sessionId,rr.FIRST_AUDIO_DECODE,$n.FIRST_AUDIO_DECODE,{peer:u._uintid,subscribeElapse:Br.measureFromSubscribeStart(this.store.clientId,s),subscribeRequestid:s,p2pid:this.store.p2pId}))},i.onFirstAudioReceived=s=>{var a;const u=Array.from(Fs(a=this.remoteUserMap).call(a)).find(h=>h._audioSSRC===s);u&&it.firstRemoteFrame(this.store.sessionId,rr.FIRST_AUDIO_RECEIVED,$n.FIRST_AUDIO_RECEIVED,{peer:u._uintid,subscribeElapse:Br.measureFromSubscribeStart(this.store.clientId,s),subscribeRequestid:s,p2pid:this.store.p2pId})},i.onFirstVideoDecoded=(s,a,u)=>{this.reportVideoFirstFrameDecoded(s,a,u)},i.onFirstVideoReceived=s=>{var a;const u=Array.from(Fs(a=this.remoteUserMap).call(a)).find(h=>h._videoSSRC===s);u&&it.firstRemoteFrame(this.store.sessionId,rr.FIRST_VIDEO_RECEIVED,$n.FIRST_VIDEO_RECEIVED,{peer:u._uintid,subscribeElapse:Br.measureFromSubscribeStart(this.store.clientId,s),subscribeRequestid:s,p2pid:this.store.p2pId})},i.onSelectedLocalCandidateChanged=(s,a)=>{const u=s.candidateType==="relay",h=a.candidateType==="relay";a.candidateType!=="unknown"&&u===h||this.emit(ut.ConnectionTypeChange,u),D.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(Hh(a))," -> ").concat(JSON.stringify(Hh(s)),")"))},i.onSelectedRemoteCandidateChanged=(s,a)=>{D.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(Hh(a))," -> ").concat(JSON.stringify(Hh(s)),")"))},i.onFirstVideoDecodedTimeout=s=>{this.reportVideoFirstFrameDecoded(s,void 0,void 0,!0)}}unbindConnectionEvents(i){i.onConnectionStateChange=void 0,i.onICEConnectionStateChange=void 0,i.onICETransportStateChange=void 0,i.onDTLSTransportStateChange=void 0,i.onDTLSTransportError=void 0,i.onFirstAudioDecoded=void 0,i.onFirstAudioReceived=void 0,i.onFirstVideoDecoded=void 0,i.onFirstVideoReceived=void 0,i.onSelectedLocalCandidateChanged=void 0,i.onSelectedRemoteCandidateChanged=void 0,i.onFirstVideoDecodedTimeout=void 0}filterTobeMutedTracks(i){const s=[];if(this.getAllTracks().indexOf(i)===-1)return s;const a=this.localTrackMap.get(Te.LocalAudioTrack);if(i instanceof cn&&(a==null?void 0:a.track)instanceof Ni)return a.track.isActive||s.push([Te.LocalAudioTrack,a]),s;const u=Array.from(this.localTrackMap.entries()).find(h=>{let[,{track:p}]=h;return i===p});if(u&&(s.push(u),u[0]===Te.LocalVideoTrack)){const h=this.localTrackMap.get(Te.LocalVideoLowTrack);h&&s.push([Te.LocalVideoLowTrack,h])}return s}filterTobeUnmutedTracks(i){const s=[],a=this.localTrackMap.get(Te.LocalAudioTrack);if(i instanceof cn&&(a==null?void 0:a.track)instanceof Ni)return a.track.isActive&&s.push([Te.LocalAudioTrack,a]),s;const u=Array.from(this.localTrackMap.entries()).find(h=>{let[,{track:p}]=h;return i===p});if(u)if(u[0]===Te.LocalVideoTrack){s.push(u);const h=this.localTrackMap.get(Te.LocalVideoLowTrack);h&&s.push([Te.LocalVideoLowTrack,h])}else s.push(u);return s}createMuteMessage(i){return i.map(s=>{var a;let u,[h,{track:p,ssrcs:_,id:v}]=s;switch(h){case Te.LocalAudioTrack:u=gn.Audio;break;case Te.LocalVideoTrack:u=ot(a=p._hints).call(a,Ln.SCREEN_TRACK)?gn.Screen:gn.High;break;case Te.LocalVideoLowTrack:u=gn.Low}return{stream_type:u,ssrcs:_,mid:v}})}createUnmuteMessage(i){return i.map(s=>{var a;let u,[h,{track:p,ssrcs:_,id:v}]=s;switch(h){case Te.LocalAudioTrack:u=gn.Audio;break;case Te.LocalVideoTrack:u=ot(a=p._hints).call(a,Ln.SCREEN_TRACK)?gn.Screen:gn.High;break;case Te.LocalVideoLowTrack:u=gn.Low}return{stream_type:u,ssrcs:_,mid:v}})}filterTobeUnSubscribedTracks(i,s){const a=[],u=this.remoteUserMap.get(i);if(!u)return a;if(s){const h=u.get(s);if(!h)return a;a.push([i,{kind:s,id:h}])}else Array.from(u.entries()).forEach(h=>{let[p,_]=h;a.push([i,{kind:p,id:_}])});return a}filterTobeUnSubscribedDataChannels(i,s){const a=[];return s.forEach(u=>{var h;(h=this.remoteDataChannelMap.get(i))!==null&&h!==void 0&&h.has(u.id)&&a.push(u)}),a}createUnsubscribeMessage(i){const s=[];return i.forEach(a=>{let[u,{kind:h,id:p}]=a;switch(h){case Qe.VIDEO:return void(u._videoSSRC&&s.push({stream_type:Qe.VIDEO,ssrcId:u._videoSSRC}));case Qe.AUDIO:return void(u._audioSSRC&&s.push({stream_type:Qe.AUDIO,ssrcId:u._audioSSRC}))}}),s}createUnsubscribeAllMessage(i){const s=new Map;return i.forEach(a=>{let[u,{kind:h}]=a;if(s.has(u)){let p=s.get(u);h===Qe.VIDEO?p|=Ui.Video:p|=Ui.Audio,s.set(u,p)}else h===Qe.VIDEO?s.set(u,Ui.Video):s.set(u,Ui.Audio)}),{users:Array.from(s.entries()).map(a=>{let[u,h]=a;return{stream_id:u.uid,stream_type:h}})}}withdrawRemoteTracks(i){i.forEach(s=>{let[a,{kind:u}]=s;const h=this.remoteUserMap.get(a);h&&(h.delete(u),Array.from(h.entries()).length===0&&this.remoteUserMap.delete(a))})}async updateBitrateLimit(i){const s=this.localTrackMap.get(Te.LocalVideoTrack),a=this.localTrackMap.get(Te.LocalVideoLowTrack);s&&await s.track.setBitrateLimit(i.uplink),a&&i.low_stream_uplink&&await a.track.setBitrateLimit({max_bitrate:i.low_stream_uplink.bitrate,min_bitrate:i.low_stream_uplink.bitrate||0})}isP2PDisconnected(){return this.connection?this.connection.peerConnectionState!=="connected":!0}mapPubResToRemoteConfig(i,s){return i.map((a,u)=>{var h;let{stream_type:p}=a;return(h=s.find(_=>{let{stream_type:v}=_;return p===v}))===null||h===void 0?void 0:h.attributes})}async tryToUnmuteAudio(i){for(let a=0;a<i.length;a++)if(i[a]instanceof cn){var s;const u=this.filterTobeUnmutedTracks(i[a]);if(u.length===0)continue;await((s=this.connection)===null||s===void 0?void 0:s.unmuteLocal(u.map(p=>{let[,{id:_}]=p;return _})));const h=this.createUnmuteMessage(u);return void await bn(this,ut.RequestUnmuteLocal,h)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=i=>{var s;return!((s=this.connection)===null||s===void 0||!s.getRemoteVideoIsReady(i))},this.statsUploader.requestUpload=(i,s)=>this.emit(ut.RequestUploadStats,i,s),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await xr(aI(this.dtlsFailedCount,Oi)),this.emit(ut.RequestReconnect)}async reconnectP2P(){const i=Array.from(this.localTrackMap.entries()),s=this.createGatewayUnpublishMessage(i);Array.from(this.remoteUserMap.entries()),s.length>0&&await Qn(this,ut.RequestUnpublishForReconnectPC,s),this.disconnectForReconnect(),this.emit(ut.RequestReconnectPC)}canPublishLowStream(){return this.localTrackMap.has(Te.LocalVideoTrack)||this.pendingLocalTracks.some(i=>i instanceof Ct)}throwIfTrackTypeNotMatch(i){if(i.filter(s=>s instanceof Ct).length>1)throw new Ee(z.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(i.filter(s=>s instanceof cn).length>1&&(i.some(s=>s instanceof cn&&s._bypassWebAudio)||!In().webAudioMediaStreamDest))throw new Ee(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const s of i){if(s instanceof Ct&&this.pendingLocalTracks.some(a=>a instanceof Ct))throw new Ee(z.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(s instanceof cn&&this.pendingLocalTracks.some(a=>a instanceof cn)&&(!In().webAudioMediaStreamDest||s._bypassWebAudio||this.pendingLocalTracks.some(a=>a instanceof cn&&a._bypassWebAudio)))throw new Ee(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(i,s){const a=!te("DISABLE_DUAL_STREAM_USE_ENCODING")&&In().supportDualStreamEncoding,u=Gh(Gh({},{width:160,height:120,framerate:15,bitrate:50}),s);let h;h=a?i._mediaStreamTrack.clone():DU(i,u);const p=wn(8,"track-low-"),_=new Ct(h,Gh(Gh({},a&&{scaleResolutionDownBy:gU(u,i)}),{},{frameRate:u.framerate,bitrateMax:u.bitrate,bitrateMin:u.bitrate}),void 0,void 0,p);return _.on(Q_.TRANSCEIVER_UPDATED,v=>{i._updateRtpTransceiver(v,kh.LOW_STREAM)}),_._hints.push(Ln.LOW_STREAM),i.addListener(qe.NEED_CLOSE,()=>{_.close()}),_}async globalLock(){return this.mutex.lock("From P2PChannel.globalLock")}async reportPCStats(i,s,a){let u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(this.connection&&this.connection instanceof Ki){var h,p,_,v;const T=this.store.keyMetrics.descriptionStart||0,{iceConnectionState:b,dtlsTransportState:C,peerConnectionState:N}=this.connection,{local:x,remote:B}=await this.connection.getSelectedCandidatePair();it.pcStats(this.store.sessionId,{startTime:T,eventElapse:i-T||0,iceconnectionsate:b,dtlsstate:C,connectionstate:N,intSucc:s?1:2,error:u,selectedLocalCandidateProtocol:(h=x==null?void 0:x.protocol)!==null&&h!==void 0?h:"",selectedLocalCandidateType:(p=x.candidateType)!==null&&p!==void 0?p:"",selectedLocalCandidateAddress:"".concat(x.address,":").concat(x.port),selectedRemoteCandidateProtocol:(_=B.protocol)!==null&&_!==void 0?_:"",selectedRemoteCandidateType:(v=B.candidateType)!==null&&v!==void 0?v:"",selectedRemoteCandidateAddress:"".concat(B.address,":").concat(B.port),restartCnt:a})}}reportVideoFirstFrameDecoded(i,s,a,u){var h;const p=Array.from(Fs(h=this.remoteUserMap).call(h)).find(_=>_._videoSSRC===i);if(p){u||this.store.subscribe(p.uid,"video",void 0,void 0,void 0,void 0,Date.now());const _=this.store.keyMetrics,v=_.subscribe.find(T=>T.userId===p.uid&&T.type==="video");it.firstRemoteVideoDecode(this.store.sessionId,rr.FIRST_VIDEO_DECODE,$n.FIRST_VIDEO_DECODE,{peer:p._uintid,videowidth:s,videoheight:a,subscribeElapse:Br.measureFromSubscribeStart(this.store.clientId,i),subscribeRequestid:i,p2pid:this.store.p2pId,apEnd:_.requestAPEnd||0,apStart:_.requestAPStart||0,joinGwEnd:_.joinGatewayEnd||0,joinGwStart:_.joinGatewayStart||0,pcEnd:_.peerConnectionEnd||0,pcStart:_.peerConnectionStart||0,subscriberEnd:(v==null?void 0:v.subscribeEnd)||0,subscriberStart:(v==null?void 0:v.subscribeStart)||0,videoAddNotify:(v==null?void 0:v.streamAdded)||0,state:u?1:0})}}async remoteMediaSsrcChanged(i,s,a){if(!this.connection)return!1;const u=this.remoteUserMap.get(i);if(!u)return!1;const h=u.get(s);if(!h)return!1;const p=await this.connection.getRemoteSSRC(h);return p!==void 0&&p!==a}resetConnection(i){D.debug("[".concat(this.store.clientId,"] [P2PChannel] reset connection to ").concat(i)),this.state===Xt.Connected?(D.debug("[".concat(this.store.clientId,"] [P2PChannel] fallback to websocket but P2PChannel state still connected, disconnect first")),this.disconnectForReconnect()):(this.connection&&(this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=i===vI.datachannel?new qi({},this.store):this.isPlanB?new _r({},this.store):new Ki({},this.store),this.bindConnectionEvents(this.connection)))}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(i=>{let[s,{track:a}]=i;s===Te.LocalVideoLowTrack?a._updateRtpTransceiver(void 0,kh.LOW_STREAM):a._updateRtpTransceiver(void 0)})}reportPCDisconnectedOrFailed(i){this.connection&&this.connection instanceof Ki&&(this.connection.iceConnectionState!=="disconnected"&&this.connection.iceConnectionState!=="checking"&&this.connection.iceConnectionState!=="failed"||(this._isFirstConnected?(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isFirstConnected=!1):this._pcStatsUploadType===rl.TCP_RESTART&&i===Fr.RELAY?this.reportPCStats(Date.now(),!1,this._pcStatsUploadType):this.reportPCStats(Date.now(),!1,rl.DISCONNECTED_OR_FAILED)))}}function rs(o,i,s){const a=o[i];if(typeof a!="function")throw new Error("Cannot use mutex on object property.");return s.value=async function(){const u=this.mutex,h=await u.lock("From P2PChannel.".concat(i));try{for(var p=arguments.length,_=new Array(p),v=0;v<p;v++)_[v]=arguments[v];return await a.apply(this,_)}finally{h()}},s}function vde(o){let i=L$();return function(s,a){let u=s.appId;u!==void 0&&(fn(a,10),au(a,u));let h=s.cid;h!==void 0&&(fn(a,16),fn(a,h));let p=s.cname;p!==void 0&&(fn(a,26),au(a,p));let _=s.deviceId;_!==void 0&&(fn(a,34),au(a,_));let v=s.elapse;v!==void 0&&(fn(a,40),Kh(a,v));let T=s.fileSize;T!==void 0&&(fn(a,48),Kh(a,hE(T)));let b=s.height;b!==void 0&&(fn(a,56),Kh(a,hE(b)));let C=s.jpg;C!==void 0&&(fn(a,66),fn(a,C.length),function(jo,Ce){let ke=fE(jo,Ce.length);jo.bytes.set(Ce,ke)}(a,C));let N=s.networkType;N!==void 0&&(fn(a,72),Kh(a,hE(N)));let x=s.osType;x!==void 0&&(fn(a,80),Kh(a,hE(x)));let B=s.requestId;B!==void 0&&(fn(a,90),au(a,B));let F=s.sdkVersion;F!==void 0&&(fn(a,98),au(a,F));let H=s.sequence;H!==void 0&&(fn(a,104),Kh(a,hE(H)));let J=s.sid;J!==void 0&&(fn(a,114),au(a,J));let ee=s.timestamp;ee!==void 0&&(fn(a,120),Kh(a,ee));let se=s.uid;se!==void 0&&(fn(a,128),fn(a,se));let ye=s.vid;ye!==void 0&&(fn(a,136),fn(a,ye));let me=s.width;me!==void 0&&(fn(a,144),Kh(a,hE(me)));let ue=s.service;ue!==void 0&&(fn(a,152),fn(a,ue));let he=s.callbackData;he!==void 0&&(fn(a,162),au(a,he));let pe=s.jpgEncryption;pe!==void 0&&(fn(a,168),fn(a,pe));let Ve=s.requestType;Ve!==void 0&&(fn(a,176),fn(a,Ve));let Me=s.scorePorn;Me!==void 0&&(fn(a,185),VU(a,Me));let wt=s.scoreSexy;wt!==void 0&&(fn(a,193),VU(a,wt));let zt=s.scoreNeutral;zt!==void 0&&(fn(a,201),VU(a,zt));let si=s.scene;si!==void 0&&(fn(a,208),fn(a,si));let ji=s.ossFilePrefix;ji!==void 0&&(fn(a,218),au(a,ji));let Fn=s.serviceVendor;if(Fn!==void 0)for(let jo of Fn){fn(a,226);let Ce=L$();Tde(jo,Ce),fn(a,Ce.limit),Rde(a,Ce),Cde(Ce)}}(o,i),function(s){let a=s.bytes,u=s.limit;return a.length===u?a:a.subarray(0,u)}(i)}function yde(o){return function(s){let a={};e:for(;!M$(s);){let u=cu(s);switch(u>>>3){case 0:break e;case 1:a.code=cu(s);break;case 2:a.msg=U$(s,cu(s));break;case 3:{let h=bde(s);a.data=Sde(s),s.limit=h;break}default:D$(s,7&u)}}return a}({bytes:i=o,offset:0,limit:i.length});var i}function Sde(o){let i={};e:for(;!M$(o);){let s=cu(o);switch(s>>>3){case 0:break e;case 1:i.requestId=U$(o,cu(o));break;case 2:i.requestType=cu(o)>>>0;break;case 3:i.scorePorn=FU(o);break;case 4:i.scoreSexy=FU(o);break;case 5:i.scoreNeutral=FU(o);break;case 6:i.requestScene=cu(o)>>>0;break;case 7:i.scene=cu(o)>>>0;break;default:D$(o,7&s)}}return i}function Tde(o,i){let s=o.service;s!==void 0&&(fn(i,8),fn(i,s));let a=o.vendor;a!==void 0&&(fn(i,16),fn(i,a));let u=o.token;u!==void 0&&(fn(i,26),au(i,u));let h=o.callbackUrl;h!==void 0&&(fn(i,34),au(i,h))}function bde(o){let i=cu(o),s=o.limit;return o.limit=o.offset+i,s}function D$(o,i){switch(i){case 0:for(;128&j$(o););break;case 2:UU(o,cu(o));break;case 5:UU(o,4);break;case 1:UU(o,8);break;default:throw new Error("Unimplemented type: "+i)}}ve([rs,j("design:type",Function),j("design:paramtypes",[Object,Boolean]),j("design:returntype",le)],Er.prototype,"startP2PConnection",null),ve([rs,j("design:type",Function),j("design:paramtypes",[Object,Object,Array,Object,String,String]),j("design:returntype",le)],Er.prototype,"connect",null),ve([rs,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",void 0)],Er.prototype,"updateRemoteRTPCapabilities",null),ve([rs,j("design:type",Function),j("design:paramtypes",[Object,Object,Array,Object,String,String]),j("design:returntype",le)],Er.prototype,"preConnect",null),ve([rs,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",le)],Er.prototype,"publishDataChannel",null),ve([rs,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",le)],Er.prototype,"unpublish",null),ve([rs,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",le)],Er.prototype,"unpublishDataChannel",null),ve([rs,j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",le)],Er.prototype,"unpublishLowStream",null),ve([rs,j("design:type",Function),j("design:paramtypes",[Wr,Array]),j("design:returntype",le)],Er.prototype,"subscribeDataChannel",null),ve([rs,j("design:type",Function),j("design:paramtypes",[Wr,String,Number,Number,Array]),j("design:returntype",le)],Er.prototype,"subscribe",null),ve([rs,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",le)],Er.prototype,"massSubscribe",null),ve([rs,j("design:type",Function),j("design:paramtypes",[Wr,String,Boolean]),j("design:returntype",le)],Er.prototype,"unsubscribe",null),ve([rs,j("design:type",Function),j("design:paramtypes",[Wr,Array]),j("design:returntype",le)],Er.prototype,"unsubscribeDataChannel",null),ve([rs,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",le)],Er.prototype,"massUnsubscribe",null),ve([rs,j("design:type",Function),j("design:paramtypes",[Wr,String]),j("design:returntype",le)],Er.prototype,"muteRemote",null),ve([rs,j("design:type",Function),j("design:paramtypes",[Wr,String]),j("design:returntype",le)],Er.prototype,"unmuteRemote",null),ve([rs,j("design:type",Function),j("design:paramtypes",[Wr,String]),j("design:returntype",le)],Er.prototype,"hasRemoteMediaWithLock",null),ve([rs,j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",le)],Er.prototype,"disconnectForReconnect",null),ve([rs,j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",le)],Er.prototype,"updateBitrateLimit",null),ve([rs,j("design:type",Function),j("design:paramtypes",[Wr,String,Number]),j("design:returntype",le)],Er.prototype,"remoteMediaSsrcChanged",null);let wde=new Float32Array(1);new Uint8Array(wde.buffer);let MU=new Float64Array(1),po=new Uint8Array(MU.buffer);function hE(o){return{low:o|=0,high:o>>31,unsigned:o>=0}}let k$=[];function L$(){const o=k$.pop();return o?(o.offset=o.limit=0,o):{bytes:new Uint8Array(64),offset:0,limit:0}}function Cde(o){k$.push(o)}function UU(o,i){if(o.offset+i>o.limit)throw new Error("Skip past limit");o.offset+=i}function M$(o){return o.offset>=o.limit}function fE(o,i){let s=o.bytes,a=o.offset,u=o.limit,h=a+i;if(h>s.length){let p=new Uint8Array(2*h);p.set(s),o.bytes=p}return o.offset=h,h>u&&(o.limit=h),a}function jU(o,i){let s=o.offset;if(s+i>o.limit)throw new Error("Read past limit");return o.offset+=i,s}function U$(o,i){let s=jU(o,i),a=String.fromCharCode,u=o.bytes,h="�",p="";for(let _=0;_<i;_++){let v,T,b,C,N=u[_+s];128&N?(224&N)==192?_+1>=i?p+=h:(v=u[_+s+1],(192&v)!=128?p+=h:(C=(31&N)<<6|63&v,C<128?p+=h:(p+=a(C),_++))):(240&N)==224?_+2>=i?p+=h:(v=u[_+s+1],T=u[_+s+2],(49344&(v|T<<8))!=32896?p+=h:(C=(15&N)<<12|(63&v)<<6|63&T,C<2048||C>=55296&&C<=57343?p+=h:(p+=a(C),_+=2))):(248&N)==240?_+3>=i?p+=h:(v=u[_+s+1],T=u[_+s+2],b=u[_+s+3],(12632256&(v|T<<8|b<<16))!=8421504?p+=h:(C=(7&N)<<18|(63&v)<<12|(63&T)<<6|63&b,C<65536||C>1114111?p+=h:(C-=65536,p+=a(55296+(C>>10),56320+(1023&C)),_+=3))):p+=h:p+=a(N)}return p}function au(o,i){let s=i.length,a=0;for(let p=0;p<s;p++){let _=i.charCodeAt(p);_>=55296&&_<=56319&&p+1<s&&(_=(_<<10)+i.charCodeAt(++p)-56613888),a+=_<128?1:_<2048?2:_<65536?3:4}fn(o,a);let u=fE(o,a),h=o.bytes;for(let p=0;p<s;p++){let _=i.charCodeAt(p);_>=55296&&_<=56319&&p+1<s&&(_=(_<<10)+i.charCodeAt(++p)-56613888),_<128?h[u++]=_:(_<2048?h[u++]=_>>6&31|192:(_<65536?h[u++]=_>>12&15|224:(h[u++]=_>>18&7|240,h[u++]=_>>12&63|128),h[u++]=_>>6&63|128),h[u++]=63&_|128)}}function Rde(o,i){let s=fE(o,i.limit),a=o.bytes,u=i.bytes;for(let h=0,p=i.limit;h<p;h++)a[h+s]=u[h]}function j$(o){return o.bytes[jU(o,1)]}function F$(o,i){let s=fE(o,1);o.bytes[s]=i}function FU(o){let i=jU(o,8),s=o.bytes;return po[0]=s[i++],po[1]=s[i++],po[2]=s[i++],po[3]=s[i++],po[4]=s[i++],po[5]=s[i++],po[6]=s[i++],po[7]=s[i++],MU[0]}function VU(o,i){let s=fE(o,8),a=o.bytes;MU[0]=i,a[s++]=po[0],a[s++]=po[1],a[s++]=po[2],a[s++]=po[3],a[s++]=po[4],a[s++]=po[5],a[s++]=po[6],a[s++]=po[7]}function cu(o){let i,s=0,a=0;do i=j$(o),s<32&&(a|=(127&i)<<s),s+=7;while(128&i);return a}function fn(o,i){for(i>>>=0;i>=128;)F$(o,127&i|128),i>>>=7;F$(o,i)}function Kh(o,i){let s=i.low>>>0,a=(i.low>>>28|i.high<<4)>>>0,u=i.high>>>24,h=u===0?a===0?s<16384?s<128?1:2:s<1<<21?3:4:a<16384?a<128?5:6:a<1<<21?7:8:u<128?9:10,p=fE(o,h),_=o.bytes;switch(h){case 10:_[p+9]=u>>>7&1;case 9:_[p+8]=h!==9?128|u:127&u;case 8:_[p+7]=h!==8?a>>>21|128:a>>>21&127;case 7:_[p+6]=h!==7?a>>>14|128:a>>>14&127;case 6:_[p+5]=h!==6?a>>>7|128:a>>>7&127;case 5:_[p+4]=h!==5?128|a:127&a;case 4:_[p+3]=h!==4?s>>>21|128:s>>>21&127;case 3:_[p+2]=h!==3?s>>>14|128:s>>>14&127;case 2:_[p+1]=h!==2?s>>>7|128:s>>>7&127;case 1:_[p]=h!==1?128|s:127&s}}function V$(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}const Ide=new Map([["moderation",1],["supervise",2]]);class fA extends Hn{get connectionState(){return this._connectionState}set connectionState(i){if(this._connectionState===i)return;const s=this._connectionState;this._connectionState=i,this.emit(Gi.CONNECTION_STATE_CHANGE,s,i)}get inspectType(){return this._inspectType}set inspectType(i){var s;this._inspectMode=zp(s=i.map(a=>Ide.get(a)||0)).call(s,(a,u)=>a+u),this._inspectType=i}get quality(){return this._quality}set quality(i){this._quality=i>1?1:i<.1?.1:i,this.qualityTimer&&(window.clearTimeout(this.qualityTimer),this.qualityTimer=null),this._quality>=1||(this.qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this.qualityRatio},6e4))}constructor(i){super(),O(this,"name","AgoraRTCVideoContentInspect"),O(this,"_connectionState",oa.CONNECTING),O(this,"_innerConnectionState",void 0),O(this,"sequence",0),O(this,"inspectStartTime",void 0),O(this,"workerManagerConnection",void 0),O(this,"workerConnection",void 0),O(this,"workerMessageLengthLimit",void 0),O(this,"inspectIntervalMinimum",void 0),O(this,"qualityRatio",void 0),O(this,"_connectInfo",void 0),O(this,"_cancelTokenSource",ao.CancelToken.source()),O(this,"_retryConfig",void 0),O(this,"wmSequence",0),O(this,"inspectInterval",void 0),O(this,"inspectTimer",null),O(this,"ossFilePrefix",void 0),O(this,"extraInfo",void 0),O(this,"_inspectType",void 0),O(this,"_inspectMode",void 0),O(this,"_quality",1),O(this,"qualityTimer",null),O(this,"_inspectId",void 0),O(this,"_needWorkUrlOnly",!1),O(this,"inspectImage",()=>{if(this.connectionState!==oa.CONNECTED)throw new ae(z.OPERATION_ABORTED,"content inspect service connection status is ".concat(this.connectionState));this.inspectTimer&&(window.clearInterval(this.inspectTimer),this.inspectTimer=null),this.inspectTimer=window.setInterval(()=>{this.connectionState===oa.CONNECTED?this.requestToInspectImage():D.debug("[".concat(this._inspectId,"] Inspect State is not connected , "),this.connectionState)},this.inspectInterval<this.inspectIntervalMinimum?this.inspectIntervalMinimum:this.inspectInterval),this.requestToInspectImage()}),this._inspectId=wn(5,"inspect-"),this.workerMessageLengthLimit=te("VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT"),this.inspectIntervalMinimum=te("VIDEO_INSPECT_INTERVAL_MINIMUM"),this.qualityRatio=te("VIDEO_INSPECT_QUALITY_RATIO"),this.inspectInterval=i.interval,this.ossFilePrefix=i.ossFilePrefix,this.extraInfo=i.extraInfo,this.inspectType=i.inspectType,this.inspectStartTime=Number(Date.now()),this.workerManagerConnection=new J0("worker-manager-"+this._inspectId,Oi),this.on(Gi.STATE_CHANGE,(s,a)=>{this._innerConnectionState=s,D.debug("[".concat(this._inspectId,"] Inspect operation :").concat(aa[s]," ").concat(a||""))}),this.handleWorkerManagerEvents(),this.workerConnection=new J0("worker-"+this._inspectId,Oi),this.handleWorkerEvents()}async init(i,s){this.emit(Gi.STATE_CHANGE,aa.CONNECT_AP),this._connectInfo=i;const a=this._cancelTokenSource.token;return this._retryConfig=s,new le((u,h)=>{this.on(Gi.CONNECTION_STATE_CHANGE,(p,_)=>{_===oa.CONNECTED&&u()}),this.requestAP(i,a,s).then(p=>{this.connectWorkerManager(p)}).catch(p=>{h(p)})})}async requestAP(i,s,a){const u=te("WEBCS_DOMAIN").map(_=>"https://".concat(_,"/api/v1")),h=await function(_,v,T,b){let{appId:C,areaCode:N,cname:x,sid:B,token:F,uid:H}=v;lE++;const J="image_moderation_api",ee={service_name:J,json_body:JSON.stringify({appId:C,areaCode:N,cname:x,command:"allocateEdge",requestId:lE,seq:lE,sid:B,token:F,ts:Date.now(),uid:H+""})};let se,ye,me=_[0];return nl(async()=>{se=Date.now();const ue=await pd(me,{data:ee,cancelToken:T,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(ye=Date.now()-se,ue.code!==0){const Me=new ae(z.UNEXPECTED_RESPONSE,"image inspect ap error, code"+ue.code,{retry:!0,responseTime:ye});throw D.error(Me.toString()),Me}const he=JSON.parse(ue.json_body);if(he.code!==200){const Me=new ae(z.UNEXPECTED_RESPONSE,"image inspect ap error, code: ".concat(he.code,", reason: ").concat(he.reason),{code:he.code,responseTime:ye});throw D.error(Me.toString()),Me}if(!he.servers||!Array.isArray(he.servers)||he.servers.length===0){const Me=new ae(z.UNEXPECTED_RESPONSE,"image inspect ap empty server",{code:he.code,responseTime:ye});throw D.error(Me.toString()),Me}const pe=te("VIDEO_INSPECT_WORKER_MANAGER_HOST"),Ve=te("VIDEO_INSPECT_WORKER_MANAGER_PORT");return{addressList:he.servers.map(Me=>{let{address:wt,wss:zt}=Me;if(wt&&zt)return"wss://".concat(wt.replace(/\./g,"-"),".").concat(pe,":").concat(Ve||zt)}).filter(Me=>!!Me),workerToken:he.workerToken,vid:he.vid,responseTime:ye}},(ue,he)=>(it.apworkerEvent(B,{success:!0,sc:200,serviceName:J,responseDetail:JSON.stringify(ue.addressList),firstSuccess:he===0,responseTime:ye,serverIp:_[he%_.length]}),!1),(ue,he)=>(it.apworkerEvent(B,{success:!1,sc:ue.data&&ue.data.code||200,serviceName:J,responseTime:ye,serverIp:_[he%_.length]}),!!(ue.code!==z.OPERATION_ABORTED&&ue.code!==z.UNEXPECTED_RESPONSE||ue.data&&ue.data.retry)&&(me=_[(he+1)%_.length],!0)),b)}(u,i,s,a);this.emit(Gi.STATE_CHANGE,aa.AP_CONNECTED);const{addressList:p}=h;return this.wmSequence++,p}async connectWorkerManager(i){let s=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this._needWorkUrlOnly=s,this.emit(Gi.STATE_CHANGE,aa.CONNECT_WORKER_MANAGER),await this.workerManagerConnection.init(i,1e4)}async connectWorker(i){await this.workerConnection.init([i])}handleWorkerManagerEvents(){this.workerManagerConnection.on(mt.CONNECTED,async()=>{this.emit(Gi.STATE_CHANGE,aa.WORKER_MANAGER_CONNECTED,this.workerManagerConnection.url),this.workerManagerConnection.sendMessage({appId:this._connectInfo.appId,cname:this._connectInfo.cname,uid:this._connectInfo.uid+"",sdkVersion:"4.19.3",sid:this._connectInfo.sid,seq:this.wmSequence,ts:Number(Date.now()),requestId:Math.floor(1e12*Math.random()),allocate:!0,clientRequest:{command:"join"}},!0)}),this.workerManagerConnection.on(mt.CLOSED,()=>{this._innerConnectionState<aa.GET_WORKER_MANAGER_RESPONSE&&D.debug("[".concat(this._inspectId,"] Inspect worker manager is closed before connecting worker"))}),this.workerManagerConnection.on(mt.FAILED,()=>{this._innerConnectionState<aa.GET_WORKER_MANAGER_RESPONSE&&D.debug("[".concat(this._inspectId,"] Connecting inspect worker manager is failed before connecting worker"))}),this.workerManagerConnection.on(mt.RECONNECTING,()=>{this._innerConnectionState<aa.GET_WORKER_MANAGER_RESPONSE&&D.debug("[".concat(this._inspectId,"] Inspect worker manager is reconnecting before connecting worker"))}),this.workerManagerConnection.on(mt.ON_MESSAGE,async i=>{this.emit(Gi.STATE_CHANGE,aa.GET_WORKER_MANAGER_RESPONSE);const s=this.workerManagerConnection.url;this.workerManagerConnection.close();const a=JSON.parse(i.data);if(a.code!==200)throw D.error("[".concat(this._inspectId,"] Unexpected code ").concat(a.code," from worker manager")),new ae(z.UNEXPECTED_RESPONSE,"response code of worker is unexpected",a);if(!(a.serverResponse&&a.serverResponse.portWss&&s))throw D.error("[".concat(this._inspectId,"] Unexpected content from worker manager : ").concat(JSON.stringify(a))),new ae(z.UNEXPECTED_RESPONSE,"response content of worker is unexpected",a);{const u=te("VIDEO_INSPECT_WORKER_PORT")||a.serverResponse.portWss,h=s.replace(/:\d+\/?$/,":".concat(u));this.emit(Gi.STATE_CHANGE,aa.CONNECT_WORKER,h),this._needWorkUrlOnly?this.emit(Gi.REQUEST_NEW_WORKER_URL,h):await this.connectWorker(h)}}),this.workerManagerConnection.on(mt.WILL_RECONNECT,(i,s,a)=>{a(i)}),this.workerManagerConnection.on(mt.REQUEST_NEW_URLS,(i,s)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(i).catch(s)})}handleWorkerEvents(){this.workerConnection.on(mt.CONNECTED,async()=>{this.emit(Gi.STATE_CHANGE,aa.WORKER_CONNECTED,this.workerConnection.url),this.connectionState=oa.CONNECTED}),this.workerConnection.on(mt.ON_MESSAGE,async i=>{if(i.data instanceof ArrayBuffer){const a=yde(new Uint8Array(i.data));if(te("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")&&D.debug("[".concat(this._inspectId,"] Response message for worker of inspect content "),JSON.stringify(a)),a.code===200){if(Array.isArray(this.inspectType)&&this.inspectType.length===1&&this.inspectType[0]==="supervise")return void this.emit(Gi.INSPECT_RESULT,void 0,void 0);if(a.data&&a.data.scorePorn&&a.data.scoreSexy&&a.data.scoreNeutral){var s;const u={porn:a.data.scorePorn,sexy:a.data.scoreSexy,neutral:a.data.scoreNeutral},h=zp(s=Object.keys(u)).call(s,(_,v)=>u[_]>u[v]?_:v,"porn"),p=Object.keys(u).find(_=>_===h);this.emit(Gi.INSPECT_RESULT,p)}else this.emit(Gi.INSPECT_RESULT,void 0,new ae(z.UNEXPECTED_RESPONSE,a.code+"","There is an unexpected data on message"))}else this.emit(Gi.INSPECT_RESULT,void 0,new ae(z.UNEXPECTED_RESPONSE,a.code+"",a.msg))}else D.error("[".concat(this._inspectId,"] Unexpected message type from worker")),this.emit(Gi.INSPECT_RESULT,void 0,new ae(z.UNEXPECTED_RESPONSE,"invalid worker message type"))}),this.workerConnection.on(mt.CLOSED,()=>{this.connectionState=oa.CLOSED}),this.workerConnection.on(mt.FAILED,()=>{this.connectionState=oa.CLOSED}),this.workerConnection.on(mt.RECONNECTING,()=>{this.connectionState=this.connectionState===oa.CONNECTED?oa.RECONNECTING:oa.CONNECTING}),this.workerConnection.on(mt.WILL_RECONNECT,(i,s,a)=>{i==="recover"&&a(i),a("tryNext")}),this.workerConnection.on(mt.REQUEST_NEW_URLS,(i,s)=>{this.workerManagerConnection.close(),this.once(Gi.REQUEST_NEW_WORKER_URL,a=>{i([a])}),this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(a=>{this.connectWorkerManager(a,!0)}).catch(a=>{s(a)})})}static intToLong(i){return{low:i|=0,high:i>>31,unsigned:i>=0}}async requestToInspectImage(){this.sequence++;const i=oo(this,Gi.CLIENT_LOCAL_VIDEO_TRACK),s={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(i){if(!i.isPlaying)return void this.emit(Gi.INSPECT_RESULT,void 0,new ae(z.INVALID_OPERATION,"Only the track being played can be inspected"));const a=await this.generateRequestData(i,s);this.workerConnection.sendMessage(a,!0,!0)}else this.emit(Gi.INSPECT_RESULT,void 0,new ae(z.INVALID_OPERATION,"Only the track being published can be inspected"))}async generateRequestData(i,s){let{appId:a,cname:u,cid:h,vid:p,sid:_,uid:v}=s;const T=Date.now(),b=await i.getCurrentFrameImage("image/jpeg",this.quality),C=await P7(b,a,u),N=this.sequence+"-"+h+"-"+v+"-"+T+"-"+wn(12,""),x={appId:a,cid:h,cname:u,deviceId:"",elapse:fA.intToLong(Number(T-this.inspectStartTime)),fileSize:C.byteLength,jpgEncryption:2,height:b.height,width:b.width,jpg:C,networkType:6,osType:7,requestId:N,sdkVersion:"4.19.3",sequence:this.sequence,sid:_,timestamp:fA.intToLong(T),uid:v,vid:p,service:this._inspectMode,callbackData:this.extraInfo,ossFilePrefix:this.ossFilePrefix};this.extraInfo===void 0&&delete x.callbackData,this.ossFilePrefix===void 0&&delete x.ossFilePrefix;const B=vde(x);if(B.byteLength<this.workerMessageLengthLimit){if(te("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")){const F=function(H){for(var J=1;J<arguments.length;J++){var ee=arguments[J]!=null?arguments[J]:{};J%2?V$(Object(ee),!0).forEach(function(se){O(H,se,ee[se])}):Object.getOwnPropertyDescriptors?Object.defineProperties(H,Object.getOwnPropertyDescriptors(ee)):V$(Object(ee)).forEach(function(se){Object.defineProperty(H,se,Object.getOwnPropertyDescriptor(ee,se))})}return H}({},x);delete F.jpg,D.debug("[".concat(this._inspectId,"] Request message for worker of inspect content "),JSON.stringify(F))}return B}{const F=this.quality*this.qualityRatio;return this.quality=F,await this.generateRequestData(i,{appId:a,cname:u,cid:h,vid:p,sid:_,uid:v})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=ao.CancelToken.source(),this.workerManagerConnection&&this.workerManagerConnection.close(),this.workerConnection&&this.workerConnection.close(),this.inspectTimer&&window.clearInterval(this.inspectTimer),this.inspectTimer=null,this.connectionState=oa.CLOSED,this.emit(Gi.STATE_CHANGE,aa.CLOSED)}}function Ade(o){let i=function(){const s=Pde.pop();return s?(s.offset=s.limit=0,s):{bytes:new Uint8Array(64),offset:0,limit:0}}();return function(s,a){let u=s.appId;u!==void 0&&(Pi(a,10),um(a,u));let h=s.cid;h!==void 0&&(Pi(a,16),Pi(a,h));let p=s.cname;p!==void 0&&(Pi(a,26),um(a,p));let _=s.deviceId;_!==void 0&&(Pi(a,34),um(a,_));let v=s.elapse;v!==void 0&&(Pi(a,40),qh(a,v));let T=s.fileSize;T!==void 0&&(Pi(a,48),qh(a,pE(T)));let b=s.height;b!==void 0&&(Pi(a,56),qh(a,pE(b)));let C=s.jpg;C!==void 0&&(Pi(a,66),Pi(a,C.length),W$(a,C));let N=s.networkType;N!==void 0&&(Pi(a,72),qh(a,pE(N)));let x=s.osType;x!==void 0&&(Pi(a,80),qh(a,pE(x)));let B=s.requestId;B!==void 0&&(Pi(a,90),um(a,B));let F=s.sdkVersion;F!==void 0&&(Pi(a,98),um(a,F));let H=s.sequence;H!==void 0&&(Pi(a,104),qh(a,pE(H)));let J=s.sid;J!==void 0&&(Pi(a,114),um(a,J));let ee=s.timestamp;ee!==void 0&&(Pi(a,120),qh(a,ee));let se=s.uid;se!==void 0&&(Pi(a,128),Pi(a,se));let ye=s.vid;ye!==void 0&&(Pi(a,136),Pi(a,ye));let me=s.width;me!==void 0&&(Pi(a,144),qh(a,pE(me)));let ue=s.service;ue!==void 0&&(Pi(a,152),Pi(a,ue));let he=s.callbackData;he!==void 0&&(Pi(a,162),Pi(a,he.length),W$(a,he));let pe=s.ticket;pe!==void 0&&(Pi(a,170),um(a,pe))}(o,i),function(s){let a=s.bytes,u=s.limit;return a.length===u?a:a.subarray(0,u)}(i)}function Ode(o){return function(s){let a={};e:for(;!xde(s);){let u=TS(s);switch(u>>>3){case 0:break e;case 1:a.code=TS(s);break;case 2:a.msg=H$(s,TS(s));break;case 3:a.requestId=H$(s,TS(s));break;case 4:a.timestamp=Dde(s,!1);break;default:Nde(s,7&u)}}return a}({bytes:i=o,offset:0,limit:i.length});var i}function Nde(o,i){switch(i){case 0:for(;128&Tc(o););break;case 2:BU(o,TS(o));break;case 5:BU(o,4);break;case 1:BU(o,8);break;default:throw new Error("Unimplemented type: "+i)}}function pE(o){return{low:o|=0,high:o>>31,unsigned:o>=0}}let Pde=[];function BU(o,i){if(o.offset+i>o.limit)throw new Error("Skip past limit");o.offset+=i}function xde(o){return o.offset>=o.limit}function pA(o,i){let s=o.bytes,a=o.offset,u=o.limit,h=a+i;if(h>s.length){let p=new Uint8Array(2*h);p.set(s),o.bytes=p}return o.offset=h,h>u&&(o.limit=h),a}function B$(o,i){let s=o.offset;if(s+i>o.limit)throw new Error("Read past limit");return o.offset+=i,s}function W$(o,i){let s=pA(o,i.length);o.bytes.set(i,s)}function H$(o,i){let s=B$(o,i),a=String.fromCharCode,u=o.bytes,h="�",p="";for(let _=0;_<i;_++){let v,T,b,C,N=u[_+s];128&N?(224&N)==192?_+1>=i?p+=h:(v=u[_+s+1],(192&v)!=128?p+=h:(C=(31&N)<<6|63&v,C<128?p+=h:(p+=a(C),_++))):(240&N)==224?_+2>=i?p+=h:(v=u[_+s+1],T=u[_+s+2],(49344&(v|T<<8))!=32896?p+=h:(C=(15&N)<<12|(63&v)<<6|63&T,C<2048||C>=55296&&C<=57343?p+=h:(p+=a(C),_+=2))):(248&N)==240?_+3>=i?p+=h:(v=u[_+s+1],T=u[_+s+2],b=u[_+s+3],(12632256&(v|T<<8|b<<16))!=8421504?p+=h:(C=(7&N)<<18|(63&v)<<12|(63&T)<<6|63&b,C<65536||C>1114111?p+=h:(C-=65536,p+=a(55296+(C>>10),56320+(1023&C)),_+=3))):p+=h:p+=a(N)}return p}function um(o,i){let s=i.length,a=0;for(let p=0;p<s;p++){let _=i.charCodeAt(p);_>=55296&&_<=56319&&p+1<s&&(_=(_<<10)+i.charCodeAt(++p)-56613888),a+=_<128?1:_<2048?2:_<65536?3:4}Pi(o,a);let u=pA(o,a),h=o.bytes;for(let p=0;p<s;p++){let _=i.charCodeAt(p);_>=55296&&_<=56319&&p+1<s&&(_=(_<<10)+i.charCodeAt(++p)-56613888),_<128?h[u++]=_:(_<2048?h[u++]=_>>6&31|192:(_<65536?h[u++]=_>>12&15|224:(h[u++]=_>>18&7|240,h[u++]=_>>12&63|128),h[u++]=_>>6&63|128),h[u++]=63&_|128)}}function Tc(o){return o.bytes[B$(o,1)]}function $$(o,i){let s=pA(o,1);o.bytes[s]=i}function TS(o){let i,s=0,a=0;do i=Tc(o),s<32&&(a|=(127&i)<<s),s+=7;while(128&i);return a}function Pi(o,i){for(i>>>=0;i>=128;)$$(o,127&i|128),i>>>=7;$$(o,i)}function Dde(o,i){let s,a=0,u=0,h=0;return s=Tc(o),a=127&s,128&s&&(s=Tc(o),a|=(127&s)<<7,128&s&&(s=Tc(o),a|=(127&s)<<14,128&s&&(s=Tc(o),a|=(127&s)<<21,128&s&&(s=Tc(o),u=127&s,128&s&&(s=Tc(o),u|=(127&s)<<7,128&s&&(s=Tc(o),u|=(127&s)<<14,128&s&&(s=Tc(o),u|=(127&s)<<21,128&s&&(s=Tc(o),h=127&s,128&s&&(s=Tc(o),h|=(127&s)<<7))))))))),{low:a|u<<28,high:u>>>4|h<<24,unsigned:i}}function qh(o,i){let s=i.low>>>0,a=(i.low>>>28|i.high<<4)>>>0,u=i.high>>>24,h=u===0?a===0?s<16384?s<128?1:2:s<1<<21?3:4:a<16384?a<128?5:6:a<1<<21?7:8:u<128?9:10,p=pA(o,h),_=o.bytes;switch(h){case 10:_[p+9]=u>>>7&1;case 9:_[p+8]=h!==9?128|u:127&u;case 8:_[p+7]=h!==8?a>>>21|128:a>>>21&127;case 7:_[p+6]=h!==7?a>>>14|128:a>>>14&127;case 6:_[p+5]=h!==6?a>>>7|128:a>>>7&127;case 5:_[p+4]=h!==5?128|a:127&a;case 4:_[p+3]=h!==4?s>>>21|128:s>>>21&127;case 3:_[p+2]=h!==3?s>>>14|128:s>>>14&127;case 2:_[p+1]=h!==2?s>>>7|128:s>>>7&127;case 1:_[p]=h!==1?128|s:127&s}}const z$={},G$={},mA=4294967296,K$=mA*mA,q$=K$/2,WU=X$(0,!0),Y$=X$(0),kde=mE(0,-2147483648,!1),Lde=mE(-1,2147483647,!1),Mde=mE(-1,-1,!0);function X$(o,i){let s,a,u;return i?(u=0<=(o>>>=0)&&o<256)&&(a=G$[o],a)?a:(s=mE(o,0,!0),u&&(G$[o]=s),s):(u=-128<=(o|=0)&&o<128)&&(a=z$[o],a)?a:(s=mE(o,o<0?-1:0,!1),u&&(z$[o]=s),s)}function mE(o,i,s){return{low:0|o,high:0|i,unsigned:!!s}}function Ude(o,i){if(isNaN(o))return i?WU:Y$;if(i){if(o<0)return WU;if(o>=K$)return Mde}else{if(o<=-q$)return kde;if(o+1>=q$)return Lde}return o<0?i?WU:Y$:mE(o%mA|0,o/mA|0,i)}function J$(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}class HU extends Hn{get connectionState(){return this._connectionState}set connectionState(i){if(this._connectionState===i)return;const s=this._connectionState;this._connectionState=i,this.emit(Fa.CONNECTION_STATE_CHANGE,i,s)}get quality(){return this._quality}set quality(i){this._quality=i>1?1:i<.1?.1:i,this._qualityTimer&&(window.clearTimeout(this._qualityTimer),this._qualityTimer=null),this._quality>=1||(this._qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this._qualityRatio},6e4))}constructor(i){var s;super(),O(this,"name","AgoraRTCImageModeration"),O(this,"_connectionState",Lo.CONNECTING),O(this,"_sequence",0),O(this,"_moderationStartTime",void 0),O(this,"_workerConnection",void 0),O(this,"_workerMessageLengthLimit",void 0),O(this,"_qualityRatio",void 0),O(this,"_connectInfo",void 0),O(this,"_cancelTokenSource",ao.CancelToken.source()),O(this,"_retryConfig",void 0),O(this,"_moderationInterval",void 0),O(this,"_moderationTimer",null),O(this,"_moderationMode",1),O(this,"_quality",1),O(this,"_qualityTimer",null),O(this,"_ticket",void 0),O(this,"_moderationIntervalMinimum",void 0),O(this,"_uploadFailedNum",0),O(this,"_uploadNum",0),O(this,"_uploadTimer",null),O(this,"_moderationId",void 0),O(this,"inspectImage",()=>{if(this.connectionState!==Lo.CONNECTED)throw new ae(z.OPERATION_ABORTED,"image moderation service connection status is ".concat(this.connectionState));this._moderationTimer&&(window.clearInterval(this._moderationTimer),this._moderationTimer=null),this._moderationTimer=window.setInterval(()=>{this.connectionState===Lo.CONNECTED?this.requestToInspectImage():D.debug("[".concat(this._moderationId,"] Moderation State is not connected , "),this.connectionState)},this._moderationInterval<this._moderationIntervalMinimum?this._moderationIntervalMinimum:this._moderationInterval),this.requestToInspectImage()}),this._moderationId=wn(5,"image-moderation-"),this._workerMessageLengthLimit=te("IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT"),this._moderationIntervalMinimum=te("IMAGE_MODERATION_INTERVAL_MINIMUM"),this._moderationInterval=(s=i.interval)!==null&&s!==void 0?s:1e3,this._qualityRatio=te("IMAGE_MODERATION_QUALITY_RATIO"),this._moderationStartTime=Number(Date.now()),this._workerConnection=new J0("worker-"+this._moderationId,Oi),this.on(Fa.STATE_CHANGE,(a,u)=>{D.debug("[".concat(this._moderationId,"] Moderation operation :").concat(Dh[a]," ").concat(u||""))}),this.handleWorkerEvents()}async init(i,s){this.emit(Fa.STATE_CHANGE,Dh.CONNECT_AP),this._connectInfo=i;const a=this._cancelTokenSource.token;return this._retryConfig=s,new le((u,h)=>{this.on(Fa.CONNECTION_STATE_CHANGE,(p,_)=>{p===Lo.CONNECTED&&u()}),this.requestAP(i,a,s).then(p=>{this.connectWorker(p)}).catch(p=>{h(p)})})}updateConfig(i){var s;this._moderationInterval=(s=i.interval)!==null&&s!==void 0?s:1e3,D.debug("[".concat(this._moderationId,"] updateConfig: ").concat(JSON.stringify(i))),this.connectionState===Lo.CONNECTED&&this.inspectImage()}async requestAP(i,s,a){const u=te("WEBCS_DOMAIN").map(v=>"https://".concat(v,"/api/v1")),h=await function(v,T,b,C){let{appId:N,areaCode:x,cname:B,sid:F,token:H,uid:J}=T;lE++;const ee="moderation_plugin",se={service_name:ee,json_body:JSON.stringify({appId:N,areaCode:x,cname:B,command:"allocateEdge",requestId:lE,seq:lE,sid:F,appToken:H,ts:Date.now(),uid:J+""})};let ye,me,ue=v[0];return nl(async()=>{ye=Date.now();const he=await pd(ue,{data:se,cancelToken:b,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(me=Date.now()-ye,he.code!==0){const Me=new ae(z.UNEXPECTED_RESPONSE,"moderation plugin ap error, code"+he.code,{retry:!0,responseTime:me});throw D.error(Me.toString()),Me}const pe=JSON.parse(he.json_body);if(pe.code!==200){const Me=new ae(z.UNEXPECTED_RESPONSE,"moderation plugin ap error, code: ".concat(pe.code,", reason: ").concat(pe.reason),{code:pe.code,responseTime:me});throw D.error(Me.toString()),Me}if(!pe.servers||!Array.isArray(pe.servers)||pe.servers.length===0){const Me=new ae(z.UNEXPECTED_RESPONSE,"moderation plugin ap empty server",{code:pe.code,responseTime:me});throw D.error(Me.toString()),Me}if(!pe.servers.some(Me=>!!Me.wss)){const Me=new ae(z.UNEXPECTED_RESPONSE,"moderation plugin ap empty port",{code:pe.code,responseTime:me});throw D.error(Me.toString()),Me}const Ve=te("IMAGE_MODERATION_WORKER_HOST");return{addressList:pe.servers.map(Me=>{let{address:wt,wss:zt}=Me;if(wt&&zt)return"wss://".concat(wt.replace(/\./g,"-"),".").concat(Ve,":").concat(zt,"/moderation")}).filter(Me=>!!Me),workerToken:pe.workerToken,vid:pe.vid,ticket:pe.appTicket,responseTime:me}},(he,pe)=>(it.apworkerEvent(F,{success:!0,sc:200,serviceName:ee,responseDetail:JSON.stringify(he.addressList),firstSuccess:pe===0,responseTime:me,serverIp:v[pe%v.length]}),!1),(he,pe)=>(it.apworkerEvent(F,{success:!1,sc:he.data&&he.data.code||200,serviceName:ee,responseTime:me,serverIp:v[pe%v.length]}),!!(he.code!==z.OPERATION_ABORTED&&he.code!==z.UNEXPECTED_RESPONSE||he.data&&he.data.retry)&&(ue=v[(pe+1)%v.length],!0)),C)}(u,i,s,a);this.emit(Fa.STATE_CHANGE,Dh.AP_CONNECTED);const{addressList:p,ticket:_}=h;return this._ticket=_,p}async connectWorker(i){this.emit(Fa.STATE_CHANGE,Dh.CONNECT_WORKER),await this._workerConnection.init(i,1e4)}handleWorkerEvents(){this._workerConnection.on(mt.CONNECTED,async()=>{this.emit(Fa.STATE_CHANGE,Dh.WORKER_CONNECTED,this._workerConnection.url),this.connectionState=Lo.CONNECTED}),this._workerConnection.on(mt.CLOSED,()=>{this.connectionState=Lo.CLOSED}),this._workerConnection.on(mt.FAILED,()=>{this.connectionState=Lo.CLOSED}),this._workerConnection.on(mt.RECONNECTING,()=>{this.connectionState=this.connectionState===Lo.CONNECTED?Lo.RECONNECTING:Lo.CONNECTING}),this._workerConnection.on(mt.ON_MESSAGE,async i=>{if(i.data instanceof ArrayBuffer){const s=Ode(new Uint8Array(i.data));te("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&D.debug("[".concat(this._moderationId,"] Response message for worker of image moderation "),JSON.stringify(s)),this._uploadNum++,s.code===void 0||s.code===0||(this._uploadFailedNum++,D.error("[".concat(this._moderationId,"] Error response from worke, code is ").concat(s.code,", msg is ").concat(s.msg)),this._uploadTimer||(this._uploadTimer=window.setTimeout(()=>{it.reportApiInvoke(this._connectInfo.sid||null,{name:Mi.IMAGE_MODERATION_UPLOAD,options:[this._uploadFailedNum,this._uploadNum,s.code],tag:Yn.TRACER}).onError(new ae(z.IMAGE_MODERATION_UPLOAD_FAILED,s.msg)),this._uploadTimer=null},te("IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL"))))}else D.error("[".concat(this._moderationId,"] Unexpected message type from worker"))}),this._workerConnection.on(mt.WILL_RECONNECT,(i,s,a)=>{i==="recover"&&a(i),a("tryNext")}),this._workerConnection.on(mt.REQUEST_NEW_URLS,(i,s)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(i).catch(s)})}static intToLong(i){return{low:i|=0,high:i>>31,unsigned:i>=0}}async requestToInspectImage(){const i=oo(this,Fa.CLIENT_LOCAL_VIDEO_TRACK),s={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(i){if(!i.isPlaying)return void(te("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&D.debug("Only the track being played can be inspected"));this._sequence++;const a=await this.generateRequestData(i,s);this._workerConnection.sendMessage(a,!0,!0)}else te("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&D.debug("Only the track being published can be inspected")}async generateRequestData(i,s){let{appId:a,cname:u,cid:h,vid:p,sid:_,uid:v}=s;const T=Date.now(),b=await i.getCurrentFrameImage("image/jpeg",this.quality),C=await P7(b,a,u),N=this._sequence+"-"+h+"-"+v+"-"+T+"-"+wn(12,""),x={appId:a,cid:h,cname:u,deviceId:"",elapse:HU.intToLong(Number(T-this._moderationStartTime)),fileSize:b.buffer.byteLength,height:b.height,width:b.width,jpg:C,networkType:6,osType:7,requestId:N,sdkVersion:"4.19.3",sequence:this._sequence,sid:_,timestamp:Ude(T),uid:v,vid:p,service:this._moderationMode,ticket:this._ticket},B=Ade(x);if(B.byteLength<this._workerMessageLengthLimit){if(te("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")){const F=function(H){for(var J=1;J<arguments.length;J++){var ee=arguments[J]!=null?arguments[J]:{};J%2?J$(Object(ee),!0).forEach(function(se){O(H,se,ee[se])}):Object.getOwnPropertyDescriptors?Object.defineProperties(H,Object.getOwnPropertyDescriptors(ee)):J$(Object(ee)).forEach(function(se){Object.defineProperty(H,se,Object.getOwnPropertyDescriptor(ee,se))})}return H}({},x);delete F.jpg,D.debug("[".concat(this._moderationId,"] Request message for worker of image moderation service: "),JSON.stringify(F))}return B}{const F=this.quality*this._qualityRatio;return this.quality=F,await this.generateRequestData(i,{appId:a,cname:u,cid:h,vid:p,sid:_,uid:v})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=ao.CancelToken.source(),this._workerConnection&&this._workerConnection.close(),this._moderationTimer&&window.clearInterval(this._moderationTimer),this._moderationTimer=null,this._uploadTimer&&window.clearTimeout(this._uploadTimer),this._uploadTimer=null,this.connectionState=Lo.CLOSED,this.emit(Fa.STATE_CHANGE,Dh.CLOSED)}}function Q$(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function gA(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?Q$(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):Q$(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}class As extends zW{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var i,s;return(i=(s=this.peerConnection.getReceivers()[0])===null||s===void 0||(s=s.transport)===null||s===void 0?void 0:s.state)!==null&&i!==void 0?i:null}constructor(i,s,a){super(i,s),O(this,"direction",void 0),O(this,"store",void 0),O(this,"peerConnection",void 0),O(this,"transportEventReceiver",void 0),O(this,"statsFilter",void 0),O(this,"localCandidateCount",0),O(this,"allCandidatesReceived",!1),O(this,"mutex",new fr("P2PConnection-mutex")),O(this,"dataChannel",void 0),O(this,"onLocalCandidate",void 0),this.store=s,this.peerConnection=new RTCPeerConnection(As.resolvePCConfiguration(i),{optional:[{googDscp:!0}]}),this.direction=a??q_.SEND_ONLY,this.dataChannel=this.peerConnection.createDataChannel("agora-p2p-signal",{ordered:!0}),this.statsFilter=cA(this.peerConnection,te("STATS_UPDATE_INTERVAL"),void 0,jn()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(i){try{if(i){await this.peerConnection.setRemoteDescription({type:"offer",sdp:i});const s=await this.peerConnection.createAnswer();if(await this.peerConnection.setLocalDescription(s),!s.sdp)throw new Error("Cannot get answer sdp when trying to establish PeerConnection.");return s.sdp}{const s=await this.peerConnection.createOffer();if(!s.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");return await this.peerConnection.setLocalDescription(s),s.sdp}}catch(s){throw new Ee(z.GET_LOCAL_CONNECTION_PARAMS_FAILED,s.toString())}}async connect(i){try{await this.peerConnection.setRemoteDescription({type:"answer",sdp:i})}catch(s){throw new Ee(z.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(s.toString()))}}async addRemoteCandidate(i){try{await this.peerConnection.addIceCandidate(i)}catch(s){throw new Ee(z.ADD_CANDIDATE_FAILED,"P2PConnection.addRemoteCandidate failed; ".concat(s.toString()))}}async send(i){try{const s=[];i.forEach(h=>{const p=this.peerConnection.addTransceiver(h._mediaStreamTrack,{direction:"sendonly"});s.push(p)}),jn()&&te("SIMULCAST")===!0&&await this.applySimulcastForFirefox(s,i),await this.applySimulcastEncodings(s,i),await this.applySendEncodings(s,i);const a=await this.peerConnection.createOffer();if(await this.peerConnection.setLocalDescription(a),!a.sdp)throw new Error("Cannot get offer.sdp when trying to send PeerConnection.");const u=s.map(h=>{const p=this.getLocalSSRC(h.mid,a.sdp);if(!p)throw new Error("Cannot get ssrc when trying to send PeerConnection.");return{mid:h.mid,localSSRC:[{ssrcId:p}]}});return{sdp:a.sdp,trackMessage:u}}catch(s){throw s instanceof Ee?s:new Ee(z.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(s.toString()))}}async stopSending(i,s){const a=s?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{const u=this.peerConnection.getTransceivers().filter(p=>i.indexOf(p.mid)!==-1);if(u.length!==i.length)throw new Error("Transceivers' length (".concat(u.length,") doesn't match mids' length (").concat(i.length,") when trying to call P2PConnection.stopSending."));u.map(p=>{var _;p.direction="inactive",(_=p.stop)===null||_===void 0||_.call(p),this.peerConnection.removeTrack(p.sender)});const h=await this.peerConnection.createOffer();if(await this.peerConnection.setLocalDescription(h),!h.sdp)throw new Error("Cannot get offer.sdp when trying to send PeerConnection.");return h.sdp}catch(u){throw new Ee(z.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(u.toString()))}finally{a&&a()}}async receive(i,s,a){try{await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const u=await this.peerConnection.createAnswer();if(!u.sdp)throw new Error("Cannot get answer sdp when trying to receive track.");await this.peerConnection.setLocalDescription(u),D.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(i," by exchanging SDP."));const h=this.getRemoteMid(a,s);if(h===void 0)throw new Error("Cannot get transceiver mid when trying to receive track.");const p=this.peerConnection.getTransceivers().find(_=>_.mid===h);if(!p||p.mid===null)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:p.receiver.track,mid:p.mid,sdp:u.sdp}}catch(u){throw new Ee(z.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(u.toString()))}}async setDescription(i,s){try{if(i==="remote"){await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const a=await this.peerConnection.createAnswer();if(!a.sdp)throw new Error("Cannot get answer sdp when trying to receive track.");return await this.peerConnection.setLocalDescription(a),D.debug("[".concat(this.store.clientId,"] [P2PConnection] exchanging SDP, type is ").concat(i)),a.sdp}await this.peerConnection.setRemoteDescription({type:"answer",sdp:s})}catch(a){throw new Ee(z.EXCHANGE_SDP_FAILED,"P2PConnection.setDescription failed; ".concat(a.toString()))}}async stopReceiving(i,s){try{const a=this.peerConnection.getTransceivers().filter(h=>i.indexOf(h.mid)!==-1);if(a.length!==i.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");a.map(h=>{var p;h.direction="inactive",(p=h.stop)===null||p===void 0||p.call(h)}),await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const u=await this.peerConnection.createAnswer();if(await this.peerConnection.setLocalDescription(u),!u.sdp)throw new Error("Cannot get answer sdp when trying to receive track.");return u.sdp}catch(a){throw new Ee(z.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(a.toString()))}}async restartICE(){try{const i=await this.peerConnection.createOffer({iceRestart:!0});if(!i.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");return this.store.descriptionStart(),await this.peerConnection.setLocalDescription(i),i.sdp}catch(i){throw new Ee(z.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(i.toString()))}}close(){var i;this.peerConnection.close(),(i=this.onConnectionStateChange)===null||i===void 0||i.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.transportEventReceiver=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(i){return this.statsFilter.getVideoIsReady(i)}async updateEncoderConfig(i,s){}async updateSendParameters(i,s){const a=this.peerConnection.getTransceivers().filter(u=>u.mid===i);a.length===1&&(this.isVP8Simulcast(s)?jn()||await this.applySimulcastEncodings(a,[s]):await this.applySendEncodings(a,[s]))}setStatsRemoteVideoIsReady(i,s){this.statsFilter.setVideoIsReady2(i,s)}async replaceTrack(i,s){const a=this.peerConnection.getTransceivers().find(u=>u.mid===s);a&&await a.sender.replaceTrack(i._mediaStreamTrack)}async getSelectedCandidatePair(){const i=this.peerConnection.getReceivers();if(i.length>0&&i[0].transport&&i[0].transport.iceTransport&&i[0].transport.iceTransport.getSelectedCandidatePair&&i[0].transport.iceTransport.getSelectedCandidatePair()){const s=i[0].transport.iceTransport,{local:a,remote:u}=s.getSelectedCandidatePair();return{local:gA(gA({},ou),{},{candidateType:a.type,protocol:a.protocol,address:a.address,port:a.port}),remote:gA(gA({},ou),{},{candidateType:u.type,protocol:u.protocol,address:u.address,port:u.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var i;(i=this.onICEConnectionStateChange)===null||i===void 0||i.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var i;(i=this.onConnectionStateChange)===null||i===void 0||i.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=i=>{var s;i.candidate&&((s=this.onLocalCandidate)===null||s===void 0||s.call(this,i.candidate)),i.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,D.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,D.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},te("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(i){const s={iceServers:[]};return i.iceServers?s.iceServers=i.iceServers:i.turnServer&&i.turnServer.mode!=="off"&&(V_(i.turnServer.servers)?s.iceServers=i.turnServer.servers:(s.iceServers&&s.iceServers.push(...As.turnServerConfigToIceServers(i.turnServer.servers)),te("USE_TURN_SERVER_OF_GATEWAY")&&s.iceServers&&i.turnServer.serversFromGateway&&s.iceServers.push(...As.turnServerConfigToIceServers(i.turnServer.serversFromGateway)),te("FORCE_TURN_TCP")?s.iceTransportPolicy="relay":i.turnServer.servers.concat(i.turnServer.serversFromGateway||[]).forEach(a=>{a.forceturn&&(s.iceTransportPolicy="relay")}))),te("ENABLE_ENCODED_TRANSFORM")&&In().supportWebRTCEncodedTransform&&(s.encodedInsertableStreams=!0),s}static turnServerConfigToIceServers(i){const s=[];return i.forEach(a=>{a.tcpport&&(s.push({username:a.username,credential:a.password,credentialType:"password",urls:"turns:".concat(gS(a.turnServerURL),":").concat(a.tcpport,"?transport=tcp")}),s.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.tcpport,"?transport=udp")}),s.push({username:a.username,credential:a.password,credentialType:"password",urls:"stun:".concat(a.turnServerURL,":").concat(a.tcpport)}))}),s}tryBindTransportEvents(i){const s=i.transport;if(s){this.transportEventReceiver=i,s.onstatechange=()=>{var u;s!=null&&s.state&&((u=this.onDTLSTransportStateChange)===null||u===void 0||u.call(this,s.state))},s.onerror=u=>{var h;(h=this.onDTLSTransportError)===null||h===void 0||h.call(this,"error"in u?u.error:u)};const a=s.iceTransport;a&&(a.onstatechange=()=>{const u=s==null?void 0:s.iceTransport.state;var h;u&&((h=this.onICETransportStateChange)===null||h===void 0||h.call(this,u))},a.getSelectedCandidatePair&&(a.onselectedcandidatepairchange=()=>{if(a.getSelectedCandidatePair()){const{local:u,remote:h}=a.getSelectedCandidatePair();D.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:u.type,protocol:u.protocol}),", remote ").concat(JSON.stringify({candidateType:h.type,protocol:h.protocol,address:h.address,port:h.port})," )"))}}))}}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(i,s){var a;if(s||(s=this.peerConnection.getSenders().find(b=>b.track===i._mediaStreamTrack)),!s)return D.warn("[".concat(i.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(i))return D.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!In().supportSetRtpSenderParameters)return D.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const u={},h={};switch(i._optimizationMode){case"motion":u.degradationPreference="maintain-framerate";break;case"detail":u.degradationPreference="maintain-resolution";break;default:u.degradationPreference="balanced"}if(i._encoderConfig){var p;const{bitrateMax:b,frameRate:C,scaleResolutionDownBy:N}=i._encoderConfig;b&&(h.maxBitrate=1e3*b),ot(p=i._hints).call(p,Ln.LOW_STREAM)&&(C&&(h.maxFramerate=pa(C)),N&&N>=1&&(h.scaleResolutionDownBy=N))}if(te("DSCP_TYPE")&&Ih()){var _;const b=te("DSCP_TYPE");ot(_=["very-low","low","medium","high"]).call(_,b)&&(h.networkPriority=b)}const v=s.getParameters(),T=(a=v.encodings)===null||a===void 0?void 0:a[0];jn()&&!T&&(u.encodings=[h]),T&&Object.assign(T,h),Object.assign(v,u),D.debug("[".concat(i.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(v.encodings))),await s.setParameters(v)}async applySendEncodings(i,s){try{if(!In().supportSetRtpSenderParameters||i.length!==s.length)return;for(let a=0;a<i.length;a++){const u=i[a],h=s[a];h instanceof Ct&&!this.isVP8Simulcast(h)&&await this.updateRtpSenderEncodings(h,u.sender)}}catch{D.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(i,s,a){const u=li.parse(i);return s.forEach((h,p)=>{const _=a[p],v=u.mediaDescriptions.find(T=>T.attributes.mid===_);v&&(cm(v,h),NU(v,h,this.store.codec))}),li.print(u)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=i=>{var s;(s=this.onFirstAudioReceived)===null||s===void 0||s.call(this,i)},this.statsFilter.onFirstVideoReceived=i=>{var s;(s=this.onFirstVideoReceived)===null||s===void 0||s.call(this,i)},this.statsFilter.onFirstAudioDecoded=i=>{var s;(s=this.onFirstAudioDecoded)===null||s===void 0||s.call(this,i)},this.statsFilter.onFirstVideoDecoded=(i,s,a)=>{var u;(u=this.onFirstVideoDecoded)===null||u===void 0||u.call(this,i,s,a)},this.statsFilter.onSelectedLocalCandidateChanged=(i,s)=>{var a;(a=this.onSelectedLocalCandidateChanged)===null||a===void 0||a.call(this,i,s)},this.statsFilter.onSelectedRemoteCandidateChanged=(i,s)=>{var a;(a=this.onSelectedRemoteCandidateChanged)===null||a===void 0||a.call(this,i,s)},this.statsFilter.onFirstVideoDecodedTimeout=i=>{var s;(s=this.onFirstVideoDecodedTimeout)===null||s===void 0||s.call(this,i)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(i,s){if(i.length===s.length)for(let v=0;v<i.length;v++){var a,u,h,p,_;const T=i[v],b=s[v];if(b instanceof Ct&&!ot(a=b._hints).call(a,Ln.LOW_STREAM)&&(u=b._encoderConfig)!==null&&u!==void 0&&u.bitrateMax&&((h=b._encoderConfig)===null||h===void 0?void 0:h.bitrateMax)>200&&(p=b._scalabilityMode)!==null&&p!==void 0&&p.numSpatialLayers&&((_=b._scalabilityMode)===null||_===void 0?void 0:_.numSpatialLayers)>1&&this.store.codec==="vp8"){const C={},N={high:1e3*(b._encoderConfig.bitrateMax-50),medium:5e4};C.encodings=[{rid:"m",active:!0,maxBitrate:N.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:N.high}];const x=T.sender.getParameters();await T.sender.setParameters(Object.assign(x,C))}}}async applySimulcastEncodings(i,s){if(!jn()&&i.length===s.length)for(let a=0;a<i.length;a++){const u=s[a];if(u instanceof Ct&&this.isVP8Simulcast(u)){const h=i[a],p={},_={high:1e3*(u._encoderConfig.bitrateMax-50),medium:5e4};p.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:_.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:_.medium,scaleResolutionDownBy:4}];const v=h.sender.getParameters();await h.sender.setParameters(Object.assign(v,p))}}}isVP8Simulcast(i){var s,a,u,h,p;return!!(i instanceof Ct&&te("SIMULCAST")&&this.store.codec==="vp8"&&!ot(s=i._hints).call(s,Ln.LOW_STREAM)&&(a=i._encoderConfig)!==null&&a!==void 0&&a.bitrateMax&&((u=i._encoderConfig)===null||u===void 0?void 0:u.bitrateMax)>200&&(h=i._scalabilityMode)!==null&&h!==void 0&&h.numSpatialLayers&&((p=i._scalabilityMode)===null||p===void 0?void 0:p.numSpatialLayers)>1)}logSDPExchange(i,s,a,u){if(te("SDP_LOGGING"))return D.upload("[".concat(this.store.clientId,"] exchanging ").concat(a," ").concat(s," SDP during P2PConnection.").concat(u,`
`),i),s==="offer"?h=>{this.logSDPExchange(h,"answer",a==="local"?"remote":"local",u)}:void 0}getLocalSSRC(i,s){var a,u;if(s=(a=s)!==null&&a!==void 0?a:(u=this.currentLocalDescription)===null||u===void 0?void 0:u.sdp){var h;const p=(h=li.parse(s).mediaDescriptions.find(_=>_.attributes.mid===i))===null||h===void 0?void 0:h.attributes.ssrcs;return p==null?void 0:p[0].ssrcId}}getRemoteMid(i,s){var a,u;if(s=(a=s)!==null&&a!==void 0?a:(u=this.currentRemoteDescription)===null||u===void 0?void 0:u.sdp){var h;return(h=li.parse(s).mediaDescriptions.find(p=>p.attributes.ssrcs.some(_=>_.ssrcId===i)))===null||h===void 0?void 0:h.attributes.mid}}async getRemoteSSRC(i,s){var a,u;if(s=(a=s)!==null&&a!==void 0?a:(u=this.currentRemoteDescription)===null||u===void 0?void 0:u.sdp){var h;const p=(h=li.parse(s).mediaDescriptions.find(_=>_.attributes.mid===i))===null||h===void 0?void 0:h.attributes.ssrcs;return p==null?void 0:p[0].ssrcId}}}function bc(o,i,s){const a=o[i];if(typeof a!="function")throw new Error("Cannot use mutex on object property.");return s.value=async function(){const u=this.mutex,h=await u.lock("From P2PConnection.".concat(i));try{for(var p=arguments.length,_=new Array(p),v=0;v<p;v++)_[v]=arguments[v];return await a.apply(this,_)}finally{h()}},s}var Ga;function Z$(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function Yh(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?Z$(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):Z$(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}ve([bc,j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",le)],As.prototype,"establish",null),ve([bc,j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",le)],As.prototype,"connect",null),ve([bc,j("design:type",Function),j("design:paramtypes",[RTCIceCandidate]),j("design:returntype",le)],As.prototype,"addRemoteCandidate",null),ve([bc,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",le)],As.prototype,"send",null),ve([bc,j("design:type",Function),j("design:paramtypes",[String,String,Number]),j("design:returntype",le)],As.prototype,"receive",null),ve([bc,j("design:type",Function),j("design:paramtypes",[String,String]),j("design:returntype",le)],As.prototype,"setDescription",null),ve([bc,j("design:type",Function),j("design:paramtypes",[Array,String]),j("design:returntype",le)],As.prototype,"stopReceiving",null),ve([bc,j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",le)],As.prototype,"restartICE",null),ve([bc,j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],As.prototype,"close",null),ve([bc,j("design:type",Function),j("design:paramtypes",[String,Vr]),j("design:returntype",le)],As.prototype,"updateEncoderConfig",null),ve([bc,j("design:type",Function),j("design:paramtypes",[String,Vr]),j("design:returntype",le)],As.prototype,"updateSendParameters",null),ve([bc,j("design:type",Function),j("design:paramtypes",[Vr,String]),j("design:returntype",le)],As.prototype,"replaceTrack",null),function(o){o.SEND_ONLY="SEND_ONLY",o.RECEIVE_ONLY="RECEIVE_ONLY"}(Ga||(Ga={}));class ri extends Hn{get state(){return this._state}set state(i){const s=this._state;this._state=i,this.emit(ut.StateChange,s,this._state)}constructor(i,s){super(),O(this,"store",void 0),O(this,"statsUploader",void 0),O(this,"sendConnection",void 0),O(this,"recvConnection",void 0),O(this,"localTrackMap",new Map),O(this,"remoteUserMap",new Map),O(this,"localDataChannels",[]),O(this,"pendingLocalTracks",[]),O(this,"pendingRemoteTracks",[]),O(this,"statsCollector",void 0),O(this,"dtlsFailedCount",0),O(this,"sendMutex",new fr("P2PChannel2-send-mutex")),O(this,"recvMutex",new fr("P2PChannel2-recv-mutex")),O(this,"_state",Xt.Disconnected),O(this,"_restartStates",["disconnected","failed"]),O(this,"_restartTimer",void 0),O(this,"handleMuteLocalTrack",async(a,u,h)=>{const p=await this.sendMutex.lock("Locking from P2PChannel2.handleMuteLocalTrack");try{if(!this.sendConnection||this.state!==Xt.Connected)return void h(new Ee(z.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established."));const T=this.filterTobeMutedTracks(a);if(T.length===0)return void u();const b=T.find(J=>J[0]==="videoLowTrack");b&&b[1].track._originMediaStreamTrack.stop();let C=!1;var _,v;a.trackMediaType==="video"?C=!((_=this.localTrackMap.get(Te.LocalAudioTrack))===null||_===void 0||!_.track._muted):C=((v=this.localTrackMap.get(Te.LocalVideoTrack))===null||v===void 0?void 0:v.id)===void 0;const N=T.filter(J=>{let[ee,se]=J;return(ee!==Te.LocalAudioTrack||C)&&se.id!==void 0}).map(J=>{let[,ee]=J;return ee});let x;N.length>0&&(x=await this.sendConnection.stopSending(N.map(J=>J.id)),N.forEach(J=>{J.id=void 0,J.ssrcs=void 0}));const B=this.createMuteMessage(T),F=a.trackMediaType==="video"?Zl.MUTE_LOCAL_VIDEO:Zl.MUTE_LOCAL_AUDIO,H=await Qn(this,ut.RequestP2PMuteLocal,{action:F,sdp:x,message:B,isMuteAll:C});H&&await this.sendConnection.setDescription("local",H),(x||a.trackMediaType==="audio")&&await bn(this,ut.RequestMuteLocal,B),u()}catch(T){h(T)}finally{p()}}),O(this,"handleUnmuteLocalTrack",async(a,u,h)=>{const p=await this.sendMutex.lock("Locking from P2PChannel2.handleUnmuteLocalTrack");try{if(!this.sendConnection||this.state!==Xt.Connected)return void h(new Ee(z.INVALID_OPERATION,"Cannot call P2PChannel2.handleUnmuteLocalTrack before sendConnection established."));const _=this.filterTobeUnmutedTracks(a);if(_.length===0)return void u();const v=this.createUnmuteMessage(_),T=a.trackMediaType==="video"?Zl.UNMUTE_LOCAL_VIDEO:Zl.UNMUTE_LOCAL_AUDIO;await bn(this,ut.RequestP2PMuteLocal,{action:T,message:v}),u()}catch(_){h(_)}finally{p()}}),O(this,"handleUpdateVideoEncoder",async(a,u,h)=>{const p=await this.sendMutex.lock("Locking from P2PChannel2.handleSetVideoEncoder");try{const _=this.localTrackMap.get(Te.LocalVideoTrack);if(!this.sendConnection||!_||_.track!==a||this.state!==Xt.Connected)return void u();const{id:v,track:T}=_;v&&(await this.sendConnection.updateSendParameters(v,T),await this.sendConnection.updateEncoderConfig(v,T),this.emit(ut.UpdateVideoEncoder,T)),u()}catch(_){h(_)}finally{p()}}),O(this,"handleSetOptimizationMode",async(a,u,h)=>{const p=await this.sendMutex.lock("Locking from P2PChannel2.handleSetOptimizationMode");try{const _=this.localTrackMap.get(Te.LocalVideoTrack);if(!this.sendConnection||!_||_.track!==a||this.state!==Xt.Connected)return;const{id:v,track:T}=_;v&&await this.sendConnection.updateSendParameters(v,T),u()}catch(_){h(_)}finally{p()}}),O(this,"handleReplaceTrack",async(a,u,h,p)=>{let _;D.debug("[".concat(this.store.clientId,"] P2PChannel2 handleReplaceTrack for [track-id-").concat(a.getTrackId(),"]")),typeof p=="boolean"&&p||(_=await this.sendMutex.lock("From P2PChannel2.handleReplaceTrack"));try{var v;const b=Array.from(this.localTrackMap.entries()).find(C=>{let[,{track:N}]=C;return a===N});if(!this.sendConnection||!b||b[1].id===void 0||this.state!==Xt.Connected)return void u();if(await((v=this.sendConnection)===null||v===void 0?void 0:v.replaceTrack(a,b[1].id)),b[0]===Te.LocalVideoTrack&&In().supportDualStreamEncoding){const C=this.localTrackMap.get(Te.LocalVideoLowTrack);if(C){const N=a._mediaStreamTrack.clone();C.track._originMediaStreamTrack.stop(),C.track._mediaStreamTrack=N,C.track._originMediaStreamTrack=N,await new le((x,B)=>{this.handleReplaceTrack(C.track,x,B,!0)})}}u()}catch(b){h(b)}finally{var T;(T=_)===null||T===void 0||T()}}),O(this,"handleGetLocalVideoStats",a=>{a(this.statsCollector.getLocalVideoTrackStats())}),O(this,"handleGetLocalAudioStats",a=>{a(this.statsCollector.getLocalAudioTrackStats())}),O(this,"handleGetRemoteVideoStats",a=>this.statsCollector.getRemoteVideoTrackStats(a.uid)[a.uid]),O(this,"handleGetRemoteAudioStats",a=>this.statsCollector.getRemoteAudioTrackStats(a.uid)[a.uid]),this.store=i,this.statsCollector=s,this.statsCollector.addP2PChannel(this),this.statsUploader=new N$,this.bindStatsUploaderEvents()}async startP2PConnection(i,s){throw new Ee(z.NOT_SUPPORTED,"p2p mode does not support startP2PConnection.")}async connect(i,s,a,u,h,p){throw new Ee(z.NOT_SUPPORTED,"p2p mode does not support connect.")}async startP2P(i,s){if(this.state=Xt.New,this.sendConnection&&(D.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset P2PConnection.")),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection)),this.recvConnection&&(D.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset P2PConnection.")),this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection)),this.sendConnection=new As(i,this.store),this.bindConnectionEvents(this.sendConnection),this.recvConnection=new As(i,this.store,q_.RECEIVE_ONLY),this.bindConnectionEvents(this.recvConnection),s){this.store.peerConnectionStart(),await this.recvConnection.establish(s);const a=await this.sendConnection.establish(s);return this.statsUploader.startUploadTransportStats(!0),this.statsUploader.startUploadExtensionUsageStats(),this.state=Xt.Connected,a}return await this.recvConnection.establish(s),this.sendConnection.establish(s)}async p2pConnect(i){if(!this.sendConnection||!this.recvConnection)throw new Ee(z.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.startP2PConnection .");this.store.peerConnectionStart(),await this.recvConnection.connect(i),await this.sendConnection.connect(i),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=Xt.Connected}async addRemoteCandidate(i){if(!this.sendConnection||!this.recvConnection)throw new Ee(z.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.recvConnection.addRemoteCandidate(i),await this.sendConnection.addRemoteCandidate(i)}async publish(i,s,a){if(!this.sendConnection||this.state!==Xt.Connected){this.throwIfTrackTypeNotMatch(i);const p=i.filter(_=>this.pendingLocalTracks.indexOf(_)===-1);return void(this.pendingLocalTracks=this.pendingLocalTracks.concat(p))}this.store.pubId=this.store.pubId+1,Br.markPublishStart(this.store.clientId,this.store.pubId);const u=this.filterTobePublishedTracks(i,s,a);if(u.length===0)return void await this.tryToUnmuteAudio(i);u.forEach(p=>{let{track:_,type:v}=p;const T=Date.now();this.store.publish(_.getTrackId(),v===Te.LocalAudioTrack?"audio":"video",T)}),this.bindLocalTrackEvents(u);const h=this.createGatewayPublishMessage(u);return this.assignLocalTracks(u),u.forEach(p=>{let{track:_,type:v}=p;const T=Date.now();this.store.publish(_.getTrackId(),v===Te.LocalAudioTrack?"audio":"video",void 0,T)}),h}async dopublish(i){if(!this.sendConnection||this.state!==Xt.Connected)return;const s=this.localTrackMap.get(i);if(s){const{sdp:a,trackMessage:u}=await this.sendConnection.send([s.track]),{mid:h,localSSRC:p}=u[0];s.id=h,s.ssrcs=p,this.statsCollector.addLocalStats(i),this.statsUploader.startUploadUplinkStats();const _=await Qn(this,ut.RequestP2PPublish,{kind:i===Te.LocalAudioTrack?Qe.AUDIO:Qe.VIDEO,sdp:a,ssrcId:p[0].ssrcId});await this.sendConnection.setDescription("local",_);const v=this.createUnmuteMessage([[i,s]]);await bn(this,ut.RequestUnmuteLocal,v)}}async setDescription(i,s){let a,u;i==="local"?(a=await this.sendMutex.lock("From P2PChannel.restartICE"),u=this.sendConnection):(a=await this.recvMutex.lock("From P2PChannel.restartICE"),u=this.recvConnection);try{return!u||this.state!==Xt.Connected?void 0:await u.setDescription(i,s)}finally{a()}}publishLowStream(i){return Ha(function*(){throw new Ee(z.NOT_SUPPORTED,"p2p mode does not support publishLowStream.")})()}async republish(){this.pendingLocalTracks.length>0&&(D.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await Qn(this,ut.RequestRePublish,this.pendingLocalTracks),this.emit(ut.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[])}async unpublish(i){if(!this.sendConnection||this.state!==Xt.Connected)return void(i.length===0?this.pendingLocalTracks.length=0:this.pendingLocalTracks=this.pendingLocalTracks.filter(v=>!ot(i).call(i,v)));const s=this.filterTobeUnpublishedTracks(i);if(s.length===0)return;this.unbindLocalTrackEvents(s.map(v=>{let[T,{track:b}]=v;return{type:T,track:b}}));const a=s.filter(v=>{let[,{id:T}]=v;return T!==void 0});if(!this.sendConnection||this.state!==Xt.Connected)return void i.forEach(v=>{const T=this.pendingLocalTracks.indexOf(v);T!==-1&&this.pendingLocalTracks.splice(T,1)});const u=s.find(v=>v[0]==="videoLowTrack");u&&u[1].track.close();let h;const p=this.createGatewayUnpublishMessage(s);a.length>0&&(h=await this.sendConnection.stopSending(a.map(v=>{let[,{id:T}]=v;return T}))),this.withdrawLocalTracks(s),this.unbindLocalTrackEvents(s.map(v=>{let[T,{track:b}]=v;return{type:T,track:b}})),s.forEach(v=>{let[T]=v;this.statsCollector.removeLocalStats(T)}),this.localTrackMap.size===0&&this.statsUploader.stopUploadUplinkStats();const _=this.createMuteMessage(s);return await le.all(_.map(async v=>{await bn(this,ut.RequestMuteLocal,[v])})),{sdp:h,unpubMsg:p}}async unpublishLowStream(){throw new Ee(z.NOT_SUPPORTED,"p2p mode does not support unpublishLowStream.")}async doUnpublish(i){if(!this.sendConnection||this.state!==Xt.Connected)return;const s=[];if(i!==Qe.AUDIO){const a=this.localTrackMap.get(Te.LocalVideoTrack);(a==null?void 0:a.id)!==void 0&&s.push([Te.LocalVideoTrack,a]);const u=this.localTrackMap.get(Te.LocalVideoLowTrack);(u==null?void 0:u.id)!==void 0&&s.push([Te.LocalVideoLowTrack,u]),this.statsCollector.removeLocalStats(Te.LocalVideoTrack),this.statsCollector.removeLocalStats(Te.LocalVideoLowTrack)}if(i!==Qe.VIDEO){const a=this.localTrackMap.get(Te.LocalAudioTrack);(a==null?void 0:a.id)!==void 0&&s.push([Te.LocalAudioTrack,a]),this.statsCollector.removeLocalStats(Te.LocalAudioTrack)}if(s.length>0){const a=await this.sendConnection.stopSending(s.map(p=>{let[,_]=p;return _.id}));s.forEach(p=>{let[,_]=p;_.id=void 0,_.ssrcs=void 0});const u=await Qn(this,ut.RequestP2PUnPublish,{sdp:a,kind:i});await this.sendConnection.setDescription("local",u);const h=this.createMuteMessage(s);await le.all(h.map(async p=>{await bn(this,ut.RequestMuteLocal,[p])}))}}async subscribe(i,s,a,u){var h;if(!this.recvConnection||this.state!==Xt.Connected)throw new Ee(z.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");if((h=this.remoteUserMap.get(i))!==null&&h!==void 0&&h.has(s))return;const{track:p,mid:_,sdp:v}=await this.recvConnection.receive(s,a,u);s===Qe.AUDIO?(i._audioSSRC=u,i._audioTrack?i._audioTrack._updateOriginMediaStreamTrack(p):(i._audioTrack=new _c(p,i.uid,i._uintid,this.store),D.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(i._audioTrack.getTrackId()))),this.bindRemoteTrackEvents(i,i._audioTrack)):(i._videoSSRC=u,i._videoTrack?i._videoTrack._updateOriginMediaStreamTrack(p):(i._videoTrack=new tu(p,i.uid,i._uintid,this.store),D.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(i._videoTrack.getTrackId()))),this.bindRemoteTrackEvents(i,i._videoTrack));const T=this.remoteUserMap.get(i);T?T.set(s,_):this.remoteUserMap.set(i,new Map([[s,_]])),this.statsCollector.addRemoteStats(i.uid),this.statsUploader.startUploadDownlinkStats(),await bn(this,ut.RequestP2PUnmuteRemote,s);const b=this.pendingRemoteTracks.findIndex(C=>{let{user:N,kind:x}=C;return N.uid===i.uid&&s===x});return b!==-1&&(this.pendingRemoteTracks.splice(b,1),this.emit(ut.MediaReconnectEnd,i.uid)),v}async unsubscribe(i,s,a,u){const h=this.pendingRemoteTracks.filter(v=>{let{user:T,kind:b}=v;return a!==void 0?T.uid===i.uid&&a===b:T.uid===i.uid});if(h.forEach(v=>{const T=this.pendingRemoteTracks.indexOf(v);this.pendingRemoteTracks.splice(T,1)}),this.recvConnection&&this.state===Xt.Connected||u||h.forEach(v=>{let{kind:T}=v;var b;if(T===Qe.AUDIO)(b=i._audioTrack)===null||b===void 0||b._destroy(),i._audioTrack=void 0;else if(T===Qe.VIDEO){var C;(C=i._videoTrack)===null||C===void 0||C._destroy(),i._videoTrack=void 0}}),!this.recvConnection||this.state!==Xt.Connected)return;const p=this.filterTobeUnSubscribedTracks(i,a);if(p.length===0)return void(a!==Qe.VIDEO&&bn(this,ut.RequestP2PMuteRemote,Qe.AUDIO));const _=await this.recvConnection.stopReceiving(p.map(v=>{let[,{id:T}]=v;return T}),s);return this.withdrawRemoteTracks(p),this.remoteUserMap.size===0&&this.statsUploader.stopUploadDownlinkStats(),p.forEach(v=>{let[T,{kind:b}]=v;var C,N;if(b===Qe.VIDEO&&T._videoSSRC&&((C=this.recvConnection)===null||C===void 0||C.setStatsRemoteVideoIsReady(T._videoSSRC,!1)),b===Qe.VIDEO)this.unbindRemoteTrackEvents(T._videoTrack),u||((N=T._videoTrack)===null||N===void 0||N._destroy(),T._videoTrack=void 0);else if(b===Qe.AUDIO){var x;this.unbindRemoteTrackEvents(T._audioTrack),!u&&((x=T._audioTrack)===null||x===void 0||x._destroy(),T._audioTrack=void 0)}}),p.filter(v=>{let[,{kind:T}]=v;return T!==Qe.AUDIO}).forEach(v=>{let[,{kind:T}]=v;bn(this,ut.RequestP2PMuteRemote,T)}),a!==Qe.VIDEO&&bn(this,ut.RequestP2PMuteRemote,Qe.AUDIO),_}getAllDataChannels(){return this.localDataChannels}async massSubscribe(i){throw new Ee(z.NOT_SUPPORTED,"p2p mode does not support massSubscribe.")}async massSubscribeNoLock(i){throw new Ee(z.NOT_SUPPORTED,"p2p mode does not support massSubscribeNoLock.")}async massUnsubscribe(i){throw new Ee(z.NOT_SUPPORTED,"p2p mode does not support massUnsubscribe.")}async massUnsubscribeNoLock(i){throw new Ee(z.NOT_SUPPORTED,"p2p mode does not support massUnsubscribeNoLock.")}async muteRemote(i,s){if(!this.recvConnection)return;const a=this.remoteUserMap.get(i);if(!a)return void D.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(i.uid,"."));if(!a.get(s))return void D.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(i.uid," media type ").concat(s,"."));const u=s===Qe.VIDEO?i._videoSSRC:i._audioSSRC;u!==void 0&&this.recvConnection.setStatsRemoteVideoIsReady(u,!1)}async unmuteRemote(i,s){return this.unmuteRemoteNoLock(i,s)}async unmuteRemoteNoLock(i,s){if(!this.recvConnection)return;const a=this.remoteUserMap.get(i);if(!a)return void D.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(i.uid,"."));a.get(s)||D.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(i.uid," media type ").concat(s,"."))}getAllTracks(i){const s=this.localTrackMap.get(Te.LocalAudioTrack);if((s==null?void 0:s.track)instanceof Ni){const a=s.track;return Array.from(this.localTrackMap.entries()).filter(u=>{let[h]=u;return h!==Te.LocalAudioTrack}).filter(u=>{let[h]=u;return!(i&&h===Te.LocalVideoLowTrack)}).map(u=>{let[,{track:h}]=u;return h}).concat(a.trackList)}return Array.from(this.localTrackMap.entries()).filter(a=>{let[u]=a;return!(i&&u===Te.LocalVideoLowTrack)}).map(a=>{let[,{track:u}]=a;return u})}reportPublishEvent(i,s,a,u,h){if(i){const _=this.localTrackMap.get(Te.LocalAudioTrack),v=u?this.localTrackMap.get(Te.LocalVideoLowTrack):this.localTrackMap.get(Te.LocalVideoTrack);it.publish(this.store.sessionId,{eventElapse:Br.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:i,ec:s,audioName:_==null?void 0:_.track.getTrackLabel(),videoName:v==null?void 0:v.track.getTrackLabel(),screenshare:(v==null?void 0:v.track._hints.indexOf(Ln.SCREEN_TRACK))!==-1,audio:!!_,video:!!v,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:h})}else{var p;a||(a=[]);const _=a.find(T=>T instanceof cn),v=u?(p=this.localTrackMap.get(Te.LocalVideoTrack))===null||p===void 0?void 0:p.track:a.find(T=>T instanceof Ct);it.publish(this.store.sessionId,{eventElapse:Br.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:i,ec:s,audioName:_==null?void 0:_.getTrackLabel(),videoName:v==null?void 0:v.getTrackLabel(),screenshare:(v==null?void 0:v._hints.indexOf(Ln.SCREEN_TRACK))!==-1,audio:!!_,video:!!v,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:h})}}reportSubscribeEvent(i,s,a,u){const h=u===Qe.VIDEO?a._videoSSRC:a._audioSSRC;h&&it.subscribe(this.store.sessionId,{succ:i,ec:s,video:u===Qe.VIDEO,audio:u===Qe.AUDIO,peerid:a.uid,subscribeRequestid:u===Qe.VIDEO?a._videoSSRC:a._audioSSRC,p2pid:this.store.p2pId,eventElapse:Br.measureFromSubscribeStart(this.store.clientId,h)})}reset(){D.debug("[".concat(this.store.clientId,"] P2PChannel2.reset")),this.sendMutex=new fr("P2PChannel2-send-mutex"),this.sendMutex=new fr("P2PChannel2-recv-mutex"),this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0),this.statsUploader.stopUploadUplinkStats(),this.statsUploader.stopUploadDownlinkStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const i=this.localTrackMap.get(Te.LocalAudioTrack);if((i==null?void 0:i.track)instanceof Ni){if(i.track.trackList.length>0){const s=i.track;i.track.trackList.forEach(a=>{s.removeAudioTrack(a)})}i.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.state=Xt.Disconnected}getStats(i){var s,a;return i?(a=this.recvConnection)===null||a===void 0?void 0:a.getStats():(s=this.sendConnection)===null||s===void 0?void 0:s.getStats()}getRemoteVideoIsReady(i){var s;return((s=this.recvConnection)===null||s===void 0?void 0:s.getRemoteVideoIsReady(i))||!1}getLocalAudioVolume(){const i=this.localTrackMap.get(Te.LocalAudioTrack);if(i)return i.track.getVolumeLevel()}getLocalVideoSize(){const i=this.localTrackMap.get(Te.LocalVideoTrack);if(i)return{width:i.track._videoWidth||0,height:i.track._videoHeight||0}}getEncoderConfig(i){const s=this.localTrackMap.get(i);return s&&s.track instanceof Ct||s&&s.track instanceof cn?s.track._encoderConfig:void 0}getLocalMedia(i){return this.localTrackMap.get(i)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(i,s){if(!i)return this.remoteUserMap.size>0;const a=this.remoteUserMap.get(i);return!!a&&(!s||a.has(s))}async hasRemoteMediaWithLock(i,s){if(!i)return this.remoteUserMap.size>0;const a=this.remoteUserMap.get(i);return!!a&&(!s||a.has(s))}getRemoteMedia(i){var s;const a=Array.from(Fs(s=this.remoteUserMap).call(s)).find(u=>u.uid===i);return a?{audioTrack:a.audioTrack,audioSSRC:a._audioSSRC,videoTrack:a.videoTrack,videoSSRC:a._videoSSRC}:{}}getAudioLevels(){let i=Array.from(this.remoteUserMap.entries()).map(a=>{let[u]=a;return{uid:u.uid,level:u.audioTrack?100*u.audioTrack._source.getAccurateVolumeLevel():0}});const s=this.localTrackMap.get(Te.LocalAudioTrack);return s&&i.push({level:100*s.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),i=Up(i).call(i,(a,u)=>a.level-u.level),i}async disconnectForReconnect(){this.sendConnection&&this.recvConnection&&(D.debug("[".concat(this.store.clientId,"] P2PChannel2.disconnectForReconnect closing P2PConnection")),this.state=Xt.Reconnecting,te("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(i=>{let[s]=i;var a;s._videoTrack&&s._videoTrack._player&&((a=s._videoTrack._player.getVideoElement())===null||a===void 0||a.pause(),s._videoTrack._player.isKeepLastFrame=!0,s._videoTrack._originMediaStreamTrack.stop())}),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0,this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0,this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(i=>{var s;let[a,{track:u}]=i;switch(a){case Te.LocalVideoTrack:ot(s=u._hints).call(s,Ln.LOW_STREAM)?u.close():this.pendingLocalTracks.push(u);break;case Te.LocalAudioTrack:u instanceof Ni?this.pendingLocalTracks=this.pendingLocalTracks.concat(u.trackList):this.pendingLocalTracks.push(u);case Te.LocalVideoLowTrack:}}),this.emit(ut.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(i=>{let[s,a]=i;Array.from(Fs(a).call(a)).forEach(u=>{this.setPendingRemoteMedia(s,u)}),this.emit(ut.MediaReconnectStart,s.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.statsUploader.stopUploadUplinkStats(),this.statsUploader.stopUploadDownlinkStats(),this.statsUploader.stopUploadTransportStats(),D.debug("[".concat(this.store.clientId,"] P2PChannel2 disconnected, waiting to reconnect.")))}hasPendingRemoteMedia(i,s){for(const a of this.pendingRemoteTracks){const{user:u,kind:h}=a;if((i instanceof Wr?i.uid:i)===u.uid&&s===h)return!0}return!1}setPendingRemoteMedia(i,s){this.hasPendingRemoteMedia(i,s)||this.pendingRemoteTracks.push({user:i,kind:s})}async restartICE(i){let s;s=i.direction===q_.SEND_ONLY?await this.sendMutex.lock("From P2PChannel.restartICE"):await this.recvMutex.lock("From P2PChannel.restartICE");try{const a=await i.restartICE(),u=await Qn(this,ut.RequestP2PRestartICE,a);i.setDescription("local",u)}finally{s()}}getUplinkNetworkQuality(){if(!this.sendConnection)return 0;const i=this.sendConnection.getStats(),s=this.localTrackMap.get(Te.LocalVideoTrack),a=this.localTrackMap.get(Te.LocalAudioTrack),u=i.videoSend.find(B=>{var F;return B.ssrc===(s==null||(F=s.ssrcs)===null||F===void 0?void 0:F[0].ssrcId)}),h=i.audioSend.find(B=>{var F;return B.ssrc===(a==null||(F=a.ssrcs)===null||F===void 0?void 0:F[0].ssrcId)});if(!u||!h)return 1;const p=oo(this,ut.NeedSignalRTT),_=u?u.rttMs:void 0,v=h?h.rttMs:void 0,T=_&&v?(_+v)/2:_||v,b=(T&&p?(T+p)/2:T||p)||0,C=100*i.sendPacketLossRate*.7/50+.3*b/1500,N=C<.17?1:C<.36?2:C<.59?3:C<.1?4:5,x=s==null?void 0:s.track;if(x&&x._encoderConfig&&x._hints.indexOf(Ln.SCREEN_TRACK)===-1){const B=x._encoderConfig.bitrateMax,F=i.bitrate.actualEncoded;if(B&&F){const H=(1e3*B-F)/(1e3*B);return MW[H<.15?0:H<.3?1:H<.45?2:H<.6?3:4][N]}}return N}getDownlinkNetworkQuality(){if(!this.recvConnection)return 0;const i=this.recvConnection.getStats();let s=0;return Array.from(this.remoteUserMap.entries()).forEach(a=>{let[u]=a;const h=u._audioSSRC,p=u._videoSSRC,_=i.audioRecv.find(F=>F.ssrc===h),v=i.videoRecv.find(F=>F.ssrc===p);if(!_&&!v)return void(s+=1);const T=oo(this,ut.NeedSignalRTT),b=i.rtt,C=(b&&T?(b+T)/2:b||T)||0,N=_?_.jitterMs:void 0,x=i.recvPacketLossRate;let B=.7*x*100/50+.3*C/1500;N&&(B=.6*x*100/50+.2*C/1500+.2*N/400),s+=B<.1?1:B<.17?2:B<.36?3:B<.59?4:5}),this.remoteUserMap.size>0?Math.round(s/this.remoteUserMap.size):s}async muteLocalTrack(i){return new le((s,a)=>{this.handleMuteLocalTrack(i,s,a)})}filterTobePublishedTracks(i,s,a){const u=[],h=In(),p=this.getAllTracks();i=B_(i=i.filter(T=>p.indexOf(T)===-1));let _=!1,v=!1;for(const T of i){if(T instanceof Ct&&(this.localTrackMap.has(Te.LocalVideoTrack)||_?new Ee(z.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(u.push({track:T,type:Te.LocalVideoTrack}),_=!0),s)){const b=this.getLowVideoTrack(T,a);u.push({track:b,type:Te.LocalVideoLowTrack})}if(T instanceof cn){const b=this.localTrackMap.get(Te.LocalAudioTrack);if(b){if(!(b.track instanceof Ni))throw new Ee(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(T._bypassWebAudio)throw new Ee(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");b.track.addAudioTrack(T),this.bindLocalAudioTrackEvents(T,!0)}else if(v){const C=u.find(N=>{let{type:x}=N;return x===Te.LocalAudioTrack});if(!(C.track instanceof Ni))throw new Ee(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(T._bypassWebAudio)throw new Ee(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");C.track.addAudioTrack(T)}else{if(!h.webAudioMediaStreamDest||T instanceof Ni||T._bypassWebAudio)u.push({track:T,type:Te.LocalAudioTrack});else{const C=new Ni;C.addAudioTrack(T),u.push({track:C,type:Te.LocalAudioTrack})}v=!0}}}return u}filterTobeUnpublishedTracks(i){const s=[],a=this.getAllTracks();i=B_(i=i.filter(u=>a.indexOf(u)!==-1));for(const u of i){if(u instanceof cn){const h=this.localTrackMap.get(Te.LocalAudioTrack);if(!h)continue;h.track instanceof Ni?(h.track.removeAudioTrack(u),this.unbindLocalAudioTrackEvents(u),h.track.trackList.length===0&&(s.push([Te.LocalAudioTrack,h]),h.track.close())):s.push([Te.LocalAudioTrack,h])}if(u instanceof Ct){const h=this.localTrackMap.get(Te.LocalVideoTrack);if(!h)continue;s.push([Te.LocalVideoTrack,h]);const p=this.localTrackMap.get(Te.LocalVideoLowTrack);p&&s.push([Te.LocalVideoLowTrack,p])}}return s}bindLocalTrackEvents(i){i.forEach(s=>{let{track:a,type:u}=s;switch(u){case Te.LocalVideoTrack:a.addListener(qe.GET_STATS,this.handleGetLocalVideoStats),a.addListener(qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.addListener(qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.addListener(qe.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),a.addListener(qe.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),a.addListener(qe.NEED_REPLACE_TRACK,this.handleReplaceTrack),a.addListener(qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.addListener(qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Te.LocalAudioTrack:this.bindLocalAudioTrackEvents(a);case Te.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(i,s){i instanceof Ni?i.trackList.forEach(a=>{a.addListener(qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.addListener(qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.addListener(qe.GET_STATS,this.handleGetLocalAudioStats),a.addListener(qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.addListener(qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(i.addListener(qe.GET_STATS,this.handleGetLocalAudioStats),i.addListener(qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),i.addListener(qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),i.addListener(qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),i.addListener(qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),s||i.addListener(qe.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(i){i||(i=Array.from(this.localTrackMap.entries()).map(s=>{let[a,{track:u}]=s;return{track:u,type:a}})),i.forEach(s=>{let{track:a,type:u}=s;switch(u){case Te.LocalVideoTrack:a.off(qe.GET_STATS,this.handleGetLocalVideoStats),a.off(qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.off(qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.off(qe.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),a.off(qe.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),a.off(qe.NEED_REPLACE_TRACK,this.handleReplaceTrack),a.off(qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.off(qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Te.LocalAudioTrack:this.unbindLocalAudioTrackEvents(a);case Te.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(i){i instanceof Ni?i.trackList.forEach(s=>{s.off(qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.off(qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.off(qe.GET_STATS,this.handleGetLocalAudioStats),s.off(qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.off(qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(i.off(qe.GET_STATS,this.handleGetLocalAudioStats),i.off(qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),i.off(qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),i.off(qe.NEED_REPLACE_TRACK,this.handleReplaceTrack),i.off(qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),i.off(qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(i,s){s instanceof tu&&s.addListener(qe.GET_STATS,a=>{a(this.handleGetRemoteVideoStats(i))}),s instanceof _c&&s.addListener(qe.GET_STATS,a=>{a(this.handleGetRemoteAudioStats(i))})}unbindRemoteTrackEvents(i){i&&i.removeAllListeners(qe.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(i=>{let[s,a]=i;a.has(Qe.AUDIO)&&this.unbindRemoteTrackEvents(s._audioTrack),a.has(Qe.VIDEO)&&this.unbindRemoteTrackEvents(s._videoTrack)})}createGatewayPublishMessage(i){return i.map(s=>{var a;let u,h,{track:p,type:_}=s;switch(_){case Te.LocalAudioTrack:u=gn.Audio,h={dtx:p instanceof Mh&&p._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case Te.LocalVideoTrack:u=ot(a=p._hints).call(a,Ln.SCREEN_TRACK)?gn.Screen:gn.High,h=Yh(Yh({},YI(p)),{},{codec:this.store.codec});break;case Te.LocalVideoLowTrack:u=gn.Low,h=Yh(Yh({},YI(p)),{},{codec:this.store.codec})}return{kind:_===Te.LocalAudioTrack?Qe.AUDIO:Qe.VIDEO,stream_type:u,attributes:h,isMuted:p.muted||!p.enabled}})}createGatewayUnpublishMessage(i){return i.map(s=>{var a;let u,[h,{track:p,ssrcs:_,id:v}]=s;switch(h){case Te.LocalVideoTrack:u=ot(a=p._hints).call(a,Ln.SCREEN_TRACK)?gn.Screen:gn.High;break;case Te.LocalAudioTrack:u=gn.Audio;break;case Te.LocalVideoLowTrack:u=gn.Low}return{stream_type:u,ssrcs:_,mid:v}})}assignLocalTracks(i){i.forEach(s=>{let{track:a,type:u}=s;this.localTrackMap.set(u,{track:a})})}withdrawLocalTracks(i){i.forEach(s=>{let[a]=s;this.localTrackMap.delete(a)})}bindConnectionEvents(i){i.onConnectionStateChange=async s=>{var a;if(D.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(s,")")),this.emit(ut.PeerConnectionStateChange,s),s!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),ot(a=this._restartStates).call(a,s)||i.direction===q_.SEND_ONLY){if(this._restartTimer)return;const u=()=>{(i.iceConnectionState==="disconnected"||i.iceConnectionState==="checking"||i.iceConnectionState==="failed")&&(D.debug("[".concat(this.store.clientId,"] [P2PChannel] start use restartICE")),oo(this,ut.QueryClientConnectionState)==="CONNECTED"&&this.restartICE(i))};this._restartTimer=window.setTimeout(()=>{u(),this._restartTimer=void 0},800)}},i.onICEConnectionStateChange=s=>{s!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),D.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(s,")")),it.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:s,tag:Yn.TRACER}).onSuccess(),this.emit(ut.IceConnectionStateChange,s)},i.onICETransportStateChange=s=>{D.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(s,")"))},i.onDTLSTransportStateChange=s=>{D.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(s,")"))},i.onDTLSTransportError=s=>{D.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(s,")"))},i.onFirstAudioDecoded=s=>{var a;const u=Array.from(Fs(a=this.remoteUserMap).call(a)).find(p=>p._audioSSRC===s);var h;u&&(this.store.subscribe(u.uid,"audio",void 0,void 0,void 0,Date.now()),(h=u.audioTrack)===null||h===void 0||h.emit(Jp.FIRST_FRAME_DECODED),it.firstRemoteFrame(this.store.sessionId,rr.FIRST_AUDIO_DECODE,$n.FIRST_AUDIO_DECODE,{peer:u._uintid,subscribeElapse:Br.measureFromSubscribeStart(this.store.clientId,s),subscribeRequestid:s,p2pid:this.store.p2pId}))},i.onFirstAudioReceived=s=>{var a;const u=Array.from(Fs(a=this.remoteUserMap).call(a)).find(h=>h._audioSSRC===s);u&&it.firstRemoteFrame(this.store.sessionId,rr.FIRST_AUDIO_RECEIVED,$n.FIRST_AUDIO_RECEIVED,{peer:u._uintid,subscribeElapse:Br.measureFromSubscribeStart(this.store.clientId,s),subscribeRequestid:s,p2pid:this.store.p2pId})},i.onFirstVideoDecoded=(s,a,u)=>{this.reportVideoFirstFrameDecoded(s,a,u)},i.onFirstVideoReceived=s=>{var a;const u=Array.from(Fs(a=this.remoteUserMap).call(a)).find(h=>h._videoSSRC===s);u&&it.firstRemoteFrame(this.store.sessionId,rr.FIRST_VIDEO_RECEIVED,$n.FIRST_VIDEO_RECEIVED,{peer:u._uintid,subscribeElapse:Br.measureFromSubscribeStart(this.store.clientId,s),subscribeRequestid:s,p2pid:this.store.p2pId})},i.onSelectedLocalCandidateChanged=(s,a)=>{const u=s.candidateType==="relay",h=a.candidateType==="relay";a.candidateType!=="unknown"&&u===h||this.emit(ut.ConnectionTypeChange,u),D.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(Hh(a))," -> ").concat(JSON.stringify(Hh(s)),")"))},i.onSelectedRemoteCandidateChanged=(s,a)=>{D.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(Hh(a))," -> ").concat(JSON.stringify(Hh(s)),")"))},i.onFirstVideoDecodedTimeout=s=>{this.reportVideoFirstFrameDecoded(s,void 0,void 0,!0)},i.onLocalCandidate=s=>{this.emit(ut.LocalCandidate,s)}}unbindConnectionEvents(i){i.onConnectionStateChange=void 0,i.onICEConnectionStateChange=void 0,i.onICETransportStateChange=void 0,i.onDTLSTransportStateChange=void 0,i.onDTLSTransportError=void 0,i.onFirstAudioDecoded=void 0,i.onFirstAudioReceived=void 0,i.onFirstVideoDecoded=void 0,i.onFirstVideoReceived=void 0,i.onSelectedLocalCandidateChanged=void 0,i.onSelectedRemoteCandidateChanged=void 0,i.onFirstVideoDecodedTimeout=void 0,i.onLocalCandidate=void 0}filterTobeMutedTracks(i){const s=[];if(this.getAllTracks().indexOf(i)===-1)return s;const a=this.localTrackMap.get(Te.LocalAudioTrack);if(i instanceof cn&&(a==null?void 0:a.track)instanceof Ni)return a.track.isActive||s.push([Te.LocalAudioTrack,a]),s;const u=Array.from(this.localTrackMap.entries()).find(h=>{let[,{track:p}]=h;return i===p});if(u&&(s.push(u),u[0]===Te.LocalVideoTrack)){const h=this.localTrackMap.get(Te.LocalVideoLowTrack);h&&s.push([Te.LocalVideoLowTrack,h])}return s}filterTobeUnmutedTracks(i){const s=[],a=this.localTrackMap.get(Te.LocalAudioTrack);if(i instanceof cn&&(a==null?void 0:a.track)instanceof Ni)return a.track.isActive&&s.push([Te.LocalAudioTrack,a]),s;const u=Array.from(this.localTrackMap.entries()).find(h=>{let[,{track:p}]=h;return i===p});if(u)if(u[0]===Te.LocalVideoTrack){s.push(u);const h=this.localTrackMap.get(Te.LocalVideoLowTrack);h&&s.push([Te.LocalVideoLowTrack,h])}else s.push(u);return s}createMuteMessage(i){return i.map(s=>{var a;let u,[h,{track:p,ssrcs:_,id:v}]=s;switch(h){case Te.LocalAudioTrack:u=gn.Audio;break;case Te.LocalVideoTrack:u=ot(a=p._hints).call(a,Ln.SCREEN_TRACK)?gn.Screen:gn.High;break;case Te.LocalVideoLowTrack:u=gn.Low}return{stream_type:u,ssrcs:_,mid:v}})}createUnmuteMessage(i){return i.map(s=>{var a;let u,[h,{track:p,ssrcs:_,id:v}]=s;switch(h){case Te.LocalAudioTrack:u=gn.Audio;break;case Te.LocalVideoTrack:u=ot(a=p._hints).call(a,Ln.SCREEN_TRACK)?gn.Screen:gn.High;break;case Te.LocalVideoLowTrack:u=gn.Low}return{stream_type:u,ssrcs:_,mid:v}})}filterTobeUnSubscribedTracks(i,s){const a=[],u=this.remoteUserMap.get(i);if(!u)return a;if(s){const h=u.get(s);if(!h)return a;a.push([i,{kind:s,id:h}])}else Array.from(u.entries()).forEach(h=>{let[p,_]=h;a.push([i,{kind:p,id:_}])});return a}createUnsubscribeMessage(i){const s=[];return i.forEach(a=>{let[u,{kind:h,id:p}]=a;switch(h){case Qe.VIDEO:return void(u._videoSSRC&&s.push({stream_type:Qe.VIDEO,ssrcId:u._videoSSRC}));case Qe.AUDIO:return void(u._audioSSRC&&s.push({stream_type:Qe.AUDIO,ssrcId:u._audioSSRC}))}}),s}withdrawRemoteTracks(i){i.forEach(s=>{let[a,{kind:u}]=s;const h=this.remoteUserMap.get(a);h&&(h.delete(u),Array.from(h.entries()).length===0&&this.remoteUserMap.delete(a))})}async updateBitrateLimit(i){const s=this.localTrackMap.get(Te.LocalVideoTrack),a=this.localTrackMap.get(Te.LocalVideoLowTrack);s&&await s.track.setBitrateLimit(i.uplink),a&&i.low_stream_uplink&&await a.track.setBitrateLimit({max_bitrate:i.low_stream_uplink.bitrate,min_bitrate:i.low_stream_uplink.bitrate||0})}isP2PDisconnected(){if(this.sendConnection&&this.recvConnection){const i=this.sendConnection.peerConnectionState,s=this.recvConnection.peerConnectionState;return i!=="connected"&&s!=="connected"}return!0}async tryToUnmuteAudio(i){for(let s=0;s<i.length;s++)if(i[s]instanceof cn){const a=this.filterTobeUnmutedTracks(i[s]);if(a.length===0)continue;const u=this.createUnmuteMessage(a);return void await bn(this,ut.RequestUnmuteLocal,u)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=i=>this.getStats(i),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()).filter(i=>{let[,{ssrcs:s}]=i;return!!s}),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=i=>{var s;return!((s=this.recvConnection)===null||s===void 0||!s.getRemoteVideoIsReady(i))},this.statsUploader.requestUpload=(i,s)=>this.emit(ut.RequestUploadStats,i,s),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await xr(aI(this.dtlsFailedCount,Oi)),this.emit(ut.RequestReconnect)}async reconnectP2P(){}canPublishLowStream(){return this.localTrackMap.has(Te.LocalVideoTrack)||this.pendingLocalTracks.some(i=>i instanceof Ct)}throwIfTrackTypeNotMatch(i){if(i.filter(s=>s instanceof Ct).length>1)throw new Ee(z.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(i.filter(s=>s instanceof cn).length>1&&(i.some(s=>s instanceof cn&&s._bypassWebAudio)||!In().webAudioMediaStreamDest))throw new Ee(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const s of i){if(s instanceof Ct&&this.pendingLocalTracks.some(a=>a instanceof Ct))throw new Ee(z.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(s instanceof cn&&this.pendingLocalTracks.some(a=>a instanceof cn)&&(!In().webAudioMediaStreamDest||s._bypassWebAudio||this.pendingLocalTracks.some(a=>a instanceof cn&&a._bypassWebAudio)))throw new Ee(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(i,s){const a=!te("DISABLE_DUAL_STREAM_USE_ENCODING")&&In().supportDualStreamEncoding,u=Yh(Yh({},{width:160,height:120,framerate:15,bitrate:50}),s);let h;h=a?i._mediaStreamTrack.clone():DU(i,u);const p=wn(8,"track-low-"),_=new Ct(h,Yh(Yh({},a&&{scaleResolutionDownBy:gU(u,i)}),{},{frameRate:u.framerate,bitrateMax:u.bitrate,bitrateMin:u.bitrate}),void 0,void 0,p);return _.on(Q_.TRANSCEIVER_UPDATED,v=>{i._updateRtpTransceiver(v,kh.LOW_STREAM)}),_._hints.push(Ln.LOW_STREAM),i.addListener(qe.NEED_CLOSE,()=>{_.close()}),_}async globalLock(){return this.recvMutex.lock("From P2PChannel2.globalLock")}reportVideoFirstFrameDecoded(i,s,a,u){var h;const p=Array.from(Fs(h=this.remoteUserMap).call(h)).find(_=>_._videoSSRC===i);if(p){u||this.store.subscribe(p.uid,"video",void 0,void 0,void 0,void 0,Date.now());const _=this.store.keyMetrics,v=_.subscribe.find(T=>T.userId===p.uid&&T.type==="video");it.firstRemoteVideoDecode(this.store.sessionId,rr.FIRST_VIDEO_DECODE,$n.FIRST_VIDEO_DECODE,{peer:p._uintid,videowidth:s,videoheight:a,subscribeElapse:Br.measureFromSubscribeStart(this.store.clientId,i),subscribeRequestid:i,p2pid:this.store.p2pId,apEnd:_.requestAPEnd||0,apStart:_.requestAPStart||0,joinGwEnd:_.joinGatewayEnd||0,joinGwStart:_.joinGatewayStart||0,pcEnd:_.peerConnectionEnd||0,pcStart:_.peerConnectionStart||0,subscriberEnd:(v==null?void 0:v.subscribeEnd)||0,subscriberStart:(v==null?void 0:v.subscribeStart)||0,videoAddNotify:(v==null?void 0:v.streamAdded)||0,state:u?1:0})}}async remoteMediaSsrcChanged(i,s,a){if(!this.recvConnection)return!1;const u=this.remoteUserMap.get(i);if(!u)return!1;const h=u.get(s);if(!h)return!1;const p=await this.recvConnection.getRemoteSSRC(h);return p!==void 0&&p!==a}resetConnection(i){D.debug("[".concat(this.store.clientId,"] [P2PChannel2] reset connection to ").concat(i)),this.state===Xt.Connected?(D.debug("[".concat(this.store.clientId,"] [P2PChannel2] fallback to websocket but P2PChannel2 state still connected, disconnect first")),this.disconnectForReconnect()):(this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0))}async publishDataChannel(i){throw new Ee(z.NOT_SUPPORTED)}async unpublishDataChannel(i){throw new Ee(z.NOT_SUPPORTED)}async subscribeDataChannel(i,s){throw new Ee(z.NOT_SUPPORTED)}async unsubscribeDataChannel(i,s){throw new Ee(z.NOT_SUPPORTED)}hasPendingRemoteDataChannel(i,s){throw new Ee(z.NOT_SUPPORTED)}setPendingRemoteDataChannel(i,s){throw new Ee(z.NOT_SUPPORTED)}async preConnect(i,s,a,u,h,p){throw new Ee(z.NOT_SUPPORTED)}getEstablishParams(){throw new Ee(z.NOT_SUPPORTED)}async reSubscribe(i){throw new Ee(z.NOT_SUPPORTED)}async updateVideoStreamParameter(i,s){throw new Ee(z.NOT_SUPPORTED)}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(i=>{let[s,{track:a}]=i;s===Te.LocalVideoLowTrack?a._updateRtpTransceiver(void 0,kh.LOW_STREAM):a._updateRtpTransceiver(void 0)})}}function Ka(o){return function(i,s,a){const u=i[s];if(typeof u!="function")throw new Error("Cannot use mutex on object property.");return a.value=async function(){for(var h=arguments.length,p=new Array(h),_=0;_<h;_++)p[_]=arguments[_];switch(o){case Ga.SEND_ONLY:{const v=await this.sendMutex.lock("From P2PChannel2.".concat(s));try{return await u.apply(this,p)}finally{v()}}case Ga.RECEIVE_ONLY:{const v=await this.recvMutex.lock("From P2PChannel2.".concat(s));try{return await u.apply(this,p)}finally{v()}}default:{const v=await this.sendMutex.lock("From P2PChannel2.".concat(s)),T=await this.recvMutex.lock("From P2PChannel2.".concat(s));try{return await u.apply(this,p)}finally{v(),T()}}}},a}}function e9(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function t9(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?e9(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):e9(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}ve([Ka(),j("design:type",Function),j("design:paramtypes",[Object,String]),j("design:returntype",le)],ri.prototype,"startP2P",null),ve([Ka(),j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",le)],ri.prototype,"p2pConnect",null),ve([Ka(Ga.SEND_ONLY),j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",le)],ri.prototype,"dopublish",null),ve([Ka(Ga.SEND_ONLY),j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",le)],ri.prototype,"unpublish",null),ve([Ka(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",le)],ri.prototype,"unpublishLowStream",null),ve([Ka(Ga.SEND_ONLY),j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",le)],ri.prototype,"doUnpublish",null),ve([Ka(Ga.RECEIVE_ONLY),j("design:type",Function),j("design:paramtypes",[Wr,String,String,Number]),j("design:returntype",le)],ri.prototype,"subscribe",null),ve([Ka(Ga.RECEIVE_ONLY),j("design:type",Function),j("design:paramtypes",[Wr,String,String,Boolean]),j("design:returntype",le)],ri.prototype,"unsubscribe",null),ve([Ka(Ga.RECEIVE_ONLY),j("design:type",Function),j("design:paramtypes",[Wr,String]),j("design:returntype",le)],ri.prototype,"muteRemote",null),ve([Ka(Ga.RECEIVE_ONLY),j("design:type",Function),j("design:paramtypes",[Wr,String]),j("design:returntype",le)],ri.prototype,"unmuteRemote",null),ve([Ka(Ga.RECEIVE_ONLY),j("design:type",Function),j("design:paramtypes",[Wr,String]),j("design:returntype",le)],ri.prototype,"hasRemoteMediaWithLock",null),ve([Ka(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",le)],ri.prototype,"disconnectForReconnect",null),ve([Ka(Ga.RECEIVE_ONLY),j("design:type",Function),j("design:paramtypes",[Wr,String,Number]),j("design:returntype",le)],ri.prototype,"remoteMediaSsrcChanged",null);const jde=Date.now(),Fde=20,$U=new Map,_A=new Map;async function n9(o){const i=$U.get(o),s=Array.isArray(i)&&i[i.length-1],a=_A.get(o);if(!s)return void(a.isSyncing=!1);const u={uid:s.uid,payload:iI(s.payload)};a.firstRecvTs===0&&(a.firstRecvTs=s.recvTs,a.firstSendTs=s.sendTs);const h=s.sendTs-a.firstSendTs,p=h-(Date.now()-a.firstRecvTs);p>0&&(a.firstRecvTs=Date.now()-h);let _=s.mediaDelay+p;_<=0?(i.pop(),i9(s.context,u),_=0):_=Math.min(_,Fde),setTimeout(()=>i.length&&n9(o),_)}function i9(o,i){o.safeEmit(Dt.STREAM_MESSAGE,i.uid,i.payload),o.onStreamMessage&&o.onStreamMessage(i)}function Vde(o){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2?arguments[2]:void 0;if(!o.syncWithAudio)return i9(s,{uid:o.uid,payload:iI(o.payload)});const a="".concat(s.id,"-").concat(o.uid),u=$U.get(a)||[],h=u.findIndex(T=>o.sendTs>=T.sendTs),p=t9(t9({},o),{},{context:s,mediaDelay:i,recvTs:Date.now()});h===-1?u.push(p):u.splice(h,0,p),$U.set(a,u);let _=!1;var v;_A.has(a)?_=!((v=_A.get(a))===null||v===void 0||!v.isSyncing):_A.set(a,{isSyncing:_,firstRecvTs:0,firstSendTs:0}),_||n9(a)}const Bde=Zt().name;function Wde(){return!function(o,i,s){const a=Zt();if(a.os!==tr.IOS||!a.osVersion)return!1;const u=a.osVersion.split(".");return s?i&&Number(u[0])===o&&Number(u[1])<i||Number(u[0])<o:i?Number(u[0])===o&&Number(u[1])<=i||Number(u[0])<o:Number(u[0])<=o}(16,0,!0)&&!function(o,i,s){const a=Zt();if(a.name!==an.SAFARI||!a.osVersion)return!1;const u=a.version.split(".");return s?i&&Number(u[0])===o&&Number(u[1])<i||Number(u[0])<o:i?Number(u[0])===o&&Number(u[1])<=i||Number(u[0])<o:Number(u[0])<=o}(16,0,!0)}function r9(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function bS(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?r9(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):r9(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}fr.setLogger(D);class Cn extends Hn{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get localDataChannels(){return this._p2pChannel.getAllDataChannels()}get mode(){return this._config.mode}get role(){var i;return((i=this._config)===null||i===void 0?void 0:i.role)||"audience"}get codec(){return this._config.codec}get audioCodec(){return this._config.audioCodec||"opus"}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}get __className__(){return"Client"}constructor(i){let s;if(super(),O(this,"store",void 0),O(this,"_uid",void 0),O(this,"_channelName",void 0),O(this,"_uintUid",void 0),O(this,"_users",[]),O(this,"_config",void 0),O(this,"_clientId",void 0),O(this,"_appId",void 0),O(this,"_sessionId",null),O(this,"_key",void 0),O(this,"_joinInfo",void 0),O(this,"_gateway",void 0),O(this,"_statsCollector",void 0),O(this,"_configDistribute",void 0),O(this,"_leaveMutex",new fr("client-leave")),O(this,"_publishMutex",new fr("client-publish")),O(this,"_renewTokenMutex",new fr("client-renewtoken")),O(this,"_subscribeMutex",new fr("client-subscribe")),O(this,"_encryptionMode","none"),O(this,"_encryptionSecret",null),O(this,"_encryptionSalt",null),O(this,"_proxyServer",void 0),O(this,"_turnServer",{servers:[],mode:"auto"}),O(this,"_cloudProxyServerMode","disabled"),O(this,"_isDualStreamEnabled",!1),O(this,"_defaultStreamFallbackType",void 0),O(this,"_lowStreamParameter",void 0),O(this,"_streamFallbackTypeCacheMap",new Map),O(this,"_remoteStreamTypeCacheMap",new Map),O(this,"_axiosCancelSource",ao.CancelToken.source()),O(this,"_audioVolumeIndicationInterval",void 0),O(this,"_networkQualityInterval",void 0),O(this,"_userOfflineTimeout",void 0),O(this,"_streamRemovedTimeout",void 0),O(this,"_injectStreamingClient",void 0),O(this,"_liveTranscodeStreamingClient",void 0),O(this,"_liveRawStreamingClient",void 0),O(this,"_channelMediaRelayClient",void 0),O(this,"_networkQualitySensitivity","normal"),O(this,"_p2pChannel",void 0),O(this,"_useLocalAccessPoint",!1),O(this,"_setLocalAPVersion",void 0),O(this,"_joinAndNotLeaveYet",!1),O(this,"_numberOfJoinCount",0),O(this,"_remoteDefaultVideoStreamType",void 0),O(this,"_inspect",void 0),O(this,"_moderation",void 0),O(this,"_license",void 0),O(this,"_pendingPublishedUsers",[]),O(this,"ntpAlignErrorCount",0),O(this,"remoteInboundOffset",0),O(this,"_handleLocalTrackEnable",(a,u,h)=>{this.publish(a,!1).then(u).catch(h)}),O(this,"_handleLocalTrackDisable",(a,u,h)=>{this.unpublish(a).then(u).catch(h)}),O(this,"_handleUserOnline",a=>{if(te("BLOCK_LOCAL_CLIENT")&&qp(a.uid,this.channelName))return void D.debug("[".concat(a.uid,"] will be ignored in local"));this.isStringUID&&typeof a.uid!="string"&&D.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID"));const u=this._users.find(h=>h.uid===a.uid);if(u)u._trust_in_room_=!0;else{const h=new Wr(a.uid,a.uint_id||a.uid);this._users.push(h),D.debug("[".concat(this._clientId,"] user online"),a.uid),this.safeEmit(Dt.USER_JOINED,h)}}),O(this,"_handleUserOffline",a=>{if(te("BLOCK_LOCAL_CLIENT")&&qp(a.uid,this.channelName))return;const u=this._users.find(h=>h.uid===a.uid);u&&(this._handleRemoveStream(a),this._handleRemoveDataChannels(a),KM(this._users,u),this._remoteStreamTypeCacheMap.delete(u.uid),this._streamFallbackTypeCacheMap.delete(u.uid),D.debug("[".concat(this._clientId,"] user offline"),a.uid,"reason:",a.reason),this.safeEmit(Dt.USER_LEAVED,u,a.reason))}),O(this,"_handleAddAudioOrVideoStream",(a,u,h,p,_,v,T)=>{if(te("BLOCK_LOCAL_CLIENT")&&qp(u,this.channelName))return;const b=this._users.find(N=>N.uid===u);if(!b)return void D.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));D.debug("[".concat(this._clientId,"] stream added with uid ").concat(u,", type ").concat(a)),this.store.subscribe(b.uid,a,void 0,void 0,void 0,Date.now());const C=a==="audio"?b.hasAudio:b.hasVideo;b._uintid||(b._uintid=_||u),a==="audio"?b._trust_audio_stream_added_state_=!0:b._trust_video_stream_added_state_=!0,a==="audio"?(b._audio_added_=!0,h!==void 0&&(b._audioSSRC=h),p!==void 0&&(b._cname=p),v&&(b._audioOrtc=v)):(b._video_added_=!0,h!==void 0&&(b._videoSSRC=h),p!==void 0&&(b._cname=p),T!==void 0&&(b._rtxSsrcId=T),v&&(b._videoOrtc=v)),(a==="audio"?b.hasAudio:b.hasVideo)&&!C&&(D.info("[".concat(this._clientId,"] remote user ").concat(b.uid," published ").concat(a)),this.safeEmit(Dt.USER_PUBLISHED,b,a)),a==="video"?it.onGatewayStream(this._sessionId,rr.ON_ADD_VIDEO_STREAM,$n.ON_ADD_VIDEO_STREAM,{peer:_||u,ssrc:b._videoSSRC}):it.onGatewayStream(this._sessionId,rr.ON_ADD_AUDIO_STREAM,$n.ON_ADD_AUDIO_STREAM,{peer:_||u,ssrc:b._audioSSRC}),this._p2pChannel.remoteMediaSsrcChanged(b,a,h).then(N=>{if(N&&(D.debug("[".concat(this._clientId,"] resubscribe ").concat(a," for user ").concat(b.uid," after rejoin because SSRC id changed.")),this._p2pChannel instanceof Er))return this._p2pChannel.unsubscribe(b,a,!0).then(()=>this._subscribe(b,a,!0).catch(x=>{D.error("[".concat(this._clientId,"] resubscribe error"),x.toString())}))}),this._p2pChannel.hasPendingRemoteMedia(b,a)&&(D.debug("[".concat(this._clientId,"] resubscribe ").concat(a," for user ").concat(b.uid," after reconnect.")),this._subscribe(b,a,!0).catch(N=>{D.error("[".concat(this._clientId,"] resubscribe error"),N.toString())}))}),O(this,"_handleRemoveStream",(a,u,h)=>{if(te("BLOCK_LOCAL_CLIENT")&&qp(a.uid,this.channelName))return;const p=this._users.find(v=>v.uid===a.uid);if(!p)return void D.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)"));D.debug("[".concat(this._clientId,"] stream removed with uid ").concat(a.uid));let _=()=>{};if(p.hasAudio&&p.hasVideo?_=()=>{D.info("[".concat(this._clientId,"] remote user ").concat(p.uid," unpublished audio track")),this.safeEmit(Dt.USER_UNPUBLISHED,p,"audio"),D.info("[".concat(this._clientId,"] remote user ").concat(p.uid," unpublished video track")),this.safeEmit(Dt.USER_UNPUBLISHED,p,"video")}:p.hasVideo?_=()=>{D.info("[".concat(this._clientId,"] remote user ").concat(p.uid," unpublished video track")),this.safeEmit(Dt.USER_UNPUBLISHED,p,"video")}:p.hasAudio&&(_=()=>{D.info("[".concat(this._clientId,"] remote user ").concat(p.uid," unpublished audio track")),this.safeEmit(Dt.USER_UNPUBLISHED,p,"audio")}),p._trust_audio_stream_added_state_=!0,p._trust_video_stream_added_state_=!0,p._audio_added_=!1,p._video_added_=!1,this._p2pChannel instanceof Er)this._p2pChannel.unsubscribe(p).then(v=>{if(v)return this._gateway.unsubscribe(v,p.uid)});else if(u&&h)if(a.sdp){const{sdp:v}=a;this._p2pChannel.unsubscribe(p,v).then(T=>{T&&u(T)}).catch(h)}else u&&u();p._audioSSRC=void 0,p._videoSSRC=void 0,p._audioOrtc=void 0,p._videoOrtc=void 0,p._rtxSsrcId=void 0,it.onGatewayStream(this._sessionId,rr.ON_REMOVE_STREAM,$n.ON_REMOVE_STREAM,{peer:a.uint_id||a.uid}),_()}),O(this,"_handleSetStreamLocalEnable",(a,u,h)=>{if(te("BLOCK_LOCAL_CLIENT")&&qp(u,this.channelName))return;const p=this._users.find(T=>T.uid===u);if(!p)return void D.error("[".concat(this._clientId,"] can not find target user!(disable_local)"));D.debug("[".concat(this._clientId,"] local ").concat(a," ").concat(h?"enabled":"disabled"," with uid ").concat(u));const _=a==="audio"?p.hasAudio:p.hasVideo;if(a==="audio"){p._trust_audio_enabled_state_=!0;const T=p._audio_enabled_;if(p._audio_enabled_=h,p._audio_enabled_===T)return;{const b=p._audio_enabled_?"enable-local-audio":"disable-local-audio";D.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(u,", msg: ").concat(b)),this.safeEmit(Dt.USER_INFO_UPDATED,u,b)}}else{p._trust_video_enabled_state_=!0;const T=p._video_enabled_;if(p._video_enabled_=h,p._video_enabled_===T)return;{const b=p._video_enabled_?"enable-local-video":"disable-local-video";D.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(u,", msg: ").concat(b)),this.safeEmit(Dt.USER_INFO_UPDATED,u,b)}}const v=a==="audio"?p.hasAudio:p.hasVideo;return _!==v?!_&&v?(D.info("[".concat(this._clientId,"] remote user ").concat(u," published ").concat(a)),void this.safeEmit(Dt.USER_PUBLISHED,p,a)):(a==="video"&&p._videoTrack&&p._videoTrack._destroy(),a==="audio"&&p._audioTrack,this._p2pChannel.muteRemote(p,a),D.info("[".concat(this._clientId,"] remote user ").concat(u," unpublished ").concat(a)),void this.safeEmit(Dt.USER_UNPUBLISHED,p,a)):void 0}),O(this,"_handleMuteStream",(a,u,h,p,_,v)=>{if(te("BLOCK_LOCAL_CLIENT")&&qp(a,this.channelName))return;D.debug("[".concat(this._clientId,"] receive mute message"),a,u,h);const T=this._users.find(N=>N.uid===a);if(!T)return void D.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(a));const b=u==="audio"?T.hasAudio:T.hasVideo;if(u==="audio"){T._trust_audio_mute_state_=!0;const N=T._audio_muted_;if(T._audio_muted_=h,T._audio_muted_===N)return;{const x=T._audio_muted_?"mute-audio":"unmute-audio";D.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(a,", msg: ").concat(x)),this.safeEmit(Dt.USER_INFO_UPDATED,a,x)}}else{T._trust_video_mute_state_=!0;const N=T._video_muted_;if(T._video_muted_=h,T._video_muted_===N)return;{const x=T._video_muted_?"mute-video":"unmute-video";D.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(a,", msg: ").concat(x)),this.safeEmit(Dt.USER_INFO_UPDATED,a,x)}}const C=u==="audio"?T.hasAudio:T.hasVideo;if(b!==C){if(!b&&C)return!this.store.useP2P&&!(u==="audio"?T._audioSSRC:T._videoSSRC)?void D.warning("[".concat(this._clientId,"] remote user ").concat(a," receive ").concat(u," unmute message  before add stream message, ").concat(u," SSRC doesn't exist yet.")):(D.info("[".concat(this._clientId,"] remote user ").concat(a," published ").concat(u)),void this.safeEmit(Dt.USER_PUBLISHED,T,u));u==="video"&&T._videoTrack&&T._videoTrack._destroy(),u==="audio"&&T._audioTrack,_&&v&&this._p2pChannel instanceof ri&&(p?this._p2pChannel.unsubscribe(T,p,u).then(N=>{_(N)}).catch(v):_()),this._p2pChannel.muteRemote(T,u),D.info("[".concat(this._clientId,"] remote user ").concat(a," unpublished ").concat(u)),this.safeEmit(Dt.USER_UNPUBLISHED,T,u)}}),O(this,"_handleP2PLost",async a=>{D.debug("[".concat(this._clientId,"] receive p2p lost"),a),parseInt(a.p2pid,10)===this.store.p2pId?await this._p2pChannel.requestReconnect():D.warning("[".concat(this._clientId,"] P2PLost stream not found"),a)}),O(this,"_handleTokenWillExpire",()=>{D.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),this.safeEmit(Dt.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)}),O(this,"_handleBeforeUnload",a=>{a.type==="beforeunload"&&a.returnValue!==void 0&&a.returnValue!==""||(this.leave(),D.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")))}),O(this,"_handleUpdateNetworkQuality",()=>{if(this._networkQualitySensitivity==="normal")return;if(navigator&&navigator.onLine!==void 0&&!navigator.onLine)return void this.safeEmit(Dt.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const a={downlinkNetworkQuality:0,uplinkNetworkQuality:0};a.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),a.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.safeEmit(Dt.NETWORK_QUALITY,a)}),O(this,"_handleP2PAddAudioOrVideoStream",(a,u)=>{const h=this._users.find(_=>_.uid===u);if(!h)return void D.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));D.debug("[".concat(this._clientId,"] stream added with uid ").concat(u,", type ").concat(a)),this.store.subscribe(h.uid,a,void 0,void 0,void 0,Date.now());const p=a==="audio"?h.hasAudio:h.hasVideo;a==="audio"?h._trust_audio_stream_added_state_=!0:h._trust_video_stream_added_state_=!0,a==="audio"?h._audio_added_=!0:h._video_added_=!0,(a==="audio"?h.hasAudio:h.hasVideo)&&!p&&(D.info("[".concat(this._clientId,"] remote user ").concat(h.uid," published ").concat(a)),this.safeEmit(Dt.USER_PUBLISHED,h,a)),this._p2pChannel.hasPendingRemoteMedia(h,a)&&(D.debug("[".concat(this._clientId,"] resubscribe ").concat(a," for user ").concat(h.uid," after reconnect.")),this._subscribe(h,a,!0).catch(_=>{D.error("[".concat(this._clientId,"] resubscribe error"),_.toString())}))}),this._config=i,this._clientId=wn(5,"client-"),this.store=new Kce(i.codec,i.audioCodec,i.mode,this._clientId),this.store.clientCreated(),i.proxyServer&&this.setProxyServer(i.proxyServer,!0),i.turnServer&&this.setTurnServer(i.turnServer,!0),D.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat(Ua," build: ").concat(_2,", mode: ").concat(this.mode,", codec: ").concat(this.codec)),i.clientRoleOptions)try{b8(i.clientRoleOptions),s=Object.assign({},i.clientRoleOptions)}catch(a){D.warning("[".concat(this._clientId,"] ").concat(a.toString()))}this._statsCollector=new cE(this.store),this._statsCollector.onStatsException=(a,u,h)=>{D.debug("[".concat(this._clientId,"] receive exception msg, code: ").concat(a,", msg: ").concat(u,", uid: ").concat(h)),this.safeEmit(Dt.EXCEPTION,{code:a,msg:u,uid:h})},this._statsCollector.onUploadPublishDuration=(a,u,h,p)=>{const _=this._users.find(v=>v.uid===a);_&&it.peerPublishStatus(this._sessionId,{subscribeElapse:p,audioPublishDuration:u,videoPublishDuration:h,peer:_._uintid})},this.store.useDataChannel=In().supportDataChannel&&te("SIGNAL_CHANNEL"),this.store.useP2P=te("P2P"),this._gateway=new Xue(this.store,{clientId:this._clientId,mode:this.mode,codec:this.codec,websocketRetryConfig:i.websocketRetryConfig||Oi,httpRetryConfig:i.httpRetryConfig||Oi,forceWaitGatewayResponse:i.forceWaitGatewayResponse===void 0||i.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:i.role,clientRoleOptions:s}),this._configDistribute=new sde,this.store.useP2P?(this._p2pChannel=new ri(this.store,this._statsCollector),this._handleP2PEvents()):this._p2pChannel=new Er(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents(),this._handleGatewaySignalEvents()}async joinMeta(i,s,a,u,h){let p=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5],_=arguments.length>6&&arguments[6]!==void 0&&arguments[6];Sn("JOIN_GATEWAY_USE_443PORT_ONLY",p),Sn("JOIN_GATEWAY_USE_DUAL_DOMAIN",_);const v=this._gateway.signal.websocket;return v instanceof X0&&(v.use443PortOnly=p,v.tryDoubleDomain=_),async function(T,b,C){JR.get(T)||JR.set(T,[]),QR.get(T)||QR.set(T,b),ql.get(T)||ql.set(T,0);const N=JR.get(T),x=QR.get(T);if(!N||!x)throw new Error("concurrent: deferQueue or maxConcurrency is null");if(ql.get(T)===x){const ee=W0();N.push(ee),await ee.promise}ql.set(T,ql.get(T)+1);for(var B=arguments.length,F=new Array(B>3?B-3:0),H=3;H<B;H++)F[H-3]=arguments[H];const J=await C(...F);return ql.set(T,ql.get(T)-1),ql.get(T)===x-1&&N.length>0&&(N[0].resolve(),N.shift()),ql.get(T)===0&&(JR.set(T,[]),QR.set(T,0),ql.set(T,0)),J}("client.join",te("JOIN_MAX_CONCURRENCY"),this.join.bind(this),i,s,a,u,h)}async join(i,s,a,u,h){const p=++this._numberOfJoinCount;this.store.joinStart(),u&&(this.store.uid=u);const _=Gce(),v=IW()?window.isSecureContext:"Browser Not Support";if(!IW()&&!_||!window.isSecureContext){const F="The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser";D.warning(F)}const T=qM();this.connectionState==="DISCONNECTED"&&(this.store.avoidJoinStart=Math.round(Date.now()),D.debug("[".concat(this._clientId,"] set avoidJoinStart to ").concat(this.store.avoidJoinStart)));const b=it.reportApiInvoke(T,{name:Mi.JOIN,options:[i,s,a,u],states:{isHttps:_,isSecureContext:v},tag:Yn.TRACER});it.setAppId(i);try{if(!a&&a!==null)throw new ae(z.INVALID_PARAMS,"Invalid token: ".concat(a,". If you don not use token, set it to null"));a&&jr(a,"token",1,2047),jr(i,"appid",1,2047),S2(s),u&&T2(u),h&&jr(h,"optionalInfo",1,2047)}catch(F){throw b.onError(F),F}if(D.info("[".concat(this._clientId,"] start join channel ").concat(s,", join number: ").concat(p)),this._leaveMutex.isLocked&&(D.debug("[".concat(this._clientId,"] join: waiting leave operation")),(await this._leaveMutex.lock())(),D.debug("[".concat(this._clientId,"] join: continue"))),this._joinAndNotLeaveYet=!0,this.connectionState!=="DISCONNECTED"){const F=new ae(z.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state"));throw b.onError(F),F}this._sessionId||(this._sessionId=T,this.store.sessionId=this._sessionId),this._gateway.state="CONNECTING";const C=bS({clientId:this._clientId,appId:i,sid:this._sessionId,cname:s,uid:typeof u!="string"?u:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:a||i,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:h,license:this._license,useLocalAccessPoint:this._useLocalAccessPoint},this._remoteDefaultVideoStreamType!==void 0&&{defaultVideoStream:this._remoteDefaultVideoStreamType});if(this._useLocalAccessPoint&&(C.setLocalAPVersion=this._setLocalAPVersion),typeof u=="string"&&(C.stringUid=u,this._uintUid?(C.uid=this._uintUid,this._uintUid=void 0):C.uid=0),this._encryptionMode!=="none"&&this._encryptionSecret){if(C.aesmode=this._encryptionMode,C.aespassword=await ece(this._encryptionSecret),!this._joinAndNotLeaveYet)throw new ae(z.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this._encryptionSalt&&(C.aessalt=this._encryptionSalt)}this._startSession(this._sessionId,{channel:s,appId:i});const N=this._sessionId;setTimeout(()=>{this.connectionState==="CONNECTING"&&N===this._sessionId&&it.joinChannelTimeout(this._sessionId,5)},5e3);try{var x;let F;const H=C.cloudProxyServer;if(ot(x=["proxy3","proxy4","proxy5"]).call(x,H)){const ye=te("PROXY_SERVER_TYPE3");Array.isArray(ye)?C.proxyServer=ye[0]:C.proxyServer=ye}if(it.setProxyServer(C.proxyServer),D.setProxyServer(C.proxyServer),this.store.requestAPStart(),C.stringUid&&!C.uid){const ye=await HH(C.stringUid,C,this._axiosCancelSource.token,this._config.httpRetryConfig||Oi,this.store);D.debug("[".concat(this._clientId,"] getUserAccount Success ").concat(C.stringUid," => ").concat(ye)),C.uid=ye,F=await WH(C,this._axiosCancelSource.token,this._config.httpRetryConfig||Oi,!0,this.store)}else F=await WH(C,this._axiosCancelSource.token,this._config.httpRetryConfig||Oi,!0,this.store);if(!this._joinAndNotLeaveYet)throw new ae(z.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this.store.requestAPEnd(),setTimeout(()=>{this._configDistribute.startGetConfigDistribute(C,this._axiosCancelSource.token),this._configDistribute.on(Y0.UPDATE_BITRATE_LIMIT,ye=>{this._p2pChannel.updateBitrateLimit(ye)})},0),this._key=a||i;const J=F.gatewayInfo;this._joinInfo=bS(bS({},C),{},{cid:J.cid,uid:C.uid?C.uid:J.uid,vid:J.vid,apResponse:J.res,uni_lbs_ip:J.uni_lbs_ip,gatewayAddrs:J.gatewayAddrs});const ee=await this._joinGateway();if(!this._joinAndNotLeaveYet)throw new ae(z.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));b.onSuccess(ee),this._appId=i,this._channelName=C.cname,this._uid=ee,this.store.uid=ee,setTimeout(()=>{this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),window.addEventListener(fs()?"beforeunload":"pagehide",this._handleBeforeUnload)},0);const se=C.stringUid?"string uid: ".concat(C.stringUid,",uid: ").concat(C.uid):"uid: ".concat(this._uid);return D.info("[".concat(this._clientId,"] Joining channel success: channel: ").concat(s,",").concat(se)),setTimeout(()=>{D.startUpload()},5e3),this.store.joinEnd(),B=this,ot(Nh).call(Nh,B)||Nh.push(B),ee}catch(F){const H=Array.isArray(F)?F[0]:F;throw H&&H.code===z.OPERATION_ABORTED?D.warning("[".concat(this._clientId,"] join number: ").concat(p,", Joining channel failed, rollback"),H):D.error("[".concat(this._clientId,"] join number: ").concat(p,", Joining channel failed, rollback"),H),H.code!==z.OPERATION_ABORTED&&this._numberOfJoinCount===p&&(this._gateway.state="DISCONNECTED",this._reset()),b.onError(H),H}var B}_joinGateway(){if(!this._joinInfo||!this._key)throw new ae(z.INVALID_OPERATION);return this._gateway.join(this._joinInfo,this._key,!(this._joinInfo.cloudProxyServer!=="disabled"||this._joinInfo.proxyServer||!te("JOIN_WITH_FALLBACK_SIGNAL_PROXY"))).then(i=>i).catch(i=>{if(i.code===z.INIT_WEBSOCKET_TIMEOUT)return this._gateway.leave(!0,Pt.FALLBACK),i;if(i.code===z.INIT_DATACHANNEL_TIMEOUT)return this._gateway.leave(!0,Pt.FALLBACK),i;throw i}).then(i=>{if(i instanceof ae){if(i.code===z.INIT_WEBSOCKET_TIMEOUT){if(D.info("[".concat(this._clientId,"] join timeout, fallback to proxy")),!this._joinInfo||!this._key)throw new ae(z.INVALID_OPERATION);this._joinInfo.cloudProxyServer="fallback",this._cloudProxyServerMode="fallback",this.store.cloudProxyServerMode="fallback";const s=te("PROXY_SERVER_TYPE3");if(Array.isArray(s))if(this._joinInfo.apUrl){const u=/^https?:\/\/(.+?)(\/.*)?$/.exec(this._joinInfo.apUrl)[1].split("."),h=u.slice(u.length-2).join(".");s.forEach(p=>{this._joinInfo&&ot(p).call(p,h)&&(this._joinInfo.proxyServer=p)}),this._joinInfo.proxyServer||(this._joinInfo.proxyServer=s[0])}else this._joinInfo.proxyServer=s[0];else this._joinInfo.proxyServer=s;const a=te("LOG_UPLOAD_SERVER").match(/.+:(\d{1,5})$/);return a&&a[1]&&a[1]!=="443"&&D.setProxyServer(this._joinInfo.proxyServer),te("STATS_COLLECTOR_PORT").toString()!=="443"&&it.setProxyServer(this._joinInfo.proxyServer),it.reportApiInvoke(this._sessionId,{name:Mi.JOIN_FALLBACK_TO_PROXY,options:[this._joinInfo.proxyServer],tag:Yn.TRACER}).onSuccess(),this.safeEmit(Dt.JOIN_FALLBACK_TO_PROXY,this._joinInfo.proxyServer),te("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&this._joinInfo.turnServer.servers.forEach(u=>{"forceturn"in u&&(u.forceturn=!0)}),this._gateway.join(this._joinInfo,this._key)}if(D.info("[".concat(this._clientId,"] join by datachannel timeout, fallback to websocket")),!this._joinInfo||!this._key)throw new ae(z.INVALID_OPERATION);return it.reportApiInvoke(this._sessionId,{name:Mi.DATACHANNEL_FAILBACK,options:[this.store.clientId],tag:Yn.TRACER}).onSuccess(),this._joinGateway()}return i}).then(i=>i)}async leave(){D.info("[".concat(this._clientId,"] Leaving channel")),window.removeEventListener(fs()?"beforeunload":"pagehide",this._handleBeforeUnload),this._reset(),function(s){const a=Nh.indexOf(s);a!==-1&&Nh.splice(a,1)}(this);const i=await this._leaveMutex.lock();if(this.connectionState==="DISCONNECTED")return D.info("[".concat(this._clientId,"] Leaving channel repeated, success")),void i();await this._gateway.leave(this.connectionState!=="CONNECTED"),D.info("[".concat(this._clientId,"] Leaving channel success")),this._joinAndNotLeaveYet=!1,this.store.resetJoinChannelServiceRecords(),i()}async publish(i){let s=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!Array.isArray(i)){if(!(i instanceof Vr))return this._publishDataChannel(i);i=[i]}if(i.length===0)throw new ae(z.INVALID_PARAMS,"param list is empty");const a=i;if(this._gateway.role==="audience")throw new ae(z.INVALID_OPERATION,"audience can not publish stream");for(const h of a){if(!(h instanceof Vr))throw new ae(z.INVALID_PARAMS,"parameter is not local track");if(!h._enabled&&s)throw new ae(z.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(h.getTrackId()))}D.info("[".concat(this._clientId,"] Publishing tracks, id ").concat(a.map(h=>"".concat(h.getTrackId()," "))));const u=await this._publishMutex.lock();await this._configDistribute.awaitConfigDistributeComplete(),s&&a.forEach(h=>{const p=this._configDistribute.getBitrateLimit();h instanceof Ct&&p&&h.setBitrateLimit(p.uplink)});try{await this._publishHighStream(a),D.info("[".concat(this._clientId,"] Publish success, id ").concat(a.map(h=>"".concat(h.getTrackId()," "))))}catch(h){throw D.error("[".concat(this._clientId,"] publish error"),h.toString()),h}finally{u()}}async _publishDataChannel(i){Tn(i.id,"id",0,65535,!0),Wp(i.ordered,"ordered"),jr(i.metadata,"metadata",0,512),D.info("[".concat(this._clientId,"] Publishing datachannels, id ").concat(i.id));const s=await this._publishMutex.lock();try{if(this._p2pChannel.getAllDataChannels().findIndex(u=>u.id===i.id)!==-1)throw new ae(z.INVALID_PARAMS,"Invalid id: ".concat(i.id,". If you want to republish the datachannel, unpublish first"));if(!this._joinInfo||this._uid===void 0)throw new ae(z.INVALID_OPERATION,"Can't publish datachannel, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new ae(z.INVALID_OPERATION,"can not publish datachannel in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&te("FORCE_TURN")&&!te("TURN_ENABLE_TCP")&&!te("TURN_ENABLE_UDP"))throw new ae(z.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");const a=new bH(i);await this._p2pChannel.publishDataChannel([a]);try{const u={streamId:i.id,ordered:i.ordered,maxRetransmits:te("DATASTREAM_MAX_RETRANSMITS"),metadata:i.metadata,channelId:a._originDataChannelId};await this._gateway.publishDataChannel(this._uid,u,!0)}catch(u){if(u.code!==z.DISCONNECT_P2P)throw u}return await a._waitTillOpen(),D.info("[".concat(this._clientId,"] Publish dataChannels success, id ").concat(a.id)),a}catch(a){throw D.error("[".concat(this._clientId,"] publish datachannels error"),a.toString()),a}finally{s()}}async unpublish(i){if(!this._joinInfo||this._uid===void 0)throw new ae(z.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");let s=[];if(i)if(Array.isArray(i))s=i;else{if(!(i instanceof Vr))return this._unpublishDataChannel([i]);s=[i]}else this.store.useP2P||await this._unpublishDataChannel(),s=this._p2pChannel.getAllTracks(!0);D.info("[".concat(this._clientId,"] Unpublish tracks, tracks ").concat(s.map(u=>"".concat(u.getTrackId()," "))," "));const a=await this._publishMutex.lock();try{if(this._p2pChannel instanceof ri){const u=await this._p2pChannel.unpublish(s);if(u){const h=await this._gateway.sendExtensionMessage(Pn.UNPUBLISH,u);h&&await this._p2pChannel.setDescription("local",h)}}else{const u=await this._p2pChannel.unpublish(s);u&&await this._gateway.unpublish(u,this._uid),D.info("[".concat(this._clientId,"] Unpublish success,tracks ").concat(s.map(h=>"".concat(h.getTrackId()))))}}catch(u){throw D.error("[".concat(this._clientId,"] unpublish error"),u.toString()),u}finally{a&&a()}}async _unpublishDataChannel(i){i!==void 0&&i.length!==0||(i=this._p2pChannel.getAllDataChannels()),D.info("[".concat(this._clientId,"] Unpublish datachannels, datachannels ").concat(i.map(a=>"".concat(a.id," "))," "));const s=await this._publishMutex.lock();try{const a=await this._p2pChannel.unpublishDataChannel(i);a&&await this._gateway.unpublishDataChannel(a),D.info("[".concat(this._clientId,"] Unpublish dataChannel success,dataChannel ").concat(i.map(u=>"".concat(u.id))))}catch(a){throw D.error("[".concat(this._clientId,"] unpublish dataChannel error"),a.toString()),a}finally{s&&s()}}async subscribe(i,s,a){return s==="datachannel"?this._subscribeDataChannel(i,a):this._subscribe(i,s)}async _subscribeDataChannel(i,s){var a;if(Tn(s,"channelId",0,65535,!0),!this._joinInfo)throw new ae(z.INVALID_OPERATION,"Can't subscribe datachannel, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new ae(z.INVALID_OPERATION,"Can't subscribe datachannel in ".concat(this.connectionState," state"));if(!this._users.find(_=>_===i))throw D.error("[".concat(this._clientId,"] can not subscribe ").concat(i.uid,", this user is not in the channel")),new ae(z.INVALID_REMOTE_USER,"user is not in the channel");if(!i.hasAudio&&!i.hasVideo&&i._dataChannels.length===0)throw D.error("[".concat(this._clientId,"] can not subscribe ").concat(i.uid,", user is not published")),new ae(z.INVALID_REMOTE_USER,"user is not published");const u=(a=i._dataChannels)===null||a===void 0?void 0:a.find(_=>_.id===s);if(!u)throw D.error("[".concat(this._clientId,"] can not subscribe ").concat(i.uid," with mediaType datachannel, remote datachannel is not published")),new ae(z.REMOTE_USER_IS_NOT_PUBLISHED);const h=await this._subscribeMutex.lock();D.info("[".concat(this._clientId,"] subscribe user ").concat(i.uid,", mediaType: datachannel"));try{const _=await this._p2pChannel.subscribeDataChannel(i,[u]);if(_&&ot(_).call(_,u.id))try{var p;if(!u._originDataChannelId)throw D.error("[".concat(this._clientId,"] can not subscribe ").concat(i.uid," with mediaType datachannel, cannot get RTCDatachannel")),new ae(z.REMOTE_USER_IS_NOT_PUBLISHED);const v={id:u.id,datachannelId:u._originDataChannelId,ordered:u.ordered,maxRetransmits:u.maxRetransmits,metadata:(p=u.metadata)!==null&&p!==void 0?p:""};await this._gateway.subscribeDataChannel(i.uid,v,!0)}catch(v){if((v==null?void 0:v.code)!==z.WS_ABORT)throw await this._p2pChannel.unsubscribeDataChannel(i,[u]),v;await this._p2pChannel.unsubscribeDataChannel(i,[u]),this._p2pChannel.setPendingRemoteDataChannel(i,u.id)}return await u._waitTillOpen(),D.info("[".concat(this._clientId,"] subscribe success user ").concat(i.uid,", mediaType: datachannel")),u}finally{h()}}async _p2pSubscribe(i,s,a){if(nr(s,"mediaType",["audio","video"]),!this._joinInfo)throw new ae(z.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new ae(z.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(p=>p===i)){const p=new ae(z.INVALID_REMOTE_USER,"user is not in the channel");throw D.error("[".concat(this._clientId,"] can not subscribe ").concat(i.uid,", this user is not in the channel")),p}if(!i.hasAudio&&!i.hasVideo){const p=new ae(z.INVALID_REMOTE_USER,"user is not published");throw D.error("[".concat(this._clientId,"] can not subscribe ").concat(i.uid,", user is not published")),p}if(!a&&(s==="audio"&&!i.hasAudio||s==="video"&&!i.hasVideo)){const p=new ae(z.REMOTE_USER_IS_NOT_PUBLISHED);throw D.error("[".concat(this._clientId,"] can not subscribe ").concat(i.uid," with mediaType ").concat(s,", remote track is not published")),p}const u=await this._subscribeMutex.lock();D.info("[".concat(this._clientId,"] subscribe user ").concat(i.uid,", mediaType: ").concat(s));const h=s==="audio"?Te.LocalAudioTrack:this._joinInfo.defaultVideoStream===RI.LOW_STREAM?Te.LocalVideoLowTrack:Te.LocalVideoTrack;try{await this._p2pChannel.hasRemoteMediaWithLock(i,s)?await this._p2pChannel.unmuteRemote(i,s):(this.store.subscribe(i.uid,s,Date.now()),this._p2pChannel instanceof ri&&await this._gateway.sendExtensionMessage(Pn.SUBSCRIBE,{trackType:h})),D.info("[".concat(this._clientId,"] subscribe success user ").concat(i.uid,", mediaType: ").concat(s)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(i.uid,this._defaultStreamFallbackType).catch(_=>{D.warning("[".concat(this._clientId,"] auto set fallback failed"),_)});const p=s==="audio"?i._audioTrack:i._videoTrack;if(!p)throw new ae(z.UNEXPECTED_ERROR,"can not find remote track in user object");return p}catch(p){throw D.error("[".concat(this._clientId,"] subscribe user ").concat(i.uid," error"),p),p}finally{u()}}async _subscribe(i,s,a){if(this._p2pChannel instanceof ri)return this._p2pSubscribe(i,s);if(nr(s,"mediaType",["audio","video"]),!this._joinInfo)throw new ae(z.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new ae(z.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(T=>T===i)){const T=new ae(z.INVALID_REMOTE_USER,"user is not in the channel");throw D.error("[".concat(this._clientId,"] can not subscribe ").concat(i.uid,", this user is not in the channel")),T}if(!i.hasAudio&&!i.hasVideo){const T=new ae(z.INVALID_REMOTE_USER,"user is not published");throw D.error("[".concat(this._clientId,"] can not subscribe ").concat(i.uid,", user is not published")),T}if(!(a||(s!=="audio"||i.hasAudio&&i._audioSSRC!==void 0)&&(s!=="video"||i.hasVideo&&i._videoSSRC!==void 0))){const T=new ae(z.REMOTE_USER_IS_NOT_PUBLISHED);throw D.error("[".concat(this._clientId,"] can not subscribe ").concat(i.uid," with mediaType ").concat(s,", remote track is not published")),T}let u=s==="audio"?i._audioSSRC:i._videoSSRC,h=s==="audio"?i._audioOrtc:i._videoOrtc,p=s==="video"?i._rtxSsrcId:void 0,_={stream_type:s==="audio"?Qe.AUDIO:Qe.VIDEO,ssrcId:u};const v=await this._subscribeMutex.lock();D.info("[".concat(this._clientId,"] subscribe user ").concat(i.uid,", mediaType: ").concat(s));try{if(await this._p2pChannel.hasRemoteMediaWithLock(i,s))await this._p2pChannel.unmuteRemote(i,s);else try{const b=s==="audio"?i._audioSSRC:i._videoSSRC;b!==void 0&&b!==u&&(u=b,h=s==="audio"?i._audioOrtc:i._videoOrtc,p=s==="video"?i._rtxSsrcId:void 0,_={stream_type:s==="audio"?Qe.AUDIO:Qe.VIDEO,ssrcId:u}),Br.markSubscribeStart(this.store.clientId,u),this.store.subscribe(i.uid,s,Date.now()),await this._p2pChannel.subscribe(i,s,u,p,h);try{await this._gateway.subscribe(i.uid,_,!0)}catch(C){if((C==null?void 0:C.code)!==z.WS_ABORT)throw await this._p2pChannel.unsubscribe(i,s),C;await this._p2pChannel.unsubscribe(i,s,!0),this._p2pChannel.setPendingRemoteMedia(i,s)}this.store.subscribe(i.uid,s,void 0,Date.now()),this._p2pChannel.reportSubscribeEvent(!0,null,i,s)}catch(b){throw this._p2pChannel.reportSubscribeEvent(!1,b==null?void 0:b.code,i,s),b}D.info("[".concat(this._clientId,"] subscribe success user ").concat(i.uid,", mediaType: ").concat(s)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(i.uid,this._defaultStreamFallbackType).catch(b=>{D.warning("[".concat(this._clientId,"] auto set fallback failed"),b)});const T=s==="audio"?i._audioTrack:i._videoTrack;if(!T)throw new ae(z.UNEXPECTED_ERROR,"can not find remote track in user object");return T}catch(T){throw D.error("[".concat(this._clientId,"] subscribe user ").concat(i.uid," error"),T),T}finally{v()}}async massSubscribe(i){if(sd(i,"subscribeList"),!this._joinInfo)throw new ae(z.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new ae(z.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));const s=Date.now(),a=new Map,u=await this._subscribeMutex.lock();D.info("[".concat(this._clientId,"]start massSubscribe user ").concat(i.map(v=>{let{user:T,mediaType:b}=v;return"user: ".concat(T==null?void 0:T.uid,", mediaType: ").concat(b)}).join("; ")));const h=(i=[...i]).map(v=>{let{user:T,mediaType:b}=v;return{user:T,mediaType:b}}),p=await this._p2pChannel.globalLock();try{var _;for(let T=i.length-1;T>=0;T--){const b=i[T],{user:C,mediaType:N}=b;if(nr(N,"mediaType",["audio","video"]),!C){const F=new ae(z.INVALID_PARAMS,"user property does not exist in subscribeList item");throw D.error("[".concat(this._clientId,"] user property does not exist in subscribeList item")),F}if(!this._users.find(F=>F===C)){const F=new ae(z.INVALID_REMOTE_USER,"user is not in the channel");D.error("[".concat(this._clientId,"] can not massSubscribe ").concat(C.uid,", this user is not in the channel")),h[T].error=F,i.splice(T,1);continue}if(N==="audio"&&(!C.hasAudio||C._audioSSRC===void 0)||N==="video"&&(!C.hasVideo||C._videoSSRC===void 0)){const F=new ae(z.REMOTE_USER_IS_NOT_PUBLISHED);D.error("[".concat(this._clientId,"] can not subscribe ").concat(C.uid," with mediaType ").concat(N,", remote user is not published")),h[T].error=F,i.splice(T,1);continue}const x=Ui.Video|Ui.LwoVideo,B=a.get(C);if(B){if(N==="video"?B&x:B&Ui.Audio){i.splice(T,1),D.warning("[".concat(this._clientId,"] repeat massSubscribe user:").concat(C.uid,", mediaType:").concat(N," twice"));continue}a.set(C,B|(N==="video"?x:Ui.Audio))}else a.set(C,N==="video"?x:Ui.Audio)}for(let T=i.length-1;T>=0;T--){const b=i[T],{user:C,mediaType:N}=b,x=Ui.Video|Ui.LwoVideo;if(this._p2pChannel.hasRemoteMedia(C,N)){await this._p2pChannel.unmuteRemoteNoLock(C,N);const B=a.get(C);a.set(C,N==="video"?B^x:B^Ui.Audio),i.splice(T,1)}}this.store.massSubscribe(i.map(T=>({userId:T.user.uid,type:T.mediaType})),s);const v=zp(_=Array.from(a.entries())).call(_,(T,b)=>{let[C,N]=b;if(N===0)return T;const x={stream_id:C.uid,stream_type:N};return N&Ui.Audio&&(x.audio_ssrc=C._audioSSRC),N&Ui.Video&&(x.video_ssrc=C._videoSSRC),T.push(x),T},[]);try{i.length>0&&await this._p2pChannel.massSubscribeNoLock(i.map(b=>{let{user:C,mediaType:N}=b;return{user:C,mediaType:N,ssrcId:N===Qe.VIDEO?C._videoSSRC:C._audioSSRC,rtxSsrcId:N===Qe.VIDEO?C._rtxSsrcId:void 0}}));const T=new Map;if(v.length>0){const b=await this._gateway.subscribeAll(v,!0);((b==null?void 0:b.users)||[]).forEach(C=>{let{stream_id:N,video_error_code:x,audio_error_code:B,error_code:F}=C;(x||B||F)&&T.set(N,{video_error_code:x,audio_error_code:B,error_code:F})})}if(Array.from(T.entries()).length>0){const b=Array.from(T.entries()).map(C=>{let N,[x,B]=C;return B.error_code||B.video_error_code&&B.audio_error_code?N=void 0:B.video_error_code?N=Qe.VIDEO:B.audio_error_code&&(N=Qe.AUDIO),{user:this.remoteUsers.find(F=>F.uid===x),mediaType:N}});await this._p2pChannel.massUnsubscribeNoLock(b)}for(const b of h){const C=T.get(b.user.uid);if(C){const N=C.error_code||b.mediaType==="audio"&&C.audio_error_code||b.mediaType==="video"&&C.video_error_code;if(N){const x=Xp(N);D.error("user:".concat(b.user.uid," mediaType:").concat(b.mediaType," has massSubscribe error ").concat(x.desc)),b.error=new ae(z.SUBSCRIBE_FAILED,"code ".concat(N,": ").concat(x.desc))}}b.error||(b.mediaType==="video"?b.track=b.user.videoTrack:b.track=b.user.audioTrack)}return this.store.massSubscribe(h.filter(b=>!b.error).map(b=>({userId:b.user.uid,type:b.mediaType})),void 0,Date.now()),h.forEach(b=>{var C;it.subscribe(this.store.sessionId,{succ:!!b.error,ec:((C=b.error)===null||C===void 0?void 0:C.code)||null,video:b.mediaType===Qe.VIDEO,audio:b.mediaType===Qe.AUDIO,peerid:b.user.uid,subscribeRequestid:b.mediaType===Qe.VIDEO?b.user._videoSSRC:b.user._audioSSRC,p2pid:this.store.p2pId,eventElapse:Math.floor(performance.now()-s)},!0)}),D.info("[".concat(this._clientId,"] massSubscribe success ").concat(i.map(b=>{let{user:C,mediaType:N}=b;return"user: ".concat(C==null?void 0:C.uid,", mediaType: ").concat(N)}).join("; "))),h}catch(T){throw await this._p2pChannel.massUnsubscribeNoLock(i),T}}finally{p(),u()}}async unsubscribe(i,s,a){if(s||this.store.useP2P){if(s==="datachannel")return this._unsubscribeDataChannel(i,a)}else await this._unsubscribeDataChannel(i,a);if(s&&nr(s,"mediaType",["audio","video"]),!this._joinInfo)throw new ae(z.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");if(!this._users.find(h=>h===i)){const h=new ae(z.INVALID_REMOTE_USER,"user is not in the channel");throw D.error("[".concat(this._clientId,"] can not unsubscribe ").concat(i.uid,", user is not in the channel")),h}D.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(i.uid,", mediaType: ").concat(s));const u=await this._subscribeMutex.lock();try{if(this._p2pChannel instanceof ri)await this._gateway.sendExtensionMessage(Pn.UNSUBSCRIBE,{mediaType:s});else{const h=await this._p2pChannel.unsubscribe(i,s);h&&await this._gateway.unsubscribe(h,i.uid),D.info("[".concat(this._clientId,"] unsubscribe success uid: ").concat(i.uid,", mediaType: ").concat(s))}}catch(h){if(h.code===z.DISCONNECT_P2P)return void D.warning("disconnecting p2p, abort unsubscribe request.");throw D.error("[".concat(this._clientId,"] unsubscribe user ").concat(i.uid," error"),h.toString()),h}finally{u()}}async _unsubscribeDataChannel(i,s){if(s&&Tn(s,"id",0,65535,!0),!this._joinInfo)throw new ae(z.INVALID_OPERATION,"Can't unsubscribe datachannel, haven't joined yet!");if(!this._users.find(u=>u===i)){const u=new ae(z.INVALID_REMOTE_USER,"user is not in the channel");throw D.error("[".concat(this._clientId,"] can not unsubscribe ").concat(i.uid,", user is not in the channel")),u}let a;if(typeof s=="number"){const u=i._dataChannels.find(h=>h.id===s);u&&(a=[u])}else a=i._dataChannels;if(a===void 0){const u=new ae(z.REMOTE_USER_IS_NOT_PUBLISHED);throw D.error("[".concat(this._clientId,"] can not unsubscribe ").concat(i.uid," with channelId ").concat(s,", remote datachannel is not published")),u}D.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(i.uid,", mediaType: datachannel, ids: ").concat(a.map(u=>u.id)));try{const u=await this._p2pChannel.unsubscribeDataChannel(i,a);u&&await this._gateway.unsubscribeDataChannel(u,i.uid),D.info("[".concat(this._clientId,"] unsubscribe datachannel success uid: ").concat(i.uid,", mediaType: datachannel, ids: ").concat(u))}catch(u){if(u.code===z.DISCONNECT_P2P)return void D.warning("disconnecting p2p, abort unsubscribe request.");throw D.error("[".concat(this._clientId,"] unsubscribe user ").concat(i.uid," error"),u.toString()),u}}async massUnsubscribe(i){if(sd(i,"unsubscribeList"),!this._joinInfo)throw new ae(z.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");D.info("[".concat(this._clientId,"] start massUnsubscribe ").concat(i.map(a=>{let{user:u,mediaType:h}=a;return"user: ".concat(u==null?void 0:u.uid,", mediaType: ").concat(h,";")}).join())),i=[...i];const s=new Map;for(let a=i.length-1;a>=0;a--){const{user:u,mediaType:h}=i[a];if(!u){const _=new ae(z.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw D.error("[".concat(this._clientId,"] user property does not exist in unsubscribeList item")),_}if(nr(h,"mediaType",["video","audio",void 0]),!this._users.find(_=>_===u)){D.warning("[".concat(this._clientId,"] can not unsubscribe ").concat(u.uid,", user is not in the channel")),i.splice(a,1);continue}const p=Ui.Video|Ui.LwoVideo;if(s.has(u)){const _=s.get(u);let v;switch(h){case"video":v=_&p;break;case"audio":v=_&Ui.Audio;break;default:v=_&(Ui.Audio|p)}if(v){D.warning("[".concat(this._clientId,"] repeat massUnsubscribe user:").concat(u.uid,",mediaType:").concat(h," twice.")),i.splice(a,1);continue}h?h==="audio"?s.set(u,_|Ui.Audio):h==="video"&&s.set(u,_|p):s.set(u,_|Ui.Audio|p)}else h?h==="audio"?s.set(u,Ui.Audio):h==="video"&&s.set(u,p):s.set(u,Ui.Audio|p)}try{const a=await this._p2pChannel.massUnsubscribe(i);a&&await this._gateway.massUnsubscribe(a),D.info("[".concat(this._clientId,"] massUnsubscribe success ").concat(i.map(u=>{let{user:h,mediaType:p}=u;return"user: ".concat(h==null?void 0:h.uid,", mediaType: ").concat(p,";")}).join()))}catch(a){if(a.code===z.DISCONNECT_P2P)return void D.warning("[".concat(this._clientId,"] disconnecting p2p, abort unsubscribe request."));throw D.error("[".concat(this._clientId,"] massUnsubscribe error"),a.toString()),a}}async setLowStreamParameter(i){(function(a){if(!a)throw new Ee(z.INVALID_PARAMS);Jn(a.width)||$M(a.width,"streamParameter.width"),Jn(a.height)||$M(a.height,"streamParameter.height"),Jn(a.framerate)||$M(a.framerate,"streamParameter.framerate"),Jn(a.bitrate)||Tn(a.bitrate,"streamParameter.bitrate")})(i),(!i.width&&i.height||i.width&&!i.height)&&D.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),D.info("[".concat(this._clientId,"] set low stream parameter to"),JSON.stringify(i));const s=this._configDistribute.getLowStreamConfigDistribute();if(s&&s.bitrate&&i.bitrate&&s.bitrate<i.bitrate&&(i.bitrate=s.bitrate),this._lowStreamParameter=i,this._isDualStreamEnabled)return this._p2pChannel.updateVideoStreamParameter(i,Te.LocalVideoLowTrack)}async enableDualStream(){if(!In().supportDualStream)throw it.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),new ae(z.NOT_SUPPORTED,"Your browser is not support dual stream");if(this._isDualStreamEnabled)throw new ae(z.INVALID_OPERATION,"Dual stream is already enabled");if(this._p2pChannel.canPublishLowStream())try{await this._publishLowStream()}catch(i){throw it.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),i}this._isDualStreamEnabled=!0,it.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),D.info("[".concat(this._clientId,"] enable dual stream"))}async disableDualStream(){if(this._isDualStreamEnabled){if(!this._joinInfo)throw new ae(z.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this._p2pChannel.getLocalMedia(Te.LocalVideoLowTrack))try{const i=await this._p2pChannel.unpublishLowStream();i&&await this._gateway.unpublish(i,this._joinInfo.stringUid||this._joinInfo.uid)}catch(i){throw it.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),i}this._isDualStreamEnabled=!1,it.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),D.info("[".concat(this._clientId,"] disable dual stream"))}}async setClientRole(i,s){if(function(a){nr(a,"role",["audience","host"])}(i),s&&b8(s),this.mode==="rtc")throw D.warning("[".concat(this._clientId,"]rtc mode can not use setClientRole")),new ae(z.INVALID_OPERATION,"rtc mode can not use setClientRole");if(s&&s.level&&i==="host")throw new ae(z.INVALID_OPERATION,"host mode can not set audience latency level");if(i==="audience"&&this._p2pChannel.hasLocalMedia())throw new ae(z.INVALID_OPERATION,"can not set client role to audience when publishing stream");await this._gateway.setClientRole(i,s),this._config.role=i,D.info("[".concat(this._clientId,"] set client role to ").concat(i,", level: ").concat(s&&s.level))}getRemoteInboundOffset(){var i;const s=(i=this._p2pChannel.getStats())===null||i===void 0?void 0:i.audioSend[0];if(!s||!s.timestamp)return 0;const a=s.timestamp-Date.now();return Math.abs(a)>1e3+s.rttMs+100?this.ntpAlignErrorCount+=1:this.ntpAlignErrorCount=0,this.ntpAlignErrorCount>=3?a:0}getNtpWallTimeInMs(){return document.visibilityState==="visible"&&(this.remoteInboundOffset=this.getRemoteInboundOffset()),this.remoteInboundOffset+Date.now()+this._gateway.ntpOffset}setProxyServer(i,s){if(jr(i,"proxyServer"),!s){if(this.connectionState!=="DISCONNECTED")throw new ae(z.INVALID_OPERATION,"Set proxy server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new ae(z.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=i,it.setProxyServer(this._proxyServer),D.setProxyServer(this._proxyServer),D.info("[".concat(this._clientId,"] Set proxy server ").concat(s?"by initialize call":""," success."))}setTurnServer(i,s){if(Array.isArray(i)||(i=[i]),!s){if(this.connectionState!=="DISCONNECTED")throw new ae(z.INVALID_OPERATION,"Set turn server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new ae(z.INVALID_OPERATION,"You have already set the proxy")}if(V_(i))return this._turnServer={servers:i,mode:"original-manual"},void D.info("[".concat(this._clientId,"] Set original turnserver ").concat(s?"by initialize call":""," success: ").concat(i.map(a=>a.urls).join(","),"."));i.forEach(a=>T8(a)),this._turnServer={servers:i,mode:"manual"},D.info("[".concat(this._clientId,"] Set turnserver ").concat(s?"by initialize call":""," success."))}setLicense(i){if(this.connectionState!=="DISCONNECTED")throw new ae(z.INVALID_OPERATION,"you should set license before join channel");if(jr(i,"license",32,32),!/^[A-Za-z\d]+$/.test(i))throw new ae(z.INVALID_PARAMS,"license should only contains characters from A-Z a-z 0-9");this._license=i,D.info("[".concat(this._clientId,"] set license success"),i)}startProxyServer(i){if(this.connectionState!=="DISCONNECTED")throw new ae(z.INVALID_OPERATION,"Start proxy server before join channel");if(this._proxyServer||this._turnServer.mode==="manual"||this._useLocalAccessPoint)throw new ae(z.INVALID_OPERATION,"You have already set the proxy");const s=[3,4,5];let a;switch(i===void 0&&(i=3),i){case 1:case 2:throw new ae(z.NOT_SUPPORTED,"proxy mode 1/2 has been deprecated and not supported.");case 3:a="proxy3";break;case 4:a="proxy4";break;case 5:a="proxy5";break;default:throw new ae(z.INVALID_PARAMS,"proxy server mode must be ".concat(s.join("|")))}this._cloudProxyServerMode=a,this.store.cloudProxyServerMode=a,D.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode)}stopProxyServer(){if(this.connectionState!=="DISCONNECTED")throw new ae(z.INVALID_OPERATION,"Stop proxy server after leave channel");it.setProxyServer(),D.setProxyServer(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",D.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]}}setLocalAccessPointsV2(i){if(!i.accessPoints)throw new ae(z.INVALID_PARAMS,"accessPoints is required.");sd(i.accessPoints.serverList,"accessPoints.serverList"),jr(i.accessPoints.domain,"accessPoints.domain");const s=(x,B)=>{Tn(x,B,0,65535,!0)};let a=443;if(i.accessPoints.port&&(s(i.accessPoints.port,"accessPoints.port"),a=i.accessPoints.port),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new ae(z.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");te("CLOSE_AFB_FOR_LOCAL_AP")&&(Sn("JOIN_WITH_FALLBACK_SIGNAL_PROXY",!1),Sn("JOIN_WITH_FALLBACK_MEDIA_PROXY",!1));const u=/^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,h=i.accessPoints.domain,p=i.accessPoints.serverList.map(x=>u.test(x)?"".concat(x.replace(/\./g,"-"),".").concat(h):x),_=p.map(x=>"".concat(x,":").concat(a));this._useLocalAccessPoint=!0,this._setLocalAPVersion=2,Sn("WEBCS_DOMAIN",_),Sn("WEBCS_DOMAIN_BACKUP_LIST",_),Sn("GATEWAY_DOMAINS",[h]),i.report&&i.report.hostname&&Array.isArray(i.report.hostname)&&i.report.hostname.length?(sd(i.report.hostname,"report.hostname"),Sn("EVENT_REPORT_DOMAIN",i.report.hostname[0]),Sn("EVENT_REPORT_BACKUP_DOMAIN",i.report.hostname[1]||i.report.hostname[0])):(Sn("EVENT_REPORT_DOMAIN",p[0]),Sn("EVENT_REPORT_BACKUP_DOMAIN",p[1]||p[0]));let v=6443;i.report&&i.report.port&&(s(i.report.port,"report.port"),v=i.report.port),Sn("STATS_COLLECTOR_PORT",v),i.report?Sn("ENABLE_EVENT_REPORT",!0):Sn("ENABLE_EVENT_REPORT",!1);let T="";i.log&&i.log.hostname&&Array.isArray(i.log.hostname)&&i.log.hostname.length?(sd(i.log.hostname,"log.hostname"),T=i.log.hostname[0]):T=p[0];let b=6444;i.log&&i.log.port&&(s(i.log.port,"log.port"),b=i.log.port),Sn("LOG_UPLOAD_SERVER","".concat(T,":").concat(b));let C=[];i.cds&&i.cds.hostname&&Array.isArray(i.cds.hostname)&&i.cds.hostname.length?(sd(i.cds.hostname,"cds.hostname"),C=i.cds.hostname):C=p;let N=443;i.cds&&i.cds.port&&(s(i.cds.port,"cds.port"),N=i.cds.port),Sn("CDS_AP",C.map(x=>"".concat(x,":").concat(N))),i.cds?Sn("ENABLE_CONFIG_DISTRIBUTE",!0):Sn("ENABLE_CONFIG_DISTRIBUTE",!1),D.info("set local access point v2 success")}setLocalAccessPoints(i,s){if(sd(i,"serverList"),jr(s,"domain"),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new ae(z.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const a=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;i=i.map(u=>a.test(u)?"".concat(u.replace(/\./g,"-"),".").concat(s):u),this._useLocalAccessPoint=!0,this._setLocalAPVersion=1,Sn("WEBCS_DOMAIN",i),Sn("WEBCS_DOMAIN_BACKUP_LIST",i),Sn("GATEWAY_DOMAINS",[s]),Sn("EVENT_REPORT_DOMAIN",i[0]),Sn("EVENT_REPORT_BACKUP_DOMAIN",i[1]||i[0]),Sn("LOG_UPLOAD_SERVER","".concat(i[0],":6444")),D.info("[".concat(this._clientId,"] set local access point success"))}async setRemoteDefaultVideoStreamType(i){if(nr(i,"streamType",[0,1]),this._remoteDefaultVideoStreamType=i,this._joinInfo)try{await this._gateway.setDefaultRemoteVideoStreamType(i),this._joinInfo.defaultVideoStream=this._remoteDefaultVideoStreamType}catch(s){throw D.error("[".concat(this._clientId,"] set default remote video stream type error"),s.toString()),s}else D.debug("[".concat(this._clientId,"] haven't joined yet, cache remoteDefaultVideoStreamType ").concat(i))}async setRemoteVideoStreamType(i,s){nr(s,"streamType",[0,1]);try{await this._gateway.setRemoteVideoStreamType(i,s),setTimeout(()=>{const a=this._users.find(u=>u.uid===i);a&&a.videoTrack&&a.videoTrack.updateMediaStreamTrackResolution()},2e3)}catch(a){throw D.error("[".concat(this._clientId,"] set remote video stream type error"),a.toString()),a}D.info("[".concat(this._clientId,"] set remote ").concat(i," video stream type to ").concat(s)),this._remoteStreamTypeCacheMap.set(i,s)}async setStreamFallbackOption(i,s){nr(s,"fallbackType",[0,1,2]);try{await this._gateway.setStreamFallbackOption(i,s)}catch(a){throw D.error("[".concat(this._clientId,"] set stream fallback option"),a.toString()),a}D.info("[".concat(this._clientId,"] set remote ").concat(i," stream fallback type to ").concat(s)),this._streamFallbackTypeCacheMap.set(i,s)}setEncryptionConfig(i,s,a){(function(h){nr(h,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"])})(i),jr(s,"secret");const u=["aes-128-gcm2","aes-256-gcm2"];if(ot(u).call(u,i)){if(!a||!(a instanceof Uint8Array&&a.length===32))throw new ae(z.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(a)throw new ae(z.INVALID_PARAMS,"current encrypt mode does not need salt");new RegExp(`^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'"|{}\\[\\]])(?=.{8,})`).test(s)||D.warning(`The secret is not strong:
      The secret must contain at least 1 lowercase alphabetical character,
      The secret must contain at least 1 uppercase alphabetical character,
      The secret must contain at least 1 numeric character,
      The secret must contain at least one special character,
      The secret must be eight characters or longer.
      `),this._encryptionMode=i,this._encryptionSecret=s,a&&(this._encryptionSalt=rI(a))}async renewToken(i){if(jr(i,"token",1,2047),!this._key||!this._joinInfo)throw new ae(z.INVALID_OPERATION,"renewToken should not be called before user join");const s=this._key;this._key=i,this._joinInfo&&(this._joinInfo.token=i);const a=await this._renewTokenMutex.lock();try{if(te("USE_NEW_TOKEN")){D.debug("[".concat(this._clientId,"] start renew token with ticket from unilbs"));const u=await rde(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||Oi);D.debug("[".concat(this._clientId,"] get ticket from unilbs success")),await this._gateway.renewToken({token:i,ticket:u})}else D.debug("[".concat(this._clientId,"] start renew token without ticket")),await this._gateway.renewToken({token:i});D.debug("[".concat(this._clientId,"] renewToken success"))}catch(u){throw this._key=s,this._joinInfo.token=s,D.error("[".concat(this._clientId,"] renewToken failed"),u.toString()),u}finally{a()}}enableAudioVolumeIndicator(){this._audioVolumeIndicationInterval?D.warning("you have already enabled audio volume indicator!"):this._audioVolumeIndicationInterval=window.setInterval(()=>{const i=this._p2pChannel.getAudioLevels();this.safeEmit(Dt.VOLUME_INDICATOR,i)},te("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3)}getRTCStats(){const i=this._statsCollector.getRTCStats(),s=this._gateway.getInChannelInfo();return i.Duration=Math.round(s.duration/1e3),i}async startLiveStreaming(i,s){if(!s){if(this.codec!=="h264")throw new ae(z.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");if(!this._p2pChannel.hasLocalMedia())throw new ae(z.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming")}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(i)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(i))throw new ae(z.LIVE_STREAMING_TASK_CONFLICT);const a=s?zi.TRANSCODE:zi.RAW;return this._createLiveStreamingClient(a).startLiveStreamingTask(i,a)}setLiveTranscoding(i){return this._createLiveStreamingClient(zi.TRANSCODE).setTranscodingConfig(i)}async stopLiveStreaming(i){const s=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient].filter(a=>a&&a.hasUrl(i));if(!s.length)throw new ae(z.INVALID_PARAMS,"can not find live streaming url to stop");await le.all(s.map(a=>a&&a.stopLiveStreamingTask(i)))}async addInjectStreamUrl(i,s){if(!this._joinInfo)throw new ae(z.INVALID_OPERATION,"can not addInjectStreamUrl, no joininfo");const a=this._createLiveStreamingClient(zi.INJECT);a.setInjectStreamConfig(s,0),await a.startLiveStreamingTask(i,zi.INJECT)}async removeInjectStreamUrl(){var i;const s=this._createLiveStreamingClient(zi.INJECT),a=Array.from(Jl(i=s.streamingTasks).call(i)).find(u=>u.mode===zi.INJECT);if(!this._joinInfo||!a)throw new ae(z.INVALID_OPERATION,"can remove addInjectStreamUrl, no joininfo or inject task");await s.stopLiveStreamingTask(a.url)}async startChannelMediaRelay(i){XH(i),await this._createChannelMediaRelayClient().startChannelMediaRelay(i)}async updateChannelMediaRelay(i){XH(i),await this._createChannelMediaRelayClient().updateChannelMediaRelay(i)}async stopChannelMediaRelay(){await this._createChannelMediaRelayClient().stopChannelMediaRelay(),this._statsCollector.onStatsChanged&&(this._statsCollector.onStatsChanged=void 0)}sendStreamMessage(i){let s=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!this._joinInfo)throw new ae(z.INVALID_OPERATION,"can not send data stream, not joined");if((typeof i=="string"||i instanceof Uint8Array)&&(i={payload:i}),typeof i.payload=="string"){const a=new TextEncoder;i.payload=a.encode(i.payload)}if(new Blob([i.payload]).size>1024)throw new ae(z.INVALID_PARAMS,"stream message out of range.");return this._gateway.signal.request(nt.DATA_STREAM,{payload:rI(i.payload),syncWithAudio:i.syncWithAudio,sendTs:Date.now()-jde},!s)}sendMetadata(i){if(!this._joinInfo)throw new ae(z.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([i]).size>1024)throw new ae(z.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(nt.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:rI(i)})}async sendCustomReportMessage(i){if(Array.isArray(i)||(i=[i]),i.forEach(Yce),!this._joinInfo)throw new ae(z.INVALID_OPERATION,"can not send custom report, not joined");await it.sendCustomReportMessage(this._joinInfo.sid,i)}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){return this._statsCollector.getRemoteNetworkQualityStats()}async pickSVCLayer(i,s){nr(s.spatialLayer,"spatialLayer",[0,1,2,3]),nr(s.temporalLayer,"temporalLayer",[0,1,2,3]);try{await this._gateway.pickSVCLayer(i,s)}catch(a){throw D.error("[".concat(this._clientId,"] pick SVC layer failed"),a.toString()),a}}setRTM2Flag(i){if(nr(i,"flag",[0,1]),!this._joinInfo)throw new ae(z.INVALID_OPERATION,"Can't setRtm2Flag, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new ae(z.INVALID_OPERATION,"Can't setRtm2Flag in ".concat(this.connectionState," state"));return this._gateway.setRTM2Flag(i)}_reset(){if(D.debug("[".concat(this._clientId,"] reset client")),this._axiosCancelSource.cancel(),this._axiosCancelSource=ao.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId=null,this.store.sessionId=null,this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._pendingPublishedUsers=[],this._users.forEach(i=>{i._audioTrack&&i._audioTrack._destroy(),i._videoTrack&&i._videoTrack._destroy(),i._dataChannels&&(i._dataChannels.forEach(s=>s._close()),i._dataChannels.length=0)}),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),this._cloudProxyServerMode==="fallback"&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new fr("client-publish"),this._subscribeMutex=new fr("client-subscribe"),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._injectStreamingClient&&(this._injectStreamingClient.terminate(),this._injectStreamingClient.removeAllListeners(),this._injectStreamingClient=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0),this._inspect)try{this._inspect.close(),this._inspect=void 0}catch{}if(this._moderation)try{this.setImageModeration(!1)}catch{}}_startSession(i,s){const a=i||qM();i?D.debug("[".concat(this._clientId,"] new Session ").concat(a)):D.debug("[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(a)),this._sessionId=a,this.store.sessionId=a,s?it.sessionInit(this._sessionId,{lts:new Date().getTime(),cname:s.channel,appid:s.appId,mode:this.mode}):this._joinInfo?it.sessionInit(this._sessionId,{lts:new Date().getTime(),cname:this._joinInfo.cname,appid:this._joinInfo.appId,mode:this.mode}):this._gateway.joinInfo&&it.sessionInit(this._sessionId,{lts:new Date().getTime(),cname:this._gateway.joinInfo.cname,appid:this._gateway.joinInfo.appId,mode:this.mode}),this._joinInfo&&(this._joinInfo.sid=a),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=a)}async _publishHighStream(i){if(!this._joinInfo||this._uid===void 0)throw new ae(z.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new ae(z.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&te("FORCE_TURN")&&!te("TURN_ENABLE_TCP")&&!te("TURN_ENABLE_UDP"))throw new ae(z.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");D.debug("[".concat(this._clientId,"] publish high stream"));try{if(this._p2pChannel instanceof ri){const a=await this._p2pChannel.publish(i,this._isDualStreamEnabled,this._lowStreamParameter);if(a)try{await this._gateway.sendExtensionMessage(Pn.PUBLISH,a)}catch(u){throw this._p2pChannel.unpublish(i),u}}else{const a=await this._p2pChannel.publish(i,this._isDualStreamEnabled,this._lowStreamParameter),u=(await a.next()).value;if(u){var s;let h;try{h=await this._gateway.publish(this._uid,u,!0)}catch(p){if(p.code!==z.DISCONNECT_P2P)throw a.throw(p),p}await a.next(((s=h)===null||s===void 0?void 0:s.ortc)||[])}this._p2pChannel.reportPublishEvent(!0,null);for(const h of i)h instanceof Ct&&h._encoderConfig&&this._gateway.setVideoProfile(h._encoderConfig),!h.muted&&h.enabled||await this._p2pChannel.muteLocalTrack(h)}}catch(a){if(this._p2pChannel.reportPublishEvent(!1,a==null?void 0:a.code,i),(a==null?void 0:a.code)===z.WS_ABORT)return;throw a}}async _publishLowStream(){if(!this._joinInfo||this._uid===void 0)throw new ae(z.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new ae(z.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));D.debug("[".concat(this._clientId,"] publish low stream"));const i=this._configDistribute.getLowStreamConfigDistribute();i&&i.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&i.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=i.bitrate));try{const a=await this._p2pChannel.publishLowStream(this._lowStreamParameter),u=(await a.next()).value;if(u){var s;let h;try{h=await this._gateway.publish(this._uid,u,!0)}catch(p){if(p.code!==z.DISCONNECT_P2P)throw a.throw(p),p}a.next(((s=h)===null||s===void 0?void 0:s.ortc)||[]),this._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(a){if(this._p2pChannel.reportPublishEvent(!1,a==null?void 0:a.code,void 0,!0),(a==null?void 0:a.code)===z.WS_ABORT)return;throw a}}_createLiveStreamingClient(i){if(!this._joinInfo||!this._appId)return new ae(z.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const s=()=>new ade(this._joinInfo,this._config.websocketRetryConfig||Oi,this._config.httpRetryConfig||Oi),a=u=>{u.onLiveStreamError=(h,p)=>{it.reportApiInvoke(this._sessionId,{name:Mi.ON_LIVE_STREAM_ERROR,options:[h,p],tag:Yn.TRACER}).onSuccess(),this.safeEmit(Dt.LIVE_STREAMING_ERROR,h,p)},u.onLiveStreamWarning=(h,p)=>{it.reportApiInvoke(this._sessionId,{name:Mi.ON_LIVE_STREAM_WARNING,options:[h,p],tag:Yn.TRACER}).onSuccess(),this.safeEmit(Dt.LIVE_STREAMING_WARNING,h,p)},u.on(Y_.REQUEST_WORKER_MANAGER_LIST,(h,p,_)=>{if(!this._joinInfo)return _(new ae(z.INVALID_OPERATION,"can not find join info to get worker manager"));zH(h,this._joinInfo,this._axiosCancelSource.token,Oi).then(p).catch(_)})};switch(i){case zi.RAW:return this._liveRawStreamingClient||(this._liveRawStreamingClient=s(),a(this._liveRawStreamingClient)),this._liveRawStreamingClient;case zi.TRANSCODE:return this._liveTranscodeStreamingClient||(this._liveTranscodeStreamingClient=s(),a(this._liveTranscodeStreamingClient)),this._liveTranscodeStreamingClient;case zi.INJECT:return this._injectStreamingClient||(this._injectStreamingClient=s(),this._injectStreamingClient.on(Y_.REQUEST_WORKER_MANAGER_LIST,(u,h,p)=>{if(!this._joinInfo)return p(new ae(z.INVALID_OPERATION,"can not find join info to get worker manager"));zH(u,this._joinInfo,this._axiosCancelSource.token,Oi).then(h).catch(p)}),this._injectStreamingClient.onInjectStatusChange=(u,h,p)=>{this.safeEmit(Dt.INJECT_STREAM_STATUS,u,h,p)}),this._injectStreamingClient}}_createChannelMediaRelayClient(){if(!this._joinInfo)return new ae(z.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw();if(!this._channelMediaRelayClient){const{sendResolutionWidth:i,sendResolutionHeight:s}=this.getLocalVideoStats(),a={width:i,height:s};this._channelMediaRelayClient=new lde(this._joinInfo,this._clientId,this._config.websocketRetryConfig||Oi,this._config.httpRetryConfig||Oi,a),this._channelMediaRelayClient.on("state",u=>{u===Rs.RELAY_STATE_FAILURE&&this._channelMediaRelayClient&&this._channelMediaRelayClient.dispose(),this.safeEmit(Dt.CHANNEL_MEDIA_RELAY_STATE,u)}),this._channelMediaRelayClient.on("event",u=>{this.safeEmit(Dt.CHANNEL_MEDIA_RELAY_EVENT,u)}),this._statsCollector.onStatsChanged=(u,h)=>{var p;u==="resolution"&&((p=this._channelMediaRelayClient)===null||p===void 0||p.setVideoProfile(h))}}return this._channelMediaRelayClient}_handleUpdateDataChannel(i,s){const{added:a,deleted:u}=i,h=[];Array.isArray(a)&&a.length>0&&a.forEach(p=>{const{uid:_,stream_id:v,ordered:T,max_retrans_times:b,metadata:C}=p,N=this._users.find(x=>x._uintid===_);if(!N)return void D.error("[".concat(this._clientId,"] can not find target user!(on_add_data_channel)"));if(D.debug("[".concat(this._clientId,"] data_channel added with uid ").concat(_)),ot(h).call(h,N)||h.push(N),N._uintid||(N._uintid=_),N._dataChannels.findIndex(x=>x.id===p.stream_id)===-1){const x={id:v,ordered:!!T,maxRetransmits:b,metadata:C},B=new zue(x);N._dataChannels.push(B),D.info("[".concat(this._clientId,"] remote user ").concat(N.uid," published datachannel")),s||this.safeEmit(Dt.USER_PUBLISHED,N,"datachannel",x)}this._p2pChannel.hasPendingRemoteDataChannel(N,p.stream_id)&&(D.debug("[".concat(this._clientId,"] resubscribe datachannel for user ").concat(N.uid," after reconnect.")),this._subscribeDataChannel(N,p.stream_id).catch(x=>{D.error("[".concat(this._clientId,"] resubscribe datachannel error"),x.toString())}))}),s&&(this.safeEmit(Dt.PUBLISHED_USER_LIST,this._pendingPublishedUsers),this._pendingPublishedUsers=[]),Array.isArray(u)&&u.length>0&&u.forEach(p=>{const{uid:_,stream_id:v}=p,T=this._users.find(C=>C._uintid===_);if(!T)return void D.error("[".concat(this._clientId,"] can not find target user!(on_delete_data_channel)"));const b=T._dataChannels.find(C=>C.id===p.stream_id);b&&(D.debug("[".concat(this._clientId,"] data_stream delete with uid ").concat(_)),this._p2pChannel.unsubscribeDataChannel(T,[b]).then(C=>{if(C)return T._dataChannels=T._dataChannels.filter(N=>N!==b),this._gateway.unsubscribeDataChannel(C,T.uid)}),D.info("[".concat(this._clientId,"] remote user ").concat(_," unpublished datachannel ,id:").concat(b.id)),this.safeEmit(Dt.USER_UNPUBLISHED,T,"datachannel",b._config))})}_handleRemoveDataChannels(i){const s=this._users.find(a=>a.uid===i.uid);if(s){if(s._dataChannels!==void 0&&s._dataChannels.length>0){D.debug("[".concat(this._clientId,"] datachannel removed with uid ").concat(i.uid));const a=()=>{D.info("[".concat(this._clientId,"] remote user ").concat(s.uid," unpublished datachannel")),s._dataChannels.forEach(u=>{this.safeEmit(Dt.USER_UNPUBLISHED,s,"datachannel",u._config)})};this._p2pChannel.unsubscribeDataChannel(s,s._dataChannels).then(u=>{if(u)return this._gateway.unsubscribeDataChannel(u,s.uid)}),a()}}else D.warning("[".concat(this._clientId,"] can not find target user!(on_remove_datachannel)"))}_handleGatewayEvents(){this._gateway.on(ii.DISCONNECT_P2P,async()=>{await this._p2pChannel.disconnectForReconnect()}),this._gateway.on(ii.CONNECTION_STATE_CHANGE,(i,s,a)=>{var u;if(a===Pt.FALLBACK)return;const h=()=>{this.safeEmit(Dt.CONNECTION_STATE_CHANGE,i,s,a)};if(it.reportApiInvoke(this._sessionId||((u=this._gateway.joinInfo)===null||u===void 0?void 0:u.sid)||null,{name:Mi.CONNECTION_STATE_CHANGE,options:[i,s,a],tag:Yn.TRACER}).onSuccess(JSON.stringify({cur:i,prev:s,reason:a})),D.info("[".concat(this._clientId,"] connection state change: ").concat(s," -> ").concat(i)),i==="DISCONNECTED")return this._reset(),void h();if(i==="RECONNECTING")this._users.forEach(_=>{_._trust_in_room_=!1,_._trust_audio_enabled_state_=!1,_._trust_video_enabled_state_=!1,_._trust_audio_mute_state_=!1,_._trust_video_mute_state_=!1,_._trust_audio_stream_added_state_=!1,_._trust_video_stream_added_state_=!1,_._audioSSRC=void 0,_._videoSSRC=void 0,_._videoOrtc=void 0,_._audioOrtc=void 0,_._cname=void 0,_._rtxSsrcId=void 0}),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if(i==="CONNECTED"){var p;this._streamFallbackTypeCacheMap.forEach((_,v)=>{this._gateway.setStreamFallbackOption(v,_).catch(T=>{D.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),T)})}),this._remoteStreamTypeCacheMap.forEach((_,v)=>{this._gateway.setRemoteVideoStreamType(v,_).catch(T=>{D.warning("[".concat(this._clientId,"] auto set remote stream type failed"),T)})}),this._remoteDefaultVideoStreamType!==void 0&&((p=this._joinInfo)===null||p===void 0?void 0:p.defaultVideoStream)===void 0&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then(()=>{D.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))}).catch(_=>{D.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(_))}),this.store.useP2P||(this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._userOfflineTimeout=void 0,this._users.filter(_=>!_._trust_in_room_).forEach(_=>{D.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(_.uid)),this._handleUserOffline({uid:_.uid})}))},3e3),this._streamRemovedTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._streamRemovedTimeout=void 0,this._users.forEach(_=>{_._trust_audio_mute_state_||(D.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(_.uid)),this._handleMuteStream(_.uid,Qe.AUDIO,!1)),_._trust_video_mute_state_||(D.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(_.uid)),this._handleMuteStream(_.uid,Qe.VIDEO,!1)),_._trust_audio_enabled_state_||(D.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(_.uid)),this._handleSetStreamLocalEnable("audio",_.uid,!0)),_._trust_video_enabled_state_||(D.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(_.uid)),this._handleSetStreamLocalEnable("video",_.uid,!0)),_._trust_video_stream_added_state_||(D.debug("[".concat(this._clientId,"] auto dispatch reset video stream added ").concat(_.uid)),this._handleResetAddStream(_,"video")),_._trust_audio_stream_added_state_||(D.debug("[".concat(this._clientId,"] auto dispatch reset audio stream added ").concat(_.uid)),this._handleResetAddStream(_,"audio")),_._video_added_||_._audio_added_||(D.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(_.uid)),this._handleRemoveStream({uid:_.uid,uint_id:_._uintid}))}))},1e3))}h()}),this._gateway.on(ii.REQUEST_NEW_GATEWAY_LIST,(i,s)=>{if(!this._joinInfo)return s(new ae(z.UNEXPECTED_ERROR,"can not recover, no join info"));wU(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||Oi,this.store).then(a=>{this._joinInfo&&(this._joinInfo.apResponse=a.gatewayInfo.res,this._joinInfo.gatewayAddrs=a.gatewayInfo.gatewayAddrs,this._joinInfo.uni_lbs_ip=a.gatewayInfo.uni_lbs_ip);const u=[];a.gatewayInfo.gatewayAddrs.forEach(h=>{let{address:p}=h;const[_,v]=p.split(":");this._joinInfo&&this._joinInfo.proxyServer?u.push({proxy:this._joinInfo.proxyServer,host:_,port:v}):u.push({host:_,port:v})}),i(u)}).catch(s)}),this._gateway.on(ii.NETWORK_QUALITY,i=>{this._networkQualitySensitivity==="normal"&&this.safeEmit(Dt.NETWORK_QUALITY,i)}),this._gateway.on(ii.STREAM_TYPE_CHANGE,(i,s)=>{this.safeEmit(Dt.STREAM_TYPE_CHANGED,i,s),it.reportApiInvoke(this._sessionId,{name:Mi.STREAM_TYPE_CHANGE,options:[i,s],tag:Yn.TRACER}).onSuccess(JSON.stringify({uid:i,streamType:s}))}),this._gateway.on(ii.IS_P2P_DISCONNECTED,i=>{this._p2pChannel.isP2PDisconnected()?i(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?i(!1):i(!0)}),this._gateway.on(ii.NEED_RENEW_SESSION,()=>{this._startSession()}),this._gateway.on(ii.REQUEST_P2P_CONNECTION_PARAMS,async(i,s,a)=>{try{s(await this._p2pChannel.startP2PConnection(i))}catch(u){a(u)}}),this._gateway.on(ii.JOIN_RESPONSE,(i,s)=>{if(this.store.useP2P)return;const{dtlsParameters:a,iceParameters:u,candidates:h,rtpCapabilities:p,setup:_,cname:v}=i$(i.ortc,s);this._p2pChannel.connect(u,a,h,p,_,v)}),this._gateway.on(ii.REQUEST_DC_CONNECTION_PARAMS,i=>{i(this._p2pChannel.getEstablishParams())}),this._gateway.on(ii.RESET_SIGNAL,i=>{this._p2pChannel.resetConnection(i),this._handleGatewaySignalEvents()}),this._gateway.on(ii.DATACHANNEL_FAILBACK,()=>{this._joinGateway()}),this._gateway.on(ii.DATACHANNEL_PRECONNECT,async(i,s,a,u)=>{var h,p,_,v,T,b;await this._p2pChannel.startP2PConnection({turnServer:(h=this._joinInfo)===null||h===void 0?void 0:h.turnServer},!0);const C=function(N,x){let B;return x&&x.ip&&typeof x.port=="number"?(B=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:x.ip,port:x.port.toString(),type:"host",extension:{}}],D.debug("Using remote candidate from AP ".concat(x.ip,":").concat(x.port)),x.ip6&&(B.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:x.ip6,port:x.port.toString(),type:"host",extension:{}}),D.debug("Using IPV6 remote candidate from AP ".concat(x.ip6,":").concat(x.port)))):B=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:N.ip,port:N.port.toString(),type:"host",extension:{}}],B}(i,s);return this._p2pChannel.preConnect({iceUfrag:"".concat((p=this._joinInfo)===null||p===void 0?void 0:p.apResponse.cid,"_").concat((_=this._joinInfo)===null||_===void 0?void 0:_.apResponse.cert),icePwd:"".concat((v=this._joinInfo)===null||v===void 0?void 0:v.apResponse.cid,"_").concat((T=this._joinInfo)===null||T===void 0?void 0:T.apResponse.cert)},{fingerprints:[{hashFunction:"sha-256",fingerprint:(b=te("FINGERPRINT"))!==null&&b!==void 0?b:i.fingerprint}]},C,{send:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},recv:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]}},"active","o/i14u9pJrxRKAsu").then(a).catch(u)})}_handleGatewaySignalEvents(){this._gateway.signal.on(St.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(St.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(St.ON_ADD_AUDIO_STREAM,i=>this._handleAddAudioOrVideoStream("audio",i.uid,i.ssrcId,i.cname,i.uint_id,i.ortc)),this._gateway.signal.on(St.ON_ADD_VIDEO_STREAM,i=>this._handleAddAudioOrVideoStream("video",i.uid,i.ssrcId,i.cname,i.uint_id,i.ortc,i.rtxSsrcId)),this._gateway.signal.on(St.ON_REMOTE_DATASTREAM_UPDATE,i=>{this._handleUpdateDataChannel(i)}),this._gateway.signal.on(St.ON_REMOTE_FULL_DATASTREAM_INFO,i=>{this._handleUpdateDataChannel({added:i.datastreams,deleted:[]},!0)}),this._gateway.signal.on(St.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(St.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(St.MUTE_AUDIO,i=>this._handleMuteStream(i.uid,Qe.AUDIO,!0)),this._gateway.signal.on(St.UNMUTE_AUDIO,i=>this._handleMuteStream(i.uid,Qe.AUDIO,!1)),this._gateway.signal.on(St.MUTE_VIDEO,i=>this._handleMuteStream(i.uid,Qe.VIDEO,!0)),this._gateway.signal.on(St.UNMUTE_VIDEO,i=>this._handleMuteStream(i.uid,Qe.VIDEO,!1)),this._gateway.signal.on(St.RECEIVE_METADATA,i=>{const s=iI(i.metadata);this.safeEmit(Dt.RECEIVE_METADATA,i.uid,s)}),this._gateway.signal.on(St.ON_DATA_STREAM,async i=>{if(!i)return;let s=0;if(i.ordered||i.syncWithAudio){const a=this._p2pChannel.getStats(),u=this.remoteUsers.find(p=>p.uid===i.uid),h=a==null?void 0:a.audioRecv.find(p=>p.ssrc===(u==null?void 0:u._audioSSRC));s=h==null?void 0:h.jitterBufferMs}s==null&&(s=0),Vde(i,s,{id:this._clientId,onStreamMessage:typeof this.onStreamMessage=="function"?this.onStreamMessage.bind(this):void 0,safeEmit:this.safeEmit.bind(this)})}),this._gateway.signal.on(St.ON_CRYPT_ERROR,()=>{z0(()=>{D.warning("[".concat(this._clientId,"] on crypt error")),this.safeEmit(Dt.CRYPT_ERROR)},this._sessionId)}),this._gateway.signal.on(St.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(St.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{D.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),this._gateway.leave(!0,Pt.TOKEN_EXPIRE),this.safeEmit(Dt.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()}),this._gateway.signal.on(St.ON_STREAM_FALLBACK_UPDATE,i=>{D.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat(i.stream_id,", attr: ").concat(i.stream_type)),this.safeEmit(Dt.STREAM_FALLBACK,i.stream_id,i.stream_type===1?"fallback":"recover")}),this._gateway.signal.on(St.ON_PUBLISH_STREAM,i=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:i.proxy})),D.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify(i))))}),this._gateway.signal.on(St.ENABLE_LOCAL_VIDEO,i=>{this._handleSetStreamLocalEnable("video",i.uid,!0)}),this._gateway.signal.on(St.DISABLE_LOCAL_VIDEO,i=>{this._handleSetStreamLocalEnable("video",i.uid,!1)}),this._gateway.signal.on(Be.REQUEST_TIMEOUT,(i,s)=>{if(this._joinInfo)switch(i){case nt.PUBLISH:{if(!s)return;const h=s.ortc;if(h){var a,u;const p=h.some(T=>{let{stream_type:b}=T;return b===gn.Audio}),_=h.some(T=>{let{stream_type:b}=T;return b!==gn.Audio}),v=h.some(T=>{let{stream_type:b}=T;return b===gn.Screen||b===gn.ScreenLow});s.state==="offer"&&it.publish(this._joinInfo.sid,{eventElapse:Br.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:z.TIMEOUT,audio:p,video:_,p2pid:s.p2p_id,publishRequestid:this.store.pubId,screenshare:v,audioName:p?(a=h.find(T=>{let{stream_type:b}=T;return b===gn.Audio}))===null||a===void 0||(a=a.ssrcs[0])===null||a===void 0?void 0:a.ssrcId.toString():void 0,videoName:_?(u=h.find(T=>{let{stream_type:b}=T;return b!==gn.Audio}))===null||u===void 0||(u=u.ssrcs[0])===null||u===void 0?void 0:u.ssrcId.toString():void 0})}break}case nt.SUBSCRIBE:s&&it.subscribe(this._joinInfo.sid,{succ:!1,ec:z.TIMEOUT,audio:s.stream_type===Qe.AUDIO,video:s.stream_type===Qe.VIDEO,peerid:s.stream_id,subscribeRequestid:s.ssrcId,p2pid:this.store.p2pId,eventElapse:Br.measureFromSubscribeStart(this.store.clientId,s.ssrcId)})}}),this._gateway.signal.on(St.ON_P2P_OK,i=>{this.uid,this._uid}),this._gateway.signal.on(St.ON_PUBLISHED_USER_LIST,i=>{if(i==null||!i.users)return;te("BLOCK_LOCAL_CLIENT")&&(i.users=i.users.filter(u=>!qp(u.string_id||u.stream_id,this.channelName)));const s=[],a=[];for(const u of i.users){let h=this._users.find(C=>C._uintid===u.stream_id);h?h._trust_in_room_=!0:(h=new Wr(u.string_id||u.stream_id,u.stream_id),this._users.push(h),this.getListeners(Dt.PUBLISHED_USER_LIST).length===0&&(D.debug("[".concat(this._clientId,"] user online"),u.stream_id),this.safeEmit(Dt.USER_JOINED,h)));const p=Ui.Audio&u.stream_type,_=(Ui.Video|Ui.LwoVideo)&u.stream_type,v=(65280&u.stream_type)!=0,T=p&&h.hasAudio,b=_&&h.hasVideo;_&&(h._trust_video_stream_added_state_=!0,h._video_added_=!0,h._videoSSRC=u.video_ssrc,h._rtxSsrcId=u.video_rtx),p&&(h._trust_audio_stream_added_state_=!0,h._audio_added_=!0,h._audioSSRC=u.audio_ssrc),p&&!T&&this.getListeners(Dt.PUBLISHED_USER_LIST).length===0&&(D.info("[".concat(this._clientId,"] remote user ").concat(h.uid," published audio")),this.safeEmit(Dt.USER_PUBLISHED,h,"audio")),_&&!b&&this.getListeners(Dt.PUBLISHED_USER_LIST).length===0&&(D.info("[".concat(this._clientId,"] remote user ").concat(h.uid," published video")),this.safeEmit(Dt.USER_PUBLISHED,h,"video")),(p&&!T||_&&!b||v)&&s.push(h),_&&this._p2pChannel.hasPendingRemoteMedia(h,"video")&&a.push({user:h,mediaType:"video"}),p&&this._p2pChannel.hasPendingRemoteMedia(h,"audio")&&a.push({user:h,mediaType:"audio"})}a.length>0&&(D.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(a.map(u=>"user: ".concat(u.user.uid,", mediaType: ").concat(u.mediaType)).join("; ")," ")),this.massSubscribe(a).catch(u=>{D.error("[".concat(this._clientId,"] mass resubscribe error"),u.toString())})),this.getListeners(Dt.PUBLISHED_USER_LIST).length>0?te("ENABLE_DATASTREAM_2")?this._pendingPublishedUsers=s:(D.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(s.map(u=>u.uid).join(", "))),this.safeEmit(Dt.PUBLISHED_USER_LIST,s)):D.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(s.map(u=>u.uid).join(", ")))}),this._gateway.signal.on(St.ON_RTP_CAPABILITY_CHANGE,i=>{const{video_codec:s}=i;this._p2pChannel instanceof Er&&this._p2pChannel.updateRemoteRTPCapabilities(s.map(a=>a.toLowerCase()).filter(a=>{var u;return ot(u=Object.keys(Kp)).call(u,a)}))})}_handleP2PEvents(){this._gateway.signal.on(St.ON_USER_OFFLINE,()=>{this._p2pChannel.disconnectForReconnect()}),this._gateway.signal.on(Pn.PUBLISH,async(i,s)=>{i.forEach(a=>a.kind===Qe.VIDEO?(this._handleP2PAddAudioOrVideoStream("video",s),a.isMuted?this._handleMuteStream(s,Qe.VIDEO,!0):this._handleMuteStream(s,Qe.VIDEO,!1)):(this._handleP2PAddAudioOrVideoStream("audio",s),a.isMuted?this._handleMuteStream(s,Qe.AUDIO,!0):this._handleMuteStream(s,Qe.AUDIO,!1)))}),this._gateway.signal.on(Be.P2P_START,async(i,s)=>{if(this._p2pChannel instanceof ri){var a;s(await this._p2pChannel.startP2P({turnServer:(a=this._joinInfo)===null||a===void 0?void 0:a.turnServer},i))}}),this._gateway.signal.on(Be.P2P_CONNECTION,async i=>{this._p2pChannel instanceof ri&&await this._p2pChannel.p2pConnect(i)}),this._gateway.signal.on(Be.P2P_REMOTE_CANDIDATE_UPDATE,i=>{this._p2pChannel instanceof ri&&this._p2pChannel.addRemoteCandidate(JSON.parse(i))}),this._gateway.signal.on(Pn.SUBSCRIBE,async(i,s,a)=>{if(this._p2pChannel instanceof ri){const{trackType:u}=JSON.parse(i);try{await this._p2pChannel.dopublish(u),s()}catch(h){a(h)}}}),this._gateway.signal.on(Pn.UNSUBSCRIBE,async(i,s,a)=>{if(this._p2pChannel instanceof ri){const{mediaType:u}=JSON.parse(i);try{await this._p2pChannel.doUnpublish(u),s()}catch(h){a(h)}}}),this._gateway.signal.on(Pn.EXCHANGE_SDP,async(i,s,a)=>{if(this._p2pChannel instanceof ri){const{type:u,sdp:h}=JSON.parse(i);try{s(await this._p2pChannel.setDescription(u,h))}catch(p){a(p)}}}),this._gateway.signal.on(Pn.UNPUBLISH,async(i,s,a)=>{if(this._p2pChannel instanceof ri){const{unpubMsg:u,uid:h}=i;if(u.length===1){const p=u[0].stream_type===gn.Audio?Qe.AUDIO:Qe.VIDEO;this._handleMuteStream(h,p,!0);const{sdp:_}=i;if(this._p2pChannel instanceof ri&&_){const v=this._users.find(T=>T.uid===h);if(!v)return D.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(h)),void s();this._p2pChannel.unsubscribe(v,_,p).then(T=>{T&&s(T)}).catch(a)}else s()}else this._handleRemoveStream(i,s,a)}}),this._gateway.signal.on(Pn.CONTROL,async(i,s,a)=>{const{action:u,sdp:h,isMuteAll:p,uid:_}=i;switch(u){case Zl.MUTE_LOCAL_VIDEO:this._handleMuteStream(_,Qe.VIDEO,!0,h,s,a);break;case Zl.MUTE_LOCAL_AUDIO:s(),this._handleMuteStream(_,Qe.AUDIO,!0);break;case Zl.UNMUTE_LOCAL_VIDEO:s(),this._handleP2PAddAudioOrVideoStream("video",_),this._handleMuteStream(_,Qe.VIDEO,!1);break;case Zl.UNMUTE_LOCAL_AUDIO:s(),this._handleP2PAddAudioOrVideoStream("audio",_),this._handleMuteStream(_,Qe.AUDIO,!1)}p&&this._handleRemoveStream(i,s,a)}),this._gateway.signal.on(Pn.DO_SUBSCRIBE,async(i,s,a)=>{if(this._p2pChannel instanceof ri){const{kind:u,sdp:h,ssrcId:p,uid:_}=i,v=this._users.find(T=>T.uid===_);if(!v)return D.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)")),void s();try{s(await this._p2pChannel.subscribe(v,u,h,p))}catch(T){a(T)}}}),this._gateway.signal.on(Pn.DO_UNSUBSCRIBE,async(i,s,a)=>{if(this._p2pChannel instanceof ri){const{uid:u,kind:h,sdp:p}=i,_=this._users.find(v=>v.uid===u);if(!_)return D.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)")),void s();try{s(await this._p2pChannel.unsubscribe(_,p,h))}catch(v){a(v)}}}),this._gateway.signal.on(Pn.RESTART_ICE,async(i,s,a)=>{if(this._p2pChannel instanceof ri)try{s(await this._p2pChannel.setDescription("remote",i))}catch(u){a(u)}}),this._p2pChannel.on(ut.RequestP2PRestartICE,async(i,s,a)=>{try{s(await this._gateway.sendExtensionMessage(Pn.RESTART_ICE,i))}catch(u){a(u)}}),this._p2pChannel.on(ut.LocalCandidate,i=>{this._gateway.sendExtensionMessage(Pn.CANDIDATE,JSON.stringify(i))}),this._p2pChannel.on(ut.RequestP2PMuteLocal,async(i,s,a)=>{try{s(await this._gateway.sendExtensionMessage(Pn.CONTROL,i))}catch(u){a(u)}}),this._p2pChannel.on(ut.RequestP2PPublish,async(i,s,a)=>{try{s(await this._gateway.sendExtensionMessage(Pn.DO_SUBSCRIBE,i))}catch(u){a(u)}}),this._p2pChannel.on(ut.RequestP2PUnPublish,async(i,s,a)=>{try{s(await this._gateway.sendExtensionMessage(Pn.DO_UNSUBSCRIBE,i))}catch(u){a(u)}}),this._p2pChannel.on(ut.RequestP2PUnmuteRemote,async(i,s,a)=>{if(this._joinInfo)try{await this._gateway.unmuteRemote(i,this._joinInfo.stringUid||this._joinInfo.uid),s()}catch(u){u.code===z.DISCONNECT_P2P?s():a(u)}else s()}),this._p2pChannel.on(ut.RequestP2PMuteRemote,async(i,s,a)=>{if(this._joinInfo)try{await this._gateway.muteRemote(i,this._joinInfo.stringUid||this._joinInfo.uid),s()}catch(u){u.code===z.DISCONNECT_P2P?s():a(u)}else s()}),this._p2pChannel.on(ut.StateChange,(i,s)=>{s===Xt.Connected&&this._p2pChannel.republish()})}_handleP2PChannelEvents(){this._p2pChannel.on(ut.RequestMuteLocal,async(i,s,a)=>{if(this._joinInfo)try{await this._gateway.muteLocal(i,this._joinInfo.stringUid||this._joinInfo.uid),s()}catch(u){u.code===z.DISCONNECT_P2P?s():a(u)}else s()}),this._p2pChannel.on(ut.RequestUnmuteLocal,async(i,s,a)=>{if(this._joinInfo)try{await this._gateway.unmuteLocal(i,this._joinInfo.stringUid||this._joinInfo.uid),s()}catch(u){u.code===z.DISCONNECT_P2P?s():a(u)}else s()}),this._p2pChannel.on(ut.RequestRePublish,(i,s,a)=>{this.publish(i,!1).then(s).catch(a)}),this._p2pChannel.on(ut.RequestRePublishDataChannel,(i,s,a)=>{le.all(i.map(async u=>{await this._p2pChannel.publishDataChannel([u]);const h={streamId:u.id,ordered:u.ordered,maxRetransmits:u.maxRetransmits,metadata:u.metadata,channelId:u._originDataChannelId};try{await this._gateway.publishDataChannel(this._uid,h,!0)}catch(p){if(p.code!==z.DISCONNECT_P2P)throw p}})).then(s).catch(a)}),this._p2pChannel.on(ut.RequestReSubscribe,async(i,s,a)=>{try{for(const{user:u,kind:h}of i)h===Qe.VIDEO?await this.subscribe(u,"video"):await this.subscribe(u,"audio");s()}catch(u){a(u)}}),this._p2pChannel.on(ut.RequestUploadStats,(i,s)=>{this._gateway.uploadStats(i,s)}),this._p2pChannel.on(ut.MediaReconnectStart,i=>{this.safeEmit(Dt.MEDIA_RECONNECT_START,i)}),this._p2pChannel.on(ut.MediaReconnectEnd,i=>{this.safeEmit(Dt.MEDIA_RECONNECT_END,i)}),this._p2pChannel.on(ut.NeedSignalRTT,i=>{i(this._gateway.getSignalRTT())}),this._p2pChannel.on(ut.RequestRestartICE,async i=>{if(this._p2pChannel instanceof ri)return;const s=await this._p2pChannel.restartICE(i),a=await s.next();if(a.done)return;const u=a.value;let h;try{h=await this._gateway.restartICE({iceParameters:u})}catch(_){return void s.throw(_)}const{iceParameters:p}=function(_){const v=_.iceParameters;return{iceParameters:{iceUfrag:v.iceUfrag,icePwd:v.icePwd}}}(h);await s.next({remoteIceParameters:p})}),this._p2pChannel.on(ut.RequestReconnect,async()=>{this._gateway.reconnect()}),this._p2pChannel.on(ut.RequestReconnectPC,async()=>{var i;const{iceParameters:s,dtlsParameters:a,rtpCapabilities:u}=await this._p2pChannel.startP2PConnection({turnServer:(i=this._joinInfo)===null||i===void 0?void 0:i.turnServer}),{gatewayEstablishParams:h,gatewayAddress:p}=await this._gateway.reconnectPC({iceParameters:s,dtlsParameters:a,rtpCapabilities:u}),{dtlsParameters:_,iceParameters:v,candidates:T,rtpCapabilities:b,setup:C,cname:N}=i$(h,p);await this._p2pChannel.connect(v,_,T,b,C,N),await this._p2pChannel.republish(),await this._p2pChannel.reSubscribe()}),this._p2pChannel.on(ut.RequestUnpublishForReconnectPC,async(i,s,a)=>{this._joinInfo&&this._uid!==void 0?(await this._gateway.unpublish(i,this._uid),s()):a()}),this._p2pChannel.on(ut.P2PLost,()=>{this.safeEmit(Dt.P2P_LOST,this.store.uid)}),this._p2pChannel.on(ut.UpdateVideoEncoder,i=>{i._encoderConfig&&this._gateway.setVideoProfile(i._encoderConfig)}),this._p2pChannel.on(ut.ConnectionTypeChange,i=>{this.safeEmit(Dt.IS_USING_CLOUD_PROXY,i)}),this._p2pChannel.on(ut.RequestLowStreamParameter,i=>{i(this._lowStreamParameter||{width:160,height:120,framerate:15,bitrate:50})}),this._p2pChannel.on(ut.QueryClientConnectionState,i=>{i(this.connectionState)})}getKeyMetrics(){return this.store.keyMetrics}async enableContentInspect(i){if(this.connectionState!=="CONNECTED"||!this._joinInfo)throw new ae(z.INVALID_OPERATION,"[".concat(this._clientId,"] Client did not join channel"));if(this._inspect)throw new ae(z.INVALID_OPERATION,"[".concat(this._clientId,"] Inspect content service already in connecting/connected state"));if(!i)throw new ae(z.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig is necessary"));if(!i.inspectType||!Array.isArray(i.inspectType))throw new ae(z.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig.inspectType is necessary and is an instance of Array."));{const s=[...new Set(i.inspectType)];s.forEach(a=>{var u;if(!ot(u=["supervise","moderation"]).call(u,a))throw new ae(z.INVALID_PARAMS,"[".concat(this._clientId,"] ").concat(a," is not a valid inspect type."))}),i.inspectType=s}if(i&&i.extraInfo&&i.extraInfo.length>1024)throw new ae(z.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig.extraInfo length cannot exceed 1024 bytes"));try{const s=new fA(i);this._inspect=s,this.handleVideoInspectEvents(this._inspect),await s.init({appId:this._joinInfo.appId,areaCode:"",cname:this._joinInfo.cname,sid:this._joinInfo.sid,token:this._joinInfo.token,uid:this._joinInfo.uid,cid:this._joinInfo.cid,vid:this._joinInfo.vid?Number(this._joinInfo.vid):0},Oi)}catch(s){throw Array.isArray(s)?s[0]:s}}async disableContentInspect(){if(!this._inspect)throw new ae(z.INVALID_OPERATION,"[".concat(this._clientId,"] inspectVideoContent not started"));try{this._inspect.close(),this._inspect=void 0}catch(i){throw Array.isArray(i)?i[0]:i}}async setImageModeration(i,s){if(Wp(i,"enabled"),i){if(!s)throw new ae(z.INVALID_PARAMS,"[".concat(this._clientId,"] config is necessary"));if(Tn(s.interval,"interval",1e3,1/0),this.connectionState!=="CONNECTED"||!this._joinInfo)throw new ae(z.INVALID_OPERATION,"[".concat(this._clientId,'] can not enable image moderation, not joined"'));try{if(this._moderation)return void this._moderation.updateConfig(s);const a=new HU(s);this._moderation=a,this.handleImageModerationEvents(this._moderation),await a.init({appId:this._joinInfo.appId,areaCode:"",cname:this._joinInfo.cname,sid:this._joinInfo.sid,token:this._joinInfo.token,uid:this._joinInfo.uid,cid:this._joinInfo.cid,vid:this._joinInfo.vid?Number(this._joinInfo.vid):0},Oi)}catch(a){throw Array.isArray(a)?a[0]:a}}else{if(!this._moderation)throw new ae(z.INVALID_OPERATION,"[".concat(this._clientId,"] image moderation not started"));try{this._moderation.close(),this._moderation.removeAllListeners(),this._moderation=void 0}catch(a){throw Array.isArray(a)?a[0]:a}}}handleImageModerationEvents(i){i.on(Fa.CONNECTION_STATE_CHANGE,(s,a)=>{if(this.safeEmit(Dt.IMAGE_MODERATION_CONNECTION_STATE_CHANGE,s,a),s===Lo.CONNECTED){if(this.connectionState!=="CONNECTED")throw this.setImageModeration(!1),new ae(z.OPERATION_ABORTED,"Image moderation was cancelled because it left the channel");i.inspectImage()}}),i.on(Fa.CLIENT_LOCAL_VIDEO_TRACK,s=>{s(this.localTracks.filter(a=>a.trackMediaType==="video")[0])})}handleVideoInspectEvents(i){i.on(Gi.CONNECTION_STATE_CHANGE,(s,a)=>{if(this.safeEmit(Dt.CONTENT_INSPECT_CONNECTION_STATE_CHANGE,s,a),a===oa.CONNECTED){if(this.connectionState!=="CONNECTED")return void this.safeEmit(Dt.CONTENT_INSPECT_ERROR,new ae(z.OPERATION_ABORTED,"Content inspect was cancelled because it left the channel"));i.inspectImage()}}),i.on(Gi.INSPECT_RESULT,(s,a)=>{var u;if((a==null?void 0:a.code)===z.INVALID_OPERATION&&this.connectionState==="DISCONNECTED")return D.debug("Stop inspect content because that has left channel"),this==null||(u=this._inspect)===null||u===void 0||u.close(),void(this._inspect=void 0);this.safeEmit(Dt.CONTENT_INSPECT_RESULT,s,a)}),i.on(Gi.CLIENT_LOCAL_VIDEO_TRACK,s=>{s(this.localTracks.filter(a=>a.trackMediaType==="video")[0])})}getJoinChannelServiceRecords(){return D.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}async setPublishAudioFilterEnabled(i){Wp(i,"enabled"),Sn("ENABLE_PUBLISH_AUDIO_FILTER",i),this._joinInfo&&await this._gateway.setPublishAudioFilterEnabled(i)}_handleResetAddStream(i,s){switch(s){case"audio":i._audio_added_=!1,i._trust_audio_stream_added_state_=!0;break;case"video":i._video_added_=!1,i._trust_video_stream_added_state_=!0}}}ve([ht(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",le)],Cn.prototype,"leave",null),ve([ht({argsMap:(o,i)=>{if(!Array.isArray(i)){if(!(i instanceof Vr))return[i];i=[i]}return i.map(s=>s?Object(s).toString():"null")}}),j("design:type",Function),j("design:paramtypes",[Object,Boolean]),j("design:returntype",le)],Cn.prototype,"publish",null),ve([ht({argsMap:(o,i)=>(i||(i=[]),i instanceof bH?[i.getChannelId()]:(Array.isArray(i)||(i=[i]),i.map(s=>s.getTrackId())))}),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",le)],Cn.prototype,"unpublish",null),ve([ht({argsMap:(o,i,s,a)=>[i.uid,s,a]}),j("design:type",Function),j("design:paramtypes",[Wr,String,Number]),j("design:returntype",le)],Cn.prototype,"subscribe",null),ve([ht({argsMap:(o,i)=>i.map(s=>{let{user:a,mediaType:u}=s;return[a==null?void 0:a.uid,u]})}),j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",le)],Cn.prototype,"massSubscribe",null),ve([ht({argsMap:(o,i,s,a)=>[i.uid,s,a]}),j("design:type",Function),j("design:paramtypes",[Wr,String,Number]),j("design:returntype",le)],Cn.prototype,"unsubscribe",null),ve([ht({argsMap:(o,i)=>i.map(s=>{let{user:a,mediaType:u}=s;return{uid:a==null?void 0:a.uid,mediaType:u}})}),j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",le)],Cn.prototype,"massUnsubscribe",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",le)],Cn.prototype,"setLowStreamParameter",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",le)],Cn.prototype,"enableDualStream",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",le)],Cn.prototype,"disableDualStream",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[String,Object]),j("design:returntype",le)],Cn.prototype,"setClientRole",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[String,Boolean]),j("design:returntype",void 0)],Cn.prototype,"setProxyServer",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[Object,Boolean]),j("design:returntype",void 0)],Cn.prototype,"setTurnServer",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",void 0)],Cn.prototype,"setLicense",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[Number]),j("design:returntype",void 0)],Cn.prototype,"startProxyServer",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Cn.prototype,"stopProxyServer",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",void 0)],Cn.prototype,"setLocalAccessPointsV2",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[Array,String]),j("design:returntype",void 0)],Cn.prototype,"setLocalAccessPoints",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[Number]),j("design:returntype",le)],Cn.prototype,"setRemoteDefaultVideoStreamType",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[Object,Number]),j("design:returntype",le)],Cn.prototype,"setRemoteVideoStreamType",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[Object,Number]),j("design:returntype",le)],Cn.prototype,"setStreamFallbackOption",null),ve([ht({argsMap:(o,i)=>[i]}),j("design:type",Function),j("design:paramtypes",[String,String,Uint8Array]),j("design:returntype",void 0)],Cn.prototype,"setEncryptionConfig",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",le)],Cn.prototype,"renewToken",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Cn.prototype,"enableAudioVolumeIndicator",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[String,Boolean]),j("design:returntype",le)],Cn.prototype,"startLiveStreaming",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",le)],Cn.prototype,"setLiveTranscoding",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",le)],Cn.prototype,"stopLiveStreaming",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[String,Object]),j("design:returntype",le)],Cn.prototype,"addInjectStreamUrl",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",le)],Cn.prototype,"removeInjectStreamUrl",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[tA]),j("design:returntype",le)],Cn.prototype,"startChannelMediaRelay",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[tA]),j("design:returntype",le)],Cn.prototype,"updateChannelMediaRelay",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",le)],Cn.prototype,"stopChannelMediaRelay",null),ve([ht({argsMap:(o,i)=>(Array.isArray(i)||(i=[i]),[JSON.stringify(i)])}),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",le)],Cn.prototype,"sendCustomReportMessage",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[Object,Object]),j("design:returntype",le)],Cn.prototype,"pickSVCLayer",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[Number]),j("design:returntype",le)],Cn.prototype,"setRTM2Flag",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",le)],Cn.prototype,"enableContentInspect",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",le)],Cn.prototype,"disableContentInspect",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[Boolean,Object]),j("design:returntype",le)],Cn.prototype,"setImageModeration",null),ve([ht({reportResult:!0}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",Array)],Cn.prototype,"getJoinChannelServiceRecords",null),ve([ht(),j("design:type",Function),j("design:paramtypes",[Boolean]),j("design:returntype",le)],Cn.prototype,"setPublishAudioFilterEnabled",null);class wS{constructor(i,s){O(this,"id",0),O(this,"element",void 0),O(this,"peerPair",void 0),O(this,"context",void 0),O(this,"audioPlayerElement",void 0),O(this,"audioTrack",void 0),wS.count+=1,this.id=wS.count,this.element=i,this.context=s}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=i=>{const s=document.createElement("audio");s.srcObject=new MediaStream([i.track]),s.play(),this.audioPlayerElement=s}}async switchSdp(){if(!this.peerPair)return;const i=async(a,u)=>{const h=u==="offer"?await a.createOffer():await a.createAnswer();return await a.setLocalDescription(h),a.iceGatheringState==="complete"?a.localDescription:new le(p=>{a.onicegatheringstatechange=()=>{a.iceGatheringState==="complete"&&p(a.localDescription)}})},s=async(a,u)=>await a.setRemoteDescription(u);try{const a=await i(this.peerPair[0],"offer");await s(this.peerPair[1],a);const u=await i(this.peerPair[1],"answer");await s(this.peerPair[0],u)}catch(a){throw new ae(z.LOCAL_AEC_ERROR,a.toString()).print()}}async getTracksFromMediaElement(i){if(this.audioTrack)return this.audioTrack;let s;try{i instanceof HTMLVideoElement&&(i.captureStream?i.captureStream():i.mozCaptureStream()),s=this.context.createMediaStreamDestination(),this.context.createMediaElementSource(i).connect(s)}catch(u){throw new ae(z.LOCAL_AEC_ERROR,u.toString()).print()}if(!s)throw new ae(z.LOCAL_AEC_ERROR,"no dest node when local aec").print();const a=s.stream.getAudioTracks()[0];return this.audioTrack=a,a}getElement(){return this.element}async startEchoCancellation(){this.context.resume(),this.peerPair&&this.close(),this.initPeers();const i=this.element,s=await this.getTracksFromMediaElement(i);this.peerPair&&this.peerPair[0].addTrack(s),await this.switchSdp()}close(){D.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach(i=>{i.close()}),this.peerPair=void 0,this.audioPlayerElement=void 0}}O(wS,"count",0);const Hde=window.AudioContext||window.webkitAudioContext;class s9{constructor(){O(this,"units",[]),O(this,"context",void 0)}processExternalMediaAEC(i){if(!this._doesEnvironmentNeedAEC())return D.debug("the system does not need to process local aec"),-1;this.context||(this.context=new Hde);let s=this.units.find(a=>a&&a.getElement()===i);return s||(s=new wS(i,this.context),this.units.push(s)),s.startEchoCancellation(),D.debug("start processing local audio echo cancellation, id is",s.id),s.id}_doesEnvironmentNeedAEC(){return Zt().name!==an.SAFARI}}ve([ht({report:it}),j("design:type",Function),j("design:paramtypes",[HTMLAudioElement]),j("design:returntype",Number)],s9.prototype,"processExternalMediaAEC",null);const $de=new s9;function o9(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);i&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable})),s.push.apply(s,a)}return s}function a9(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?o9(Object(s),!0).forEach(function(a){O(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):o9(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}const zU=window||document;function c9(o){let i=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!zU)return;const s=sr._cspEventHandlerPointer;if(s&&i)return void console.error(s,i);const a=u=>{if(!(u&&u.blockedURI&&(sr.onSecurityPolicyViolation||sr.getListeners(sl.SECURITY_POLICY_VIOLATION).length>0)))return;const h=u.blockedURI;te("CSP_DETECTED_HOSTNAME_LIST").some(p=>ot(h).call(h,p))&&(sr.onSecurityPolicyViolation&&typeof sr.onSecurityPolicyViolation=="function"&&sr.onSecurityPolicyViolation(u),sr.getListeners(sl.SECURITY_POLICY_VIOLATION).length>0&&sr.safeEmit(sl.SECURITY_POLICY_VIOLATION,u))};s&&zU.removeEventListener("securitypolicyviolation",s),(i||o&&typeof o=="function"||sr.getListeners(sl.SECURITY_POLICY_VIOLATION).length>0)&&zU.addEventListener("securitypolicyviolation",a),sr._cspEventHandlerPointer=a}Sn("PROCESS_ID","process-".concat(wn(8,""),"-").concat(wn(4,""),"-").concat(wn(4,""),"-").concat(wn(4,""),"-").concat(wn(12,""))),function(){const o=Zt();is.getDisplayMedia=function(i){return!!(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)}(),is.getStreamFromExtension=o.name===an.CHROME&&Number(o.version)>34,is.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;const i=new RTCPeerConnection;let s=!1;try{i.addTransceiver("audio"),s=!0}catch{}return i.close(),s}(),is.supportMinBitrate=o.name===an.CHROME||o.name===an.EDGE,is.supportSetRtpSenderParameters=function(){const i=Zt();return!window.RTCRtpSender||!window.RTCRtpSender.prototype.setParameters||!window.RTCRtpSender.prototype.getParameters?!1:!!Ih()||!(!fs()&&!eI())||i.name===an.FIREFOX&&Number(i.version)>=64}(),o.name===an.SAFARI&&(Number(o.version)>=14?is.supportDualStream=!0:is.supportDualStream=!1),is.webAudioMediaStreamDest=function(){const i=Zt();return!(i.name===an.SAFARI&&Number(i.version)<12)}(),is.supportReplaceTrack=function(){return window.RTCRtpSender?typeof RTCRtpSender.prototype.replaceTrack=="function":!1}(),is.supportWebGL=typeof WebGLRenderingContext<"u",is.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,Ih()||(is.webAudioWithAEC=!0),is.supportShareAudio=function(){const i=Zt();return(i.os===tr.WIN_10||i.os===tr.WIN_81||i.os===tr.WIN_7||i.os===tr.LINUX||i.os===tr.MAC_OS)&&i.name===an.CHROME&&Number(i.version)>=74}(),is.supportDataChannel=function(){return!!(WM(76)||function(i){const s=Zt();return!(s.name!==an.FIREFOX||!s.osVersion)&&Number(s.version)>=i}(68)||function(i){const s=Zt();return!(s.name!==an.SAFARI||!s.osVersion)&&Number(s.version)>=i}(14))}(),is.supportPCSetConfiguration=function(){const i=window.RTCPeerConnection;return!jn()&&!!i&&i.prototype.setConfiguration instanceof Function}(),is.supportWebRTCEncodedTransform=function(){const i=Zt();return i.name==="Chrome"&&Number(i.version)>=86}(),is.supportWebRTCInsertableStream=function(){const i=Zt();return(i.name===an.CHROME||i.name===an.EDGE)&&Number(i.version)>=94&&"MediaStreamTrackGenerator"in window&&"MediaStreamTrackProcessor"in window}(),pc(()=>{is.supportDualStreamEncoding=function(){const i=Zt();return te("DISABLE_WEBAUDIO")?!0:i.name==="Safari"&&Number(i.version)>=14||!!(i.name==="Chrome"&&/Windows/i.test(i.os||"")&&Number(i.version)>=100&&te("CHROME_DUAL_STREAM_USE_ENCODING"))}(),D.info("browser compatibility",JSON.stringify(is),JSON.stringify(o))})}(),function(){let o;try{o=window.localStorage.getItem("websdk_ng_global_parameter")}catch(i){return void D.error("Error loading sdk config",i.message)}if(o)try{const i=JSON.parse(window.atob(o)),s=Date.now();D.debug("Loading global parameters from cache",i),Object.keys(i).forEach(a=>{if(Object.prototype.hasOwnProperty.call(Cs,a)){const{value:u,expires:h}=i[a];if(h&&h<=s)return;Oh[a]=u,Cs[a]=u}})}catch(i){D.error("Error loading mutableParamsCache: ".concat(o),i.message)}}(),Array.isArray(Oh.AREAS)&&Oh.AREAS.length>0&&yU(Oh.AREAS,!0);const sr=function(o){const i=new Hn,s=o,a={getListeners:i.getListeners.bind(i),on:(u,h)=>(function(p,_){p===sl.SECURITY_POLICY_VIOLATION&&c9(_,!0)}(u,h),i.on.bind(i)(u,h)),addListener:i.addListener.bind(i),once:i.once.bind(i),off:i.off.bind(i),removeAllListeners:i.removeAllListeners.bind(i),emit:i.emit.bind(i),safeEmit:i.safeEmit.bind(i)};return a9(a9({},s),a)}({__TRACK_LIST__:J_,VERSION:Ua,BUILD:_2,ESM_BUNDLER:!1,ESM:!1,UMD:!0,DEV:!1,setParameter:(o,i,s)=>{D.debug("setParameter key:".concat(o,", value:").concat(JSON.stringify(i))),Sn(o,i,s)},getParameter:te,getSupportedCodec:async function(){let o={audio:[],video:[]};try{let i=new RTCPeerConnection;i.addTransceiver("video",{direction:"recvonly"}),i.addTransceiver("audio",{direction:"recvonly"});const s=(await i.createOffer()).sdp;if(!s)return o;i.close(),i=null,o=function(a){const u={video:[],audio:[]};return a.match(/ VP8/i)&&u.video.push("VP8"),a.match(/ VP9/i)&&u.video.push("VP9"),a.match(/ AV1/i)&&u.video.push("AV1"),a.match(/ H264/i)&&u.video.push("H264"),a.match(/ H265/i)&&u.video.push("H265"),a.match(/ opus/i)&&u.audio.push("OPUS"),a.match(/ PCMU/i)&&u.audio.push("PCMU"),a.match(/ PCMA/i)&&u.audio.push("PCMA"),a.match(/ G722/i)&&u.audio.push("G722"),u}(s)}catch(i){throw new ae(z.CREATE_OFFER_FAILED,i.toString&&i.toString()).print()}return o},checkSystemRequirements:function(){const o=it.reportApiInvoke(null,{name:Mi.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:Yn.TRACER});let i=!1;try{const h=window.RTCPeerConnection,p=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,_=window.WebSocket;i=!!(h&&p&&_)}catch(h){return D.error("check system requirement failed: ",h),!1}let s=!1;const a=Zt();a.name===an.CHROME&&Number(a.version)>=58&&(!Zae()||Qae())&&(s=!0),a.name===an.FIREFOX&&Number(a.version)>=56&&(s=!0),a.name===an.OPERA&&Number(a.version)>=45&&(s=!0),a.name===an.SAFARI&&Number(a.version)>=11&&(s=!0),(f8()||Zt().name===an.QQ)&&(s=!0),D.debug("checkSystemRequirements, api:",i,"browser",s);const u=i&&s;return o.onSuccess(u),u},getDevices:function(o){return ua.enumerateDevices(!0,!0,o)},getMicrophones:function(o){return ua.getRecordingDevices(o)},getCameras:function(o){return ua.getCamerasDevices(o)},getElectronScreenSources:d7,getPlaybackDevices:function(o){return ua.getSpeakers(o)},createClient:function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"};const i=it.reportApiInvoke(null,{name:Mi.CREATE_CLIENT,options:[o],tag:Yn.TRACER});try{(function(s){nr(s.codec,"config.codec",["vp8","vp9","av1","h264","h265"]),nr(s.mode,"config.mode",["rtc","live"]),s.audioCodec!==void 0&&nr(s.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),s.proxyServer!==void 0&&jr(s.proxyServer,"config.proxyServer",1,1e4),s.turnServer!==void 0&&T8(s.turnServer),s.httpRetryConfig!==void 0&&S8(s.httpRetryConfig),s.websocketRetryConfig!==void 0&&S8(s.websocketRetryConfig)})(o)}catch(s){throw i.onError(s),s}return Wde()||(o.codec==="vp9"&&(o.codec="vp8",D.debug("browser not support vp9, force use vp8")),Sn("UNSUPPORTED_VIDEO_CODEC",["vp9"])),o.audioCodec===void 0&&(o.audioCodec="opus"),i.onSuccess(),new Cn(bS(bS({forceWaitGatewayResponse:!0},o),{},{role:o.mode==="rtc"?"host":o.role||"audience"}))},createCameraVideoTrack:async function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const i=it.reportApiInvoke(null,{tag:Yn.TRACER,name:Mi.CREATE_CAM_VIDEO_TRACK,options:[DI({},o)]}),s=xI(o),a=wn(8,"track-cam-");let u=null;const h=o.encoderConfig==="720p_auto";D.info("start create camera video track with config",JSON.stringify(o),"trackId",a);try{u=(await la({video:s},a)).getVideoTracks()[0]||null}catch(_){throw i.onError(_),_}if(!u){const _=new Ee(z.UNEXPECTED_ERROR,"can not find track in media stream");return i.onError(_),_.throw(D)}o.optimizationMode&&G2(a,u,o,eu(o.encoderConfig));const p=new jh(u,o,s,o.scalabiltyMode?wI(o.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},o.optimizationMode,a);return h&&p.startMonitorStats(),i.onSuccess(p.getTrackId()),D.info("create camera video success, trackId:",a),p},createCustomVideoTrack:function(o){const i=it.reportApiInvoke(null,{tag:Yn.TRACER,name:Mi.CREATE_CUSTOM_VIDEO_TRACK,options:[o]}),s=new Ct(o.mediaStreamTrack,{width:o.width,height:o.height,frameRate:o.frameRate,bitrateMax:o.bitrateMax,bitrateMin:o.bitrateMin},o.scalabiltyMode?wI(o.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},o.optimizationMode,wn(8,"track-cus-"),[Ln.CUSTOM_TRACK]);return i.onSuccess(s.getTrackId()),D.info("create custom video track success with config",o,"trackId",s.getTrackId()),s},createScreenVideoTrack:async function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"disable";const s=it.reportApiInvoke(null,{tag:Yn.TRACER,name:Mi.CREATE_SCREEN_VIDEO_TRACK,options:[DI({},o),i]}),a=o.encoderConfig==="720p_auto";o.encoderConfig?typeof o.encoderConfig=="string"||o.encoderConfig.width&&o.encoderConfig.height||(o.encoderConfig.width={max:1920},o.encoderConfig.height={max:1080}):o.encoderConfig="1080p_2";const u=function(C){const N={};C.screenSourceType&&(N.mediaSource=C.screenSourceType),C.extensionId&&BM()&&(N.extensionId=C.extensionId);const{displaySurface:x,selfBrowserSurface:B,surfaceSwitching:F,systemAudio:H}=C;(WM(107)||c8(107)||l8(93))&&(x&&(nr(x,"displaySurface",["browser","window","monitor"]),N.displaySurface=x),B?(nr(B,"selfBrowserSurface",["exclude","include"]),N.selfBrowserSurface=B):N.selfBrowserSurface="include",F&&(nr(F,"surfaceSwitching",["exclude","include"]),N.surfaceSwitching=F)),(WM(105)||c8(105)||l8(91))&&H&&(nr(H,"systemAudio",["exclude","include"]),N.systemAudio=H),C.electronScreenSourceId&&(N.sourceId=C.electronScreenSourceId);const J=C.encoderConfig?P2(C.encoderConfig):null;return N.mandatory={chromeMediaSource:"desktop",maxWidth:J?J.width:void 0,maxHeight:J?J.height:void 0},J&&(J.frameRate&&(typeof J.frameRate=="number"?(N.mandatory.maxFrameRate=J.frameRate,N.mandatory.minFrameRate=J.frameRate):(N.mandatory.maxFrameRate=J.frameRate.max||J.frameRate.ideal||J.frameRate.exact||void 0,N.mandatory.minFrameRate=J.frameRate.min||J.frameRate.ideal||J.frameRate.exact||void 0),N.frameRate=J.frameRate),J.width&&(N.width=J.width),J.height&&(N.height=J.height)),N}(o),h=wn(8,"track-scr-v-");let p=null,_=null;const v=In();if(!v.supportShareAudio&&i==="enable"){const C=new Ee(z.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return s.onError(C),C.throw(D)}D.info("start create screen video track with config",o,"withAudio",i,"trackId",h);try{const C=await la({screen:u,screenAudio:i==="auto"?v.supportShareAudio:i==="enable"},h);p=C.getVideoTracks()[0]||null,_=C.getAudioTracks()[0]||null}catch(C){throw s.onError(C),C}if(!p){const C=new Ee(z.UNEXPECTED_ERROR,"can not find track in media stream");return s.onError(C),C.throw(D)}if(!_&&i==="enable"){p&&p.stop();const C=new Ee(z.SHARE_AUDIO_NOT_ALLOWED);return s.onError(C),C.throw(D)}o.optimizationMode||(o.optimizationMode="detail"),o.optimizationMode&&(G2(h,p,o,o.encoderConfig&&P2(o.encoderConfig)||void 0),o.encoderConfig&&typeof o.encoderConfig!="string"&&(o.encoderConfig.bitrateMin=o.encoderConfig.bitrateMax));const T=new Ct(p,o.encoderConfig?P2(o.encoderConfig):{},o.scalabiltyMode?wI(o.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},o.optimizationMode,h,[Ln.SCREEN_TRACK]);if(a&&T.startMonitorStats(),!_)return s.onSuccess(T.getTrackId()),D.info("create screen video track success","video:",T.getTrackId()),T;const b=new cn(_,void 0,wn(8,"track-scr-a-"),!1,!0);return s.onSuccess([T.getTrackId(),b.getTrackId()]),D.info("create screen video track success","video:",T.getTrackId(),"audio:",b.getTrackId()),[T,b]},createMicrophoneAndCameraTracks:async function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=it.reportApiInvoke(null,{tag:Yn.TRACER,name:Mi.CREATE_MIC_AND_CAM_TRACKS,options:[o,i]}),a=i.encoderConfig==="720p_auto",u=xI(i),h=b7(o),p=wn(8,"track-mic-"),_=wn(8,"track-cam-");let v=null,T=null;D.info("start create camera video track(".concat(_,") and microphone audio track(").concat(p,") with config, audio: ").concat(JSON.stringify(o),", video: ").concat(JSON.stringify(i)));try{const N=await la({audio:h,video:u},"".concat(p,"-").concat(_));v=N.getAudioTracks()[0],T=N.getVideoTracks()[0]}catch(N){throw s.onError(N),N}if(!v||!T){const N=new Ee(z.UNEXPECTED_ERROR,"can not find tracks in media stream");return s.onError(N),N.throw(D)}i.optimizationMode&&G2(_,T,i,eu(i.encoderConfig));const b=new Mh(v,o,h,p),C=new jh(T,i,u,i.scalabiltyMode?wI(i.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},i.optimizationMode,_);return a&&C.startMonitorStats(),s.onSuccess([b.getTrackId(),C.getTrackId()]),D.info("create camera video track(".concat(_,") and microphone audio track(").concat(p,") success")),[b,C]},createMicrophoneAudioTrack:async function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const i=it.reportApiInvoke(null,{tag:Yn.TRACER,name:Mi.CREATE_MIC_AUDIO_TRACK,options:[o]}),s=b7(o),a=wn(8,"track-mic-");let u=null;D.info("start create microphone audio track with config",JSON.stringify(o),"trackId",a);try{u=(await la({audio:s},a)).getAudioTracks()[0]||null}catch(p){throw i.onError(p),p}if(!u){const p=new Ee(z.UNEXPECTED_ERROR,"can not find track in media stream");return i.onError(p),p.throw(D)}const h=new Mh(u,o,s,a);return i.onSuccess(h.getTrackId()),D.info("create microphone audio track success, trackId:",a),h},createCustomAudioTrack:function(o){const i=it.reportApiInvoke(null,{tag:Yn.TRACER,name:Mi.CREATE_CUSTOM_AUDIO_TRACK,options:[o]}),s=new cn(o.mediaStreamTrack,o.encoderConfig?CI(o.encoderConfig):{},wn(8,"track-cus-"),!1,!0);return D.info("create custom audio track success with config",o,"trackId",s.getTrackId()),i.onSuccess(s.getTrackId()),s},createBufferSourceAudioTrack:async function(o){var i;const{cacheOnlineFile:s,encoderConfig:a}=o;let{source:u}=o;const h={source:u instanceof AudioBuffer?"AudioBuffer":u instanceof File?(i=File.name)!==null&&i!==void 0?i:"File":u,cacheOnlineFile:s,encoderConfig:a},p=it.reportApiInvoke(null,{tag:Yn.TRACER,name:Mi.CREATE_BUFFER_AUDIO_TRACK,options:[h]});if(te("DISABLE_WEBAUDIO"))throw new Ee(z.NOT_SUPPORTED,"can not create BufferSourceAudioTrack when WebAudio disabled");const _=wn(8,"track-buf-");D.info("start create buffer source audio track with config",JSON.stringify(h),"trackId",_);const v=u;if(!(u instanceof AudioBuffer))try{u=await jle(u,s)}catch(C){return p.onError(C),C.throw(D)}const T=new Ule(u),b=new Uh(v,T,a?CI(a):{},_);return D.info("create buffer source audio track success, trackId:",_),p.onSuccess(b.getTrackId()),b},setAppType:function(o){if(D.debug("setAppType: ".concat(o)),!(Number.isInteger(o)&&o>=0))throw D.debug("Invalid appType"),new ae(z.INVALID_PARAMS,"invalid app type",o);Sn("APP_TYPE",Math.floor(o))},setLogLevel:function(o){D.setLogLevel(o)},enableLogUpload:function(){te("USE_NEW_LOG")?Sn("UPLOAD_LOG",!0):D.enableLogUpload()},disableLogUpload:function(){te("USE_NEW_LOG")?Sn("UPLOAD_LOG",!1):D.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new tA},checkAudioTrackIsActive:async function(o){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const s=it.reportApiInvoke(null,{tag:Yn.TRACER,name:Mi.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[i]});if(!(o instanceof cn||o instanceof _c)){const v=new ae(z.INVALID_TRACK,"the parameter is not a audio track");return s.onError(v),v.throw()}i&&i<1e3&&(i=1e3);const a=o instanceof cn?o.getTrackLabel():"remote_track",u=o.getVolumeLevel();let h=u,p=u;const _=Date.now();return new le(v=>{const T=setInterval(()=>{const b=o.getVolumeLevel();h=b>h?b:h,p=b<p?b:p;const C=h-p>1e-4,N=Date.now()-_;if(C||N>i){clearInterval(T);const x=C,B={duration:N,deviceLabel:a,maxVolumeLevel:h,result:x};D.info("[track-".concat(o.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(B))),s.onSuccess(B),v(x)}},200)})},checkVideoTrackIsActive:async function(o){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const s=it.reportApiInvoke(null,{tag:Yn.TRACER,name:Mi.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[i]});if(!(o instanceof Ct||o instanceof tu)){const C=new ae(z.INVALID_TRACK,"the parameter is not a video track");return s.onError(C),C.throw()}i&&i<1e3&&(i=1e3);const a=o instanceof Ct?o.getTrackLabel():"remote_track",u=o.getMediaStreamTrack(!0),h=document.createElement("video");h.style.width="1px",h.style.height="1px",h.setAttribute("muted",""),h.muted=!0,h.setAttribute("playsinline",""),h.controls=!1,(fs()||eI())&&(h.style.opacity="0.01",h.style.position="fixed",h.style.left="0",h.style.top="0",document.body.appendChild(h)),h.srcObject=new MediaStream([u]),h.play();const p=document.createElement("canvas");p.width=160,p.height=120;let _=0,v=0;try{const C=Date.now();_=await function(N,x,B,F){let H,J=0,ee=null;return new le((se,ye)=>{function me(){J>F&&H&&(H(),se(J));const ue=B.getContext("2d");if(!ue){const Ve=new ae(z.UNEXPECTED_ERROR,"can not get canvas 2d context.");return D.error(Ve.toString()),void ye(Ve)}ue.drawImage(N,0,0,160,120);const he=ue.getImageData(0,0,B.width,B.height),pe=Math.floor(he.data.length/3);if(ee){for(let Ve=0;Ve<pe;Ve+=3)if(he.data[Ve]!==ee[Ve])return J+=1,void(ee=he.data);ee=he.data}else ee=he.data}setTimeout(()=>{H&&(H(),se(J))},x),H=U2(()=>{me()},30)})}(h,i,p,4),v=Date.now()-C}catch(C){throw s.onError(C),C}Bde===an.SAFARI&&(h.pause(),h.remove()),h.srcObject=null;const T=_>4,b={duration:v,changedPicNum:_,deviceLabel:a,result:T};return D.info("[track-".concat(o.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(b))),s.onSuccess(b),T},setArea:yU,audioElementPlayCenter:Mo,processExternalMediaAEC:function(o){$de.processExternalMediaAEC(o)},registerExtensions:function(o){o.forEach(i=>{const s=i;s.__registered__=!0,s.logger.hookLog=D.extLog,s.reporter.hookApiInvoke=it.extApiInvoke,s.parameters&&Object.keys(s.parameters).forEach(a=>{s.parameters[a]=te(a)})})},ChannelMediaRelayError:xh,ChannelMediaRelayEvent:il,ChannelMediaRelayState:Rs,RemoteStreamFallbackType:x2,RemoteStreamType:RI,ConnectionDisconnectedReason:Pt,AudienceLatencyLevelType:GM,AREAS:Yt});return Object.defineProperties(sr,{onAudioAutoplayFailed:{get:()=>da.onAudioAutoplayFailed,set:o=>{da.onAudioAutoplayFailed=o}},onAutoplayFailed:{get:()=>da.onAutoplayFailed,set:o=>{da.onAutoplayFailed=o}},_onSecurityPolicyViolation:{value:void 0,writable:!0},_cspEventHandlerPointer:{value:void 0,writable:!0},onSecurityPolicyViolation:{get:()=>sr._onSecurityPolicyViolation,set(o){sr._onSecurityPolicyViolation=o,c9(o)}},__CLIENT_LIST__:{get:()=>te("SHOW_GLOBAL_CLIENT_LIST")?Nh:[]}}),ua.on(cd.CAMERA_DEVICE_CHANGED,o=>{D.info("camera device changed",JSON.stringify(o)),sr.onCameraChanged&&sr.onCameraChanged(o),sr.safeEmit(sl.CAMERA_CHANGED,o)}),ua.on(cd.RECORDING_DEVICE_CHANGED,o=>{D.info("microphone device changed",JSON.stringify(o)),sr.onMicrophoneChanged&&sr.onMicrophoneChanged(o),sr.safeEmit(sl.MICROPHONE_CHANGED,o)}),ua.on(cd.PLAYOUT_DEVICE_CHANGED,o=>{D.debug("playout device changed",JSON.stringify(o)),sr.onPlaybackDeviceChanged&&sr.onPlaybackDeviceChanged(o),sr.safeEmit(sl.PLAYBACK_DEVICE_CHANGED,o)}),Mo.onAutoplayFailed=()=>{D.info("detect audio element autoplay failed"),da.onAudioAutoplayFailed&&da.onAudioAutoplayFailed()},_n.on("autoplay-failed",()=>{D.info("detect webaudio autoplay failed"),da.onAudioAutoplayFailed&&da.onAudioAutoplayFailed(),sr.safeEmit(sl.AUTOPLAY_FAILED)}),Ii.on(od.NETWORK_STATE_CHANGE,(o,i)=>{D.info("[network-indicator] network state changed, ".concat(i," => ").concat(o))}),window&&(window.__ARTC__=sr),sr})})(mre);var wLe=mre.exports;const DV=Kf(wLe),CLe={mode:"rtc",codec:"vp9"};let zE=DV.createClient(CLe),eO={appId:"7da9f91d67c847669ae92ea41d529572",channel:"call",uid:null,token:null},vl={audioTrack:null,videoTrack:null},$5={};const RLe=async t=>{zE.on("user-published",ALe),zE.on("user-unpublished",OLe);try{[eO.uid,vl.audioTrack,vl.videoTrack]=await Promise.all([zE.join(eO.appId,eO.channel,eO.token||null),DV.createMicrophoneAudioTrack(),t==="video"?DV.createCameraVideoTrack():null]);const e=Object.values(vl).filter(n=>n!==null);t==="video"&&vl.videoTrack.play("local-video"),await zE.publish(Object.values(e))}catch(e){console.error("Error joining the channel:",e)}},ILe=async(t,e)=>{await zE.subscribe(t,e),e==="video"&&t.videoTrack.play("remote-video"),e==="audio"&&t.audioTrack.play()},kV=async()=>{for(const t in vl){const e=vl[t];e&&(e.stop(),e.close(),vl[t]=void 0),$5={},await zE.leave()}},ALe=async(t,e)=>{const n=t.uid;$5[n]=t,ILe(t,e)},OLe=async t=>{const e=t.uid;delete $5[e]},NLe=t=>{t?vl.videoTrack.setEnabled(!0):vl.videoTrack.setEnabled(!1)},PLe=t=>{t?vl.audioTrack.setEnabled(!0):vl.audioTrack.setEnabled(!1)},xLe="/assets/icon-flatImageChat-bb07b063.svg";function gre({data:t,currentUser:e,online:n}){var d,f;const[r,c]=$.useState(null),l=bi();return $.useEffect(()=>{const m=t.members.find(y=>y!==e);(async()=>{try{const{data:y}=await E5(m);c(y)}catch(y){console.log(y,"//"),y.response.data.error==="Token has expired"&&l(Bi())}})()},[]),R.jsxs(R.Fragment,{children:[R.jsx("div",{className:"conversation",children:R.jsxs("div",{className:"follower",children:[n&&R.jsx("div",{className:"online-dot"}),!n&&R.jsxs(R.Fragment,{children:[R.jsx("div",{className:"online-dot"}),R.jsx("div",{className:"offline-dot"})]}),R.jsx("img",{src:(r==null?void 0:r.profileimage)||Gr,alt:"Profile",className:"followerImage",style:{width:"50px",height:"50px",borderRadius:"50%"}}),R.jsxs("div",{className:"name",style:{fontSize:"0.8rem"},children:[R.jsx("span",{children:r==null?void 0:r.username}),R.jsx("span",{style:{color:n?"#51e200":"darkgrey"},children:n?"Online":"Offline"}),R.jsx("span",{className:"trunc-text lg-text",children:(d=t==null?void 0:t.lastMessage)!=null&&d.media?R.jsxs("span",{children:[R.jsx("img",{style:{width:"1rem"},src:xLe,alt:""})," Image"]}):(f=t==null?void 0:t.lastMessage)==null?void 0:f.text})]})]})}),R.jsx("div",{className:"divider"})]})}gre.propTypes={data:Le.object.isRequired,currentUser:Le.string.isRequired,online:Le.bool.isRequired};const _re=ip(),DLe=t=>_re.get(`/message/${t}`),jq=t=>_re.post("/message/",t);var kLe=["second","minute","hour","day","week","month","year"];function LLe(t,e){if(e===0)return["just now","right now"];var n=kLe[Math.floor(e/2)];return t>1&&(n+="s"),[t+" "+n+" ago","in "+t+" "+n]}var MLe=["秒","分钟","小时","天","周","个月","年"];function ULe(t,e){if(e===0)return["刚刚","片刻后"];var n=MLe[~~(e/2)];return[t+" "+n+"前",t+" "+n+"后"]}var LV={},Ere=function(t,e){LV[t]=e},jLe=function(t){return LV[t]||LV.en_US},aF=[60,60,24,7,365/7/12,12];function Fq(t){return t instanceof Date?t:!isNaN(t)||/^\d+$/.test(t)?new Date(parseInt(t)):(t=(t||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(t))}function FLe(t,e){var n=t<0?1:0;t=Math.abs(t);for(var r=t,c=0;t>=aF[c]&&c<aF.length;c++)t/=aF[c];return t=Math.floor(t),c*=2,t>(c===0?9:1)&&(c+=1),e(t,c,r)[n].replace("%s",t.toString())}function VLe(t,e){var n=e?Fq(e):new Date;return(+n-+Fq(t))/1e3}var MV=function(t,e,n){var r=VLe(t,n&&n.relativeDate);return FLe(r,jLe(e))};Ere("en_US",LLe);Ere("zh_CN",ULe);const BLe="/assets/icon-flatSent-6791b2ce.svg",WLe="/assets/icon-flatShare-c24f65bf.svg",HLe="/assets/icon-flatCloseBtn-43a3afee.svg",$Le="/assets/icon-flatVedioCall-3c4fee9e.svg",zLe="/assets/icon-flatCallIcon-3e5e8daa.svg";function GLe(t,e){e===void 0&&(e={});var n=e.insertAt;if(!(!t||typeof document>"u")){var r=document.head||document.getElementsByTagName("head")[0],c=document.createElement("style");c.type="text/css",n==="top"&&r.firstChild?r.insertBefore(c,r.firstChild):r.appendChild(c),c.styleSheet?c.styleSheet.cssText=t:c.appendChild(document.createTextNode(t))}}var KLe=`.react-input-emoji--container {
  color: #4b4b4b;
  text-rendering: optimizeLegibility;
  background-color: #fff;
  border: 1px solid #fff;
  border-radius: 21px;
  margin: 5px 10px;
  box-sizing: border-box;
  flex: 1 1 auto;
  font-size: 15px;
  font-family: sans-serif;
  font-weight: 400;
  line-height: 20px;
  min-height: 20px;
  min-width: 0;
  outline: none;
  width: inherit;
  will-change: width;
  vertical-align: baseline;
  border: 1px solid #eaeaea;
  margin-right: 0;
}

.react-input-emoji--wrapper {
  display: flex;
  overflow: hidden;
  flex: 1;
  position: relative;
  padding-right: 0;
  vertical-align: baseline;
  outline: none;
  margin: 0;
  padding: 0;
  border: 0;
}

.react-input-emoji--input {
  font-weight: 400;
  max-height: 100px;
  min-height: 20px;
  outline: none;
  overflow-x: hidden;
  overflow-y: auto;
  position: relative;
  white-space: pre-wrap;
  word-wrap: break-word;
  z-index: 1;
  width: 100%;
  user-select: text;
  padding: 9px 12px 11px;
  text-align: left;
}

.react-input-emoji--input img {
  vertical-align: middle;
  width: 18px !important;
  height: 18px !important;
  display: inline !important;
  margin-left: 1px;
  margin-right: 1px;
}

.react-input-emoji--overlay {
  position: fixed;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  z-index: 9;
}

.react-input-emoji--placeholder {
  color: #a0a0a0;
  pointer-events: none;
  position: absolute;
  user-select: none;
  z-index: 2;
  left: 16px;
  top: 0;
  bottom: 0;
  display: flex;
  align-items: center;
  width: calc(100% - 22px);
}

.react-input-emoji--button {
  position: relative;
  display: block;
  text-align: center;
  padding: 0 10px;
  overflow: hidden;
  transition: color 0.1s ease-out;
  margin: 0;
  box-shadow: none;
  background: none;
  border: none;
  outline: none;
  cursor: pointer;
  flex-shrink: 0;
}

.react-input-emoji--button svg {
  fill: #858585;
}

.react-input-emoji--button__show svg {
  fill: #128b7e;
}

.react-emoji {
  display: flex;
  align-items: center;
  position: relative;
  width: 100%;
}

.react-emoji-picker--container {
  position: absolute;
  top: 0;
  width: 100%;
}

.react-emoji-picker--wrapper {
  position: absolute;
  bottom: 0;
  right: 0;
  height: 435px;
  width: 352px;
  overflow: hidden;
  z-index: 10;
}

.react-emoji-picker {
  position: absolute;
  top: 0;
  left: 0;
  animation: slidein 0.1s ease-in-out;
}

.react-emoji-picker__show {
  top: 0;
}

.react-input-emoji--mention--container {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  z-index: 10;
}

.react-input-emoji--mention--list {
  background-color: #fafafa;
  border: 1px solid #eaeaea;
  border-radius: 4px;
  margin: 0;
  padding: 0;
  list-style: none;
  display: flex;
  gap: 5px;
  flex-direction: column;
  position: absolute;
  bottom: 0;
  width: 100%;
  left: 0;
}

.react-input-emoji--mention--item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 5px 10px;
  background-color: transparent;
  width: 100%;
  margin: 0;
  border: 0;
}

.react-input-emoji--mention--item__selected {
  background-color: #eeeeee;
}

.react-input-emoji--mention--item--img {
  width: 34px;
  height: 34px;
  border-radius: 50%;
}

.react-input-emoji--mention--item--name {
  font-size: 16px;
  color: #333;
}

.react-input-emoji--mention--item--name__selected {
  color: green;
}

.react-input-emoji--mention--text {
  color: #039be5;
}

.react-input-emoji--mention--loading {
  background-color: #fafafa;
  border: 1px solid #eaeaea;
  border-radius: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 10px 0;
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
}

.react-input-emoji--mention--loading--spinner,
.react-input-emoji--mention--loading--spinner::after {
  border-radius: 50%;
  width: 10em;
  height: 10em;
}

.react-input-emoji--mention--loading--spinner {
  margin: 1px auto;
  font-size: 2px;
  position: relative;
  text-indent: -9999em;
  border-top: 1.1em solid rgba(0, 0, 0, 0.1);
  border-right: 1.1em solid rgba(0, 0, 0, 0.1);
  border-bottom: 1.1em solid rgba(0, 0, 0, 0.1);
  border-left: 1.1em solid rgba(0, 0, 0, 0.4);
  transform: translateZ(0);
  animation: load8 1.1s infinite linear;
}

@keyframes load8 {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

@keyframes slidein {
  from {
    opacity: 0;
  }

  to {
    opacity: 1;
  }
}
`;GLe(KLe);function qLe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,c,l,d,f=[],m=!0,E=!1;try{if(l=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;m=!1}else for(;!(m=(r=l.call(n)).done)&&(f.push(r.value),f.length!==e);m=!0);}catch(y){E=!0,c=y}finally{try{if(!m&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(E)throw c}}return f}}function Vq(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),n.push.apply(n,r)}return n}function Bq(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Vq(Object(n),!0).forEach(function(r){YLe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Vq(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function rT(){rT=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,c=Object.defineProperty||function(be,Oe,_e){be[Oe]=_e.value},l=typeof Symbol=="function"?Symbol:{},d=l.iterator||"@@iterator",f=l.asyncIterator||"@@asyncIterator",m=l.toStringTag||"@@toStringTag";function E(be,Oe,_e){return Object.defineProperty(be,Oe,{value:_e,enumerable:!0,configurable:!0,writable:!0}),be[Oe]}try{E({},"")}catch{E=function(Oe,_e,We){return Oe[_e]=We}}function y(be,Oe,_e,We){var Ie=Oe&&Oe.prototype instanceof W?Oe:W,De=Object.create(Ie.prototype),Ue=new Ke(We||[]);return c(De,"_invoke",{value:xe(be,_e,Ue)}),De}function w(be,Oe,_e){try{return{type:"normal",arg:be.call(Oe,_e)}}catch(We){return{type:"throw",arg:We}}}e.wrap=y;var I="suspendedStart",P="suspendedYield",k="executing",M="completed",K={};function W(){}function V(){}function G(){}var Q={};E(Q,d,function(){return this});var Z=Object.getPrototypeOf,Y=Z&&Z(Z(He([])));Y&&Y!==n&&r.call(Y,d)&&(Q=Y);var oe=G.prototype=W.prototype=Object.create(Q);function ce(be){["next","throw","return"].forEach(function(Oe){E(be,Oe,function(_e){return this._invoke(Oe,_e)})})}function Se(be,Oe){function _e(Ie,De,Ue,rt){var gt=w(be[Ie],be,De);if(gt.type!=="throw"){var ft=gt.arg,Ft=ft.value;return Ft&&typeof Ft=="object"&&r.call(Ft,"__await")?Oe.resolve(Ft.__await).then(function(qt){_e("next",qt,Ue,rt)},function(qt){_e("throw",qt,Ue,rt)}):Oe.resolve(Ft).then(function(qt){ft.value=qt,Ue(ft)},function(qt){return _e("throw",qt,Ue,rt)})}rt(gt.arg)}var We;c(this,"_invoke",{value:function(Ie,De){function Ue(){return new Oe(function(rt,gt){_e(Ie,De,rt,gt)})}return We=We?We.then(Ue,Ue):Ue()}})}function xe(be,Oe,_e){var We=I;return function(Ie,De){if(We===k)throw new Error("Generator is already running");if(We===M){if(Ie==="throw")throw De;return{value:t,done:!0}}for(_e.method=Ie,_e.arg=De;;){var Ue=_e.delegate;if(Ue){var rt=je(Ue,_e);if(rt){if(rt===K)continue;return rt}}if(_e.method==="next")_e.sent=_e._sent=_e.arg;else if(_e.method==="throw"){if(We===I)throw We=M,_e.arg;_e.dispatchException(_e.arg)}else _e.method==="return"&&_e.abrupt("return",_e.arg);We=k;var gt=w(be,Oe,_e);if(gt.type==="normal"){if(We=_e.done?M:P,gt.arg===K)continue;return{value:gt.arg,done:_e.done}}gt.type==="throw"&&(We=M,_e.method="throw",_e.arg=gt.arg)}}}function je(be,Oe){var _e=Oe.method,We=be.iterator[_e];if(We===t)return Oe.delegate=null,_e==="throw"&&be.iterator.return&&(Oe.method="return",Oe.arg=t,je(be,Oe),Oe.method==="throw")||_e!=="return"&&(Oe.method="throw",Oe.arg=new TypeError("The iterator does not provide a '"+_e+"' method")),K;var Ie=w(We,be.iterator,Oe.arg);if(Ie.type==="throw")return Oe.method="throw",Oe.arg=Ie.arg,Oe.delegate=null,K;var De=Ie.arg;return De?De.done?(Oe[be.resultName]=De.value,Oe.next=be.nextLoc,Oe.method!=="return"&&(Oe.method="next",Oe.arg=t),Oe.delegate=null,K):De:(Oe.method="throw",Oe.arg=new TypeError("iterator result is not an object"),Oe.delegate=null,K)}function Ge(be){var Oe={tryLoc:be[0]};1 in be&&(Oe.catchLoc=be[1]),2 in be&&(Oe.finallyLoc=be[2],Oe.afterLoc=be[3]),this.tryEntries.push(Oe)}function ze(be){var Oe=be.completion||{};Oe.type="normal",delete Oe.arg,be.completion=Oe}function Ke(be){this.tryEntries=[{tryLoc:"root"}],be.forEach(Ge,this),this.reset(!0)}function He(be){if(be||be===""){var Oe=be[d];if(Oe)return Oe.call(be);if(typeof be.next=="function")return be;if(!isNaN(be.length)){var _e=-1,We=function Ie(){for(;++_e<be.length;)if(r.call(be,_e))return Ie.value=be[_e],Ie.done=!1,Ie;return Ie.value=t,Ie.done=!0,Ie};return We.next=We}}throw new TypeError(typeof be+" is not iterable")}return V.prototype=G,c(oe,"constructor",{value:G,configurable:!0}),c(G,"constructor",{value:V,configurable:!0}),V.displayName=E(G,m,"GeneratorFunction"),e.isGeneratorFunction=function(be){var Oe=typeof be=="function"&&be.constructor;return!!Oe&&(Oe===V||(Oe.displayName||Oe.name)==="GeneratorFunction")},e.mark=function(be){return Object.setPrototypeOf?Object.setPrototypeOf(be,G):(be.__proto__=G,E(be,m,"GeneratorFunction")),be.prototype=Object.create(oe),be},e.awrap=function(be){return{__await:be}},ce(Se.prototype),E(Se.prototype,f,function(){return this}),e.AsyncIterator=Se,e.async=function(be,Oe,_e,We,Ie){Ie===void 0&&(Ie=Promise);var De=new Se(y(be,Oe,_e,We),Ie);return e.isGeneratorFunction(Oe)?De:De.next().then(function(Ue){return Ue.done?Ue.value:De.next()})},ce(oe),E(oe,m,"Generator"),E(oe,d,function(){return this}),E(oe,"toString",function(){return"[object Generator]"}),e.keys=function(be){var Oe=Object(be),_e=[];for(var We in Oe)_e.push(We);return _e.reverse(),function Ie(){for(;_e.length;){var De=_e.pop();if(De in Oe)return Ie.value=De,Ie.done=!1,Ie}return Ie.done=!0,Ie}},e.values=He,Ke.prototype={constructor:Ke,reset:function(be){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(ze),!be)for(var Oe in this)Oe.charAt(0)==="t"&&r.call(this,Oe)&&!isNaN(+Oe.slice(1))&&(this[Oe]=t)},stop:function(){this.done=!0;var be=this.tryEntries[0].completion;if(be.type==="throw")throw be.arg;return this.rval},dispatchException:function(be){if(this.done)throw be;var Oe=this;function _e(gt,ft){return De.type="throw",De.arg=be,Oe.next=gt,ft&&(Oe.method="next",Oe.arg=t),!!ft}for(var We=this.tryEntries.length-1;We>=0;--We){var Ie=this.tryEntries[We],De=Ie.completion;if(Ie.tryLoc==="root")return _e("end");if(Ie.tryLoc<=this.prev){var Ue=r.call(Ie,"catchLoc"),rt=r.call(Ie,"finallyLoc");if(Ue&&rt){if(this.prev<Ie.catchLoc)return _e(Ie.catchLoc,!0);if(this.prev<Ie.finallyLoc)return _e(Ie.finallyLoc)}else if(Ue){if(this.prev<Ie.catchLoc)return _e(Ie.catchLoc,!0)}else{if(!rt)throw new Error("try statement without catch or finally");if(this.prev<Ie.finallyLoc)return _e(Ie.finallyLoc)}}}},abrupt:function(be,Oe){for(var _e=this.tryEntries.length-1;_e>=0;--_e){var We=this.tryEntries[_e];if(We.tryLoc<=this.prev&&r.call(We,"finallyLoc")&&this.prev<We.finallyLoc){var Ie=We;break}}Ie&&(be==="break"||be==="continue")&&Ie.tryLoc<=Oe&&Oe<=Ie.finallyLoc&&(Ie=null);var De=Ie?Ie.completion:{};return De.type=be,De.arg=Oe,Ie?(this.method="next",this.next=Ie.finallyLoc,K):this.complete(De)},complete:function(be,Oe){if(be.type==="throw")throw be.arg;return be.type==="break"||be.type==="continue"?this.next=be.arg:be.type==="return"?(this.rval=this.arg=be.arg,this.method="return",this.next="end"):be.type==="normal"&&Oe&&(this.next=Oe),K},finish:function(be){for(var Oe=this.tryEntries.length-1;Oe>=0;--Oe){var _e=this.tryEntries[Oe];if(_e.finallyLoc===be)return this.complete(_e.completion,_e.afterLoc),ze(_e),K}},catch:function(be){for(var Oe=this.tryEntries.length-1;Oe>=0;--Oe){var _e=this.tryEntries[Oe];if(_e.tryLoc===be){var We=_e.completion;if(We.type==="throw"){var Ie=We.arg;ze(_e)}return Ie}}throw new Error("illegal catch attempt")},delegateYield:function(be,Oe,_e){return this.delegate={iterator:He(be),resultName:Oe,nextLoc:_e},this.method==="next"&&(this.arg=t),K}},e}function Wq(t,e,n,r,c,l,d){try{var f=t[l](d),m=f.value}catch(E){n(E);return}f.done?e(m):Promise.resolve(m).then(r,c)}function Hq(t){return function(){var e=this,n=arguments;return new Promise(function(r,c){var l=t.apply(e,n);function d(m){Wq(l,r,c,d,f,"next",m)}function f(m){Wq(l,r,c,d,f,"throw",m)}d(void 0)})}}function YLe(t,e,n){return e=rMe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XLe(t,e){if(t==null)return{};var n={},r=Object.keys(t),c,l;for(l=0;l<r.length;l++)c=r[l],!(e.indexOf(c)>=0)&&(n[c]=t[c]);return n}function JLe(t,e){if(t==null)return{};var n=XLe(t,e),r,c;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(c=0;c<l.length;c++)r=l[c],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Md(t,e){return ZLe(t)||qLe(t,e)||yre(t,e)||nMe()}function vre(t){return QLe(t)||eMe(t)||yre(t)||tMe()}function QLe(t){if(Array.isArray(t))return UV(t)}function ZLe(t){if(Array.isArray(t))return t}function eMe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function yre(t,e){if(t){if(typeof t=="string")return UV(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return UV(t,e)}}function UV(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function tMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iMe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rMe(t){var e=iMe(t,"string");return typeof e=="symbol"?e:String(e)}var sMe="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";function Sre(t){var e=oMe(t);return e&&(e=vre(new Set(e)),e.forEach(function(n){t=Tre(t,n,bre("",n))})),t}function Tre(t,e,n){return t.replace(new RegExp(e,"g"),n)}function oMe(t){return t.match(/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?)*/g)}function aMe(t){var e,n=document.querySelector("em-emoji-picker");if(!n)return $q(t.native);var r=n==null||(e=n.shadowRoot)===null||e===void 0?void 0:e.querySelector('[title="'.concat(t.name,'"] > span > span'));if(!r)return $q(t.native);var c=Tre(r.style.cssText,'"',"'");return bre(c,t.native)}function bre(t,e){return'<img style="'.concat(t,'; display: inline-block" data-emoji="').concat(e,'" src="').concat(sMe,'" />')}function $q(t){return'<span class="width: 18px; height: 18px; display: inline-block; margin: 0 1px;">'.concat(t,"</span>")}function KO(t){var e=document.createElement("div");e.innerHTML=t;var n=Array.prototype.slice.call(e.querySelectorAll("img"));return n.forEach(function(r){e.innerHTML=e.innerHTML.replace(r.outerHTML,r.dataset.emoji)}),e.innerHTML}function cMe(t){var e=window.getSelection();if(e!==null){for(var n=document.createElement("div"),r=0,c=e.rangeCount;r<c;++r)n.appendChild(e.getRangeAt(r).cloneContents());n=uMe(n),t.clipboardData.setData("text",n.innerText),t.preventDefault()}}function lMe(t){var e,n;if(window.getSelection){if(e=window.getSelection(),e===null)return;if(e.getRangeAt&&e.rangeCount){n=e.getRangeAt(0),n.deleteContents();var r=document.createElement("div");r.innerHTML=t;for(var c=document.createDocumentFragment(),l,d;l=r.firstChild;)d=c.appendChild(l);n.insertNode(c),d&&(n=n.cloneRange(),n.setStartAfter(d),n.collapse(!0),e.removeAllRanges(),e.addRange(n))}}}function uMe(t){var e=Array.prototype.slice.call(t.querySelectorAll("img"));return e.forEach(function(n){n.outerHTML=n.dataset.emoji}),t}function zq(t){var e=t.text,n=t.html,r=e.length,c=(n.match(/<img/g)||[]).length;return r+c}function dMe(t){var e,n;document.createRange&&t.current&&(e=document.createRange(),e.selectNodeContents(t.current),e.collapse(!1),n=window.getSelection(),n&&(n.removeAllRanges(),n.addRange(e)))}function hMe(t){var e=t.innerHTML.replace(/<br\s*\/?>/gi,"[BR]"),n=e.replace(/<[^>]+>/g,""),r=n.replace(/\[BR\]/gi,"</br>");return r}function wre(t){var e=$.useRef([]),n=$.useRef(""),r=$.useCallback(function(l){e.current.push(l)},[]),c=$.useCallback(function(l){var d=e.current.reduce(function(f,m){return m(f)},l);return d=fMe(d,t),n.current=d,d},[]);return{addSanitizeFn:r,sanitize:c,sanitizedTextRef:n}}function fMe(t,e){var n=document.createElement("div");n.innerHTML=t;var r;return e?r=hMe(n):r=n.innerText||"",r=r.replace(/\n/gi,""),r}function pMe(t){var e=t.ref,n=t.textInputRef,r=t.setValue,c=t.emitChange,l=wre(!1),d=l.sanitize,f=l.sanitizedTextRef;$.useImperativeHandle(e,function(){return{get value(){return f.current},set value(m){r(m)},focus:function(){n.current!==null&&n.current.focus()},blur:function(){n.current!==null&&d(n.current.html),c()}}})}function mMe(t,e,n){var r=$.useRef(null),c=$.useRef(n),l=$.useCallback(function(){if(t.current!==null){var f=r.current,m=t.current.size;(!f||f.width!==m.width||f.height!==m.height)&&typeof e=="function"&&e(m),r.current=m}},[e,t]),d=$.useCallback(function(f){typeof c.current=="function"&&c.current(f),typeof e=="function"&&l()},[l,e]);return $.useEffect(function(){t.current&&l()},[l,t]),d}var gMe=["placeholder","style","tabIndex","className","onChange"],_Me=function(e,n){var r=e.placeholder,c=e.style,l=e.tabIndex,d=e.className,f=e.onChange,m=JLe(e,gMe);$.useImperativeHandle(n,function(){return{appendContent:function(M){y.current&&y.current.focus(),lMe(M),y.current&&y.current.focus(),y.current&&E.current&&KO(y.current.innerHTML)===""?E.current.style.visibility="visible":E.current&&(E.current.style.visibility="hidden"),y.current&&typeof f=="function"&&f(y.current.innerHTML)},set html(k){if(y.current&&(y.current.innerHTML=k),E.current){var M=KO(k);M===""?E.current.style.visibility="visible":E.current.style.visibility="hidden"}typeof f=="function"&&y.current&&f(y.current.innerHTML)},get html(){return y.current?y.current.innerHTML:""},get text(){return y.current?y.current.innerText:""},get size(){return y.current?{width:y.current.offsetWidth,height:y.current.offsetHeight}:{width:0,height:0}},focus:function(){y.current&&y.current.focus()}}});var E=$.useRef(null),y=$.useRef(null);function w(k){if(k.key==="Enter"&&(k.shiftKey===!0||k.ctrlKey===!0)&&m.shouldReturn&&(k.preventDefault(),y.current)){y.current.innerHTML="".concat(y.current.innerHTML,"</br></br>"),dMe(y);return}k.key==="Enter"?m.onEnter(k):k.key==="ArrowUp"?m.onArrowUp(k):k.key==="ArrowDown"?m.onArrowDown(k):k.key.length===1&&E.current&&(E.current.style.visibility="hidden"),m.onKeyDown(k)}function I(){m.onFocus()}function P(k){m.onKeyUp(k);var M=y.current;if(E.current&&M){var K=KO(M.innerHTML);K===""?E.current.style.visibility="visible":E.current.style.visibility="hidden"}typeof f=="function"&&y.current&&f(y.current.innerHTML)}return At.createElement("div",{className:"react-input-emoji--container",style:c},At.createElement("div",{className:"react-input-emoji--wrapper",onClick:I},At.createElement("div",{ref:E,className:"react-input-emoji--placeholder"},r),At.createElement("div",{ref:y,onKeyDown:w,onKeyUp:P,tabIndex:l,contentEditable:!0,className:"react-input-emoji--input".concat(d?" ".concat(d):""),onBlur:m.onBlur,onCopy:m.onCopy,onPaste:m.onPaste,"data-testid":"react-input-emoji--input"})))},EMe=$.forwardRef(_Me);function Gq(t){var e=t.showPicker,n=t.toggleShowPicker,r=t.buttonElement,c=t.buttonRef,l=$.useRef(null),d=$.useState(!1),f=Md(d,2),m=f[0],E=f[1];return $.useEffect(function(){var y,w,I,P;((y=c==null||(w=c.current)===null||w===void 0||(w=w.childNodes)===null||w===void 0?void 0:w.length)!==null&&y!==void 0?y:0)>2?(l.current.appendChild(c.current.childNodes[0]),E(!0)):((I=r==null||(P=r.childNodes)===null||P===void 0?void 0:P.length)!==null&&I!==void 0?I:0)>2&&(l.current.appendChild(r==null?void 0:r.childNodes[0]),E(!0))},[r==null?void 0:r.childNodes]),At.createElement("button",{ref:l,type:"button",className:"react-input-emoji--button".concat(e?" react-input-emoji--button__show":""),onClick:n},!m&&At.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",className:"react-input-emoji--button--icon"},At.createElement("path",{d:"M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0m0 22C6.486 22 2 17.514 2 12S6.486 2 12 2s10 4.486 10 10-4.486 10-10 10"}),At.createElement("path",{d:"M8 7a2 2 0 1 0-.001 3.999A2 2 0 0 0 8 7M16 7a2 2 0 1 0-.001 3.999A2 2 0 0 0 16 7M15.232 15c-.693 1.195-1.87 2-3.349 2-1.477 0-2.655-.805-3.347-2H15m3-2H6a6 6 0 1 0 12 0"})))}function Cre(t){return t&&t.__esModule?t.default:t}function dl(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var VP,Kt,Rre,CT,Ire,Kq,X1={},Are=[],vMe=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function Tf(t,e){for(var n in e)t[n]=e[n];return t}function Ore(t){var e=t.parentNode;e&&e.removeChild(t)}function jV(t,e,n){var r,c,l,d={};for(l in e)l=="key"?r=e[l]:l=="ref"?c=e[l]:d[l]=e[l];if(arguments.length>2&&(d.children=arguments.length>3?VP.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(l in t.defaultProps)d[l]===void 0&&(d[l]=t.defaultProps[l]);return qO(t,d,r,c,null)}function qO(t,e,n,r,c){var l={type:t,props:e,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:c??++Rre};return c==null&&Kt.vnode!=null&&Kt.vnode(l),l}function Ed(){return{current:null}}function Cv(t){return t.children}function wu(t,e){this.props=t,this.context=e}function Rv(t,e){if(e==null)return t.__?Rv(t.__,t.__.__k.indexOf(t)+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?Rv(t):null}function Nre(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return Nre(t)}}function qq(t){(!t.__d&&(t.__d=!0)&&CT.push(t)&&!J1.__r++||Kq!==Kt.debounceRendering)&&((Kq=Kt.debounceRendering)||Ire)(J1)}function J1(){for(var t;J1.__r=CT.length;)t=CT.sort(function(e,n){return e.__v.__b-n.__v.__b}),CT=[],t.some(function(e){var n,r,c,l,d,f;e.__d&&(d=(l=(n=e).__v).__e,(f=n.__P)&&(r=[],(c=Tf({},l)).__v=l.__v+1,z5(f,l,c,n.__n,f.ownerSVGElement!==void 0,l.__h!=null?[d]:null,r,d??Rv(l),l.__h),kre(r,l),l.__e!=d&&Nre(l)))})}function Pre(t,e,n,r,c,l,d,f,m,E){var y,w,I,P,k,M,K,W=r&&r.__k||Are,V=W.length;for(n.__k=[],y=0;y<e.length;y++)if((P=n.__k[y]=(P=e[y])==null||typeof P=="boolean"?null:typeof P=="string"||typeof P=="number"||typeof P=="bigint"?qO(null,P,null,null,P):Array.isArray(P)?qO(Cv,{children:P},null,null,null):P.__b>0?qO(P.type,P.props,P.key,null,P.__v):P)!=null){if(P.__=n,P.__b=n.__b+1,(I=W[y])===null||I&&P.key==I.key&&P.type===I.type)W[y]=void 0;else for(w=0;w<V;w++){if((I=W[w])&&P.key==I.key&&P.type===I.type){W[w]=void 0;break}I=null}z5(t,P,I=I||X1,c,l,d,f,m,E),k=P.__e,(w=P.ref)&&I.ref!=w&&(K||(K=[]),I.ref&&K.push(I.ref,null,P),K.push(w,P.__c||k,P)),k!=null?(M==null&&(M=k),typeof P.type=="function"&&P.__k===I.__k?P.__d=m=xre(P,m,t):m=Dre(t,P,I,W,k,m),typeof n.type=="function"&&(n.__d=m)):m&&I.__e==m&&m.parentNode!=t&&(m=Rv(I))}for(n.__e=M,y=V;y--;)W[y]!=null&&(typeof n.type=="function"&&W[y].__e!=null&&W[y].__e==n.__d&&(n.__d=Rv(r,y+1)),Mre(W[y],W[y]));if(K)for(y=0;y<K.length;y++)Lre(K[y],K[++y],K[++y])}function xre(t,e,n){for(var r,c=t.__k,l=0;c&&l<c.length;l++)(r=c[l])&&(r.__=t,e=typeof r.type=="function"?xre(r,e,n):Dre(n,r,r,c,r.__e,e));return e}function Q1(t,e){return e=e||[],t==null||typeof t=="boolean"||(Array.isArray(t)?t.some(function(n){Q1(n,e)}):e.push(t)),e}function Dre(t,e,n,r,c,l){var d,f,m;if(e.__d!==void 0)d=e.__d,e.__d=void 0;else if(n==null||c!=l||c.parentNode==null)e:if(l==null||l.parentNode!==t)t.appendChild(c),d=null;else{for(f=l,m=0;(f=f.nextSibling)&&m<r.length;m+=2)if(f==c)break e;t.insertBefore(c,l),d=l}return d!==void 0?d:c.nextSibling}function yMe(t,e,n,r,c){var l;for(l in n)l==="children"||l==="key"||l in e||Z1(t,l,null,n[l],r);for(l in e)c&&typeof e[l]!="function"||l==="children"||l==="key"||l==="value"||l==="checked"||n[l]===e[l]||Z1(t,l,e[l],n[l],r)}function Yq(t,e,n){e[0]==="-"?t.setProperty(e,n):t[e]=n==null?"":typeof n!="number"||vMe.test(e)?n:n+"px"}function Z1(t,e,n,r,c){var l;e:if(e==="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof r=="string"&&(t.style.cssText=r=""),r)for(e in r)n&&e in n||Yq(t.style,e,"");if(n)for(e in n)r&&n[e]===r[e]||Yq(t.style,e,n[e])}else if(e[0]==="o"&&e[1]==="n")l=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in t?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+l]=n,n?r||t.addEventListener(e,l?Jq:Xq,l):t.removeEventListener(e,l?Jq:Xq,l);else if(e!=="dangerouslySetInnerHTML"){if(c)e=e.replace(/xlink[H:h]/,"h").replace(/sName$/,"s");else if(e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n!=null&&(n!==!1||e[0]==="a"&&e[1]==="r")?t.setAttribute(e,n):t.removeAttribute(e))}}function Xq(t){this.l[t.type+!1](Kt.event?Kt.event(t):t)}function Jq(t){this.l[t.type+!0](Kt.event?Kt.event(t):t)}function z5(t,e,n,r,c,l,d,f,m){var E,y,w,I,P,k,M,K,W,V,G,Q=e.type;if(e.constructor!==void 0)return null;n.__h!=null&&(m=n.__h,f=e.__e=n.__e,e.__h=null,l=[f]),(E=Kt.__b)&&E(e);try{e:if(typeof Q=="function"){if(K=e.props,W=(E=Q.contextType)&&r[E.__c],V=E?W?W.props.value:E.__:r,n.__c?M=(y=e.__c=n.__c).__=y.__E:("prototype"in Q&&Q.prototype.render?e.__c=y=new Q(K,V):(e.__c=y=new wu(K,V),y.constructor=Q,y.render=TMe),W&&W.sub(y),y.props=K,y.state||(y.state={}),y.context=V,y.__n=r,w=y.__d=!0,y.__h=[]),y.__s==null&&(y.__s=y.state),Q.getDerivedStateFromProps!=null&&(y.__s==y.state&&(y.__s=Tf({},y.__s)),Tf(y.__s,Q.getDerivedStateFromProps(K,y.__s))),I=y.props,P=y.state,w)Q.getDerivedStateFromProps==null&&y.componentWillMount!=null&&y.componentWillMount(),y.componentDidMount!=null&&y.__h.push(y.componentDidMount);else{if(Q.getDerivedStateFromProps==null&&K!==I&&y.componentWillReceiveProps!=null&&y.componentWillReceiveProps(K,V),!y.__e&&y.shouldComponentUpdate!=null&&y.shouldComponentUpdate(K,y.__s,V)===!1||e.__v===n.__v){y.props=K,y.state=y.__s,e.__v!==n.__v&&(y.__d=!1),y.__v=e,e.__e=n.__e,e.__k=n.__k,e.__k.forEach(function(Z){Z&&(Z.__=e)}),y.__h.length&&d.push(y);break e}y.componentWillUpdate!=null&&y.componentWillUpdate(K,y.__s,V),y.componentDidUpdate!=null&&y.__h.push(function(){y.componentDidUpdate(I,P,k)})}y.context=V,y.props=K,y.state=y.__s,(E=Kt.__r)&&E(e),y.__d=!1,y.__v=e,y.__P=t,E=y.render(y.props,y.state,y.context),y.state=y.__s,y.getChildContext!=null&&(r=Tf(Tf({},r),y.getChildContext())),w||y.getSnapshotBeforeUpdate==null||(k=y.getSnapshotBeforeUpdate(I,P)),G=E!=null&&E.type===Cv&&E.key==null?E.props.children:E,Pre(t,Array.isArray(G)?G:[G],e,n,r,c,l,d,f,m),y.base=e.__e,e.__h=null,y.__h.length&&d.push(y),M&&(y.__E=y.__=null),y.__e=!1}else l==null&&e.__v===n.__v?(e.__k=n.__k,e.__e=n.__e):e.__e=SMe(n.__e,e,n,r,c,l,d,m);(E=Kt.diffed)&&E(e)}catch(Z){e.__v=null,(m||l!=null)&&(e.__e=f,e.__h=!!m,l[l.indexOf(f)]=null),Kt.__e(Z,e,n)}}function kre(t,e){Kt.__c&&Kt.__c(e,t),t.some(function(n){try{t=n.__h,n.__h=[],t.some(function(r){r.call(n)})}catch(r){Kt.__e(r,n.__v)}})}function SMe(t,e,n,r,c,l,d,f){var m,E,y,w=n.props,I=e.props,P=e.type,k=0;if(P==="svg"&&(c=!0),l!=null){for(;k<l.length;k++)if((m=l[k])&&"setAttribute"in m==!!P&&(P?m.localName===P:m.nodeType===3)){t=m,l[k]=null;break}}if(t==null){if(P===null)return document.createTextNode(I);t=c?document.createElementNS("http://www.w3.org/2000/svg",P):document.createElement(P,I.is&&I),l=null,f=!1}if(P===null)w===I||f&&t.data===I||(t.data=I);else{if(l=l&&VP.call(t.childNodes),E=(w=n.props||X1).dangerouslySetInnerHTML,y=I.dangerouslySetInnerHTML,!f){if(l!=null)for(w={},k=0;k<t.attributes.length;k++)w[t.attributes[k].name]=t.attributes[k].value;(y||E)&&(y&&(E&&y.__html==E.__html||y.__html===t.innerHTML)||(t.innerHTML=y&&y.__html||""))}if(yMe(t,I,w,c,f),y)e.__k=[];else if(k=e.props.children,Pre(t,Array.isArray(k)?k:[k],e,n,r,c&&P!=="foreignObject",l,d,l?l[0]:n.__k&&Rv(n,0),f),l!=null)for(k=l.length;k--;)l[k]!=null&&Ore(l[k]);f||("value"in I&&(k=I.value)!==void 0&&(k!==w.value||k!==t.value||P==="progress"&&!k)&&Z1(t,"value",k,w.value,!1),"checked"in I&&(k=I.checked)!==void 0&&k!==t.checked&&Z1(t,"checked",k,w.checked,!1))}return t}function Lre(t,e,n){try{typeof t=="function"?t(e):t.current=e}catch(r){Kt.__e(r,n)}}function Mre(t,e,n){var r,c;if(Kt.unmount&&Kt.unmount(t),(r=t.ref)&&(r.current&&r.current!==t.__e||Lre(r,null,e)),(r=t.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(l){Kt.__e(l,e)}r.base=r.__P=null}if(r=t.__k)for(c=0;c<r.length;c++)r[c]&&Mre(r[c],e,typeof t.type!="function");n||t.__e==null||Ore(t.__e),t.__e=t.__d=void 0}function TMe(t,e,n){return this.constructor(t,n)}function Ure(t,e,n){var r,c,l;Kt.__&&Kt.__(t,e),c=(r=typeof n=="function")?null:n&&n.__k||e.__k,l=[],z5(e,t=(!r&&n||e).__k=jV(Cv,null,[t]),c||X1,X1,e.ownerSVGElement!==void 0,!r&&n?[n]:c?null:e.firstChild?VP.call(e.childNodes):null,l,!r&&n?n:c?c.__e:e.firstChild,r),kre(l,t)}VP=Are.slice,Kt={__e:function(t,e){for(var n,r,c;e=e.__;)if((n=e.__c)&&!n.__)try{if((r=n.constructor)&&r.getDerivedStateFromError!=null&&(n.setState(r.getDerivedStateFromError(t)),c=n.__d),n.componentDidCatch!=null&&(n.componentDidCatch(t),c=n.__d),c)return n.__E=n}catch(l){t=l}throw t}},Rre=0,wu.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Tf({},this.state),typeof t=="function"&&(t=t(Tf({},n),this.props)),t&&Tf(n,t),t!=null&&this.__v&&(e&&this.__h.push(e),qq(this))},wu.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),qq(this))},wu.prototype.render=Cv,CT=[],Ire=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,J1.__r=0;var bMe=0;function et(t,e,n,r,c){var l,d,f={};for(d in e)d=="ref"?l=e[d]:f[d]=e[d];var m={type:t,props:f,key:n,ref:l,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--bMe,__source:r,__self:c};if(typeof t=="function"&&(l=t.defaultProps))for(d in l)f[d]===void 0&&(f[d]=l[d]);return Kt.vnode&&Kt.vnode(m),m}function wMe(t,e){try{window.localStorage[`emoji-mart.${t}`]=JSON.stringify(e)}catch{}}function CMe(t){try{const e=window.localStorage[`emoji-mart.${t}`];if(e)return JSON.parse(e)}catch{}}var Ff={set:wMe,get:CMe};const cF=new Map,RMe=[{v:14,emoji:"🫠"},{v:13.1,emoji:"😶‍🌫️"},{v:13,emoji:"🥸"},{v:12.1,emoji:"🧑‍🦰"},{v:12,emoji:"🥱"},{v:11,emoji:"🥰"},{v:5,emoji:"🤩"},{v:4,emoji:"👱‍♀️"},{v:3,emoji:"🤣"},{v:2,emoji:"👋🏻"},{v:1,emoji:"🙃"}];function IMe(){for(const{v:t,emoji:e}of RMe)if(jre(e))return t}function AMe(){return!jre("🇨🇦")}function jre(t){if(cF.has(t))return cF.get(t);const e=OMe(t);return cF.set(t,e),e}const OMe=(()=>{let t=null;try{navigator.userAgent.includes("jsdom")||(t=document.createElement("canvas").getContext("2d",{willReadFrequently:!0}))}catch{}if(!t)return()=>!1;const e=25,n=20,r=Math.floor(e/2);return t.font=r+"px Arial, Sans-Serif",t.textBaseline="top",t.canvas.width=n*2,t.canvas.height=e,c=>{t.clearRect(0,0,n*2,e),t.fillStyle="#FF0000",t.fillText(c,0,22),t.fillStyle="#0000FF",t.fillText(c,n,22);const l=t.getImageData(0,0,n,e).data,d=l.length;let f=0;for(;f<d&&!l[f+3];f+=4);if(f>=d)return!1;const m=n+f/4%n,E=Math.floor(f/4/n),y=t.getImageData(m,E,1,1).data;return!(l[f]!==y[0]||l[f+2]!==y[2]||t.measureText(c).width>=n)}})();var Qq={latestVersion:IMe,noCountryFlags:AMe};const FV=["+1","grinning","kissing_heart","heart_eyes","laughing","stuck_out_tongue_winking_eye","sweat_smile","joy","scream","disappointed","unamused","weary","sob","sunglasses","heart"];let Gs=null;function NMe(t){Gs||(Gs=Ff.get("frequently")||{});const e=t.id||t;e&&(Gs[e]||(Gs[e]=0),Gs[e]+=1,Ff.set("last",e),Ff.set("frequently",Gs))}function PMe({maxFrequentRows:t,perLine:e}){if(!t)return[];Gs||(Gs=Ff.get("frequently"));let n=[];if(!Gs){Gs={};for(let l in FV.slice(0,e)){const d=FV[l];Gs[d]=e-l,n.push(d)}return n}const r=t*e,c=Ff.get("last");for(let l in Gs)n.push(l);if(n.sort((l,d)=>{const f=Gs[d],m=Gs[l];return f==m?l.localeCompare(d):f-m}),n.length>r){const l=n.slice(r);n=n.slice(0,r);for(let d of l)d!=c&&delete Gs[d];c&&n.indexOf(c)==-1&&(delete Gs[n[n.length-1]],n.splice(-1,1,c)),Ff.set("frequently",Gs)}return n}var Fre={add:NMe,get:PMe,DEFAULTS:FV},Vre={};Vre=JSON.parse('{"search":"Search","search_no_results_1":"Oh no!","search_no_results_2":"That emoji couldn’t be found","pick":"Pick an emoji…","add_custom":"Add custom emoji","categories":{"activity":"Activity","custom":"Custom","flags":"Flags","foods":"Food & Drink","frequent":"Frequently used","nature":"Animals & Nature","objects":"Objects","people":"Smileys & People","places":"Travel & Places","search":"Search Results","symbols":"Symbols"},"skins":{"1":"Default","2":"Light","3":"Medium-Light","4":"Medium","5":"Medium-Dark","6":"Dark","choose":"Choose default skin tone"}}');var Cd={autoFocus:{value:!1},dynamicWidth:{value:!1},emojiButtonColors:{value:null},emojiButtonRadius:{value:"100%"},emojiButtonSize:{value:36},emojiSize:{value:24},emojiVersion:{value:14,choices:[1,2,3,4,5,11,12,12.1,13,13.1,14]},exceptEmojis:{value:[]},icons:{value:"auto",choices:["auto","outline","solid"]},locale:{value:"en",choices:["en","ar","be","cs","de","es","fa","fi","fr","hi","it","ja","kr","nl","pl","pt","ru","sa","tr","uk","vi","zh"]},maxFrequentRows:{value:4},navPosition:{value:"top",choices:["top","bottom","none"]},noCountryFlags:{value:!1},noResultsEmoji:{value:null},perLine:{value:9},previewEmoji:{value:null},previewPosition:{value:"bottom",choices:["top","bottom","none"]},searchPosition:{value:"sticky",choices:["sticky","static","none"]},set:{value:"native",choices:["native","apple","facebook","google","twitter"]},skin:{value:1,choices:[1,2,3,4,5,6]},skinTonePosition:{value:"preview",choices:["preview","search","none"]},theme:{value:"auto",choices:["auto","light","dark"]},categories:null,categoryIcons:null,custom:null,data:null,i18n:null,getImageURL:null,getSpritesheetURL:null,onAddCustomEmoji:null,onClickOutside:null,onEmojiSelect:null,stickySearch:{deprecated:!0,value:!0}};let vo=null,Un=null;const lF={};async function Zq(t){if(lF[t])return lF[t];const n=await(await fetch(t)).json();return lF[t]=n,n}let uF=null,Bre=null,Wre=!1;function BP(t,{caller:e}={}){return uF||(uF=new Promise(n=>{Bre=n})),t?xMe(t):e&&!Wre&&console.warn(`\`${e}\` requires data to be initialized first. Promise will be pending until \`init\` is called.`),uF}async function xMe(t){Wre=!0;let{emojiVersion:e,set:n,locale:r}=t;if(e||(e=Cd.emojiVersion.value),n||(n=Cd.set.value),r||(r=Cd.locale.value),Un)Un.categories=Un.categories.filter(m=>!m.name);else{Un=(typeof t.data=="function"?await t.data():t.data)||await Zq(`https://cdn.jsdelivr.net/npm/@emoji-mart/data@latest/sets/${e}/${n}.json`),Un.emoticons={},Un.natives={},Un.categories.unshift({id:"frequent",emojis:[]});for(const m in Un.aliases){const E=Un.aliases[m],y=Un.emojis[E];y&&(y.aliases||(y.aliases=[]),y.aliases.push(m))}Un.originalCategories=Un.categories}if(vo=(typeof t.i18n=="function"?await t.i18n():t.i18n)||(r=="en"?Cre(Vre):await Zq(`https://cdn.jsdelivr.net/npm/@emoji-mart/data@latest/i18n/${r}.json`)),t.custom)for(let m in t.custom){m=parseInt(m);const E=t.custom[m],y=t.custom[m-1];if(!(!E.emojis||!E.emojis.length)){E.id||(E.id=`custom_${m+1}`),E.name||(E.name=vo.categories.custom),y&&!E.icon&&(E.target=y.target||y),Un.categories.push(E);for(const w of E.emojis)Un.emojis[w.id]=w}}t.categories&&(Un.categories=Un.originalCategories.filter(m=>t.categories.indexOf(m.id)!=-1).sort((m,E)=>{const y=t.categories.indexOf(m.id),w=t.categories.indexOf(E.id);return y-w}));let c=null,l=null;n=="native"&&(c=Qq.latestVersion(),l=t.noCountryFlags||Qq.noCountryFlags());let d=Un.categories.length,f=!1;for(;d--;){const m=Un.categories[d];if(m.id=="frequent"){let{maxFrequentRows:w,perLine:I}=t;w=w>=0?w:Cd.maxFrequentRows.value,I||(I=Cd.perLine.value),m.emojis=Fre.get({maxFrequentRows:w,perLine:I})}if(!m.emojis||!m.emojis.length){Un.categories.splice(d,1);continue}const{categoryIcons:E}=t;if(E){const w=E[m.id];w&&!m.icon&&(m.icon=w)}let y=m.emojis.length;for(;y--;){const w=m.emojis[y],I=w.id?w:Un.emojis[w],P=()=>{m.emojis.splice(y,1)};if(!I||t.exceptEmojis&&t.exceptEmojis.includes(I.id)){P();continue}if(c&&I.version>c){P();continue}if(l&&m.id=="flags"&&!UMe.includes(I.id)){P();continue}if(!I.search){if(f=!0,I.search=","+[[I.id,!1],[I.name,!0],[I.keywords,!1],[I.emoticons,!1]].map(([M,K])=>{if(M)return(Array.isArray(M)?M:[M]).map(W=>(K?W.split(/[-|_|\s]+/):[W]).map(V=>V.toLowerCase())).flat()}).flat().filter(M=>M&&M.trim()).join(","),I.emoticons)for(const M of I.emoticons)Un.emoticons[M]||(Un.emoticons[M]=I.id);let k=0;for(const M of I.skins){if(!M)continue;k++;const{native:K}=M;K&&(Un.natives[K]=I.id,I.search+=`,${K}`);const W=k==1?"":`:skin-tone-${k}:`;M.shortcodes=`:${I.id}:${W}`}}}}f&&rv.reset(),Bre()}function Hre(t,e,n){t||(t={});const r={};for(let c in e)r[c]=$re(c,t,e,n);return r}function $re(t,e,n,r){const c=n[t];let l=r&&r.getAttribute(t)||(e[t]!=null&&e[t]!=null?e[t]:null);return c&&(l!=null&&c.value&&typeof c.value!=typeof l&&(typeof c.value=="boolean"?l=l!="false":l=c.value.constructor(l)),c.transform&&l&&(l=c.transform(l)),(l==null||c.choices&&c.choices.indexOf(l)==-1)&&(l=c.value)),l}const DMe=/^(?:\:([^\:]+)\:)(?:\:skin-tone-(\d)\:)?$/;let VV=null;function kMe(t){return t.id?t:Un.emojis[t]||Un.emojis[Un.aliases[t]]||Un.emojis[Un.natives[t]]}function LMe(){VV=null}async function MMe(t,{maxResults:e,caller:n}={}){if(!t||!t.trim().length)return null;e||(e=90),await BP(null,{caller:n||"SearchIndex.search"});const r=t.toLowerCase().replace(/(\w)-/,"$1 ").split(/[\s|,]+/).filter((f,m,E)=>f.trim()&&E.indexOf(f)==m);if(!r.length)return;let c=VV||(VV=Object.values(Un.emojis)),l,d;for(const f of r){if(!c.length)break;l=[],d={};for(const m of c){if(!m.search)continue;const E=m.search.indexOf(`,${f}`);E!=-1&&(l.push(m),d[m.id]||(d[m.id]=0),d[m.id]+=m.id==f?0:E+1)}c=l}return l.length<2||(l.sort((f,m)=>{const E=d[f.id],y=d[m.id];return E==y?f.id.localeCompare(m.id):E-y}),l.length>e&&(l=l.slice(0,e))),l}var rv={search:MMe,get:kMe,reset:LMe,SHORTCODES_REGEX:DMe};const UMe=["checkered_flag","crossed_flags","pirate_flag","rainbow-flag","transgender_flag","triangular_flag_on_post","waving_black_flag","waving_white_flag"];function jMe(t,e){return Array.isArray(t)&&Array.isArray(e)&&t.length===e.length&&t.every((n,r)=>n==e[r])}async function FMe(t=1){for(let e in[...Array(t).keys()])await new Promise(requestAnimationFrame)}function VMe(t,{skinIndex:e=0}={}){const n=t.skins[e]||(()=>(e=0,t.skins[e]))(),r={id:t.id,name:t.name,native:n.native,unified:n.unified,keywords:t.keywords,shortcodes:n.shortcodes||t.shortcodes};return t.skins.length>1&&(r.skin=e+1),n.src&&(r.src=n.src),t.aliases&&t.aliases.length&&(r.aliases=t.aliases),t.emoticons&&t.emoticons.length&&(r.emoticons=t.emoticons),r}const BMe={activity:{outline:et("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:et("path",{d:"M12 0C5.373 0 0 5.372 0 12c0 6.627 5.373 12 12 12 6.628 0 12-5.373 12-12 0-6.628-5.372-12-12-12m9.949 11H17.05c.224-2.527 1.232-4.773 1.968-6.113A9.966 9.966 0 0 1 21.949 11M13 11V2.051a9.945 9.945 0 0 1 4.432 1.564c-.858 1.491-2.156 4.22-2.392 7.385H13zm-2 0H8.961c-.238-3.165-1.536-5.894-2.393-7.385A9.95 9.95 0 0 1 11 2.051V11zm0 2v8.949a9.937 9.937 0 0 1-4.432-1.564c.857-1.492 2.155-4.221 2.393-7.385H11zm4.04 0c.236 3.164 1.534 5.893 2.392 7.385A9.92 9.92 0 0 1 13 21.949V13h2.04zM4.982 4.887C5.718 6.227 6.726 8.473 6.951 11h-4.9a9.977 9.977 0 0 1 2.931-6.113M2.051 13h4.9c-.226 2.527-1.233 4.771-1.969 6.113A9.972 9.972 0 0 1 2.051 13m16.967 6.113c-.735-1.342-1.744-3.586-1.968-6.113h4.899a9.961 9.961 0 0 1-2.931 6.113"})}),solid:et("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:et("path",{d:"M16.17 337.5c0 44.98 7.565 83.54 13.98 107.9C35.22 464.3 50.46 496 174.9 496c9.566 0 19.59-.4707 29.84-1.271L17.33 307.3C16.53 317.6 16.17 327.7 16.17 337.5zM495.8 174.5c0-44.98-7.565-83.53-13.98-107.9c-4.688-17.54-18.34-31.23-36.04-35.95C435.5 27.91 392.9 16 337 16c-9.564 0-19.59 .4707-29.84 1.271l187.5 187.5C495.5 194.4 495.8 184.3 495.8 174.5zM26.77 248.8l236.3 236.3c142-36.1 203.9-150.4 222.2-221.1L248.9 26.87C106.9 62.96 45.07 177.2 26.77 248.8zM256 335.1c0 9.141-7.474 16-16 16c-4.094 0-8.188-1.564-11.31-4.689L164.7 283.3C161.6 280.2 160 276.1 160 271.1c0-8.529 6.865-16 16-16c4.095 0 8.189 1.562 11.31 4.688l64.01 64C254.4 327.8 256 331.9 256 335.1zM304 287.1c0 9.141-7.474 16-16 16c-4.094 0-8.188-1.564-11.31-4.689L212.7 235.3C209.6 232.2 208 228.1 208 223.1c0-9.141 7.473-16 16-16c4.094 0 8.188 1.562 11.31 4.688l64.01 64.01C302.5 279.8 304 283.9 304 287.1zM256 175.1c0-9.141 7.473-16 16-16c4.094 0 8.188 1.562 11.31 4.688l64.01 64.01c3.125 3.125 4.688 7.219 4.688 11.31c0 9.133-7.468 16-16 16c-4.094 0-8.189-1.562-11.31-4.688l-64.01-64.01C257.6 184.2 256 180.1 256 175.1z"})})},custom:et("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",children:et("path",{d:"M417.1 368c-5.937 10.27-16.69 16-27.75 16c-5.422 0-10.92-1.375-15.97-4.281L256 311.4V448c0 17.67-14.33 32-31.1 32S192 465.7 192 448V311.4l-118.3 68.29C68.67 382.6 63.17 384 57.75 384c-11.06 0-21.81-5.734-27.75-16c-8.828-15.31-3.594-34.88 11.72-43.72L159.1 256L41.72 187.7C26.41 178.9 21.17 159.3 29.1 144C36.63 132.5 49.26 126.7 61.65 128.2C65.78 128.7 69.88 130.1 73.72 132.3L192 200.6V64c0-17.67 14.33-32 32-32S256 46.33 256 64v136.6l118.3-68.29c3.838-2.213 7.939-3.539 12.07-4.051C398.7 126.7 411.4 132.5 417.1 144c8.828 15.31 3.594 34.88-11.72 43.72L288 256l118.3 68.28C421.6 333.1 426.8 352.7 417.1 368z"})}),flags:{outline:et("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:et("path",{d:"M0 0l6.084 24H8L1.916 0zM21 5h-4l-1-4H4l3 12h3l1 4h13L21 5zM6.563 3h7.875l2 8H8.563l-2-8zm8.832 10l-2.856 1.904L12.063 13h3.332zM19 13l-1.5-6h1.938l2 8H16l3-2z"})}),solid:et("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:et("path",{d:"M64 496C64 504.8 56.75 512 48 512h-32C7.25 512 0 504.8 0 496V32c0-17.75 14.25-32 32-32s32 14.25 32 32V496zM476.3 0c-6.365 0-13.01 1.35-19.34 4.233c-45.69 20.86-79.56 27.94-107.8 27.94c-59.96 0-94.81-31.86-163.9-31.87C160.9 .3055 131.6 4.867 96 15.75v350.5c32-9.984 59.87-14.1 84.85-14.1c73.63 0 124.9 31.78 198.6 31.78c31.91 0 68.02-5.971 111.1-23.09C504.1 355.9 512 344.4 512 332.1V30.73C512 11.1 495.3 0 476.3 0z"})})},foods:{outline:et("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:et("path",{d:"M17 4.978c-1.838 0-2.876.396-3.68.934.513-1.172 1.768-2.934 4.68-2.934a1 1 0 0 0 0-2c-2.921 0-4.629 1.365-5.547 2.512-.064.078-.119.162-.18.244C11.73 1.838 10.798.023 9.207.023 8.579.022 7.85.306 7 .978 5.027 2.54 5.329 3.902 6.492 4.999 3.609 5.222 0 7.352 0 12.969c0 4.582 4.961 11.009 9 11.009 1.975 0 2.371-.486 3-1 .629.514 1.025 1 3 1 4.039 0 9-6.418 9-11 0-5.953-4.055-8-7-8M8.242 2.546c.641-.508.943-.523.965-.523.426.169.975 1.405 1.357 3.055-1.527-.629-2.741-1.352-2.98-1.846.059-.112.241-.356.658-.686M15 21.978c-1.08 0-1.21-.109-1.559-.402l-.176-.146c-.367-.302-.816-.452-1.266-.452s-.898.15-1.266.452l-.176.146c-.347.292-.477.402-1.557.402-2.813 0-7-5.389-7-9.009 0-5.823 4.488-5.991 5-5.991 1.939 0 2.484.471 3.387 1.251l.323.276a1.995 1.995 0 0 0 2.58 0l.323-.276c.902-.78 1.447-1.251 3.387-1.251.512 0 5 .168 5 6 0 3.617-4.187 9-7 9"})}),solid:et("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:et("path",{d:"M481.9 270.1C490.9 279.1 496 291.3 496 304C496 316.7 490.9 328.9 481.9 337.9C472.9 346.9 460.7 352 448 352H64C51.27 352 39.06 346.9 30.06 337.9C21.06 328.9 16 316.7 16 304C16 291.3 21.06 279.1 30.06 270.1C39.06 261.1 51.27 256 64 256H448C460.7 256 472.9 261.1 481.9 270.1zM475.3 388.7C478.3 391.7 480 395.8 480 400V416C480 432.1 473.3 449.3 461.3 461.3C449.3 473.3 432.1 480 416 480H96C79.03 480 62.75 473.3 50.75 461.3C38.74 449.3 32 432.1 32 416V400C32 395.8 33.69 391.7 36.69 388.7C39.69 385.7 43.76 384 48 384H464C468.2 384 472.3 385.7 475.3 388.7zM50.39 220.8C45.93 218.6 42.03 215.5 38.97 211.6C35.91 207.7 33.79 203.2 32.75 198.4C31.71 193.5 31.8 188.5 32.99 183.7C54.98 97.02 146.5 32 256 32C365.5 32 457 97.02 479 183.7C480.2 188.5 480.3 193.5 479.2 198.4C478.2 203.2 476.1 207.7 473 211.6C469.1 215.5 466.1 218.6 461.6 220.8C457.2 222.9 452.3 224 447.3 224H64.67C59.73 224 54.84 222.9 50.39 220.8zM372.7 116.7C369.7 119.7 368 123.8 368 128C368 131.2 368.9 134.3 370.7 136.9C372.5 139.5 374.1 141.6 377.9 142.8C380.8 143.1 384 144.3 387.1 143.7C390.2 143.1 393.1 141.6 395.3 139.3C397.6 137.1 399.1 134.2 399.7 131.1C400.3 128 399.1 124.8 398.8 121.9C397.6 118.1 395.5 116.5 392.9 114.7C390.3 112.9 387.2 111.1 384 111.1C379.8 111.1 375.7 113.7 372.7 116.7V116.7zM244.7 84.69C241.7 87.69 240 91.76 240 96C240 99.16 240.9 102.3 242.7 104.9C244.5 107.5 246.1 109.6 249.9 110.8C252.8 111.1 256 112.3 259.1 111.7C262.2 111.1 265.1 109.6 267.3 107.3C269.6 105.1 271.1 102.2 271.7 99.12C272.3 96.02 271.1 92.8 270.8 89.88C269.6 86.95 267.5 84.45 264.9 82.7C262.3 80.94 259.2 79.1 256 79.1C251.8 79.1 247.7 81.69 244.7 84.69V84.69zM116.7 116.7C113.7 119.7 112 123.8 112 128C112 131.2 112.9 134.3 114.7 136.9C116.5 139.5 118.1 141.6 121.9 142.8C124.8 143.1 128 144.3 131.1 143.7C134.2 143.1 137.1 141.6 139.3 139.3C141.6 137.1 143.1 134.2 143.7 131.1C144.3 128 143.1 124.8 142.8 121.9C141.6 118.1 139.5 116.5 136.9 114.7C134.3 112.9 131.2 111.1 128 111.1C123.8 111.1 119.7 113.7 116.7 116.7L116.7 116.7z"})})},frequent:{outline:et("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:[et("path",{d:"M13 4h-2l-.001 7H9v2h2v2h2v-2h4v-2h-4z"}),et("path",{d:"M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0m0 22C6.486 22 2 17.514 2 12S6.486 2 12 2s10 4.486 10 10-4.486 10-10 10"})]}),solid:et("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:et("path",{d:"M256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512zM232 256C232 264 236 271.5 242.7 275.1L338.7 339.1C349.7 347.3 364.6 344.3 371.1 333.3C379.3 322.3 376.3 307.4 365.3 300L280 243.2V120C280 106.7 269.3 96 255.1 96C242.7 96 231.1 106.7 231.1 120L232 256z"})})},nature:{outline:et("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:[et("path",{d:"M15.5 8a1.5 1.5 0 1 0 .001 3.001A1.5 1.5 0 0 0 15.5 8M8.5 8a1.5 1.5 0 1 0 .001 3.001A1.5 1.5 0 0 0 8.5 8"}),et("path",{d:"M18.933 0h-.027c-.97 0-2.138.787-3.018 1.497-1.274-.374-2.612-.51-3.887-.51-1.285 0-2.616.133-3.874.517C7.245.79 6.069 0 5.093 0h-.027C3.352 0 .07 2.67.002 7.026c-.039 2.479.276 4.238 1.04 5.013.254.258.882.677 1.295.882.191 3.177.922 5.238 2.536 6.38.897.637 2.187.949 3.2 1.102C8.04 20.6 8 20.795 8 21c0 1.773 2.35 3 4 3 1.648 0 4-1.227 4-3 0-.201-.038-.393-.072-.586 2.573-.385 5.435-1.877 5.925-7.587.396-.22.887-.568 1.104-.788.763-.774 1.079-2.534 1.04-5.013C23.929 2.67 20.646 0 18.933 0M3.223 9.135c-.237.281-.837 1.155-.884 1.238-.15-.41-.368-1.349-.337-3.291.051-3.281 2.478-4.972 3.091-5.031.256.015.731.27 1.265.646-1.11 1.171-2.275 2.915-2.352 5.125-.133.546-.398.858-.783 1.313M12 22c-.901 0-1.954-.693-2-1 0-.654.475-1.236 1-1.602V20a1 1 0 1 0 2 0v-.602c.524.365 1 .947 1 1.602-.046.307-1.099 1-2 1m3-3.48v.02a4.752 4.752 0 0 0-1.262-1.02c1.092-.516 2.239-1.334 2.239-2.217 0-1.842-1.781-2.195-3.977-2.195-2.196 0-3.978.354-3.978 2.195 0 .883 1.148 1.701 2.238 2.217A4.8 4.8 0 0 0 9 18.539v-.025c-1-.076-2.182-.281-2.973-.842-1.301-.92-1.838-3.045-1.853-6.478l.023-.041c.496-.826 1.49-1.45 1.804-3.102 0-2.047 1.357-3.631 2.362-4.522C9.37 3.178 10.555 3 11.948 3c1.447 0 2.685.192 3.733.57 1 .9 2.316 2.465 2.316 4.48.313 1.651 1.307 2.275 1.803 3.102.035.058.068.117.102.178-.059 5.967-1.949 7.01-4.902 7.19m6.628-8.202c-.037-.065-.074-.13-.113-.195a7.587 7.587 0 0 0-.739-.987c-.385-.455-.648-.768-.782-1.313-.076-2.209-1.241-3.954-2.353-5.124.531-.376 1.004-.63 1.261-.647.636.071 3.044 1.764 3.096 5.031.027 1.81-.347 3.218-.37 3.235"})]}),solid:et("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512",children:et("path",{d:"M332.7 19.85C334.6 8.395 344.5 0 356.1 0C363.6 0 370.6 3.52 375.1 9.502L392 32H444.1C456.8 32 469.1 37.06 478.1 46.06L496 64H552C565.3 64 576 74.75 576 88V112C576 156.2 540.2 192 496 192H426.7L421.6 222.5L309.6 158.5L332.7 19.85zM448 64C439.2 64 432 71.16 432 80C432 88.84 439.2 96 448 96C456.8 96 464 88.84 464 80C464 71.16 456.8 64 448 64zM416 256.1V480C416 497.7 401.7 512 384 512H352C334.3 512 320 497.7 320 480V364.8C295.1 377.1 268.8 384 240 384C211.2 384 184 377.1 160 364.8V480C160 497.7 145.7 512 128 512H96C78.33 512 64 497.7 64 480V249.8C35.23 238.9 12.64 214.5 4.836 183.3L.9558 167.8C-3.331 150.6 7.094 133.2 24.24 128.1C41.38 124.7 58.76 135.1 63.05 152.2L66.93 167.8C70.49 182 83.29 191.1 97.97 191.1H303.8L416 256.1z"})})},objects:{outline:et("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:[et("path",{d:"M12 0a9 9 0 0 0-5 16.482V21s2.035 3 5 3 5-3 5-3v-4.518A9 9 0 0 0 12 0zm0 2c3.86 0 7 3.141 7 7s-3.14 7-7 7-7-3.141-7-7 3.14-7 7-7zM9 17.477c.94.332 1.946.523 3 .523s2.06-.19 3-.523v.834c-.91.436-1.925.689-3 .689a6.924 6.924 0 0 1-3-.69v-.833zm.236 3.07A8.854 8.854 0 0 0 12 21c.965 0 1.888-.167 2.758-.451C14.155 21.173 13.153 22 12 22c-1.102 0-2.117-.789-2.764-1.453z"}),et("path",{d:"M14.745 12.449h-.004c-.852-.024-1.188-.858-1.577-1.824-.421-1.061-.703-1.561-1.182-1.566h-.009c-.481 0-.783.497-1.235 1.537-.436.982-.801 1.811-1.636 1.791l-.276-.043c-.565-.171-.853-.691-1.284-1.794-.125-.313-.202-.632-.27-.913-.051-.213-.127-.53-.195-.634C7.067 9.004 7.039 9 6.99 9A1 1 0 0 1 7 7h.01c1.662.017 2.015 1.373 2.198 2.134.486-.981 1.304-2.058 2.797-2.075 1.531.018 2.28 1.153 2.731 2.141l.002-.008C14.944 8.424 15.327 7 16.979 7h.032A1 1 0 1 1 17 9h-.011c-.149.076-.256.474-.319.709a6.484 6.484 0 0 1-.311.951c-.429.973-.79 1.789-1.614 1.789"})]}),solid:et("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",children:et("path",{d:"M112.1 454.3c0 6.297 1.816 12.44 5.284 17.69l17.14 25.69c5.25 7.875 17.17 14.28 26.64 14.28h61.67c9.438 0 21.36-6.401 26.61-14.28l17.08-25.68c2.938-4.438 5.348-12.37 5.348-17.7L272 415.1h-160L112.1 454.3zM191.4 .0132C89.44 .3257 16 82.97 16 175.1c0 44.38 16.44 84.84 43.56 115.8c16.53 18.84 42.34 58.23 52.22 91.45c.0313 .25 .0938 .5166 .125 .7823h160.2c.0313-.2656 .0938-.5166 .125-.7823c9.875-33.22 35.69-72.61 52.22-91.45C351.6 260.8 368 220.4 368 175.1C368 78.61 288.9-.2837 191.4 .0132zM192 96.01c-44.13 0-80 35.89-80 79.1C112 184.8 104.8 192 96 192S80 184.8 80 176c0-61.76 50.25-111.1 112-111.1c8.844 0 16 7.159 16 16S200.8 96.01 192 96.01z"})})},people:{outline:et("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:[et("path",{d:"M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0m0 22C6.486 22 2 17.514 2 12S6.486 2 12 2s10 4.486 10 10-4.486 10-10 10"}),et("path",{d:"M8 7a2 2 0 1 0-.001 3.999A2 2 0 0 0 8 7M16 7a2 2 0 1 0-.001 3.999A2 2 0 0 0 16 7M15.232 15c-.693 1.195-1.87 2-3.349 2-1.477 0-2.655-.805-3.347-2H15m3-2H6a6 6 0 1 0 12 0"})]}),solid:et("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:et("path",{d:"M0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256zM256 432C332.1 432 396.2 382 415.2 314.1C419.1 300.4 407.8 288 393.6 288H118.4C104.2 288 92.92 300.4 96.76 314.1C115.8 382 179.9 432 256 432V432zM176.4 160C158.7 160 144.4 174.3 144.4 192C144.4 209.7 158.7 224 176.4 224C194 224 208.4 209.7 208.4 192C208.4 174.3 194 160 176.4 160zM336.4 224C354 224 368.4 209.7 368.4 192C368.4 174.3 354 160 336.4 160C318.7 160 304.4 174.3 304.4 192C304.4 209.7 318.7 224 336.4 224z"})})},places:{outline:et("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:[et("path",{d:"M6.5 12C5.122 12 4 13.121 4 14.5S5.122 17 6.5 17 9 15.879 9 14.5 7.878 12 6.5 12m0 3c-.275 0-.5-.225-.5-.5s.225-.5.5-.5.5.225.5.5-.225.5-.5.5M17.5 12c-1.378 0-2.5 1.121-2.5 2.5s1.122 2.5 2.5 2.5 2.5-1.121 2.5-2.5-1.122-2.5-2.5-2.5m0 3c-.275 0-.5-.225-.5-.5s.225-.5.5-.5.5.225.5.5-.225.5-.5.5"}),et("path",{d:"M22.482 9.494l-1.039-.346L21.4 9h.6c.552 0 1-.439 1-.992 0-.006-.003-.008-.003-.008H23c0-1-.889-2-1.984-2h-.642l-.731-1.717C19.262 3.012 18.091 2 16.764 2H7.236C5.909 2 4.738 3.012 4.357 4.283L3.626 6h-.642C1.889 6 1 7 1 8h.003S1 8.002 1 8.008C1 8.561 1.448 9 2 9h.6l-.043.148-1.039.346a2.001 2.001 0 0 0-1.359 2.097l.751 7.508a1 1 0 0 0 .994.901H3v1c0 1.103.896 2 2 2h2c1.104 0 2-.897 2-2v-1h6v1c0 1.103.896 2 2 2h2c1.104 0 2-.897 2-2v-1h1.096a.999.999 0 0 0 .994-.901l.751-7.508a2.001 2.001 0 0 0-1.359-2.097M6.273 4.857C6.402 4.43 6.788 4 7.236 4h9.527c.448 0 .834.43.963.857L19.313 9H4.688l1.585-4.143zM7 21H5v-1h2v1zm12 0h-2v-1h2v1zm2.189-3H2.811l-.662-6.607L3 11h18l.852.393L21.189 18z"})]}),solid:et("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:et("path",{d:"M39.61 196.8L74.8 96.29C88.27 57.78 124.6 32 165.4 32H346.6C387.4 32 423.7 57.78 437.2 96.29L472.4 196.8C495.6 206.4 512 229.3 512 256V448C512 465.7 497.7 480 480 480H448C430.3 480 416 465.7 416 448V400H96V448C96 465.7 81.67 480 64 480H32C14.33 480 0 465.7 0 448V256C0 229.3 16.36 206.4 39.61 196.8V196.8zM109.1 192H402.9L376.8 117.4C372.3 104.6 360.2 96 346.6 96H165.4C151.8 96 139.7 104.6 135.2 117.4L109.1 192zM96 256C78.33 256 64 270.3 64 288C64 305.7 78.33 320 96 320C113.7 320 128 305.7 128 288C128 270.3 113.7 256 96 256zM416 320C433.7 320 448 305.7 448 288C448 270.3 433.7 256 416 256C398.3 256 384 270.3 384 288C384 305.7 398.3 320 416 320z"})})},symbols:{outline:et("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:et("path",{d:"M0 0h11v2H0zM4 11h3V6h4V4H0v2h4zM15.5 17c1.381 0 2.5-1.116 2.5-2.493s-1.119-2.493-2.5-2.493S13 13.13 13 14.507 14.119 17 15.5 17m0-2.986c.276 0 .5.222.5.493 0 .272-.224.493-.5.493s-.5-.221-.5-.493.224-.493.5-.493M21.5 19.014c-1.381 0-2.5 1.116-2.5 2.493S20.119 24 21.5 24s2.5-1.116 2.5-2.493-1.119-2.493-2.5-2.493m0 2.986a.497.497 0 0 1-.5-.493c0-.271.224-.493.5-.493s.5.222.5.493a.497.497 0 0 1-.5.493M22 13l-9 9 1.513 1.5 8.99-9.009zM17 11c2.209 0 4-1.119 4-2.5V2s.985-.161 1.498.949C23.01 4.055 23 6 23 6s1-1.119 1-3.135C24-.02 21 0 21 0h-2v6.347A5.853 5.853 0 0 0 17 6c-2.209 0-4 1.119-4 2.5s1.791 2.5 4 2.5M10.297 20.482l-1.475-1.585a47.54 47.54 0 0 1-1.442 1.129c-.307-.288-.989-1.016-2.045-2.183.902-.836 1.479-1.466 1.729-1.892s.376-.871.376-1.336c0-.592-.273-1.178-.818-1.759-.546-.581-1.329-.871-2.349-.871-1.008 0-1.79.293-2.344.879-.556.587-.832 1.181-.832 1.784 0 .813.419 1.748 1.256 2.805-.847.614-1.444 1.208-1.794 1.784a3.465 3.465 0 0 0-.523 1.833c0 .857.308 1.56.924 2.107.616.549 1.423.823 2.42.823 1.173 0 2.444-.379 3.813-1.137L8.235 24h2.819l-2.09-2.383 1.333-1.135zm-6.736-6.389a1.02 1.02 0 0 1 .73-.286c.31 0 .559.085.747.254a.849.849 0 0 1 .283.659c0 .518-.419 1.112-1.257 1.784-.536-.651-.805-1.231-.805-1.742a.901.901 0 0 1 .302-.669M3.74 22c-.427 0-.778-.116-1.057-.349-.279-.232-.418-.487-.418-.766 0-.594.509-1.288 1.527-2.083.968 1.134 1.717 1.946 2.248 2.438-.921.507-1.686.76-2.3.76"})}),solid:et("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:et("path",{d:"M500.3 7.251C507.7 13.33 512 22.41 512 31.1V175.1C512 202.5 483.3 223.1 447.1 223.1C412.7 223.1 383.1 202.5 383.1 175.1C383.1 149.5 412.7 127.1 447.1 127.1V71.03L351.1 90.23V207.1C351.1 234.5 323.3 255.1 287.1 255.1C252.7 255.1 223.1 234.5 223.1 207.1C223.1 181.5 252.7 159.1 287.1 159.1V63.1C287.1 48.74 298.8 35.61 313.7 32.62L473.7 .6198C483.1-1.261 492.9 1.173 500.3 7.251H500.3zM74.66 303.1L86.5 286.2C92.43 277.3 102.4 271.1 113.1 271.1H174.9C185.6 271.1 195.6 277.3 201.5 286.2L213.3 303.1H239.1C266.5 303.1 287.1 325.5 287.1 351.1V463.1C287.1 490.5 266.5 511.1 239.1 511.1H47.1C21.49 511.1-.0019 490.5-.0019 463.1V351.1C-.0019 325.5 21.49 303.1 47.1 303.1H74.66zM143.1 359.1C117.5 359.1 95.1 381.5 95.1 407.1C95.1 434.5 117.5 455.1 143.1 455.1C170.5 455.1 191.1 434.5 191.1 407.1C191.1 381.5 170.5 359.1 143.1 359.1zM440.3 367.1H496C502.7 367.1 508.6 372.1 510.1 378.4C513.3 384.6 511.6 391.7 506.5 396L378.5 508C372.9 512.1 364.6 513.3 358.6 508.9C352.6 504.6 350.3 496.6 353.3 489.7L391.7 399.1H336C329.3 399.1 323.4 395.9 321 389.6C318.7 383.4 320.4 376.3 325.5 371.1L453.5 259.1C459.1 255 467.4 254.7 473.4 259.1C479.4 263.4 481.6 271.4 478.7 278.3L440.3 367.1zM116.7 219.1L19.85 119.2C-8.112 90.26-6.614 42.31 24.85 15.34C51.82-8.137 93.26-3.642 118.2 21.83L128.2 32.32L137.7 21.83C162.7-3.642 203.6-8.137 231.6 15.34C262.6 42.31 264.1 90.26 236.1 119.2L139.7 219.1C133.2 225.6 122.7 225.6 116.7 219.1H116.7z"})})}},WMe={loupe:et("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:et("path",{d:"M12.9 14.32a8 8 0 1 1 1.41-1.41l5.35 5.33-1.42 1.42-5.33-5.34zM8 14A6 6 0 1 0 8 2a6 6 0 0 0 0 12z"})}),delete:et("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:et("path",{d:"M10 8.586L2.929 1.515 1.515 2.929 8.586 10l-7.071 7.071 1.414 1.414L10 11.414l7.071 7.071 1.414-1.414L11.414 10l7.071-7.071-1.414-1.414L10 8.586z"})})};var eN={categories:BMe,search:WMe};function BV(t){let{id:e,skin:n,emoji:r}=t;if(t.shortcodes){const f=t.shortcodes.match(rv.SHORTCODES_REGEX);f&&(e=f[1],f[2]&&(n=f[2]))}if(r||(r=rv.get(e||t.native)),!r)return t.fallback;const c=r.skins[n-1]||r.skins[0],l=c.src||(t.set!="native"&&!t.spritesheet?typeof t.getImageURL=="function"?t.getImageURL(t.set,c.unified):`https://cdn.jsdelivr.net/npm/emoji-datasource-${t.set}@14.0.0/img/${t.set}/64/${c.unified}.png`:void 0),d=typeof t.getSpritesheetURL=="function"?t.getSpritesheetURL(t.set):`https://cdn.jsdelivr.net/npm/emoji-datasource-${t.set}@14.0.0/img/${t.set}/sheets-256/64.png`;return et("span",{class:"emoji-mart-emoji","data-emoji-set":t.set,children:l?et("img",{style:{maxWidth:t.size||"1em",maxHeight:t.size||"1em",display:"inline-block"},alt:c.native||c.shortcodes,src:l}):t.set=="native"?et("span",{style:{fontSize:t.size,fontFamily:'"EmojiMart", "Segoe UI Emoji", "Segoe UI Symbol", "Segoe UI", "Apple Color Emoji", "Twemoji Mozilla", "Noto Color Emoji", "Android Emoji"'},children:c.native}):et("span",{style:{display:"block",width:t.size,height:t.size,backgroundImage:`url(${d})`,backgroundSize:`${100*Un.sheet.cols}% ${100*Un.sheet.rows}%`,backgroundPosition:`${100/(Un.sheet.cols-1)*c.x}% ${100/(Un.sheet.rows-1)*c.y}%`}})})}const HMe=typeof window<"u"&&window.HTMLElement?window.HTMLElement:Object;class zre extends HMe{static get observedAttributes(){return Object.keys(this.Props)}update(e={}){for(let n in e)this.attributeChangedCallback(n,null,e[n])}attributeChangedCallback(e,n,r){if(!this.component)return;const c=$re(e,{[e]:r},this.constructor.Props,this);this.component.componentWillReceiveProps?this.component.componentWillReceiveProps({[e]:c}):(this.component.props[e]=c,this.component.forceUpdate())}disconnectedCallback(){this.disconnected=!0,this.component&&this.component.unregister&&this.component.unregister()}constructor(e={}){if(super(),this.props=e,e.parent||e.ref){let n=null;const r=e.parent||(n=e.ref&&e.ref.current);n&&(n.innerHTML=""),r&&r.appendChild(this)}}}class $Me extends zre{setShadow(){this.attachShadow({mode:"open"})}injectStyles(e){if(!e)return;const n=document.createElement("style");n.textContent=e,this.shadowRoot.insertBefore(n,this.shadowRoot.firstChild)}constructor(e,{styles:n}={}){super(e),this.setShadow(),this.injectStyles(n)}}var Gre={fallback:"",id:"",native:"",shortcodes:"",size:{value:"",transform:t=>/\D/.test(t)?t:`${t}px`},set:Cd.set,skin:Cd.skin};class Kre extends zre{async connectedCallback(){const e=Hre(this.props,Gre,this);e.element=this,e.ref=n=>{this.component=n},await BP(),!this.disconnected&&Ure(et(BV,{...e}),this)}constructor(e){super(e)}}dl(Kre,"Props",Gre);typeof customElements<"u"&&!customElements.get("em-emoji")&&customElements.define("em-emoji",Kre);var eY,WV=[],tY=Kt.__b,nY=Kt.__r,iY=Kt.diffed,rY=Kt.__c,sY=Kt.unmount;function zMe(){var t;for(WV.sort(function(e,n){return e.__v.__b-n.__v.__b});t=WV.pop();)if(t.__P)try{t.__H.__h.forEach(YO),t.__H.__h.forEach(HV),t.__H.__h=[]}catch(e){t.__H.__h=[],Kt.__e(e,t.__v)}}Kt.__b=function(t){tY&&tY(t)},Kt.__r=function(t){nY&&nY(t);var e=t.__c.__H;e&&(e.__h.forEach(YO),e.__h.forEach(HV),e.__h=[])},Kt.diffed=function(t){iY&&iY(t);var e=t.__c;e&&e.__H&&e.__H.__h.length&&(WV.push(e)!==1&&eY===Kt.requestAnimationFrame||((eY=Kt.requestAnimationFrame)||function(n){var r,c=function(){clearTimeout(l),oY&&cancelAnimationFrame(r),setTimeout(n)},l=setTimeout(c,100);oY&&(r=requestAnimationFrame(c))})(zMe))},Kt.__c=function(t,e){e.some(function(n){try{n.__h.forEach(YO),n.__h=n.__h.filter(function(r){return!r.__||HV(r)})}catch(r){e.some(function(c){c.__h&&(c.__h=[])}),e=[],Kt.__e(r,n.__v)}}),rY&&rY(t,e)},Kt.unmount=function(t){sY&&sY(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{YO(r)}catch(c){e=c}}),e&&Kt.__e(e,n.__v))};var oY=typeof requestAnimationFrame=="function";function YO(t){var e=t.__c;typeof e=="function"&&(t.__c=void 0,e())}function HV(t){t.__c=t.__()}function GMe(t,e){for(var n in e)t[n]=e[n];return t}function aY(t,e){for(var n in t)if(n!=="__source"&&!(n in e))return!0;for(var r in e)if(r!=="__source"&&t[r]!==e[r])return!0;return!1}function tN(t){this.props=t}(tN.prototype=new wu).isPureReactComponent=!0,tN.prototype.shouldComponentUpdate=function(t,e){return aY(this.props,t)||aY(this.state,e)};var cY=Kt.__b;Kt.__b=function(t){t.type&&t.type.__f&&t.ref&&(t.props.ref=t.ref,t.ref=null),cY&&cY(t)};var KMe=Kt.__e;Kt.__e=function(t,e,n){if(t.then){for(var r,c=e;c=c.__;)if((r=c.__c)&&r.__c)return e.__e==null&&(e.__e=n.__e,e.__k=n.__k),r.__c(t,e)}KMe(t,e,n)};var lY=Kt.unmount;function dF(){this.__u=0,this.t=null,this.__b=null}function qre(t){var e=t.__.__c;return e&&e.__e&&e.__e(t)}function tO(){this.u=null,this.o=null}Kt.unmount=function(t){var e=t.__c;e&&e.__R&&e.__R(),e&&t.__h===!0&&(t.type=null),lY&&lY(t)},(dF.prototype=new wu).__c=function(t,e){var n=e.__c,r=this;r.t==null&&(r.t=[]),r.t.push(n);var c=qre(r.__v),l=!1,d=function(){l||(l=!0,n.__R=null,c?c(f):f())};n.__R=d;var f=function(){if(!--r.__u){if(r.state.__e){var E=r.state.__e;r.__v.__k[0]=function w(I,P,k){return I&&(I.__v=null,I.__k=I.__k&&I.__k.map(function(M){return w(M,P,k)}),I.__c&&I.__c.__P===P&&(I.__e&&k.insertBefore(I.__e,I.__d),I.__c.__e=!0,I.__c.__P=k)),I}(E,E.__c.__P,E.__c.__O)}var y;for(r.setState({__e:r.__b=null});y=r.t.pop();)y.forceUpdate()}},m=e.__h===!0;r.__u++||m||r.setState({__e:r.__b=r.__v.__k[0]}),t.then(d,d)},dF.prototype.componentWillUnmount=function(){this.t=[]},dF.prototype.render=function(t,e){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=function l(d,f,m){return d&&(d.__c&&d.__c.__H&&(d.__c.__H.__.forEach(function(E){typeof E.__c=="function"&&E.__c()}),d.__c.__H=null),(d=GMe({},d)).__c!=null&&(d.__c.__P===m&&(d.__c.__P=f),d.__c=null),d.__k=d.__k&&d.__k.map(function(E){return l(E,f,m)})),d}(this.__b,n,r.__O=r.__P)}this.__b=null}var c=e.__e&&jV(Cv,null,t.fallback);return c&&(c.__h=null),[jV(Cv,null,e.__e?null:t.children),c]};var uY=function(t,e,n){if(++n[1]===n[0]&&t.o.delete(e),t.props.revealOrder&&(t.props.revealOrder[0]!=="t"||!t.o.size))for(n=t.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;t.u=n=n[2]}};(tO.prototype=new wu).__e=function(t){var e=this,n=qre(e.__v),r=e.o.get(t);return r[0]++,function(c){var l=function(){e.props.revealOrder?(r.push(c),uY(e,t,r)):c()};n?n(l):l()}},tO.prototype.render=function(t){this.u=null,this.o=new Map;var e=Q1(t.children);t.revealOrder&&t.revealOrder[0]==="b"&&e.reverse();for(var n=e.length;n--;)this.o.set(e[n],this.u=[1,0,this.u]);return t.children},tO.prototype.componentDidUpdate=tO.prototype.componentDidMount=function(){var t=this;this.o.forEach(function(e,n){uY(t,n,e)})};var qMe=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,YMe=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,XMe=typeof document<"u",JMe=function(t){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(t)};wu.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(t){Object.defineProperty(wu.prototype,t,{configurable:!0,get:function(){return this["UNSAFE_"+t]},set:function(e){Object.defineProperty(this,t,{configurable:!0,writable:!0,value:e})}})});var dY=Kt.event;function QMe(){}function ZMe(){return this.cancelBubble}function e2e(){return this.defaultPrevented}Kt.event=function(t){return dY&&(t=dY(t)),t.persist=QMe,t.isPropagationStopped=ZMe,t.isDefaultPrevented=e2e,t.nativeEvent=t};var hY={configurable:!0,get:function(){return this.class}},fY=Kt.vnode;Kt.vnode=function(t){var e=t.type,n=t.props,r=n;if(typeof e=="string"){var c=e.indexOf("-")===-1;for(var l in r={},n){var d=n[l];XMe&&l==="children"&&e==="noscript"||l==="value"&&"defaultValue"in n&&d==null||(l==="defaultValue"&&"value"in n&&n.value==null?l="value":l==="download"&&d===!0?d="":/ondoubleclick/i.test(l)?l="ondblclick":/^onchange(textarea|input)/i.test(l+e)&&!JMe(n.type)?l="oninput":/^onfocus$/i.test(l)?l="onfocusin":/^onblur$/i.test(l)?l="onfocusout":/^on(Ani|Tra|Tou|BeforeInp)/.test(l)?l=l.toLowerCase():c&&YMe.test(l)?l=l.replace(/[A-Z0-9]/,"-$&").toLowerCase():d===null&&(d=void 0),r[l]=d)}e=="select"&&r.multiple&&Array.isArray(r.value)&&(r.value=Q1(n.children).forEach(function(f){f.props.selected=r.value.indexOf(f.props.value)!=-1})),e=="select"&&r.defaultValue!=null&&(r.value=Q1(n.children).forEach(function(f){f.props.selected=r.multiple?r.defaultValue.indexOf(f.props.value)!=-1:r.defaultValue==f.props.value})),t.props=r,n.class!=n.className&&(hY.enumerable="className"in n,n.className!=null&&(r.class=n.className),Object.defineProperty(r,"className",hY))}t.$$typeof=qMe,fY&&fY(t)};var pY=Kt.__r;Kt.__r=function(t){pY&&pY(t),t.__c};const t2e={light:"outline",dark:"solid"};class n2e extends tN{renderIcon(e){const{icon:n}=e;if(n){if(n.svg)return et("span",{class:"flex",dangerouslySetInnerHTML:{__html:n.svg}});if(n.src)return et("img",{src:n.src})}const r=eN.categories[e.id]||eN.categories.custom,c=this.props.icons=="auto"?t2e[this.props.theme]:this.props.icons;return r[c]||r}render(){let e=null;return et("nav",{id:"nav",class:"padding","data-position":this.props.position,dir:this.props.dir,children:et("div",{class:"flex relative",children:[this.categories.map((n,r)=>{const c=n.name||vo.categories[n.id],l=!this.props.unfocused&&n.id==this.state.categoryId;return l&&(e=r),et("button",{"aria-label":c,"aria-selected":l||void 0,title:c,type:"button",class:"flex flex-grow flex-center",onMouseDown:d=>d.preventDefault(),onClick:()=>{this.props.onClick({category:n,i:r})},children:this.renderIcon(n)})}),et("div",{class:"bar",style:{width:`${100/this.categories.length}%`,opacity:e==null?0:1,transform:this.props.dir==="rtl"?`scaleX(-1) translateX(${e*100}%)`:`translateX(${e*100}%)`}})]})})}constructor(){super(),this.categories=Un.categories.filter(e=>!e.target),this.state={categoryId:this.categories[0].id}}}class i2e extends tN{shouldComponentUpdate(e){for(let n in e)if(n!="children"&&e[n]!=this.props[n])return!0;return!1}render(){return this.props.children}}const nO={rowsPerRender:10};class r2e extends wu{getInitialState(e=this.props){return{skin:Ff.get("skin")||e.skin,theme:this.initTheme(e.theme)}}componentWillMount(){this.dir=vo.rtl?"rtl":"ltr",this.refs={menu:Ed(),navigation:Ed(),scroll:Ed(),search:Ed(),searchInput:Ed(),skinToneButton:Ed(),skinToneRadio:Ed()},this.initGrid(),this.props.stickySearch==!1&&this.props.searchPosition=="sticky"&&(console.warn("[EmojiMart] Deprecation warning: `stickySearch` has been renamed `searchPosition`."),this.props.searchPosition="static")}componentDidMount(){if(this.register(),this.shadowRoot=this.base.parentNode,this.props.autoFocus){const{searchInput:e}=this.refs;e.current&&e.current.focus()}}componentWillReceiveProps(e){this.nextState||(this.nextState={});for(const n in e)this.nextState[n]=e[n];clearTimeout(this.nextStateTimer),this.nextStateTimer=setTimeout(()=>{let n=!1;for(const c in this.nextState)this.props[c]=this.nextState[c],(c==="custom"||c==="categories")&&(n=!0);delete this.nextState;const r=this.getInitialState();if(n)return this.reset(r);this.setState(r)})}componentWillUnmount(){this.unregister()}async reset(e={}){await BP(this.props),this.initGrid(),this.unobserve(),this.setState(e,()=>{this.observeCategories(),this.observeRows()})}register(){document.addEventListener("click",this.handleClickOutside),this.observe()}unregister(){document.removeEventListener("click",this.handleClickOutside),this.unobserve()}observe(){this.observeCategories(),this.observeRows()}unobserve({except:e=[]}={}){Array.isArray(e)||(e=[e]);for(const n of this.observers)e.includes(n)||n.disconnect();this.observers=[].concat(e)}initGrid(){const{categories:e}=Un;this.refs.categories=new Map;const n=Un.categories.map(c=>c.id).join(",");this.navKey&&this.navKey!=n&&this.refs.scroll.current&&(this.refs.scroll.current.scrollTop=0),this.navKey=n,this.grid=[],this.grid.setsize=0;const r=(c,l)=>{const d=[];d.__categoryId=l.id,d.__index=c.length,this.grid.push(d);const f=this.grid.length-1,m=f%nO.rowsPerRender?{}:Ed();return m.index=f,m.posinset=this.grid.setsize+1,c.push(m),d};for(let c of e){const l=[];let d=r(l,c);for(let f of c.emojis)d.length==this.getPerLine()&&(d=r(l,c)),this.grid.setsize+=1,d.push(f);this.refs.categories.set(c.id,{root:Ed(),rows:l})}}initTheme(e){if(e!="auto")return e;if(!this.darkMedia){if(this.darkMedia=matchMedia("(prefers-color-scheme: dark)"),this.darkMedia.media.match(/^not/))return"light";this.darkMedia.addListener(()=>{this.props.theme=="auto"&&this.setState({theme:this.darkMedia.matches?"dark":"light"})})}return this.darkMedia.matches?"dark":"light"}initDynamicPerLine(e=this.props){if(!e.dynamicWidth)return;const{element:n,emojiButtonSize:r}=e,c=()=>{const{width:d}=n.getBoundingClientRect();return Math.floor(d/r)},l=new ResizeObserver(()=>{this.unobserve({except:l}),this.setState({perLine:c()},()=>{this.initGrid(),this.forceUpdate(()=>{this.observeCategories(),this.observeRows()})})});return l.observe(n),this.observers.push(l),c()}getPerLine(){return this.state.perLine||this.props.perLine}getEmojiByPos([e,n]){const r=this.state.searchResults||this.grid,c=r[e]&&r[e][n];if(c)return rv.get(c)}observeCategories(){const e=this.refs.navigation.current;if(!e)return;const n=new Map,r=d=>{d!=e.state.categoryId&&e.setState({categoryId:d})},c={root:this.refs.scroll.current,threshold:[0,1]},l=new IntersectionObserver(d=>{for(const m of d){const E=m.target.dataset.id;n.set(E,m.intersectionRatio)}const f=[...n];for(const[m,E]of f)if(E){r(m);break}},c);for(const{root:d}of this.refs.categories.values())l.observe(d.current);this.observers.push(l)}observeRows(){const e={...this.state.visibleRows},n=new IntersectionObserver(r=>{for(const c of r){const l=parseInt(c.target.dataset.index);c.isIntersecting?e[l]=!0:delete e[l]}this.setState({visibleRows:e})},{root:this.refs.scroll.current,rootMargin:`${this.props.emojiButtonSize*(nO.rowsPerRender+5)}px 0px ${this.props.emojiButtonSize*nO.rowsPerRender}px`});for(const{rows:r}of this.refs.categories.values())for(const c of r)c.current&&n.observe(c.current);this.observers.push(n)}preventDefault(e){e.preventDefault()}unfocusSearch(){const e=this.refs.searchInput.current;e&&e.blur()}navigate({e,input:n,left:r,right:c,up:l,down:d}){const f=this.state.searchResults||this.grid;if(!f.length)return;let[m,E]=this.state.pos;const y=(()=>{if(m==0&&E==0&&!e.repeat&&(r||l))return null;if(m==-1)return!e.repeat&&(c||d)&&n.selectionStart==n.value.length?[0,0]:null;if(r||c){let w=f[m];const I=r?-1:1;if(E+=I,!w[E]){if(m+=I,w=f[m],!w)return m=r?0:f.length-1,E=r?0:f[m].length-1,[m,E];E=r?w.length-1:0}return[m,E]}if(l||d){m+=l?-1:1;const w=f[m];return w?(w[E]||(E=w.length-1),[m,E]):(m=l?0:f.length-1,E=l?0:f[m].length-1,[m,E])}})();if(y)e.preventDefault();else{this.state.pos[0]>-1&&this.setState({pos:[-1,-1]});return}this.setState({pos:y,keyboard:!0},()=>{this.scrollTo({row:y[0]})})}scrollTo({categoryId:e,row:n}){const r=this.state.searchResults||this.grid;if(!r.length)return;const c=this.refs.scroll.current,l=c.getBoundingClientRect();let d=0;if(n>=0&&(e=r[n].__categoryId),e&&(d=(this.refs[e]||this.refs.categories.get(e).root).current.getBoundingClientRect().top-(l.top-c.scrollTop)+1),n>=0)if(!n)d=0;else{const f=r[n].__index,m=d+f*this.props.emojiButtonSize,E=m+this.props.emojiButtonSize+this.props.emojiButtonSize*.88;if(m<c.scrollTop)d=m;else if(E>c.scrollTop+l.height)d=E-l.height;else return}this.ignoreMouse(),c.scrollTop=d}ignoreMouse(){this.mouseIsIgnored=!0,clearTimeout(this.ignoreMouseTimer),this.ignoreMouseTimer=setTimeout(()=>{delete this.mouseIsIgnored},100)}handleEmojiOver(e){this.mouseIsIgnored||this.state.showSkins||this.setState({pos:e||[-1,-1],keyboard:!1})}handleEmojiClick({e,emoji:n,pos:r}){if(this.props.onEmojiSelect&&(!n&&r&&(n=this.getEmojiByPos(r)),n)){const c=VMe(n,{skinIndex:this.state.skin-1});this.props.maxFrequentRows&&Fre.add(c,this.props),this.props.onEmojiSelect(c,e)}}closeSkins(){this.state.showSkins&&(this.setState({showSkins:null,tempSkin:null}),this.base.removeEventListener("click",this.handleBaseClick),this.base.removeEventListener("keydown",this.handleBaseKeydown))}handleSkinMouseOver(e){this.setState({tempSkin:e})}handleSkinClick(e){this.ignoreMouse(),this.closeSkins(),this.setState({skin:e,tempSkin:null}),Ff.set("skin",e)}renderNav(){return et(n2e,{ref:this.refs.navigation,icons:this.props.icons,theme:this.state.theme,dir:this.dir,unfocused:!!this.state.searchResults,position:this.props.navPosition,onClick:this.handleCategoryClick},this.navKey)}renderPreview(){const e=this.getEmojiByPos(this.state.pos),n=this.state.searchResults&&!this.state.searchResults.length;return et("div",{id:"preview",class:"flex flex-middle",dir:this.dir,"data-position":this.props.previewPosition,children:[et("div",{class:"flex flex-middle flex-grow",children:[et("div",{class:"flex flex-auto flex-middle flex-center",style:{height:this.props.emojiButtonSize,fontSize:this.props.emojiButtonSize},children:et(BV,{emoji:e,id:n?this.props.noResultsEmoji||"cry":this.props.previewEmoji||(this.props.previewPosition=="top"?"point_down":"point_up"),set:this.props.set,size:this.props.emojiButtonSize,skin:this.state.tempSkin||this.state.skin,spritesheet:!0,getSpritesheetURL:this.props.getSpritesheetURL})}),et("div",{class:`margin-${this.dir[0]}`,children:e||n?et("div",{class:`padding-${this.dir[2]} align-${this.dir[0]}`,children:[et("div",{class:"preview-title ellipsis",children:e?e.name:vo.search_no_results_1}),et("div",{class:"preview-subtitle ellipsis color-c",children:e?e.skins[0].shortcodes:vo.search_no_results_2})]}):et("div",{class:"preview-placeholder color-c",children:vo.pick})})]}),!e&&this.props.skinTonePosition=="preview"&&this.renderSkinToneButton()]})}renderEmojiButton(e,{pos:n,posinset:r,grid:c}){const l=this.props.emojiButtonSize,d=this.state.tempSkin||this.state.skin,m=(e.skins[d-1]||e.skins[0]).native,E=jMe(this.state.pos,n),y=n.concat(e.id).join("");return et(i2e,{selected:E,skin:d,size:l,children:et("button",{"aria-label":m,"aria-selected":E||void 0,"aria-posinset":r,"aria-setsize":c.setsize,"data-keyboard":this.state.keyboard,title:this.props.previewPosition=="none"?e.name:void 0,type:"button",class:"flex flex-center flex-middle",tabindex:"-1",onClick:w=>this.handleEmojiClick({e:w,emoji:e}),onMouseEnter:()=>this.handleEmojiOver(n),onMouseLeave:()=>this.handleEmojiOver(),style:{width:this.props.emojiButtonSize,height:this.props.emojiButtonSize,fontSize:this.props.emojiSize,lineHeight:0},children:[et("div",{"aria-hidden":"true",class:"background",style:{borderRadius:this.props.emojiButtonRadius,backgroundColor:this.props.emojiButtonColors?this.props.emojiButtonColors[(r-1)%this.props.emojiButtonColors.length]:void 0}}),et(BV,{emoji:e,set:this.props.set,size:this.props.emojiSize,skin:d,spritesheet:!0,getSpritesheetURL:this.props.getSpritesheetURL})]})},y)}renderSearch(){const e=this.props.previewPosition=="none"||this.props.skinTonePosition=="search";return et("div",{children:[et("div",{class:"spacer"}),et("div",{class:"flex flex-middle",children:[et("div",{class:"search relative flex-grow",children:[et("input",{type:"search",ref:this.refs.searchInput,placeholder:vo.search,onClick:this.handleSearchClick,onInput:this.handleSearchInput,onKeyDown:this.handleSearchKeyDown,autoComplete:"off"}),et("span",{class:"icon loupe flex",children:eN.search.loupe}),this.state.searchResults&&et("button",{title:"Clear","aria-label":"Clear",type:"button",class:"icon delete flex",onClick:this.clearSearch,onMouseDown:this.preventDefault,children:eN.search.delete})]}),e&&this.renderSkinToneButton()]})]})}renderSearchResults(){const{searchResults:e}=this.state;return e?et("div",{class:"category",ref:this.refs.search,children:[et("div",{class:`sticky padding-small align-${this.dir[0]}`,children:vo.categories.search}),et("div",{children:e.length?e.map((n,r)=>et("div",{class:"flex",children:n.map((c,l)=>this.renderEmojiButton(c,{pos:[r,l],posinset:r*this.props.perLine+l+1,grid:e}))})):et("div",{class:`padding-small align-${this.dir[0]}`,children:this.props.onAddCustomEmoji&&et("a",{onClick:this.props.onAddCustomEmoji,children:vo.add_custom})})})]}):null}renderCategories(){const{categories:e}=Un,n=!!this.state.searchResults,r=this.getPerLine();return et("div",{style:{visibility:n?"hidden":void 0,display:n?"none":void 0,height:"100%"},children:e.map(c=>{const{root:l,rows:d}=this.refs.categories.get(c.id);return et("div",{"data-id":c.target?c.target.id:c.id,class:"category",ref:l,children:[et("div",{class:`sticky padding-small align-${this.dir[0]}`,children:c.name||vo.categories[c.id]}),et("div",{class:"relative",style:{height:d.length*this.props.emojiButtonSize},children:d.map((f,m)=>{const E=f.index-f.index%nO.rowsPerRender,y=this.state.visibleRows[E],w="current"in f?f:void 0;if(!y&&!w)return null;const I=m*r,P=I+r,k=c.emojis.slice(I,P);return k.length<r&&k.push(...new Array(r-k.length)),et("div",{"data-index":f.index,ref:w,class:"flex row",style:{top:m*this.props.emojiButtonSize},children:y&&k.map((M,K)=>{if(!M)return et("div",{style:{width:this.props.emojiButtonSize,height:this.props.emojiButtonSize}});const W=rv.get(M);return this.renderEmojiButton(W,{pos:[f.index,K],posinset:f.posinset+K,grid:this.grid})})},f.index)})})]})})})}renderSkinToneButton(){return this.props.skinTonePosition=="none"?null:et("div",{class:"flex flex-auto flex-center flex-middle",style:{position:"relative",width:this.props.emojiButtonSize,height:this.props.emojiButtonSize},children:et("button",{type:"button",ref:this.refs.skinToneButton,class:"skin-tone-button flex flex-auto flex-center flex-middle","aria-selected":this.state.showSkins?"":void 0,"aria-label":vo.skins.choose,title:vo.skins.choose,onClick:this.openSkins,style:{width:this.props.emojiSize,height:this.props.emojiSize},children:et("span",{class:`skin-tone skin-tone-${this.state.skin}`})})})}renderLiveRegion(){const e=this.getEmojiByPos(this.state.pos),n=e?e.name:"";return et("div",{"aria-live":"polite",class:"sr-only",children:n})}renderSkins(){const n=this.refs.skinToneButton.current.getBoundingClientRect(),r=this.base.getBoundingClientRect(),c={};return this.dir=="ltr"?c.right=r.right-n.right-3:c.left=n.left-r.left-3,this.props.previewPosition=="bottom"&&this.props.skinTonePosition=="preview"?c.bottom=r.bottom-n.top+6:(c.top=n.bottom-r.top+3,c.bottom="auto"),et("div",{ref:this.refs.menu,role:"radiogroup",dir:this.dir,"aria-label":vo.skins.choose,class:"menu hidden","data-position":c.top?"top":"bottom",style:c,children:[...Array(6).keys()].map(l=>{const d=l+1,f=this.state.skin==d;return et("div",{children:[et("input",{type:"radio",name:"skin-tone",value:d,"aria-label":vo.skins[d],ref:f?this.refs.skinToneRadio:null,defaultChecked:f,onChange:()=>this.handleSkinMouseOver(d),onKeyDown:m=>{(m.code=="Enter"||m.code=="Space"||m.code=="Tab")&&(m.preventDefault(),this.handleSkinClick(d))}}),et("button",{"aria-hidden":"true",tabindex:"-1",onClick:()=>this.handleSkinClick(d),onMouseEnter:()=>this.handleSkinMouseOver(d),onMouseLeave:()=>this.handleSkinMouseOver(),class:"option flex flex-grow flex-middle",children:[et("span",{class:`skin-tone skin-tone-${d}`}),et("span",{class:"margin-small-lr",children:vo.skins[d]})]})]})})})}render(){const e=this.props.perLine*this.props.emojiButtonSize;return et("section",{id:"root",class:"flex flex-column",dir:this.dir,style:{width:this.props.dynamicWidth?"100%":`calc(${e}px + (var(--padding) + var(--sidebar-width)))`},"data-emoji-set":this.props.set,"data-theme":this.state.theme,"data-menu":this.state.showSkins?"":void 0,children:[this.props.previewPosition=="top"&&this.renderPreview(),this.props.navPosition=="top"&&this.renderNav(),this.props.searchPosition=="sticky"&&et("div",{class:"padding-lr",children:this.renderSearch()}),et("div",{ref:this.refs.scroll,class:"scroll flex-grow padding-lr",children:et("div",{style:{width:this.props.dynamicWidth?"100%":e,height:"100%"},children:[this.props.searchPosition=="static"&&this.renderSearch(),this.renderSearchResults(),this.renderCategories()]})}),this.props.navPosition=="bottom"&&this.renderNav(),this.props.previewPosition=="bottom"&&this.renderPreview(),this.state.showSkins&&this.renderSkins(),this.renderLiveRegion()]})}constructor(e){super(),dl(this,"handleClickOutside",n=>{const{element:r}=this.props;n.target!=r&&(this.state.showSkins&&this.closeSkins(),this.props.onClickOutside&&this.props.onClickOutside(n))}),dl(this,"handleBaseClick",n=>{this.state.showSkins&&(n.target.closest(".menu")||(n.preventDefault(),n.stopImmediatePropagation(),this.closeSkins()))}),dl(this,"handleBaseKeydown",n=>{this.state.showSkins&&n.key=="Escape"&&(n.preventDefault(),n.stopImmediatePropagation(),this.closeSkins())}),dl(this,"handleSearchClick",()=>{this.getEmojiByPos(this.state.pos)&&this.setState({pos:[-1,-1]})}),dl(this,"handleSearchInput",async()=>{const n=this.refs.searchInput.current;if(!n)return;const{value:r}=n,c=await rv.search(r),l=()=>{this.refs.scroll.current&&(this.refs.scroll.current.scrollTop=0)};if(!c)return this.setState({searchResults:c,pos:[-1,-1]},l);const d=n.selectionStart==n.value.length?[0,0]:[-1,-1],f=[];f.setsize=c.length;let m=null;for(let E of c)(!f.length||m.length==this.getPerLine())&&(m=[],m.__categoryId="search",m.__index=f.length,f.push(m)),m.push(E);this.ignoreMouse(),this.setState({searchResults:f,pos:d},l)}),dl(this,"handleSearchKeyDown",n=>{const r=n.currentTarget;switch(n.stopImmediatePropagation(),n.key){case"ArrowLeft":this.navigate({e:n,input:r,left:!0});break;case"ArrowRight":this.navigate({e:n,input:r,right:!0});break;case"ArrowUp":this.navigate({e:n,input:r,up:!0});break;case"ArrowDown":this.navigate({e:n,input:r,down:!0});break;case"Enter":n.preventDefault(),this.handleEmojiClick({e:n,pos:this.state.pos});break;case"Escape":n.preventDefault(),this.state.searchResults?this.clearSearch():this.unfocusSearch();break}}),dl(this,"clearSearch",()=>{const n=this.refs.searchInput.current;n&&(n.value="",n.focus(),this.handleSearchInput())}),dl(this,"handleCategoryClick",({category:n,i:r})=>{this.scrollTo(r==0?{row:-1}:{categoryId:n.id})}),dl(this,"openSkins",n=>{const{currentTarget:r}=n,c=r.getBoundingClientRect();this.setState({showSkins:c},async()=>{await FMe(2);const l=this.refs.menu.current;l&&(l.classList.remove("hidden"),this.refs.skinToneRadio.current.focus(),this.base.addEventListener("click",this.handleBaseClick,!0),this.base.addEventListener("keydown",this.handleBaseKeydown,!0))})}),this.observers=[],this.state={pos:[-1,-1],perLine:this.initDynamicPerLine(e),visibleRows:{0:!0},...this.getInitialState(e)}}}class G5 extends $Me{async connectedCallback(){const e=Hre(this.props,Cd,this);e.element=this,e.ref=n=>{this.component=n},await BP(e),!this.disconnected&&Ure(et(r2e,{...e}),this.shadowRoot)}constructor(e){super(e,{styles:Cre(Yre)})}}dl(G5,"Props",Cd);typeof customElements<"u"&&!customElements.get("em-emoji-picker")&&customElements.define("em-emoji-picker",G5);var Yre={};Yre=`:host {
  width: min-content;
  height: 435px;
  min-height: 230px;
  border-radius: var(--border-radius);
  box-shadow: var(--shadow);
  --border-radius: 10px;
  --category-icon-size: 18px;
  --font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", sans-serif;
  --font-size: 15px;
  --preview-placeholder-size: 21px;
  --preview-title-size: 1.1em;
  --preview-subtitle-size: .9em;
  --shadow-color: 0deg 0% 0%;
  --shadow: .3px .5px 2.7px hsl(var(--shadow-color) / .14), .4px .8px 1px -3.2px hsl(var(--shadow-color) / .14), 1px 2px 2.5px -4.5px hsl(var(--shadow-color) / .14);
  display: flex;
}

[data-theme="light"] {
  --em-rgb-color: var(--rgb-color, 34, 36, 39);
  --em-rgb-accent: var(--rgb-accent, 34, 102, 237);
  --em-rgb-background: var(--rgb-background, 255, 255, 255);
  --em-rgb-input: var(--rgb-input, 255, 255, 255);
  --em-color-border: var(--color-border, rgba(0, 0, 0, .05));
  --em-color-border-over: var(--color-border-over, rgba(0, 0, 0, .1));
}

[data-theme="dark"] {
  --em-rgb-color: var(--rgb-color, 222, 222, 221);
  --em-rgb-accent: var(--rgb-accent, 58, 130, 247);
  --em-rgb-background: var(--rgb-background, 21, 22, 23);
  --em-rgb-input: var(--rgb-input, 0, 0, 0);
  --em-color-border: var(--color-border, rgba(255, 255, 255, .1));
  --em-color-border-over: var(--color-border-over, rgba(255, 255, 255, .2));
}

#root {
  --color-a: rgb(var(--em-rgb-color));
  --color-b: rgba(var(--em-rgb-color), .65);
  --color-c: rgba(var(--em-rgb-color), .45);
  --padding: 12px;
  --padding-small: calc(var(--padding) / 2);
  --sidebar-width: 16px;
  --duration: 225ms;
  --duration-fast: 125ms;
  --duration-instant: 50ms;
  --easing: cubic-bezier(.4, 0, .2, 1);
  width: 100%;
  text-align: left;
  border-radius: var(--border-radius);
  background-color: rgb(var(--em-rgb-background));
  position: relative;
}

@media (prefers-reduced-motion) {
  #root {
    --duration: 0;
    --duration-fast: 0;
    --duration-instant: 0;
  }
}

#root[data-menu] button {
  cursor: auto;
}

#root[data-menu] .menu button {
  cursor: pointer;
}

:host, #root, input, button {
  color: rgb(var(--em-rgb-color));
  font-family: var(--font-family);
  font-size: var(--font-size);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  line-height: normal;
}

*, :before, :after {
  box-sizing: border-box;
  min-width: 0;
  margin: 0;
  padding: 0;
}

.relative {
  position: relative;
}

.flex {
  display: flex;
}

.flex-auto {
  flex: none;
}

.flex-center {
  justify-content: center;
}

.flex-column {
  flex-direction: column;
}

.flex-grow {
  flex: auto;
}

.flex-middle {
  align-items: center;
}

.flex-wrap {
  flex-wrap: wrap;
}

.padding {
  padding: var(--padding);
}

.padding-t {
  padding-top: var(--padding);
}

.padding-lr {
  padding-left: var(--padding);
  padding-right: var(--padding);
}

.padding-r {
  padding-right: var(--padding);
}

.padding-small {
  padding: var(--padding-small);
}

.padding-small-b {
  padding-bottom: var(--padding-small);
}

.padding-small-lr {
  padding-left: var(--padding-small);
  padding-right: var(--padding-small);
}

.margin {
  margin: var(--padding);
}

.margin-r {
  margin-right: var(--padding);
}

.margin-l {
  margin-left: var(--padding);
}

.margin-small-l {
  margin-left: var(--padding-small);
}

.margin-small-lr {
  margin-left: var(--padding-small);
  margin-right: var(--padding-small);
}

.align-l {
  text-align: left;
}

.align-r {
  text-align: right;
}

.color-a {
  color: var(--color-a);
}

.color-b {
  color: var(--color-b);
}

.color-c {
  color: var(--color-c);
}

.ellipsis {
  white-space: nowrap;
  max-width: 100%;
  width: auto;
  text-overflow: ellipsis;
  overflow: hidden;
}

.sr-only {
  width: 1px;
  height: 1px;
  position: absolute;
  top: auto;
  left: -10000px;
  overflow: hidden;
}

a {
  cursor: pointer;
  color: rgb(var(--em-rgb-accent));
}

a:hover {
  text-decoration: underline;
}

.spacer {
  height: 10px;
}

[dir="rtl"] .scroll {
  padding-left: 0;
  padding-right: var(--padding);
}

.scroll {
  padding-right: 0;
  overflow-x: hidden;
  overflow-y: auto;
}

.scroll::-webkit-scrollbar {
  width: var(--sidebar-width);
  height: var(--sidebar-width);
}

.scroll::-webkit-scrollbar-track {
  border: 0;
}

.scroll::-webkit-scrollbar-button {
  width: 0;
  height: 0;
  display: none;
}

.scroll::-webkit-scrollbar-corner {
  background-color: rgba(0, 0, 0, 0);
}

.scroll::-webkit-scrollbar-thumb {
  min-height: 20%;
  min-height: 65px;
  border: 4px solid rgb(var(--em-rgb-background));
  border-radius: 8px;
}

.scroll::-webkit-scrollbar-thumb:hover {
  background-color: var(--em-color-border-over) !important;
}

.scroll:hover::-webkit-scrollbar-thumb {
  background-color: var(--em-color-border);
}

.sticky {
  z-index: 1;
  background-color: rgba(var(--em-rgb-background), .9);
  -webkit-backdrop-filter: blur(4px);
  backdrop-filter: blur(4px);
  font-weight: 500;
  position: sticky;
  top: -1px;
}

[dir="rtl"] .search input[type="search"] {
  padding: 10px 2.2em 10px 2em;
}

[dir="rtl"] .search .loupe {
  left: auto;
  right: .7em;
}

[dir="rtl"] .search .delete {
  left: .7em;
  right: auto;
}

.search {
  z-index: 2;
  position: relative;
}

.search input, .search button {
  font-size: calc(var(--font-size)  - 1px);
}

.search input[type="search"] {
  width: 100%;
  background-color: var(--em-color-border);
  transition-duration: var(--duration);
  transition-property: background-color, box-shadow;
  transition-timing-function: var(--easing);
  border: 0;
  border-radius: 10px;
  outline: 0;
  padding: 10px 2em 10px 2.2em;
  display: block;
}

.search input[type="search"]::-ms-input-placeholder {
  color: inherit;
  opacity: .6;
}

.search input[type="search"]::placeholder {
  color: inherit;
  opacity: .6;
}

.search input[type="search"], .search input[type="search"]::-webkit-search-decoration, .search input[type="search"]::-webkit-search-cancel-button, .search input[type="search"]::-webkit-search-results-button, .search input[type="search"]::-webkit-search-results-decoration {
  -webkit-appearance: none;
  -ms-appearance: none;
  appearance: none;
}

.search input[type="search"]:focus {
  background-color: rgb(var(--em-rgb-input));
  box-shadow: inset 0 0 0 1px rgb(var(--em-rgb-accent)), 0 1px 3px rgba(65, 69, 73, .2);
}

.search .icon {
  z-index: 1;
  color: rgba(var(--em-rgb-color), .7);
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
}

.search .loupe {
  pointer-events: none;
  left: .7em;
}

.search .delete {
  right: .7em;
}

svg {
  fill: currentColor;
  width: 1em;
  height: 1em;
}

button {
  -webkit-appearance: none;
  -ms-appearance: none;
  appearance: none;
  cursor: pointer;
  color: currentColor;
  background-color: rgba(0, 0, 0, 0);
  border: 0;
}

#nav {
  z-index: 2;
  padding-top: 12px;
  padding-bottom: 12px;
  padding-right: var(--sidebar-width);
  position: relative;
}

#nav button {
  color: var(--color-b);
  transition: color var(--duration) var(--easing);
}

#nav button:hover {
  color: var(--color-a);
}

#nav svg, #nav img {
  width: var(--category-icon-size);
  height: var(--category-icon-size);
}

#nav[dir="rtl"] .bar {
  left: auto;
  right: 0;
}

#nav .bar {
  width: 100%;
  height: 3px;
  background-color: rgb(var(--em-rgb-accent));
  transition: transform var(--duration) var(--easing);
  border-radius: 3px 3px 0 0;
  position: absolute;
  bottom: -12px;
  left: 0;
}

#nav button[aria-selected] {
  color: rgb(var(--em-rgb-accent));
}

#preview {
  z-index: 2;
  padding: calc(var(--padding)  + 4px) var(--padding);
  padding-right: var(--sidebar-width);
  position: relative;
}

#preview .preview-placeholder {
  font-size: var(--preview-placeholder-size);
}

#preview .preview-title {
  font-size: var(--preview-title-size);
}

#preview .preview-subtitle {
  font-size: var(--preview-subtitle-size);
}

#nav:before, #preview:before {
  content: "";
  height: 2px;
  position: absolute;
  left: 0;
  right: 0;
}

#nav[data-position="top"]:before, #preview[data-position="top"]:before {
  background: linear-gradient(to bottom, var(--em-color-border), transparent);
  top: 100%;
}

#nav[data-position="bottom"]:before, #preview[data-position="bottom"]:before {
  background: linear-gradient(to top, var(--em-color-border), transparent);
  bottom: 100%;
}

.category:last-child {
  min-height: calc(100% + 1px);
}

.category button {
  font-family: -apple-system, BlinkMacSystemFont, Helvetica Neue, sans-serif;
  position: relative;
}

.category button > * {
  position: relative;
}

.category button .background {
  opacity: 0;
  background-color: var(--em-color-border);
  transition: opacity var(--duration-fast) var(--easing) var(--duration-instant);
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
}

.category button:hover .background {
  transition-duration: var(--duration-instant);
  transition-delay: 0s;
}

.category button[aria-selected] .background {
  opacity: 1;
}

.category button[data-keyboard] .background {
  transition: none;
}

.row {
  width: 100%;
  position: absolute;
  top: 0;
  left: 0;
}

.skin-tone-button {
  border: 1px solid rgba(0, 0, 0, 0);
  border-radius: 100%;
}

.skin-tone-button:hover {
  border-color: var(--em-color-border);
}

.skin-tone-button:active .skin-tone {
  transform: scale(.85) !important;
}

.skin-tone-button .skin-tone {
  transition: transform var(--duration) var(--easing);
}

.skin-tone-button[aria-selected] {
  background-color: var(--em-color-border);
  border-top-color: rgba(0, 0, 0, .05);
  border-bottom-color: rgba(0, 0, 0, 0);
  border-left-width: 0;
  border-right-width: 0;
}

.skin-tone-button[aria-selected] .skin-tone {
  transform: scale(.9);
}

.menu {
  z-index: 2;
  white-space: nowrap;
  border: 1px solid var(--em-color-border);
  background-color: rgba(var(--em-rgb-background), .9);
  -webkit-backdrop-filter: blur(4px);
  backdrop-filter: blur(4px);
  transition-property: opacity, transform;
  transition-duration: var(--duration);
  transition-timing-function: var(--easing);
  border-radius: 10px;
  padding: 4px;
  position: absolute;
  box-shadow: 1px 1px 5px rgba(0, 0, 0, .05);
}

.menu.hidden {
  opacity: 0;
}

.menu[data-position="bottom"] {
  transform-origin: 100% 100%;
}

.menu[data-position="bottom"].hidden {
  transform: scale(.9)rotate(-3deg)translateY(5%);
}

.menu[data-position="top"] {
  transform-origin: 100% 0;
}

.menu[data-position="top"].hidden {
  transform: scale(.9)rotate(3deg)translateY(-5%);
}

.menu input[type="radio"] {
  clip: rect(0 0 0 0);
  width: 1px;
  height: 1px;
  border: 0;
  margin: 0;
  padding: 0;
  position: absolute;
  overflow: hidden;
}

.menu input[type="radio"]:checked + .option {
  box-shadow: 0 0 0 2px rgb(var(--em-rgb-accent));
}

.option {
  width: 100%;
  border-radius: 6px;
  padding: 4px 6px;
}

.option:hover {
  color: #fff;
  background-color: rgb(var(--em-rgb-accent));
}

.skin-tone {
  width: 16px;
  height: 16px;
  border-radius: 100%;
  display: inline-block;
  position: relative;
  overflow: hidden;
}

.skin-tone:after {
  content: "";
  mix-blend-mode: overlay;
  background: linear-gradient(rgba(255, 255, 255, .2), rgba(0, 0, 0, 0));
  border: 1px solid rgba(0, 0, 0, .8);
  border-radius: 100%;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  box-shadow: inset 0 -2px 3px #000, inset 0 1px 2px #fff;
}

.skin-tone-1 {
  background-color: #ffc93a;
}

.skin-tone-2 {
  background-color: #ffdab7;
}

.skin-tone-3 {
  background-color: #e7b98f;
}

.skin-tone-4 {
  background-color: #c88c61;
}

.skin-tone-5 {
  background-color: #a46134;
}

.skin-tone-6 {
  background-color: #5d4437;
}

[data-index] {
  justify-content: space-between;
}

[data-emoji-set="twitter"] .skin-tone:after {
  box-shadow: none;
  border-color: rgba(0, 0, 0, .5);
}

[data-emoji-set="twitter"] .skin-tone-1 {
  background-color: #fade72;
}

[data-emoji-set="twitter"] .skin-tone-2 {
  background-color: #f3dfd0;
}

[data-emoji-set="twitter"] .skin-tone-3 {
  background-color: #eed3a8;
}

[data-emoji-set="twitter"] .skin-tone-4 {
  background-color: #cfad8d;
}

[data-emoji-set="twitter"] .skin-tone-5 {
  background-color: #a8805d;
}

[data-emoji-set="twitter"] .skin-tone-6 {
  background-color: #765542;
}

[data-emoji-set="google"] .skin-tone:after {
  box-shadow: inset 0 0 2px 2px rgba(0, 0, 0, .4);
}

[data-emoji-set="google"] .skin-tone-1 {
  background-color: #f5c748;
}

[data-emoji-set="google"] .skin-tone-2 {
  background-color: #f1d5aa;
}

[data-emoji-set="google"] .skin-tone-3 {
  background-color: #d4b48d;
}

[data-emoji-set="google"] .skin-tone-4 {
  background-color: #aa876b;
}

[data-emoji-set="google"] .skin-tone-5 {
  background-color: #916544;
}

[data-emoji-set="google"] .skin-tone-6 {
  background-color: #61493f;
}

[data-emoji-set="facebook"] .skin-tone:after {
  border-color: rgba(0, 0, 0, .4);
  box-shadow: inset 0 -2px 3px #000, inset 0 1px 4px #fff;
}

[data-emoji-set="facebook"] .skin-tone-1 {
  background-color: #f5c748;
}

[data-emoji-set="facebook"] .skin-tone-2 {
  background-color: #f1d5aa;
}

[data-emoji-set="facebook"] .skin-tone-3 {
  background-color: #d4b48d;
}

[data-emoji-set="facebook"] .skin-tone-4 {
  background-color: #aa876b;
}

[data-emoji-set="facebook"] .skin-tone-5 {
  background-color: #916544;
}

[data-emoji-set="facebook"] .skin-tone-6 {
  background-color: #61493f;
}

`;function s2e(t){const e=$.useRef(null),n=$.useRef(null);return n.current&&n.current.update(t),$.useEffect(()=>(n.current=new G5({...t,ref:e}),()=>{n.current=null}),[]),At.createElement("div",{ref:e})}function o2e(t){var e=t.theme,n=t.onSelectEmoji,r=t.disableRecent,c=t.customEmojis,l=t.language,d=$.useMemo(function(){var m=[];return r||m.push("frequent"),m=[].concat(vre(m),["people","nature","foods","activity","places","objects","symbols","flags"]),m},[r]),f=$.useMemo(function(){if(l)return require("@emoji-mart/data/i18n/".concat(l??"en",".json"))},[l]);return At.createElement(s2e,{data:void 0,theme:e,previewPosition:"none",onEmojiSelect:n,custom:c,categories:d,set:"apple",i18n:f})}var a2e=$.memo(o2e);function mY(t){var e=t.showPicker,n=t.theme,r=t.handleSelectEmoji,c=t.disableRecent,l=t.customEmojis,d=t.position,f=t.language;return At.createElement("div",{className:"react-emoji-picker--container"},e&&At.createElement("div",{className:"react-emoji-picker--wrapper",onClick:function(E){return E.stopPropagation()},style:d==="below"?{top:"40px"}:{}},At.createElement("div",{className:"react-emoji-picker"},At.createElement(a2e,{theme:n,onSelectEmoji:r,disableRecent:c,customEmojis:l,language:f}))))}var c2e=435,l2e=function(e){var n=e.theme,r=e.keepOpened,c=e.disableRecent,l=e.customEmojis,d=e.addSanitizeFn,f=e.addPolluteFn,m=e.appendContent,E=e.buttonElement,y=e.buttonRef,w=e.language,I=$.useState(!1),P=Md(I,2),k=P[0],M=P[1],K=$.useState(),W=Md(K,2),V=W[0],G=W[1],Q=$.useState(),Z=Md(Q,2),Y=Z[0],oe=Z[1];$.useEffect(function(){d(KO)},[d]),$.useEffect(function(){f(Sre)},[f]),$.useEffect(function(){function je(Ge){var ze=Ge.target;ze.classList.contains("react-input-emoji--button")||ze.classList.contains("react-input-emoji--button--icon")||M(!1)}return document.addEventListener("click",je),function(){document.removeEventListener("click",je)}},[]);function ce(je){je.stopPropagation(),je.preventDefault(),oe(Se(je)),M(function(Ge){return!Ge})}function Se(je){var Ge=je.currentTarget,ze=Ge.getBoundingClientRect(),Ke=c2e;return ze.top>=Ke?"above":"below"}function xe(je){m(aMe(je)),r||M(function(Ge){return!Ge})}return $.useEffect(function(){var je;y!=null&&(je=y.current)!==null&&je!==void 0&&je.style?(y.current.style.position="relative",G(y.current)):E!=null&&E.style&&(E.style.position="relative",G(E))},[y,E]),V?Mm.createPortal(At.createElement(At.Fragment,null,At.createElement(mY,{showPicker:k,theme:n,handleSelectEmoji:xe,disableRecent:c,customEmojis:l,position:Y,language:w}),At.createElement(Gq,{showPicker:k,toggleShowPicker:ce,buttonElement:V,buttonRef:y})),V):At.createElement(At.Fragment,null,At.createElement(mY,{showPicker:k,theme:n,handleSelectEmoji:xe,disableRecent:c,customEmojis:l,position:Y,language:w}),At.createElement(Gq,{showPicker:k,toggleShowPicker:ce}))};function u2e(){var t=Xre();if(!t)return null;var e=t.text.substring(t.begin,t.end);return e||null}function d2e(){var t=Xre();t&&t.element.deleteData(t.begin,t.end-t.begin)}function Xre(){var t=$V();if(!t)return null;var e=t.element,n=t.caretOffset,r=e.textContent,c=r.lastIndexOf("@");return c===-1||c>=n||c!==0&&r[c-1]!==" "?null:{begin:c,end:n,text:r,element:e}}function $V(){var t=h2e();if(t===null)return null;var e=0;if(typeof window.getSelection<"u"){var n=window.getSelection().getRangeAt(0),r=n.cloneRange();r.selectNodeContents(t),r.setEnd(n.endContainer,n.endOffset),e=r.toString().length}else if(typeof document.selection<"u"&&document.selection.type!="Control"){var c=document.selection.createRange(),l=document.body.createTextRange();l.moveToElementText(t),l.setEndPoint("EndToEnd",c),e=l.text.length}return{element:t,caretOffset:e}}function h2e(){var t=document.getSelection().anchorNode;return(t==null?void 0:t.nodeType)==3?t:null}function f2e(t){var e,n=$.useState(!1),r=Md(n,2),c=r[0],l=r[1],d=$.useState([]),f=Md(d,2),m=f[0],E=f[1],y=$.useState(null),w=Md(y,2),I=w[0],P=w[1],k=$.useCallback(function(){d2e(),E([])},[]),M=$.useCallback(Hq(rT().mark(function V(){var G,Q;return rT().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:if(G=u2e(),P(G),G!==null){Y.next=6;break}E([]),Y.next=12;break;case 6:return l(!0),Y.next=9,t(G);case 9:Q=Y.sent,l(!1),E(Q);case 12:case"end":return Y.stop()}},V)})),[t]),K=$.useCallback(function(V){return(e=e||Hq(rT().mark(function G(Q){var Z,Y;return rT().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:if(typeof t=="function"){ce.next=2;break}return ce.abrupt("return");case 2:Q.key==="Backspace"&&(Z=$V())!==null&&Z!==void 0&&Z.element.parentElement.hasAttribute("data-mention-id")?(Y=$V(),Y.element.parentElement.remove()):["ArrowUp","ArrowDown","Esc","Escape"].includes(Q.key)||M();case 3:case"end":return ce.stop()}},G)}))).apply(this,arguments)},[M,t]),W=$.useCallback(function(){M()},[M]);return{mentionSearchText:I,mentionUsers:m,onKeyUp:K,onFocus:W,onSelectUser:k,loading:c}}var p2e=function(e,n){var r=e.users,c=e.mentionSearchText,l=e.onSelect,d=e.addEventListener,f=$.useState(0),m=Md(f,2),E=m[0],y=m[1];$.useImperativeHandle(n,function(){return{prevUser:function(){y(function(M){return M===0?0:M-1})},nextUser:function(){y(function(M){return M===r.length-1?r.length-1:M+1})}}}),$.useEffect(function(){y(0)},[r]);function w(k,M){return'<span class="react-input-emoji--mention--item--name__selected" data-testid="metion-selected-word">'.concat(k,"</span>").concat(M)}var I=$.useMemo(function(){var k=c?c.substring(1).toLocaleLowerCase():"";return r.map(function(M){var K=M.name;if(c&&c.length>1)if(M.name.toLowerCase().startsWith(k))K=w(M.name.substring(0,k.length),M.name.substring(k.length));else{var W=M.name.split(" ");K=W.map(function(V){return V.toLocaleLowerCase().startsWith(k)?w(V.substring(0,k.length),V.substring(k.length)):V}).join(" ")}return Bq(Bq({},M),{},{nameHtml:K})})},[c,r]);function P(k){return function(M){M.stopPropagation(),M.preventDefault(),l(k)}}return $.useEffect(function(){var k=d("enter",function(M){M.stopPropagation(),M.preventDefault(),l(I[E])});return function(){k()}},[d,l,E,I]),At.createElement("ul",{className:"react-input-emoji--mention--list","data-testid":"mention-user-list"},I.map(function(k,M){return At.createElement("li",{key:k.id},At.createElement("button",{type:"button",onClick:P(k),className:"react-input-emoji--mention--item".concat(E===M?" react-input-emoji--mention--item__selected":""),onMouseOver:function(){return y(M)}},At.createElement("img",{className:"react-input-emoji--mention--item--img",src:k.image}),At.createElement("div",{className:"react-input-emoji--mention--item--name",dangerouslySetInnerHTML:{__html:k.nameHtml}})))}))},m2e=$.forwardRef(p2e),g2e=function(e){var n=e.searchMention,r=e.addEventListener,c=e.appendContent,l=e.addSanitizeFn,d=$.useRef(null),f=$.useState(!1),m=Md(f,2),E=m[0],y=m[1],w=f2e(n),I=w.mentionSearchText,P=w.mentionUsers,k=w.loading,M=w.onKeyUp,K=w.onFocus,W=w.onSelectUser;$.useEffect(function(){l(function(G){var Q=document.createElement("div");Q.innerHTML=G;var Z=Array.prototype.slice.call(Q.querySelectorAll(".react-input-emoji--mention--text"));return Z.forEach(function(Y){Q.innerHTML=Q.innerHTML.replace(Y.outerHTML,"@[".concat(Y.dataset.mentionName,"](userId:").concat(Y.dataset.mentionId,")"))}),Q.innerHTML})},[l]),$.useEffect(function(){y(P.length>0)},[P]),$.useEffect(function(){function G(){y(!1)}return document.addEventListener("click",G),function(){document.removeEventListener("click",G)}},[]),$.useEffect(function(){var G=r("keyUp",M);return function(){G()}},[r,M]),$.useEffect(function(){function G(Z){switch(Z.key){case"Esc":case"Escape":y(!1);break}}var Q=r("keyDown",G);return function(){Q()}},[r]),$.useEffect(function(){var G=r("focus",K);return function(){G()}},[r,K]),$.useEffect(function(){if(E){var G=r("arrowUp",function(Z){Z.stopPropagation(),Z.preventDefault(),d.current.prevUser()}),Q=r("arrowDown",function(Z){Z.stopPropagation(),Z.preventDefault(),d.current.nextUser()});return function(){G(),Q()}}},[r,E]);function V(G){W(),c('<span class="react-input-emoji--mention--text" data-mention-id="'.concat(G.id,'" data-mention-name="').concat(G.name,'">@').concat(G.name,"</span> "))}return At.createElement(At.Fragment,null,k?At.createElement("div",{className:"react-input-emoji--mention--container"},At.createElement("div",{className:"react-input-emoji--mention--loading"},At.createElement("div",{className:"react-input-emoji--mention--loading--spinner"},"Loading..."))):E&&At.createElement("div",{className:"react-input-emoji--mention--container",onClick:function(Q){return Q.stopPropagation()}},At.createElement(m2e,{ref:d,mentionSearchText:I,users:P,onSelect:V,addEventListener:r})))};function _m(){var t=[];return{subscribe:function(n){return t.push(n),function(){t=t.filter(function(r){return r!==n})}},publish:function(n){t.forEach(function(r){return r(n)})},get currentListerners(){return t}}}function _2e(){var t=$.useMemo(function(){return{keyDown:_m(),keyUp:_m(),arrowUp:_m(),arrowDown:_m(),enter:_m(),focus:_m(),blur:_m()}},[]),e=$.useCallback(function(n,r){return t[n].subscribe(r)},[t]);return{addEventListener:e,listeners:t}}function E2e(){var t=$.useRef([]),e=$.useCallback(function(r){t.current.push(r)},[]),n=$.useCallback(function(r){var c=t.current.reduce(function(l,d){return d(l)},r);return c},[]);return{addPolluteFn:e,pollute:n}}function v2e(t,e){var n=t.onChange,r=t.onEnter,c=t.shouldReturn,l=t.onResize,d=t.onClick,f=t.onFocus,m=t.onBlur,E=t.onKeyDown,y=t.theme,w=t.cleanOnEnter,I=t.placeholder,P=t.maxLength,k=t.keepOpened,M=t.inputClass,K=t.disableRecent,W=t.tabIndex,V=t.value,G=t.customEmojis,Q=t.language,Z=t.searchMention,Y=t.buttonElement,oe=t.buttonRef,ce=t.borderRadius,Se=t.borderColor,xe=t.fontSize,je=t.fontFamily,Ge=$.useRef(null),ze=_2e(),Ke=ze.addEventListener,He=ze.listeners,be=wre(t.shouldReturn),Oe=be.addSanitizeFn,_e=be.sanitize,We=be.sanitizedTextRef,Ie=E2e(),De=Ie.addPolluteFn,Ue=Ie.pollute,rt=$.useCallback(function(){var Vt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";Ge.current!==null&&(Ge.current.html=Sre(Vt),We.current=Vt)},[We]),gt=$.useCallback(function(Vt){rt(Vt)},[rt]),ft=mMe(Ge,l,n);pMe({ref:e,setValue:gt,textInputRef:Ge,emitChange:ft}),$.useEffect(function(){We.current!==V&&gt(V)},[We,gt,V]),$.useEffect(function(){function Vt(En){if(typeof P<"u"&&En.key!=="Backspace"&&Ge.current!==null&&zq(Ge.current)>=P&&En.preventDefault(),En.key==="Enter"&&Ge.current){En.preventDefault();var Di=_e(Ge.current.html);return ft(We.current),typeof r=="function"&&He.enter.currentListerners.length===0&&r(Di),w&&He.enter.currentListerners.length===0&&rt(""),typeof E=="function"&&E(En.nativeEvent),!1}return typeof E=="function"&&E(En.nativeEvent),!0}var xn=Ke("keyDown",Vt);return function(){xn()}},[Ke,w,ft,He.enter.currentListerners.length,P,r,E,_e,We,rt]),$.useEffect(function(){function Vt(){typeof d=="function"&&d(),typeof f=="function"&&f()}var xn=Ke("focus",Vt);return function(){xn()}},[Ke,d,f]),$.useEffect(function(){function Vt(){typeof m=="function"&&m()}var xn=Ke("blur",Vt);return function(){xn()}},[Ke,m]);function Ft(Vt){_e(Vt),V!==We.current&&ft(We.current)}function qt(Vt){typeof P<"u"&&Ge.current!==null&&zq(Ge.current)>=P||Ge.current!==null&&Ge.current.appendContent(Vt)}function ti(Vt){Vt.preventDefault();var xn;Vt.clipboardData&&(xn=Vt.clipboardData.getData("text/plain"),xn=Ue(xn),document.execCommand("insertHTML",!1,xn))}return At.createElement("div",{className:"react-emoji"},At.createElement(g2e,{searchMention:Z,addEventListener:Ke,appendContent:qt,addSanitizeFn:Oe}),At.createElement(EMe,{ref:Ge,onCopy:cMe,onPaste:ti,shouldReturn:c,onBlur:He.blur.publish,onFocus:He.focus.publish,onArrowUp:He.arrowUp.publish,onArrowDown:He.arrowDown.publish,onKeyUp:He.keyUp.publish,onKeyDown:He.keyDown.publish,onEnter:He.enter.publish,placeholder:I,style:{borderRadius:ce,borderColor:Se,fontSize:xe,fontFamily:je},tabIndex:W,className:M,onChange:Ft}),At.createElement(l2e,{theme:y,keepOpened:k,disableRecent:K,customEmojis:G,addSanitizeFn:Oe,addPolluteFn:De,appendContent:qt,buttonElement:Y,buttonRef:oe,language:Q}))}var Jre=$.forwardRef(v2e);Jre.defaultProps={theme:"auto",height:30,placeholder:"Type a message",borderRadius:21,borderColor:"#EAEAEA",fontSize:15,fontFamily:"sans-serif",tabIndex:0,shouldReturn:!1,customEmojis:[],language:void 0};function Qre({chat:t,currentUser:e,setSendMessage:n,receivedMessage:r,setNotification:c}){const l=$.useRef(),d=$.useRef(),f=Ia(),m=bi(),[E,y]=$.useState(null),[w,I]=$.useState([]),[P,k]=$.useState(""),[M,K]=$.useState(!1),[W,V]=$.useState(""),[G,Q]=$.useState(null),[Z,Y]=$.useState(!1),[oe,ce]=$.useState(!1),Se=()=>{m({type:"SET_VIDEO_CALL",videoCall:{...E,type:"out-going",callType:"video"}})},xe=()=>{console.log("voice call"),m({type:"SET_VOICE_CALL",voiceCall:{...E,type:"out-going",callType:"voice"}})},je=Ie=>{k(Ie)};$.useEffect(()=>{var Ue;const Ie=(Ue=t==null?void 0:t.members)==null?void 0:Ue.find(rt=>rt!==e);t!==null&&(async()=>{try{const{data:rt}=await E5(Ie);y(rt)}catch(rt){console.log(rt)}})()},[t,e]),$.useEffect(()=>{t!==null&&(async()=>{try{const{data:De}=await DLe(t._id);I(De)}catch(De){console.log(De)}})()},[t]),$.useEffect(()=>{var Ie;(Ie=d.current)==null||Ie.scrollIntoView({behavior:"smooth"})},[w]);const Ge=async Ie=>{if(console.log("send message"),Ie.preventDefault(),!P)return;const De={senderId:e,text:P,chatId:t._id},Ue=t.members.find(gt=>gt!==e);c({senderId:e,receiverId:Ue,text:"sent you a message",description:P}),n({...De,receiverId:Ue});try{const{data:gt}=await jq(De);I([...w,gt]),k("")}catch{console.log("error")}};$.useEffect(()=>{r!==null&&r.chatId===t._id&&I([...w,r])},[r]);const ze=()=>Y(!0),Ke=()=>{Y(!1)},He=()=>{l.current.value=null,l.current.click()},be=Ie=>{if(Ie.target.files&&Ie.target.files[0]){let De=Ie.target.files[0];console.log(De,"image");const Ue=De.name.split(".").pop().toLowerCase();if(["jpg","jpeg","png"].includes(Ue))Q({name:De.name,url:URL.createObjectURL(De),file:De}),ze();else return Q(null),fe.error(R.jsx("b",{children:"Invalid file type. Please select a JPG, JPEG, or PNG image."}))}},Oe=async Ie=>{if(console.log("just loging upload"),Ie.preventDefault(),!G)return fe.error(R.jsx("b",{children:"Please Provide an Image...!"}));const De=new FormData;De.append("file",G.file);try{const Ue=fe.loading(R.jsx("b",{children:"sharing...!"}));ce(!0);const rt=await $ie(De);if(rt&&rt.data.url){fe.dismiss(Ue);const gt={senderId:e,media:rt.data.url,chatId:t._id},ft=t.members.find(qt=>qt!==e);c({senderId:e,receiverId:ft,text:"sent you a message",description:"Image"}),n({...gt,receiverId:ft});try{const{data:qt}=await jq(gt);ce(!1),I([...w,qt]),Ke()}catch(qt){console.log("Error sending media message:",qt)}}}catch(Ue){Ke(),ce(!1),console.log(Ue)}},_e=Ie=>{V(Ie),K(!0)},We=()=>{V(""),K(!1)};return R.jsxs(R.Fragment,{children:[R.jsx(ku,{position:"top-center",reverseOrder:!1}),R.jsx("div",{className:"ChatBox-container",children:t?R.jsxs(R.Fragment,{children:[R.jsxs(dn.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{duration:.5},className:"chat-header",children:[R.jsxs("div",{className:"d-flex justify-content-between",children:[R.jsxs("div",{className:"follower",children:[R.jsx("img",{src:(E==null?void 0:E.profileimage)||Gr,alt:"Profile",className:"followerImage",style:{width:"50px",height:"50px",borderRadius:"50%"}}),R.jsx("div",{className:"name",style:{fontSize:"0.9rem"},onClick:()=>f(`/profile/${E._id}`),children:R.jsx("span",{children:E==null?void 0:E.username})})]}),R.jsxs("div",{className:"d-flex gap-3 px-2",children:[R.jsx(dn.img,{whileHover:{scale:1.2},whileTap:{scale:.9},transition:{type:"spring",stiffness:400,damping:17},className:"vedio-icon",src:$Le,alt:"video icon",onClick:Se}),R.jsx(dn.img,{whileHover:{scale:1.2},whileTap:{scale:.9},transition:{type:"spring",stiffness:400,damping:17},className:"call-icon",src:zLe,alt:"video icon",onClick:xe})]})]}),R.jsx("hr",{style:{width:"100%",border:"0.1px solid #c0c0c0",marginTop:"20px"}})]}),M&&R.jsxs("div",{className:"image-modal",children:[R.jsx(dn.img,{className:"imageView",initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},transition:{duration:.8,ease:[0,.71,.2,1.01]},src:W,alt:"Selected Media"}),R.jsx("img",{className:"close",src:HLe,onClick:()=>We()})]}),R.jsx("div",{className:"chat-body",children:w.map((Ie,De)=>R.jsxs(dn.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{duration:.5},ref:d,className:Ie.senderId===e?"message own":"message",children:[Ie.text&&R.jsx("span",{children:Ie.text}),Ie.media&&R.jsx("div",{className:"message-media",onClick:()=>_e(Ie.media),children:R.jsx("img",{src:Ie.media,alt:"Media"})}),R.jsx("span",{children:MV(Ie.createdAt)})]},De))}),R.jsxs(dn.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{duration:.5},className:"chat-sender",children:[R.jsx(dn.img,{whileHover:{scale:1.2},whileTap:{scale:.9},transition:{type:"spring",stiffness:400,damping:17},src:WLe,onClick:He}),R.jsx(Jre,{value:P,onChange:je}),R.jsx(dn.img,{whileHover:{scale:1.2},whileTap:{scale:.9},transition:{type:"spring",stiffness:400,damping:17},src:BLe,onClick:Ge}),R.jsx("input",{type:"file",style:{display:"none"},ref:l,onChange:be})]})]}):R.jsx("span",{className:"chatbox-empty-message",children:"Tap on a chat to start conversation..."})}),R.jsx(ln,{show:Z,onHide:Ke,backdrop:"static",children:R.jsxs(ln.Body,{children:[R.jsx("img",{className:"media-share",src:G==null?void 0:G.url,alt:"checking share media"}),R.jsxs("div",{className:"d-flex flex-row-reverse pt-3 px-2 gap-2",children:[R.jsx("button",{className:"button modaButton px-3",onClick:Oe,disabled:oe,children:"Share"}),R.jsx("button",{onClick:Ke,className:"button modaButton px-3 py-1",disabled:oe,children:"Cancel"})]})]})})]})}Qre.propTypes={chat:Le.object,currentUser:Le.string.isRequired,setSendMessage:Le.func.isRequired,receivedMessage:Le.object,socket:Le.object,setNotification:Le.func.isRequired};const Zre="/assets/icon-flatAccept-1bde1c28.svg",K5="/assets/icon-flatCancel-98116576.svg";var ese={},nN=Gt&&Gt.__assign||function(){return nN=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&(t[c]=e[c])}return t},nN.apply(this,arguments)},y2e=Gt&&Gt.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n);var c=Object.getOwnPropertyDescriptor(e,n);(!c||("get"in c?!e.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,c)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),S2e=Gt&&Gt.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),T2e=Gt&&Gt.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)n!=="default"&&Object.prototype.hasOwnProperty.call(t,n)&&y2e(e,t,n);return S2e(e,t),e},b2e=Gt&&Gt.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,r=Object.getOwnPropertySymbols(t);c<r.length;c++)e.indexOf(r[c])<0&&Object.prototype.propertyIsEnumerable.call(t,r[c])&&(n[r[c]]=t[r[c]]);return n};Object.defineProperty(ese,"__esModule",{value:!0});var iO=T2e($),hF=$d,w2e=Sg,C2e=(0,w2e.createAnimation)("PulseLoader","0% {transform: scale(1); opacity: 1} 45% {transform: scale(0.1); opacity: 0.7} 80% {transform: scale(1); opacity: 1}","pulse");function R2e(t){var e=t.loading,n=e===void 0?!0:e,r=t.color,c=r===void 0?"#000000":r,l=t.speedMultiplier,d=l===void 0?1:l,f=t.cssOverride,m=f===void 0?{}:f,E=t.size,y=E===void 0?15:E,w=t.margin,I=w===void 0?2:w,P=b2e(t,["loading","color","speedMultiplier","cssOverride","size","margin"]),k=nN({display:"inherit"},m),M=function(K){return{backgroundColor:c,width:(0,hF.cssValue)(y),height:(0,hF.cssValue)(y),margin:(0,hF.cssValue)(I),borderRadius:"100%",display:"inline-block",animation:"".concat(C2e," ").concat(.75/d,"s ").concat(K*.12/d,"s infinite cubic-bezier(0.2, 0.68, 0.18, 1.08)"),animationFillMode:"both"}};return n?iO.createElement("span",nN({style:k},P),iO.createElement("span",{style:M(1)}),iO.createElement("span",{style:M(2)}),iO.createElement("span",{style:M(3)})):null}var q5=ese.default=R2e;function tse({data:t,socket:e}){const n=bi(),{incomingVideoCall:r}=Si(d=>d.chatReducer),c=()=>{n({type:"SET_VIDEO_CALL",videoCall:{...r,type:"in-coming"}}),e.emit("accept-incoming-call",{id:r.id}),n({type:"SET_INCOMING_VIDEO_CALL",incomingVideoCall:void 0})},l=()=>{e.emit("reject-video-call",{from:r.id}),n({type:"END_CALL"})};return R.jsxs("div",{className:"incoming d",children:[R.jsxs("div",{className:"d-flex flex-row",children:[R.jsx("img",{className:"inc-profile",src:t==null?void 0:t.profileimage,alt:"profile"}),R.jsxs("div",{className:"d-flex flex-column",children:[R.jsx("span",{className:"text-white",children:t==null?void 0:t.username}),R.jsxs("span",{className:"text-black position-relative d-flex flex-row align-items-baseline gap-1",children:["Incoming ",R.jsx(q5,{color:"#00000",margin:7,size:5,speedMultiplier:.6})]})]})]}),R.jsxs("div",{className:"d-flex flex-row gap-3",children:[R.jsx(dn.img,{whileHover:{scale:1.1},whileTap:{scale:.9},transition:{type:"spring",stiffness:400,damping:17},className:"icons",src:Zre,alt:"accept",onClick:c}),R.jsx(dn.img,{whileHover:{scale:1.1},whileTap:{scale:.9},transition:{type:"spring",stiffness:400,damping:17},className:"icons",src:K5,alt:"accept",onClick:l})]})]})}tse.propTypes={data:Le.shape({profileimage:Le.string,username:Le.string}).isRequired,socket:Le.object};function nse({data:t,socket:e}){const n=bi(),{incomingVoiceCall:r}=Si(d=>d.chatReducer),c=()=>{n({type:"SET_VOICE_CALL",voiceCall:{...r,type:"in-coming"}}),e.emit("accept-incoming-call",{id:r.id}),n({type:"SET_INCOMING_VOICE_CALL",incomingVoiceCall:void 0})},l=()=>{e.emit("reject-voice-call",{from:r.id}),n({type:"END_CALL"})};return R.jsxs("div",{className:"incoming d",children:[R.jsxs("div",{className:"d-flex flex-row",children:[R.jsx("img",{className:"inc-profile",src:t==null?void 0:t.profileimage,alt:"profile"}),R.jsxs("div",{className:"d-flex flex-column",children:[R.jsx("span",{className:"text-white",children:t==null?void 0:t.username}),R.jsxs("span",{className:"text-black position-relative d-flex flex-row align-items-baseline gap-1",children:["Incoming ",R.jsx(q5,{color:"#00000",margin:7,size:5,speedMultiplier:.6})]})]})]}),R.jsxs("div",{className:"d-flex flex-row gap-3",children:[R.jsx(dn.img,{whileHover:{scale:1.1},whileTap:{scale:.9},transition:{type:"spring",stiffness:400,damping:17},className:"icons",src:Zre,alt:"accept",onClick:c}),R.jsx(dn.img,{whileHover:{scale:1.1},whileTap:{scale:.9},transition:{type:"spring",stiffness:400,damping:17},className:"icons",src:K5,alt:"accept",onClick:l})]})]})}nse.propTypes={data:Le.shape({profileimage:Le.string,username:Le.string}).isRequired,socket:Le.object};const I2e="/assets/icon-flatMute-3124b632.svg",A2e="/assets/icon-flatMuteVd-1b7e08fb.svg";function zV({data:t,socket:e}){const n=bi(),{videoCall:r,voiceCall:c}=Si(k=>k.chatReducer),[l,d]=$.useState(!1),[f,m]=$.useState(!1),[E,y]=$.useState(!1),w=$.useRef(l);$.useEffect(()=>{w.current=l},[l]),$.useEffect(()=>{if(r||c){const k=(r==null?void 0:r.callType)||(c==null?void 0:c.callType);RLe(k),setTimeout(()=>{w.current||I()},17e3)}return()=>{kV()}},[r,c]),$.useEffect(()=>{(t==null?void 0:t.type)==="out-going"?e.on("accept-call",()=>{d(!0)}):d(!0)},[t]);const I=()=>{kV(),(t==null?void 0:t.callType)==="voice"?e.emit("reject-voice-call",{from:t._id||t.id}):(console.log(t),e.emit("reject-video-call",{from:t._id||t.id})),n({type:"END_CALL"})},P=k=>{k==="video"&&NLe(f),k==="audio"&&PLe(E)};return R.jsx("div",{className:"image-modal",children:R.jsxs("div",{className:"d-flex h-100 flex-column justify-content-around align-items-center",children:[R.jsxs("div",{className:"align-items-center d-flex flex-column gap-3",children:[R.jsx("h1",{className:"text-white",children:t==null?void 0:t.username}),!l&&R.jsx("img",{className:"profile-img",src:t==null?void 0:t.profileimage,alt:"profile"}),R.jsxs("span",{className:"text-white position-relative d-flex flex-row align-items-baseline gap-1",children:[l?"Ongoing call":"Calling",!l&&R.jsx(q5,{color:"#ffffff",margin:7,size:7,speedMultiplier:.6})]})]}),R.jsxs("div",{className:"d-flex gap-5",children:[l&&(r==null?void 0:r.callType)=="video"&&R.jsx("div",{className:`rounded-circle ${f?"active":null}`,children:R.jsx(dn.img,{whileHover:{scale:1.1},whileTap:{scale:.9},transition:{type:"spring",stiffness:400,damping:17},onClick:()=>{m(k=>!k),P("video")},className:"action-icon",src:A2e,alt:"mute-video"})}),R.jsx(dn.img,{whileHover:{scale:1.1},whileTap:{scale:.9},transition:{type:"spring",stiffness:400,damping:17},className:"cancel",onClick:I,src:K5,alt:"cancel"}),l&&R.jsx("div",{className:`rounded-circle ${E?"active":null}`,children:R.jsx(dn.img,{whileHover:{scale:1.1},whileTap:{scale:.9},transition:{type:"spring",stiffness:400,damping:17},onClick:()=>{y(k=>!k),P("audio")},className:"action-icon",src:I2e,alt:"mute"})})]}),R.jsx("div",{className:"remoteVideo bg-dark",id:"remote-video"}),R.jsx("div",{className:`bg-dark ${l?"localVideo":"remoteVideo"}`,id:"local-video"})]})})}zV.propTypes={data:Le.shape({type:Le.string,username:Le.string,profileimage:Le.string,callType:Le.string,_id:Le.string,id:Le.string}),socket:Le.object};const O2e="/assets/ringtone-640ccca1.mp3";function ise({socket:t}){const{user:e}=Si(Z=>Z.authReducer.authData),{currentChatUser:n,videoCall:r,voiceCall:c,onlineUsers:l,incomingVideoCall:d,incomingVoiceCall:f}=Si(Z=>Z.chatReducer),m=$.useRef(),E=bi(),[y,w]=$.useState([]),[I,P]=$.useState(null),[k,M]=$.useState(null),[K,W]=$.useState(null),[V,G]=$.useState(null);$.useEffect(()=>{const Z=async()=>{try{const{data:Y}=await bLe(e._id);w(Y)}catch(Y){console.log(Y),Y.response.data.error=="Token has expired"&&E(Bi())}};n?(async()=>{try{const oe={senderId:e._id,receiverId:n},{data:ce}=await TLe(oe);P(ce),Z()}catch(oe){console.log(oe),oe.response.data.error=="Token has expired"&&E(Bi())}})():Z()},[n,e._id]),$.useEffect(()=>{t.on("get-users",Z=>{E({type:"SET_ONLINE_USERS",data:Z})}),t.on("incoming-video-call",({from:Z,roomId:Y,callType:oe})=>{E({type:"SET_INCOMING_VIDEO_CALL",incomingVideoCall:{...Z,roomId:Y,callType:oe}})}),t.on("incoming-voice-call",({from:Z,roomId:Y,callType:oe})=>{E({type:"SET_INCOMING_VOICE_CALL",incomingVoiceCall:{...Z,roomId:Y,callType:oe}})}),t.on("video-call-rejected",()=>{kV(),E({type:"END_CALL"})}),t.on("voice-call-rejected",()=>{E({type:"END_CALL"})}),t.on("recieve-message",Z=>{G(Z),w(Y=>{const oe=Y.findIndex(ce=>ce._id===Z.chatId);if(oe!==-1){const ce=[...Y];return ce[oe].lastMessage=Z,ce}return Y})})},[e]),$.useEffect(()=>{k!==null&&(ng(K).then(({data:Z})=>{t.emit("get-notification",{to:Z.receiverId||K.receiverId,from:{id:e._id,profileimage:e.profileimage,username:e.username},text:Z.text||K.text,description:Z.description||K.description})}),t.emit("send-message",k),w(Z=>{const Y=Z.findIndex(oe=>oe._id===k.chatId);if(Y!==-1){const oe=[...Z];return oe[Y].lastMessage=k,oe}return Z}))},[k]),$.useEffect(()=>{c&&(c==null?void 0:c.type)=="out-going"&&t.emit("outgoing-voice-call",{to:c==null?void 0:c._id,from:{id:e._id,profileimage:e.profileimage,username:e.username},callType:c==null?void 0:c.callType,roomID:c==null?void 0:c.roomID})},[c]);const Q=Z=>{const Y=Z.members.find(ce=>ce!==e._id);return!!l.find(ce=>ce.userId===Y)};return $.useEffect(()=>{r&&(r==null?void 0:r.type)=="out-going"&&(console.log("helooo"),t.emit("outgoing-video-call",{to:r==null?void 0:r._id,from:{id:e._id,profileimage:e.profileimage,username:e.username},callType:r==null?void 0:r.callType,roomID:r==null?void 0:r.roomID}))},[r]),$.useEffect(()=>{let Z;return d||f?(m.current.currentTime=0,m.current.play(),Z=setInterval(()=>{m.current.currentTime=0,m.current.play()},8e3)):(clearInterval(Z),m.current.pause()),()=>clearInterval(Z)},[d,f]),R.jsxs(R.Fragment,{children:[R.jsx("audio",{ref:m,style:{display:"none"},children:R.jsx("source",{src:O2e,type:"audio/mp3"})}),R.jsxs(dn.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5},className:"Chat",children:[R.jsx("div",{className:"Left-side-chat",children:R.jsx("div",{className:"Chat-container",children:R.jsx("div",{className:"Chat-list",children:y==null?void 0:y.map(Z=>R.jsx(dn.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5},onClick:()=>{P(Z);const Y=Z.members.find(oe=>oe!==e._id);E({type:"CURRENT_CHAT_USER",data:Y})},children:R.jsx(gre,{data:Z,currentUser:e._id,online:Q(Z),socket:t})},Z._id))})})}),R.jsxs(dn.div,{className:"Right-side-chat",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5},children:[d&&R.jsx(tse,{data:d,socket:t}),f&&R.jsx(nse,{data:f,socket:t}),r&&R.jsx(zV,{data:r,socket:t}),c&&R.jsx(zV,{data:c,socket:t}),R.jsx(Qre,{chat:I,currentUser:e._id,setSendMessage:M,receivedMessage:V,setNotification:W,socket:t})]})]})]})}ise.propTypes={socket:Le.object};const N2e="/assets/icon-flatBellIcon-e637d2b7.svg",P2e="/assets/pristine-609-f146ac08.mp3",rse=({notifications:t,setShowModal:e,showModal:n,user:r,length:c})=>{const l=()=>{e(!1)};return $.useEffect(()=>{n&&(sNe(r==null?void 0:r._id).catch(d=>console.log(d)),c(0))},[n]),R.jsx(ln,{show:n,onHide:l,children:R.jsxs(ln.Body,{style:{overflow:"scroll",maxHeight:"14rem"},children:[R.jsx("h3",{className:"lg-text",children:"Notifications"}),R.jsxs("div",{className:"d-flex flex-column",children:[t==null?void 0:t.map(d=>{var f,m;return R.jsxs("div",{className:"d-flex py-2",style:{borderBottom:"1px solid white"},children:[R.jsx("img",{className:"rounded-circle",src:((f=d==null?void 0:d.senderId)==null?void 0:f.profileimage)||Gr,style:{width:"2.8rem",height:"2.8rem"},alt:""}),R.jsxs("div",{className:"d-flex flex-column align-items-start px-2",children:[R.jsx("b",{className:"text-white",style:{fontSize:"12px"},children:(m=d==null?void 0:d.senderId)==null?void 0:m.username}),R.jsx("span",{className:"text-white text-nowrap",style:{fontSize:"14px"},children:d==null?void 0:d.text}),R.jsx("span",{style:{color:"#828282",fontSize:"11px"},children:MV(d==null?void 0:d.createdAt)})]}),(d==null?void 0:d.url)&&R.jsx("img",{className:"rounded",src:(d==null?void 0:d.url)||Gr,style:{width:"3rem",height:"3rem"},alt:""})]},d==null?void 0:d._id)}),t==null?void 0:t.map(d=>{var f,m;return R.jsxs("div",{className:"d-flex py-2",style:{borderBottom:"1px solid white"},children:[R.jsx("img",{className:"rounded-circle",src:((f=d==null?void 0:d.senderId)==null?void 0:f.profileimage)||Gr,style:{width:"2.8rem",height:"2.8rem"},alt:""}),R.jsxs("div",{className:"d-flex flex-column align-items-start px-2",children:[R.jsx("b",{className:"text-white",style:{fontSize:"12px"},children:(m=d==null?void 0:d.senderId)==null?void 0:m.username}),R.jsx("span",{className:"text-white text-nowrap",style:{fontSize:"14px"},children:d==null?void 0:d.text}),R.jsx("span",{style:{color:"#828282",fontSize:"11px"},children:MV(d==null?void 0:d.createdAt)})]}),(d==null?void 0:d.url)&&R.jsx("img",{className:"rounded",src:(d==null?void 0:d.url)||Gr,style:{width:"3rem",height:"3rem"},alt:""})]},d==null?void 0:d._id)}),(t==null?void 0:t.length)==0&&R.jsx("span",{className:"text-white",children:"No new notification!"})]})]})})};rse.propTypes={notifications:Le.array.isRequired,setShowModal:Le.func.isRequired,showModal:Le.bool.isRequired,user:Le.object.isRequired,length:Le.func.isRequired};const Am=({location:t})=>{const e=bi(),n=$.useRef(),{user:r}=Si(M=>M.authReducer.authData),c=$.useRef(null),[l,d]=$.useState(window.innerWidth>=930),[f,m]=$.useState(window.innerWidth<=450),[E,y]=$.useState([]),[w,I]=$.useState(0),[P,k]=$.useState(!1);return $.useEffect(()=>{E5(r._id).then(({data:M})=>{M.isblocked&&e(Bi())}).catch(M=>{console.log(M),M.response.data.error=="Token has expired"&&e(Bi())})},[t,r,e]),$.useEffect(()=>(_a.emit("new-user-add",{userId:r._id}),_a.on("get-users",M=>{e({type:"SET_ONLINE_USERS",data:M})}),e({type:"SET_PEER_ID",id:r._id}),_a.emit("new-user-add",{userId:r._id}),_a.on("get-users",M=>{e({type:"SET_ONLINE_USERS",data:M})}),()=>{_a.off("new-user-add"),_a.off("get-users")}),[]),$.useEffect(()=>{P||YK(r._id).then(({data:M})=>{I(M==null?void 0:M.length),y(M)}),_a.on("recieve-notification",M=>{console.log(M,"recieved notification"),n.current.play(),YK(r._id).then(({data:K})=>{I(K==null?void 0:K.length),y(K)})})},[r,P]),$.useEffect(()=>{const M=()=>{d(window.innerWidth>=930),m(window.innerWidth<=450)};return window.addEventListener("resize",M),()=>{window.removeEventListener("resize",M)}},[]),R.jsxs("div",{className:"Home",ref:c,children:[R.jsx("audio",{ref:n,style:{display:"none"},children:R.jsx("source",{src:P2e,type:"audio/mp3"})}),R.jsx(rse,{notifications:E,showModal:P,setShowModal:k,user:r,length:I}),R.jsxs(dn.div,{drag:!0,dragConstraints:c,initial:{top:"3vh",right:"3vh"},className:"item",children:[R.jsx("span",{className:"badge",children:w||0}),R.jsx(dn.img,{onClick:()=>k(!0),className:"w-100",src:N2e})]}),f?R.jsx(vLe,{}):R.jsx(ELe,{}),l&&t=="home"&&R.jsx(hre,{location:t}),t==="chat"&&R.jsx(ise,{socket:_a}),t==="home"&&R.jsx(aLe,{}),t==="explore"&&R.jsx(yLe,{}),t==="saved"&&R.jsx(SLe,{}),t==="profile"&&R.jsx(dn.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5},children:R.jsxs("div",{className:"d-flex flex-row gap-4",children:[R.jsx(H5,{location:t}),l&&R.jsx(ure,{})]})})]})};Am.propTypes={location:Le.string.isRequired};const gY=[{link:"/admin",section:"admin",icon:R.jsx("i",{className:"bx bx-home-alt"}),text:"Dashboard"},{link:"/admin/users",section:"users",icon:R.jsx("i",{className:"bx bx-user"}),text:"Users"},{link:"/admin/reports",section:"reports",icon:R.jsx("i",{className:"bx bx-receipt"}),text:"Reports"}],x2e=()=>{const t=qd(),e=bi(),n=Ia(),[r,c]=$.useState(0);$.useEffect(()=>{const f=window.location.pathname.split("/admin/")[1],m=gY.findIndex(E=>E.section===f);c(m===-1?0:m)},[t]);const l=()=>{document.querySelector(".main__content").style.transform="scale(1) translateX(0)",setTimeout(()=>{document.body.classList.remove("sidebar-open"),document.querySelector(".main__content").style=""},500)},d=async()=>{await e(tee()),n("/admin/auth")};return R.jsxs("div",{className:"adminsidebar",children:[R.jsxs("div",{className:"logo",children:[R.jsx("img",{src:fre,alt:""}),R.jsx("div",{className:"sidebar-close",onClick:l,children:R.jsx("i",{className:"bx bx-x"})})]}),R.jsxs("div",{className:"adminmenu",children:[gY.map((f,m)=>R.jsxs(df,{to:f.link,className:`adminitem ${r===m&&"active"}`,onClick:l,children:[R.jsx("div",{className:"adminicon",children:f.icon}),R.jsx("div",{className:"adminsidebar__menu__item__txt",children:f.text})]},`nav-${m}`)),R.jsxs("div",{className:"adminitem",children:[R.jsx("div",{className:"adminicon",children:R.jsx("i",{className:"bx bx-log-out"})}),R.jsx("div",{className:"adminsidebar__menu__item__txt",onClick:d,children:"Logout"})]})]})]})},D2e="/assets/icon-flatAdmin-be5817ac.svg",k2e=()=>R.jsxs("div",{className:"user-info",children:[R.jsx("div",{className:"user-info__img",children:R.jsx("img",{src:D2e,alt:""})}),R.jsx("div",{className:"user-info__name",children:R.jsx("span",{children:"Hensal Deon"})})]}),L2e=()=>{const t=()=>{document.body.classList.add("sidebar-open")};return R.jsxs("div",{className:"topnav",children:[R.jsx(k2e,{}),R.jsx("div",{className:"sidebar-toggle",onClick:t,children:R.jsx("i",{className:"bx bx-menu-alt-right"})})]})},M2e=()=>R.jsxs("div",{className:"body",children:[R.jsx(x2e,{}),R.jsx("div",{className:"main",children:R.jsxs("div",{className:"main__content",children:[R.jsx(L2e,{}),R.jsx(aSe,{})]})})]});function fF(){return R.jsx("div",{children:"nothing"})}const WP=t=>{const e={box:"box",purple:t.purple&&"box-purple",fullheight:t.fullheight&&"box-fullheight"};return R.jsx("div",{className:Object.values(e).join(" "),children:t.children})};WP.propTypes={purple:Le.bool,fullheight:Le.bool,children:Le.node};/*!
 * Chart.js v3.7.0
 * https://www.chartjs.org
 * (c) 2021 Chart.js Contributors
 * Released under the MIT License
 */const sse=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function ose(t,e,n){const r=n||(d=>Array.prototype.slice.call(d));let c=!1,l=[];return function(...d){l=r(d),c||(c=!0,sse.call(window,()=>{c=!1,t.apply(e,l)}))}}function U2e(t,e){let n;return function(...r){return e?(clearTimeout(n),n=setTimeout(t,e,r)):t.apply(this,r),e}}const Y5=t=>t==="start"?"left":t==="end"?"right":"center",So=(t,e,n)=>t==="start"?e:t==="end"?n:(e+n)/2,j2e=(t,e,n,r)=>t===(r?"left":"right")?n:t==="center"?(e+n)/2:e;function vd(){}const F2e=function(){let t=0;return function(){return t++}}();function vi(t){return t===null||typeof t>"u"}function cr(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.substr(0,7)==="[object"&&e.substr(-6)==="Array]"}function oi(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}const qs=t=>(typeof t=="number"||t instanceof Number)&&isFinite(+t);function Ac(t,e){return qs(t)?t:e}function An(t,e){return typeof t>"u"?e:t}const V2e=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:t/e,ase=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function Xi(t,e,n){if(t&&typeof t.call=="function")return t.apply(n,e)}function Ei(t,e,n,r){let c,l,d;if(cr(t))if(l=t.length,r)for(c=l-1;c>=0;c--)e.call(n,t[c],c);else for(c=0;c<l;c++)e.call(n,t[c],c);else if(oi(t))for(d=Object.keys(t),l=d.length,c=0;c<l;c++)e.call(n,t[d[c]],d[c])}function iN(t,e){let n,r,c,l;if(!t||!e||t.length!==e.length)return!1;for(n=0,r=t.length;n<r;++n)if(c=t[n],l=e[n],c.datasetIndex!==l.datasetIndex||c.index!==l.index)return!1;return!0}function rN(t){if(cr(t))return t.map(rN);if(oi(t)){const e=Object.create(null),n=Object.keys(t),r=n.length;let c=0;for(;c<r;++c)e[n[c]]=rN(t[n[c]]);return e}return t}function cse(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function B2e(t,e,n,r){if(!cse(t))return;const c=e[t],l=n[t];oi(c)&&oi(l)?lb(c,l,r):e[t]=rN(l)}function lb(t,e,n){const r=cr(e)?e:[e],c=r.length;if(!oi(t))return t;n=n||{};const l=n.merger||B2e;for(let d=0;d<c;++d){if(e=r[d],!oi(e))continue;const f=Object.keys(e);for(let m=0,E=f.length;m<E;++m)l(f[m],t,e,n)}return t}function RT(t,e){return lb(t,e,{merger:W2e})}function W2e(t,e,n){if(!cse(t))return;const r=e[t],c=n[t];oi(r)&&oi(c)?RT(r,c):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=rN(c))}const H2e="",$2e=".";function _Y(t,e){const n=t.indexOf($2e,e);return n===-1?t.length:n}function rg(t,e){if(e===H2e)return t;let n=0,r=_Y(e,n);for(;t&&r>n;)t=t[e.substr(n,r-n)],n=r+1,r=_Y(e,n);return t}function X5(t){return t.charAt(0).toUpperCase()+t.slice(1)}const Fc=t=>typeof t<"u",Gf=t=>typeof t=="function",EY=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function z2e(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const br=Math.PI,Qi=2*br,G2e=Qi+br,sN=Number.POSITIVE_INFINITY,K2e=br/180,Lr=br/2,$S=br/4,vY=br*2/3,xc=Math.log10,Cu=Math.sign;function yY(t){const e=Math.round(t);t=IT(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(xc(t))),r=t/n;return(r<=1?1:r<=2?2:r<=5?5:10)*n}function q2e(t){const e=[],n=Math.sqrt(t);let r;for(r=1;r<n;r++)t%r===0&&(e.push(r),e.push(t/r));return n===(n|0)&&e.push(n),e.sort((c,l)=>c-l).pop(),e}function ub(t){return!isNaN(parseFloat(t))&&isFinite(t)}function IT(t,e,n){return Math.abs(t-e)<n}function Y2e(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function lse(t,e,n){let r,c,l;for(r=0,c=t.length;r<c;r++)l=t[r][n],isNaN(l)||(e.min=Math.min(e.min,l),e.max=Math.max(e.max,l))}function yl(t){return t*(br/180)}function J5(t){return t*(180/br)}function SY(t){if(!qs(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function use(t,e){const n=e.x-t.x,r=e.y-t.y,c=Math.sqrt(n*n+r*r);let l=Math.atan2(r,n);return l<-.5*br&&(l+=Qi),{angle:l,distance:c}}function GV(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function X2e(t,e){return(t-e+G2e)%Qi-br}function ml(t){return(t%Qi+Qi)%Qi}function db(t,e,n,r){const c=ml(t),l=ml(e),d=ml(n),f=ml(l-c),m=ml(d-c),E=ml(c-l),y=ml(c-d);return c===l||c===d||r&&l===d||f>m&&E<y}function wo(t,e,n){return Math.max(e,Math.min(n,t))}function J2e(t){return wo(t,-32768,32767)}function bf(t,e,n,r=1e-6){return t>=Math.min(e,n)-r&&t<=Math.max(e,n)+r}const rO=t=>t===0||t===1,TY=(t,e,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*Qi/n)),bY=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*Qi/n)+1,AT={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*Lr)+1,easeOutSine:t=>Math.sin(t*Lr),easeInOutSine:t=>-.5*(Math.cos(br*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>rO(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>rO(t)?t:TY(t,.075,.3),easeOutElastic:t=>rO(t)?t:bY(t,.075,.3),easeInOutElastic(t){return rO(t)?t:t<.5?.5*TY(t*2,.1125,.45):.5+.5*bY(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-AT.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?AT.easeInBounce(t*2)*.5:AT.easeOutBounce(t*2-1)*.5+.5};/*!
 * @kurkle/color v0.1.9
 * https://github.com/kurkle/color#readme
 * (c) 2020 Jukka Kurkela
 * Released under the MIT License
 */const Rc={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},KV="0123456789ABCDEF",Q2e=t=>KV[t&15],Z2e=t=>KV[(t&240)>>4]+KV[t&15],sO=t=>(t&240)>>4===(t&15);function eUe(t){return sO(t.r)&&sO(t.g)&&sO(t.b)&&sO(t.a)}function tUe(t){var e=t.length,n;return t[0]==="#"&&(e===4||e===5?n={r:255&Rc[t[1]]*17,g:255&Rc[t[2]]*17,b:255&Rc[t[3]]*17,a:e===5?Rc[t[4]]*17:255}:(e===7||e===9)&&(n={r:Rc[t[1]]<<4|Rc[t[2]],g:Rc[t[3]]<<4|Rc[t[4]],b:Rc[t[5]]<<4|Rc[t[6]],a:e===9?Rc[t[7]]<<4|Rc[t[8]]:255})),n}function nUe(t){var e=eUe(t)?Q2e:Z2e;return t&&"#"+e(t.r)+e(t.g)+e(t.b)+(t.a<255?e(t.a):"")}function zb(t){return t+.5|0}const HP=(t,e,n)=>Math.max(Math.min(t,n),e);function sT(t){return HP(zb(t*2.55),0,255)}function hb(t){return HP(zb(t*255),0,255)}function Q5(t){return HP(zb(t/2.55)/100,0,1)}function wY(t){return HP(zb(t*100),0,100)}const iUe=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function rUe(t){const e=iUe.exec(t);let n=255,r,c,l;if(e){if(e[7]!==r){const d=+e[7];n=255&(e[8]?sT(d):d*255)}return r=+e[1],c=+e[3],l=+e[5],r=255&(e[2]?sT(r):r),c=255&(e[4]?sT(c):c),l=255&(e[6]?sT(l):l),{r,g:c,b:l,a:n}}}function sUe(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${Q5(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const oUe=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function dse(t,e,n){const r=e*Math.min(n,1-n),c=(l,d=(l+t/30)%12)=>n-r*Math.max(Math.min(d-3,9-d,1),-1);return[c(0),c(8),c(4)]}function aUe(t,e,n){const r=(c,l=(c+t/60)%6)=>n-n*e*Math.max(Math.min(l,4-l,1),0);return[r(5),r(3),r(1)]}function cUe(t,e,n){const r=dse(t,1,.5);let c;for(e+n>1&&(c=1/(e+n),e*=c,n*=c),c=0;c<3;c++)r[c]*=1-e-n,r[c]+=e;return r}function Z5(t){const n=t.r/255,r=t.g/255,c=t.b/255,l=Math.max(n,r,c),d=Math.min(n,r,c),f=(l+d)/2;let m,E,y;return l!==d&&(y=l-d,E=f>.5?y/(2-l-d):y/(l+d),m=l===n?(r-c)/y+(r<c?6:0):l===r?(c-n)/y+2:(n-r)/y+4,m=m*60+.5),[m|0,E||0,f]}function e6(t,e,n,r){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,r)).map(hb)}function t6(t,e,n){return e6(dse,t,e,n)}function lUe(t,e,n){return e6(cUe,t,e,n)}function uUe(t,e,n){return e6(aUe,t,e,n)}function hse(t){return(t%360+360)%360}function dUe(t){const e=oUe.exec(t);let n=255,r;if(!e)return;e[5]!==r&&(n=e[6]?sT(+e[5]):hb(+e[5]));const c=hse(+e[2]),l=+e[3]/100,d=+e[4]/100;return e[1]==="hwb"?r=lUe(c,l,d):e[1]==="hsv"?r=uUe(c,l,d):r=t6(c,l,d),{r:r[0],g:r[1],b:r[2],a:n}}function hUe(t,e){var n=Z5(t);n[0]=hse(n[0]+e),n=t6(n),t.r=n[0],t.g=n[1],t.b=n[2]}function fUe(t){if(!t)return;const e=Z5(t),n=e[0],r=wY(e[1]),c=wY(e[2]);return t.a<255?`hsla(${n}, ${r}%, ${c}%, ${Q5(t.a)})`:`hsl(${n}, ${r}%, ${c}%)`}const CY={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},RY={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function pUe(){const t={},e=Object.keys(RY),n=Object.keys(CY);let r,c,l,d,f;for(r=0;r<e.length;r++){for(d=f=e[r],c=0;c<n.length;c++)l=n[c],f=f.replace(l,CY[l]);l=parseInt(RY[d],16),t[f]=[l>>16&255,l>>8&255,l&255]}return t}let oO;function mUe(t){oO||(oO=pUe(),oO.transparent=[0,0,0,0]);const e=oO[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}function aO(t,e,n){if(t){let r=Z5(t);r[e]=Math.max(0,Math.min(r[e]+r[e]*n,e===0?360:1)),r=t6(r),t.r=r[0],t.g=r[1],t.b=r[2]}}function fse(t,e){return t&&Object.assign(e||{},t)}function IY(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=hb(t[3]))):(e=fse(t,{r:0,g:0,b:0,a:1}),e.a=hb(e.a)),e}function gUe(t){return t.charAt(0)==="r"?rUe(t):dUe(t)}class oN{constructor(e){if(e instanceof oN)return e;const n=typeof e;let r;n==="object"?r=IY(e):n==="string"&&(r=tUe(e)||mUe(e)||gUe(e)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var e=fse(this._rgb);return e&&(e.a=Q5(e.a)),e}set rgb(e){this._rgb=IY(e)}rgbString(){return this._valid?sUe(this._rgb):this._rgb}hexString(){return this._valid?nUe(this._rgb):this._rgb}hslString(){return this._valid?fUe(this._rgb):this._rgb}mix(e,n){const r=this;if(e){const c=r.rgb,l=e.rgb;let d;const f=n===d?.5:n,m=2*f-1,E=c.a-l.a,y=((m*E===-1?m:(m+E)/(1+m*E))+1)/2;d=1-y,c.r=255&y*c.r+d*l.r+.5,c.g=255&y*c.g+d*l.g+.5,c.b=255&y*c.b+d*l.b+.5,c.a=f*c.a+(1-f)*l.a,r.rgb=c}return r}clone(){return new oN(this.rgb)}alpha(e){return this._rgb.a=hb(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=zb(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return aO(this._rgb,2,e),this}darken(e){return aO(this._rgb,2,-e),this}saturate(e){return aO(this._rgb,1,e),this}desaturate(e){return aO(this._rgb,1,-e),this}rotate(e){return hUe(this._rgb,e),this}}function pse(t){return new oN(t)}const mse=t=>t instanceof CanvasGradient||t instanceof CanvasPattern;function AY(t){return mse(t)?t:pse(t)}function pF(t){return mse(t)?t:pse(t).saturate(.5).darken(.1).hexString()}const sg=Object.create(null),qV=Object.create(null);function OT(t,e){if(!e)return t;const n=e.split(".");for(let r=0,c=n.length;r<c;++r){const l=n[r];t=t[l]||(t[l]=Object.create(null))}return t}function mF(t,e,n){return typeof e=="string"?lb(OT(t,e),n):lb(OT(t,""),e)}class _Ue{constructor(e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,r)=>pF(r.backgroundColor),this.hoverBorderColor=(n,r)=>pF(r.borderColor),this.hoverColor=(n,r)=>pF(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e)}set(e,n){return mF(this,e,n)}get(e){return OT(this,e)}describe(e,n){return mF(qV,e,n)}override(e,n){return mF(sg,e,n)}route(e,n,r,c){const l=OT(this,e),d=OT(this,r),f="_"+n;Object.defineProperties(l,{[f]:{value:l[n],writable:!0},[n]:{enumerable:!0,get(){const m=this[f],E=d[c];return oi(m)?Object.assign({},E,m):An(m,E)},set(m){this[f]=m}}})}}var Gn=new _Ue({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}});function EUe(t){return!t||vi(t.size)||vi(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function aN(t,e,n,r,c){let l=e[c];return l||(l=e[c]=t.measureText(c).width,n.push(c)),l>r&&(r=l),r}function vUe(t,e,n,r){r=r||{};let c=r.data=r.data||{},l=r.garbageCollect=r.garbageCollect||[];r.font!==e&&(c=r.data={},l=r.garbageCollect=[],r.font=e),t.save(),t.font=e;let d=0;const f=n.length;let m,E,y,w,I;for(m=0;m<f;m++)if(w=n[m],w!=null&&cr(w)!==!0)d=aN(t,c,l,d,w);else if(cr(w))for(E=0,y=w.length;E<y;E++)I=w[E],I!=null&&!cr(I)&&(d=aN(t,c,l,d,I));t.restore();const P=l.length/2;if(P>n.length){for(m=0;m<P;m++)delete c[l[m]];l.splice(0,P)}return d}function Em(t,e,n){const r=t.currentDevicePixelRatio,c=n!==0?Math.max(n/2,.5):0;return Math.round((e-c)*r)/r+c}function OY(t,e){e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore()}function cN(t,e,n,r){let c,l,d,f,m;const E=e.pointStyle,y=e.rotation,w=e.radius;let I=(y||0)*K2e;if(E&&typeof E=="object"&&(c=E.toString(),c==="[object HTMLImageElement]"||c==="[object HTMLCanvasElement]")){t.save(),t.translate(n,r),t.rotate(I),t.drawImage(E,-E.width/2,-E.height/2,E.width,E.height),t.restore();return}if(!(isNaN(w)||w<=0)){switch(t.beginPath(),E){default:t.arc(n,r,w,0,Qi),t.closePath();break;case"triangle":t.moveTo(n+Math.sin(I)*w,r-Math.cos(I)*w),I+=vY,t.lineTo(n+Math.sin(I)*w,r-Math.cos(I)*w),I+=vY,t.lineTo(n+Math.sin(I)*w,r-Math.cos(I)*w),t.closePath();break;case"rectRounded":m=w*.516,f=w-m,l=Math.cos(I+$S)*f,d=Math.sin(I+$S)*f,t.arc(n-l,r-d,m,I-br,I-Lr),t.arc(n+d,r-l,m,I-Lr,I),t.arc(n+l,r+d,m,I,I+Lr),t.arc(n-d,r+l,m,I+Lr,I+br),t.closePath();break;case"rect":if(!y){f=Math.SQRT1_2*w,t.rect(n-f,r-f,2*f,2*f);break}I+=$S;case"rectRot":l=Math.cos(I)*w,d=Math.sin(I)*w,t.moveTo(n-l,r-d),t.lineTo(n+d,r-l),t.lineTo(n+l,r+d),t.lineTo(n-d,r+l),t.closePath();break;case"crossRot":I+=$S;case"cross":l=Math.cos(I)*w,d=Math.sin(I)*w,t.moveTo(n-l,r-d),t.lineTo(n+l,r+d),t.moveTo(n+d,r-l),t.lineTo(n-d,r+l);break;case"star":l=Math.cos(I)*w,d=Math.sin(I)*w,t.moveTo(n-l,r-d),t.lineTo(n+l,r+d),t.moveTo(n+d,r-l),t.lineTo(n-d,r+l),I+=$S,l=Math.cos(I)*w,d=Math.sin(I)*w,t.moveTo(n-l,r-d),t.lineTo(n+l,r+d),t.moveTo(n+d,r-l),t.lineTo(n-d,r+l);break;case"line":l=Math.cos(I)*w,d=Math.sin(I)*w,t.moveTo(n-l,r-d),t.lineTo(n+l,r+d);break;case"dash":t.moveTo(n,r),t.lineTo(n+Math.cos(I)*w,r+Math.sin(I)*w);break}t.fill(),e.borderWidth>0&&t.stroke()}}function og(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function n6(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function i6(t){t.restore()}function yUe(t,e,n,r,c){if(!e)return t.lineTo(n.x,n.y);if(c==="middle"){const l=(e.x+n.x)/2;t.lineTo(l,e.y),t.lineTo(l,n.y)}else c==="after"!=!!r?t.lineTo(e.x,n.y):t.lineTo(n.x,e.y);t.lineTo(n.x,n.y)}function SUe(t,e,n,r){if(!e)return t.lineTo(n.x,n.y);t.bezierCurveTo(r?e.cp1x:e.cp2x,r?e.cp1y:e.cp2y,r?n.cp2x:n.cp1x,r?n.cp2y:n.cp1y,n.x,n.y)}function ag(t,e,n,r,c,l={}){const d=cr(e)?e:[e],f=l.strokeWidth>0&&l.strokeColor!=="";let m,E;for(t.save(),t.font=c.string,TUe(t,l),m=0;m<d.length;++m)E=d[m],f&&(l.strokeColor&&(t.strokeStyle=l.strokeColor),vi(l.strokeWidth)||(t.lineWidth=l.strokeWidth),t.strokeText(E,n,r,l.maxWidth)),t.fillText(E,n,r,l.maxWidth),bUe(t,n,r,E,l),r+=c.lineHeight;t.restore()}function TUe(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),vi(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function bUe(t,e,n,r,c){if(c.strikethrough||c.underline){const l=t.measureText(r),d=e-l.actualBoundingBoxLeft,f=e+l.actualBoundingBoxRight,m=n-l.actualBoundingBoxAscent,E=n+l.actualBoundingBoxDescent,y=c.strikethrough?(m+E)/2:E;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=c.decorationWidth||2,t.moveTo(d,y),t.lineTo(f,y),t.stroke()}}function lN(t,e){const{x:n,y:r,w:c,h:l,radius:d}=e;t.arc(n+d.topLeft,r+d.topLeft,d.topLeft,-Lr,br,!0),t.lineTo(n,r+l-d.bottomLeft),t.arc(n+d.bottomLeft,r+l-d.bottomLeft,d.bottomLeft,br,Lr,!0),t.lineTo(n+c-d.bottomRight,r+l),t.arc(n+c-d.bottomRight,r+l-d.bottomRight,d.bottomRight,Lr,0,!0),t.lineTo(n+c,r+d.topRight),t.arc(n+c-d.topRight,r+d.topRight,d.topRight,0,-Lr,!0),t.lineTo(n+d.topLeft,r)}const wUe=new RegExp(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/),CUe=new RegExp(/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/);function RUe(t,e){const n=(""+t).match(wUe);if(!n||n[1]==="normal")return e*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const IUe=t=>+t||0;function r6(t,e){const n={},r=oi(e),c=r?Object.keys(e):e,l=oi(t)?r?d=>An(t[d],t[e[d]]):d=>t[d]:()=>t;for(const d of c)n[d]=IUe(l(d));return n}function gse(t){return r6(t,{top:"y",right:"x",bottom:"y",left:"x"})}function sv(t){return r6(t,["topLeft","topRight","bottomLeft","bottomRight"])}function Io(t){const e=gse(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Es(t,e){t=t||{},e=e||Gn.font;let n=An(t.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let r=An(t.style,e.style);r&&!(""+r).match(CUe)&&(console.warn('Invalid font style specified: "'+r+'"'),r="");const c={family:An(t.family,e.family),lineHeight:RUe(An(t.lineHeight,e.lineHeight),n),size:n,style:r,weight:An(t.weight,e.weight),string:""};return c.string=EUe(c),c}function cO(t,e,n,r){let c=!0,l,d,f;for(l=0,d=t.length;l<d;++l)if(f=t[l],f!==void 0&&(e!==void 0&&typeof f=="function"&&(f=f(e),c=!1),n!==void 0&&cr(f)&&(f=f[n%f.length],c=!1),f!==void 0))return r&&!c&&(r.cacheable=!1),f}function AUe(t,e,n){const{min:r,max:c}=t,l=ase(e,(c-r)/2),d=(f,m)=>n&&f===0?0:f+m;return{min:d(r,-Math.abs(l)),max:d(c,l)}}function rp(t,e){return Object.assign(Object.create(t),e)}function s6(t,e,n){n=n||(d=>t[d]<e);let r=t.length-1,c=0,l;for(;r-c>1;)l=c+r>>1,n(l)?c=l:r=l;return{lo:c,hi:r}}const Vm=(t,e,n)=>s6(t,n,r=>t[r][e]<n),OUe=(t,e,n)=>s6(t,n,r=>t[r][e]>=n);function NUe(t,e,n){let r=0,c=t.length;for(;r<c&&t[r]<e;)r++;for(;c>r&&t[c-1]>n;)c--;return r>0||c<t.length?t.slice(r,c):t}const _se=["push","pop","shift","splice","unshift"];function PUe(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),_se.forEach(n=>{const r="_onData"+X5(n),c=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...l){const d=c.apply(this,l);return t._chartjs.listeners.forEach(f=>{typeof f[r]=="function"&&f[r](...l)}),d}})})}function NY(t,e){const n=t._chartjs;if(!n)return;const r=n.listeners,c=r.indexOf(e);c!==-1&&r.splice(c,1),!(r.length>0)&&(_se.forEach(l=>{delete t[l]}),delete t._chartjs)}function Ese(t){const e=new Set;let n,r;for(n=0,r=t.length;n<r;++n)e.add(t[n]);return e.size===r?t:Array.from(e)}function o6(t,e=[""],n=t,r,c=()=>t[0]){Fc(r)||(r=Tse("_fallback",t));const l={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:n,_fallback:r,_getTarget:c,override:d=>o6([d,...t],e,n,r)};return new Proxy(l,{deleteProperty(d,f){return delete d[f],delete d._keys,delete t[0][f],!0},get(d,f){return yse(d,f,()=>FUe(f,e,t,d))},getOwnPropertyDescriptor(d,f){return Reflect.getOwnPropertyDescriptor(d._scopes[0],f)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(d,f){return xY(d).includes(f)},ownKeys(d){return xY(d)},set(d,f,m){const E=d._storage||(d._storage=c());return d[f]=E[f]=m,delete d._keys,!0}})}function Iv(t,e,n,r){const c={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:vse(t,r),setContext:l=>Iv(t,l,n,r),override:l=>Iv(t.override(l),e,n,r)};return new Proxy(c,{deleteProperty(l,d){return delete l[d],delete t[d],!0},get(l,d,f){return yse(l,d,()=>DUe(l,d,f))},getOwnPropertyDescriptor(l,d){return l._descriptors.allKeys?Reflect.has(t,d)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,d)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(l,d){return Reflect.has(t,d)},ownKeys(){return Reflect.ownKeys(t)},set(l,d,f){return t[d]=f,delete l[d],!0}})}function vse(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:r=e.indexable,_allKeys:c=e.allKeys}=t;return{allKeys:c,scriptable:n,indexable:r,isScriptable:Gf(n)?n:()=>n,isIndexable:Gf(r)?r:()=>r}}const xUe=(t,e)=>t?t+X5(e):e,a6=(t,e)=>oi(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function yse(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e))return t[e];const r=n();return t[e]=r,r}function DUe(t,e,n){const{_proxy:r,_context:c,_subProxy:l,_descriptors:d}=t;let f=r[e];return Gf(f)&&d.isScriptable(e)&&(f=kUe(e,f,t,n)),cr(f)&&f.length&&(f=LUe(e,f,t,d.isIndexable)),a6(e,f)&&(f=Iv(f,c,l&&l[e],d)),f}function kUe(t,e,n,r){const{_proxy:c,_context:l,_subProxy:d,_stack:f}=n;if(f.has(t))throw new Error("Recursion detected: "+Array.from(f).join("->")+"->"+t);return f.add(t),e=e(l,d||r),f.delete(t),a6(t,e)&&(e=c6(c._scopes,c,t,e)),e}function LUe(t,e,n,r){const{_proxy:c,_context:l,_subProxy:d,_descriptors:f}=n;if(Fc(l.index)&&r(t))e=e[l.index%e.length];else if(oi(e[0])){const m=e,E=c._scopes.filter(y=>y!==m);e=[];for(const y of m){const w=c6(E,c,t,y);e.push(Iv(w,l,d&&d[t],f))}}return e}function Sse(t,e,n){return Gf(t)?t(e,n):t}const MUe=(t,e)=>t===!0?e:typeof t=="string"?rg(e,t):void 0;function UUe(t,e,n,r,c){for(const l of e){const d=MUe(n,l);if(d){t.add(d);const f=Sse(d._fallback,n,c);if(Fc(f)&&f!==n&&f!==r)return f}else if(d===!1&&Fc(r)&&n!==r)return null}return!1}function c6(t,e,n,r){const c=e._rootScopes,l=Sse(e._fallback,n,r),d=[...t,...c],f=new Set;f.add(r);let m=PY(f,d,n,l||n,r);return m===null||Fc(l)&&l!==n&&(m=PY(f,d,l,m,r),m===null)?!1:o6(Array.from(f),[""],c,l,()=>jUe(e,n,r))}function PY(t,e,n,r,c){for(;n;)n=UUe(t,e,n,r,c);return n}function jUe(t,e,n){const r=t._getTarget();e in r||(r[e]={});const c=r[e];return cr(c)&&oi(n)?n:c}function FUe(t,e,n,r){let c;for(const l of e)if(c=Tse(xUe(l,t),n),Fc(c))return a6(t,c)?c6(n,r,t,c):c}function Tse(t,e){for(const n of e){if(!n)continue;const r=n[t];if(Fc(r))return r}}function xY(t){let e=t._keys;return e||(e=t._keys=VUe(t._scopes)),e}function VUe(t){const e=new Set;for(const n of t)for(const r of Object.keys(n).filter(c=>!c.startsWith("_")))e.add(r);return Array.from(e)}const BUe=Number.EPSILON||1e-14,Av=(t,e)=>e<t.length&&!t[e].skip&&t[e],bse=t=>t==="x"?"y":"x";function WUe(t,e,n,r){const c=t.skip?e:t,l=e,d=n.skip?e:n,f=GV(l,c),m=GV(d,l);let E=f/(f+m),y=m/(f+m);E=isNaN(E)?0:E,y=isNaN(y)?0:y;const w=r*E,I=r*y;return{previous:{x:l.x-w*(d.x-c.x),y:l.y-w*(d.y-c.y)},next:{x:l.x+I*(d.x-c.x),y:l.y+I*(d.y-c.y)}}}function HUe(t,e,n){const r=t.length;let c,l,d,f,m,E=Av(t,0);for(let y=0;y<r-1;++y)if(m=E,E=Av(t,y+1),!(!m||!E)){if(IT(e[y],0,BUe)){n[y]=n[y+1]=0;continue}c=n[y]/e[y],l=n[y+1]/e[y],f=Math.pow(c,2)+Math.pow(l,2),!(f<=9)&&(d=3/Math.sqrt(f),n[y]=c*d*e[y],n[y+1]=l*d*e[y])}}function $Ue(t,e,n="x"){const r=bse(n),c=t.length;let l,d,f,m=Av(t,0);for(let E=0;E<c;++E){if(d=f,f=m,m=Av(t,E+1),!f)continue;const y=f[n],w=f[r];d&&(l=(y-d[n])/3,f[`cp1${n}`]=y-l,f[`cp1${r}`]=w-l*e[E]),m&&(l=(m[n]-y)/3,f[`cp2${n}`]=y+l,f[`cp2${r}`]=w+l*e[E])}}function zUe(t,e="x"){const n=bse(e),r=t.length,c=Array(r).fill(0),l=Array(r);let d,f,m,E=Av(t,0);for(d=0;d<r;++d)if(f=m,m=E,E=Av(t,d+1),!!m){if(E){const y=E[e]-m[e];c[d]=y!==0?(E[n]-m[n])/y:0}l[d]=f?E?Cu(c[d-1])!==Cu(c[d])?0:(c[d-1]+c[d])/2:c[d-1]:c[d]}HUe(t,c,l),$Ue(t,l,e)}function lO(t,e,n){return Math.max(Math.min(t,n),e)}function GUe(t,e){let n,r,c,l,d,f=og(t[0],e);for(n=0,r=t.length;n<r;++n)d=l,l=f,f=n<r-1&&og(t[n+1],e),l&&(c=t[n],d&&(c.cp1x=lO(c.cp1x,e.left,e.right),c.cp1y=lO(c.cp1y,e.top,e.bottom)),f&&(c.cp2x=lO(c.cp2x,e.left,e.right),c.cp2y=lO(c.cp2y,e.top,e.bottom)))}function KUe(t,e,n,r,c){let l,d,f,m;if(e.spanGaps&&(t=t.filter(E=>!E.skip)),e.cubicInterpolationMode==="monotone")zUe(t,c);else{let E=r?t[t.length-1]:t[0];for(l=0,d=t.length;l<d;++l)f=t[l],m=WUe(E,f,t[Math.min(l+1,d-(r?0:1))%d],e.tension),f.cp1x=m.previous.x,f.cp1y=m.previous.y,f.cp2x=m.next.x,f.cp2y=m.next.y,E=f}e.capBezierPoints&&GUe(t,n)}function wse(){return typeof window<"u"&&typeof document<"u"}function l6(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function uN(t,e,n){let r;return typeof t=="string"?(r=parseInt(t,10),t.indexOf("%")!==-1&&(r=r/100*e.parentNode[n])):r=t,r}const $P=t=>window.getComputedStyle(t,null);function qUe(t,e){return $P(t).getPropertyValue(e)}const YUe=["top","right","bottom","left"];function Km(t,e,n){const r={};n=n?"-"+n:"";for(let c=0;c<4;c++){const l=YUe[c];r[l]=parseFloat(t[e+"-"+l+n])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}const XUe=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function JUe(t,e){const n=t.native||t,r=n.touches,c=r&&r.length?r[0]:n,{offsetX:l,offsetY:d}=c;let f=!1,m,E;if(XUe(l,d,n.target))m=l,E=d;else{const y=e.getBoundingClientRect();m=c.clientX-y.left,E=c.clientY-y.top,f=!0}return{x:m,y:E,box:f}}function Cse(t,e){const{canvas:n,currentDevicePixelRatio:r}=e,c=$P(n),l=c.boxSizing==="border-box",d=Km(c,"padding"),f=Km(c,"border","width"),{x:m,y:E,box:y}=JUe(t,n),w=d.left+(y&&f.left),I=d.top+(y&&f.top);let{width:P,height:k}=e;return l&&(P-=d.width+f.width,k-=d.height+f.height),{x:Math.round((m-w)/P*n.width/r),y:Math.round((E-I)/k*n.height/r)}}function QUe(t,e,n){let r,c;if(e===void 0||n===void 0){const l=l6(t);if(!l)e=t.clientWidth,n=t.clientHeight;else{const d=l.getBoundingClientRect(),f=$P(l),m=Km(f,"border","width"),E=Km(f,"padding");e=d.width-E.width-m.width,n=d.height-E.height-m.height,r=uN(f.maxWidth,l,"clientWidth"),c=uN(f.maxHeight,l,"clientHeight")}}return{width:e,height:n,maxWidth:r||sN,maxHeight:c||sN}}const gF=t=>Math.round(t*10)/10;function ZUe(t,e,n,r){const c=$P(t),l=Km(c,"margin"),d=uN(c.maxWidth,t,"clientWidth")||sN,f=uN(c.maxHeight,t,"clientHeight")||sN,m=QUe(t,e,n);let{width:E,height:y}=m;if(c.boxSizing==="content-box"){const w=Km(c,"border","width"),I=Km(c,"padding");E-=I.width+w.width,y-=I.height+w.height}return E=Math.max(0,E-l.width),y=Math.max(0,r?Math.floor(E/r):y-l.height),E=gF(Math.min(E,d,m.maxWidth)),y=gF(Math.min(y,f,m.maxHeight)),E&&!y&&(y=gF(E/2)),{width:E,height:y}}function DY(t,e,n){const r=e||1,c=Math.floor(t.height*r),l=Math.floor(t.width*r);t.height=c/r,t.width=l/r;const d=t.canvas;return d.style&&(n||!d.style.height&&!d.style.width)&&(d.style.height=`${t.height}px`,d.style.width=`${t.width}px`),t.currentDevicePixelRatio!==r||d.height!==c||d.width!==l?(t.currentDevicePixelRatio=r,d.height=c,d.width=l,t.ctx.setTransform(r,0,0,r,0,0),!0):!1}const eje=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch{}return t}();function kY(t,e){const n=qUe(t,e),r=n&&n.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function Om(t,e,n,r){return{x:t.x+n*(e.x-t.x),y:t.y+n*(e.y-t.y)}}function tje(t,e,n,r){return{x:t.x+n*(e.x-t.x),y:r==="middle"?n<.5?t.y:e.y:r==="after"?n<1?t.y:e.y:n>0?e.y:t.y}}function nje(t,e,n,r){const c={x:t.cp2x,y:t.cp2y},l={x:e.cp1x,y:e.cp1y},d=Om(t,c,n),f=Om(c,l,n),m=Om(l,e,n),E=Om(d,f,n),y=Om(f,m,n);return Om(E,y,n)}const LY=new Map;function ije(t,e){e=e||{};const n=t+JSON.stringify(e);let r=LY.get(n);return r||(r=new Intl.NumberFormat(t,e),LY.set(n,r)),r}function Gb(t,e,n){return ije(e,n).format(t)}const rje=function(t,e){return{x(n){return t+t+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,r){return n-r},leftForLtr(n,r){return n-r}}},sje=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function ov(t,e,n){return t?rje(e,n):sje()}function Rse(t,e){let n,r;(e==="ltr"||e==="rtl")&&(n=t.canvas.style,r=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=r)}function Ise(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function Ase(t){return t==="angle"?{between:db,compare:X2e,normalize:ml}:{between:bf,compare:(e,n)=>e-n,normalize:e=>e}}function MY({start:t,end:e,count:n,loop:r,style:c}){return{start:t%n,end:e%n,loop:r&&(e-t+1)%n===0,style:c}}function oje(t,e,n){const{property:r,start:c,end:l}=n,{between:d,normalize:f}=Ase(r),m=e.length;let{start:E,end:y,loop:w}=t,I,P;if(w){for(E+=m,y+=m,I=0,P=m;I<P&&d(f(e[E%m][r]),c,l);++I)E--,y--;E%=m,y%=m}return y<E&&(y+=m),{start:E,end:y,loop:w,style:t.style}}function aje(t,e,n){if(!n)return[t];const{property:r,start:c,end:l}=n,d=e.length,{compare:f,between:m,normalize:E}=Ase(r),{start:y,end:w,loop:I,style:P}=oje(t,e,n),k=[];let M=!1,K=null,W,V,G;const Q=()=>m(c,G,W)&&f(c,G)!==0,Z=()=>f(l,W)===0||m(l,G,W),Y=()=>M||Q(),oe=()=>!M||Z();for(let ce=y,Se=y;ce<=w;++ce)V=e[ce%d],!V.skip&&(W=E(V[r]),W!==G&&(M=m(W,c,l),K===null&&Y()&&(K=f(W,c)===0?ce:Se),K!==null&&oe()&&(k.push(MY({start:K,end:ce,loop:I,count:d,style:P})),K=null),Se=ce,G=W));return K!==null&&k.push(MY({start:K,end:w,loop:I,count:d,style:P})),k}function cje(t,e){const n=[],r=t.segments;for(let c=0;c<r.length;c++){const l=aje(r[c],t.points,e);l.length&&n.push(...l)}return n}function lje(t,e,n,r){let c=0,l=e-1;if(n&&!r)for(;c<e&&!t[c].skip;)c++;for(;c<e&&t[c].skip;)c++;for(c%=e,n&&(l+=c);l>c&&t[l%e].skip;)l--;return l%=e,{start:c,end:l}}function uje(t,e,n,r){const c=t.length,l=[];let d=e,f=t[e],m;for(m=e+1;m<=n;++m){const E=t[m%c];E.skip||E.stop?f.skip||(r=!1,l.push({start:e%c,end:(m-1)%c,loop:r}),e=d=E.stop?m:null):(d=m,f.skip&&(e=m)),f=E}return d!==null&&l.push({start:e%c,end:d%c,loop:r}),l}function dje(t,e){const n=t.points,r=t.options.spanGaps,c=n.length;if(!c)return[];const l=!!t._loop,{start:d,end:f}=lje(n,c,l,r);if(r===!0)return UY(t,[{start:d,end:f,loop:l}],n,e);const m=f<d?f+c:f,E=!!t._fullLoop&&d===0&&f===c-1;return UY(t,uje(n,d,m,E),n,e)}function UY(t,e,n,r){return!r||!r.setContext||!n?e:hje(t,e,n,r)}function hje(t,e,n,r){const c=t._chart.getContext(),l=jY(t.options),{_datasetIndex:d,options:{spanGaps:f}}=t,m=n.length,E=[];let y=l,w=e[0].start,I=w;function P(k,M,K,W){const V=f?-1:1;if(k!==M){for(k+=m;n[k%m].skip;)k-=V;for(;n[M%m].skip;)M+=V;k%m!==M%m&&(E.push({start:k%m,end:M%m,loop:K,style:W}),y=W,w=M%m)}}for(const k of e){w=f?w:k.start;let M=n[w%m],K;for(I=w+1;I<=k.end;I++){const W=n[I%m];K=jY(r.setContext(rp(c,{type:"segment",p0:M,p1:W,p0DataIndex:(I-1)%m,p1DataIndex:I%m,datasetIndex:d}))),fje(K,y)&&P(w,I-1,k.loop,y),M=W,y=K}w<I-1&&P(w,I-1,k.loop,y)}return E}function jY(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function fje(t,e){return e&&JSON.stringify(t)!==JSON.stringify(e)}/*!
 * Chart.js v3.7.0
 * https://www.chartjs.org
 * (c) 2021 Chart.js Contributors
 * Released under the MIT License
 */class pje{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,r,c){const l=n.listeners[c],d=n.duration;l.forEach(f=>f({chart:e,initial:n.initial,numSteps:d,currentStep:Math.min(r-n.start,d)}))}_refresh(){this._request||(this._running=!0,this._request=sse.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((r,c)=>{if(!r.running||!r.items.length)return;const l=r.items;let d=l.length-1,f=!1,m;for(;d>=0;--d)m=l[d],m._active?(m._total>r.duration&&(r.duration=m._total),m.tick(e),f=!0):(l[d]=l[l.length-1],l.pop());f&&(c.draw(),this._notify(c,r,e,"progress")),l.length||(r.running=!1,this._notify(c,r,e,"complete"),r.initial=!1),n+=l.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let r=n.get(e);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,r)),r}listen(e,n,r){this._getAnims(e).listeners[n].push(r)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((r,c)=>Math.max(r,c._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const r=n.items;let c=r.length-1;for(;c>=0;--c)r[c].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var yd=new pje;const FY="transparent",mje={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const r=AY(t||FY),c=r.valid&&AY(e||FY);return c&&c.valid?c.mix(r,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class gje{constructor(e,n,r,c){const l=n[r];c=cO([e.to,c,l,e.from]);const d=cO([e.from,l,c]);this._active=!0,this._fn=e.fn||mje[e.type||typeof d],this._easing=AT[e.easing]||AT.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=r,this._from=d,this._to=c,this._promises=void 0}active(){return this._active}update(e,n,r){if(this._active){this._notify(!1);const c=this._target[this._prop],l=r-this._start,d=this._duration-l;this._start=r,this._duration=Math.floor(Math.max(d,e.duration)),this._total+=l,this._loop=!!e.loop,this._to=cO([e.to,n,c,e.from]),this._from=cO([e.from,c,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,r=this._duration,c=this._prop,l=this._from,d=this._loop,f=this._to;let m;if(this._active=l!==f&&(d||n<r),!this._active){this._target[c]=f,this._notify(!0);return}if(n<0){this._target[c]=l;return}m=n/r%2,m=d&&m>1?2-m:m,m=this._easing(Math.min(1,Math.max(0,m))),this._target[c]=this._fn(l,f,m)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,r)=>{e.push({res:n,rej:r})})}_notify(e){const n=e?"res":"rej",r=this._promises||[];for(let c=0;c<r.length;c++)r[c][n]()}}const _je=["x","y","borderWidth","radius","tension"],Eje=["color","borderColor","backgroundColor"];Gn.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0});const vje=Object.keys(Gn.animation);Gn.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"});Gn.set("animations",{colors:{type:"color",properties:Eje},numbers:{type:"number",properties:_je}});Gn.describe("animations",{_fallback:"animation"});Gn.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}});class Ose{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!oi(e))return;const n=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const c=e[r];if(!oi(c))return;const l={};for(const d of vje)l[d]=c[d];(cr(c.properties)&&c.properties||[r]).forEach(d=>{(d===r||!n.has(d))&&n.set(d,l)})})}_animateOptions(e,n){const r=n.options,c=Sje(e,r);if(!c)return[];const l=this._createAnimations(c,r);return r.$shared&&yje(e.options.$animations,r).then(()=>{e.options=r},()=>{}),l}_createAnimations(e,n){const r=this._properties,c=[],l=e.$animations||(e.$animations={}),d=Object.keys(n),f=Date.now();let m;for(m=d.length-1;m>=0;--m){const E=d[m];if(E.charAt(0)==="$")continue;if(E==="options"){c.push(...this._animateOptions(e,n));continue}const y=n[E];let w=l[E];const I=r.get(E);if(w)if(I&&w.active()){w.update(I,y,f);continue}else w.cancel();if(!I||!I.duration){e[E]=y;continue}l[E]=w=new gje(I,e,E,y),c.push(w)}return c}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const r=this._createAnimations(e,n);if(r.length)return yd.add(this._chart,r),!0}}function yje(t,e){const n=[],r=Object.keys(e);for(let c=0;c<r.length;c++){const l=t[r[c]];l&&l.active()&&n.push(l.wait())}return Promise.all(n)}function Sje(t,e){if(!e)return;let n=t.options;if(!n){t.options=e;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function VY(t,e){const n=t&&t.options||{},r=n.reverse,c=n.min===void 0?e:0,l=n.max===void 0?e:0;return{start:r?l:c,end:r?c:l}}function Tje(t,e,n){if(n===!1)return!1;const r=VY(t,n),c=VY(e,n);return{top:c.end,right:r.end,bottom:c.start,left:r.start}}function bje(t){let e,n,r,c;return oi(t)?(e=t.top,n=t.right,r=t.bottom,c=t.left):e=n=r=c=t,{top:e,right:n,bottom:r,left:c,disabled:t===!1}}function Nse(t,e){const n=[],r=t._getSortedDatasetMetas(e);let c,l;for(c=0,l=r.length;c<l;++c)n.push(r[c].index);return n}function BY(t,e,n,r={}){const c=t.keys,l=r.mode==="single";let d,f,m,E;if(e!==null){for(d=0,f=c.length;d<f;++d){if(m=+c[d],m===n){if(r.all)continue;break}E=t.values[m],qs(E)&&(l||e===0||Cu(e)===Cu(E))&&(e+=E)}return e}}function wje(t){const e=Object.keys(t),n=new Array(e.length);let r,c,l;for(r=0,c=e.length;r<c;++r)l=e[r],n[r]={x:l,y:t[l]};return n}function WY(t,e){const n=t&&t.options.stacked;return n||n===void 0&&e.stack!==void 0}function Cje(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function Rje(t){const{min:e,max:n,minDefined:r,maxDefined:c}=t.getUserBounds();return{min:r?e:Number.NEGATIVE_INFINITY,max:c?n:Number.POSITIVE_INFINITY}}function Ije(t,e,n){const r=t[e]||(t[e]={});return r[n]||(r[n]={})}function HY(t,e,n,r){for(const c of e.getMatchingVisibleMetas(r).reverse()){const l=t[c.index];if(n&&l>0||!n&&l<0)return c.index}return null}function $Y(t,e){const{chart:n,_cachedMeta:r}=t,c=n._stacks||(n._stacks={}),{iScale:l,vScale:d,index:f}=r,m=l.axis,E=d.axis,y=Cje(l,d,r),w=e.length;let I;for(let P=0;P<w;++P){const k=e[P],{[m]:M,[E]:K}=k,W=k._stacks||(k._stacks={});I=W[E]=Ije(c,y,M),I[f]=K,I._top=HY(I,d,!0,r.type),I._bottom=HY(I,d,!1,r.type)}}function _F(t,e){const n=t.scales;return Object.keys(n).filter(r=>n[r].axis===e).shift()}function Aje(t,e){return rp(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function Oje(t,e,n){return rp(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function zS(t,e){const n=t.controller.index,r=t.vScale&&t.vScale.axis;if(r){e=e||t._parsed;for(const c of e){const l=c._stacks;if(!l||l[r]===void 0||l[r][n]===void 0)return;delete l[r][n]}}}const EF=t=>t==="reset"||t==="none",zY=(t,e)=>e?t:Object.assign({},t),Nje=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:Nse(n,!0),values:null};class Mu{constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.$context=void 0,this._syncList=[],this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=WY(e.vScale,e),this.addElements()}updateIndex(e){this.index!==e&&zS(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,r=this.getDataset(),c=(w,I,P,k)=>w==="x"?I:w==="r"?k:P,l=n.xAxisID=An(r.xAxisID,_F(e,"x")),d=n.yAxisID=An(r.yAxisID,_F(e,"y")),f=n.rAxisID=An(r.rAxisID,_F(e,"r")),m=n.indexAxis,E=n.iAxisID=c(m,l,d,f),y=n.vAxisID=c(m,d,l,f);n.xScale=this.getScaleForId(l),n.yScale=this.getScaleForId(d),n.rScale=this.getScaleForId(f),n.iScale=this.getScaleForId(E),n.vScale=this.getScaleForId(y)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&NY(this._data,this),e._stacked&&zS(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),r=this._data;if(oi(n))this._data=wje(n);else if(r!==n){if(r){NY(r,this);const c=this._cachedMeta;zS(c),c._parsed=[]}n&&Object.isExtensible(n)&&PUe(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,r=this.getDataset();let c=!1;this._dataCheck();const l=n._stacked;n._stacked=WY(n.vScale,n),n.stack!==r.stack&&(c=!0,zS(n),n.stack=r.stack),this._resyncElements(e),(c||l!==n._stacked)&&$Y(this,n._parsed)}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),r=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:r,_data:c}=this,{iScale:l,_stacked:d}=r,f=l.axis;let m=e===0&&n===c.length?!0:r._sorted,E=e>0&&r._parsed[e-1],y,w,I;if(this._parsing===!1)r._parsed=c,r._sorted=!0,I=c;else{cr(c[e])?I=this.parseArrayData(r,c,e,n):oi(c[e])?I=this.parseObjectData(r,c,e,n):I=this.parsePrimitiveData(r,c,e,n);const P=()=>w[f]===null||E&&w[f]<E[f];for(y=0;y<n;++y)r._parsed[y+e]=w=I[y],m&&(P()&&(m=!1),E=w);r._sorted=m}d&&$Y(this,I)}parsePrimitiveData(e,n,r,c){const{iScale:l,vScale:d}=e,f=l.axis,m=d.axis,E=l.getLabels(),y=l===d,w=new Array(c);let I,P,k;for(I=0,P=c;I<P;++I)k=I+r,w[I]={[f]:y||l.parse(E[k],k),[m]:d.parse(n[k],k)};return w}parseArrayData(e,n,r,c){const{xScale:l,yScale:d}=e,f=new Array(c);let m,E,y,w;for(m=0,E=c;m<E;++m)y=m+r,w=n[y],f[m]={x:l.parse(w[0],y),y:d.parse(w[1],y)};return f}parseObjectData(e,n,r,c){const{xScale:l,yScale:d}=e,{xAxisKey:f="x",yAxisKey:m="y"}=this._parsing,E=new Array(c);let y,w,I,P;for(y=0,w=c;y<w;++y)I=y+r,P=n[I],E[y]={x:l.parse(rg(P,f),I),y:d.parse(rg(P,m),I)};return E}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,r){const c=this.chart,l=this._cachedMeta,d=n[e.axis],f={keys:Nse(c,!0),values:n._stacks[e.axis]};return BY(f,d,l.index,{mode:r})}updateRangeFromParsed(e,n,r,c){const l=r[n.axis];let d=l===null?NaN:l;const f=c&&r._stacks[n.axis];c&&f&&(c.values=f,d=BY(c,l,this._cachedMeta.index)),e.min=Math.min(e.min,d),e.max=Math.max(e.max,d)}getMinMax(e,n){const r=this._cachedMeta,c=r._parsed,l=r._sorted&&e===r.iScale,d=c.length,f=this._getOtherScale(e),m=Nje(n,r,this.chart),E={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:y,max:w}=Rje(f);let I,P;function k(){P=c[I];const M=P[f.axis];return!qs(P[e.axis])||y>M||w<M}for(I=0;I<d&&!(!k()&&(this.updateRangeFromParsed(E,e,P,m),l));++I);if(l){for(I=d-1;I>=0;--I)if(!k()){this.updateRangeFromParsed(E,e,P,m);break}}return E}getAllParsedValues(e){const n=this._cachedMeta._parsed,r=[];let c,l,d;for(c=0,l=n.length;c<l;++c)d=n[c][e.axis],qs(d)&&r.push(d);return r}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,r=n.iScale,c=n.vScale,l=this.getParsed(e);return{label:r?""+r.getLabelForValue(l[r.axis]):"",value:c?""+c.getLabelForValue(l[c.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=bje(An(this.options.clip,Tje(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,r=this._cachedMeta,c=r.data||[],l=n.chartArea,d=[],f=this._drawStart||0,m=this._drawCount||c.length-f,E=this.options.drawActiveElementsOnTop;let y;for(r.dataset&&r.dataset.draw(e,l,f,m),y=f;y<f+m;++y){const w=c[y];w.hidden||(w.active&&E?d.push(w):w.draw(e,l))}for(y=0;y<d.length;++y)d[y].draw(e,l)}getStyle(e,n){const r=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(e||0,r)}getContext(e,n,r){const c=this.getDataset();let l;if(e>=0&&e<this._cachedMeta.data.length){const d=this._cachedMeta.data[e];l=d.$context||(d.$context=Oje(this.getContext(),e,d)),l.parsed=this.getParsed(e),l.raw=c.data[e],l.index=l.dataIndex=e}else l=this.$context||(this.$context=Aje(this.chart.getContext(),this.index)),l.dataset=c,l.index=l.datasetIndex=this.index;return l.active=!!n,l.mode=r,l}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",r){const c=n==="active",l=this._cachedDataOpts,d=e+"-"+n,f=l[d],m=this.enableOptionSharing&&Fc(r);if(f)return zY(f,m);const E=this.chart.config,y=E.datasetElementScopeKeys(this._type,e),w=c?[`${e}Hover`,"hover",e,""]:[e,""],I=E.getOptionScopes(this.getDataset(),y),P=Object.keys(Gn.elements[e]),k=()=>this.getContext(r,c),M=E.resolveNamedOptions(I,P,k,w);return M.$shared&&(M.$shared=m,l[d]=Object.freeze(zY(M,m))),M}_resolveAnimations(e,n,r){const c=this.chart,l=this._cachedDataOpts,d=`animation-${n}`,f=l[d];if(f)return f;let m;if(c.options.animation!==!1){const y=this.chart.config,w=y.datasetAnimationScopeKeys(this._type,n),I=y.getOptionScopes(this.getDataset(),w);m=y.createResolver(I,this.getContext(e,r,n))}const E=new Ose(c,m&&m.animations);return m&&m._cacheable&&(l[d]=Object.freeze(E)),E}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||EF(e)||this.chart._animationsDisabled}updateElement(e,n,r,c){EF(c)?Object.assign(e,r):this._resolveAnimations(n,c).update(e,r)}updateSharedOptions(e,n,r){e&&!EF(n)&&this._resolveAnimations(void 0,n).update(e,r)}_setStyle(e,n,r,c){e.active=c;const l=this.getStyle(n,c);this._resolveAnimations(n,r,c).update(e,{options:!c&&this.getSharedOptions(l)||l})}removeHoverStyle(e,n,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,n,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,r=this._cachedMeta.data;for(const[f,m,E]of this._syncList)this[f](m,E);this._syncList=[];const c=r.length,l=n.length,d=Math.min(l,c);d&&this.parse(0,d),l>c?this._insertElements(c,l-c,e):l<c&&this._removeElements(l,c-l)}_insertElements(e,n,r=!0){const c=this._cachedMeta,l=c.data,d=e+n;let f;const m=E=>{for(E.length+=n,f=E.length-1;f>=d;f--)E[f]=E[f-n]};for(m(l),f=e;f<d;++f)l[f]=new this.dataElementType;this._parsing&&m(c._parsed),this.parse(e,n),r&&this.updateElements(l,e,n,"reset")}updateElements(e,n,r,c){}_removeElements(e,n){const r=this._cachedMeta;if(this._parsing){const c=r._parsed.splice(e,n);r._stacked&&zS(r,c)}r.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,r,c]=e;this[n](r,c)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const r=arguments.length-2;r&&this._sync(["_insertElements",e,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Mu.defaults={};Mu.prototype.datasetElementType=null;Mu.prototype.dataElementType=null;function Pje(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let r=[];for(let c=0,l=n.length;c<l;c++)r=r.concat(n[c].controller.getAllParsedValues(t));t._cache.$bar=Ese(r.sort((c,l)=>c-l))}return t._cache.$bar}function xje(t){const e=t.iScale,n=Pje(e,t.type);let r=e._length,c,l,d,f;const m=()=>{d===32767||d===-32768||(Fc(f)&&(r=Math.min(r,Math.abs(d-f)||r)),f=d)};for(c=0,l=n.length;c<l;++c)d=e.getPixelForValue(n[c]),m();for(f=void 0,c=0,l=e.ticks.length;c<l;++c)d=e.getPixelForTick(c),m();return r}function Dje(t,e,n,r){const c=n.barThickness;let l,d;return vi(c)?(l=e.min*n.categoryPercentage,d=n.barPercentage):(l=c*r,d=1),{chunk:l/r,ratio:d,start:e.pixels[t]-l/2}}function kje(t,e,n,r){const c=e.pixels,l=c[t];let d=t>0?c[t-1]:null,f=t<c.length-1?c[t+1]:null;const m=n.categoryPercentage;d===null&&(d=l-(f===null?e.end-e.start:f-l)),f===null&&(f=l+l-d);const E=l-(l-Math.min(d,f))/2*m;return{chunk:Math.abs(f-d)/2*m/r,ratio:n.barPercentage,start:E}}function Lje(t,e,n,r){const c=n.parse(t[0],r),l=n.parse(t[1],r),d=Math.min(c,l),f=Math.max(c,l);let m=d,E=f;Math.abs(d)>Math.abs(f)&&(m=f,E=d),e[n.axis]=E,e._custom={barStart:m,barEnd:E,start:c,end:l,min:d,max:f}}function Pse(t,e,n,r){return cr(t)?Lje(t,e,n,r):e[n.axis]=n.parse(t,r),e}function GY(t,e,n,r){const c=t.iScale,l=t.vScale,d=c.getLabels(),f=c===l,m=[];let E,y,w,I;for(E=n,y=n+r;E<y;++E)I=e[E],w={},w[c.axis]=f||c.parse(d[E],E),m.push(Pse(I,w,l,E));return m}function vF(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function Mje(t,e,n){return t!==0?Cu(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}function Uje(t){let e,n,r,c,l;return t.horizontal?(e=t.base>t.x,n="left",r="right"):(e=t.base<t.y,n="bottom",r="top"),e?(c="end",l="start"):(c="start",l="end"),{start:n,end:r,reverse:e,top:c,bottom:l}}function jje(t,e,n,r){let c=e.borderSkipped;const l={};if(!c){t.borderSkipped=l;return}const{start:d,end:f,reverse:m,top:E,bottom:y}=Uje(t);c==="middle"&&n&&(t.enableBorderRadius=!0,(n._top||0)===r?c=E:(n._bottom||0)===r?c=y:(l[KY(y,d,f,m)]=!0,c=E)),l[KY(c,d,f,m)]=!0,t.borderSkipped=l}function KY(t,e,n,r){return r?(t=Fje(t,e,n),t=qY(t,n,e)):t=qY(t,e,n),t}function Fje(t,e,n){return t===e?n:t===n?e:t}function qY(t,e,n){return t==="start"?e:t==="end"?n:t}function Vje(t,{inflateAmount:e},n){t.inflateAmount=e==="auto"?n===1?.33:0:e}class zP extends Mu{parsePrimitiveData(e,n,r,c){return GY(e,n,r,c)}parseArrayData(e,n,r,c){return GY(e,n,r,c)}parseObjectData(e,n,r,c){const{iScale:l,vScale:d}=e,{xAxisKey:f="x",yAxisKey:m="y"}=this._parsing,E=l.axis==="x"?f:m,y=d.axis==="x"?f:m,w=[];let I,P,k,M;for(I=r,P=r+c;I<P;++I)M=n[I],k={},k[l.axis]=l.parse(rg(M,E),I),w.push(Pse(rg(M,y),k,d,I));return w}updateRangeFromParsed(e,n,r,c){super.updateRangeFromParsed(e,n,r,c);const l=r._custom;l&&n===this._cachedMeta.vScale&&(e.min=Math.min(e.min,l.min),e.max=Math.max(e.max,l.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const n=this._cachedMeta,{iScale:r,vScale:c}=n,l=this.getParsed(e),d=l._custom,f=vF(d)?"["+d.start+", "+d.end+"]":""+c.getLabelForValue(l[c.axis]);return{label:""+r.getLabelForValue(l[r.axis]),value:f}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,e)}updateElements(e,n,r,c){const l=c==="reset",{index:d,_cachedMeta:{vScale:f}}=this,m=f.getBasePixel(),E=f.isHorizontal(),y=this._getRuler(),w=this.resolveDataElementOptions(n,c),I=this.getSharedOptions(w),P=this.includeOptions(c,I);this.updateSharedOptions(I,c,w);for(let k=n;k<n+r;k++){const M=this.getParsed(k),K=l||vi(M[f.axis])?{base:m,head:m}:this._calculateBarValuePixels(k),W=this._calculateBarIndexPixels(k,y),V=(M._stacks||{})[f.axis],G={horizontal:E,base:K.base,enableBorderRadius:!V||vF(M._custom)||d===V._top||d===V._bottom,x:E?K.head:W.center,y:E?W.center:K.head,height:E?W.size:Math.abs(K.size),width:E?Math.abs(K.size):W.size};P&&(G.options=I||this.resolveDataElementOptions(k,e[k].active?"active":c));const Q=G.options||e[k].options;jje(G,Q,V,d),Vje(G,Q,y.ratio),this.updateElement(e[k],k,G,c)}}_getStacks(e,n){const c=this._cachedMeta.iScale,l=c.getMatchingVisibleMetas(this._type),d=c.options.stacked,f=l.length,m=[];let E,y;for(E=0;E<f;++E)if(y=l[E],!!y.controller.options.grouped){if(typeof n<"u"){const w=y.controller.getParsed(n)[y.controller._cachedMeta.vScale.axis];if(vi(w)||isNaN(w))continue}if((d===!1||m.indexOf(y.stack)===-1||d===void 0&&y.stack===void 0)&&m.push(y.stack),y.index===e)break}return m.length||m.push(void 0),m}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,n,r){const c=this._getStacks(e,r),l=n!==void 0?c.indexOf(n):-1;return l===-1?c.length-1:l}_getRuler(){const e=this.options,n=this._cachedMeta,r=n.iScale,c=[];let l,d;for(l=0,d=n.data.length;l<d;++l)c.push(r.getPixelForValue(this.getParsed(l)[r.axis],l));const f=e.barThickness;return{min:f||xje(n),pixels:c,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:e.grouped,ratio:f?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:n,_stacked:r},options:{base:c,minBarLength:l}}=this,d=c||0,f=this.getParsed(e),m=f._custom,E=vF(m);let y=f[n.axis],w=0,I=r?this.applyStack(n,f,r):y,P,k;I!==y&&(w=I-y,I=y),E&&(y=m.barStart,I=m.barEnd-m.barStart,y!==0&&Cu(y)!==Cu(m.barEnd)&&(w=0),w+=y);const M=!vi(c)&&!E?c:w;let K=n.getPixelForValue(M);if(this.chart.getDataVisibility(e)?P=n.getPixelForValue(w+I):P=K,k=P-K,Math.abs(k)<l&&(k=Mje(k,n,d)*l,y===d&&(K-=k/2),P=K+k),K===n.getPixelForValue(d)){const W=Cu(k)*n.getLineWidthForValue(d)/2;K+=W,k-=W}return{size:k,base:K,head:P,center:P+k/2}}_calculateBarIndexPixels(e,n){const r=n.scale,c=this.options,l=c.skipNull,d=An(c.maxBarThickness,1/0);let f,m;if(n.grouped){const E=l?this._getStackCount(e):n.stackCount,y=c.barThickness==="flex"?kje(e,n,c,E):Dje(e,n,c,E),w=this._getStackIndex(this.index,this._cachedMeta.stack,l?e:void 0);f=y.start+y.chunk*w+y.chunk/2,m=Math.min(d,y.chunk*y.ratio)}else f=r.getPixelForValue(this.getParsed(e)[r.axis],e),m=Math.min(d,n.min*n.ratio);return{base:f-m/2,head:f+m/2,center:f,size:m}}draw(){const e=this._cachedMeta,n=e.vScale,r=e.data,c=r.length;let l=0;for(;l<c;++l)this.getParsed(l)[n.axis]!==null&&r[l].draw(this._ctx)}}zP.id="bar";zP.defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};zP.overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};class u6 extends Mu{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,n,r,c){const l=super.parsePrimitiveData(e,n,r,c);for(let d=0;d<l.length;d++)l[d]._custom=this.resolveDataElementOptions(d+r).radius;return l}parseArrayData(e,n,r,c){const l=super.parseArrayData(e,n,r,c);for(let d=0;d<l.length;d++){const f=n[r+d];l[d]._custom=An(f[2],this.resolveDataElementOptions(d+r).radius)}return l}parseObjectData(e,n,r,c){const l=super.parseObjectData(e,n,r,c);for(let d=0;d<l.length;d++){const f=n[r+d];l[d]._custom=An(f&&f.r&&+f.r,this.resolveDataElementOptions(d+r).radius)}return l}getMaxOverflow(){const e=this._cachedMeta.data;let n=0;for(let r=e.length-1;r>=0;--r)n=Math.max(n,e[r].size(this.resolveDataElementOptions(r))/2);return n>0&&n}getLabelAndValue(e){const n=this._cachedMeta,{xScale:r,yScale:c}=n,l=this.getParsed(e),d=r.getLabelForValue(l.x),f=c.getLabelForValue(l.y),m=l._custom;return{label:n.label,value:"("+d+", "+f+(m?", "+m:"")+")"}}update(e){const n=this._cachedMeta.data;this.updateElements(n,0,n.length,e)}updateElements(e,n,r,c){const l=c==="reset",{iScale:d,vScale:f}=this._cachedMeta,m=this.resolveDataElementOptions(n,c),E=this.getSharedOptions(m),y=this.includeOptions(c,E),w=d.axis,I=f.axis;for(let P=n;P<n+r;P++){const k=e[P],M=!l&&this.getParsed(P),K={},W=K[w]=l?d.getPixelForDecimal(.5):d.getPixelForValue(M[w]),V=K[I]=l?f.getBasePixel():f.getPixelForValue(M[I]);K.skip=isNaN(W)||isNaN(V),y&&(K.options=this.resolveDataElementOptions(P,k.active?"active":c),l&&(K.options.radius=0)),this.updateElement(k,P,K,c)}this.updateSharedOptions(E,c,m)}resolveDataElementOptions(e,n){const r=this.getParsed(e);let c=super.resolveDataElementOptions(e,n);c.$shared&&(c=Object.assign({},c,{$shared:!1}));const l=c.radius;return n!=="active"&&(c.radius=0),c.radius+=An(r&&r._custom,l),c}}u6.id="bubble";u6.defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};u6.overrides={scales:{x:{type:"linear"},y:{type:"linear"}},plugins:{tooltip:{callbacks:{title(){return""}}}}};function Bje(t,e,n){let r=1,c=1,l=0,d=0;if(e<Qi){const f=t,m=f+e,E=Math.cos(f),y=Math.sin(f),w=Math.cos(m),I=Math.sin(m),P=(G,Q,Z)=>db(G,f,m,!0)?1:Math.max(Q,Q*n,Z,Z*n),k=(G,Q,Z)=>db(G,f,m,!0)?-1:Math.min(Q,Q*n,Z,Z*n),M=P(0,E,w),K=P(Lr,y,I),W=k(br,E,w),V=k(br+Lr,y,I);r=(M-W)/2,c=(K-V)/2,l=-(M+W)/2,d=-(K+V)/2}return{ratioX:r,ratioY:c,offsetX:l,offsetY:d}}class Kb extends Mu{constructor(e,n){super(e,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,n){const r=this.getDataset().data,c=this._cachedMeta;if(this._parsing===!1)c._parsed=r;else{let l=m=>+r[m];if(oi(r[e])){const{key:m="value"}=this._parsing;l=E=>+rg(r[E],m)}let d,f;for(d=e,f=e+n;d<f;++d)c._parsed[d]=l(d)}}_getRotation(){return yl(this.options.rotation-90)}_getCircumference(){return yl(this.options.circumference)}_getRotationExtents(){let e=Qi,n=-Qi;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)){const c=this.chart.getDatasetMeta(r).controller,l=c._getRotation(),d=c._getCircumference();e=Math.min(e,l),n=Math.max(n,l+d)}return{rotation:e,circumference:n-e}}update(e){const n=this.chart,{chartArea:r}=n,c=this._cachedMeta,l=c.data,d=this.getMaxBorderWidth()+this.getMaxOffset(l)+this.options.spacing,f=Math.max((Math.min(r.width,r.height)-d)/2,0),m=Math.min(V2e(this.options.cutout,f),1),E=this._getRingWeight(this.index),{circumference:y,rotation:w}=this._getRotationExtents(),{ratioX:I,ratioY:P,offsetX:k,offsetY:M}=Bje(w,y,m),K=(r.width-d)/I,W=(r.height-d)/P,V=Math.max(Math.min(K,W)/2,0),G=ase(this.options.radius,V),Q=Math.max(G*m,0),Z=(G-Q)/this._getVisibleDatasetWeightTotal();this.offsetX=k*G,this.offsetY=M*G,c.total=this.calculateTotal(),this.outerRadius=G-Z*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-Z*E,0),this.updateElements(l,0,l.length,e)}_circumference(e,n){const r=this.options,c=this._cachedMeta,l=this._getCircumference();return n&&r.animation.animateRotate||!this.chart.getDataVisibility(e)||c._parsed[e]===null||c.data[e].hidden?0:this.calculateCircumference(c._parsed[e]*l/Qi)}updateElements(e,n,r,c){const l=c==="reset",d=this.chart,f=d.chartArea,E=d.options.animation,y=(f.left+f.right)/2,w=(f.top+f.bottom)/2,I=l&&E.animateScale,P=I?0:this.innerRadius,k=I?0:this.outerRadius,M=this.resolveDataElementOptions(n,c),K=this.getSharedOptions(M),W=this.includeOptions(c,K);let V=this._getRotation(),G;for(G=0;G<n;++G)V+=this._circumference(G,l);for(G=n;G<n+r;++G){const Q=this._circumference(G,l),Z=e[G],Y={x:y+this.offsetX,y:w+this.offsetY,startAngle:V,endAngle:V+Q,circumference:Q,outerRadius:k,innerRadius:P};W&&(Y.options=K||this.resolveDataElementOptions(G,Z.active?"active":c)),V+=Q,this.updateElement(Z,G,Y,c)}this.updateSharedOptions(K,c,M)}calculateTotal(){const e=this._cachedMeta,n=e.data;let r=0,c;for(c=0;c<n.length;c++){const l=e._parsed[c];l!==null&&!isNaN(l)&&this.chart.getDataVisibility(c)&&!n[c].hidden&&(r+=Math.abs(l))}return r}calculateCircumference(e){const n=this._cachedMeta.total;return n>0&&!isNaN(e)?Qi*(Math.abs(e)/n):0}getLabelAndValue(e){const n=this._cachedMeta,r=this.chart,c=r.data.labels||[],l=Gb(n._parsed[e],r.options.locale);return{label:c[e]||"",value:l}}getMaxBorderWidth(e){let n=0;const r=this.chart;let c,l,d,f,m;if(!e){for(c=0,l=r.data.datasets.length;c<l;++c)if(r.isDatasetVisible(c)){d=r.getDatasetMeta(c),e=d.data,f=d.controller;break}}if(!e)return 0;for(c=0,l=e.length;c<l;++c)m=f.resolveDataElementOptions(c),m.borderAlign!=="inner"&&(n=Math.max(n,m.borderWidth||0,m.hoverBorderWidth||0));return n}getMaxOffset(e){let n=0;for(let r=0,c=e.length;r<c;++r){const l=this.resolveDataElementOptions(r);n=Math.max(n,l.offset||0,l.hoverOffset||0)}return n}_getRingWeightOffset(e){let n=0;for(let r=0;r<e;++r)this.chart.isDatasetVisible(r)&&(n+=this._getRingWeight(r));return n}_getRingWeight(e){return Math.max(An(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Kb.id="doughnut";Kb.defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};Kb.descriptors={_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"};Kb.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:n}}=t.legend.options;return e.labels.map((r,c)=>{const d=t.getDatasetMeta(0).controller.getStyle(c);return{text:r,fillStyle:d.backgroundColor,strokeStyle:d.borderColor,lineWidth:d.borderWidth,pointStyle:n,hidden:!t.getDataVisibility(c),index:c}})}return[]}},onClick(t,e,n){n.chart.toggleDataVisibility(e.index),n.chart.update()}},tooltip:{callbacks:{title(){return""},label(t){let e=t.label;const n=": "+t.formattedValue;return cr(e)?(e=e.slice(),e[0]+=n):e+=n,e}}}}};class qb extends Mu{initialize(){this.enableOptionSharing=!0,super.initialize()}update(e){const n=this._cachedMeta,{dataset:r,data:c=[],_dataset:l}=n,d=this.chart._animationsDisabled;let{start:f,count:m}=Wje(n,c,d);this._drawStart=f,this._drawCount=m,Hje(n)&&(f=0,m=c.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!l._decimated,r.points=c;const E=this.resolveDatasetElementOptions(e);this.options.showLine||(E.borderWidth=0),E.segment=this.options.segment,this.updateElement(r,void 0,{animated:!d,options:E},e),this.updateElements(c,f,m,e)}updateElements(e,n,r,c){const l=c==="reset",{iScale:d,vScale:f,_stacked:m,_dataset:E}=this._cachedMeta,y=this.resolveDataElementOptions(n,c),w=this.getSharedOptions(y),I=this.includeOptions(c,w),P=d.axis,k=f.axis,{spanGaps:M,segment:K}=this.options,W=ub(M)?M:Number.POSITIVE_INFINITY,V=this.chart._animationsDisabled||l||c==="none";let G=n>0&&this.getParsed(n-1);for(let Q=n;Q<n+r;++Q){const Z=e[Q],Y=this.getParsed(Q),oe=V?Z:{},ce=vi(Y[k]),Se=oe[P]=d.getPixelForValue(Y[P],Q),xe=oe[k]=l||ce?f.getBasePixel():f.getPixelForValue(m?this.applyStack(f,Y,m):Y[k],Q);oe.skip=isNaN(Se)||isNaN(xe)||ce,oe.stop=Q>0&&Y[P]-G[P]>W,K&&(oe.parsed=Y,oe.raw=E.data[Q]),I&&(oe.options=w||this.resolveDataElementOptions(Q,Z.active?"active":c)),V||this.updateElement(Z,Q,oe,c),G=Y}this.updateSharedOptions(w,c,y)}getMaxOverflow(){const e=this._cachedMeta,n=e.dataset,r=n.options&&n.options.borderWidth||0,c=e.data||[];if(!c.length)return r;const l=c[0].size(this.resolveDataElementOptions(0)),d=c[c.length-1].size(this.resolveDataElementOptions(c.length-1));return Math.max(r,l,d)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}qb.id="line";qb.defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};qb.overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};function Wje(t,e,n){const r=e.length;let c=0,l=r;if(t._sorted){const{iScale:d,_parsed:f}=t,m=d.axis,{min:E,max:y,minDefined:w,maxDefined:I}=d.getUserBounds();w&&(c=wo(Math.min(Vm(f,d.axis,E).lo,n?r:Vm(e,m,d.getPixelForValue(E)).lo),0,r-1)),I?l=wo(Math.max(Vm(f,d.axis,y).hi+1,n?0:Vm(e,m,d.getPixelForValue(y)).hi+1),c,r)-c:l=r-c}return{start:c,count:l}}function Hje(t){const{xScale:e,yScale:n,_scaleRanges:r}=t,c={xmin:e.min,xmax:e.max,ymin:n.min,ymax:n.max};if(!r)return t._scaleRanges=c,!0;const l=r.xmin!==e.min||r.xmax!==e.max||r.ymin!==n.min||r.ymax!==n.max;return Object.assign(r,c),l}class d6 extends Mu{constructor(e,n){super(e,n),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const n=this._cachedMeta,r=this.chart,c=r.data.labels||[],l=Gb(n._parsed[e].r,r.options.locale);return{label:c[e]||"",value:l}}update(e){const n=this._cachedMeta.data;this._updateRadius(),this.updateElements(n,0,n.length,e)}_updateRadius(){const e=this.chart,n=e.chartArea,r=e.options,c=Math.min(n.right-n.left,n.bottom-n.top),l=Math.max(c/2,0),d=Math.max(r.cutoutPercentage?l/100*r.cutoutPercentage:1,0),f=(l-d)/e.getVisibleDatasetCount();this.outerRadius=l-f*this.index,this.innerRadius=this.outerRadius-f}updateElements(e,n,r,c){const l=c==="reset",d=this.chart,f=this.getDataset(),E=d.options.animation,y=this._cachedMeta.rScale,w=y.xCenter,I=y.yCenter,P=y.getIndexAngle(0)-.5*br;let k=P,M;const K=360/this.countVisibleElements();for(M=0;M<n;++M)k+=this._computeAngle(M,c,K);for(M=n;M<n+r;M++){const W=e[M];let V=k,G=k+this._computeAngle(M,c,K),Q=d.getDataVisibility(M)?y.getDistanceFromCenterForValue(f.data[M]):0;k=G,l&&(E.animateScale&&(Q=0),E.animateRotate&&(V=G=P));const Z={x:w,y:I,innerRadius:0,outerRadius:Q,startAngle:V,endAngle:G,options:this.resolveDataElementOptions(M,W.active?"active":c)};this.updateElement(W,M,Z,c)}}countVisibleElements(){const e=this.getDataset(),n=this._cachedMeta;let r=0;return n.data.forEach((c,l)=>{!isNaN(e.data[l])&&this.chart.getDataVisibility(l)&&r++}),r}_computeAngle(e,n,r){return this.chart.getDataVisibility(e)?yl(this.resolveDataElementOptions(e,n).angle||r):0}}d6.id="polarArea";d6.defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};d6.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:n}}=t.legend.options;return e.labels.map((r,c)=>{const d=t.getDatasetMeta(0).controller.getStyle(c);return{text:r,fillStyle:d.backgroundColor,strokeStyle:d.borderColor,lineWidth:d.borderWidth,pointStyle:n,hidden:!t.getDataVisibility(c),index:c}})}return[]}},onClick(t,e,n){n.chart.toggleDataVisibility(e.index),n.chart.update()}},tooltip:{callbacks:{title(){return""},label(t){return t.chart.data.labels[t.dataIndex]+": "+t.formattedValue}}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};class xse extends Kb{}xse.id="pie";xse.defaults={cutout:0,rotation:0,circumference:360,radius:"100%"};class h6 extends Mu{getLabelAndValue(e){const n=this._cachedMeta.vScale,r=this.getParsed(e);return{label:n.getLabels()[e],value:""+n.getLabelForValue(r[n.axis])}}update(e){const n=this._cachedMeta,r=n.dataset,c=n.data||[],l=n.iScale.getLabels();if(r.points=c,e!=="resize"){const d=this.resolveDatasetElementOptions(e);this.options.showLine||(d.borderWidth=0);const f={_loop:!0,_fullLoop:l.length===c.length,options:d};this.updateElement(r,void 0,f,e)}this.updateElements(c,0,c.length,e)}updateElements(e,n,r,c){const l=this.getDataset(),d=this._cachedMeta.rScale,f=c==="reset";for(let m=n;m<n+r;m++){const E=e[m],y=this.resolveDataElementOptions(m,E.active?"active":c),w=d.getPointPositionForValue(m,l.data[m]),I=f?d.xCenter:w.x,P=f?d.yCenter:w.y,k={x:I,y:P,angle:w.angle,skip:isNaN(I)||isNaN(P),options:y};this.updateElement(E,m,k,c)}}}h6.id="radar";h6.defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};h6.overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};class f6 extends qb{}f6.id="scatter";f6.defaults={showLine:!1,fill:!1};f6.overrides={interaction:{mode:"point"},plugins:{tooltip:{callbacks:{title(){return""},label(t){return"("+t.label+", "+t.formattedValue+")"}}}},scales:{x:{type:"linear"},y:{type:"linear"}}};function vm(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class YV{constructor(e){this.options=e||{}}formats(){return vm()}parse(e,n){return vm()}format(e,n){return vm()}add(e,n,r){return vm()}diff(e,n,r){return vm()}startOf(e,n,r){return vm()}endOf(e,n){return vm()}}YV.override=function(t){Object.assign(YV.prototype,t)};var $je={_date:YV};function oT(t,e){return"native"in t?{x:t.x,y:t.y}:Cse(t,e)}function zje(t,e){const n=t.getSortedVisibleDatasetMetas();let r,c,l;for(let d=0,f=n.length;d<f;++d){({index:r,data:c}=n[d]);for(let m=0,E=c.length;m<E;++m)l=c[m],l.skip||e(l,r,m)}}function Gje(t,e,n,r){const{controller:c,data:l,_sorted:d}=t,f=c._cachedMeta.iScale;if(f&&e===f.axis&&e!=="r"&&d&&l.length){const m=f._reversePixels?OUe:Vm;if(r){if(c._sharedOptions){const E=l[0],y=typeof E.getRange=="function"&&E.getRange(e);if(y){const w=m(l,e,n-y),I=m(l,e,n+y);return{lo:w.lo,hi:I.hi}}}}else return m(l,e,n)}return{lo:0,hi:l.length-1}}function p6(t,e,n,r,c){const l=t.getSortedVisibleDatasetMetas(),d=n[e];for(let f=0,m=l.length;f<m;++f){const{index:E,data:y}=l[f],{lo:w,hi:I}=Gje(l[f],e,d,c);for(let P=w;P<=I;++P){const k=y[P];k.skip||r(k,E,P)}}}function Kje(t){const e=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(r,c){const l=e?Math.abs(r.x-c.x):0,d=n?Math.abs(r.y-c.y):0;return Math.sqrt(Math.pow(l,2)+Math.pow(d,2))}}function yF(t,e,n,r){const c=[];return og(e,t.chartArea,t._minPadding)&&p6(t,n,e,function(d,f,m){d.inRange(e.x,e.y,r)&&c.push({element:d,datasetIndex:f,index:m})},!0),c}function qje(t,e,n,r){let c=[];function l(d,f,m){const{startAngle:E,endAngle:y}=d.getProps(["startAngle","endAngle"],r),{angle:w}=use(d,{x:e.x,y:e.y});db(w,E,y)&&c.push({element:d,datasetIndex:f,index:m})}return p6(t,n,e,l),c}function Yje(t,e,n,r,c){let l=[];const d=Kje(n);let f=Number.POSITIVE_INFINITY;function m(E,y,w){const I=E.inRange(e.x,e.y,c);if(r&&!I)return;const P=E.getCenterPoint(c);if(!og(P,t.chartArea,t._minPadding)&&!I)return;const M=d(e,P);M<f?(l=[{element:E,datasetIndex:y,index:w}],f=M):M===f&&l.push({element:E,datasetIndex:y,index:w})}return p6(t,n,e,m),l}function SF(t,e,n,r,c){return og(e,t.chartArea,t._minPadding)?n==="r"&&!r?qje(t,e,n,c):Yje(t,e,n,r,c):[]}function YY(t,e,n,r){const c=oT(e,t),l=[],d=n.axis,f=d==="x"?"inXRange":"inYRange";let m=!1;return zje(t,(E,y,w)=>{E[f](c[d],r)&&l.push({element:E,datasetIndex:y,index:w}),E.inRange(c.x,c.y,r)&&(m=!0)}),n.intersect&&!m?[]:l}var Xje={modes:{index(t,e,n,r){const c=oT(e,t),l=n.axis||"x",d=n.intersect?yF(t,c,l,r):SF(t,c,l,!1,r),f=[];return d.length?(t.getSortedVisibleDatasetMetas().forEach(m=>{const E=d[0].index,y=m.data[E];y&&!y.skip&&f.push({element:y,datasetIndex:m.index,index:E})}),f):[]},dataset(t,e,n,r){const c=oT(e,t),l=n.axis||"xy";let d=n.intersect?yF(t,c,l,r):SF(t,c,l,!1,r);if(d.length>0){const f=d[0].datasetIndex,m=t.getDatasetMeta(f).data;d=[];for(let E=0;E<m.length;++E)d.push({element:m[E],datasetIndex:f,index:E})}return d},point(t,e,n,r){const c=oT(e,t),l=n.axis||"xy";return yF(t,c,l,r)},nearest(t,e,n,r){const c=oT(e,t),l=n.axis||"xy";return SF(t,c,l,n.intersect,r)},x(t,e,n,r){return YY(t,e,{axis:"x",intersect:n.intersect},r)},y(t,e,n,r){return YY(t,e,{axis:"y",intersect:n.intersect},r)}}};const Dse=["left","top","right","bottom"];function GS(t,e){return t.filter(n=>n.pos===e)}function XY(t,e){return t.filter(n=>Dse.indexOf(n.pos)===-1&&n.box.axis===e)}function KS(t,e){return t.sort((n,r)=>{const c=e?r:n,l=e?n:r;return c.weight===l.weight?c.index-l.index:c.weight-l.weight})}function Jje(t){const e=[];let n,r,c,l,d,f;for(n=0,r=(t||[]).length;n<r;++n)c=t[n],{position:l,options:{stack:d,stackWeight:f=1}}=c,e.push({index:n,box:c,pos:l,horizontal:c.isHorizontal(),weight:c.weight,stack:d&&l+d,stackWeight:f});return e}function Qje(t){const e={};for(const n of t){const{stack:r,pos:c,stackWeight:l}=n;if(!r||!Dse.includes(c))continue;const d=e[r]||(e[r]={count:0,placed:0,weight:0,size:0});d.count++,d.weight+=l}return e}function Zje(t,e){const n=Qje(t),{vBoxMaxWidth:r,hBoxMaxHeight:c}=e;let l,d,f;for(l=0,d=t.length;l<d;++l){f=t[l];const{fullSize:m}=f.box,E=n[f.stack],y=E&&f.stackWeight/E.weight;f.horizontal?(f.width=y?y*r:m&&e.availableWidth,f.height=c):(f.width=r,f.height=y?y*c:m&&e.availableHeight)}return n}function eFe(t){const e=Jje(t),n=KS(e.filter(E=>E.box.fullSize),!0),r=KS(GS(e,"left"),!0),c=KS(GS(e,"right")),l=KS(GS(e,"top"),!0),d=KS(GS(e,"bottom")),f=XY(e,"x"),m=XY(e,"y");return{fullSize:n,leftAndTop:r.concat(l),rightAndBottom:c.concat(m).concat(d).concat(f),chartArea:GS(e,"chartArea"),vertical:r.concat(c).concat(m),horizontal:l.concat(d).concat(f)}}function JY(t,e,n,r){return Math.max(t[n],e[n])+Math.max(t[r],e[r])}function kse(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function tFe(t,e,n,r){const{pos:c,box:l}=n,d=t.maxPadding;if(!oi(c)){n.size&&(t[c]-=n.size);const w=r[n.stack]||{size:0,count:1};w.size=Math.max(w.size,n.horizontal?l.height:l.width),n.size=w.size/w.count,t[c]+=n.size}l.getPadding&&kse(d,l.getPadding());const f=Math.max(0,e.outerWidth-JY(d,t,"left","right")),m=Math.max(0,e.outerHeight-JY(d,t,"top","bottom")),E=f!==t.w,y=m!==t.h;return t.w=f,t.h=m,n.horizontal?{same:E,other:y}:{same:y,other:E}}function nFe(t){const e=t.maxPadding;function n(r){const c=Math.max(e[r]-t[r],0);return t[r]+=c,c}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function iFe(t,e){const n=e.maxPadding;function r(c){const l={left:0,top:0,right:0,bottom:0};return c.forEach(d=>{l[d]=Math.max(e[d],n[d])}),l}return r(t?["left","right"]:["top","bottom"])}function aT(t,e,n,r){const c=[];let l,d,f,m,E,y;for(l=0,d=t.length,E=0;l<d;++l){f=t[l],m=f.box,m.update(f.width||e.w,f.height||e.h,iFe(f.horizontal,e));const{same:w,other:I}=tFe(e,n,f,r);E|=w&&c.length,y=y||I,m.fullSize||c.push(f)}return E&&aT(c,e,n,r)||y}function uO(t,e,n,r,c){t.top=n,t.left=e,t.right=e+r,t.bottom=n+c,t.width=r,t.height=c}function QY(t,e,n,r){const c=n.padding;let{x:l,y:d}=e;for(const f of t){const m=f.box,E=r[f.stack]||{count:1,placed:0,weight:1},y=f.stackWeight/E.weight||1;if(f.horizontal){const w=e.w*y,I=E.size||m.height;Fc(E.start)&&(d=E.start),m.fullSize?uO(m,c.left,d,n.outerWidth-c.right-c.left,I):uO(m,e.left+E.placed,d,w,I),E.start=d,E.placed+=w,d=m.bottom}else{const w=e.h*y,I=E.size||m.width;Fc(E.start)&&(l=E.start),m.fullSize?uO(m,l,c.top,I,n.outerHeight-c.bottom-c.top):uO(m,l,e.top+E.placed,I,w),E.start=l,E.placed+=w,l=m.right}}e.x=l,e.y=d}Gn.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}});var kc={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,r){if(!t)return;const c=Io(t.options.layout.padding),l=Math.max(e-c.width,0),d=Math.max(n-c.height,0),f=eFe(t.boxes),m=f.vertical,E=f.horizontal;Ei(t.boxes,M=>{typeof M.beforeLayout=="function"&&M.beforeLayout()});const y=m.reduce((M,K)=>K.box.options&&K.box.options.display===!1?M:M+1,0)||1,w=Object.freeze({outerWidth:e,outerHeight:n,padding:c,availableWidth:l,availableHeight:d,vBoxMaxWidth:l/2/y,hBoxMaxHeight:d/2}),I=Object.assign({},c);kse(I,Io(r));const P=Object.assign({maxPadding:I,w:l,h:d,x:c.left,y:c.top},c),k=Zje(m.concat(E),w);aT(f.fullSize,P,w,k),aT(m,P,w,k),aT(E,P,w,k)&&aT(m,P,w,k),nFe(P),QY(f.leftAndTop,P,w,k),P.x+=P.w,P.y+=P.h,QY(f.rightAndBottom,P,w,k),t.chartArea={left:P.left,top:P.top,right:P.left+P.w,bottom:P.top+P.h,height:P.h,width:P.w},Ei(f.chartArea,M=>{const K=M.box;Object.assign(K,t.chartArea),K.update(P.w,P.h,{left:0,top:0,right:0,bottom:0})})}};class Lse{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,r){}removeEventListener(e,n,r){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,r,c){return n=Math.max(0,n||e.width),r=r||e.height,{width:n,height:Math.max(0,c?Math.floor(n/c):r)}}isAttached(e){return!0}updateConfig(e){}}class rFe extends Lse{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const XO="$chartjs",sFe={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},ZY=t=>t===null||t==="";function oFe(t,e){const n=t.style,r=t.getAttribute("height"),c=t.getAttribute("width");if(t[XO]={initial:{height:r,width:c,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",ZY(c)){const l=kY(t,"width");l!==void 0&&(t.width=l)}if(ZY(r))if(t.style.height==="")t.height=t.width/(e||2);else{const l=kY(t,"height");l!==void 0&&(t.height=l)}return t}const Mse=eje?{passive:!0}:!1;function aFe(t,e,n){t.addEventListener(e,n,Mse)}function cFe(t,e,n){t.canvas.removeEventListener(e,n,Mse)}function lFe(t,e){const n=sFe[t.type]||t.type,{x:r,y:c}=Cse(t,e);return{type:n,chart:e,native:t,x:r!==void 0?r:null,y:c!==void 0?c:null}}function dN(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function uFe(t,e,n){const r=t.canvas,c=new MutationObserver(l=>{let d=!1;for(const f of l)d=d||dN(f.addedNodes,r),d=d&&!dN(f.removedNodes,r);d&&n()});return c.observe(document,{childList:!0,subtree:!0}),c}function dFe(t,e,n){const r=t.canvas,c=new MutationObserver(l=>{let d=!1;for(const f of l)d=d||dN(f.removedNodes,r),d=d&&!dN(f.addedNodes,r);d&&n()});return c.observe(document,{childList:!0,subtree:!0}),c}const fb=new Map;let eX=0;function Use(){const t=window.devicePixelRatio;t!==eX&&(eX=t,fb.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function hFe(t,e){fb.size||window.addEventListener("resize",Use),fb.set(t,e)}function fFe(t){fb.delete(t),fb.size||window.removeEventListener("resize",Use)}function pFe(t,e,n){const r=t.canvas,c=r&&l6(r);if(!c)return;const l=ose((f,m)=>{const E=c.clientWidth;n(f,m),E<c.clientWidth&&n()},window),d=new ResizeObserver(f=>{const m=f[0],E=m.contentRect.width,y=m.contentRect.height;E===0&&y===0||l(E,y)});return d.observe(c),hFe(t,l),d}function TF(t,e,n){n&&n.disconnect(),e==="resize"&&fFe(t)}function mFe(t,e,n){const r=t.canvas,c=ose(l=>{t.ctx!==null&&n(lFe(l,t))},t,l=>{const d=l[0];return[d,d.offsetX,d.offsetY]});return aFe(r,e,c),c}class gFe extends Lse{acquireContext(e,n){const r=e&&e.getContext&&e.getContext("2d");return r&&r.canvas===e?(oFe(e,n),r):null}releaseContext(e){const n=e.canvas;if(!n[XO])return!1;const r=n[XO].initial;["height","width"].forEach(l=>{const d=r[l];vi(d)?n.removeAttribute(l):n.setAttribute(l,d)});const c=r.style||{};return Object.keys(c).forEach(l=>{n.style[l]=c[l]}),n.width=n.width,delete n[XO],!0}addEventListener(e,n,r){this.removeEventListener(e,n);const c=e.$proxies||(e.$proxies={}),d={attach:uFe,detach:dFe,resize:pFe}[n]||mFe;c[n]=d(e,n,r)}removeEventListener(e,n){const r=e.$proxies||(e.$proxies={}),c=r[n];if(!c)return;({attach:TF,detach:TF,resize:TF}[n]||cFe)(e,n,c),r[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,r,c){return ZUe(e,n,r,c)}isAttached(e){const n=l6(e);return!!(n&&n.isConnected)}}function _Fe(t){return!wse()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?rFe:gFe}let wl=class{constructor(){this.x=void 0,this.y=void 0,this.active=!1,this.options=void 0,this.$animations=void 0}tooltipPosition(e){const{x:n,y:r}=this.getProps(["x","y"],e);return{x:n,y:r}}hasValue(){return ub(this.x)&&ub(this.y)}getProps(e,n){const r=this.$animations;if(!n||!r)return this;const c={};return e.forEach(l=>{c[l]=r[l]&&r[l].active()?r[l]._to:this[l]}),c}};wl.defaults={};wl.defaultRoutes=void 0;const jse={values(t){return cr(t)?t:""+t},numeric(t,e,n){if(t===0)return"0";const r=this.chart.options.locale;let c,l=t;if(n.length>1){const E=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(E<1e-4||E>1e15)&&(c="scientific"),l=EFe(t,n)}const d=xc(Math.abs(l)),f=Math.max(Math.min(-1*Math.floor(d),20),0),m={notation:c,minimumFractionDigits:f,maximumFractionDigits:f};return Object.assign(m,this.options.ticks.format),Gb(t,r,m)},logarithmic(t,e,n){if(t===0)return"0";const r=t/Math.pow(10,Math.floor(xc(t)));return r===1||r===2||r===5?jse.numeric.call(this,t,e,n):""}};function EFe(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var GP={formatters:jse};Gn.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1,borderDash:[],borderDashOffset:0,borderWidth:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:GP.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}});Gn.route("scale.ticks","color","","color");Gn.route("scale.grid","color","","borderColor");Gn.route("scale.grid","borderColor","","borderColor");Gn.route("scale.title","color","","color");Gn.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"});Gn.describe("scales",{_fallback:"scale"});Gn.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"});function vFe(t,e){const n=t.options.ticks,r=n.maxTicksLimit||yFe(t),c=n.major.enabled?TFe(e):[],l=c.length,d=c[0],f=c[l-1],m=[];if(l>r)return bFe(e,m,c,l/r),m;const E=SFe(c,e,r);if(l>0){let y,w;const I=l>1?Math.round((f-d)/(l-1)):null;for(dO(e,m,E,vi(I)?0:d-I,d),y=0,w=l-1;y<w;y++)dO(e,m,E,c[y],c[y+1]);return dO(e,m,E,f,vi(I)?e.length:f+I),m}return dO(e,m,E),m}function yFe(t){const e=t.options.offset,n=t._tickSize(),r=t._length/n+(e?0:1),c=t._maxLength/n;return Math.floor(Math.min(r,c))}function SFe(t,e,n){const r=wFe(t),c=e.length/n;if(!r)return Math.max(c,1);const l=q2e(r);for(let d=0,f=l.length-1;d<f;d++){const m=l[d];if(m>c)return m}return Math.max(c,1)}function TFe(t){const e=[];let n,r;for(n=0,r=t.length;n<r;n++)t[n].major&&e.push(n);return e}function bFe(t,e,n,r){let c=0,l=n[0],d;for(r=Math.ceil(r),d=0;d<t.length;d++)d===l&&(e.push(t[d]),c++,l=n[c*r])}function dO(t,e,n,r,c){const l=An(r,0),d=Math.min(An(c,t.length),t.length);let f=0,m,E,y;for(n=Math.ceil(n),c&&(m=c-r,n=m/Math.floor(m/n)),y=l;y<0;)f++,y=Math.round(l+f*n);for(E=Math.max(l,0);E<d;E++)E===y&&(e.push(t[E]),f++,y=Math.round(l+f*n))}function wFe(t){const e=t.length;let n,r;if(e<2)return!1;for(r=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==r)return!1;return r}const CFe=t=>t==="left"?"right":t==="right"?"left":t,tX=(t,e,n)=>e==="top"||e==="left"?t[e]+n:t[e]-n;function nX(t,e){const n=[],r=t.length/e,c=t.length;let l=0;for(;l<c;l+=r)n.push(t[Math.floor(l)]);return n}function RFe(t,e,n){const r=t.ticks.length,c=Math.min(e,r-1),l=t._startPixel,d=t._endPixel,f=1e-6;let m=t.getPixelForTick(c),E;if(!(n&&(r===1?E=Math.max(m-l,d-m):e===0?E=(t.getPixelForTick(1)-m)/2:E=(m-t.getPixelForTick(c-1))/2,m+=c<e?E:-E,m<l-f||m>d+f)))return m}function IFe(t,e){Ei(t,n=>{const r=n.gc,c=r.length/2;let l;if(c>e){for(l=0;l<c;++l)delete n.data[r[l]];r.splice(0,c)}})}function qS(t){return t.drawTicks?t.tickLength:0}function iX(t,e){if(!t.display)return 0;const n=Es(t.font,e),r=Io(t.padding);return(cr(t.text)?t.text.length:1)*n.lineHeight+r.height}function AFe(t,e){return rp(t,{scale:e,type:"scale"})}function OFe(t,e,n){return rp(t,{tick:n,index:e,type:"tick"})}function NFe(t,e,n){let r=Y5(t);return(n&&e!=="right"||!n&&e==="right")&&(r=CFe(r)),r}function PFe(t,e,n,r){const{top:c,left:l,bottom:d,right:f,chart:m}=t,{chartArea:E,scales:y}=m;let w=0,I,P,k;const M=d-c,K=f-l;if(t.isHorizontal()){if(P=So(r,l,f),oi(n)){const W=Object.keys(n)[0],V=n[W];k=y[W].getPixelForValue(V)+M-e}else n==="center"?k=(E.bottom+E.top)/2+M-e:k=tX(t,n,e);I=f-l}else{if(oi(n)){const W=Object.keys(n)[0],V=n[W];P=y[W].getPixelForValue(V)-K+e}else n==="center"?P=(E.left+E.right)/2-K+e:P=tX(t,n,e);k=So(r,d,c),w=n==="left"?-Lr:Lr}return{titleX:P,titleY:k,maxWidth:I,rotation:w}}class Tg extends wl{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:r,_suggestedMax:c}=this;return e=Ac(e,Number.POSITIVE_INFINITY),n=Ac(n,Number.NEGATIVE_INFINITY),r=Ac(r,Number.POSITIVE_INFINITY),c=Ac(c,Number.NEGATIVE_INFINITY),{min:Ac(e,r),max:Ac(n,c),minDefined:qs(e),maxDefined:qs(n)}}getMinMax(e){let{min:n,max:r,minDefined:c,maxDefined:l}=this.getUserBounds(),d;if(c&&l)return{min:n,max:r};const f=this.getMatchingVisibleMetas();for(let m=0,E=f.length;m<E;++m)d=f[m].controller.getMinMax(this,e),c||(n=Math.min(n,d.min)),l||(r=Math.max(r,d.max));return n=l&&n>r?r:n,r=c&&n>r?n:r,{min:Ac(n,Ac(r,n)),max:Ac(r,Ac(n,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Xi(this.options.beforeUpdate,[this])}update(e,n,r){const{beginAtZero:c,grace:l,ticks:d}=this.options,f=d.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=AUe(this,l,c),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const m=f<this.ticks.length;this._convertTicksToLabels(m?nX(this.ticks,f):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),d.display&&(d.autoSkip||d.source==="auto")&&(this.ticks=vFe(this,this.ticks),this._labelSizes=null),m&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,r;this.isHorizontal()?(n=this.left,r=this.right):(n=this.top,r=this.bottom,e=!e),this._startPixel=n,this._endPixel=r,this._reversePixels=e,this._length=r-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Xi(this.options.afterUpdate,[this])}beforeSetDimensions(){Xi(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Xi(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Xi(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Xi(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let r,c,l;for(r=0,c=e.length;r<c;r++)l=e[r],l.label=Xi(n.callback,[l.value,r,e],this)}afterTickToLabelConversion(){Xi(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Xi(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,r=this.ticks.length,c=n.minRotation||0,l=n.maxRotation;let d=c,f,m,E;if(!this._isVisible()||!n.display||c>=l||r<=1||!this.isHorizontal()){this.labelRotation=c;return}const y=this._getLabelSizes(),w=y.widest.width,I=y.highest.height,P=wo(this.chart.width-w,0,this.maxWidth);f=e.offset?this.maxWidth/r:P/(r-1),w+6>f&&(f=P/(r-(e.offset?.5:1)),m=this.maxHeight-qS(e.grid)-n.padding-iX(e.title,this.chart.options.font),E=Math.sqrt(w*w+I*I),d=J5(Math.min(Math.asin(wo((y.highest.height+6)/f,-1,1)),Math.asin(wo(m/E,-1,1))-Math.asin(wo(I/E,-1,1)))),d=Math.max(c,Math.min(l,d))),this.labelRotation=d}afterCalculateLabelRotation(){Xi(this.options.afterCalculateLabelRotation,[this])}beforeFit(){Xi(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:r,title:c,grid:l}}=this,d=this._isVisible(),f=this.isHorizontal();if(d){const m=iX(c,n.options.font);if(f?(e.width=this.maxWidth,e.height=qS(l)+m):(e.height=this.maxHeight,e.width=qS(l)+m),r.display&&this.ticks.length){const{first:E,last:y,widest:w,highest:I}=this._getLabelSizes(),P=r.padding*2,k=yl(this.labelRotation),M=Math.cos(k),K=Math.sin(k);if(f){const W=r.mirror?0:K*w.width+M*I.height;e.height=Math.min(this.maxHeight,e.height+W+P)}else{const W=r.mirror?0:M*w.width+K*I.height;e.width=Math.min(this.maxWidth,e.width+W+P)}this._calculatePadding(E,y,K,M)}}this._handleMargins(),f?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,r,c){const{ticks:{align:l,padding:d},position:f}=this.options,m=this.labelRotation!==0,E=f!=="top"&&this.axis==="x";if(this.isHorizontal()){const y=this.getPixelForTick(0)-this.left,w=this.right-this.getPixelForTick(this.ticks.length-1);let I=0,P=0;m?E?(I=c*e.width,P=r*n.height):(I=r*e.height,P=c*n.width):l==="start"?P=n.width:l==="end"?I=e.width:(I=e.width/2,P=n.width/2),this.paddingLeft=Math.max((I-y+d)*this.width/(this.width-y),0),this.paddingRight=Math.max((P-w+d)*this.width/(this.width-w),0)}else{let y=n.height/2,w=e.height/2;l==="start"?(y=0,w=e.height):l==="end"&&(y=n.height,w=0),this.paddingTop=y+d,this.paddingBottom=w+d}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Xi(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,r;for(n=0,r=e.length;n<r;n++)vi(e[n].label)&&(e.splice(n,1),r--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let r=this.ticks;n<r.length&&(r=nX(r,n)),this._labelSizes=e=this._computeLabelSizes(r,r.length)}return e}_computeLabelSizes(e,n){const{ctx:r,_longestTextCache:c}=this,l=[],d=[];let f=0,m=0,E,y,w,I,P,k,M,K,W,V,G;for(E=0;E<n;++E){if(I=e[E].label,P=this._resolveTickFontOptions(E),r.font=k=P.string,M=c[k]=c[k]||{data:{},gc:[]},K=P.lineHeight,W=V=0,!vi(I)&&!cr(I))W=aN(r,M.data,M.gc,W,I),V=K;else if(cr(I))for(y=0,w=I.length;y<w;++y)G=I[y],!vi(G)&&!cr(G)&&(W=aN(r,M.data,M.gc,W,G),V+=K);l.push(W),d.push(V),f=Math.max(W,f),m=Math.max(V,m)}IFe(c,n);const Q=l.indexOf(f),Z=d.indexOf(m),Y=oe=>({width:l[oe]||0,height:d[oe]||0});return{first:Y(0),last:Y(n-1),widest:Y(Q),highest:Y(Z),widths:l,heights:d}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return J2e(this._alignToPixels?Em(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const r=n[e];return r.$context||(r.$context=OFe(this.getContext(),e,r))}return this.$context||(this.$context=AFe(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=yl(this.labelRotation),r=Math.abs(Math.cos(n)),c=Math.abs(Math.sin(n)),l=this._getLabelSizes(),d=e.autoSkipPadding||0,f=l?l.widest.width+d:0,m=l?l.highest.height+d:0;return this.isHorizontal()?m*r>f*c?f/r:m/c:m*c<f*r?m/r:f/c}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,r=this.chart,c=this.options,{grid:l,position:d}=c,f=l.offset,m=this.isHorizontal(),y=this.ticks.length+(f?1:0),w=qS(l),I=[],P=l.setContext(this.getContext()),k=P.drawBorder?P.borderWidth:0,M=k/2,K=function(He){return Em(r,He,k)};let W,V,G,Q,Z,Y,oe,ce,Se,xe,je,Ge;if(d==="top")W=K(this.bottom),Y=this.bottom-w,ce=W-M,xe=K(e.top)+M,Ge=e.bottom;else if(d==="bottom")W=K(this.top),xe=e.top,Ge=K(e.bottom)-M,Y=W+M,ce=this.top+w;else if(d==="left")W=K(this.right),Z=this.right-w,oe=W-M,Se=K(e.left)+M,je=e.right;else if(d==="right")W=K(this.left),Se=e.left,je=K(e.right)-M,Z=W+M,oe=this.left+w;else if(n==="x"){if(d==="center")W=K((e.top+e.bottom)/2+.5);else if(oi(d)){const He=Object.keys(d)[0],be=d[He];W=K(this.chart.scales[He].getPixelForValue(be))}xe=e.top,Ge=e.bottom,Y=W+M,ce=Y+w}else if(n==="y"){if(d==="center")W=K((e.left+e.right)/2);else if(oi(d)){const He=Object.keys(d)[0],be=d[He];W=K(this.chart.scales[He].getPixelForValue(be))}Z=W-M,oe=Z-w,Se=e.left,je=e.right}const ze=An(c.ticks.maxTicksLimit,y),Ke=Math.max(1,Math.ceil(y/ze));for(V=0;V<y;V+=Ke){const He=l.setContext(this.getContext(V)),be=He.lineWidth,Oe=He.color,_e=l.borderDash||[],We=He.borderDashOffset,Ie=He.tickWidth,De=He.tickColor,Ue=He.tickBorderDash||[],rt=He.tickBorderDashOffset;G=RFe(this,V,f),G!==void 0&&(Q=Em(r,G,be),m?Z=oe=Se=je=Q:Y=ce=xe=Ge=Q,I.push({tx1:Z,ty1:Y,tx2:oe,ty2:ce,x1:Se,y1:xe,x2:je,y2:Ge,width:be,color:Oe,borderDash:_e,borderDashOffset:We,tickWidth:Ie,tickColor:De,tickBorderDash:Ue,tickBorderDashOffset:rt}))}return this._ticksLength=y,this._borderValue=W,I}_computeLabelItems(e){const n=this.axis,r=this.options,{position:c,ticks:l}=r,d=this.isHorizontal(),f=this.ticks,{align:m,crossAlign:E,padding:y,mirror:w}=l,I=qS(r.grid),P=I+y,k=w?-y:P,M=-yl(this.labelRotation),K=[];let W,V,G,Q,Z,Y,oe,ce,Se,xe,je,Ge,ze="middle";if(c==="top")Y=this.bottom-k,oe=this._getXAxisLabelAlignment();else if(c==="bottom")Y=this.top+k,oe=this._getXAxisLabelAlignment();else if(c==="left"){const He=this._getYAxisLabelAlignment(I);oe=He.textAlign,Z=He.x}else if(c==="right"){const He=this._getYAxisLabelAlignment(I);oe=He.textAlign,Z=He.x}else if(n==="x"){if(c==="center")Y=(e.top+e.bottom)/2+P;else if(oi(c)){const He=Object.keys(c)[0],be=c[He];Y=this.chart.scales[He].getPixelForValue(be)+P}oe=this._getXAxisLabelAlignment()}else if(n==="y"){if(c==="center")Z=(e.left+e.right)/2-P;else if(oi(c)){const He=Object.keys(c)[0],be=c[He];Z=this.chart.scales[He].getPixelForValue(be)}oe=this._getYAxisLabelAlignment(I).textAlign}n==="y"&&(m==="start"?ze="top":m==="end"&&(ze="bottom"));const Ke=this._getLabelSizes();for(W=0,V=f.length;W<V;++W){G=f[W],Q=G.label;const He=l.setContext(this.getContext(W));ce=this.getPixelForTick(W)+l.labelOffset,Se=this._resolveTickFontOptions(W),xe=Se.lineHeight,je=cr(Q)?Q.length:1;const be=je/2,Oe=He.color,_e=He.textStrokeColor,We=He.textStrokeWidth;d?(Z=ce,c==="top"?E==="near"||M!==0?Ge=-je*xe+xe/2:E==="center"?Ge=-Ke.highest.height/2-be*xe+xe:Ge=-Ke.highest.height+xe/2:E==="near"||M!==0?Ge=xe/2:E==="center"?Ge=Ke.highest.height/2-be*xe:Ge=Ke.highest.height-je*xe,w&&(Ge*=-1)):(Y=ce,Ge=(1-je)*xe/2);let Ie;if(He.showLabelBackdrop){const De=Io(He.backdropPadding),Ue=Ke.heights[W],rt=Ke.widths[W];let gt=Y+Ge-De.top,ft=Z-De.left;switch(ze){case"middle":gt-=Ue/2;break;case"bottom":gt-=Ue;break}switch(oe){case"center":ft-=rt/2;break;case"right":ft-=rt;break}Ie={left:ft,top:gt,width:rt+De.width,height:Ue+De.height,color:He.backdropColor}}K.push({rotation:M,label:Q,font:Se,color:Oe,strokeColor:_e,strokeWidth:We,textOffset:Ge,textAlign:oe,textBaseline:ze,translation:[Z,Y],backdrop:Ie})}return K}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-yl(this.labelRotation))return e==="top"?"left":"right";let c="center";return n.align==="start"?c="left":n.align==="end"&&(c="right"),c}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:r,mirror:c,padding:l}}=this.options,d=this._getLabelSizes(),f=e+l,m=d.widest.width;let E,y;return n==="left"?c?(y=this.right+l,r==="near"?E="left":r==="center"?(E="center",y+=m/2):(E="right",y+=m)):(y=this.right-f,r==="near"?E="right":r==="center"?(E="center",y-=m/2):(E="left",y=this.left)):n==="right"?c?(y=this.left+l,r==="near"?E="right":r==="center"?(E="center",y-=m/2):(E="left",y-=m)):(y=this.left+f,r==="near"?E="left":r==="center"?(E="center",y+=m/2):(E="right",y=this.right)):E="right",{textAlign:E,x:y}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:r,top:c,width:l,height:d}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(r,c,l,d),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const c=this.ticks.findIndex(l=>l.value===e);return c>=0?n.setContext(this.getContext(c)).lineWidth:0}drawGrid(e){const n=this.options.grid,r=this.ctx,c=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let l,d;const f=(m,E,y)=>{!y.width||!y.color||(r.save(),r.lineWidth=y.width,r.strokeStyle=y.color,r.setLineDash(y.borderDash||[]),r.lineDashOffset=y.borderDashOffset,r.beginPath(),r.moveTo(m.x,m.y),r.lineTo(E.x,E.y),r.stroke(),r.restore())};if(n.display)for(l=0,d=c.length;l<d;++l){const m=c[l];n.drawOnChartArea&&f({x:m.x1,y:m.y1},{x:m.x2,y:m.y2},m),n.drawTicks&&f({x:m.tx1,y:m.ty1},{x:m.tx2,y:m.ty2},{color:m.tickColor,width:m.tickWidth,borderDash:m.tickBorderDash,borderDashOffset:m.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{grid:r}}=this,c=r.setContext(this.getContext()),l=r.drawBorder?c.borderWidth:0;if(!l)return;const d=r.setContext(this.getContext(0)).lineWidth,f=this._borderValue;let m,E,y,w;this.isHorizontal()?(m=Em(e,this.left,l)-l/2,E=Em(e,this.right,d)+d/2,y=w=f):(y=Em(e,this.top,l)-l/2,w=Em(e,this.bottom,d)+d/2,m=E=f),n.save(),n.lineWidth=c.borderWidth,n.strokeStyle=c.borderColor,n.beginPath(),n.moveTo(m,y),n.lineTo(E,w),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const r=this.ctx,c=this._computeLabelArea();c&&n6(r,c);const l=this._labelItems||(this._labelItems=this._computeLabelItems(e));let d,f;for(d=0,f=l.length;d<f;++d){const m=l[d],E=m.font,y=m.label;m.backdrop&&(r.fillStyle=m.backdrop.color,r.fillRect(m.backdrop.left,m.backdrop.top,m.backdrop.width,m.backdrop.height));let w=m.textOffset;ag(r,y,0,w,E,m)}c&&i6(r)}drawTitle(){const{ctx:e,options:{position:n,title:r,reverse:c}}=this;if(!r.display)return;const l=Es(r.font),d=Io(r.padding),f=r.align;let m=l.lineHeight/2;n==="bottom"||n==="center"||oi(n)?(m+=d.bottom,cr(r.text)&&(m+=l.lineHeight*(r.text.length-1))):m+=d.top;const{titleX:E,titleY:y,maxWidth:w,rotation:I}=PFe(this,m,n,f);ag(e,r.text,0,0,l,{color:r.color,maxWidth:w,rotation:I,textAlign:NFe(f,n,c),textBaseline:"middle",translation:[E,y]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,r=An(e.grid&&e.grid.z,-1);return!this._isVisible()||this.draw!==Tg.prototype.draw?[{z:n,draw:c=>{this.draw(c)}}]:[{z:r,draw:c=>{this.drawBackground(),this.drawGrid(c),this.drawTitle()}},{z:r+1,draw:()=>{this.drawBorder()}},{z:n,draw:c=>{this.drawLabels(c)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",c=[];let l,d;for(l=0,d=n.length;l<d;++l){const f=n[l];f[r]===this.id&&(!e||f.type===e)&&c.push(f)}return c}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return Es(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class hO{constructor(e,n,r){this.type=e,this.scope=n,this.override=r,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let r;kFe(n)&&(r=this.register(n));const c=this.items,l=e.id,d=this.scope+"."+l;if(!l)throw new Error("class does not have id: "+e);return l in c||(c[l]=e,xFe(e,d,r),this.override&&Gn.override(e.id,e.overrides)),d}get(e){return this.items[e]}unregister(e){const n=this.items,r=e.id,c=this.scope;r in n&&delete n[r],c&&r in Gn[c]&&(delete Gn[c][r],this.override&&delete sg[r])}}function xFe(t,e,n){const r=lb(Object.create(null),[n?Gn.get(n):{},Gn.get(e),t.defaults]);Gn.set(e,r),t.defaultRoutes&&DFe(e,t.defaultRoutes),t.descriptors&&Gn.describe(e,t.descriptors)}function DFe(t,e){Object.keys(e).forEach(n=>{const r=n.split("."),c=r.pop(),l=[t].concat(r).join("."),d=e[n].split("."),f=d.pop(),m=d.join(".");Gn.route(l,c,m,f)})}function kFe(t){return"id"in t&&"defaults"in t}class LFe{constructor(){this.controllers=new hO(Mu,"datasets",!0),this.elements=new hO(wl,"elements"),this.plugins=new hO(Object,"plugins"),this.scales=new hO(Tg,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,r){[...n].forEach(c=>{const l=r||this._getRegistryForType(c);r||l.isForType(c)||l===this.plugins&&c.id?this._exec(e,l,c):Ei(c,d=>{const f=r||this._getRegistryForType(d);this._exec(e,f,d)})})}_exec(e,n,r){const c=X5(e);Xi(r["before"+c],[],r),n[e](r),Xi(r["after"+c],[],r)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const r=this._typedRegistries[n];if(r.isForType(e))return r}return this.plugins}_get(e,n,r){const c=n.get(e);if(c===void 0)throw new Error('"'+e+'" is not a registered '+r+".");return c}}var Pd=new LFe;class MFe{constructor(){this._init=[]}notify(e,n,r,c){n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const l=c?this._descriptors(e).filter(c):this._descriptors(e),d=this._notify(l,e,n,r);return n==="afterDestroy"&&(this._notify(l,e,"stop"),this._notify(this._init,e,"uninstall")),d}_notify(e,n,r,c){c=c||{};for(const l of e){const d=l.plugin,f=d[r],m=[n,c,l.options];if(Xi(f,m,d)===!1&&c.cancelable)return!1}return!0}invalidate(){vi(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const r=e&&e.config,c=An(r.options&&r.options.plugins,{}),l=UFe(r);return c===!1&&!n?[]:FFe(e,l,c,n)}_notifyStateChanges(e){const n=this._oldCache||[],r=this._cache,c=(l,d)=>l.filter(f=>!d.some(m=>f.plugin.id===m.plugin.id));this._notify(c(n,r),e,"stop"),this._notify(c(r,n),e,"start")}}function UFe(t){const e=[],n=Object.keys(Pd.plugins.items);for(let c=0;c<n.length;c++)e.push(Pd.getPlugin(n[c]));const r=t.plugins||[];for(let c=0;c<r.length;c++){const l=r[c];e.indexOf(l)===-1&&e.push(l)}return e}function jFe(t,e){return!e&&t===!1?null:t===!0?{}:t}function FFe(t,e,n,r){const c=[],l=t.getContext();for(let d=0;d<e.length;d++){const f=e[d],m=f.id,E=jFe(n[m],r);E!==null&&c.push({plugin:f,options:VFe(t.config,f,E,l)})}return c}function VFe(t,e,n,r){const c=t.pluginScopeKeys(e),l=t.getOptionScopes(n,c);return t.createResolver(l,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function XV(t,e){const n=Gn.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function BFe(t,e){let n=t;return t==="_index_"?n=e:t==="_value_"&&(n=e==="x"?"y":"x"),n}function WFe(t,e){return t===e?"_index_":"_value_"}function HFe(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function JV(t,e){return t==="x"||t==="y"?t:e.axis||HFe(e.position)||t.charAt(0).toLowerCase()}function $Fe(t,e){const n=sg[t.type]||{scales:{}},r=e.scales||{},c=XV(t.type,e),l=Object.create(null),d=Object.create(null);return Object.keys(r).forEach(f=>{const m=r[f];if(!oi(m))return console.error(`Invalid scale configuration for scale: ${f}`);if(m._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${f}`);const E=JV(f,m),y=WFe(E,c),w=n.scales||{};l[E]=l[E]||f,d[f]=RT(Object.create(null),[{axis:E},m,w[E],w[y]])}),t.data.datasets.forEach(f=>{const m=f.type||t.type,E=f.indexAxis||XV(m,e),w=(sg[m]||{}).scales||{};Object.keys(w).forEach(I=>{const P=BFe(I,E),k=f[P+"AxisID"]||l[P]||P;d[k]=d[k]||Object.create(null),RT(d[k],[{axis:P},r[k],w[I]])})}),Object.keys(d).forEach(f=>{const m=d[f];RT(m,[Gn.scales[m.type],Gn.scale])}),d}function Fse(t){const e=t.options||(t.options={});e.plugins=An(e.plugins,{}),e.scales=$Fe(t,e)}function Vse(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function zFe(t){return t=t||{},t.data=Vse(t.data),Fse(t),t}const rX=new Map,Bse=new Set;function fO(t,e){let n=rX.get(t);return n||(n=e(),rX.set(t,n),Bse.add(n)),n}const YS=(t,e,n)=>{const r=rg(e,n);r!==void 0&&t.add(r)};class GFe{constructor(e){this._config=zFe(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=Vse(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),Fse(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return fO(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return fO(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return fO(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,r=this.type;return fO(`${r}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const r=this._scopeCache;let c=r.get(e);return(!c||n)&&(c=new Map,r.set(e,c)),c}getOptionScopes(e,n,r){const{options:c,type:l}=this,d=this._cachedScopes(e,r),f=d.get(n);if(f)return f;const m=new Set;n.forEach(y=>{e&&(m.add(e),y.forEach(w=>YS(m,e,w))),y.forEach(w=>YS(m,c,w)),y.forEach(w=>YS(m,sg[l]||{},w)),y.forEach(w=>YS(m,Gn,w)),y.forEach(w=>YS(m,qV,w))});const E=Array.from(m);return E.length===0&&E.push(Object.create(null)),Bse.has(n)&&d.set(n,E),E}chartOptionScopes(){const{options:e,type:n}=this;return[e,sg[n]||{},Gn.datasets[n]||{},{type:n},Gn,qV]}resolveNamedOptions(e,n,r,c=[""]){const l={$shared:!0},{resolver:d,subPrefixes:f}=sX(this._resolverCache,e,c);let m=d;if(qFe(d,n)){l.$shared=!1,r=Gf(r)?r():r;const E=this.createResolver(e,r,f);m=Iv(d,r,E)}for(const E of n)l[E]=m[E];return l}createResolver(e,n,r=[""],c){const{resolver:l}=sX(this._resolverCache,e,r);return oi(n)?Iv(l,n,void 0,c):l}}function sX(t,e,n){let r=t.get(e);r||(r=new Map,t.set(e,r));const c=n.join();let l=r.get(c);return l||(l={resolver:o6(e,n),subPrefixes:n.filter(f=>!f.toLowerCase().includes("hover"))},r.set(c,l)),l}const KFe=t=>oi(t)&&Object.getOwnPropertyNames(t).reduce((e,n)=>e||Gf(t[n]),!1);function qFe(t,e){const{isScriptable:n,isIndexable:r}=vse(t);for(const c of e){const l=n(c),d=r(c),f=(d||l)&&t[c];if(l&&(Gf(f)||KFe(f))||d&&cr(f))return!0}return!1}var YFe="3.7.0";const XFe=["top","bottom","left","right","chartArea"];function oX(t,e){return t==="top"||t==="bottom"||XFe.indexOf(t)===-1&&e==="x"}function aX(t,e){return function(n,r){return n[t]===r[t]?n[e]-r[e]:n[t]-r[t]}}function cX(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),Xi(n&&n.onComplete,[t],e)}function JFe(t){const e=t.chart,n=e.options.animation;Xi(n&&n.onProgress,[t],e)}function Wse(t){return wse()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const hN={},Hse=t=>{const e=Wse(t);return Object.values(hN).filter(n=>n.canvas===e).pop()};function QFe(t,e,n){const r=Object.keys(t);for(const c of r){const l=+c;if(l>=e){const d=t[c];delete t[c],(n>0||l>e)&&(t[l+n]=d)}}}function ZFe(t,e,n,r){return!n||t.type==="mouseout"?null:r?e:t}let Vv=class{constructor(e,n){const r=this.config=new GFe(n),c=Wse(e),l=Hse(c);if(l)throw new Error("Canvas is already in use. Chart with ID '"+l.id+"' must be destroyed before the canvas can be reused.");const d=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||_Fe(c)),this.platform.updateConfig(r);const f=this.platform.acquireContext(c,d.aspectRatio),m=f&&f.canvas,E=m&&m.height,y=m&&m.width;if(this.id=F2e(),this.ctx=f,this.canvas=m,this.width=y,this.height=E,this._options=d,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new MFe,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=U2e(w=>this.update(w),d.resizeDelay||0),this._dataChanges=[],hN[this.id]=this,!f||!m){console.error("Failed to create chart: can't acquire context from the given item");return}yd.listen(this,"complete",cX),yd.listen(this,"progress",JFe),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:r,height:c,_aspectRatio:l}=this;return vi(e)?n&&l?l:c?r/c:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():DY(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return OY(this.canvas,this.ctx),this}stop(){return yd.stop(this),this}resize(e,n){yd.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const r=this.options,c=this.canvas,l=r.maintainAspectRatio&&this.aspectRatio,d=this.platform.getMaximumSize(c,e,n,l),f=r.devicePixelRatio||this.platform.getDevicePixelRatio(),m=this.width?"resize":"attach";this.width=d.width,this.height=d.height,this._aspectRatio=this.aspectRatio,DY(this,f,!0)&&(this.notifyPlugins("resize",{size:d}),Xi(r.onResize,[this,d],this),this.attached&&this._doResize(m)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};Ei(n,(r,c)=>{r.id=c})}buildOrUpdateScales(){const e=this.options,n=e.scales,r=this.scales,c=Object.keys(r).reduce((d,f)=>(d[f]=!1,d),{});let l=[];n&&(l=l.concat(Object.keys(n).map(d=>{const f=n[d],m=JV(d,f),E=m==="r",y=m==="x";return{options:f,dposition:E?"chartArea":y?"bottom":"left",dtype:E?"radialLinear":y?"category":"linear"}}))),Ei(l,d=>{const f=d.options,m=f.id,E=JV(m,f),y=An(f.type,d.dtype);(f.position===void 0||oX(f.position,E)!==oX(d.dposition))&&(f.position=d.dposition),c[m]=!0;let w=null;if(m in r&&r[m].type===y)w=r[m];else{const I=Pd.getScale(y);w=new I({id:m,type:y,ctx:this.ctx,chart:this}),r[w.id]=w}w.init(f,e)}),Ei(c,(d,f)=>{d||delete r[f]}),Ei(r,d=>{kc.configure(this,d,d.options),kc.addBox(this,d)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,r=e.length;if(e.sort((c,l)=>c.index-l.index),r>n){for(let c=n;c<r;++c)this._destroyDatasetMeta(c);e.splice(n,r-n)}this._sortedMetasets=e.slice(0).sort(aX("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((r,c)=>{n.filter(l=>l===r._dataset).length===0&&this._destroyDatasetMeta(c)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let r,c;for(this._removeUnreferencedMetasets(),r=0,c=n.length;r<c;r++){const l=n[r];let d=this.getDatasetMeta(r);const f=l.type||this.config.type;if(d.type&&d.type!==f&&(this._destroyDatasetMeta(r),d=this.getDatasetMeta(r)),d.type=f,d.indexAxis=l.indexAxis||XV(f,this.options),d.order=l.order||0,d.index=r,d.label=""+l.label,d.visible=this.isDatasetVisible(r),d.controller)d.controller.updateIndex(r),d.controller.linkScales();else{const m=Pd.getController(f),{datasetElementType:E,dataElementType:y}=Gn.datasets[f];Object.assign(m.prototype,{dataElementType:Pd.getElement(y),datasetElementType:E&&Pd.getElement(E)}),d.controller=new m(this,r),e.push(d.controller)}}return this._updateMetasets(),e}_resetElements(){Ei(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const r=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),c=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const l=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let d=0;for(let E=0,y=this.data.datasets.length;E<y;E++){const{controller:w}=this.getDatasetMeta(E),I=!c&&l.indexOf(w)===-1;w.buildOrUpdateElements(I),d=Math.max(+w.getMaxOverflow(),d)}d=this._minPadding=r.layout.autoPadding?d:0,this._updateLayout(d),c||Ei(l,E=>{E.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(aX("z","_idx"));const{_active:f,_lastEvent:m}=this;m?this._eventHandler(m,!0):f.length&&this._updateHoverStyles(f,f,!0),this.render()}_updateScales(){Ei(this.scales,e=>{kc.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),r=new Set(e.events);(!EY(n,r)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:r,start:c,count:l}of n){const d=r==="_removeElements"?-l:l;QFe(e,c,d)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,r=l=>new Set(e.filter(d=>d[0]===l).map((d,f)=>f+","+d.splice(1).join(","))),c=r(0);for(let l=1;l<n;l++)if(!EY(c,r(l)))return;return Array.from(c).map(l=>l.split(",")).map(l=>({method:l[1],start:+l[2],count:+l[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;kc.update(this,this.width,this.height,e);const n=this.chartArea,r=n.width<=0||n.height<=0;this._layers=[],Ei(this.boxes,c=>{r&&c.position==="chartArea"||(c.configure&&c.configure(),this._layers.push(...c._layers()))},this),this._layers.forEach((c,l)=>{c._idx=l}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,r=this.data.datasets.length;n<r;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,r=this.data.datasets.length;n<r;++n)this._updateDataset(n,Gf(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const r=this.getDatasetMeta(e),c={meta:r,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",c)!==!1&&(r.controller._update(n),c.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",c))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(yd.has(this)?this.attached&&!yd.running(this)&&yd.start(this):(this.draw(),cX({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:r,height:c}=this._resizeBeforeDraw;this._resize(r,c),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,r=[];let c,l;for(c=0,l=n.length;c<l;++c){const d=n[c];(!e||d.visible)&&r.push(d)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,r=e._clip,c=!r.disabled,l=this.chartArea,d={meta:e,index:e.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",d)!==!1&&(c&&n6(n,{left:r.left===!1?0:l.left-r.left,right:r.right===!1?this.width:l.right+r.right,top:r.top===!1?0:l.top-r.top,bottom:r.bottom===!1?this.height:l.bottom+r.bottom}),e.controller.draw(),c&&i6(n),d.cancelable=!1,this.notifyPlugins("afterDatasetDraw",d))}getElementsAtEventForMode(e,n,r,c){const l=Xje.modes[n];return typeof l=="function"?l(this,e,r,c):[]}getDatasetMeta(e){const n=this.data.datasets[e],r=this._metasets;let c=r.filter(l=>l&&l._dataset===n).pop();return c||(c={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},r.push(c)),c}getContext(){return this.$context||(this.$context=rp(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const r=this.getDatasetMeta(e);return typeof r.hidden=="boolean"?!r.hidden:!n.hidden}setDatasetVisibility(e,n){const r=this.getDatasetMeta(e);r.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,r){const c=r?"show":"hide",l=this.getDatasetMeta(e),d=l.controller._resolveAnimations(void 0,c);Fc(n)?(l.data[n].hidden=!r,this.update()):(this.setDatasetVisibility(e,r),d.update(l,{visible:r}),this.update(f=>f.datasetIndex===e?c:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),yd.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),OY(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),this.notifyPlugins("destroy"),delete hN[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,r=(l,d)=>{n.addEventListener(this,l,d),e[l]=d},c=(l,d,f)=>{l.offsetX=d,l.offsetY=f,this._eventHandler(l)};Ei(this.options.events,l=>r(l,c))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,r=(m,E)=>{n.addEventListener(this,m,E),e[m]=E},c=(m,E)=>{e[m]&&(n.removeEventListener(this,m,E),delete e[m])},l=(m,E)=>{this.canvas&&this.resize(m,E)};let d;const f=()=>{c("attach",f),this.attached=!0,this.resize(),r("resize",l),r("detach",d)};d=()=>{this.attached=!1,c("resize",l),this._stop(),this._resize(0,0),r("attach",f)},n.isAttached(this.canvas)?f():d()}unbindEvents(){Ei(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},Ei(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,r){const c=r?"set":"remove";let l,d,f,m;for(n==="dataset"&&(l=this.getDatasetMeta(e[0].datasetIndex),l.controller["_"+c+"DatasetHoverStyle"]()),f=0,m=e.length;f<m;++f){d=e[f];const E=d&&this.getDatasetMeta(d.datasetIndex).controller;E&&E[c+"HoverStyle"](d.element,d.datasetIndex,d.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],r=e.map(({datasetIndex:l,index:d})=>{const f=this.getDatasetMeta(l);if(!f)throw new Error("No dataset found at index "+l);return{datasetIndex:l,element:f.data[d],index:d}});!iN(r,n)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,n))}notifyPlugins(e,n,r){return this._plugins.notify(this,e,n,r)}_updateHoverStyles(e,n,r){const c=this.options.hover,l=(m,E)=>m.filter(y=>!E.some(w=>y.datasetIndex===w.datasetIndex&&y.index===w.index)),d=l(n,e),f=r?e:l(e,n);d.length&&this.updateHoverStyle(d,c.mode,!1),f.length&&c.mode&&this.updateHoverStyle(f,c.mode,!0)}_eventHandler(e,n){const r={event:e,replay:n,cancelable:!0,inChartArea:og(e,this.chartArea,this._minPadding)},c=d=>(d.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",r,c)===!1)return;const l=this._handleEvent(e,n,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,c),(l||r.changed)&&this.render(),this}_handleEvent(e,n,r){const{_active:c=[],options:l}=this,d=n,f=this._getActiveElements(e,c,r,d),m=z2e(e),E=ZFe(e,this._lastEvent,r,m);r&&(this._lastEvent=null,Xi(l.onHover,[e,f,this],this),m&&Xi(l.onClick,[e,f,this],this));const y=!iN(f,c);return(y||n)&&(this._active=f,this._updateHoverStyles(f,c,n)),this._lastEvent=E,y}_getActiveElements(e,n,r,c){if(e.type==="mouseout")return[];if(!r)return n;const l=this.options.hover;return this.getElementsAtEventForMode(e,l.mode,l,c)}};const lX=()=>Ei(Vv.instances,t=>t._plugins.invalidate()),nf=!0;Object.defineProperties(Vv,{defaults:{enumerable:nf,value:Gn},instances:{enumerable:nf,value:hN},overrides:{enumerable:nf,value:sg},registry:{enumerable:nf,value:Pd},version:{enumerable:nf,value:YFe},getChart:{enumerable:nf,value:Hse},register:{enumerable:nf,value:(...t)=>{Pd.add(...t),lX()}},unregister:{enumerable:nf,value:(...t)=>{Pd.remove(...t),lX()}}});function $se(t,e,n){const{startAngle:r,pixelMargin:c,x:l,y:d,outerRadius:f,innerRadius:m}=e;let E=c/f;t.beginPath(),t.arc(l,d,f,r-E,n+E),m>c?(E=c/m,t.arc(l,d,m,n+E,r-E,!0)):t.arc(l,d,c,n+Lr,r-Lr),t.closePath(),t.clip()}function e3e(t){return r6(t,["outerStart","outerEnd","innerStart","innerEnd"])}function t3e(t,e,n,r){const c=e3e(t.options.borderRadius),l=(n-e)/2,d=Math.min(l,r*e/2),f=m=>{const E=(n-Math.min(l,m))*r/2;return wo(m,0,Math.min(l,E))};return{outerStart:f(c.outerStart),outerEnd:f(c.outerEnd),innerStart:wo(c.innerStart,0,d),innerEnd:wo(c.innerEnd,0,d)}}function wE(t,e,n,r){return{x:n+t*Math.cos(e),y:r+t*Math.sin(e)}}function QV(t,e,n,r,c){const{x:l,y:d,startAngle:f,pixelMargin:m,innerRadius:E}=e,y=Math.max(e.outerRadius+r+n-m,0),w=E>0?E+r+n+m:0;let I=0;const P=c-f;if(r){const be=E>0?E-r:0,Oe=y>0?y-r:0,_e=(be+Oe)/2,We=_e!==0?P*_e/(_e+r):P;I=(P-We)/2}const k=Math.max(.001,P*y-n/br)/y,M=(P-k)/2,K=f+M+I,W=c-M-I,{outerStart:V,outerEnd:G,innerStart:Q,innerEnd:Z}=t3e(e,w,y,W-K),Y=y-V,oe=y-G,ce=K+V/Y,Se=W-G/oe,xe=w+Q,je=w+Z,Ge=K+Q/xe,ze=W-Z/je;if(t.beginPath(),t.arc(l,d,y,ce,Se),G>0){const be=wE(oe,Se,l,d);t.arc(be.x,be.y,G,Se,W+Lr)}const Ke=wE(je,W,l,d);if(t.lineTo(Ke.x,Ke.y),Z>0){const be=wE(je,ze,l,d);t.arc(be.x,be.y,Z,W+Lr,ze+Math.PI)}if(t.arc(l,d,w,W-Z/w,K+Q/w,!0),Q>0){const be=wE(xe,Ge,l,d);t.arc(be.x,be.y,Q,Ge+Math.PI,K-Lr)}const He=wE(Y,K,l,d);if(t.lineTo(He.x,He.y),V>0){const be=wE(Y,ce,l,d);t.arc(be.x,be.y,V,K-Lr,ce)}t.closePath()}function n3e(t,e,n,r){const{fullCircles:c,startAngle:l,circumference:d}=e;let f=e.endAngle;if(c){QV(t,e,n,r,l+Qi);for(let m=0;m<c;++m)t.fill();isNaN(d)||(f=l+d%Qi,d%Qi===0&&(f+=Qi))}return QV(t,e,n,r,f),t.fill(),f}function i3e(t,e,n){const{x:r,y:c,startAngle:l,pixelMargin:d,fullCircles:f}=e,m=Math.max(e.outerRadius-d,0),E=e.innerRadius+d;let y;for(n&&$se(t,e,l+Qi),t.beginPath(),t.arc(r,c,E,l+Qi,l,!0),y=0;y<f;++y)t.stroke();for(t.beginPath(),t.arc(r,c,m,l,l+Qi),y=0;y<f;++y)t.stroke()}function r3e(t,e,n,r,c){const{options:l}=e,{borderWidth:d,borderJoinStyle:f}=l,m=l.borderAlign==="inner";d&&(m?(t.lineWidth=d*2,t.lineJoin=f||"round"):(t.lineWidth=d,t.lineJoin=f||"bevel"),e.fullCircles&&i3e(t,e,m),m&&$se(t,e,c),QV(t,e,n,r,c),t.stroke())}class m6 extends wl{constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,n,r){const c=this.getProps(["x","y"],r),{angle:l,distance:d}=use(c,{x:e,y:n}),{startAngle:f,endAngle:m,innerRadius:E,outerRadius:y,circumference:w}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),I=this.options.spacing/2,k=An(w,m-f)>=Qi||db(l,f,m),M=bf(d,E+I,y+I);return k&&M}getCenterPoint(e){const{x:n,y:r,startAngle:c,endAngle:l,innerRadius:d,outerRadius:f}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius","circumference"],e),{offset:m,spacing:E}=this.options,y=(c+l)/2,w=(d+f+E+m)/2;return{x:n+Math.cos(y)*w,y:r+Math.sin(y)*w}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:n,circumference:r}=this,c=(n.offset||0)/2,l=(n.spacing||0)/2;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=r>Qi?Math.floor(r/Qi):0,r===0||this.innerRadius<0||this.outerRadius<0)return;e.save();let d=0;if(c){d=c/2;const m=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(m)*d,Math.sin(m)*d),this.circumference>=br&&(d=c)}e.fillStyle=n.backgroundColor,e.strokeStyle=n.borderColor;const f=n3e(e,this,d,l);r3e(e,this,d,l,f),e.restore()}}m6.id="arc";m6.defaults={borderAlign:"center",borderColor:"#fff",borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0};m6.defaultRoutes={backgroundColor:"backgroundColor"};function zse(t,e,n=e){t.lineCap=An(n.borderCapStyle,e.borderCapStyle),t.setLineDash(An(n.borderDash,e.borderDash)),t.lineDashOffset=An(n.borderDashOffset,e.borderDashOffset),t.lineJoin=An(n.borderJoinStyle,e.borderJoinStyle),t.lineWidth=An(n.borderWidth,e.borderWidth),t.strokeStyle=An(n.borderColor,e.borderColor)}function s3e(t,e,n){t.lineTo(n.x,n.y)}function o3e(t){return t.stepped?yUe:t.tension||t.cubicInterpolationMode==="monotone"?SUe:s3e}function Gse(t,e,n={}){const r=t.length,{start:c=0,end:l=r-1}=n,{start:d,end:f}=e,m=Math.max(c,d),E=Math.min(l,f),y=c<d&&l<d||c>f&&l>f;return{count:r,start:m,loop:e.loop,ilen:E<m&&!y?r+E-m:E-m}}function a3e(t,e,n,r){const{points:c,options:l}=e,{count:d,start:f,loop:m,ilen:E}=Gse(c,n,r),y=o3e(l);let{move:w=!0,reverse:I}=r||{},P,k,M;for(P=0;P<=E;++P)k=c[(f+(I?E-P:P))%d],!k.skip&&(w?(t.moveTo(k.x,k.y),w=!1):y(t,M,k,I,l.stepped),M=k);return m&&(k=c[(f+(I?E:0))%d],y(t,M,k,I,l.stepped)),!!m}function c3e(t,e,n,r){const c=e.points,{count:l,start:d,ilen:f}=Gse(c,n,r),{move:m=!0,reverse:E}=r||{};let y=0,w=0,I,P,k,M,K,W;const V=Q=>(d+(E?f-Q:Q))%l,G=()=>{M!==K&&(t.lineTo(y,K),t.lineTo(y,M),t.lineTo(y,W))};for(m&&(P=c[V(0)],t.moveTo(P.x,P.y)),I=0;I<=f;++I){if(P=c[V(I)],P.skip)continue;const Q=P.x,Z=P.y,Y=Q|0;Y===k?(Z<M?M=Z:Z>K&&(K=Z),y=(w*y+Q)/++w):(G(),t.lineTo(Q,Z),k=Y,w=0,M=K=Z),W=Z}G()}function ZV(t){const e=t.options,n=e.borderDash&&e.borderDash.length;return!t._decimated&&!t._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!n?c3e:a3e}function l3e(t){return t.stepped?tje:t.tension||t.cubicInterpolationMode==="monotone"?nje:Om}function u3e(t,e,n,r){let c=e._path;c||(c=e._path=new Path2D,e.path(c,n,r)&&c.closePath()),zse(t,e.options),t.stroke(c)}function d3e(t,e,n,r){const{segments:c,options:l}=e,d=ZV(e);for(const f of c)zse(t,l,f.style),t.beginPath(),d(t,e,f,{start:n,end:n+r-1})&&t.closePath(),t.stroke()}const h3e=typeof Path2D=="function";function f3e(t,e,n,r){h3e&&!e.options.segment?u3e(t,e,n,r):d3e(t,e,n,r)}class Yb extends wl{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,n){const r=this.options;if((r.tension||r.cubicInterpolationMode==="monotone")&&!r.stepped&&!this._pointsUpdated){const c=r.spanGaps?this._loop:this._fullLoop;KUe(this._points,r,e,c,n),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=dje(this,this.options.segment))}first(){const e=this.segments,n=this.points;return e.length&&n[e[0].start]}last(){const e=this.segments,n=this.points,r=e.length;return r&&n[e[r-1].end]}interpolate(e,n){const r=this.options,c=e[n],l=this.points,d=cje(this,{property:n,start:c,end:c});if(!d.length)return;const f=[],m=l3e(r);let E,y;for(E=0,y=d.length;E<y;++E){const{start:w,end:I}=d[E],P=l[w],k=l[I];if(P===k){f.push(P);continue}const M=Math.abs((c-P[n])/(k[n]-P[n])),K=m(P,k,M,r.stepped);K[n]=e[n],f.push(K)}return f.length===1?f[0]:f}pathSegment(e,n,r){return ZV(this)(e,this,n,r)}path(e,n,r){const c=this.segments,l=ZV(this);let d=this._loop;n=n||0,r=r||this.points.length-n;for(const f of c)d&=l(e,this,f,{start:n,end:n+r-1});return!!d}draw(e,n,r,c){const l=this.options||{};(this.points||[]).length&&l.borderWidth&&(e.save(),f3e(e,this,r,c),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Yb.id="line";Yb.defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};Yb.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};Yb.descriptors={_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"};function uX(t,e,n,r){const c=t.options,{[n]:l}=t.getProps([n],r);return Math.abs(e-l)<c.radius+c.hitRadius}class Xb extends wl{constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,n,r){const c=this.options,{x:l,y:d}=this.getProps(["x","y"],r);return Math.pow(e-l,2)+Math.pow(n-d,2)<Math.pow(c.hitRadius+c.radius,2)}inXRange(e,n){return uX(this,e,"x",n)}inYRange(e,n){return uX(this,e,"y",n)}getCenterPoint(e){const{x:n,y:r}=this.getProps(["x","y"],e);return{x:n,y:r}}size(e){e=e||this.options||{};let n=e.radius||0;n=Math.max(n,n&&e.hoverRadius||0);const r=n&&e.borderWidth||0;return(n+r)*2}draw(e,n){const r=this.options;this.skip||r.radius<.1||!og(this,n,this.size(r)/2)||(e.strokeStyle=r.borderColor,e.lineWidth=r.borderWidth,e.fillStyle=r.backgroundColor,cN(e,r,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}Xb.id="point";Xb.defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};Xb.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};function Kse(t,e){const{x:n,y:r,base:c,width:l,height:d}=t.getProps(["x","y","base","width","height"],e);let f,m,E,y,w;return t.horizontal?(w=d/2,f=Math.min(n,c),m=Math.max(n,c),E=r-w,y=r+w):(w=l/2,f=n-w,m=n+w,E=Math.min(r,c),y=Math.max(r,c)),{left:f,top:E,right:m,bottom:y}}function wf(t,e,n,r){return t?0:wo(e,n,r)}function p3e(t,e,n){const r=t.options.borderWidth,c=t.borderSkipped,l=gse(r);return{t:wf(c.top,l.top,0,n),r:wf(c.right,l.right,0,e),b:wf(c.bottom,l.bottom,0,n),l:wf(c.left,l.left,0,e)}}function m3e(t,e,n){const{enableBorderRadius:r}=t.getProps(["enableBorderRadius"]),c=t.options.borderRadius,l=sv(c),d=Math.min(e,n),f=t.borderSkipped,m=r||oi(c);return{topLeft:wf(!m||f.top||f.left,l.topLeft,0,d),topRight:wf(!m||f.top||f.right,l.topRight,0,d),bottomLeft:wf(!m||f.bottom||f.left,l.bottomLeft,0,d),bottomRight:wf(!m||f.bottom||f.right,l.bottomRight,0,d)}}function g3e(t){const e=Kse(t),n=e.right-e.left,r=e.bottom-e.top,c=p3e(t,n/2,r/2),l=m3e(t,n/2,r/2);return{outer:{x:e.left,y:e.top,w:n,h:r,radius:l},inner:{x:e.left+c.l,y:e.top+c.t,w:n-c.l-c.r,h:r-c.t-c.b,radius:{topLeft:Math.max(0,l.topLeft-Math.max(c.t,c.l)),topRight:Math.max(0,l.topRight-Math.max(c.t,c.r)),bottomLeft:Math.max(0,l.bottomLeft-Math.max(c.b,c.l)),bottomRight:Math.max(0,l.bottomRight-Math.max(c.b,c.r))}}}}function bF(t,e,n,r){const c=e===null,l=n===null,f=t&&!(c&&l)&&Kse(t,r);return f&&(c||bf(e,f.left,f.right))&&(l||bf(n,f.top,f.bottom))}function _3e(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function E3e(t,e){t.rect(e.x,e.y,e.w,e.h)}function wF(t,e,n={}){const r=t.x!==n.x?-e:0,c=t.y!==n.y?-e:0,l=(t.x+t.w!==n.x+n.w?e:0)-r,d=(t.y+t.h!==n.y+n.h?e:0)-c;return{x:t.x+r,y:t.y+c,w:t.w+l,h:t.h+d,radius:t.radius}}class KP extends wl{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:n,options:{borderColor:r,backgroundColor:c}}=this,{inner:l,outer:d}=g3e(this),f=_3e(d.radius)?lN:E3e;e.save(),(d.w!==l.w||d.h!==l.h)&&(e.beginPath(),f(e,wF(d,n,l)),e.clip(),f(e,wF(l,-n,d)),e.fillStyle=r,e.fill("evenodd")),e.beginPath(),f(e,wF(l,n)),e.fillStyle=c,e.fill(),e.restore()}inRange(e,n,r){return bF(this,e,n,r)}inXRange(e,n){return bF(this,e,null,n)}inYRange(e,n){return bF(this,null,e,n)}getCenterPoint(e){const{x:n,y:r,base:c,horizontal:l}=this.getProps(["x","y","base","horizontal"],e);return{x:l?(n+c)/2:n,y:l?r:(r+c)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}KP.id="bar";KP.defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};KP.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};const dX=(t,e)=>{let{boxHeight:n=e,boxWidth:r=e}=t;return t.usePointStyle&&(n=Math.min(n,e),r=Math.min(r,e)),{boxWidth:r,boxHeight:n,itemHeight:Math.max(e,n)}},v3e=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class hX extends wl{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,r){this.maxWidth=e,this.maxHeight=n,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=Xi(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(r=>e.filter(r,this.chart.data))),e.sort&&(n=n.sort((r,c)=>e.sort(r,c,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const r=e.labels,c=Es(r.font),l=c.size,d=this._computeTitleHeight(),{boxWidth:f,itemHeight:m}=dX(r,l);let E,y;n.font=c.string,this.isHorizontal()?(E=this.maxWidth,y=this._fitRows(d,l,f,m)+10):(y=this.maxHeight,E=this._fitCols(d,l,f,m)+10),this.width=Math.min(E,e.maxWidth||this.maxWidth),this.height=Math.min(y,e.maxHeight||this.maxHeight)}_fitRows(e,n,r,c){const{ctx:l,maxWidth:d,options:{labels:{padding:f}}}=this,m=this.legendHitBoxes=[],E=this.lineWidths=[0],y=c+f;let w=e;l.textAlign="left",l.textBaseline="middle";let I=-1,P=-y;return this.legendItems.forEach((k,M)=>{const K=r+n/2+l.measureText(k.text).width;(M===0||E[E.length-1]+K+2*f>d)&&(w+=y,E[E.length-(M>0?0:1)]=0,P+=y,I++),m[M]={left:0,top:P,row:I,width:K,height:c},E[E.length-1]+=K+f}),w}_fitCols(e,n,r,c){const{ctx:l,maxHeight:d,options:{labels:{padding:f}}}=this,m=this.legendHitBoxes=[],E=this.columnSizes=[],y=d-e;let w=f,I=0,P=0,k=0,M=0;return this.legendItems.forEach((K,W)=>{const V=r+n/2+l.measureText(K.text).width;W>0&&P+c+2*f>y&&(w+=I+f,E.push({width:I,height:P}),k+=I+f,M++,I=P=0),m[W]={left:k,top:P,col:M,width:V,height:c},I=Math.max(I,V),P+=c+f}),w+=I,E.push({width:I,height:P}),w}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:r,labels:{padding:c},rtl:l}}=this,d=ov(l,this.left,this.width);if(this.isHorizontal()){let f=0,m=So(r,this.left+c,this.right-this.lineWidths[f]);for(const E of n)f!==E.row&&(f=E.row,m=So(r,this.left+c,this.right-this.lineWidths[f])),E.top+=this.top+e+c,E.left=d.leftForLtr(d.x(m),E.width),m+=E.width+c}else{let f=0,m=So(r,this.top+e+c,this.bottom-this.columnSizes[f].height);for(const E of n)E.col!==f&&(f=E.col,m=So(r,this.top+e+c,this.bottom-this.columnSizes[f].height)),E.top=m,E.left+=this.left+c,E.left=d.leftForLtr(d.x(E.left),E.width),m+=E.height+c}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;n6(e,this),this._draw(),i6(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:r,ctx:c}=this,{align:l,labels:d}=e,f=Gn.color,m=ov(e.rtl,this.left,this.width),E=Es(d.font),{color:y,padding:w}=d,I=E.size,P=I/2;let k;this.drawTitle(),c.textAlign=m.textAlign("left"),c.textBaseline="middle",c.lineWidth=.5,c.font=E.string;const{boxWidth:M,boxHeight:K,itemHeight:W}=dX(d,I),V=function(oe,ce,Se){if(isNaN(M)||M<=0||isNaN(K)||K<0)return;c.save();const xe=An(Se.lineWidth,1);if(c.fillStyle=An(Se.fillStyle,f),c.lineCap=An(Se.lineCap,"butt"),c.lineDashOffset=An(Se.lineDashOffset,0),c.lineJoin=An(Se.lineJoin,"miter"),c.lineWidth=xe,c.strokeStyle=An(Se.strokeStyle,f),c.setLineDash(An(Se.lineDash,[])),d.usePointStyle){const je={radius:M*Math.SQRT2/2,pointStyle:Se.pointStyle,rotation:Se.rotation,borderWidth:xe},Ge=m.xPlus(oe,M/2),ze=ce+P;cN(c,je,Ge,ze)}else{const je=ce+Math.max((I-K)/2,0),Ge=m.leftForLtr(oe,M),ze=sv(Se.borderRadius);c.beginPath(),Object.values(ze).some(Ke=>Ke!==0)?lN(c,{x:Ge,y:je,w:M,h:K,radius:ze}):c.rect(Ge,je,M,K),c.fill(),xe!==0&&c.stroke()}c.restore()},G=function(oe,ce,Se){ag(c,Se.text,oe,ce+W/2,E,{strikethrough:Se.hidden,textAlign:m.textAlign(Se.textAlign)})},Q=this.isHorizontal(),Z=this._computeTitleHeight();Q?k={x:So(l,this.left+w,this.right-r[0]),y:this.top+w+Z,line:0}:k={x:this.left+w,y:So(l,this.top+Z+w,this.bottom-n[0].height),line:0},Rse(this.ctx,e.textDirection);const Y=W+w;this.legendItems.forEach((oe,ce)=>{c.strokeStyle=oe.fontColor||y,c.fillStyle=oe.fontColor||y;const Se=c.measureText(oe.text).width,xe=m.textAlign(oe.textAlign||(oe.textAlign=d.textAlign)),je=M+P+Se;let Ge=k.x,ze=k.y;m.setWidth(this.width),Q?ce>0&&Ge+je+w>this.right&&(ze=k.y+=Y,k.line++,Ge=k.x=So(l,this.left+w,this.right-r[k.line])):ce>0&&ze+Y>this.bottom&&(Ge=k.x=Ge+n[k.line].width+w,k.line++,ze=k.y=So(l,this.top+Z+w,this.bottom-n[k.line].height));const Ke=m.x(Ge);V(Ke,ze,oe),Ge=j2e(xe,Ge+M+P,Q?Ge+je:this.right,e.rtl),G(m.x(Ge),ze,oe),Q?k.x+=je+w:k.y+=Y}),Ise(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,r=Es(n.font),c=Io(n.padding);if(!n.display)return;const l=ov(e.rtl,this.left,this.width),d=this.ctx,f=n.position,m=r.size/2,E=c.top+m;let y,w=this.left,I=this.width;if(this.isHorizontal())I=Math.max(...this.lineWidths),y=this.top+E,w=So(e.align,w,this.right-I);else{const k=this.columnSizes.reduce((M,K)=>Math.max(M,K.height),0);y=E+So(e.align,this.top,this.bottom-k-e.labels.padding-this._computeTitleHeight())}const P=So(f,w,w+I);d.textAlign=l.textAlign(Y5(f)),d.textBaseline="middle",d.strokeStyle=n.color,d.fillStyle=n.color,d.font=r.string,ag(d,n.text,P,y,r)}_computeTitleHeight(){const e=this.options.title,n=Es(e.font),r=Io(e.padding);return e.display?n.lineHeight+r.height:0}_getLegendItemAt(e,n){let r,c,l;if(bf(e,this.left,this.right)&&bf(n,this.top,this.bottom)){for(l=this.legendHitBoxes,r=0;r<l.length;++r)if(c=l[r],bf(e,c.left,c.left+c.width)&&bf(n,c.top,c.top+c.height))return this.legendItems[r]}return null}handleEvent(e){const n=this.options;if(!y3e(e.type,n))return;const r=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"){const c=this._hoveredItem,l=v3e(c,r);c&&!l&&Xi(n.onLeave,[e,c,this],this),this._hoveredItem=r,r&&!l&&Xi(n.onHover,[e,r,this],this)}else r&&Xi(n.onClick,[e,r,this],this)}}function y3e(t,e){return!!(t==="mousemove"&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var qse={id:"legend",_element:hX,start(t,e,n){const r=t.legend=new hX({ctx:t.ctx,options:n,chart:t});kc.configure(t,r,n),kc.addBox(t,r)},stop(t){kc.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const r=t.legend;kc.configure(t,r,n),r.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const r=e.datasetIndex,c=n.chart;c.isDatasetVisible(r)?(c.hide(r),e.hidden=!0):(c.show(r),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:r,textAlign:c,color:l}}=t.legend.options;return t._getSortedDatasetMetas().map(d=>{const f=d.controller.getStyle(n?0:void 0),m=Io(f.borderWidth);return{text:e[d.index].label,fillStyle:f.backgroundColor,fontColor:l,hidden:!d.visible,lineCap:f.borderCapStyle,lineDash:f.borderDash,lineDashOffset:f.borderDashOffset,lineJoin:f.borderJoinStyle,lineWidth:(m.width+m.height)/4,strokeStyle:f.borderColor,pointStyle:r||f.pointStyle,rotation:f.rotation,textAlign:c||f.textAlign,borderRadius:0,datasetIndex:d.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class Yse extends wl{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n){const r=this.options;if(this.left=0,this.top=0,!r.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=n;const c=cr(r.text)?r.text.length:1;this._padding=Io(r.padding);const l=c*Es(r.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=l:this.width=l}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:n,left:r,bottom:c,right:l,options:d}=this,f=d.align;let m=0,E,y,w;return this.isHorizontal()?(y=So(f,r,l),w=n+e,E=l-r):(d.position==="left"?(y=r+e,w=So(f,c,n),m=br*-.5):(y=l-e,w=So(f,n,c),m=br*.5),E=c-n),{titleX:y,titleY:w,maxWidth:E,rotation:m}}draw(){const e=this.ctx,n=this.options;if(!n.display)return;const r=Es(n.font),l=r.lineHeight/2+this._padding.top,{titleX:d,titleY:f,maxWidth:m,rotation:E}=this._drawArgs(l);ag(e,n.text,0,0,r,{color:n.color,maxWidth:m,rotation:E,textAlign:Y5(n.align),textBaseline:"middle",translation:[d,f]})}}function S3e(t,e){const n=new Yse({ctx:t.ctx,options:e,chart:t});kc.configure(t,n,e),kc.addBox(t,n),t.titleBlock=n}var Xse={id:"title",_element:Yse,start(t,e,n){S3e(t,n)},stop(t){const e=t.titleBlock;kc.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,n){const r=t.titleBlock;kc.configure(t,r,n),r.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const NT={average(t){if(!t.length)return!1;let e,n,r=0,c=0,l=0;for(e=0,n=t.length;e<n;++e){const d=t[e].element;if(d&&d.hasValue()){const f=d.tooltipPosition();r+=f.x,c+=f.y,++l}}return{x:r/l,y:c/l}},nearest(t,e){if(!t.length)return!1;let n=e.x,r=e.y,c=Number.POSITIVE_INFINITY,l,d,f;for(l=0,d=t.length;l<d;++l){const m=t[l].element;if(m&&m.hasValue()){const E=m.getCenterPoint(),y=GV(e,E);y<c&&(c=y,f=m)}}if(f){const m=f.tooltipPosition();n=m.x,r=m.y}return{x:n,y:r}}};function du(t,e){return e&&(cr(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Sd(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function T3e(t,e){const{element:n,datasetIndex:r,index:c}=e,l=t.getDatasetMeta(r).controller,{label:d,value:f}=l.getLabelAndValue(c);return{chart:t,label:d,parsed:l.getParsed(c),raw:t.data.datasets[r].data[c],formattedValue:f,dataset:l.getDataset(),dataIndex:c,datasetIndex:r,element:n}}function fX(t,e){const n=t.chart.ctx,{body:r,footer:c,title:l}=t,{boxWidth:d,boxHeight:f}=e,m=Es(e.bodyFont),E=Es(e.titleFont),y=Es(e.footerFont),w=l.length,I=c.length,P=r.length,k=Io(e.padding);let M=k.height,K=0,W=r.reduce((Q,Z)=>Q+Z.before.length+Z.lines.length+Z.after.length,0);if(W+=t.beforeBody.length+t.afterBody.length,w&&(M+=w*E.lineHeight+(w-1)*e.titleSpacing+e.titleMarginBottom),W){const Q=e.displayColors?Math.max(f,m.lineHeight):m.lineHeight;M+=P*Q+(W-P)*m.lineHeight+(W-1)*e.bodySpacing}I&&(M+=e.footerMarginTop+I*y.lineHeight+(I-1)*e.footerSpacing);let V=0;const G=function(Q){K=Math.max(K,n.measureText(Q).width+V)};return n.save(),n.font=E.string,Ei(t.title,G),n.font=m.string,Ei(t.beforeBody.concat(t.afterBody),G),V=e.displayColors?d+2+e.boxPadding:0,Ei(r,Q=>{Ei(Q.before,G),Ei(Q.lines,G),Ei(Q.after,G)}),V=0,n.font=y.string,Ei(t.footer,G),n.restore(),K+=k.width,{width:K,height:M}}function b3e(t,e){const{y:n,height:r}=e;return n<r/2?"top":n>t.height-r/2?"bottom":"center"}function w3e(t,e,n,r){const{x:c,width:l}=r,d=n.caretSize+n.caretPadding;if(t==="left"&&c+l+d>e.width||t==="right"&&c-l-d<0)return!0}function C3e(t,e,n,r){const{x:c,width:l}=n,{width:d,chartArea:{left:f,right:m}}=t;let E="center";return r==="center"?E=c<=(f+m)/2?"left":"right":c<=l/2?E="left":c>=d-l/2&&(E="right"),w3e(E,t,e,n)&&(E="center"),E}function pX(t,e,n){const r=n.yAlign||e.yAlign||b3e(t,n);return{xAlign:n.xAlign||e.xAlign||C3e(t,e,n,r),yAlign:r}}function R3e(t,e){let{x:n,width:r}=t;return e==="right"?n-=r:e==="center"&&(n-=r/2),n}function I3e(t,e,n){let{y:r,height:c}=t;return e==="top"?r+=n:e==="bottom"?r-=c+n:r-=c/2,r}function mX(t,e,n,r){const{caretSize:c,caretPadding:l,cornerRadius:d}=t,{xAlign:f,yAlign:m}=n,E=c+l,{topLeft:y,topRight:w,bottomLeft:I,bottomRight:P}=sv(d);let k=R3e(e,f);const M=I3e(e,m,E);return m==="center"?f==="left"?k+=E:f==="right"&&(k-=E):f==="left"?k-=Math.max(y,I)+c:f==="right"&&(k+=Math.max(w,P)+c),{x:wo(k,0,r.width-e.width),y:wo(M,0,r.height-e.height)}}function pO(t,e,n){const r=Io(n.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-r.right:t.x+r.left}function gX(t){return du([],Sd(t))}function A3e(t,e,n){return rp(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}function _X(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}class eB extends wl{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart||e._chart,this._chart=this.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const n=this.chart,r=this.options.setContext(this.getContext()),c=r.enabled&&n.options.animation&&r.animations,l=new Ose(this.chart,c);return c._cacheable&&(this._cachedAnimations=Object.freeze(l)),l}getContext(){return this.$context||(this.$context=A3e(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){const{callbacks:r}=n,c=r.beforeTitle.apply(this,[e]),l=r.title.apply(this,[e]),d=r.afterTitle.apply(this,[e]);let f=[];return f=du(f,Sd(c)),f=du(f,Sd(l)),f=du(f,Sd(d)),f}getBeforeBody(e,n){return gX(n.callbacks.beforeBody.apply(this,[e]))}getBody(e,n){const{callbacks:r}=n,c=[];return Ei(e,l=>{const d={before:[],lines:[],after:[]},f=_X(r,l);du(d.before,Sd(f.beforeLabel.call(this,l))),du(d.lines,f.label.call(this,l)),du(d.after,Sd(f.afterLabel.call(this,l))),c.push(d)}),c}getAfterBody(e,n){return gX(n.callbacks.afterBody.apply(this,[e]))}getFooter(e,n){const{callbacks:r}=n,c=r.beforeFooter.apply(this,[e]),l=r.footer.apply(this,[e]),d=r.afterFooter.apply(this,[e]);let f=[];return f=du(f,Sd(c)),f=du(f,Sd(l)),f=du(f,Sd(d)),f}_createItems(e){const n=this._active,r=this.chart.data,c=[],l=[],d=[];let f=[],m,E;for(m=0,E=n.length;m<E;++m)f.push(T3e(this.chart,n[m]));return e.filter&&(f=f.filter((y,w,I)=>e.filter(y,w,I,r))),e.itemSort&&(f=f.sort((y,w)=>e.itemSort(y,w,r))),Ei(f,y=>{const w=_X(e.callbacks,y);c.push(w.labelColor.call(this,y)),l.push(w.labelPointStyle.call(this,y)),d.push(w.labelTextColor.call(this,y))}),this.labelColors=c,this.labelPointStyles=l,this.labelTextColors=d,this.dataPoints=f,f}update(e,n){const r=this.options.setContext(this.getContext()),c=this._active;let l,d=[];if(!c.length)this.opacity!==0&&(l={opacity:0});else{const f=NT[r.position].call(this,c,this._eventPosition);d=this._createItems(r),this.title=this.getTitle(d,r),this.beforeBody=this.getBeforeBody(d,r),this.body=this.getBody(d,r),this.afterBody=this.getAfterBody(d,r),this.footer=this.getFooter(d,r);const m=this._size=fX(this,r),E=Object.assign({},f,m),y=pX(this.chart,r,E),w=mX(r,E,y,this.chart);this.xAlign=y.xAlign,this.yAlign=y.yAlign,l={opacity:1,x:w.x,y:w.y,width:m.width,height:m.height,caretX:f.x,caretY:f.y}}this._tooltipItems=d,this.$context=void 0,l&&this._resolveAnimations().update(this,l),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,r,c){const l=this.getCaretPosition(e,r,c);n.lineTo(l.x1,l.y1),n.lineTo(l.x2,l.y2),n.lineTo(l.x3,l.y3)}getCaretPosition(e,n,r){const{xAlign:c,yAlign:l}=this,{caretSize:d,cornerRadius:f}=r,{topLeft:m,topRight:E,bottomLeft:y,bottomRight:w}=sv(f),{x:I,y:P}=e,{width:k,height:M}=n;let K,W,V,G,Q,Z;return l==="center"?(Q=P+M/2,c==="left"?(K=I,W=K-d,G=Q+d,Z=Q-d):(K=I+k,W=K+d,G=Q-d,Z=Q+d),V=K):(c==="left"?W=I+Math.max(m,y)+d:c==="right"?W=I+k-Math.max(E,w)-d:W=this.caretX,l==="top"?(G=P,Q=G-d,K=W-d,V=W+d):(G=P+M,Q=G+d,K=W+d,V=W-d),Z=G),{x1:K,x2:W,x3:V,y1:G,y2:Q,y3:Z}}drawTitle(e,n,r){const c=this.title,l=c.length;let d,f,m;if(l){const E=ov(r.rtl,this.x,this.width);for(e.x=pO(this,r.titleAlign,r),n.textAlign=E.textAlign(r.titleAlign),n.textBaseline="middle",d=Es(r.titleFont),f=r.titleSpacing,n.fillStyle=r.titleColor,n.font=d.string,m=0;m<l;++m)n.fillText(c[m],E.x(e.x),e.y+d.lineHeight/2),e.y+=d.lineHeight+f,m+1===l&&(e.y+=r.titleMarginBottom-f)}}_drawColorBox(e,n,r,c,l){const d=this.labelColors[r],f=this.labelPointStyles[r],{boxHeight:m,boxWidth:E,boxPadding:y}=l,w=Es(l.bodyFont),I=pO(this,"left",l),P=c.x(I),k=m<w.lineHeight?(w.lineHeight-m)/2:0,M=n.y+k;if(l.usePointStyle){const K={radius:Math.min(E,m)/2,pointStyle:f.pointStyle,rotation:f.rotation,borderWidth:1},W=c.leftForLtr(P,E)+E/2,V=M+m/2;e.strokeStyle=l.multiKeyBackground,e.fillStyle=l.multiKeyBackground,cN(e,K,W,V),e.strokeStyle=d.borderColor,e.fillStyle=d.backgroundColor,cN(e,K,W,V)}else{e.lineWidth=d.borderWidth||1,e.strokeStyle=d.borderColor,e.setLineDash(d.borderDash||[]),e.lineDashOffset=d.borderDashOffset||0;const K=c.leftForLtr(P,E-y),W=c.leftForLtr(c.xPlus(P,1),E-y-2),V=sv(d.borderRadius);Object.values(V).some(G=>G!==0)?(e.beginPath(),e.fillStyle=l.multiKeyBackground,lN(e,{x:K,y:M,w:E,h:m,radius:V}),e.fill(),e.stroke(),e.fillStyle=d.backgroundColor,e.beginPath(),lN(e,{x:W,y:M+1,w:E-2,h:m-2,radius:V}),e.fill()):(e.fillStyle=l.multiKeyBackground,e.fillRect(K,M,E,m),e.strokeRect(K,M,E,m),e.fillStyle=d.backgroundColor,e.fillRect(W,M+1,E-2,m-2))}e.fillStyle=this.labelTextColors[r]}drawBody(e,n,r){const{body:c}=this,{bodySpacing:l,bodyAlign:d,displayColors:f,boxHeight:m,boxWidth:E,boxPadding:y}=r,w=Es(r.bodyFont);let I=w.lineHeight,P=0;const k=ov(r.rtl,this.x,this.width),M=function(ce){n.fillText(ce,k.x(e.x+P),e.y+I/2),e.y+=I+l},K=k.textAlign(d);let W,V,G,Q,Z,Y,oe;for(n.textAlign=d,n.textBaseline="middle",n.font=w.string,e.x=pO(this,K,r),n.fillStyle=r.bodyColor,Ei(this.beforeBody,M),P=f&&K!=="right"?d==="center"?E/2+y:E+2+y:0,Q=0,Y=c.length;Q<Y;++Q){for(W=c[Q],V=this.labelTextColors[Q],n.fillStyle=V,Ei(W.before,M),G=W.lines,f&&G.length&&(this._drawColorBox(n,e,Q,k,r),I=Math.max(w.lineHeight,m)),Z=0,oe=G.length;Z<oe;++Z)M(G[Z]),I=w.lineHeight;Ei(W.after,M)}P=0,I=w.lineHeight,Ei(this.afterBody,M),e.y-=l}drawFooter(e,n,r){const c=this.footer,l=c.length;let d,f;if(l){const m=ov(r.rtl,this.x,this.width);for(e.x=pO(this,r.footerAlign,r),e.y+=r.footerMarginTop,n.textAlign=m.textAlign(r.footerAlign),n.textBaseline="middle",d=Es(r.footerFont),n.fillStyle=r.footerColor,n.font=d.string,f=0;f<l;++f)n.fillText(c[f],m.x(e.x),e.y+d.lineHeight/2),e.y+=d.lineHeight+r.footerSpacing}}drawBackground(e,n,r,c){const{xAlign:l,yAlign:d}=this,{x:f,y:m}=e,{width:E,height:y}=r,{topLeft:w,topRight:I,bottomLeft:P,bottomRight:k}=sv(c.cornerRadius);n.fillStyle=c.backgroundColor,n.strokeStyle=c.borderColor,n.lineWidth=c.borderWidth,n.beginPath(),n.moveTo(f+w,m),d==="top"&&this.drawCaret(e,n,r,c),n.lineTo(f+E-I,m),n.quadraticCurveTo(f+E,m,f+E,m+I),d==="center"&&l==="right"&&this.drawCaret(e,n,r,c),n.lineTo(f+E,m+y-k),n.quadraticCurveTo(f+E,m+y,f+E-k,m+y),d==="bottom"&&this.drawCaret(e,n,r,c),n.lineTo(f+P,m+y),n.quadraticCurveTo(f,m+y,f,m+y-P),d==="center"&&l==="left"&&this.drawCaret(e,n,r,c),n.lineTo(f,m+w),n.quadraticCurveTo(f,m,f+w,m),n.closePath(),n.fill(),c.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){const n=this.chart,r=this.$animations,c=r&&r.x,l=r&&r.y;if(c||l){const d=NT[e.position].call(this,this._active,this._eventPosition);if(!d)return;const f=this._size=fX(this,e),m=Object.assign({},d,this._size),E=pX(n,e,m),y=mX(e,m,E,n);(c._to!==y.x||l._to!==y.y)&&(this.xAlign=E.xAlign,this.yAlign=E.yAlign,this.width=f.width,this.height=f.height,this.caretX=d.x,this.caretY=d.y,this._resolveAnimations().update(this,y))}}draw(e){const n=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(n);const c={width:this.width,height:this.height},l={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const d=Io(n.padding),f=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&f&&(e.save(),e.globalAlpha=r,this.drawBackground(l,e,c,n),Rse(e,n.textDirection),l.y+=d.top,this.drawTitle(l,e,n),this.drawBody(l,e,n),this.drawFooter(l,e,n),Ise(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){const r=this._active,c=e.map(({datasetIndex:f,index:m})=>{const E=this.chart.getDatasetMeta(f);if(!E)throw new Error("Cannot find a dataset at index "+f);return{datasetIndex:f,element:E.data[m],index:m}}),l=!iN(r,c),d=this._positionChanged(c,n);(l||d)&&(this._active=c,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,r=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const c=this.options,l=this._active||[],d=this._getActiveElements(e,l,n,r),f=this._positionChanged(d,e),m=n||!iN(d,l)||f;return m&&(this._active=d,(c.enabled||c.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),m}_getActiveElements(e,n,r,c){const l=this.options;if(e.type==="mouseout")return[];if(!c)return n;const d=this.chart.getElementsAtEventForMode(e,l.mode,l,r);return l.reverse&&d.reverse(),d}_positionChanged(e,n){const{caretX:r,caretY:c,options:l}=this,d=NT[l.position].call(this,e,n);return d!==!1&&(r!==d.x||c!==d.y)}}eB.positioners=NT;var Jse={id:"tooltip",_element:eB,positioners:NT,afterInit(t,e,n){n&&(t.tooltip=new eB({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip,n={tooltip:e};t.notifyPlugins("beforeTooltipDraw",n)!==!1&&(e&&e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n))},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:{beforeTitle:vd,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,r=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(r>0&&e.dataIndex<r)return n[e.dataIndex]}return""},afterTitle:vd,beforeBody:vd,beforeLabel:vd,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return vi(n)||(e+=n),e},labelColor(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:vd,afterBody:vd,beforeFooter:vd,footer:vd,afterFooter:vd}},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const O3e=(t,e,n,r)=>(typeof e=="string"?(n=t.push(e)-1,r.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function N3e(t,e,n,r){const c=t.indexOf(e);if(c===-1)return O3e(t,e,n,r);const l=t.lastIndexOf(e);return c!==l?n:c}const P3e=(t,e)=>t===null?null:wo(Math.round(t),0,e);class pb extends Tg{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const r=this.getLabels();for(const{index:c,label:l}of n)r[c]===l&&r.splice(c,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(vi(e))return null;const r=this.getLabels();return n=isFinite(n)&&r[n]===e?n:N3e(r,e,An(n,e),this._addedLabels),P3e(n,r.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:r,max:c}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(r=0),n||(c=this.getLabels().length-1)),this.min=r,this.max=c}buildTicks(){const e=this.min,n=this.max,r=this.options.offset,c=[];let l=this.getLabels();l=e===0&&n===l.length-1?l:l.slice(e,n+1),this._valueRange=Math.max(l.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let d=e;d<=n;d++)c.push({value:d});return c}getLabelForValue(e){const n=this.getLabels();return e>=0&&e<n.length?n[e]:e}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}pb.id="category";pb.defaults={ticks:{callback:pb.prototype.getLabelForValue}};function x3e(t,e){const n=[],{bounds:c,step:l,min:d,max:f,precision:m,count:E,maxTicks:y,maxDigits:w,includeBounds:I}=t,P=l||1,k=y-1,{min:M,max:K}=e,W=!vi(d),V=!vi(f),G=!vi(E),Q=(K-M)/(w+1);let Z=yY((K-M)/k/P)*P,Y,oe,ce,Se;if(Z<1e-14&&!W&&!V)return[{value:M},{value:K}];Se=Math.ceil(K/Z)-Math.floor(M/Z),Se>k&&(Z=yY(Se*Z/k/P)*P),vi(m)||(Y=Math.pow(10,m),Z=Math.ceil(Z*Y)/Y),c==="ticks"?(oe=Math.floor(M/Z)*Z,ce=Math.ceil(K/Z)*Z):(oe=M,ce=K),W&&V&&l&&Y2e((f-d)/l,Z/1e3)?(Se=Math.round(Math.min((f-d)/Z,y)),Z=(f-d)/Se,oe=d,ce=f):G?(oe=W?d:oe,ce=V?f:ce,Se=E-1,Z=(ce-oe)/Se):(Se=(ce-oe)/Z,IT(Se,Math.round(Se),Z/1e3)?Se=Math.round(Se):Se=Math.ceil(Se));const xe=Math.max(SY(Z),SY(oe));Y=Math.pow(10,vi(m)?xe:m),oe=Math.round(oe*Y)/Y,ce=Math.round(ce*Y)/Y;let je=0;for(W&&(I&&oe!==d?(n.push({value:d}),oe<d&&je++,IT(Math.round((oe+je*Z)*Y)/Y,d,EX(d,Q,t))&&je++):oe<d&&je++);je<Se;++je)n.push({value:Math.round((oe+je*Z)*Y)/Y});return V&&I&&ce!==f?n.length&&IT(n[n.length-1].value,f,EX(f,Q,t))?n[n.length-1].value=f:n.push({value:f}):(!V||ce===f)&&n.push({value:ce}),n}function EX(t,e,{horizontal:n,minRotation:r}){const c=yl(r),l=(n?Math.sin(c):Math.cos(c))||.001,d=.75*e*(""+t).length;return Math.min(e/l,d)}class fN extends Tg{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return vi(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:r}=this.getUserBounds();let{min:c,max:l}=this;const d=m=>c=n?c:m,f=m=>l=r?l:m;if(e){const m=Cu(c),E=Cu(l);m<0&&E<0?f(0):m>0&&E>0&&d(0)}if(c===l){let m=1;(l>=Number.MAX_SAFE_INTEGER||c<=Number.MIN_SAFE_INTEGER)&&(m=Math.abs(l*.05)),f(l+m),e||d(c-m)}this.min=c,this.max=l}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:r}=e,c;return r?(c=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,c>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${c} ticks. Limiting to 1000.`),c=1e3)):(c=this.computeTickLimit(),n=n||11),n&&(c=Math.min(n,c)),c}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let r=this.getTickLimit();r=Math.max(2,r);const c={maxTicks:r,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},l=this._range||this,d=x3e(c,l);return e.bounds==="ticks"&&lse(d,this,"value"),e.reverse?(d.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),d}configure(){const e=this.ticks;let n=this.min,r=this.max;if(super.configure(),this.options.offset&&e.length){const c=(r-n)/Math.max(e.length-1,1)/2;n-=c,r+=c}this._startValue=n,this._endValue=r,this._valueRange=r-n}getLabelForValue(e){return Gb(e,this.chart.options.locale,this.options.ticks.format)}}class qP extends fN{determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=qs(e)?e:0,this.max=qs(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,r=yl(this.options.ticks.minRotation),c=(e?Math.sin(r):Math.cos(r))||.001,l=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,l.lineHeight/c))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}qP.id="linear";qP.defaults={ticks:{callback:GP.formatters.numeric}};function vX(t){return t/Math.pow(10,Math.floor(xc(t)))===1}function D3e(t,e){const n=Math.floor(xc(e.max)),r=Math.ceil(e.max/Math.pow(10,n)),c=[];let l=Ac(t.min,Math.pow(10,Math.floor(xc(e.min)))),d=Math.floor(xc(l)),f=Math.floor(l/Math.pow(10,d)),m=d<0?Math.pow(10,Math.abs(d)):1;do c.push({value:l,major:vX(l)}),++f,f===10&&(f=1,++d,m=d>=0?1:m),l=Math.round(f*Math.pow(10,d)*m)/m;while(d<n||d===n&&f<r);const E=Ac(t.max,l);return c.push({value:E,major:vX(l)}),c}class Qse extends Tg{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,n){const r=fN.prototype.parse.apply(this,[e,n]);if(r===0){this._zero=!0;return}return qs(r)&&r>0?r:null}determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=qs(e)?Math.max(0,e):null,this.max=qs(n)?Math.max(0,n):null,this.options.beginAtZero&&(this._zero=!0),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let r=this.min,c=this.max;const l=m=>r=e?r:m,d=m=>c=n?c:m,f=(m,E)=>Math.pow(10,Math.floor(xc(m))+E);r===c&&(r<=0?(l(1),d(10)):(l(f(r,-1)),d(f(c,1)))),r<=0&&l(f(c,-1)),c<=0&&d(f(r,1)),this._zero&&this.min!==this._suggestedMin&&r===f(this.min,0)&&l(f(r,-1)),this.min=r,this.max=c}buildTicks(){const e=this.options,n={min:this._userMin,max:this._userMax},r=D3e(n,this);return e.bounds==="ticks"&&lse(r,this,"value"),e.reverse?(r.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),r}getLabelForValue(e){return e===void 0?"0":Gb(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=xc(e),this._valueRange=xc(this.max)-xc(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(xc(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const n=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+n*this._valueRange)}}Qse.id="logarithmic";Qse.defaults={ticks:{callback:GP.formatters.logarithmic,major:{enabled:!0}}};function tB(t){const e=t.ticks;if(e.display&&t.display){const n=Io(e.backdropPadding);return An(e.font&&e.font.size,Gn.font.size)+n.height}return 0}function k3e(t,e,n){return n=cr(n)?n:[n],{w:vUe(t,e.string,n),h:n.length*e.lineHeight}}function yX(t,e,n,r,c){return t===r||t===c?{start:e-n/2,end:e+n/2}:t<r||t>c?{start:e-n,end:e}:{start:e,end:e+n}}function L3e(t){const e={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},n=Object.assign({},e),r=[],c=[],l=t._pointLabels.length,d=t.options.pointLabels,f=d.centerPointLabels?br/l:0;for(let m=0;m<l;m++){const E=d.setContext(t.getPointLabelContext(m));c[m]=E.padding;const y=t.getPointPosition(m,t.drawingArea+c[m],f),w=Es(E.font),I=k3e(t.ctx,w,t._pointLabels[m]);r[m]=I;const P=ml(t.getIndexAngle(m)+f),k=Math.round(J5(P)),M=yX(k,y.x,I.w,0,180),K=yX(k,y.y,I.h,90,270);M3e(n,e,P,M,K)}t.setCenterPoint(e.l-n.l,n.r-e.r,e.t-n.t,n.b-e.b),t._pointLabelItems=U3e(t,r,c)}function M3e(t,e,n,r,c){const l=Math.abs(Math.sin(n)),d=Math.abs(Math.cos(n));let f=0,m=0;r.start<e.l?(f=(e.l-r.start)/l,t.l=Math.min(t.l,e.l-f)):r.end>e.r&&(f=(r.end-e.r)/l,t.r=Math.max(t.r,e.r+f)),c.start<e.t?(m=(e.t-c.start)/d,t.t=Math.min(t.t,e.t-m)):c.end>e.b&&(m=(c.end-e.b)/d,t.b=Math.max(t.b,e.b+m))}function U3e(t,e,n){const r=[],c=t._pointLabels.length,l=t.options,d=tB(l)/2,f=t.drawingArea,m=l.pointLabels.centerPointLabels?br/c:0;for(let E=0;E<c;E++){const y=t.getPointPosition(E,f+d+n[E],m),w=Math.round(J5(ml(y.angle+Lr))),I=e[E],P=V3e(y.y,I.h,w),k=j3e(w),M=F3e(y.x,I.w,k);r.push({x:y.x,y:P,textAlign:k,left:M,top:P,right:M+I.w,bottom:P+I.h})}return r}function j3e(t){return t===0||t===180?"center":t<180?"left":"right"}function F3e(t,e,n){return n==="right"?t-=e:n==="center"&&(t-=e/2),t}function V3e(t,e,n){return n===90||n===270?t-=e/2:(n>270||n<90)&&(t-=e),t}function B3e(t,e){const{ctx:n,options:{pointLabels:r}}=t;for(let c=e-1;c>=0;c--){const l=r.setContext(t.getPointLabelContext(c)),d=Es(l.font),{x:f,y:m,textAlign:E,left:y,top:w,right:I,bottom:P}=t._pointLabelItems[c],{backdropColor:k}=l;if(!vi(k)){const M=Io(l.backdropPadding);n.fillStyle=k,n.fillRect(y-M.left,w-M.top,I-y+M.width,P-w+M.height)}ag(n,t._pointLabels[c],f,m+d.lineHeight/2,d,{color:l.color,textAlign:E,textBaseline:"middle"})}}function Zse(t,e,n,r){const{ctx:c}=t;if(n)c.arc(t.xCenter,t.yCenter,e,0,Qi);else{let l=t.getPointPosition(0,e);c.moveTo(l.x,l.y);for(let d=1;d<r;d++)l=t.getPointPosition(d,e),c.lineTo(l.x,l.y)}}function W3e(t,e,n,r){const c=t.ctx,l=e.circular,{color:d,lineWidth:f}=e;!l&&!r||!d||!f||n<0||(c.save(),c.strokeStyle=d,c.lineWidth=f,c.setLineDash(e.borderDash),c.lineDashOffset=e.borderDashOffset,c.beginPath(),Zse(t,n,l,r),c.closePath(),c.stroke(),c.restore())}function H3e(t,e,n){return rp(t,{label:n,index:e,type:"pointLabel"})}class YP extends fN{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=Io(tB(this.options)/2),n=this.width=this.maxWidth-e.width,r=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+n/2+e.left),this.yCenter=Math.floor(this.top+r/2+e.top),this.drawingArea=Math.floor(Math.min(n,r)/2)}determineDataLimits(){const{min:e,max:n}=this.getMinMax(!1);this.min=qs(e)&&!isNaN(e)?e:0,this.max=qs(n)&&!isNaN(n)?n:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/tB(this.options))}generateTickLabels(e){fN.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((n,r)=>{const c=Xi(this.options.pointLabels.callback,[n,r],this);return c||c===0?c:""}).filter((n,r)=>this.chart.getDataVisibility(r))}fit(){const e=this.options;e.display&&e.pointLabels.display?L3e(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,n,r,c){this.xCenter+=Math.floor((e-n)/2),this.yCenter+=Math.floor((r-c)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,n,r,c))}getIndexAngle(e){const n=Qi/(this._pointLabels.length||1),r=this.options.startAngle||0;return ml(e*n+yl(r))}getDistanceFromCenterForValue(e){if(vi(e))return NaN;const n=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*n:(e-this.min)*n}getValueForDistanceFromCenter(e){if(vi(e))return NaN;const n=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-n:this.min+n}getPointLabelContext(e){const n=this._pointLabels||[];if(e>=0&&e<n.length){const r=n[e];return H3e(this.getContext(),e,r)}}getPointPosition(e,n,r=0){const c=this.getIndexAngle(e)-Lr+r;return{x:Math.cos(c)*n+this.xCenter,y:Math.sin(c)*n+this.yCenter,angle:c}}getPointPositionForValue(e,n){return this.getPointPosition(e,this.getDistanceFromCenterForValue(n))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:n,top:r,right:c,bottom:l}=this._pointLabelItems[e];return{left:n,top:r,right:c,bottom:l}}drawBackground(){const{backgroundColor:e,grid:{circular:n}}=this.options;if(e){const r=this.ctx;r.save(),r.beginPath(),Zse(this,this.getDistanceFromCenterForValue(this._endValue),n,this._pointLabels.length),r.closePath(),r.fillStyle=e,r.fill(),r.restore()}}drawGrid(){const e=this.ctx,n=this.options,{angleLines:r,grid:c}=n,l=this._pointLabels.length;let d,f,m;if(n.pointLabels.display&&B3e(this,l),c.display&&this.ticks.forEach((E,y)=>{if(y!==0){f=this.getDistanceFromCenterForValue(E.value);const w=c.setContext(this.getContext(y-1));W3e(this,w,f,l)}}),r.display){for(e.save(),d=l-1;d>=0;d--){const E=r.setContext(this.getPointLabelContext(d)),{color:y,lineWidth:w}=E;!w||!y||(e.lineWidth=w,e.strokeStyle=y,e.setLineDash(E.borderDash),e.lineDashOffset=E.borderDashOffset,f=this.getDistanceFromCenterForValue(n.ticks.reverse?this.min:this.max),m=this.getPointPosition(d,f),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(m.x,m.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,n=this.options,r=n.ticks;if(!r.display)return;const c=this.getIndexAngle(0);let l,d;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(c),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((f,m)=>{if(m===0&&!n.reverse)return;const E=r.setContext(this.getContext(m)),y=Es(E.font);if(l=this.getDistanceFromCenterForValue(this.ticks[m].value),E.showLabelBackdrop){e.font=y.string,d=e.measureText(f.label).width,e.fillStyle=E.backdropColor;const w=Io(E.backdropPadding);e.fillRect(-d/2-w.left,-l-y.size/2-w.top,d+w.width,y.size+w.height)}ag(e,f.label,0,-l,y,{color:E.color})}),e.restore()}drawTitle(){}}YP.id="radialLinear";YP.defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:GP.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}};YP.defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};YP.descriptors={angleLines:{_fallback:"grid"}};const XP={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Sa=Object.keys(XP);function $3e(t,e){return t-e}function SX(t,e){if(vi(e))return null;const n=t._adapter,{parser:r,round:c,isoWeekday:l}=t._parseOpts;let d=e;return typeof r=="function"&&(d=r(d)),qs(d)||(d=typeof r=="string"?n.parse(d,r):n.parse(d)),d===null?null:(c&&(d=c==="week"&&(ub(l)||l===!0)?n.startOf(d,"isoWeek",l):n.startOf(d,c)),+d)}function TX(t,e,n,r){const c=Sa.length;for(let l=Sa.indexOf(t);l<c-1;++l){const d=XP[Sa[l]],f=d.steps?d.steps:Number.MAX_SAFE_INTEGER;if(d.common&&Math.ceil((n-e)/(f*d.size))<=r)return Sa[l]}return Sa[c-1]}function z3e(t,e,n,r,c){for(let l=Sa.length-1;l>=Sa.indexOf(n);l--){const d=Sa[l];if(XP[d].common&&t._adapter.diff(c,r,d)>=e-1)return d}return Sa[n?Sa.indexOf(n):0]}function G3e(t){for(let e=Sa.indexOf(t)+1,n=Sa.length;e<n;++e)if(XP[Sa[e]].common)return Sa[e]}function bX(t,e,n){if(!n)t[e]=!0;else if(n.length){const{lo:r,hi:c}=s6(n,e),l=n[r]>=e?n[r]:n[c];t[l]=!0}}function K3e(t,e,n,r){const c=t._adapter,l=+c.startOf(e[0].value,r),d=e[e.length-1].value;let f,m;for(f=l;f<=d;f=+c.add(f,1,r))m=n[f],m>=0&&(e[m].major=!0);return e}function wX(t,e,n){const r=[],c={},l=e.length;let d,f;for(d=0;d<l;++d)f=e[d],c[f]=d,r.push({value:f,major:!1});return l===0||!n?r:K3e(t,r,c,n)}class JP extends Tg{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n){const r=e.time||(e.time={}),c=this._adapter=new $je._date(e.adapters.date);RT(r.displayFormats,c.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:SX(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,r=e.time.unit||"day";let{min:c,max:l,minDefined:d,maxDefined:f}=this.getUserBounds();function m(E){!d&&!isNaN(E.min)&&(c=Math.min(c,E.min)),!f&&!isNaN(E.max)&&(l=Math.max(l,E.max))}(!d||!f)&&(m(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&m(this.getMinMax(!1))),c=qs(c)&&!isNaN(c)?c:+n.startOf(Date.now(),r),l=qs(l)&&!isNaN(l)?l:+n.endOf(Date.now(),r)+1,this.min=Math.min(c,l-1),this.max=Math.max(c+1,l)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],r=e[e.length-1]),{min:n,max:r}}buildTicks(){const e=this.options,n=e.time,r=e.ticks,c=r.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&c.length&&(this.min=this._userMin||c[0],this.max=this._userMax||c[c.length-1]);const l=this.min,d=this.max,f=NUe(c,l,d);return this._unit=n.unit||(r.autoSkip?TX(n.minUnit,this.min,this.max,this._getLabelCapacity(l)):z3e(this,f.length,n.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:G3e(this._unit),this.initOffsets(c),e.reverse&&f.reverse(),wX(this,f,this._majorUnit)}initOffsets(e){let n=0,r=0,c,l;this.options.offset&&e.length&&(c=this.getDecimalForValue(e[0]),e.length===1?n=1-c:n=(this.getDecimalForValue(e[1])-c)/2,l=this.getDecimalForValue(e[e.length-1]),e.length===1?r=l:r=(l-this.getDecimalForValue(e[e.length-2]))/2);const d=e.length<3?.5:.25;n=wo(n,0,d),r=wo(r,0,d),this._offsets={start:n,end:r,factor:1/(n+1+r)}}_generate(){const e=this._adapter,n=this.min,r=this.max,c=this.options,l=c.time,d=l.unit||TX(l.minUnit,n,r,this._getLabelCapacity(n)),f=An(l.stepSize,1),m=d==="week"?l.isoWeekday:!1,E=ub(m)||m===!0,y={};let w=n,I,P;if(E&&(w=+e.startOf(w,"isoWeek",m)),w=+e.startOf(w,E?"day":d),e.diff(r,n,d)>1e5*f)throw new Error(n+" and "+r+" are too far apart with stepSize of "+f+" "+d);const k=c.ticks.source==="data"&&this.getDataTimestamps();for(I=w,P=0;I<r;I=+e.add(I,f,d),P++)bX(y,I,k);return(I===r||c.bounds==="ticks"||P===1)&&bX(y,I,k),Object.keys(y).sort((M,K)=>M-K).map(M=>+M)}getLabelForValue(e){const n=this._adapter,r=this.options.time;return r.tooltipFormat?n.format(e,r.tooltipFormat):n.format(e,r.displayFormats.datetime)}_tickFormatFunction(e,n,r,c){const l=this.options,d=l.time.displayFormats,f=this._unit,m=this._majorUnit,E=f&&d[f],y=m&&d[m],w=r[n],I=m&&y&&w&&w.major,P=this._adapter.format(e,c||(I?y:E)),k=l.ticks.callback;return k?Xi(k,[P,n,r],this):P}generateTickLabels(e){let n,r,c;for(n=0,r=e.length;n<r;++n)c=e[n],c.label=this._tickFormatFunction(c.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,r=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+r)*n.factor)}getValueForPixel(e){const n=this._offsets,r=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+r*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,r=this.ctx.measureText(e).width,c=yl(this.isHorizontal()?n.maxRotation:n.minRotation),l=Math.cos(c),d=Math.sin(c),f=this._resolveTickFontOptions(0).size;return{w:r*l+f*d,h:r*d+f*l}}_getLabelCapacity(e){const n=this.options.time,r=n.displayFormats,c=r[n.unit]||r.millisecond,l=this._tickFormatFunction(e,0,wX(this,[e],this._majorUnit),c),d=this._getLabelSize(l),f=Math.floor(this.isHorizontal()?this.width/d.w:this.height/d.h)-1;return f>0?f:1}getDataTimestamps(){let e=this._cache.data||[],n,r;if(e.length)return e;const c=this.getMatchingVisibleMetas();if(this._normalized&&c.length)return this._cache.data=c[0].controller.getAllParsedValues(this);for(n=0,r=c.length;n<r;++n)e=e.concat(c[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,r;if(e.length)return e;const c=this.getLabels();for(n=0,r=c.length;n<r;++n)e.push(SX(this,c[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return Ese(e.sort($3e))}}JP.id="time";JP.defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",major:{enabled:!1}}};function mO(t,e,n){let r=0,c=t.length-1,l,d,f,m;n?(e>=t[r].pos&&e<=t[c].pos&&({lo:r,hi:c}=Vm(t,"pos",e)),{pos:l,time:f}=t[r],{pos:d,time:m}=t[c]):(e>=t[r].time&&e<=t[c].time&&({lo:r,hi:c}=Vm(t,"time",e)),{time:l,pos:f}=t[r],{time:d,pos:m}=t[c]);const E=d-l;return E?f+(m-f)*(e-l)/E:f}class eoe extends JP{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=mO(n,this.min),this._tableRange=mO(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:r}=this,c=[],l=[];let d,f,m,E,y;for(d=0,f=e.length;d<f;++d)E=e[d],E>=n&&E<=r&&c.push(E);if(c.length<2)return[{time:n,pos:0},{time:r,pos:1}];for(d=0,f=c.length;d<f;++d)y=c[d+1],m=c[d-1],E=c[d],Math.round((y+m)/2)!==E&&l.push({time:E,pos:d/(f-1)});return l}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),r=this.getLabelTimestamps();return n.length&&r.length?e=this.normalize(n.concat(r)):e=n.length?n:r,e=this._cache.all=e,e}getDecimalForValue(e){return(mO(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,r=this.getDecimalForPixel(e)/n.factor-n.end;return mO(this._table,r*this._tableRange+this._minPos,!0)}}eoe.id="timeseries";eoe.defaults=JP.defaults;const toe="label";function CX(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function q3e(t,e){Object.assign(t.options,e)}function noe(t,e){t.labels=e}function ioe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:toe;const r=[];t.datasets=e.map(c=>{const l=t.datasets.find(d=>d[n]===c[n]);return!l||!c.data||r.includes(l)?{...c}:(r.push(l),Object.assign(l,c),l)})}function Y3e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:toe;const n={labels:[],datasets:[]};return noe(n,t.labels),ioe(n,t.datasets,e),n}function X3e(t,e){let{height:n=150,width:r=300,redraw:c=!1,datasetIdKey:l,type:d,data:f,options:m,plugins:E=[],fallbackContent:y,updateMode:w,...I}=t;const P=$.useRef(null),k=$.useRef(),M=()=>{P.current&&(k.current=new Vv(P.current,{type:d,data:Y3e(f,l),options:m&&{...m},plugins:E}),CX(e,k.current))},K=()=>{CX(e,null),k.current&&(k.current.destroy(),k.current=null)};return $.useEffect(()=>{!c&&k.current&&m&&q3e(k.current,m)},[c,m]),$.useEffect(()=>{!c&&k.current&&noe(k.current.config.data,f.labels)},[c,f.labels]),$.useEffect(()=>{!c&&k.current&&f.datasets&&ioe(k.current.config.data,f.datasets,l)},[c,f.datasets]),$.useEffect(()=>{k.current&&(c?(K(),setTimeout(M)):k.current.update(w))},[c,m,f.labels,f.datasets,w]),$.useEffect(()=>{k.current&&(K(),setTimeout(M))},[d]),$.useEffect(()=>(M(),()=>K()),[]),At.createElement("canvas",Object.assign({ref:P,role:"img",height:n,width:r},I),y)}const J3e=$.forwardRef(X3e);function roe(t,e){return Vv.register(e),$.forwardRef((n,r)=>At.createElement(J3e,Object.assign({},n,{ref:r,type:t})))}const Q3e=roe("line",qb),Z3e=roe("bar",zP),soe=t=>R.jsx("div",{className:"dashboard-wrapper",children:t.children});soe.propTypes={children:Le.node};const ooe=t=>R.jsx("div",{className:"dashboard-wrapper__main",children:t.children});ooe.propTypes={children:Le.node};Le.node;/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var nB=function(t,e){return nB=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var c in r)r.hasOwnProperty(c)&&(n[c]=r[c])},nB(t,e)};function eVe(t,e){nB(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var iB=function(){return iB=Object.assign||function(e){for(var n,r=1,c=arguments.length;r<c;r++){n=arguments[r];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e},iB.apply(this,arguments)};function tVe(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,r=Object.getOwnPropertySymbols(t);c<r.length;c++)e.indexOf(r[c])<0&&(n[r[c]]=t[r[c]]);return n}var nVe=100,iVe=100,RX=50,rB=50,sB=50;function IX(t){var e=t.className,n=t.counterClockwise,r=t.dashRatio,c=t.pathRadius,l=t.strokeWidth,d=t.style;return $.createElement("path",{className:e,style:Object.assign({},d,sVe({pathRadius:c,dashRatio:r,counterClockwise:n})),d:rVe({pathRadius:c,counterClockwise:n}),strokeWidth:l,fillOpacity:0})}function rVe(t){var e=t.pathRadius,n=t.counterClockwise,r=e,c=n?1:0;return`
      M `+rB+","+sB+`
      m 0,-`+r+`
      a `+r+","+r+" "+c+" 1 1 0,"+2*r+`
      a `+r+","+r+" "+c+" 1 1 0,-"+2*r+`
    `}function sVe(t){var e=t.counterClockwise,n=t.dashRatio,r=t.pathRadius,c=Math.PI*2*r,l=(1-n)*c;return{strokeDasharray:c+"px "+c+"px",strokeDashoffset:(e?-l:l)+"px"}}var oVe=function(t){eVe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getBackgroundPadding=function(){return this.props.background?this.props.backgroundPadding:0},e.prototype.getPathRadius=function(){return RX-this.props.strokeWidth/2-this.getBackgroundPadding()},e.prototype.getPathRatio=function(){var n=this.props,r=n.value,c=n.minValue,l=n.maxValue,d=Math.min(Math.max(r,c),l);return(d-c)/(l-c)},e.prototype.render=function(){var n=this.props,r=n.circleRatio,c=n.className,l=n.classes,d=n.counterClockwise,f=n.styles,m=n.strokeWidth,E=n.text,y=this.getPathRadius(),w=this.getPathRatio();return $.createElement("svg",{className:l.root+" "+c,style:f.root,viewBox:"0 0 "+nVe+" "+iVe,"data-test-id":"CircularProgressbar"},this.props.background?$.createElement("circle",{className:l.background,style:f.background,cx:rB,cy:sB,r:RX}):null,$.createElement(IX,{className:l.trail,counterClockwise:d,dashRatio:r,pathRadius:y,strokeWidth:m,style:f.trail}),$.createElement(IX,{className:l.path,counterClockwise:d,dashRatio:w*r,pathRadius:y,strokeWidth:m,style:f.path}),E?$.createElement("text",{className:l.text,style:f.text,x:rB,y:sB},E):null)},e.defaultProps={background:!1,backgroundPadding:0,circleRatio:1,classes:{root:"CircularProgressbar",trail:"CircularProgressbar-trail",path:"CircularProgressbar-path",text:"CircularProgressbar-text",background:"CircularProgressbar-background"},counterClockwise:!1,className:"",maxValue:100,minValue:0,strokeWidth:8,styles:{root:{},trail:{},path:{},text:{},background:{}},text:""},e}($.Component);function aVe(t){t.children;var e=tVe(t,["children"]);return $.createElement("div",{"data-test-id":"CircularProgressbarWithChildren"},$.createElement("div",{style:{position:"relative",width:"100%",height:"100%"}},$.createElement(oVe,iB({},e)),t.children?$.createElement("div",{"data-test-id":"CircularProgressbarWithChildren__children",style:{position:"absolute",width:"100%",height:"100%",marginTop:"-100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}},t.children):null))}function cVe(t){var e=t.rotation,n=t.strokeLinecap,r=t.textColor,c=t.textSize,l=t.pathColor,d=t.pathTransition,f=t.pathTransitionDuration,m=t.trailColor,E=t.backgroundColor,y=e==null?void 0:"rotate("+e+"turn)",w=e==null?void 0:"center center";return{root:{},path:gO({stroke:l,strokeLinecap:n,transform:y,transformOrigin:w,transition:d,transitionDuration:f==null?void 0:f+"s"}),trail:gO({stroke:m,strokeLinecap:n,transform:y,transformOrigin:w}),text:gO({fill:r,fontSize:c}),background:gO({fill:E})}}function gO(t){return Object.keys(t).forEach(function(e){t[e]==null&&delete t[e]}),t}const oB={green:"#4CAF50",red:"#DB190C",purple:"#8624DB",white:"#fff",orange:"#FF9066"};Vv.register(pb,qP,Xb,Yb,Xse,Jse,qse);const aoe=({item:t})=>R.jsx(WP,{children:R.jsxs("div",{className:"summary-box",children:[R.jsxs("div",{className:"summary-box__info",children:[R.jsxs("div",{className:"summary-box__info__title",children:[R.jsx("div",{children:t.title}),R.jsx("span",{children:t.subtitle})]}),R.jsx("div",{className:"summary-box__info__value",children:t.value})]}),R.jsx("div",{className:"summary-box__chart",children:R.jsx(aVe,{value:t.percent,strokeWidth:10,styles:cVe({pathColor:t.percent<50?oB.red:oB.purple,trailColor:"transparent",strokeLinecap:"round"}),children:R.jsxs("div",{className:"summary-box__chart__value",children:[t.percent,"%"]})})})]})});aoe.propTypes={item:Le.shape({title:Le.string.isRequired,subtitle:Le.string.isRequired,percent:Le.number.isRequired,value:Le.string.isRequired}).isRequired};const coe=({item:t})=>{var r,c;const e={responsive:!0,scales:{xAxis:{display:!1},yAxis:{display:!1}},plugins:{legend:{display:!1}},elements:{point:{radius:0}}},n={labels:(r=t==null?void 0:t.chartData)==null?void 0:r.labels,datasets:[{label:"Revenue",data:(c=t==null?void 0:t.chartData)==null?void 0:c.data,borderColor:"#fff",tension:.5}]};return R.jsx(WP,{purple:!0,fullheight:!0,children:R.jsxs("div",{className:"summary-box-special",children:[R.jsx("div",{className:"summary-box-special__title",children:t==null?void 0:t.title}),R.jsx("div",{className:"summary-box-special__value",children:t==null?void 0:t.value}),R.jsx("div",{className:"summary-box-special__chart",children:R.jsx(Q3e,{options:e,data:n,width:"250px"})})]})})};coe.propTypes={item:Le.shape({title:Le.string.isRequired,value:Le.number.isRequired,chartData:Le.shape({labels:Le.arrayOf(Le.string),data:Le.arrayOf(Le.number)})}).isRequired};Vv.register(pb,qP,Xb,KP,Xse,Jse,qse);function lVe(){var l;const[t,e]=$.useState(),[n,r]=$.useState(!1),c={position:"absolute",top:"45%",left:"45%",display:"block",zIndex:"1066"};return $.useEffect(()=>{(async()=>{r(!0);const f=await ANe();f&&(r(!1),e(f.data))})()},[]),R.jsxs(soe,{children:[R.jsx($b,{loading:n,cssOverride:c,color:"orange",speedMultiplier:1}),R.jsx(ooe,{children:!n&&R.jsxs("div",{className:"row",children:[R.jsx("div",{className:"col-lg-8",children:R.jsx("div",{className:"row",children:(l=t==null?void 0:t.summaryData)==null?void 0:l.map((d,f)=>R.jsx("div",{className:"col-lg-6 col-md-6 col-sm-12 mb",children:!n&&t&&R.jsx(aoe,{item:d})},`summary-${f}`))})}),R.jsx("div",{className:"col-lg-4 hide-sm",children:!n&&t&&R.jsx(coe,{item:t==null?void 0:t.visitedData})}),R.jsx("div",{className:"row",children:R.jsx("div",{className:"col-12",children:!n&&t&&R.jsx(WP,{children:R.jsx(uVe,{data:t.usersByMonth})})})})]})})]})}const uVe=t=>{const e={responsive:!0,maintainAspectRatio:!1,scales:{xAxes:{grid:{display:!1,drawBorder:!1}},yAxes:{grid:{display:!1,drawBorder:!1}}},plugins:{legend:{display:!1},title:{display:!1}},elements:{bar:{backgroundColor:oB.orange,borderRadius:20,borderSkipped:"bottom"}}},n={labels:t.data.labels,datasets:[{label:"Revenue",data:t.data.data}]};return R.jsxs(R.Fragment,{children:[R.jsx("div",{className:"title mb",children:"Users Joined "}),R.jsx("div",{children:R.jsx(Z3e,{options:e,data:n,height:"300px"})})]})},dVe=()=>async t=>{t({type:"FETCH_USERS_START"});try{const{data:e}=await CNe();t({type:"FETCH_USERS_SUCCESS",data:e})}catch(e){e.response.data.error==="Token has expired"&&t(Bi()),t({type:"FETCH_USERS_FAIL",error:e})}},hVe=t=>async e=>{try{const n=await RNe(t);if(n.status===200){const r=n.data.includes("User blocked")?"BLOCK_USER":"UNBLOCK_USER";e({type:r,userId:t})}}catch(n){console.log(n),n.response.data.error==="Token has expired"&&e(Bi())}},loe=({onSearch:t})=>{const[e,n]=$.useState(""),r=c=>{const l=c.target.value;n(l),t(l)};return R.jsx("div",{className:"LogoSearch",children:R.jsx("div",{className:"contents",children:R.jsxs("div",{className:"Search",children:[R.jsx("input",{type:"text",placeholder:"#Explore",value:e,onChange:r}),R.jsx("div",{className:"s-icon",children:R.jsx(dke,{})})]})})})};loe.propTypes={onSearch:Le.func.isRequired,location:Le.string.isRequired};const fVe="/assets/icon-blockUser-aa18f657.svg",pVe="/assets/icon-unblock-6d6b5cc8.svg";function uoe({user:t}){const e=bi(),[n,r]=$.useState(!1),[c,l]=$.useState(t.isblocked),d=y=>{const w={year:"numeric",month:"short",day:"numeric"};return new Date(y).toLocaleDateString(void 0,w)},f=()=>r(!1),m=()=>r(!0),E=()=>{r(!1),e(hVe(t._id)),c?(fe.success(R.jsx("b",{children:"User was Unblocked 👍"})),l(!1)):(fe.success(R.jsx("b",{children:"User is blocked 👍"})),l(!0))};return R.jsxs(R.Fragment,{children:[R.jsxs("tr",{className:"table-row",children:[R.jsx("td",{className:"table-cell",children:R.jsx("div",{className:"image-container",children:R.jsx("img",{src:t.profileimage||Gr,alt:"",className:"avatar"})})}),R.jsx("td",{className:"table-cell",children:t.username}),R.jsx("td",{className:"table-cell",children:t.email}),R.jsx("td",{className:"table-cell",children:d(t.createdAt)}),R.jsx("td",{className:"table-cell",children:t.phone}),R.jsx("td",{className:"table-cell",children:R.jsx("span",{className:c?"red":"green",children:c?"disabled":"enabled"})}),R.jsx("td",{className:"table-cell",children:R.jsx("div",{className:"image-container",children:R.jsxs("div",{className:"flex",children:[R.jsx("img",{onClick:m,src:c?pVe:fVe,className:"block",alt:"action"}),R.jsx("span",{children:c?"unblock":"block"})]})})})]},t._id),R.jsx(ln,{show:n,onHide:f,children:R.jsxs(ln.Body,{style:{width:"10rem"},children:[R.jsx("img",{src:t.profileimage||Gr,alt:""}),R.jsx("span",{className:"lg-text pb-2",children:c?"Unblock this User?":"Block this user?"}),R.jsxs("div",{className:"cover",children:[R.jsx("button",{className:"button modalButton",onClick:f,children:"No!"}),R.jsx("button",{className:"button modalButton",onClick:E,children:"Yes!"})]})]})})]})}uoe.propTypes={user:Le.shape({_id:Le.string.isRequired,profileimage:Le.string,username:Le.string.isRequired,email:Le.string.isRequired,createdAt:Le.string.isRequired,phone:Le.string.isRequired,isblocked:Le.bool.isRequired}).isRequired};function mVe(){const t=bi(),{userDetails:e,loading:n}=Si(f=>f.adminReducer),[r,c]=$.useState("");$.useEffect(()=>{t(dVe())},[]);const l=e==null?void 0:e.filter(f=>f.username.toLowerCase().includes(r.toLowerCase())),d={display:"block",margin:"0 auto"};return R.jsxs(R.Fragment,{children:[R.jsx(ku,{position:"top-center",reverseOrder:!1}),R.jsx(loe,{onSearch:f=>c(f),location:"admin"}),R.jsxs("div",{className:"table-container",children:[R.jsx(dn.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5},children:R.jsxs("table",{className:"table",children:[R.jsx("thead",{className:"table-head",children:R.jsxs("tr",{children:[R.jsx("th",{style:{display:"flex",justifyContent:"center"},children:"User"}),R.jsx("th",{children:"Username"}),R.jsx("th",{children:"Email"}),R.jsx("th",{children:"Joined on"}),R.jsx("th",{children:"Phone"}),R.jsx("th",{children:"Status"}),R.jsx("th",{style:{display:"flex",justifyContent:"center"},children:"Action"})]})}),R.jsx("tbody",{children:e&&!n&&l.map(f=>R.jsx(uoe,{user:f},f._id))})]})}),R.jsx($b,{loading:n,cssOverride:d,color:"orange",speedMultiplier:1})]})]})}const gVe="/assets/icon-flatView-ed544bbb.svg",_Ve="/assets/icon-flatDone-93beea11.svg",EVe="/assets/icon-flatDelete-524c5024.svg";function doe({report:t,setTargetLoading:e,setReports:n,incPage:r}){var xe,je,Ge;const[c,l]=$.useState(!0),[d,f]=$.useState(!1),[m,E]=$.useState(null),[y,w]=$.useState(!1),[I,P]=$.useState(!1),k=bi(),M=()=>{l(!c)},K=()=>{w(!0),f(!1)},W=()=>{w(!1)},V=()=>{const ze=fe.loading("Deleting...");WNe(t._id).then(Ke=>{fe.dismiss(ze),n(He=>{const be=He.filter(Oe=>Oe._id!==t._id);return be.length<8&&r(),be}),fe.success(R.jsx("b",{children:Ke.data.message}))}).catch(Ke=>{fe.dismiss(ze),fe.error(R.jsx("b",{children:Ke.response.data.err}))})},G=async()=>{const ze=fe.loading("Deleting...");try{const Ke=await k(y5(t.targetId,"HensalDeon","admin"));fe.dismiss(ze),Ke.success?(w(!1),fe.success(R.jsx("b",{children:"Post Deleted...!"}))):(w(!1),fe.error(R.jsx("b",{children:"Failed to delete...!"})))}catch(Ke){w(!1),fe.error(R.jsx("b",{children:"Something went wrong!"})),console.error("Error:",Ke)}},Q=()=>{const ze=fe.loading("Deleting...");YNe(t.targetId).then(Ke=>{k(rie(t.targetId,m.postId._id)),w(!1),fe.dismiss(ze),fe.success(R.jsx("b",{children:Ke.data.message}))}).catch(Ke=>{w(!1),fe.dismiss(ze),console.error("Error deleting comment:",Ke),fe.error(R.jsx("b",{children:"Error deleting comment"}))})},Z=async()=>{t.targetType==="post"?G():t.targetType==="comment"&&Q()},Y=()=>{const ze=fe.loading(R.jsx("b",{children:"Changing..."}));BNe("HensalDeon",t._id).then(Ke=>{fe.dismiss(ze);const He=Ke.data.report;n(be=>be.map(Oe=>Oe._id===He._id?{...He,reporterId:Oe.reporterId}:Oe)),fe.success(R.jsx("b",{children:"Status changed!"}))}).catch(Ke=>{fe.dismiss(ze),console.log(Ke),fe.error(R.jsx("b",{children:"Error updating status"}))})},oe=()=>{e(!0),VNe(t.targetId,t.targetType).then(ze=>{ze.data&&ze.data!=="deleted"?(E(ze.data),f(!0)):ze.data&&ze.data==="deleted"&&P(!0),e(!1)}).catch(ze=>{console.log(ze),e(!1)})},ce=()=>{f(!1)},Se=ze=>{const Ke={year:"numeric",month:"short",day:"numeric"};return new Date(ze).toLocaleDateString(void 0,Ke)};return R.jsxs(R.Fragment,{children:[R.jsxs("tr",{className:"table-row",children:[R.jsx("td",{className:"table-cell",children:R.jsx("div",{className:"image-container",children:R.jsx("img",{src:t.reporterId.profileimage||Gr,alt:"",className:"avatar"})})}),R.jsx("td",{className:"table-cell",children:t.reporterId.username}),R.jsx("td",{className:"table-cell w-25",children:R.jsx("span",{onClick:M,className:c?"content":"expand",children:t.reason})}),R.jsx("td",{className:"table-cell",children:Se(t.createdAt)}),R.jsx("td",{className:"table-cell",children:t.targetType}),R.jsx("td",{className:"table-cell",children:R.jsx("span",{className:t.status==="pending"?"red":"green",children:t.status==="pending"?"pending":"resolved"})}),R.jsx("td",{className:"table-cell",children:R.jsx("div",{className:"image-container",children:R.jsxs("div",{className:"d-flex gap-2",children:[R.jsx("img",{onClick:oe,src:gVe,className:"action-img",alt:"action"}),t.status==="pending"&&R.jsx("img",{src:_Ve,onClick:Y,className:"action-img",alt:"action"}),t.status==="resolved"&&R.jsx("img",{src:EVe,onClick:V,className:"action-img",alt:"action"})]})})})]}),R.jsx(ln,{show:d,onHide:ce,children:R.jsxs(ln.Body,{children:[t.targetType==="comment"?R.jsx("div",{children:R.jsxs("div",{className:"cmt-containers",children:[R.jsx("img",{src:((xe=m==null?void 0:m.user)==null?void 0:xe.profileimage)||Gr,style:{maxWidth:"2rem"},alt:"avatar"}),R.jsxs("div",{className:"user-details",children:[R.jsx("b",{className:"lg-text",children:(je=m==null?void 0:m.user)==null?void 0:je.username}),R.jsxs("span",{className:"text",children:[m==null?void 0:m.text,"    "]})]}),R.jsxs("div",{className:"like-count",children:[R.jsx("img",{src:LP,alt:"like"}),R.jsx("span",{className:"lg-text",style:{fontSize:"13px"},children:(Ge=m==null?void 0:m.likes)==null?void 0:Ge.length})]})]})}):R.jsx("div",{className:"post-size",children:R.jsx("img",{className:"post-size py-2",src:m==null?void 0:m.image,alt:"avatar"})}),R.jsx("button",{onClick:K,className:"button my-1 py-1 w-25 align-self-end",children:"Delete"})]})}),R.jsx(ln,{show:y,onHide:W,style:{marginTop:"14%"},children:R.jsxs(ln.Body,{style:{width:"13rem"},children:[R.jsxs("span",{className:"lg-text pb-2",children:["Do you wish to delete this ",t.targetType==="post"?"post":"comment","?"]}),R.jsxs("div",{className:"cover px-4",children:[R.jsx("button",{className:"button modalButton",onClick:W,children:"No!"}),R.jsx("button",{className:"button modalButton",onClick:Z,children:"Yes!"})]})]})}),R.jsx(ln,{show:I,onHide:()=>P(!1),style:{marginTop:"14%"},children:R.jsxs(ln.Body,{children:[R.jsxs("span",{className:"lg-text",children:[t.targetType==="post"?"Post":"Comment"," has already been deleted!"]}),R.jsx("button",{onClick:()=>P(!1),className:"button mx-5 mt-2 py-1",children:"OK"})]})})]})}doe.propTypes={report:Le.shape({reporterId:Le.shape({profileimage:Le.string,username:Le.string}),_id:Le.string,reason:Le.string,createdAt:Le.string,targetType:Le.string,targetId:Le.string,status:Le.oneOf(["pending","resolved"])}).isRequired,setTargetLoading:Le.func.isRequired,setReports:Le.func.isRequired,incPage:Le.func.isRequired};function vVe(){const[t,e]=$.useState(!0),[n,r]=$.useState(!0),[c,l]=$.useState(!1),[d,f]=$.useState([]),[m,E]=$.useState(!1),[y,w]=$.useState(1),I=bi(),P={display:"block",position:"absolute",top:"15%",margin:" 0 50%",zIndex:"1070"},k={display:"block",margin:" 0 50%",marginBottom:"5rem"},M=()=>{w(V=>V+1)},W=k5(async()=>{if(!m&&n){E(!0);try{window.innerHeight+document.documentElement.scrollTop+1>=document.documentElement.scrollHeight&&w(V=>V+1)}catch(V){console.log(V)}}},1e3);return $.useEffect(()=>{FNe(y).then(V=>{e(!1);const G=V.data;(G.length===0||G.length<8)&&r(!1),f(Q=>[...Q,...G])}).catch(V=>{V.response.data.error==="Token has expired"&&(console.log("👍👍👍👍"),I(tee())),console.log(V),e(!1)})},[y]),$.useEffect(()=>(window.addEventListener("scroll",W),()=>{window.removeEventListener("scroll",W),E(!1)}),[m]),R.jsxs(R.Fragment,{children:[R.jsx(ku,{position:"top-center",reverseOrder:!1}),R.jsxs("div",{className:"table-container",children:[!t&&R.jsx(dn.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5},children:R.jsxs("table",{className:"table",children:[R.jsx("thead",{className:"table-head",children:R.jsxs("tr",{children:[R.jsx("th",{style:{display:"flex",justifyContent:"center"},children:"User"}),R.jsx("th",{children:"Username"}),R.jsx("th",{children:"Reason"}),R.jsx("th",{children:"Reported on"}),R.jsx("th",{children:"Target"}),R.jsx("th",{children:"Status"}),R.jsx("th",{style:{display:"flex",justifyContent:"center"},children:"Action"})]})}),R.jsx("tbody",{children:d.map(V=>R.jsx(doe,{report:V,setTargetLoading:l,setReports:f,incPage:M},V._id))})]})}),R.jsx(S5,{loading:t,cssOverride:k,color:"orange"}),R.jsx($b,{loading:c,cssOverride:P,color:"orange",speedMultiplier:1})]})]})}function yVe(){const t=Ia(),e=$.useRef(null),n=$.useRef(null),[r,c]=$.useState(!1),[l,d]=$.useState(!1),[f,m]=$.useState(!1),[E,y]=$.useState(30),[w,I]=$.useState(!1),P=Vb({phone:To().trim().matches(/^[0-9]{10}$/,"Phone must be a 10-digit number").required("Phone cannot be empty"),verifyOtp:To().trim().matches(/^[0-9]{6}$/,"OTP must be a 6-digit number").required("OTP cannot be empty"),password:To().trim().min(8,"Minimum 6 characters required").matches(/^(?=.*[a-zA-Z])(?=.*\d)/,"Password must contain at least one letter","and one number").required("Password cannot be empty"),confPassword:To().oneOf([Bne("password"),null],"Confirm password is not same").required("Confirm password is required")}),k=async W=>{var G,Q;if(W.preventDefault(),e.current.value.length===10)try{const Z=fe.loading(R.jsx("b",{children:"Sending...!"})),Y=await Oye({phone:e.current.value});console.log(Y.data),fe.dismiss(Z),Y.status==200?(fe.success(R.jsx("b",{children:Y.data.message})),c(!0),y(30),m(!0)):fe.error(R.jsx("b",{children:Y.data.error}))}catch(Z){fe.error(R.jsx("b",{children:(G=Z.response)!=null&&G.data.error?(Q=Z.response)==null?void 0:Q.data.error:"Something went wrong!"})),console.log(Z)}},M=async W=>{var G,Q;if(W.preventDefault(),n.current.value.length===6)try{const Z=fe.loading(R.jsx("b",{children:"Verifying...!"})),Y=await eee(e.current.value,n.current.value);fe.dismiss(Z),Y.status==200?(d(!0),fe.success(R.jsx("b",{children:Y.data.message}))):fe.error(R.jsx("b",{children:Y.data.error}))}catch(Z){fe.error(R.jsx("b",{children:(G=Z.response)!=null&&G.data.error?(Q=Z.response)==null?void 0:Q.data.error:"Something went wrong!"})),console.log(Z)}};$.useEffect(()=>{let W;return r&&E>0&&f?W=setInterval(()=>{y(V=>V-1)},1e3):E===0&&m(!1),()=>{clearInterval(W)}},[r,E,f]);const K=XN({initialValues:{password:"",confPassword:"",phone:"",verifyOtp:""},validationSchema:P,validateOnBlur:!0,validateOnChange:!0,onSubmit:async W=>{if(W=await Object.assign(W),!l)return fe.error(R.jsx("b",{children:"Verify Otp first"}));const V=fe.loading(R.jsx("b",{children:"Updating...!"}));I(!0),Nye(W).then(()=>{fe.dismiss(V),y(0),I(!1),t("/auth")}).catch(G=>{I(!1),fe.error(R.jsx("b",{children:"Failed to update password!"})),console.error("An error occurred:",G)})}});return R.jsxs("div",{className:"Auth",children:[R.jsx(ku,{position:"top-center",reverseOrder:!1}),R.jsxs("div",{onClick:()=>t("/auth"),className:"a-left",children:[R.jsx("img",{src:RP,alt:""}),R.jsxs("div",{className:"Webname",children:[R.jsx("h1",{children:"BuzzGram"}),R.jsx("h6",{children:"Explore the ideas throughout the world"})]})]}),R.jsx("div",{className:"a-right signup",children:R.jsxs("form",{className:"infoForm authForm",onSubmit:K.handleSubmit,children:[!l&&R.jsxs(R.Fragment,{children:[R.jsx("h4",{children:"Reset password with OTP"}),R.jsxs("div",{style:{display:"flow"},children:[R.jsxs("div",{className:"otp-setup",children:[R.jsx("input",{...K.getFieldProps("phone"),ref:e,type:"text",className:"infoInput",placeholder:"Phone",name:"phone"}),!f&&R.jsx("button",{className:"button otp",onClick:W=>k(W),children:R.jsx("span",{children:"OTP"})})]}),K.touched.phone&&K.errors.phone&&R.jsx("div",{style:{color:"red"},children:K.errors.phone}),f&&R.jsxs("span",{style:{fontSize:"0.8rem"},children:["Resend OTP in ",E,"s"]})]}),r&&R.jsxs("div",{style:{display:"flow"},children:[R.jsxs("div",{className:"otp-setup",children:[R.jsx("input",{...K.getFieldProps("verifyOtp"),ref:n,type:"text",className:"infoInput",placeholder:"Verify OTP",name:"verifyOtp"}),R.jsx("button",{className:"button otp",onClick:W=>M(W),children:R.jsx("span",{className:"material-symbols-outlined",children:"task_alt"})})]}),K.touched.verifyOtp&&K.errors.verifyOtp&&R.jsx("div",{style:{color:"red"},children:K.errors.verifyOtp})]})]}),l&&R.jsxs(R.Fragment,{children:[R.jsx("h4",{children:"Update password"}),R.jsxs("div",{style:{display:"flow"},children:[R.jsx("input",{...K.getFieldProps("password"),type:"password",className:"infoInput",placeholder:"Password",name:"password"}),K.touched.password&&K.errors.password&&R.jsx("div",{style:{color:"red"},children:K.errors.password})]}),R.jsxs("div",{style:{display:"flow"},children:[R.jsx("input",{...K.getFieldProps("confPassword"),type:"password",className:"infoInput",placeholder:"Confirm password",name:"confPassword"}),K.touched.confPassword&&K.errors.confPassword&&R.jsx("div",{style:{color:"red"},children:K.errors.confPassword})]}),R.jsx("div",{children:R.jsx("button",{type:"submit",className:"button infoButton",disabled:w,children:w?"Updating...":"Update"})})]})]})})]})}function SVe(){var r;const t=Si(c=>c.authReducer.authData),e=localStorage.getItem("admin"),n=t&&((r=t==null?void 0:t.user)==null?void 0:r.isblocked)!==!0;return R.jsxs("div",{className:"App",children:[R.jsx("div",{className:"blur",style:{top:"-18%",right:"0"}}),R.jsx("div",{className:"blur",style:{top:"36%",left:"-8rem"}}),R.jsxs(vee,{children:[R.jsx(Os,{path:"/check",element:R.jsx(fF,{})}),R.jsx(Os,{path:"/",element:n?R.jsx(Ya,{to:"home"}):R.jsx(Ya,{to:"auth"})}),R.jsx(Os,{path:"/home",element:n?R.jsx(Am,{location:"home"}):R.jsx(Ya,{to:"/auth"})}),R.jsx(Os,{path:"/chat",element:n?R.jsx(Am,{location:"chat"}):R.jsx(Ya,{to:"/auth"})}),R.jsx(Os,{path:"/explore",element:n?R.jsx(Am,{location:"explore"}):R.jsx(Ya,{to:"/auth"})}),R.jsx(Os,{path:"/saved",element:n?R.jsx(Am,{location:"saved"}):R.jsx(Ya,{to:"/auth"})}),R.jsx(Os,{path:"/auth",element:n?R.jsx(Ya,{to:"../home"}):R.jsx(G1e,{})}),R.jsx(Os,{path:"/profile/:id",element:n?R.jsx(Am,{location:"profile"}):R.jsx(Ya,{to:"/auth"})}),R.jsx(Os,{path:"/forgot-password",element:n?R.jsx(Am,{location:"profile"}):R.jsx(yVe,{})}),R.jsx(Os,{path:"*",element:R.jsx(fF,{})}),R.jsxs(Os,{path:"/admin/",element:e?R.jsx(M2e,{}):R.jsx(Ya,{to:"auth"}),children:[R.jsx(Os,{index:!0,element:R.jsx(lVe,{})}),R.jsx(Os,{path:"users",element:e?R.jsx(mVe,{}):R.jsx(Ya,{to:"../auth"})}),R.jsx(Os,{path:"posts",element:e?R.jsx(fF,{}):R.jsx(Ya,{to:"../auth"})}),R.jsx(Os,{path:"reports",element:e?R.jsx(vVe,{}):R.jsx(Ya,{to:"../auth"})})]}),R.jsx(Os,{path:"/admin/auth",element:e?R.jsx(Ya,{to:"../admin"}):R.jsx(q1e,{})})]})]})}function _l(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+t+(n.length?" "+n.map(function(c){return"'"+c+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function cg(t){return!!t&&!!t[yr]}function lg(t){var e;return!!t&&(function(n){if(!n||typeof n!="object")return!1;var r=Object.getPrototypeOf(n);if(r===null)return!0;var c=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;return c===Object||typeof c=="function"&&Function.toString.call(c)===NVe}(t)||Array.isArray(t)||!!t[kX]||!!(!((e=t.constructor)===null||e===void 0)&&e[kX])||g6(t)||_6(t))}function ug(t,e,n){n===void 0&&(n=!1),Bv(t)===0?(n?Object.keys:cv)(t).forEach(function(r){n&&typeof r=="symbol"||e(r,t[r],t)}):t.forEach(function(r,c){return e(c,r,t)})}function Bv(t){var e=t[yr];return e?e.i>3?e.i-4:e.i:Array.isArray(t)?1:g6(t)?2:_6(t)?3:0}function av(t,e){return Bv(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function TVe(t,e){return Bv(t)===2?t.get(e):t[e]}function hoe(t,e,n){var r=Bv(t);r===2?t.set(e,n):r===3?t.add(n):t[e]=n}function foe(t,e){return t===e?t!==0||1/t==1/e:t!=t&&e!=e}function g6(t){return AVe&&t instanceof Map}function _6(t){return OVe&&t instanceof Set}function Nm(t){return t.o||t.t}function E6(t){if(Array.isArray(t))return Array.prototype.slice.call(t);var e=moe(t);delete e[yr];for(var n=cv(e),r=0;r<n.length;r++){var c=n[r],l=e[c];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(e[c]={configurable:!0,writable:!0,enumerable:l.enumerable,value:t[c]})}return Object.create(Object.getPrototypeOf(t),e)}function v6(t,e){return e===void 0&&(e=!1),y6(t)||cg(t)||!lg(t)||(Bv(t)>1&&(t.set=t.add=t.clear=t.delete=bVe),Object.freeze(t),e&&ug(t,function(n,r){return v6(r,!0)},!0)),t}function bVe(){_l(2)}function y6(t){return t==null||typeof t!="object"||Object.isFrozen(t)}function Ru(t){var e=uB[t];return e||_l(18,t),e}function wVe(t,e){uB[t]||(uB[t]=e)}function aB(){return mb}function CF(t,e){e&&(Ru("Patches"),t.u=[],t.s=[],t.v=e)}function pN(t){cB(t),t.p.forEach(CVe),t.p=null}function cB(t){t===mb&&(mb=t.l)}function AX(t){return mb={p:[],l:mb,h:t,m:!0,_:0}}function CVe(t){var e=t[yr];e.i===0||e.i===1?e.j():e.g=!0}function RF(t,e){e._=e.p.length;var n=e.p[0],r=t!==void 0&&t!==n;return e.h.O||Ru("ES5").S(e,t,r),r?(n[yr].P&&(pN(e),_l(4)),lg(t)&&(t=mN(e,t),e.l||gN(e,t)),e.u&&Ru("Patches").M(n[yr].t,t,e.u,e.s)):t=mN(e,n,[]),pN(e),e.u&&e.v(e.u,e.s),t!==poe?t:void 0}function mN(t,e,n){if(y6(e))return e;var r=e[yr];if(!r)return ug(e,function(f,m){return OX(t,r,e,f,m,n)},!0),e;if(r.A!==t)return e;if(!r.P)return gN(t,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var c=r.i===4||r.i===5?r.o=E6(r.k):r.o,l=c,d=!1;r.i===3&&(l=new Set(c),c.clear(),d=!0),ug(l,function(f,m){return OX(t,r,c,f,m,n,d)}),gN(t,c,!1),n&&t.u&&Ru("Patches").N(r,n,t.u,t.s)}return r.o}function OX(t,e,n,r,c,l,d){if(cg(c)){var f=mN(t,c,l&&e&&e.i!==3&&!av(e.R,r)?l.concat(r):void 0);if(hoe(n,r,f),!cg(f))return;t.m=!1}else d&&n.add(c);if(lg(c)&&!y6(c)){if(!t.h.D&&t._<1)return;mN(t,c),e&&e.A.l||gN(t,c)}}function gN(t,e,n){n===void 0&&(n=!1),!t.l&&t.h.D&&t.m&&v6(e,n)}function IF(t,e){var n=t[yr];return(n?Nm(n):t)[e]}function NX(t,e){if(e in t)for(var n=Object.getPrototypeOf(t);n;){var r=Object.getOwnPropertyDescriptor(n,e);if(r)return r;n=Object.getPrototypeOf(n)}}function gf(t){t.P||(t.P=!0,t.l&&gf(t.l))}function AF(t){t.o||(t.o=E6(t.t))}function lB(t,e,n){var r=g6(e)?Ru("MapSet").F(e,n):_6(e)?Ru("MapSet").T(e,n):t.O?function(c,l){var d=Array.isArray(c),f={i:d?1:0,A:l?l.A:aB(),P:!1,I:!1,R:{},l,t:c,k:null,o:null,j:null,C:!1},m=f,E=gb;d&&(m=[f],E=cT);var y=Proxy.revocable(m,E),w=y.revoke,I=y.proxy;return f.k=I,f.j=w,I}(e,n):Ru("ES5").J(e,n);return(n?n.A:aB()).p.push(r),r}function RVe(t){return cg(t)||_l(22,t),function e(n){if(!lg(n))return n;var r,c=n[yr],l=Bv(n);if(c){if(!c.P&&(c.i<4||!Ru("ES5").K(c)))return c.t;c.I=!0,r=PX(n,l),c.I=!1}else r=PX(n,l);return ug(r,function(d,f){c&&TVe(c.t,d)===f||hoe(r,d,e(f))}),l===3?new Set(r):r}(t)}function PX(t,e){switch(e){case 2:return new Map(t);case 3:return Array.from(t)}return E6(t)}function IVe(){function t(l,d){var f=c[l];return f?f.enumerable=d:c[l]=f={configurable:!0,enumerable:d,get:function(){var m=this[yr];return gb.get(m,l)},set:function(m){var E=this[yr];gb.set(E,l,m)}},f}function e(l){for(var d=l.length-1;d>=0;d--){var f=l[d][yr];if(!f.P)switch(f.i){case 5:r(f)&&gf(f);break;case 4:n(f)&&gf(f)}}}function n(l){for(var d=l.t,f=l.k,m=cv(f),E=m.length-1;E>=0;E--){var y=m[E];if(y!==yr){var w=d[y];if(w===void 0&&!av(d,y))return!0;var I=f[y],P=I&&I[yr];if(P?P.t!==w:!foe(I,w))return!0}}var k=!!d[yr];return m.length!==cv(d).length+(k?0:1)}function r(l){var d=l.k;if(d.length!==l.t.length)return!0;var f=Object.getOwnPropertyDescriptor(d,d.length-1);if(f&&!f.get)return!0;for(var m=0;m<d.length;m++)if(!d.hasOwnProperty(m))return!0;return!1}var c={};wVe("ES5",{J:function(l,d){var f=Array.isArray(l),m=function(y,w){if(y){for(var I=Array(w.length),P=0;P<w.length;P++)Object.defineProperty(I,""+P,t(P,!0));return I}var k=moe(w);delete k[yr];for(var M=cv(k),K=0;K<M.length;K++){var W=M[K];k[W]=t(W,y||!!k[W].enumerable)}return Object.create(Object.getPrototypeOf(w),k)}(f,l),E={i:f?5:4,A:d?d.A:aB(),P:!1,I:!1,R:{},l:d,t:l,k:m,o:null,g:!1,C:!1};return Object.defineProperty(m,yr,{value:E,writable:!0}),m},S:function(l,d,f){f?cg(d)&&d[yr].A===l&&e(l.p):(l.u&&function m(E){if(E&&typeof E=="object"){var y=E[yr];if(y){var w=y.t,I=y.k,P=y.R,k=y.i;if(k===4)ug(I,function(G){G!==yr&&(w[G]!==void 0||av(w,G)?P[G]||m(I[G]):(P[G]=!0,gf(y)))}),ug(w,function(G){I[G]!==void 0||av(I,G)||(P[G]=!1,gf(y))});else if(k===5){if(r(y)&&(gf(y),P.length=!0),I.length<w.length)for(var M=I.length;M<w.length;M++)P[M]=!1;else for(var K=w.length;K<I.length;K++)P[K]=!0;for(var W=Math.min(I.length,w.length),V=0;V<W;V++)I.hasOwnProperty(V)||(P[V]=!0),P[V]===void 0&&m(I[V])}}}}(l.p[0]),e(l.p))},K:function(l){return l.i===4?n(l):r(l)}})}var xX,mb,S6=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",AVe=typeof Map<"u",OVe=typeof Set<"u",DX=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",poe=S6?Symbol.for("immer-nothing"):((xX={})["immer-nothing"]=!0,xX),kX=S6?Symbol.for("immer-draftable"):"__$immer_draftable",yr=S6?Symbol.for("immer-state"):"__$immer_state",NVe=""+Object.prototype.constructor,cv=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames,moe=Object.getOwnPropertyDescriptors||function(t){var e={};return cv(t).forEach(function(n){e[n]=Object.getOwnPropertyDescriptor(t,n)}),e},uB={},gb={get:function(t,e){if(e===yr)return t;var n=Nm(t);if(!av(n,e))return function(c,l,d){var f,m=NX(l,d);return m?"value"in m?m.value:(f=m.get)===null||f===void 0?void 0:f.call(c.k):void 0}(t,n,e);var r=n[e];return t.I||!lg(r)?r:r===IF(t.t,e)?(AF(t),t.o[e]=lB(t.A.h,r,t)):r},has:function(t,e){return e in Nm(t)},ownKeys:function(t){return Reflect.ownKeys(Nm(t))},set:function(t,e,n){var r=NX(Nm(t),e);if(r!=null&&r.set)return r.set.call(t.k,n),!0;if(!t.P){var c=IF(Nm(t),e),l=c==null?void 0:c[yr];if(l&&l.t===n)return t.o[e]=n,t.R[e]=!1,!0;if(foe(n,c)&&(n!==void 0||av(t.t,e)))return!0;AF(t),gf(t)}return t.o[e]===n&&(n!==void 0||e in t.o)||Number.isNaN(n)&&Number.isNaN(t.o[e])||(t.o[e]=n,t.R[e]=!0),!0},deleteProperty:function(t,e){return IF(t.t,e)!==void 0||e in t.t?(t.R[e]=!1,AF(t),gf(t)):delete t.R[e],t.o&&delete t.o[e],!0},getOwnPropertyDescriptor:function(t,e){var n=Nm(t),r=Reflect.getOwnPropertyDescriptor(n,e);return r&&{writable:!0,configurable:t.i!==1||e!=="length",enumerable:r.enumerable,value:n[e]}},defineProperty:function(){_l(11)},getPrototypeOf:function(t){return Object.getPrototypeOf(t.t)},setPrototypeOf:function(){_l(12)}},cT={};ug(gb,function(t,e){cT[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}}),cT.deleteProperty=function(t,e){return cT.set.call(this,t,e,void 0)},cT.set=function(t,e,n){return gb.set.call(this,t[0],e,n,t[0])};var PVe=function(){function t(n){var r=this;this.O=DX,this.D=!0,this.produce=function(c,l,d){if(typeof c=="function"&&typeof l!="function"){var f=l;l=c;var m=r;return function(M){var K=this;M===void 0&&(M=f);for(var W=arguments.length,V=Array(W>1?W-1:0),G=1;G<W;G++)V[G-1]=arguments[G];return m.produce(M,function(Q){var Z;return(Z=l).call.apply(Z,[K,Q].concat(V))})}}var E;if(typeof l!="function"&&_l(6),d!==void 0&&typeof d!="function"&&_l(7),lg(c)){var y=AX(r),w=lB(r,c,void 0),I=!0;try{E=l(w),I=!1}finally{I?pN(y):cB(y)}return typeof Promise<"u"&&E instanceof Promise?E.then(function(M){return CF(y,d),RF(M,y)},function(M){throw pN(y),M}):(CF(y,d),RF(E,y))}if(!c||typeof c!="object"){if((E=l(c))===void 0&&(E=c),E===poe&&(E=void 0),r.D&&v6(E,!0),d){var P=[],k=[];Ru("Patches").M(c,E,P,k),d(P,k)}return E}_l(21,c)},this.produceWithPatches=function(c,l){if(typeof c=="function")return function(E){for(var y=arguments.length,w=Array(y>1?y-1:0),I=1;I<y;I++)w[I-1]=arguments[I];return r.produceWithPatches(E,function(P){return c.apply(void 0,[P].concat(w))})};var d,f,m=r.produce(c,l,function(E,y){d=E,f=y});return typeof Promise<"u"&&m instanceof Promise?m.then(function(E){return[E,d,f]}):[m,d,f]},typeof(n==null?void 0:n.useProxies)=="boolean"&&this.setUseProxies(n.useProxies),typeof(n==null?void 0:n.autoFreeze)=="boolean"&&this.setAutoFreeze(n.autoFreeze)}var e=t.prototype;return e.createDraft=function(n){lg(n)||_l(8),cg(n)&&(n=RVe(n));var r=AX(this),c=lB(this,n,void 0);return c[yr].C=!0,cB(r),c},e.finishDraft=function(n,r){var c=n&&n[yr],l=c.A;return CF(l,r),RF(void 0,l)},e.setAutoFreeze=function(n){this.D=n},e.setUseProxies=function(n){n&&!DX&&_l(20),this.O=n},e.applyPatches=function(n,r){var c;for(c=r.length-1;c>=0;c--){var l=r[c];if(l.path.length===0&&l.op==="replace"){n=l.value;break}}c>-1&&(r=r.slice(c+1));var d=Ru("Patches").$;return cg(n)?d(n,r):this.produce(n,function(f){return d(f,r)})},t}(),sc=new PVe;sc.produce;sc.produceWithPatches.bind(sc);sc.setAutoFreeze.bind(sc);sc.setUseProxies.bind(sc);sc.applyPatches.bind(sc);sc.createDraft.bind(sc);sc.finishDraft.bind(sc);function _b(t){"@babel/helpers - typeof";return _b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_b(t)}function xVe(t,e){if(_b(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(_b(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function DVe(t){var e=xVe(t,"string");return _b(e)==="symbol"?e:String(e)}function kVe(t,e,n){return e=DVe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LX(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),n.push.apply(n,r)}return n}function MX(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?LX(Object(n),!0).forEach(function(r){kVe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):LX(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function yo(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var UX=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),OF=function(){return Math.random().toString(36).substring(7).split("").join(".")},_N={INIT:"@@redux/INIT"+OF(),REPLACE:"@@redux/REPLACE"+OF(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+OF()}};function LVe(t){if(typeof t!="object"||t===null)return!1;for(var e=t;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function goe(t,e,n){var r;if(typeof e=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(yo(0));if(typeof e=="function"&&typeof n>"u"&&(n=e,e=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(yo(1));return n(goe)(t,e)}if(typeof t!="function")throw new Error(yo(2));var c=t,l=e,d=[],f=d,m=!1;function E(){f===d&&(f=d.slice())}function y(){if(m)throw new Error(yo(3));return l}function w(M){if(typeof M!="function")throw new Error(yo(4));if(m)throw new Error(yo(5));var K=!0;return E(),f.push(M),function(){if(K){if(m)throw new Error(yo(6));K=!1,E();var V=f.indexOf(M);f.splice(V,1),d=null}}}function I(M){if(!LVe(M))throw new Error(yo(7));if(typeof M.type>"u")throw new Error(yo(8));if(m)throw new Error(yo(9));try{m=!0,l=c(l,M)}finally{m=!1}for(var K=d=f,W=0;W<K.length;W++){var V=K[W];V()}return M}function P(M){if(typeof M!="function")throw new Error(yo(10));c=M,I({type:_N.REPLACE})}function k(){var M,K=w;return M={subscribe:function(V){if(typeof V!="object"||V===null)throw new Error(yo(11));function G(){V.next&&V.next(y())}G();var Q=K(G);return{unsubscribe:Q}}},M[UX]=function(){return this},M}return I({type:_N.INIT}),r={dispatch:I,subscribe:w,getState:y,replaceReducer:P},r[UX]=k,r}function MVe(t){Object.keys(t).forEach(function(e){var n=t[e],r=n(void 0,{type:_N.INIT});if(typeof r>"u")throw new Error(yo(12));if(typeof n(void 0,{type:_N.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(yo(13))})}function _oe(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++){var c=e[r];typeof t[c]=="function"&&(n[c]=t[c])}var l=Object.keys(n),d;try{MVe(n)}catch(f){d=f}return function(m,E){if(m===void 0&&(m={}),d)throw d;for(var y=!1,w={},I=0;I<l.length;I++){var P=l[I],k=n[P],M=m[P],K=k(M,E);if(typeof K>"u")throw E&&E.type,new Error(yo(14));w[P]=K,y=y||K!==M}return y=y||l.length!==Object.keys(m).length,y?w:m}}function EN(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length===0?function(r){return r}:e.length===1?e[0]:e.reduce(function(r,c){return function(){return r(c.apply(void 0,arguments))}})}function UVe(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(r){return function(){var c=r.apply(void 0,arguments),l=function(){throw new Error(yo(15))},d={getState:c.getState,dispatch:function(){return l.apply(void 0,arguments)}},f=e.map(function(m){return m(d)});return l=EN.apply(void 0,f)(c.dispatch),MX(MX({},c),{},{dispatch:l})}}}function Eoe(t){var e=function(r){var c=r.dispatch,l=r.getState;return function(d){return function(f){return typeof f=="function"?f(c,l,t):d(f)}}};return e}var voe=Eoe();voe.withExtraArgument=Eoe;const dB=voe;var yoe=globalThis&&globalThis.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,c){r.__proto__=c}||function(r,c){for(var l in c)Object.prototype.hasOwnProperty.call(c,l)&&(r[l]=c[l])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),jVe=globalThis&&globalThis.__generator||function(t,e){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},r,c,l,d;return d={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function f(E){return function(y){return m([E,y])}}function m(E){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,c&&(l=E[0]&2?c.return:E[0]?c.throw||((l=c.return)&&l.call(c),0):c.next)&&!(l=l.call(c,E[1])).done)return l;switch(c=0,l&&(E=[E[0]&2,l.value]),E[0]){case 0:case 1:l=E;break;case 4:return n.label++,{value:E[1],done:!1};case 5:n.label++,c=E[1],E=[0];continue;case 7:E=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(E[0]===6||E[0]===2)){n=0;continue}if(E[0]===3&&(!l||E[1]>l[0]&&E[1]<l[3])){n.label=E[1];break}if(E[0]===6&&n.label<l[1]){n.label=l[1],l=E;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(E);break}l[2]&&n.ops.pop(),n.trys.pop();continue}E=e.call(t,n)}catch(y){E=[6,y],c=0}finally{r=l=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}},Eb=globalThis&&globalThis.__spreadArray||function(t,e){for(var n=0,r=e.length,c=t.length;n<r;n++,c++)t[c]=e[n];return t},FVe=Object.defineProperty,VVe=Object.defineProperties,BVe=Object.getOwnPropertyDescriptors,jX=Object.getOwnPropertySymbols,WVe=Object.prototype.hasOwnProperty,HVe=Object.prototype.propertyIsEnumerable,FX=function(t,e,n){return e in t?FVe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n},lv=function(t,e){for(var n in e||(e={}))WVe.call(e,n)&&FX(t,n,e[n]);if(jX)for(var r=0,c=jX(e);r<c.length;r++){var n=c[r];HVe.call(e,n)&&FX(t,n,e[n])}return t},NF=function(t,e){return VVe(t,BVe(e))},$Ve=function(t,e,n){return new Promise(function(r,c){var l=function(m){try{f(n.next(m))}catch(E){c(E)}},d=function(m){try{f(n.throw(m))}catch(E){c(E)}},f=function(m){return m.done?r(m.value):Promise.resolve(m.value).then(l,d)};f((n=n.apply(t,e)).next())})},zVe=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?EN:EN.apply(null,arguments)};function GVe(t){if(typeof t!="object"||t===null)return!1;var e=Object.getPrototypeOf(t);if(e===null)return!0;for(var n=e;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return e===n}function uv(t,e){function n(){for(var r=[],c=0;c<arguments.length;c++)r[c]=arguments[c];if(e){var l=e.apply(void 0,r);if(!l)throw new Error("prepareAction did not return an object");return lv(lv({type:t,payload:l.payload},"meta"in l&&{meta:l.meta}),"error"in l&&{error:l.error})}return{type:t,payload:r[0]}}return n.toString=function(){return""+t},n.type=t,n.match=function(r){return r.type===t},n}var KVe=function(t){yoe(e,t);function e(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var c=t.apply(this,n)||this;return Object.setPrototypeOf(c,e.prototype),c}return Object.defineProperty(e,Symbol.species,{get:function(){return e},enumerable:!1,configurable:!0}),e.prototype.concat=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.prototype.concat.apply(this,n)},e.prototype.prepend=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.length===1&&Array.isArray(n[0])?new(e.bind.apply(e,Eb([void 0],n[0].concat(this)))):new(e.bind.apply(e,Eb([void 0],n.concat(this))))},e}(Array),qVe=function(t){yoe(e,t);function e(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var c=t.apply(this,n)||this;return Object.setPrototypeOf(c,e.prototype),c}return Object.defineProperty(e,Symbol.species,{get:function(){return e},enumerable:!1,configurable:!0}),e.prototype.concat=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.prototype.concat.apply(this,n)},e.prototype.prepend=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.length===1&&Array.isArray(n[0])?new(e.bind.apply(e,Eb([void 0],n[0].concat(this)))):new(e.bind.apply(e,Eb([void 0],n.concat(this))))},e}(Array);function YVe(t){return typeof t=="boolean"}function XVe(){return function(e){return JVe(e)}}function JVe(t){t===void 0&&(t={});var e=t.thunk,n=e===void 0?!0:e;t.immutableCheck,t.serializableCheck,t.actionCreatorCheck;var r=new KVe;return n&&(YVe(n)?r.push(dB):r.push(dB.withExtraArgument(n.extraArgument))),r}var QVe=!0;function ZVe(t){var e=XVe(),n=t||{},r=n.reducer,c=r===void 0?void 0:r,l=n.middleware,d=l===void 0?e():l,f=n.devTools,m=f===void 0?!0:f,E=n.preloadedState,y=E===void 0?void 0:E,w=n.enhancers,I=w===void 0?void 0:w,P;if(typeof c=="function")P=c;else if(GVe(c))P=_oe(c);else throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');var k=d;typeof k=="function"&&(k=k(e));var M=UVe.apply(void 0,k),K=EN;m&&(K=zVe(lv({trace:!QVe},typeof m=="object"&&m)));var W=new qVe(M),V=W;Array.isArray(I)?V=Eb([M],I):typeof I=="function"&&(V=I(W));var G=K.apply(void 0,V);return goe(P,y,G)}var eBe="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",tBe=function(t){t===void 0&&(t=21);for(var e="",n=t;n--;)e+=eBe[Math.random()*64|0];return e},nBe=["name","message","stack","code"],PF=function(){function t(e,n){this.payload=e,this.meta=n}return t}(),VX=function(){function t(e,n){this.payload=e,this.meta=n}return t}(),iBe=function(t){if(typeof t=="object"&&t!==null){for(var e={},n=0,r=nBe;n<r.length;n++){var c=r[n];typeof t[c]=="string"&&(e[c]=t[c])}return e}return{message:String(t)}};(function(){function t(e,n,r){var c=uv(e+"/fulfilled",function(E,y,w,I){return{payload:E,meta:NF(lv({},I||{}),{arg:w,requestId:y,requestStatus:"fulfilled"})}}),l=uv(e+"/pending",function(E,y,w){return{payload:void 0,meta:NF(lv({},w||{}),{arg:y,requestId:E,requestStatus:"pending"})}}),d=uv(e+"/rejected",function(E,y,w,I,P){return{payload:I,error:(r&&r.serializeError||iBe)(E||"Rejected"),meta:NF(lv({},P||{}),{arg:w,requestId:y,rejectedWithValue:!!I,requestStatus:"rejected",aborted:(E==null?void 0:E.name)==="AbortError",condition:(E==null?void 0:E.name)==="ConditionError"})}}),f=typeof AbortController<"u"?AbortController:function(){function E(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){},reason:void 0,throwIfAborted:function(){}}}return E.prototype.abort=function(){},E}();function m(E){return function(y,w,I){var P=r!=null&&r.idGenerator?r.idGenerator(E):tBe(),k=new f,M;function K(V){M=V,k.abort()}var W=function(){return $Ve(this,null,function(){var V,G,Q,Z,Y,oe,ce;return jVe(this,function(Se){switch(Se.label){case 0:return Se.trys.push([0,4,,5]),Z=(V=r==null?void 0:r.condition)==null?void 0:V.call(r,E,{getState:w,extra:I}),sBe(Z)?[4,Z]:[3,2];case 1:Z=Se.sent(),Se.label=2;case 2:if(Z===!1||k.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return Y=new Promise(function(xe,je){return k.signal.addEventListener("abort",function(){return je({name:"AbortError",message:M||"Aborted"})})}),y(l(P,E,(G=r==null?void 0:r.getPendingMeta)==null?void 0:G.call(r,{requestId:P,arg:E},{getState:w,extra:I}))),[4,Promise.race([Y,Promise.resolve(n(E,{dispatch:y,getState:w,extra:I,requestId:P,signal:k.signal,abort:K,rejectWithValue:function(xe,je){return new PF(xe,je)},fulfillWithValue:function(xe,je){return new VX(xe,je)}})).then(function(xe){if(xe instanceof PF)throw xe;return xe instanceof VX?c(xe.payload,P,E,xe.meta):c(xe,P,E)})])];case 3:return Q=Se.sent(),[3,5];case 4:return oe=Se.sent(),Q=oe instanceof PF?d(null,P,E,oe.payload,oe.meta):d(oe,P,E),[3,5];case 5:return ce=r&&!r.dispatchConditionRejection&&d.match(Q)&&Q.meta.condition,ce||y(Q),[2,Q]}})})}();return Object.assign(W,{abort:K,requestId:P,arg:E,unwrap:function(){return W.then(rBe)}})}}return Object.assign(m,{pending:l,rejected:d,fulfilled:c,typePrefix:e})}return t.withTypes=function(){return t},t})();function rBe(t){if(t.meta&&t.meta.rejectedWithValue)throw t.payload;if(t.error)throw t.error;return t.payload}function sBe(t){return t!==null&&typeof t=="object"&&typeof t.then=="function"}var T6="listenerMiddleware";uv(T6+"/add");uv(T6+"/removeAll");uv(T6+"/remove");var BX;typeof queueMicrotask=="function"&&queueMicrotask.bind(typeof window<"u"?window:typeof global<"u"?global:globalThis);IVe();const oBe=(t={authData:null,loading:!1,error:null,updateLoading:!1},e)=>{switch(e.type){case"AUTH_START":return{...t,loading:!0,error:null};case"AUTH_SUCCESS":return localStorage.setItem("profile",JSON.stringify({...e==null?void 0:e.data})),{...t,authData:e.data,loading:!1,error:null};case"AUTH_FAIL":return{...t,loading:!1,error:e.error};case"ADMIN_AUTH_START":return{...t,adminLoading:!0,adminError:null};case"ADMIN_AUTH_SUCCESS":return localStorage.setItem("admin",JSON.stringify({...e==null?void 0:e.data})),{...t,adminAuthData:e.data,adminLoading:!1,adminError:null};case"ADMIN_AUTH_FAIL":return{...t,adminLoading:!1,adminError:e.error};case"PROFILE_UPLOAD_SUCCESS":return{...t,authData:{...t.authData,user:{...t.authData.user,profileimage:e.data}}};case"COVER_UPLOAD_SUCCESS":return{...t,authData:{...t.authData,user:{...t.authData.user,coverimage:e.data}}};case"UPDATING_START":return{...t,updateLoading:!0,error:null};case"UPDATING_SUCCESS":{const n={...t.authData.user,...e.data.user},r=t.authData.token,c={user:n,token:r};return localStorage.setItem("profile",JSON.stringify(c)),{...t,authData:{user:n,token:r},updateLoading:!1,error:null}}case"UPDATING_FAIL":return{...t,updateLoading:!1,error:e.error};case"LOG_OUT":return localStorage.removeItem("profile"),localStorage.removeItem("expPage"),localStorage.removeItem("timelinePage"),{...t,authData:null,loading:!1,error:null,updateLoading:!1};case"ADMIN_LOG_OUT":return localStorage.removeItem("admin"),{...t,adminAuthData:null,adminLoading:!1,adminError:null,updateLoading:!1};case"FOLLOW_USER":return{...t,authData:{...t.authData,user:{...t.authData.user,following:[...t.authData.user.following,e.data]}}};case"UNFOLLOW_USER":return{...t,authData:{...t.authData,user:{...t.authData.user,following:[...t.authData.user.following.filter(n=>n!==e.data)]}}};case"BLOCK_USER":return{...t,authData:{...t.authData,user:{...t.authData.user,isblocked:!0}}};case"UNBLOCK_USER":return{...t,authData:{...t.authData,user:{...t.authData.user,isblocked:!1}}};case"UPDATE_SAVED":return{...t,authData:{...t.authData,user:{...t.authData.user,saved:e.isSaved?t.authData.user.saved.filter(n=>n!==e.postId):[...t.authData.user.saved,e.postId]}}};default:return t}},aBe=(t={posts:[],hasMorePosts:!0,moreTimelinePosts:!0,allPosts:[],loading:!1,timeLineloading:!1,error:!1,imgError:!1,uploading:!1},e)=>{switch(e.type){case"IMG_UPLOAD_START":return{...t,imgError:!1,uploading:!0};case"IMG_UPLOAD_SUCCESS":return{...t,uploading:!1,imgError:!1};case"IMG_UPLOAD_FAIL":return{...t,uploading:!1,imgError:!0};case"UPLOAD_START":return{...t,error:!1,uploading:!0};case"UPLOAD_SUCCESS":return{...t,posts:[e.data,...t.posts],uploading:!1,error:!1,hasMorePosts:!0};case"PROFILE_UPLOAD_SUCCESS":return{...t,posts:t.posts.map(n=>n.user._id===e.id?{...n,user:{...n.user,profileimage:e.data}}:n),allPosts:t.allPosts.map(n=>n.user._id===e.id?{...n,user:{...n.user,profileimage:e.data}}:n)};case"COVER_UPLOAD_SUCCESS":return{...t,posts:t.posts.map(n=>n.user._id===e.id?{...n,user:{...n.user,coverimage:e.data}}:n),allPosts:t.allPosts.map(n=>n.user._id===e.id?{...n,user:{...n.user,coverimage:e.data}}:n)};case"UPLOAD_FAIL":return{...t,uploading:!1,error:!0};case"RETREIVING_START":return{...t,timeLineloading:!0,error:!1};case"RETREIVING_SUCCESS":return{...t,posts:e.data.length>0?[...t.posts,...e.data]:t.posts,timeLineloading:!1,error:!1,moreTimelinePosts:e.data.length>0};case"RETREIVING_FAIL":return{...t,timeLineloading:!1,error:!0};case"GET_POSTS_START":return{...t,loading:!0,error:!1};case"GET_POSTS_SUCCESS":return{...t,allPosts:e.data.length>0?[...t.allPosts,...e.data]:t.allPosts,loading:!1,error:!1,hasMorePosts:e.data.length>0};case"GET_POSTS_FAIL":return{...t,loading:!1,error:!0};case"LIKE_POST":return{...t,posts:t.posts.map(n=>n._id===e.postId?{...n,likes:[...n.likes,e.userId]}:n),allPosts:t.allPosts.map(n=>n._id===e.postId?{...n,likes:[...n.likes,e.userId]}:n)};case"UNLIKE_POST":return{...t,posts:t.posts.map(n=>n._id===e.postId?{...n,likes:n.likes.filter(r=>r!==e.userId)}:n),allPosts:t.allPosts.map(n=>n._id===e.postId?{...n,likes:n.likes.filter(r=>r!==e.userId)}:n)};case"EDIT_POST_SUCCESS":return{...t,posts:t.posts.map(n=>n._id===e.postId?{...n,description:e.editedData.description}:n),allPosts:t.allPosts.map(n=>n._id===e.postId?{...n,description:e.editedData.description}:n)};case"COMMENT_SUCCESS":return{...t,posts:t.posts.map(n=>n._id===e.postId?{...n,comments:[...n.comments,e.Id]}:n),allPosts:t.allPosts.map(n=>n._id===e.postId?{...n,comments:[...n.comments,e.Id]}:n)};case"DELETE_POST_SUCCESS":return{...t,posts:t.posts.filter(n=>n._id!==e.postId),allPosts:t.allPosts.filter(n=>n._id!==e.postId)};case"DELETE_COMMENT":return{...t,posts:t.posts.map(n=>n._id===e.postId?{...n,comments:n.comments.filter(r=>r!==e.id)}:n),allPosts:t.allPosts.map(n=>n._id===e.postId?{...n,comments:n.comments.filter(r=>r!==e.id)}:n)};case"FILTER_REPORTED_POSTS":return{...t,posts:t.posts.filter(n=>n._id!==e.targetId),allPosts:t.allPosts.filter(n=>n._id!==e.targetId)};case"RESET_POST_STATE":return{posts:[],allPosts:[],timeLineloading:!1,loading:!1,error:!1,imgError:!1,uploading:!1,hasMorePosts:!0,moreTimelinePosts:!0};default:return t}},cBe={reports:[],loading:!1,error:null},lBe=(t=cBe,e)=>{switch(e.type){case"CREATE_REPORT_SUCCESS":return{...t,reports:[...t.reports,e.payload]};case"GET_REPORTS_SUCCESS":return{...t,reports:e.payload};case"GET_REPORT_SUCCESS":return t;case"UPDATE_REPORT_SUCCESS":return t;case"DELETE_REPORT_SUCCESS":return{...t,reports:t.reports.filter(n=>n._id!==e.payload)};default:return t}},uBe=(t={userDetails:null,loading:!1,error:null},e)=>{switch(e.type){case"FETCH_USERS_START":return{...t,loading:!0,error:null};case"FETCH_USERS_SUCCESS":return{...t,userDetails:e.data,loading:!1,error:null};case"FETCH_USERS_FAIL":return{...t,loading:!1,error:e.error};case"RESET_STATE":return{...t,userDetails:null,loading:!1,error:null};case"BLOCK_USER":return{...t,userDetails:t.userDetails.map(n=>n._id===e.userId?{...n,isblocked:!0}:n)};case"UNBLOCK_USER":return{...t,userDetails:t.userDetails.map(n=>n._id===e.userId?{...n,isblocked:!1}:n)};default:return t}},dBe=(t={currentChatUser:null,onlineUsers:[],videoCall:void 0,voiceCall:void 0,incomingVideoCall:void 0,incomingVoiceCall:void 0},e)=>{switch(e.type){case"CURRENT_CHAT_USER":return{...t,currentChatUser:e.data};case"SET_ONLINE_USERS":return{...t,onlineUsers:e.data};case"LOG_OUT":return{...t,currentChatUser:null};case"SET_VIDEO_CALL":return{...t,videoCall:e.videoCall};case"SET_VOICE_CALL":return{...t,voiceCall:e.voiceCall};case"SET_INCOMING_VOICE_CALL":return{...t,incomingVoiceCall:e.incomingVoiceCall};case"SET_INCOMING_VIDEO_CALL":return{...t,incomingVideoCall:e.incomingVideoCall};case"END_CALL":return{...t,voiceCall:void 0,videoCall:void 0,incomingVideoCall:void 0,incomingVoiceCall:void 0};default:return t}},hBe=_oe({authReducer:oBe,postReducer:aBe,reportReducer:lBe,adminReducer:uBe,chatReducer:dBe});function fBe(t){try{const e=JSON.stringify(t.getState());window.localStorage.setItem("store",e)}catch(e){console.error(e)}}function pBe(){try{const t=window.localStorage.getItem("store");return t===null?void 0:JSON.parse(t)}catch(t){console.error(t);return}}const mBe=pBe(),hB=ZVe({reducer:hBe,preloadedState:mBe,middleware:[dB],devTools:!1});hB.subscribe(()=>fBe(hB));xF.createRoot(document.getElementById("root")).render(R.jsx(m0e,{store:hB,children:R.jsx(pSe,{children:R.jsx(vee,{children:R.jsx(Os,{path:"*",element:R.jsx(SVe,{})})})})}))});export default gBe();
